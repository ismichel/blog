/*! For license information please see main.0dd92edc.js.LICENSE.txt */
!function(){var e={4525:function(e,t,n){(function(){"use strict";var e;function t(e){var t=0;return function(){return t<e.length?{done:!1,value:e[t++]}:{done:!0}}}var r="function"==typeof Object.defineProperties?Object.defineProperty:function(e,t,n){return e==Array.prototype||e==Object.prototype||(e[t]=n.value),e};var a=function(e){e=["object"==typeof globalThis&&globalThis,e,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof n.g&&n.g];for(var t=0;t<e.length;++t){var r=e[t];if(r&&r.Math==Math)return r}throw Error("Cannot find global object")}(this);function i(e,t){if(t)e:{var n=a;e=e.split(".");for(var i=0;i<e.length-1;i++){var o=e[i];if(!(o in n))break e;n=n[o]}(t=t(i=n[e=e[e.length-1]]))!=i&&null!=t&&r(n,e,{configurable:!0,writable:!0,value:t})}}function o(e){return(e={next:e})[Symbol.iterator]=function(){return this},e}function u(e){var n="undefined"!=typeof Symbol&&Symbol.iterator&&e[Symbol.iterator];return n?n.call(e):{next:t(e)}}function s(e){if(!(e instanceof Array)){e=u(e);for(var t,n=[];!(t=e.next()).done;)n.push(t.value);e=n}return e}i("Symbol",(function(e){function t(e,t){this.g=e,r(this,"description",{configurable:!0,writable:!0,value:t})}if(e)return e;t.prototype.toString=function(){return this.g};var n="jscomp_symbol_"+(1e9*Math.random()>>>0)+"_",a=0;return function e(r){if(this instanceof e)throw new TypeError("Symbol is not a constructor");return new t(n+(r||"")+"_"+a++,r)}})),i("Symbol.iterator",(function(e){if(e)return e;e=Symbol("Symbol.iterator");for(var n="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),i=0;i<n.length;i++){var u=a[n[i]];"function"===typeof u&&"function"!=typeof u.prototype[e]&&r(u.prototype,e,{configurable:!0,writable:!0,value:function(){return o(t(this))}})}return e}));var c,l="function"==typeof Object.create?Object.create:function(e){function t(){}return t.prototype=e,new t};if("function"==typeof Object.setPrototypeOf)c=Object.setPrototypeOf;else{var f;e:{var d={};try{d.__proto__={a:!0},f=d.a;break e}catch(Gt){}f=!1}c=f?function(e,t){if(e.__proto__=t,e.__proto__!==t)throw new TypeError(e+" is not extensible");return e}:null}var h=c;function p(e,t){if(e.prototype=l(t.prototype),e.prototype.constructor=e,h)h(e,t);else for(var n in t)if("prototype"!=n)if(Object.defineProperties){var r=Object.getOwnPropertyDescriptor(t,n);r&&Object.defineProperty(e,n,r)}else e[n]=t[n];e.na=t.prototype}function v(){this.l=!1,this.i=null,this.h=void 0,this.g=1,this.u=this.o=0,this.j=null}function m(e){if(e.l)throw new TypeError("Generator is already running");e.l=!0}function g(e,t){e.j={da:t,ea:!0},e.g=e.o||e.u}function y(e,t,n){return e.g=n,{value:t}}function b(e){this.g=new v,this.h=e}function x(e,t,n,r){try{var a=t.call(e.g.i,n);if(!(a instanceof Object))throw new TypeError("Iterator result "+a+" is not an object");if(!a.done)return e.g.l=!1,a;var i=a.value}catch(o){return e.g.i=null,g(e.g,o),w(e)}return e.g.i=null,r.call(e.g,i),w(e)}function w(e){for(;e.g.g;)try{var t=e.h(e.g);if(t)return e.g.l=!1,{value:t.value,done:!1}}catch(n){e.g.h=void 0,g(e.g,n)}if(e.g.l=!1,e.g.j){if(t=e.g.j,e.g.j=null,t.ea)throw t.da;return{value:t.return,done:!0}}return{value:void 0,done:!0}}function k(e){this.next=function(t){return m(e.g),e.g.i?t=x(e,e.g.i.next,t,e.g.s):(e.g.s(t),t=w(e)),t},this.throw=function(t){return m(e.g),e.g.i?t=x(e,e.g.i.throw,t,e.g.s):(g(e.g,t),t=w(e)),t},this.return=function(t){return function(e,t){m(e.g);var n=e.g.i;return n?x(e,"return"in n?n.return:function(e){return{value:e,done:!0}},t,e.g.return):(e.g.return(t),w(e))}(e,t)},this[Symbol.iterator]=function(){return this}}function _(e){return function(e){function t(t){return e.next(t)}function n(t){return e.throw(t)}return new Promise((function(r,a){!function e(i){i.done?r(i.value):Promise.resolve(i.value).then(t,n).then(e,a)}(e.next())}))}(new k(new b(e)))}v.prototype.s=function(e){this.h=e},v.prototype.return=function(e){this.j={return:e},this.g=this.u},i("Promise",(function(e){function t(e){this.h=0,this.i=void 0,this.g=[],this.s=!1;var t=this.j();try{e(t.resolve,t.reject)}catch(n){t.reject(n)}}function n(){this.g=null}function r(e){return e instanceof t?e:new t((function(t){t(e)}))}if(e)return e;n.prototype.h=function(e){if(null==this.g){this.g=[];var t=this;this.i((function(){t.l()}))}this.g.push(e)};var i=a.setTimeout;n.prototype.i=function(e){i(e,0)},n.prototype.l=function(){for(;this.g&&this.g.length;){var e=this.g;this.g=[];for(var t=0;t<e.length;++t){var n=e[t];e[t]=null;try{n()}catch(r){this.j(r)}}}this.g=null},n.prototype.j=function(e){this.i((function(){throw e}))},t.prototype.j=function(){function e(e){return function(r){n||(n=!0,e.call(t,r))}}var t=this,n=!1;return{resolve:e(this.D),reject:e(this.l)}},t.prototype.D=function(e){if(e===this)this.l(new TypeError("A Promise cannot resolve to itself"));else if(e instanceof t)this.H(e);else{e:switch(typeof e){case"object":var n=null!=e;break e;case"function":n=!0;break e;default:n=!1}n?this.A(e):this.o(e)}},t.prototype.A=function(e){var t=void 0;try{t=e.then}catch(n){return void this.l(n)}"function"==typeof t?this.I(t,e):this.o(e)},t.prototype.l=function(e){this.u(2,e)},t.prototype.o=function(e){this.u(1,e)},t.prototype.u=function(e,t){if(0!=this.h)throw Error("Cannot settle("+e+", "+t+"): Promise already settled in state"+this.h);this.h=e,this.i=t,2===this.h&&this.G(),this.B()},t.prototype.G=function(){var e=this;i((function(){if(e.C()){var t=a.console;"undefined"!==typeof t&&t.error(e.i)}}),1)},t.prototype.C=function(){if(this.s)return!1;var e=a.CustomEvent,t=a.Event,n=a.dispatchEvent;return"undefined"===typeof n||("function"===typeof e?e=new e("unhandledrejection",{cancelable:!0}):"function"===typeof t?e=new t("unhandledrejection",{cancelable:!0}):(e=a.document.createEvent("CustomEvent")).initCustomEvent("unhandledrejection",!1,!0,e),e.promise=this,e.reason=this.i,n(e))},t.prototype.B=function(){if(null!=this.g){for(var e=0;e<this.g.length;++e)o.h(this.g[e]);this.g=null}};var o=new n;return t.prototype.H=function(e){var t=this.j();e.M(t.resolve,t.reject)},t.prototype.I=function(e,t){var n=this.j();try{e.call(t,n.resolve,n.reject)}catch(r){n.reject(r)}},t.prototype.then=function(e,n){function r(e,t){return"function"==typeof e?function(t){try{a(e(t))}catch(n){i(n)}}:t}var a,i,o=new t((function(e,t){a=e,i=t}));return this.M(r(e,a),r(n,i)),o},t.prototype.catch=function(e){return this.then(void 0,e)},t.prototype.M=function(e,t){function n(){switch(r.h){case 1:e(r.i);break;case 2:t(r.i);break;default:throw Error("Unexpected state: "+r.h)}}var r=this;null==this.g?o.h(n):this.g.push(n),this.s=!0},t.resolve=r,t.reject=function(e){return new t((function(t,n){n(e)}))},t.race=function(e){return new t((function(t,n){for(var a=u(e),i=a.next();!i.done;i=a.next())r(i.value).M(t,n)}))},t.all=function(e){var n=u(e),a=n.next();return a.done?r([]):new t((function(e,t){function i(t){return function(n){o[t]=n,0==--u&&e(o)}}var o=[],u=0;do{o.push(void 0),u++,r(a.value).M(i(o.length-1),t),a=n.next()}while(!a.done)}))},t}));var S="function"==typeof Object.assign?Object.assign:function(e,t){for(var n=1;n<arguments.length;n++){var r=arguments[n];if(r)for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e};i("Object.assign",(function(e){return e||S})),i("Object.is",(function(e){return e||function(e,t){return e===t?0!==e||1/e===1/t:e!==e&&t!==t}})),i("Array.prototype.includes",(function(e){return e||function(e,t){var n=this;n instanceof String&&(n=String(n));var r=n.length;for(0>(t=t||0)&&(t=Math.max(t+r,0));t<r;t++){var a=n[t];if(a===e||Object.is(a,e))return!0}return!1}})),i("String.prototype.includes",(function(e){return e||function(e,t){if(null==this)throw new TypeError("The 'this' value for String.prototype.includes must not be null or undefined");if(e instanceof RegExp)throw new TypeError("First argument to String.prototype.includes must not be a regular expression");return-1!==this.indexOf(e,t||0)}})),i("Array.prototype.keys",(function(e){return e||function(){return function(e,t){e instanceof String&&(e+="");var n=0,r=!1,a={next:function(){if(!r&&n<e.length){var a=n++;return{value:t(a,e[a]),done:!1}}return r=!0,{done:!0,value:void 0}}};return a[Symbol.iterator]=function(){return a},a}(this,(function(e){return e}))}}));var C=this||self;function A(e,t){e=e.split(".");var n,r=C;e[0]in r||"undefined"==typeof r.execScript||r.execScript("var "+e[0]);for(;e.length&&(n=e.shift());)e.length||void 0===t?r=r[n]&&r[n]!==Object.prototype[n]?r[n]:r[n]={}:r[n]=t}function E(){throw Error("Invalid UTF8")}function N(e,t){return t=String.fromCharCode.apply(null,t),null==e?t:e+t}var T,I,D="undefined"!==typeof TextDecoder,F="undefined"!==typeof TextEncoder,M={},O=null;function R(e){var t;void 0===t&&(t=0),B(),t=M[t];for(var n=Array(Math.floor(e.length/3)),r=t[64]||"",a=0,i=0;a<e.length-2;a+=3){var o=e[a],u=e[a+1],s=e[a+2],c=t[o>>2];o=t[(3&o)<<4|u>>4],u=t[(15&u)<<2|s>>6],s=t[63&s],n[i++]=c+o+u+s}switch(c=0,s=r,e.length-a){case 2:s=t[(15&(c=e[a+1]))<<2]||r;case 1:e=e[a],n[i]=t[e>>2]+t[(3&e)<<4|c>>4]+s+r}return n.join("")}function j(e){var t=e.length,n=3*t/4;n%3?n=Math.floor(n):-1!="=.".indexOf(e[t-1])&&(n=-1!="=.".indexOf(e[t-2])?n-2:n-1);var r=new Uint8Array(n),a=0;return function(e,t){function n(t){for(;r<e.length;){var n=e.charAt(r++),a=O[n];if(null!=a)return a;if(!/^[\s\xa0]*$/.test(n))throw Error("Unknown base64 encoding at char: "+n)}return t}B();for(var r=0;;){var a=n(-1),i=n(0),o=n(64),u=n(64);if(64===u&&-1===a)break;t(a<<2|i>>4),64!=o&&(t(i<<4&240|o>>2),64!=u&&t(o<<6&192|u))}}(e,(function(e){r[a++]=e})),a!==n?r.subarray(0,a):r}function B(){if(!O){O={};for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".split(""),t=["+/=","+/","-_=","-_.","-_"],n=0;5>n;n++){var r=e.concat(t[n].split(""));M[n]=r;for(var a=0;a<r.length;a++){var i=r[a];void 0===O[i]&&(O[i]=a)}}}}var z,Z="function"===typeof Uint8Array;function L(e){return Z&&null!=e&&e instanceof Uint8Array}function P(e){if(this.L=e,null!==e&&0===e.length)throw Error("ByteString should be constructed with non-empty values")}var U="function"===typeof Uint8Array.prototype.slice,W=0;function V(e,t){return Error("Invalid wire type: "+e+" (at position "+t+")")}function q(){return Error("Failed to read varint, encoding is invalid.")}function G(e,t){t=void 0!==(t=void 0===t?{}:t).v&&t.v,this.h=null,this.g=this.i=this.j=0,this.v=t,e&&H(this,e)}function H(e,t){e.h=function(e,t){if(e.constructor===Uint8Array)return e;if(e.constructor===ArrayBuffer)return new Uint8Array(e);if(e.constructor===Array)return new Uint8Array(e);if(e.constructor===String)return j(e);if(e.constructor===P)return!t&&(t=e.L)&&t.constructor===Uint8Array?t:(t=null==(t=e.L)||L(t)?t:"string"===typeof t?j(t):null,(e=e.L=t)?new Uint8Array(e):z||(z=new Uint8Array(0)));if(e instanceof Uint8Array)return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw Error("Type not convertible to a Uint8Array, expected a Uint8Array, an ArrayBuffer, a base64 encoded string, or Array of numbers")}(t,e.v),e.j=0,e.i=e.h.length,e.g=e.j}function X(e){if(e.g>e.i)throw Error("Tried to read past the end of the data "+e.g+" > "+e.i)}function K(e){var t=e.h,n=t[e.g],r=127&n;if(128>n)return e.g+=1,X(e),r;if(r|=(127&(n=t[e.g+1]))<<7,128>n)return e.g+=2,X(e),r;if(r|=(127&(n=t[e.g+2]))<<14,128>n)return e.g+=3,X(e),r;if(r|=(127&(n=t[e.g+3]))<<21,128>n)return e.g+=4,X(e),r;if(n=t[e.g+4],e.g+=5,r|=(15&n)<<28,128>n)return X(e),r;if(128<=t[e.g++]&&128<=t[e.g++]&&128<=t[e.g++]&&128<=t[e.g++]&&128<=t[e.g++])throw q();return X(e),r}G.prototype.reset=function(){this.g=this.j};var Y=[];function $(){this.g=[]}function Q(e,t){for(;127<t;)e.g.push(127&t|128),t>>>=7;e.g.push(t)}function J(e){var t={},n=void 0!==t.W&&t.W;this.l={v:void 0!==t.v&&t.v},this.W=n,t=this.l,Y.length?(n=Y.pop(),t&&(n.v=t.v),e&&H(n,e),e=n):e=new G(e,t),this.g=e,this.j=this.g.g,this.h=this.i=-1}function ee(e){var t=e.g;if(t.g==t.i)return!1;e.j=e.g.g;var n=K(e.g)>>>0;if(t=n>>>3,!(0<=(n&=7)&&5>=n))throw V(n,e.j);if(1>t)throw Error("Invalid field number: "+t+" (at position "+e.j+")");return e.i=t,e.h=n,!0}function te(e){switch(e.h){case 0:if(0!=e.h)te(e);else e:{for(var t=(e=e.g).g,n=t+10;t<n;)if(0===(128&e.h[t++])){e.g=t,X(e);break e}throw q()}break;case 1:(e=e.g).g+=8,X(e);break;case 2:2!=e.h?te(e):(t=K(e.g)>>>0,(e=e.g).g+=t,X(e));break;case 5:(e=e.g).g+=4,X(e);break;case 3:for(t=e.i;;){if(!ee(e))throw Error("Unmatched start-group tag: stream EOF");if(4==e.h){if(e.i!=t)throw Error("Unmatched end-group tag");break}te(e)}break;default:throw V(e.h,e.j)}}$.prototype.length=function(){return this.g.length},$.prototype.end=function(){var e=this.g;return this.g=[],e},J.prototype.reset=function(){this.g.reset(),this.j=this.g.g,this.h=this.i=-1};var ne=[];function re(){this.i=[],this.h=0,this.g=new $}function ae(e,t){0!==t.length&&(e.i.push(t),e.h+=t.length)}var ie="function"===typeof Symbol&&"symbol"===typeof Symbol()?Symbol(void 0):void 0;function oe(e,t){Object.isFrozen(e)||(ie?e[ie]|=t:void 0!==e.N?e.N|=t:Object.defineProperties(e,{N:{value:t,configurable:!0,writable:!0,enumerable:!1}}))}function ue(e){var t;return null==(t=ie?e[ie]:e.N)?0:t}function se(e){return oe(e,1),e}function ce(e){return!!Array.isArray(e)&&!!(2&ue(e))}function le(e){if(!Array.isArray(e))throw Error("cannot mark non-array as immutable");oe(e,2)}function fe(e){return null!==e&&"object"===typeof e&&!Array.isArray(e)&&e.constructor===Object}var de=Object.freeze(se([]));function he(e){if(ce(e.m))throw Error("Cannot mutate an immutable Message")}var pe,ve="undefined"!=typeof Symbol&&"undefined"!=typeof Symbol.hasInstance;function me(e){return{value:e,configurable:!1,writable:!1,enumerable:!1}}function ge(e,t,n){return-1===t?null:t>=e.i?e.g?e.g[t]:void 0:void 0!==n&&n&&e.g&&null!=(n=e.g[t])?n:e.m[t+e.h]}function ye(e,t,n,r){r=void 0!==r&&r,he(e),t<e.i&&!r?e.m[t+e.h]=n:(e.g||(e.g=e.m[e.i+e.h]={}))[t]=n}function be(e,t,n,r){n=void 0===n||n;var a=ge(e,t,r=void 0!==r&&r);return null==a&&(a=de),ce(e.m)?n&&(le(a),Object.freeze(a)):(a===de||ce(a))&&ye(e,t,a=se(a.slice()),r),a}function xe(e,t,n){return null==(e=null==(e=ge(e,t))?e:+e)?void 0===n?0:n:e}function we(e,t,n,r){e.j||(e.j={});var a=ce(e.m),i=e.j[n];if(!i){r=be(e,n,!0,void 0!==r&&r),i=[],a=a||ce(r);for(var o=0;o<r.length;o++)i[o]=new t(r[o]),a&&le(i[o].m);a&&(le(i),Object.freeze(i)),e.j[n]=i}return i}function ke(e,t,n,r,a){var i=void 0!==i&&i;return he(e),i=we(e,n,t,i),n=r||new n,e=be(e,t),void 0!=a?(i.splice(a,0,n),e.splice(a,0,n.m)):(i.push(n),e.push(n.m)),n}function _e(e,t){return null==(e=ge(e,t))?0:e}function Se(e,t){return null==(e=ge(e,t))?"":e}function Ce(e){var t=Ne;return Ee(e,t=void 0===t?Te:t)}function Ae(e,t){if(null!=e){if(Array.isArray(e))e=Ee(e,t);else if(fe(e)){var n,r={};for(n in e)r[n]=Ae(e[n],t);e=r}else e=t(e);return e}}function Ee(e,t){for(var n=e.slice(),r=0;r<n.length;r++)n[r]=Ae(n[r],t);return Array.isArray(e)&&1&ue(e)&&se(n),n}function Ne(e){return e&&"object"==typeof e&&e.toJSON?e.toJSON():(e=function(e){switch(typeof e){case"number":return isFinite(e)?e:String(e);case"object":if(e&&!Array.isArray(e)){if(L(e))return R(e);if(e instanceof P){var t=e.L;return t=null==t||"string"===typeof t?t:Z&&t instanceof Uint8Array?R(t):null,(e.L=t)||""}}}return e}(e),Array.isArray(e)?Ce(e):e)}function Te(e){return L(e)?new Uint8Array(e):e}function Ie(e,t,n){e||(e=pe),pe=null;var r=this.constructor.h;if(e||(e=r?[r]:[]),this.h=(r?0:-1)-(this.constructor.g||0),this.j=void 0,this.m=e,e=(r=this.m.length)-1,r&&fe(r=this.m[e])?(this.i=e-this.h,this.g=r):void 0!==t&&-1<t?(this.i=Math.max(t,e+1-this.h),this.g=void 0):this.i=Number.MAX_VALUE,n)for(t=0;t<n.length;t++)if((e=n[t])<this.i)e+=this.h,(r=this.m[e])?Array.isArray(r)&&se(r):this.m[e]=de;else{var a=(r=this.g||(this.g=this.m[this.i+this.h]={}))[e];a?Array.isArray(a)&&se(a):r[e]=de}}function De(){Ie.apply(this,arguments)}if(Ie.prototype.toJSON=function(){return Ce(this.m)},Ie.prototype.toString=function(){return this.m.toString()},p(De,Ie),ve){var Fe={};Object.defineProperties(De,(Fe[Symbol.hasInstance]=me((function(){throw Error("Cannot perform instanceof checks for MutableMessage")})),Fe))}function Me(e,t,n){if(n){var r,a={};for(r in n){var i=n[r],o=i.ha;o||(a.F=i.la||i.fa.P,i.aa?(a.U=Le(i.aa),o=function(e){return function(t,n,r){return e.F(t,n,r,e.U)}}(a)):i.ca?(a.T=Pe(i.X.g,i.ca),o=function(e){return function(t,n,r){return e.F(t,n,r,e.T)}}(a)):o=a.F,i.ha=o),o(t,e,i.X),a={F:a.F,U:a.U,T:a.T}}}!function(e,t){if(t=t.ba){ae(e,e.g.end());for(var n=0;n<t.length;n++)ae(e,t[n])}}(t,e)}var Oe=Symbol();function Re(e,t,n){return e[Oe]||(e[Oe]=function(e,r){return t(e,r,n)})}function je(e){var t=e[Oe];if(!t){var n=Je(e);t=function(e,t){return et(e,t,n)},e[Oe]=t}return t}function Be(e){var t=function(e){var t=e.aa;return t?je(t):(t=e.ka)?Re(e.X.g,t,e.ca):void 0}(e),n=e.X,r=e.fa.O;return t?function(e,a){return r(e,a,n,t)}:function(e,t){return r(e,t,n)}}function ze(e,t,n,r,a,i){var o=0;for((e=e()).length&&"number"!==typeof e[0]&&(n(t,e[0]),o++);o<e.length;){n=e[o++];for(var u=o+1;u<e.length&&"number"!==typeof e[u];)u++;var s=e[o++];switch(u-=o){case 0:r(t,n,s);break;case 1:r(t,n,s,e[o++]);break;case 2:a(t,n,s,e[o++],e[o++]);break;case 3:u=e[o++];var c=e[o++],l=e[o++];Array.isArray(l)?a(t,n,s,u,c,l):i(t,n,s,u,c,l);break;case 4:i(t,n,s,e[o++],e[o++],e[o++],e[o++]);break;default:throw Error("unexpected number of binary field arguments: "+u)}}return t}var Ze=Symbol();function Le(e){var t=e[Ze];if(!t){var n=He(e);t=function(e,t){return nt(e,t,n)},e[Ze]=t}return t}function Pe(e,t){var n=e[Ze];return n||(n=function(e,n){return Me(e,n,t)},e[Ze]=n),n}var Ue=Symbol();function We(e,t){e.push(t)}function Ve(e,t,n){e.push(t,n.P)}function qe(e,t,n,r,a){var i=Le(a),o=n.P;e.push(t,(function(e,t,n){return o(e,t,n,r,i)}))}function Ge(e,t,n,r,a,i){var o=Pe(r,i),u=n.P;e.push(t,(function(e,t,n){return u(e,t,n,r,o)}))}function He(e){var t=e[Ue];return t||ze(e,e[Ue]=[],We,Ve,qe,Ge)}var Xe=Symbol();function Ke(e,t){e[0]=t}function Ye(e,t,n,r){var a=n.O;e[t]=r?function(e,t,n){return a(e,t,n,r)}:a}function $e(e,t,n,r,a,i){var o=n.O,u=je(a);e[t]=function(e,t,n){return o(e,t,n,r,u,i)}}function Qe(e,t,n,r,a,i,o){var u=n.O,s=Re(r,a,i);e[t]=function(e,t,n){return u(e,t,n,r,s,o)}}function Je(e){var t=e[Xe];return t||ze(e,e[Xe]={},Ke,Ye,$e,Qe)}function et(e,t,n){for(;ee(t)&&4!=t.h;){var r=t.i,a=n[r];if(!a){var i=n[0];i&&(i=i[r])&&(a=n[r]=Be(i))}if((!a||!a(t,e,r))&&(r=e,i=(a=t).j,te(a),!a.W)){var o=a.g.h;a=i===(a=a.g.g)?z||(z=new Uint8Array(0)):U?o.slice(i,a):new Uint8Array(o.subarray(i,a)),(i=r.ba)?i.push(a):r.ba=[a]}}return e}function tt(e,t,n){if(ne.length){var r=ne.pop();e&&(H(r.g,e),r.i=-1,r.h=-1),e=r}else e=new J(e);try{return et(new t,e,Je(n))}finally{(t=e.g).h=null,t.j=0,t.i=0,t.g=0,t.v=!1,e.i=-1,e.h=-1,100>ne.length&&ne.push(e)}}function nt(e,t,n){for(var r=n.length,a=1==r%2,i=a?1:0;i<r;i+=2)(0,n[i+1])(t,e,n[i]);Me(e,t,a?n[0]:void 0)}function rt(e,t){var n=new re;nt(e,n,He(t)),ae(n,n.g.end()),e=new Uint8Array(n.h);for(var r=(t=n.i).length,a=0,i=0;i<r;i++){var o=t[i];e.set(o,a),a+=o.length}return n.i=[e],e}function at(e,t){return{O:e,P:t}}var it=at((function(e,t,n){if(5!==e.h)return!1;var r=(e=e.g).h[e.g],a=e.h[e.g+1],i=e.h[e.g+2],o=e.h[e.g+3];return e.g+=4,X(e),e=2*((a=(r<<0|a<<8|i<<16|o<<24)>>>0)>>31)+1,r=a>>>23&255,a&=8388607,ye(t,n,255==r?a?NaN:1/0*e:0==r?e*Math.pow(2,-149)*a:e*Math.pow(2,r-150)*(a+Math.pow(2,23))),!0}),(function(e,t,n){if(null!=(t=ge(t,n))){Q(e.g,8*n+5),e=e.g;var r=t;0===(r=(n=0>r?1:0)?-r:r)?0<1/r?W=0:(0,W=2147483648):isNaN(r)?(0,W=2147483647):34028234663852886e22<r?(0,W=(n<<31|2139095040)>>>0):11754943508222875e-54>r?(r=Math.round(r/Math.pow(2,-149)),0,W=(n<<31|r)>>>0):(t=Math.floor(Math.log(r)/Math.LN2),r*=Math.pow(2,-t),16777216<=(r=Math.round(8388608*r))&&++t,0,W=(n<<31|t+127<<23|8388607&r)>>>0),n=W,e.g.push(n>>>0&255),e.g.push(n>>>8&255),e.g.push(n>>>16&255),e.g.push(n>>>24&255)}})),ot=at((function(e,t,n){if(0!==e.h)return!1;for(var r=e.g,a=128,i=0,o=e=0;4>o&&128<=a;o++)a=r.h[r.g++],X(r),i|=(127&a)<<7*o;if(128<=a&&(a=r.h[r.g++],X(r),i|=(127&a)<<28,e|=(127&a)>>4),128<=a)for(o=0;5>o&&128<=a;o++)a=r.h[r.g++],X(r),e|=(127&a)<<7*o+3;if(!(128>a))throw q();return r=i>>>0,(e=2147483648&(a=e>>>0))&&(a=~a>>>0,0==(r=1+~r>>>0)&&(a=a+1>>>0)),r=4294967296*a+(r>>>0),ye(t,n,e?-r:r),!0}),(function(e,t,n){if(null!=(t=ge(t,n))&&null!=t){Q(e.g,8*n),e=e.g;var r=t;for(n=0>r,t=(r=Math.abs(r))>>>0,r=Math.floor((r-t)/4294967296),r>>>=0,n&&(r=~r>>>0,4294967295<(t=1+(~t>>>0))&&(t=0,4294967295<++r&&(r=0))),n=W=t,t=r;0<t||127<n;)e.g.push(127&n|128),n=(n>>>7|t<<25)>>>0,t>>>=7;e.g.push(n)}})),ut=at((function(e,t,n){return 0===e.h&&(ye(t,n,K(e.g)),!0)}),(function(e,t,n){if(null!=(t=ge(t,n))&&null!=t)if(Q(e.g,8*n),e=e.g,0<=(n=t))Q(e,n);else{for(t=0;9>t;t++)e.g.push(127&n|128),n>>=7;e.g.push(1)}})),st=at((function(e,t,n){if(2!==e.h)return!1;var r,a=K(e.g)>>>0,i=(e=e.g).g;if(e.g+=a,X(e),e=e.h,D)(r=T)||(r=T=new TextDecoder("utf-8",{fatal:!0})),r=r.decode(e.subarray(i,i+a));else{a=i+a;for(var o,u,s,c=[],l=null;i<a;)128>(o=e[i++])?c.push(o):224>o?i>=a?E():(u=e[i++],194>o||128!==(192&u)?(i--,E()):c.push((31&o)<<6|63&u)):240>o?i>=a-1?E():128!==(192&(u=e[i++]))||224===o&&160>u||237===o&&160<=u||128!==(192&(r=e[i++]))?(i--,E()):c.push((15&o)<<12|(63&u)<<6|63&r):244>=o?i>=a-2?E():128!==(192&(u=e[i++]))||0!==u-144+(o<<28)>>30||128!==(192&(r=e[i++]))||128!==(192&(s=e[i++]))?(i--,E()):(o=(7&o)<<18|(63&u)<<12|(63&r)<<6|63&s,o-=65536,c.push(55296+(o>>10&1023),56320+(1023&o))):E(),8192<=c.length&&(l=N(l,c),c.length=0);r=N(l,c)}return ye(t,n,r),!0}),(function(e,t,n){if(null!=(t=ge(t,n))){var r=!1;if(r=void 0!==r&&r,F){if(r&&/(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])/.test(t))throw Error("Found an unpaired surrogate");t=(I||(I=new TextEncoder)).encode(t)}else{for(var a=0,i=new Uint8Array(3*t.length),o=0;o<t.length;o++){var u=t.charCodeAt(o);if(128>u)i[a++]=u;else{if(2048>u)i[a++]=u>>6|192;else{if(55296<=u&&57343>=u){if(56319>=u&&o<t.length){var s=t.charCodeAt(++o);if(56320<=s&&57343>=s){u=1024*(u-55296)+s-56320+65536,i[a++]=u>>18|240,i[a++]=u>>12&63|128,i[a++]=u>>6&63|128,i[a++]=63&u|128;continue}o--}if(r)throw Error("Found an unpaired surrogate");u=65533}i[a++]=u>>12|224,i[a++]=u>>6&63|128}i[a++]=63&u|128}}t=i.subarray(0,a)}Q(e.g,8*n+2),Q(e.g,t.length),ae(e,e.g.end()),ae(e,t)}})),ct=at((function(e,t,n,r,a){if(2!==e.h)return!1;t=ke(t,n,r),n=e.g.i,r=K(e.g)>>>0;var i=e.g.g+r,o=i-n;if(0>=o&&(e.g.i=i,a(t,e),o=i-e.g.g),o)throw Error("Message parsing ended unexpectedly. Expected to read "+r+" bytes, instead read "+(r-o)+" bytes, either the data ended unexpectedly or the message misreported its own length");return e.g.g=i,e.g.i=n,!0}),(function(e,t,n,r,a){if(null!=(t=we(t,r,n)))for(r=0;r<t.length;r++){var i=e;Q(i.g,8*n+2);var o=i.g.end();ae(i,o),o.push(i.h),i=o,a(t[r],e),o=e;var u=i.pop();for(u=o.h+o.g.length()-u;127<u;)i.push(127&u|128),u>>>=7,o.h++;i.push(u),o.h++}}));function lt(){De.apply(this,arguments)}if(p(lt,De),ve){var ft={};Object.defineProperties(lt,(ft[Symbol.hasInstance]=me(Object[Symbol.hasInstance]),ft))}function dt(e){lt.call(this,e)}function ht(){return[1,ut,2,it,3,st,4,st]}function pt(e){lt.call(this,e,-1,mt)}function vt(){return[1,ct,dt,ht]}p(dt,lt),p(pt,lt),pt.prototype.addClassification=function(e,t){return ke(this,1,dt,e,t),this};var mt=[1];function gt(e){lt.call(this,e)}function yt(){return[1,it,2,it,3,it,4,it,5,it]}function bt(e){lt.call(this,e,-1,wt)}function xt(){return[1,ct,gt,yt]}p(gt,lt),p(bt,lt);var wt=[1];function kt(e){lt.call(this,e)}function _t(){return[1,it,2,it,3,it,4,it,5,it,6,ot]}p(kt,lt);var St=[[61,146],[146,91],[91,181],[181,84],[84,17],[17,314],[314,405],[405,321],[321,375],[375,291],[61,185],[185,40],[40,39],[39,37],[37,0],[0,267],[267,269],[269,270],[270,409],[409,291],[78,95],[95,88],[88,178],[178,87],[87,14],[14,317],[317,402],[402,318],[318,324],[324,308],[78,191],[191,80],[80,81],[81,82],[82,13],[13,312],[312,311],[311,310],[310,415],[415,308]],Ct=[[263,249],[249,390],[390,373],[373,374],[374,380],[380,381],[381,382],[382,362],[263,466],[466,388],[388,387],[387,386],[386,385],[385,384],[384,398],[398,362]],At=[[276,283],[283,282],[282,295],[295,285],[300,293],[293,334],[334,296],[296,336]],Et=[[33,7],[7,163],[163,144],[144,145],[145,153],[153,154],[154,155],[155,133],[33,246],[246,161],[161,160],[160,159],[159,158],[158,157],[157,173],[173,133]],Nt=[[46,53],[53,52],[52,65],[65,55],[70,63],[63,105],[105,66],[66,107]],Tt=[[10,338],[338,297],[297,332],[332,284],[284,251],[251,389],[389,356],[356,454],[454,323],[323,361],[361,288],[288,397],[397,365],[365,379],[379,378],[378,400],[400,377],[377,152],[152,148],[148,176],[176,149],[149,150],[150,136],[136,172],[172,58],[58,132],[132,93],[93,234],[234,127],[127,162],[162,21],[21,54],[54,103],[103,67],[67,109],[109,10]],It=[].concat(s(St),s(Ct),s(At),s(Et),s(Nt),s(Tt));function Dt(e,t,n){if(n=e.createShader(0===n?e.VERTEX_SHADER:e.FRAGMENT_SHADER),e.shaderSource(n,t),e.compileShader(n),!e.getShaderParameter(n,e.COMPILE_STATUS))throw Error("Could not compile WebGL shader.\n\n"+e.getShaderInfoLog(n));return n}function Ft(e){return we(e,dt,1).map((function(e){return{index:_e(e,1),ga:xe(e,2),label:null!=ge(e,3)?Se(e,3):void 0,displayName:null!=ge(e,4)?Se(e,4):void 0}}))}function Mt(e){return{x:xe(e,1),y:xe(e,2),z:xe(e,3),visibility:null!=ge(e,4)?xe(e,4):void 0}}function Ot(e,t){this.h=e,this.g=t,this.l=0}function Rt(e,t,n){return function(e,t){var n=e.g;if(void 0===e.o){var r=Dt(n,"\n  attribute vec2 aVertex;\n  attribute vec2 aTex;\n  varying vec2 vTex;\n  void main(void) {\n    gl_Position = vec4(aVertex, 0.0, 1.0);\n    vTex = aTex;\n  }",0),a=Dt(n,"\n  precision mediump float;\n  varying vec2 vTex;\n  uniform sampler2D sampler0;\n  void main(){\n    gl_FragColor = texture2D(sampler0, vTex);\n  }",1),i=n.createProgram();if(n.attachShader(i,r),n.attachShader(i,a),n.linkProgram(i),!n.getProgramParameter(i,n.LINK_STATUS))throw Error("Could not compile WebGL program.\n\n"+n.getProgramInfoLog(i));r=e.o=i,n.useProgram(r),a=n.getUniformLocation(r,"sampler0"),e.j={K:n.getAttribLocation(r,"aVertex"),J:n.getAttribLocation(r,"aTex"),ma:a},e.u=n.createBuffer(),n.bindBuffer(n.ARRAY_BUFFER,e.u),n.enableVertexAttribArray(e.j.K),n.vertexAttribPointer(e.j.K,2,n.FLOAT,!1,0,0),n.bufferData(n.ARRAY_BUFFER,new Float32Array([-1,-1,-1,1,1,1,1,-1]),n.STATIC_DRAW),n.bindBuffer(n.ARRAY_BUFFER,null),e.s=n.createBuffer(),n.bindBuffer(n.ARRAY_BUFFER,e.s),n.enableVertexAttribArray(e.j.J),n.vertexAttribPointer(e.j.J,2,n.FLOAT,!1,0,0),n.bufferData(n.ARRAY_BUFFER,new Float32Array([0,1,0,0,1,0,1,1]),n.STATIC_DRAW),n.bindBuffer(n.ARRAY_BUFFER,null),n.uniform1i(a,0)}r=e.j,n.useProgram(e.o),n.canvas.width=t.width,n.canvas.height=t.height,n.viewport(0,0,t.width,t.height),n.activeTexture(n.TEXTURE0),e.h.bindTexture2d(t.glName),n.enableVertexAttribArray(r.K),n.bindBuffer(n.ARRAY_BUFFER,e.u),n.vertexAttribPointer(r.K,2,n.FLOAT,!1,0,0),n.enableVertexAttribArray(r.J),n.bindBuffer(n.ARRAY_BUFFER,e.s),n.vertexAttribPointer(r.J,2,n.FLOAT,!1,0,0),n.bindFramebuffer(n.DRAW_FRAMEBUFFER?n.DRAW_FRAMEBUFFER:n.FRAMEBUFFER,null),n.clearColor(0,0,0,0),n.clear(n.COLOR_BUFFER_BIT),n.colorMask(!0,!0,!0,!0),n.drawArrays(n.TRIANGLE_FAN,0,4),n.disableVertexAttribArray(r.K),n.disableVertexAttribArray(r.J),n.bindBuffer(n.ARRAY_BUFFER,null),e.h.bindTexture2d(0)}(e,t),"function"===typeof e.g.canvas.transferToImageBitmap?Promise.resolve(e.g.canvas.transferToImageBitmap()):n?Promise.resolve(e.g.canvas):"function"===typeof createImageBitmap?createImageBitmap(e.g.canvas):(void 0===e.i&&(e.i=document.createElement("canvas")),new Promise((function(t){e.i.height=e.g.canvas.height,e.i.width=e.g.canvas.width,e.i.getContext("2d",{}).drawImage(e.g.canvas,0,0,e.g.canvas.width,e.g.canvas.height),t(e.i)})))}function jt(e){this.g=e}var Bt=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,9,1,7,0,65,0,253,15,26,11]);function zt(e,t){return t+e}function Zt(e,t){window[e]=t}function Lt(e){if(this.g=e,this.listeners={},this.j={},this.H={},this.o={},this.u={},this.I=this.s=this.Z=!0,this.D=Promise.resolve(),this.Y="",this.C={},this.locateFile=e&&e.locateFile||zt,"object"===typeof window)var t=window.location.pathname.toString().substring(0,window.location.pathname.toString().lastIndexOf("/"))+"/";else{if("undefined"===typeof location)throw Error("solutions can only be loaded on a web page or in a web worker");t=location.pathname.toString().substring(0,location.pathname.toString().lastIndexOf("/"))+"/"}if(this.$=t,e.options)for(var n=(t=u(Object.keys(e.options))).next();!n.done;n=t.next()){n=n.value;var r=e.options[n].default;void 0!==r&&(this.j[n]="function"===typeof r?r():r)}}function Pt(e){var t,n,r,a,i,o,u,c,l,f,d;return _((function(h){switch(h.g){case 1:return e.Z?(t=void 0===e.g.files?[]:"function"===typeof e.g.files?e.g.files(e.j):e.g.files,y(h,_((function(e){switch(e.g){case 1:return e.o=2,y(e,WebAssembly.instantiate(Bt),4);case 4:e.g=3,e.o=0;break;case 2:return e.o=0,e.j=null,e.return(!1);case 3:return e.return(!0)}})),2)):h.return();case 2:if(n=h.h,"object"===typeof window)return Zt("createMediapipeSolutionsWasm",{locateFile:e.locateFile}),Zt("createMediapipeSolutionsPackedAssets",{locateFile:e.locateFile}),o=t.filter((function(e){return void 0!==e.data})),u=t.filter((function(e){return void 0===e.data})),c=Promise.all(o.map((function(t){var n=Ut(e,t.url);if(void 0!==t.path){var r=t.path;n=n.then((function(t){return e.overrideFile(r,t),Promise.resolve(t)}))}return n}))),l=Promise.all(u.map((function(t){return void 0===t.simd||t.simd&&n||!t.simd&&!n?function(e){var t=document.createElement("script");return t.setAttribute("src",e),t.setAttribute("crossorigin","anonymous"),new Promise((function(e){t.addEventListener("load",(function(){e()}),!1),t.addEventListener("error",(function(){e()}),!1),document.body.appendChild(t)}))}(e.locateFile(t.url,e.$)):Promise.resolve()}))).then((function(){var t,n,r;return _((function(a){if(1==a.g)return t=window.createMediapipeSolutionsWasm,n=window.createMediapipeSolutionsPackedAssets,r=e,y(a,t(n),2);r.h=a.h,a.g=0}))})),f=_((function(t){return e.g.graph&&e.g.graph.url?t=y(t,Ut(e,e.g.graph.url),0):(t.g=0,t=void 0),t})),y(h,Promise.all([l,c,f]),7);if("function"!==typeof importScripts)throw Error("solutions can only be loaded on a web page or in a web worker");return r=t.filter((function(e){return void 0===e.simd||e.simd&&n||!e.simd&&!n})).map((function(t){return e.locateFile(t.url,e.$)})),importScripts.apply(null,s(r)),a=e,y(h,createMediapipeSolutionsWasm(Module),6);case 6:a.h=h.h,e.l=new OffscreenCanvas(1,1),e.h.canvas=e.l,i=e.h.GL.createContext(e.l,{antialias:!1,alpha:!1,ja:"undefined"!==typeof WebGL2RenderingContext?2:1}),e.h.GL.makeContextCurrent(i),h.g=4;break;case 7:if(e.l=document.createElement("canvas"),!(d=e.l.getContext("webgl2",{}))&&!(d=e.l.getContext("webgl",{})))return alert("Failed to create WebGL canvas context when passing video frame."),h.return();e.G=d,e.h.canvas=e.l,e.h.createContext(e.l,!0,!0,{});case 4:e.i=new e.h.SolutionWasm,e.Z=!1,h.g=0}}))}function Ut(e,t){var n,r;return _((function(a){return t in e.H?a.return(e.H[t]):(n=e.locateFile(t,""),r=fetch(n).then((function(e){return e.arrayBuffer()})),e.H[t]=r,a.return(r))}))}function Wt(e,t,n){var r,a,i,o,s,c,l,f,d,h,p,v,m,g;return _((function(b){switch(b.g){case 1:if(!n)return b.return(t);for(r={},a=0,i=u(Object.keys(n)),o=i.next();!o.done;o=i.next())s=o.value,"string"!==typeof(c=n[s])&&"texture"===c.type&&void 0!==t[c.stream]&&++a;1<a&&(e.I=!1),l=u(Object.keys(n)),o=l.next();case 2:if(o.done){b.g=4;break}if(f=o.value,"string"===typeof(d=n[f]))return m=r,g=f,y(b,function(e,t,n){var r;return _((function(a){return"number"===typeof n||n instanceof Uint8Array||n instanceof e.h.Uint8BlobList?a.return(n):n instanceof e.h.Texture2dDataOut?((r=e.u[t])||(r=new Ot(e.h,e.G),e.u[t]=r),a.return(Rt(r,n,e.I))):a.return(void 0)}))}(e,f,t[d]),14);if(h=t[d.stream],"detection_list"===d.type){if(h){for(var x=h.getRectList(),w=h.getLandmarksList(),k=h.getClassificationsList(),S=[],C=0;C<x.size();++C){var A=tt(x.get(C),kt,_t);A={boundingBox:{xCenter:xe(A,1),yCenter:xe(A,2),height:xe(A,3),width:xe(A,4),rotation:xe(A,5,0),rectId:_e(A,6)},landmarks:we(tt(w.get(C),bt,xt),gt,1).map(Mt),V:Ft(tt(k.get(C),pt,vt))},S.push(A)}x=S}else x=[];r[f]=x,b.g=7;break}if("proto_list"===d.type){if(h){for(x=Array(h.size()),w=0;w<h.size();w++)x[w]=h.get(w);h.delete()}else x=[];r[f]=x,b.g=7;break}if(void 0===h){b.g=3;break}if("float_list"===d.type){r[f]=h,b.g=7;break}if("proto"===d.type){r[f]=h,b.g=7;break}if("texture"!==d.type)throw Error("Unknown output config type: '"+d.type+"'");return(p=e.u[f])||(p=new Ot(e.h,e.G),e.u[f]=p),y(b,Rt(p,h,e.I),13);case 13:v=b.h,r[f]=v;case 7:d.transform&&r[f]&&(r[f]=d.transform(r[f])),b.g=3;break;case 14:m[g]=b.h;case 3:o=l.next(),b.g=2;break;case 4:return b.return(r)}}))}function Vt(e,t){for(var n=t.name||"$",r=[].concat(s(t.wants)),a=new e.h.StringList,i=u(t.wants),o=i.next();!o.done;o=i.next())a.push_back(o.value);i=e.h.PacketListener.implement({onResults:function(a){for(var i={},o=0;o<t.wants.length;++o)i[r[o]]=a.get(o);var u=e.listeners[n];u&&(e.D=Wt(e,i,t.outs).then((function(n){n=u(n);for(var a=0;a<t.wants.length;++a){var o=i[r[a]];"object"===typeof o&&o.hasOwnProperty&&o.hasOwnProperty("delete")&&o.delete()}n&&(e.D=n)})))}}),e.i.attachMultiListener(a,i),a.delete()}function qt(e){var t=this;e=e||{};var n={url:"face_detection_short.binarypb"},r={type:1,graphOptionXref:{calculatorType:"TensorsToDetectionsCalculator",calculatorName:"facedetectionshortrangegpu__facedetectionshortrangecommon__TensorsToDetectionsCalculator",fieldName:"min_score_thresh"}};this.g=new Lt({locateFile:e.locateFile,files:[{data:!0,url:"face_detection_short.binarypb"},{data:!0,url:"face_detection_short_range.tflite"},{simd:!0,url:"face_detection_solution_simd_wasm_bin.js"},{simd:!1,url:"face_detection_solution_wasm_bin.js"}],graph:n,listeners:[{wants:["detections","image_transformed"],outs:{image:"image_transformed",detections:{type:"detection_list",stream:"detections"}}}],inputs:{image:{type:"video",stream:"input_frames_gpu"}},options:{useCpuInference:{type:0,graphOptionXref:{calculatorType:"InferenceCalculator",fieldName:"use_cpu_inference"},default:"object"===typeof window&&void 0!==window.navigator&&("iPad Simulator;iPhone Simulator;iPod Simulator;iPad;iPhone;iPod".split(";").includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document)},selfieMode:{type:0,graphOptionXref:{calculatorType:"GlScalerCalculator",calculatorIndex:1,fieldName:"flip_horizontal"}},model:{type:0,onChange:function(e){var a,i,o,s,c;return _((function(l){switch(l.g){case 1:a=u("short"===e?["face_detection_short_range.tflite"]:["face_detection_full_range_sparse.tflite"]),i=a.next();case 2:if(i.done){l.g=4;break}return o=i.value,s="third_party/mediapipe/modules/face_detection/"+o,y(l,Ut(t.g,o),5);case 5:c=l.h,t.g.overrideFile(s,c),i=a.next(),l.g=2;break;case 4:return n.url="short"===e?"face_detection_short.binarypb":"face_detection_full.binarypb",r.graphOptionXref.calculatorName="short"===e?"facedetectionshortrangegpu__facedetectionshortrangecommon__TensorsToDetectionsCalculator":"facedetectionfullrangegpu__facedetectionfullrangecommon__TensorsToDetectionsCalculator",l.return(!0)}}))}},minDetectionConfidence:r}})}(e=Lt.prototype).close=function(){return this.i&&this.i.delete(),Promise.resolve()},e.reset=function(){var e=this;return _((function(t){e.i&&(e.i.reset(),e.o={},e.u={}),t.g=0}))},e.setOptions=function(e,t){var n=this;if(t=t||this.g.options){for(var r=[],a=[],i={},o=u(Object.keys(e)),s=o.next();!s.done;i={R:i.R,S:i.S},s=o.next()){var c=s.value;c in this.j&&this.j[c]===e[c]||(this.j[c]=e[c],void 0!==(s=t[c])&&(s.onChange&&(i.R=s.onChange,i.S=e[c],r.push(function(e){return function(){return _((function(t){if(1==t.g)return y(t,e.R(e.S),2);!0===t.h&&(n.s=!0),t.g=0}))}}(i))),s.graphOptionXref&&(c={valueNumber:1===s.type?e[c]:0,valueBoolean:0===s.type&&e[c],valueString:2===s.type?e[c]:""},s=Object.assign(Object.assign(Object.assign({},{calculatorName:"",calculatorIndex:0}),s.graphOptionXref),c),a.push(s))))}0===r.length&&0===a.length||(this.s=!0,this.B=(void 0===this.B?[]:this.B).concat(a),this.A=(void 0===this.A?[]:this.A).concat(r))}},e.initialize=function(){var e=this;return _((function(t){return 1==t.g?y(t,Pt(e),2):3!=t.g?y(t,function(e){var t,n,r,a,i,o,s,c;return _((function(l){if(1==l.g)return e.g.graph&&e.g.graph.url&&e.Y===e.g.graph.url?l.return():(e.s=!0,e.g.graph&&e.g.graph.url?(e.Y=e.g.graph.url,y(l,Ut(e,e.g.graph.url),3)):void(l.g=2));for(2!=l.g&&(t=l.h,e.i.loadGraph(t)),n=u(Object.keys(e.C)),r=n.next();!r.done;r=n.next())a=r.value,e.i.overrideFile(a,e.C[a]);if(e.C={},e.g.listeners)for(i=u(e.g.listeners),o=i.next();!o.done;o=i.next())s=o.value,Vt(e,s);c=e.j,e.j={},e.setOptions(c),l.g=0}))}(e),3):y(t,function(e){var t,n,r,a,i,o;return _((function(s){switch(s.g){case 1:if(!e.s)return s.return();if(!e.A){s.g=2;break}t=u(e.A),n=t.next();case 3:if(n.done){s.g=5;break}return y(s,(0,n.value)(),4);case 4:n=t.next(),s.g=3;break;case 5:e.A=void 0;case 2:if(e.B){for(r=new e.h.GraphOptionChangeRequestList,a=u(e.B),i=a.next();!i.done;i=a.next())o=i.value,r.push_back(o);e.i.changeOptions(r),r.delete(),e.B=void 0}e.s=!1,s.g=0}}))}(e),0)}))},e.overrideFile=function(e,t){this.i?this.i.overrideFile(e,t):this.C[e]=t},e.clearOverriddenFiles=function(){this.C={},this.i&&this.i.clearOverriddenFiles()},e.send=function(e,t){var n,r,a,i,o,s,c,l,f,d=this;return _((function(h){switch(h.g){case 1:return d.g.inputs?(n=1e3*(void 0===t||null===t?performance.now():t),y(h,d.D,2)):h.return();case 2:return y(h,d.initialize(),3);case 3:for(r=new d.h.PacketDataList,a=u(Object.keys(e)),i=a.next();!i.done;i=a.next())if(o=i.value,s=d.g.inputs[o]){e:{var p=e[o];switch(s.type){case"video":var v=d.o[s.stream];if(v||(v=new Ot(d.h,d.G),d.o[s.stream]=v),0===v.l&&(v.l=v.h.createTexture()),"undefined"!==typeof HTMLVideoElement&&p instanceof HTMLVideoElement)var m=p.videoWidth,g=p.videoHeight;else"undefined"!==typeof HTMLImageElement&&p instanceof HTMLImageElement?(m=p.naturalWidth,g=p.naturalHeight):(m=p.width,g=p.height);g={glName:v.l,width:m,height:g},(m=v.g).canvas.width=g.width,m.canvas.height=g.height,m.activeTexture(m.TEXTURE0),v.h.bindTexture2d(v.l),m.texImage2D(m.TEXTURE_2D,0,m.RGBA,m.RGBA,m.UNSIGNED_BYTE,p),v.h.bindTexture2d(0),v=g;break e;case"detections":for((v=d.o[s.stream])||(v=new jt(d.h),d.o[s.stream]=v),v.data||(v.data=new v.g.DetectionListData),v.data.reset(p.length),g=0;g<p.length;++g){m=p[g];var b=v.data,x=b.setBoundingBox,w=g,k=m.boundingBox,_=new kt;if(ye(_,1,k.xCenter),ye(_,2,k.yCenter),ye(_,3,k.height),ye(_,4,k.width),ye(_,5,k.rotation),ye(_,6,k.rectId),k=rt(_,_t),x.call(b,w,k),m.landmarks)for(b=0;b<m.landmarks.length;++b){var S=!!(_=m.landmarks[b]).visibility;w=(x=v.data).addNormalizedLandmark,k=g,_=Object.assign(Object.assign({},_),{visibility:S?_.visibility:0}),ye(S=new gt,1,_.x),ye(S,2,_.y),ye(S,3,_.z),_.visibility&&ye(S,4,_.visibility),_=rt(S,yt),w.call(x,k,_)}if(m.V)for(b=0;b<m.V.length;++b)w=(x=v.data).addClassification,k=g,_=m.V[b],ye(S=new dt,2,_.ga),_.index&&ye(S,1,_.index),_.label&&ye(S,3,_.label),_.displayName&&ye(S,4,_.displayName),_=rt(S,ht),w.call(x,k,_)}v=v.data;break e;default:v={}}}switch(c=v,l=s.stream,s.type){case"video":r.pushTexture2d(Object.assign(Object.assign({},c),{stream:l,timestamp:n}));break;case"detections":(f=c).stream=l,f.timestamp=n,r.pushDetectionList(f);break;default:throw Error("Unknown input config type: '"+s.type+"'")}}return d.i.send(r),y(h,d.D,4);case 4:r.delete(),h.g=0}}))},e.onResults=function(e,t){this.listeners[t||"$"]=e},A("Solution",Lt),A("OptionType",{BOOL:0,NUMBER:1,ia:2,0:"BOOL",1:"NUMBER",2:"STRING"}),(e=qt.prototype).close=function(){return this.g.close(),Promise.resolve()},e.onResults=function(e){this.g.onResults(e)},e.initialize=function(){var e=this;return _((function(t){return y(t,e.g.initialize(),0)}))},e.reset=function(){this.g.reset()},e.send=function(e){var t=this;return _((function(n){return y(n,t.g.send(e),0)}))},e.setOptions=function(e){this.g.setOptions(e)},A("FaceDetection",qt),A("FACEDETECTION_LIPS",St),A("FACEDETECTION_LEFT_EYE",Ct),A("FACEDETECTION_LEFT_EYEBROW",At),A("FACEDETECTION_RIGHT_EYE",Et),A("FACEDETECTION_RIGHT_EYEBROW",Nt),A("FACEDETECTION_FACE_OVAL",Tt),A("FACEDETECTION_CONTOURS",It),A("FACEDETECTION_TESSELATION",[[127,34],[34,139],[139,127],[11,0],[0,37],[37,11],[232,231],[231,120],[120,232],[72,37],[37,39],[39,72],[128,121],[121,47],[47,128],[232,121],[121,128],[128,232],[104,69],[69,67],[67,104],[175,171],[171,148],[148,175],[118,50],[50,101],[101,118],[73,39],[39,40],[40,73],[9,151],[151,108],[108,9],[48,115],[115,131],[131,48],[194,204],[204,211],[211,194],[74,40],[40,185],[185,74],[80,42],[42,183],[183,80],[40,92],[92,186],[186,40],[230,229],[229,118],[118,230],[202,212],[212,214],[214,202],[83,18],[18,17],[17,83],[76,61],[61,146],[146,76],[160,29],[29,30],[30,160],[56,157],[157,173],[173,56],[106,204],[204,194],[194,106],[135,214],[214,192],[192,135],[203,165],[165,98],[98,203],[21,71],[71,68],[68,21],[51,45],[45,4],[4,51],[144,24],[24,23],[23,144],[77,146],[146,91],[91,77],[205,50],[50,187],[187,205],[201,200],[200,18],[18,201],[91,106],[106,182],[182,91],[90,91],[91,181],[181,90],[85,84],[84,17],[17,85],[206,203],[203,36],[36,206],[148,171],[171,140],[140,148],[92,40],[40,39],[39,92],[193,189],[189,244],[244,193],[159,158],[158,28],[28,159],[247,246],[246,161],[161,247],[236,3],[3,196],[196,236],[54,68],[68,104],[104,54],[193,168],[168,8],[8,193],[117,228],[228,31],[31,117],[189,193],[193,55],[55,189],[98,97],[97,99],[99,98],[126,47],[47,100],[100,126],[166,79],[79,218],[218,166],[155,154],[154,26],[26,155],[209,49],[49,131],[131,209],[135,136],[136,150],[150,135],[47,126],[126,217],[217,47],[223,52],[52,53],[53,223],[45,51],[51,134],[134,45],[211,170],[170,140],[140,211],[67,69],[69,108],[108,67],[43,106],[106,91],[91,43],[230,119],[119,120],[120,230],[226,130],[130,247],[247,226],[63,53],[53,52],[52,63],[238,20],[20,242],[242,238],[46,70],[70,156],[156,46],[78,62],[62,96],[96,78],[46,53],[53,63],[63,46],[143,34],[34,227],[227,143],[123,117],[117,111],[111,123],[44,125],[125,19],[19,44],[236,134],[134,51],[51,236],[216,206],[206,205],[205,216],[154,153],[153,22],[22,154],[39,37],[37,167],[167,39],[200,201],[201,208],[208,200],[36,142],[142,100],[100,36],[57,212],[212,202],[202,57],[20,60],[60,99],[99,20],[28,158],[158,157],[157,28],[35,226],[226,113],[113,35],[160,159],[159,27],[27,160],[204,202],[202,210],[210,204],[113,225],[225,46],[46,113],[43,202],[202,204],[204,43],[62,76],[76,77],[77,62],[137,123],[123,116],[116,137],[41,38],[38,72],[72,41],[203,129],[129,142],[142,203],[64,98],[98,240],[240,64],[49,102],[102,64],[64,49],[41,73],[73,74],[74,41],[212,216],[216,207],[207,212],[42,74],[74,184],[184,42],[169,170],[170,211],[211,169],[170,149],[149,176],[176,170],[105,66],[66,69],[69,105],[122,6],[6,168],[168,122],[123,147],[147,187],[187,123],[96,77],[77,90],[90,96],[65,55],[55,107],[107,65],[89,90],[90,180],[180,89],[101,100],[100,120],[120,101],[63,105],[105,104],[104,63],[93,137],[137,227],[227,93],[15,86],[86,85],[85,15],[129,102],[102,49],[49,129],[14,87],[87,86],[86,14],[55,8],[8,9],[9,55],[100,47],[47,121],[121,100],[145,23],[23,22],[22,145],[88,89],[89,179],[179,88],[6,122],[122,196],[196,6],[88,95],[95,96],[96,88],[138,172],[172,136],[136,138],[215,58],[58,172],[172,215],[115,48],[48,219],[219,115],[42,80],[80,81],[81,42],[195,3],[3,51],[51,195],[43,146],[146,61],[61,43],[171,175],[175,199],[199,171],[81,82],[82,38],[38,81],[53,46],[46,225],[225,53],[144,163],[163,110],[110,144],[52,65],[65,66],[66,52],[229,228],[228,117],[117,229],[34,127],[127,234],[234,34],[107,108],[108,69],[69,107],[109,108],[108,151],[151,109],[48,64],[64,235],[235,48],[62,78],[78,191],[191,62],[129,209],[209,126],[126,129],[111,35],[35,143],[143,111],[117,123],[123,50],[50,117],[222,65],[65,52],[52,222],[19,125],[125,141],[141,19],[221,55],[55,65],[65,221],[3,195],[195,197],[197,3],[25,7],[7,33],[33,25],[220,237],[237,44],[44,220],[70,71],[71,139],[139,70],[122,193],[193,245],[245,122],[247,130],[130,33],[33,247],[71,21],[21,162],[162,71],[170,169],[169,150],[150,170],[188,174],[174,196],[196,188],[216,186],[186,92],[92,216],[2,97],[97,167],[167,2],[141,125],[125,241],[241,141],[164,167],[167,37],[37,164],[72,38],[38,12],[12,72],[38,82],[82,13],[13,38],[63,68],[68,71],[71,63],[226,35],[35,111],[111,226],[101,50],[50,205],[205,101],[206,92],[92,165],[165,206],[209,198],[198,217],[217,209],[165,167],[167,97],[97,165],[220,115],[115,218],[218,220],[133,112],[112,243],[243,133],[239,238],[238,241],[241,239],[214,135],[135,169],[169,214],[190,173],[173,133],[133,190],[171,208],[208,32],[32,171],[125,44],[44,237],[237,125],[86,87],[87,178],[178,86],[85,86],[86,179],[179,85],[84,85],[85,180],[180,84],[83,84],[84,181],[181,83],[201,83],[83,182],[182,201],[137,93],[93,132],[132,137],[76,62],[62,183],[183,76],[61,76],[76,184],[184,61],[57,61],[61,185],[185,57],[212,57],[57,186],[186,212],[214,207],[207,187],[187,214],[34,143],[143,156],[156,34],[79,239],[239,237],[237,79],[123,137],[137,177],[177,123],[44,1],[1,4],[4,44],[201,194],[194,32],[32,201],[64,102],[102,129],[129,64],[213,215],[215,138],[138,213],[59,166],[166,219],[219,59],[242,99],[99,97],[97,242],[2,94],[94,141],[141,2],[75,59],[59,235],[235,75],[24,110],[110,228],[228,24],[25,130],[130,226],[226,25],[23,24],[24,229],[229,23],[22,23],[23,230],[230,22],[26,22],[22,231],[231,26],[112,26],[26,232],[232,112],[189,190],[190,243],[243,189],[221,56],[56,190],[190,221],[28,56],[56,221],[221,28],[27,28],[28,222],[222,27],[29,27],[27,223],[223,29],[30,29],[29,224],[224,30],[247,30],[30,225],[225,247],[238,79],[79,20],[20,238],[166,59],[59,75],[75,166],[60,75],[75,240],[240,60],[147,177],[177,215],[215,147],[20,79],[79,166],[166,20],[187,147],[147,213],[213,187],[112,233],[233,244],[244,112],[233,128],[128,245],[245,233],[128,114],[114,188],[188,128],[114,217],[217,174],[174,114],[131,115],[115,220],[220,131],[217,198],[198,236],[236,217],[198,131],[131,134],[134,198],[177,132],[132,58],[58,177],[143,35],[35,124],[124,143],[110,163],[163,7],[7,110],[228,110],[110,25],[25,228],[356,389],[389,368],[368,356],[11,302],[302,267],[267,11],[452,350],[350,349],[349,452],[302,303],[303,269],[269,302],[357,343],[343,277],[277,357],[452,453],[453,357],[357,452],[333,332],[332,297],[297,333],[175,152],[152,377],[377,175],[347,348],[348,330],[330,347],[303,304],[304,270],[270,303],[9,336],[336,337],[337,9],[278,279],[279,360],[360,278],[418,262],[262,431],[431,418],[304,408],[408,409],[409,304],[310,415],[415,407],[407,310],[270,409],[409,410],[410,270],[450,348],[348,347],[347,450],[422,430],[430,434],[434,422],[313,314],[314,17],[17,313],[306,307],[307,375],[375,306],[387,388],[388,260],[260,387],[286,414],[414,398],[398,286],[335,406],[406,418],[418,335],[364,367],[367,416],[416,364],[423,358],[358,327],[327,423],[251,284],[284,298],[298,251],[281,5],[5,4],[4,281],[373,374],[374,253],[253,373],[307,320],[320,321],[321,307],[425,427],[427,411],[411,425],[421,313],[313,18],[18,421],[321,405],[405,406],[406,321],[320,404],[404,405],[405,320],[315,16],[16,17],[17,315],[426,425],[425,266],[266,426],[377,400],[400,369],[369,377],[322,391],[391,269],[269,322],[417,465],[465,464],[464,417],[386,257],[257,258],[258,386],[466,260],[260,388],[388,466],[456,399],[399,419],[419,456],[284,332],[332,333],[333,284],[417,285],[285,8],[8,417],[346,340],[340,261],[261,346],[413,441],[441,285],[285,413],[327,460],[460,328],[328,327],[355,371],[371,329],[329,355],[392,439],[439,438],[438,392],[382,341],[341,256],[256,382],[429,420],[420,360],[360,429],[364,394],[394,379],[379,364],[277,343],[343,437],[437,277],[443,444],[444,283],[283,443],[275,440],[440,363],[363,275],[431,262],[262,369],[369,431],[297,338],[338,337],[337,297],[273,375],[375,321],[321,273],[450,451],[451,349],[349,450],[446,342],[342,467],[467,446],[293,334],[334,282],[282,293],[458,461],[461,462],[462,458],[276,353],[353,383],[383,276],[308,324],[324,325],[325,308],[276,300],[300,293],[293,276],[372,345],[345,447],[447,372],[352,345],[345,340],[340,352],[274,1],[1,19],[19,274],[456,248],[248,281],[281,456],[436,427],[427,425],[425,436],[381,256],[256,252],[252,381],[269,391],[391,393],[393,269],[200,199],[199,428],[428,200],[266,330],[330,329],[329,266],[287,273],[273,422],[422,287],[250,462],[462,328],[328,250],[258,286],[286,384],[384,258],[265,353],[353,342],[342,265],[387,259],[259,257],[257,387],[424,431],[431,430],[430,424],[342,353],[353,276],[276,342],[273,335],[335,424],[424,273],[292,325],[325,307],[307,292],[366,447],[447,345],[345,366],[271,303],[303,302],[302,271],[423,266],[266,371],[371,423],[294,455],[455,460],[460,294],[279,278],[278,294],[294,279],[271,272],[272,304],[304,271],[432,434],[434,427],[427,432],[272,407],[407,408],[408,272],[394,430],[430,431],[431,394],[395,369],[369,400],[400,395],[334,333],[333,299],[299,334],[351,417],[417,168],[168,351],[352,280],[280,411],[411,352],[325,319],[319,320],[320,325],[295,296],[296,336],[336,295],[319,403],[403,404],[404,319],[330,348],[348,349],[349,330],[293,298],[298,333],[333,293],[323,454],[454,447],[447,323],[15,16],[16,315],[315,15],[358,429],[429,279],[279,358],[14,15],[15,316],[316,14],[285,336],[336,9],[9,285],[329,349],[349,350],[350,329],[374,380],[380,252],[252,374],[318,402],[402,403],[403,318],[6,197],[197,419],[419,6],[318,319],[319,325],[325,318],[367,364],[364,365],[365,367],[435,367],[367,397],[397,435],[344,438],[438,439],[439,344],[272,271],[271,311],[311,272],[195,5],[5,281],[281,195],[273,287],[287,291],[291,273],[396,428],[428,199],[199,396],[311,271],[271,268],[268,311],[283,444],[444,445],[445,283],[373,254],[254,339],[339,373],[282,334],[334,296],[296,282],[449,347],[347,346],[346,449],[264,447],[447,454],[454,264],[336,296],[296,299],[299,336],[338,10],[10,151],[151,338],[278,439],[439,455],[455,278],[292,407],[407,415],[415,292],[358,371],[371,355],[355,358],[340,345],[345,372],[372,340],[346,347],[347,280],[280,346],[442,443],[443,282],[282,442],[19,94],[94,370],[370,19],[441,442],[442,295],[295,441],[248,419],[419,197],[197,248],[263,255],[255,359],[359,263],[440,275],[275,274],[274,440],[300,383],[383,368],[368,300],[351,412],[412,465],[465,351],[263,467],[467,466],[466,263],[301,368],[368,389],[389,301],[395,378],[378,379],[379,395],[412,351],[351,419],[419,412],[436,426],[426,322],[322,436],[2,164],[164,393],[393,2],[370,462],[462,461],[461,370],[164,0],[0,267],[267,164],[302,11],[11,12],[12,302],[268,12],[12,13],[13,268],[293,300],[300,301],[301,293],[446,261],[261,340],[340,446],[330,266],[266,425],[425,330],[426,423],[423,391],[391,426],[429,355],[355,437],[437,429],[391,327],[327,326],[326,391],[440,457],[457,438],[438,440],[341,382],[382,362],[362,341],[459,457],[457,461],[461,459],[434,430],[430,394],[394,434],[414,463],[463,362],[362,414],[396,369],[369,262],[262,396],[354,461],[461,457],[457,354],[316,403],[403,402],[402,316],[315,404],[404,403],[403,315],[314,405],[405,404],[404,314],[313,406],[406,405],[405,313],[421,418],[418,406],[406,421],[366,401],[401,361],[361,366],[306,408],[408,407],[407,306],[291,409],[409,408],[408,291],[287,410],[410,409],[409,287],[432,436],[436,410],[410,432],[434,416],[416,411],[411,434],[264,368],[368,383],[383,264],[309,438],[438,457],[457,309],[352,376],[376,401],[401,352],[274,275],[275,4],[4,274],[421,428],[428,262],[262,421],[294,327],[327,358],[358,294],[433,416],[416,367],[367,433],[289,455],[455,439],[439,289],[462,370],[370,326],[326,462],[2,326],[326,370],[370,2],[305,460],[460,455],[455,305],[254,449],[449,448],[448,254],[255,261],[261,446],[446,255],[253,450],[450,449],[449,253],[252,451],[451,450],[450,252],[256,452],[452,451],[451,256],[341,453],[453,452],[452,341],[413,464],[464,463],[463,413],[441,413],[413,414],[414,441],[258,442],[442,441],[441,258],[257,443],[443,442],[442,257],[259,444],[444,443],[443,259],[260,445],[445,444],[444,260],[467,342],[342,445],[445,467],[459,458],[458,250],[250,459],[289,392],[392,290],[290,289],[290,328],[328,460],[460,290],[376,433],[433,435],[435,376],[250,290],[290,392],[392,250],[411,416],[416,433],[433,411],[341,463],[463,464],[464,341],[453,464],[464,465],[465,453],[357,465],[465,412],[412,357],[343,412],[412,399],[399,343],[360,363],[363,440],[440,360],[437,399],[399,456],[456,437],[420,456],[456,363],[363,420],[401,435],[435,288],[288,401],[372,383],[383,353],[353,372],[339,255],[255,249],[249,339],[448,261],[261,255],[255,448],[133,243],[243,190],[190,133],[133,155],[155,112],[112,133],[33,246],[246,247],[247,33],[33,130],[130,25],[25,33],[398,384],[384,286],[286,398],[362,398],[398,414],[414,362],[362,463],[463,341],[341,362],[263,359],[359,467],[467,263],[263,249],[249,255],[255,263],[466,467],[467,260],[260,466],[75,60],[60,166],[166,75],[238,239],[239,79],[79,238],[162,127],[127,139],[139,162],[72,11],[11,37],[37,72],[121,232],[232,120],[120,121],[73,72],[72,39],[39,73],[114,128],[128,47],[47,114],[233,232],[232,128],[128,233],[103,104],[104,67],[67,103],[152,175],[175,148],[148,152],[119,118],[118,101],[101,119],[74,73],[73,40],[40,74],[107,9],[9,108],[108,107],[49,48],[48,131],[131,49],[32,194],[194,211],[211,32],[184,74],[74,185],[185,184],[191,80],[80,183],[183,191],[185,40],[40,186],[186,185],[119,230],[230,118],[118,119],[210,202],[202,214],[214,210],[84,83],[83,17],[17,84],[77,76],[76,146],[146,77],[161,160],[160,30],[30,161],[190,56],[56,173],[173,190],[182,106],[106,194],[194,182],[138,135],[135,192],[192,138],[129,203],[203,98],[98,129],[54,21],[21,68],[68,54],[5,51],[51,4],[4,5],[145,144],[144,23],[23,145],[90,77],[77,91],[91,90],[207,205],[205,187],[187,207],[83,201],[201,18],[18,83],[181,91],[91,182],[182,181],[180,90],[90,181],[181,180],[16,85],[85,17],[17,16],[205,206],[206,36],[36,205],[176,148],[148,140],[140,176],[165,92],[92,39],[39,165],[245,193],[193,244],[244,245],[27,159],[159,28],[28,27],[30,247],[247,161],[161,30],[174,236],[236,196],[196,174],[103,54],[54,104],[104,103],[55,193],[193,8],[8,55],[111,117],[117,31],[31,111],[221,189],[189,55],[55,221],[240,98],[98,99],[99,240],[142,126],[126,100],[100,142],[219,166],[166,218],[218,219],[112,155],[155,26],[26,112],[198,209],[209,131],[131,198],[169,135],[135,150],[150,169],[114,47],[47,217],[217,114],[224,223],[223,53],[53,224],[220,45],[45,134],[134,220],[32,211],[211,140],[140,32],[109,67],[67,108],[108,109],[146,43],[43,91],[91,146],[231,230],[230,120],[120,231],[113,226],[226,247],[247,113],[105,63],[63,52],[52,105],[241,238],[238,242],[242,241],[124,46],[46,156],[156,124],[95,78],[78,96],[96,95],[70,46],[46,63],[63,70],[116,143],[143,227],[227,116],[116,123],[123,111],[111,116],[1,44],[44,19],[19,1],[3,236],[236,51],[51,3],[207,216],[216,205],[205,207],[26,154],[154,22],[22,26],[165,39],[39,167],[167,165],[199,200],[200,208],[208,199],[101,36],[36,100],[100,101],[43,57],[57,202],[202,43],[242,20],[20,99],[99,242],[56,28],[28,157],[157,56],[124,35],[35,113],[113,124],[29,160],[160,27],[27,29],[211,204],[204,210],[210,211],[124,113],[113,46],[46,124],[106,43],[43,204],[204,106],[96,62],[62,77],[77,96],[227,137],[137,116],[116,227],[73,41],[41,72],[72,73],[36,203],[203,142],[142,36],[235,64],[64,240],[240,235],[48,49],[49,64],[64,48],[42,41],[41,74],[74,42],[214,212],[212,207],[207,214],[183,42],[42,184],[184,183],[210,169],[169,211],[211,210],[140,170],[170,176],[176,140],[104,105],[105,69],[69,104],[193,122],[122,168],[168,193],[50,123],[123,187],[187,50],[89,96],[96,90],[90,89],[66,65],[65,107],[107,66],[179,89],[89,180],[180,179],[119,101],[101,120],[120,119],[68,63],[63,104],[104,68],[234,93],[93,227],[227,234],[16,15],[15,85],[85,16],[209,129],[129,49],[49,209],[15,14],[14,86],[86,15],[107,55],[55,9],[9,107],[120,100],[100,121],[121,120],[153,145],[145,22],[22,153],[178,88],[88,179],[179,178],[197,6],[6,196],[196,197],[89,88],[88,96],[96,89],[135,138],[138,136],[136,135],[138,215],[215,172],[172,138],[218,115],[115,219],[219,218],[41,42],[42,81],[81,41],[5,195],[195,51],[51,5],[57,43],[43,61],[61,57],[208,171],[171,199],[199,208],[41,81],[81,38],[38,41],[224,53],[53,225],[225,224],[24,144],[144,110],[110,24],[105,52],[52,66],[66,105],[118,229],[229,117],[117,118],[227,34],[34,234],[234,227],[66,107],[107,69],[69,66],[10,109],[109,151],[151,10],[219,48],[48,235],[235,219],[183,62],[62,191],[191,183],[142,129],[129,126],[126,142],[116,111],[111,143],[143,116],[118,117],[117,50],[50,118],[223,222],[222,52],[52,223],[94,19],[19,141],[141,94],[222,221],[221,65],[65,222],[196,3],[3,197],[197,196],[45,220],[220,44],[44,45],[156,70],[70,139],[139,156],[188,122],[122,245],[245,188],[139,71],[71,162],[162,139],[149,170],[170,150],[150,149],[122,188],[188,196],[196,122],[206,216],[216,92],[92,206],[164,2],[2,167],[167,164],[242,141],[141,241],[241,242],[0,164],[164,37],[37,0],[11,72],[72,12],[12,11],[12,38],[38,13],[13,12],[70,63],[63,71],[71,70],[31,226],[226,111],[111,31],[36,101],[101,205],[205,36],[203,206],[206,165],[165,203],[126,209],[209,217],[217,126],[98,165],[165,97],[97,98],[237,220],[220,218],[218,237],[237,239],[239,241],[241,237],[210,214],[214,169],[169,210],[140,171],[171,32],[32,140],[241,125],[125,237],[237,241],[179,86],[86,178],[178,179],[180,85],[85,179],[179,180],[181,84],[84,180],[180,181],[182,83],[83,181],[181,182],[194,201],[201,182],[182,194],[177,137],[137,132],[132,177],[184,76],[76,183],[183,184],[185,61],[61,184],[184,185],[186,57],[57,185],[185,186],[216,212],[212,186],[186,216],[192,214],[214,187],[187,192],[139,34],[34,156],[156,139],[218,79],[79,237],[237,218],[147,123],[123,177],[177,147],[45,44],[44,4],[4,45],[208,201],[201,32],[32,208],[98,64],[64,129],[129,98],[192,213],[213,138],[138,192],[235,59],[59,219],[219,235],[141,242],[242,97],[97,141],[97,2],[2,141],[141,97],[240,75],[75,235],[235,240],[229,24],[24,228],[228,229],[31,25],[25,226],[226,31],[230,23],[23,229],[229,230],[231,22],[22,230],[230,231],[232,26],[26,231],[231,232],[233,112],[112,232],[232,233],[244,189],[189,243],[243,244],[189,221],[221,190],[190,189],[222,28],[28,221],[221,222],[223,27],[27,222],[222,223],[224,29],[29,223],[223,224],[225,30],[30,224],[224,225],[113,247],[247,225],[225,113],[99,60],[60,240],[240,99],[213,147],[147,215],[215,213],[60,20],[20,166],[166,60],[192,187],[187,213],[213,192],[243,112],[112,244],[244,243],[244,233],[233,245],[245,244],[245,128],[128,188],[188,245],[188,114],[114,174],[174,188],[134,131],[131,220],[220,134],[174,217],[217,236],[236,174],[236,198],[198,134],[134,236],[215,177],[177,58],[58,215],[156,143],[143,124],[124,156],[25,110],[110,7],[7,25],[31,228],[228,25],[25,31],[264,356],[356,368],[368,264],[0,11],[11,267],[267,0],[451,452],[452,349],[349,451],[267,302],[302,269],[269,267],[350,357],[357,277],[277,350],[350,452],[452,357],[357,350],[299,333],[333,297],[297,299],[396,175],[175,377],[377,396],[280,347],[347,330],[330,280],[269,303],[303,270],[270,269],[151,9],[9,337],[337,151],[344,278],[278,360],[360,344],[424,418],[418,431],[431,424],[270,304],[304,409],[409,270],[272,310],[310,407],[407,272],[322,270],[270,410],[410,322],[449,450],[450,347],[347,449],[432,422],[422,434],[434,432],[18,313],[313,17],[17,18],[291,306],[306,375],[375,291],[259,387],[387,260],[260,259],[424,335],[335,418],[418,424],[434,364],[364,416],[416,434],[391,423],[423,327],[327,391],[301,251],[251,298],[298,301],[275,281],[281,4],[4,275],[254,373],[373,253],[253,254],[375,307],[307,321],[321,375],[280,425],[425,411],[411,280],[200,421],[421,18],[18,200],[335,321],[321,406],[406,335],[321,320],[320,405],[405,321],[314,315],[315,17],[17,314],[423,426],[426,266],[266,423],[396,377],[377,369],[369,396],[270,322],[322,269],[269,270],[413,417],[417,464],[464,413],[385,386],[386,258],[258,385],[248,456],[456,419],[419,248],[298,284],[284,333],[333,298],[168,417],[417,8],[8,168],[448,346],[346,261],[261,448],[417,413],[413,285],[285,417],[326,327],[327,328],[328,326],[277,355],[355,329],[329,277],[309,392],[392,438],[438,309],[381,382],[382,256],[256,381],[279,429],[429,360],[360,279],[365,364],[364,379],[379,365],[355,277],[277,437],[437,355],[282,443],[443,283],[283,282],[281,275],[275,363],[363,281],[395,431],[431,369],[369,395],[299,297],[297,337],[337,299],[335,273],[273,321],[321,335],[348,450],[450,349],[349,348],[359,446],[446,467],[467,359],[283,293],[293,282],[282,283],[250,458],[458,462],[462,250],[300,276],[276,383],[383,300],[292,308],[308,325],[325,292],[283,276],[276,293],[293,283],[264,372],[372,447],[447,264],[346,352],[352,340],[340,346],[354,274],[274,19],[19,354],[363,456],[456,281],[281,363],[426,436],[436,425],[425,426],[380,381],[381,252],[252,380],[267,269],[269,393],[393,267],[421,200],[200,428],[428,421],[371,266],[266,329],[329,371],[432,287],[287,422],[422,432],[290,250],[250,328],[328,290],[385,258],[258,384],[384,385],[446,265],[265,342],[342,446],[386,387],[387,257],[257,386],[422,424],[424,430],[430,422],[445,342],[342,276],[276,445],[422,273],[273,424],[424,422],[306,292],[292,307],[307,306],[352,366],[366,345],[345,352],[268,271],[271,302],[302,268],[358,423],[423,371],[371,358],[327,294],[294,460],[460,327],[331,279],[279,294],[294,331],[303,271],[271,304],[304,303],[436,432],[432,427],[427,436],[304,272],[272,408],[408,304],[395,394],[394,431],[431,395],[378,395],[395,400],[400,378],[296,334],[334,299],[299,296],[6,351],[351,168],[168,6],[376,352],[352,411],[411,376],[307,325],[325,320],[320,307],[285,295],[295,336],[336,285],[320,319],[319,404],[404,320],[329,330],[330,349],[349,329],[334,293],[293,333],[333,334],[366,323],[323,447],[447,366],[316,15],[15,315],[315,316],[331,358],[358,279],[279,331],[317,14],[14,316],[316,317],[8,285],[285,9],[9,8],[277,329],[329,350],[350,277],[253,374],[374,252],[252,253],[319,318],[318,403],[403,319],[351,6],[6,419],[419,351],[324,318],[318,325],[325,324],[397,367],[367,365],[365,397],[288,435],[435,397],[397,288],[278,344],[344,439],[439,278],[310,272],[272,311],[311,310],[248,195],[195,281],[281,248],[375,273],[273,291],[291,375],[175,396],[396,199],[199,175],[312,311],[311,268],[268,312],[276,283],[283,445],[445,276],[390,373],[373,339],[339,390],[295,282],[282,296],[296,295],[448,449],[449,346],[346,448],[356,264],[264,454],[454,356],[337,336],[336,299],[299,337],[337,338],[338,151],[151,337],[294,278],[278,455],[455,294],[308,292],[292,415],[415,308],[429,358],[358,355],[355,429],[265,340],[340,372],[372,265],[352,346],[346,280],[280,352],[295,442],[442,282],[282,295],[354,19],[19,370],[370,354],[285,441],[441,295],[295,285],[195,248],[248,197],[197,195],[457,440],[440,274],[274,457],[301,300],[300,368],[368,301],[417,351],[351,465],[465,417],[251,301],[301,389],[389,251],[394,395],[395,379],[379,394],[399,412],[412,419],[419,399],[410,436],[436,322],[322,410],[326,2],[2,393],[393,326],[354,370],[370,461],[461,354],[393,164],[164,267],[267,393],[268,302],[302,12],[12,268],[312,268],[268,13],[13,312],[298,293],[293,301],[301,298],[265,446],[446,340],[340,265],[280,330],[330,425],[425,280],[322,426],[426,391],[391,322],[420,429],[429,437],[437,420],[393,391],[391,326],[326,393],[344,440],[440,438],[438,344],[458,459],[459,461],[461,458],[364,434],[434,394],[394,364],[428,396],[396,262],[262,428],[274,354],[354,457],[457,274],[317,316],[316,402],[402,317],[316,315],[315,403],[403,316],[315,314],[314,404],[404,315],[314,313],[313,405],[405,314],[313,421],[421,406],[406,313],[323,366],[366,361],[361,323],[292,306],[306,407],[407,292],[306,291],[291,408],[408,306],[291,287],[287,409],[409,291],[287,432],[432,410],[410,287],[427,434],[434,411],[411,427],[372,264],[264,383],[383,372],[459,309],[309,457],[457,459],[366,352],[352,401],[401,366],[1,274],[274,4],[4,1],[418,421],[421,262],[262,418],[331,294],[294,358],[358,331],[435,433],[433,367],[367,435],[392,289],[289,439],[439,392],[328,462],[462,326],[326,328],[94,2],[2,370],[370,94],[289,305],[305,455],[455,289],[339,254],[254,448],[448,339],[359,255],[255,446],[446,359],[254,253],[253,449],[449,254],[253,252],[252,450],[450,253],[252,256],[256,451],[451,252],[256,341],[341,452],[452,256],[414,413],[413,463],[463,414],[286,441],[441,414],[414,286],[286,258],[258,441],[441,286],[258,257],[257,442],[442,258],[257,259],[259,443],[443,257],[259,260],[260,444],[444,259],[260,467],[467,445],[445,260],[309,459],[459,250],[250,309],[305,289],[289,290],[290,305],[305,290],[290,460],[460,305],[401,376],[376,435],[435,401],[309,250],[250,392],[392,309],[376,411],[411,433],[433,376],[453,341],[341,464],[464,453],[357,453],[453,465],[465,357],[343,357],[357,412],[412,343],[437,343],[343,399],[399,437],[344,360],[360,440],[440,344],[420,437],[437,456],[456,420],[360,420],[420,363],[363,360],[361,401],[401,288],[288,361],[265,372],[372,353],[353,265],[390,339],[339,249],[249,390],[339,448],[448,255],[255,339]]),A("VERSION","0.4.1646425229")}).call(this)},4679:function(e,t,n){"use strict";n.d(t,{JL:function(){return i},Zu:function(){return o}});var r=n(5671),a=n(3144),i=function(){function e(t,n){(0,r.Z)(this,e),this.backend=t,this.dataMover=n,this.data=new WeakMap,this.dataIdsCount=0}return(0,a.Z)(e,[{key:"get",value:function(e){return this.data.has(e)||this.dataMover.moveData(this.backend,e),this.data.get(e)}},{key:"set",value:function(e,t){this.dataIdsCount++,this.data.set(e,t)}},{key:"has",value:function(e){return this.data.has(e)}},{key:"delete",value:function(e){return this.dataIdsCount--,this.data.delete(e)}},{key:"numDataIds",value:function(){return this.dataIdsCount}}]),e}(),o=function(){function e(){(0,r.Z)(this,e)}return(0,a.Z)(e,[{key:"refCount",value:function(e){return u("refCount")}},{key:"incRef",value:function(e){return u("incRef")}},{key:"timerAvailable",value:function(){return!0}},{key:"time",value:function(e){return u("time")}},{key:"read",value:function(e){return u("read")}},{key:"readSync",value:function(e){return u("readSync")}},{key:"readToGPU",value:function(e,t){return u("readToGPU")}},{key:"numDataIds",value:function(){return u("numDataIds")}},{key:"disposeData",value:function(e,t){return u("disposeData")}},{key:"write",value:function(e,t,n){return u("write")}},{key:"move",value:function(e,t,n,r,a){return u("move")}},{key:"createTensorFromGPUData",value:function(e,t,n){return u("createTensorFromGPUData")}},{key:"memory",value:function(){return u("memory")}},{key:"floatPrecision",value:function(){return u("floatPrecision")}},{key:"epsilon",value:function(){return 32===this.floatPrecision()?1e-7:1e-4}},{key:"dispose",value:function(){return u("dispose")}}]),e}();function u(e){throw new Error("'".concat(e,"' not yet implemented or not found in the registry. ")+"This kernel may not be supported by the tfjs backend you have chosen")}},745:function(e,t,n){"use strict";n.d(t,{GP:function(){return o},qP:function(){return u},pA:function(){return s}});var r=n(3433);function a(e,t,n){var r=function(e,t,n){return function(e,t,n){var r=0,a=e.length,i=0,o=!1;for(;r<a;){var u=n(t,e[i=r+(a-r>>>1)]);u>0?r=i+1:(a=i,o=!u)}return o?r:-r-1}(e,t,n||i)}(e,t,n),a=r<0?-(r+1):r;e.splice(a,0,t)}function i(e,t){return e>t?1:e<t?-1:0}function o(e,t,n,r,a){return c(e,t,n,r,a,0)}function u(e,t,n,r,a,i){return c(e,t,n,r,a,0,!1,i,!0)}function s(e,t,n,r,a,i){return c(e,t,n,r,a,i,!0)}function c(e,t,n,i,o,u){for(var s=arguments.length>6&&void 0!==arguments[6]&&arguments[6],c=arguments.length>7&&void 0!==arguments[7]&&arguments[7],h=arguments.length>8&&void 0!==arguments[8]&&arguments[8],p=[],v=0;v<t.length;v++)t[v]>o&&p.push({score:t[v],boxIndex:v,suppressBeginIndex:0});p.sort(d);for(var m=u>0?-.5/u:0,g=[],y=[];g.length<n&&p.length>0;){var b=p.pop(),x=b.score,w=b.boxIndex,k=b.suppressBeginIndex;if(x<o)break;for(var _=!1,S=g.length-1;S>=k;--S){var C=l(e,w,g[S]);if(C>=i){_=!0;break}if(b.score=b.score*f(i,m,C),b.score<=o)break}b.suppressBeginIndex=g.length,_||(b.score===x?(g.push(w),y.push(b.score)):b.score>o&&a(p,b,d))}var A=g.length,E=n-A;c&&E>0&&(g.push.apply(g,(0,r.Z)(new Array(E).fill(0))),y.push.apply(y,(0,r.Z)(new Array(E).fill(0))));var N={selectedIndices:g};return s&&(N.selectedScores=y),h&&(N.validOutputs=A),N}function l(e,t,n){var r=e.subarray(4*t,4*t+4),a=e.subarray(4*n,4*n+4),i=Math.min(r[0],r[2]),o=Math.min(r[1],r[3]),u=Math.max(r[0],r[2]),s=Math.max(r[1],r[3]),c=Math.min(a[0],a[2]),l=Math.min(a[1],a[3]),f=Math.max(a[0],a[2]),d=Math.max(a[1],a[3]),h=(u-i)*(s-o),p=(f-c)*(d-l);if(h<=0||p<=0)return 0;var v=Math.max(i,c),m=Math.max(o,l),g=Math.min(u,f),y=Math.min(s,d),b=Math.max(g-v,0)*Math.max(y-m,0);return b/(h+p-b)}function f(e,t,n){var r=Math.exp(t*n*n);return n<=e?r:0}function d(e,t){return e.score-t.score||e.score===t.score&&t.boxIndex-e.boxIndex}},4189:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});var r=n(7039);function a(e,t){for(var n=[],a=0;a<t.length;a++)t[a]&&n.push(a);for(var i=(0,r.f)(e,"int32"),o=(0,r.f)([n.length,e.length],"int32"),u=0;u<n.length;u++){var s=i.indexToLoc(n[u]),c=u*e.length;o.values.set(s,c)}return o.toTensor()}},318:function(e,t,n){"use strict";n.d(t,{BV:function(){return T},wv:function(){return N}});var r=n(7762),a=n(3433),i=n(5861),o=n(5671),u=n(3144),s=n(4687),c=n.n(s),l=n(4679),f=n(5050),d=n(6581),h=n(2145),p=n(8864),v=n(7269),m=n(115),g=n(6147),y=function(){function e(t,n){(0,o.Z)(this,e),this.backendTimer=t,this.logger=n,null==n&&(this.logger=new b)}return(0,u.Z)(e,[{key:"profileKernel",value:function(e,t,n){var a,i,o=function(){a=n()},u=m.now();if(this.backendTimer.timerAvailable())i=this.backendTimer.time(o);else{o();var s,c=(0,r.Z)(a);try{for(c.s();!(s=c.n()).done;){s.value.dataSync()}}catch(h){c.e(h)}finally{c.f()}i=Promise.resolve({kernelMs:m.now()-u})}if((0,f.OB)().getBool("CHECK_COMPUTATION_FOR_ERRORS"))for(var l=function(t){var n=a[t];n.data().then((function(t){!function(e,t,n){if("float32"!==t)return!1;for(var r=0;r<e.length;r++){var a=e[r];if(isNaN(a)||!isFinite(a))return console.warn("Found ".concat(a," in the result of '").concat(n,"'")),!0}}(t,n.dtype,e)}))},d=0;d<a.length;d++)l(d);return{kernelName:e,outputs:a,inputs:t,timeMs:i.then((function(e){return e.kernelMs})),extraInfo:i.then((function(e){return null!=e.getExtraProfileInfo?e.getExtraProfileInfo():""}))}}},{key:"logKernelProfile",value:function(e){var t=this,n=e.kernelName,r=e.outputs,a=e.timeMs,i=e.inputs,o=e.extraInfo;r.forEach((function(e){Promise.all([e.data(),a,o]).then((function(r){t.logger.logKernelProfile(n,e,r[0],r[1],i,r[2])}))}))}}]),e}();var b=function(){function e(){(0,o.Z)(this,e)}return(0,u.Z)(e,[{key:"logKernelProfile",value:function(e,t,n,r,a,i){var o="number"===typeof r?g.oj("".concat(r,"ms"),9):r.error,u=g.oj(e,25),s=t.rank,c=t.size,l=g.oj(t.shape.toString(),14),f="";for(var d in a){var h=a[d];if(null!=h){var p=h.shape||t.shape,v=p.length;f+="".concat(d,": ").concat(v,"D ").concat(v>0?p:""," ")}}console.log("%c".concat(u,"\t%c").concat(o,"\t%c").concat(s,"D ").concat(l,"\t%c").concat(c,"\t%c").concat(f,"\t%c").concat(i),"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")}}]),e}();function x(e,t,n){for(var r={},a={},i=0;i<t.length;i++)r[t[i].id]=!0;for(var o=0;o<e.length;o++){var u=e[o],s=u.inputs;for(var c in s){for(var l=s[c],f=!1,d=0;d<t.length;d++)if(r[l.id]){u.outputs.forEach((function(e){return r[e.id]=!0})),f=!0,a[u.id]=!0;break}if(f)break}}var h={};h[n.id]=!0;for(var p={},v=e.length-1;v>=0;v--)for(var m=e[v],g=m.inputs,y=0;y<m.outputs.length;y++)if(h[m.outputs[y].id]){for(var b in g)h[g[b].id]=!0,p[m.id]=!0;break}for(var x=[],w=0;w<e.length;w++){var k=e[w];if(a[k.id]&&p[k.id]){var _={};for(var S in k.inputs){var C=k.inputs[S];r[C.id]&&(_[S]=C)}var A=Object.assign({},k);A.inputs=_,A.outputs=k.outputs,x.push(A)}}return x}function w(e,t,n,r){for(var a=function(a){var i=t[a],o=[];if(i.outputs.forEach((function(t){var n=e[t.id];null!=n?o.push(n):o.push(null)})),null==i.gradient)throw new Error("Cannot compute gradient: gradient function not found "+"for ".concat(i.kernelName,"."));var u=i.gradient(o),s=function(t){if(!(t in u))throw new Error("Cannot backprop through input ".concat(t,". ")+"Available gradients found: ".concat(Object.keys(u),"."));var a=n((function(){return u[t]()}));if("float32"!==a.dtype)throw new Error("Error in gradient for op ".concat(i.kernelName,". The gradient of input ")+"".concat(t," must have 'float32' dtype, but has '").concat(a.dtype,"'"));var o=i.inputs[t];if(!g.cO(a.shape,o.shape))throw new Error("Error in gradient for op ".concat(i.kernelName,". The gradient of input ")+"'".concat(t,"' has shape '").concat(a.shape,"', which does not match ")+"the shape of the input '".concat(o.shape,"'"));if(null==e[o.id])e[o.id]=a;else{var s=e[o.id];e[o.id]=r(s,a),s.dispose()}};for(var c in i.inputs)s(c)},i=t.length-1;i>=0;i--)a(i)}var k=n(4376),_=n(9064);function S(e){return null!=e.kernelName}var C=function(){function e(){(0,o.Z)(this,e),this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null,get kernelNames(){return Array.from(new Set(this.kernels.map((function(e){return e.name}))))}}}return(0,u.Z)(e,[{key:"dispose",value:function(){for(var e in this.registeredVariables)this.registeredVariables[e].dispose()}}]),e}(),A=function(){function e(t){(0,o.Z)(this,e),this.ENV=t,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new C}return(0,u.Z)(e,[{key:"ready",value:function(){var e=(0,i.Z)(c().mark((function e(){var t,n,r;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==this.pendingBackendInit){e.next=2;break}return e.abrupt("return",this.pendingBackendInit.then((function(){})));case 2:if(null==this.backendInstance){e.next=4;break}return e.abrupt("return");case 4:t=this.getSortedBackends(),n=0;case 6:if(!(n<t.length)){e.next=18;break}return r=t[n],e.next=10,this.initializeBackend(r).success;case 10:if(!e.sent){e.next=15;break}return e.next=14,this.setBackend(r);case 14:return e.abrupt("return");case 15:n++,e.next=6;break;case 18:throw new Error("Could not initialize any backends, all backend initializations failed.");case 19:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"backend",get:function(){if(null!=this.pendingBackendInit)throw new Error("Backend '".concat(this.backendName,"' has not yet been initialized. Make ")+"sure to await tf.ready() or await tf.setBackend() before calling other methods");if(null==this.backendInstance){var e=this.initializeBackendsAndReturnBest(),t=e.name;if(e.asyncInit)throw new Error("The highest priority backend '".concat(t,"' has not yet been ")+"initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods");this.setBackend(t)}return this.backendInstance}},{key:"backendNames",value:function(){return Object.keys(this.registryFactory)}},{key:"findBackend",value:function(e){if(!(e in this.registry)){if(!(e in this.registryFactory))return null;if(this.initializeBackend(e).asyncInit)return null}return this.registry[e]}},{key:"findBackendFactory",value:function(e){return e in this.registryFactory?this.registryFactory[e].factory:null}},{key:"registerBackend",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return e in this.registryFactory?(v.Z("".concat(e," backend was already registered. ")+"Reusing existing backend factory."),!1):(this.registryFactory[e]={factory:t,priority:n},!0)}},{key:"setBackend",value:function(){var e=(0,i.Z)(c().mark((function e(t){var n,r;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=this.registryFactory[t]){e.next=2;break}throw new Error("Backend name '".concat(t,"' not found in registry"));case 2:if(this.backendName=t,null!=this.registry[t]){e.next=16;break}if(this.backendInstance=null,n=this.initializeBackend(t),r=n.success,!n.asyncInit){e.next=12;break}return e.next=9,r;case 9:e.t0=e.sent,e.next=13;break;case 12:e.t0=r;case 13:if(e.t0){e.next=16;break}return e.abrupt("return",!1);case 16:return this.backendInstance=this.registry[t],this.setupRegisteredKernels(),this.profiler=new y(this.backendInstance),e.abrupt("return",!0);case 20:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"setupRegisteredKernels",value:function(){var e=this;(0,p.tr)(this.backendName).forEach((function(t){null!=t.setupFunc&&t.setupFunc(e.backendInstance)}))}},{key:"disposeRegisteredKernels",value:function(e){var t=this;(0,p.tr)(e).forEach((function(n){null!=n.disposeFunc&&n.disposeFunc(t.registry[e])}))}},{key:"initializeBackend",value:function(e){var t=this,n=this.registryFactory[e];if(null==n)throw new Error("Cannot initialize backend ".concat(e,", no registration found."));try{var r=n.factory();if(!r||r instanceof l.Zu||"function"!==typeof r.then)return this.registry[e]=r,{success:!0,asyncInit:!1};var a=++this.pendingBackendInitId,i=r.then((function(n){return!(a<t.pendingBackendInitId)&&(t.registry[e]=n,t.pendingBackendInit=null,!0)})).catch((function(n){return a<t.pendingBackendInitId||(t.pendingBackendInit=null,v.Z("Initialization of backend ".concat(e," failed")),v.Z(n.stack||n.message)),!1}));return this.pendingBackendInit=i,{success:i,asyncInit:!0}}catch(o){return v.Z("Initialization of backend ".concat(e," failed")),v.Z(o.stack||o.message),{success:!1,asyncInit:!1}}}},{key:"removeBackend",value:function(e){if(!(e in this.registryFactory))throw new Error("".concat(e," backend not found in registry"));this.backendName===e&&null!=this.pendingBackendInit&&this.pendingBackendInitId++,e in this.registry&&(this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e]),delete this.registryFactory[e],this.backendName===e&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)}},{key:"getSortedBackends",value:function(){var e=this;if(0===Object.keys(this.registryFactory).length)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort((function(t,n){return e.registryFactory[n].priority-e.registryFactory[t].priority}))}},{key:"initializeBackendsAndReturnBest",value:function(){for(var e=this.getSortedBackends(),t=0;t<e.length;t++){var n=e[t],r=this.initializeBackend(n),a=r.success,i=r.asyncInit;if(i||a)return{name:n,asyncInit:i}}throw new Error("Could not initialize any backends, all backend initializations failed.")}},{key:"moveData",value:function(e,t){var n=this.state.tensorInfo.get(t),r=n.backend,a=this.readSync(t),i=r.refCount(t);r.disposeData(t,!0),n.backend=e,e.move(t,a,n.shape,n.dtype,i),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++}},{key:"tidy",value:function(e,t){var n,r=this,a=null;if(null==t){if("function"!==typeof e)throw new Error("Please provide a function to tidy()");t=e}else{if("string"!==typeof e&&!(e instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if("function"!==typeof t)throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");a=e}return this.scopedRun((function(){return r.startScope(a)}),(function(){return r.endScope(n)}),(function(){return(n=t())instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),n}))}},{key:"scopedRun",value:function(e,t,n){e();try{var r=n();return t(),r}catch(a){throw t(),a}}},{key:"nextTensorId",value:function(){return e.nextTensorId++}},{key:"nextVariableId",value:function(){return e.nextVariableId++}},{key:"clone",value:function(e){var t=T.runKernel(h.iJz,{x:e}),n={x:e};return this.addTapeNode(this.state.activeScope.name,n,[t],(function(e){return{x:function(){var t={x:e},n={dtype:"float32"};return T.runKernel(h.RFZ,t,n)}}}),[],{}),t}},{key:"runKernel",value:function(e,t,n){if(null==this.backendName&&this.backend,!(null!=(0,p.pI)(e,this.backendName)))throw new Error("Kernel '".concat(e,"' not registered for backend '").concat(this.backendName,"'"));return this.runKernelFunc({kernelName:e,inputs:t,attrs:n})}},{key:"shouldCheckForMemLeaks",value:function(){return this.ENV.getBool("IS_TEST")}},{key:"checkKernelForMemLeak",value:function(e,t,n){var r=this.backend.numDataIds(),a=0;n.forEach((function(e){a+="complex64"===e.dtype?3:1}));var i=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],o=r-t-a-i;if(o>0)throw new Error("Backend '".concat(this.backendName,"' has an internal memory leak ")+"(".concat(o," data ids) after running '").concat(e,"'"))}},{key:"runKernelFunc",value:function(e){var t,n,r,a=this,i=[],o=this.isTapeOn(),u=this.state.numBytes,s=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0),null==this.backendName&&this.backend;var c=S(e)?e.kernelName:null!=this.state.activeScope?this.state.activeScope.name:"";if(S(e)){var l=e.kernelName,f=e.inputs,d=e.attrs;null==this.backendName&&this.backend;var h=(0,p.pI)(l,this.backendName);g.hu(null!=h,(function(){return"Cannot find registered kernel '".concat(l,"' for backend '").concat(a.backendName,"'")})),n=function(){var e=a.backend.numDataIds();r=h.kernelFunc({inputs:f,attrs:d,backend:a.backend});var t=Array.isArray(r)?r:[r];a.shouldCheckForMemLeaks()&&a.checkKernelForMemLeak(l,e,t);var n=t.map((function(e){return null!=e.rank?e:a.makeTensorFromTensorInfo(e)}));if(o){var u=a.getTensorsForGradient(l,f,n);i=a.saveTensorsForBackwardMode(u)}return n}}else{var v=e.forwardFunc,m=function(e){o&&(i=e.map((function(e){return a.keep(a.clone(e))})))};n=function(){var e=a.backend.numDataIds();r=a.tidy((function(){return v(a.backend,m)}));var t=Array.isArray(r)?r:[r];return a.shouldCheckForMemLeaks()&&a.checkKernelForMemLeak(c,e,t),t}}var y,b=e.inputs,x=e.attrs,w=S(e)?null:e.backwardsFunc;return this.scopedRun((function(){return a.state.kernelDepth++}),(function(){return a.state.kernelDepth--}),(function(){a.ENV.getBool("DEBUG")||a.state.profiling?(y=a.profiler.profileKernel(c,b,(function(){return n()})),a.ENV.getBool("DEBUG")&&a.profiler.logKernelProfile(y),t=y.outputs):t=n()})),o&&this.addTapeNode(c,b,t,w,i,x),this.state.profiling&&this.state.activeProfile.kernels.push({name:c,bytesAdded:this.state.numBytes-u,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-s,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(b).map((function(e){return null!=b[e]?b[e].shape:null})),outputShapes:t.map((function(e){return e.shape})),kernelTimeMs:y.timeMs,extraInfo:y.extraInfo}),Array.isArray(r)?t:t[0]}},{key:"saveTensorsForBackwardMode",value:function(e){var t=this,n=e.map((function(e){return t.keep(t.clone(e))}));return n}},{key:"getTensorsForGradient",value:function(e,t,n){var r=(0,p.uk)(e);if(null!=r){var a,i=r.inputsToSave||[],o=r.outputsToSave||[];r.saveAllInputs?(g.hu(Array.isArray(t),(function(){return"saveAllInputs is true, expected inputs to be an array."})),a=Object.keys(t).map((function(e){return t[e]}))):a=i.map((function(e){return t[e]}));var u=n.filter((function(e,t){return o[t]}));return a.concat(u)}return[]}},{key:"makeTensor",value:function(e,t,n,r){if(null==e)throw new Error("Values passed to engine.makeTensor() are null");n=n||"float32",r=r||this.backend;var a=e;"string"===n&&g.HD(e[0])&&(a=e.map((function(e){return m.encodeString(e)})));var i=r.write(a,t,n),o=new k.es(t,n,i,this.nextTensorId());if(this.trackTensor(o,r),"string"===n){var u=this.state.tensorInfo.get(i),s=(0,g.Ub)(a);this.state.numBytes+=s-u.bytes,u.bytes=s}return o}},{key:"makeTensorFromDataId",value:function(e,t,n,r){var a={dataId:e,shape:t,dtype:n=n||"float32"};return this.makeTensorFromTensorInfo(a,r)}},{key:"makeTensorFromTensorInfo",value:function(e,t){var n=e.dataId,r=e.shape,a=e.dtype,i=new k.es(r,a,n,this.nextTensorId());return this.trackTensor(i,t),i}},{key:"makeVariable",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;n=n||this.nextVariableId().toString(),null!=r&&r!==e.dtype&&(e=e.cast(r));var a=new k._w(e,t,n,this.nextTensorId());if(null!=this.state.registeredVariables[a.name])throw new Error("Variable with name ".concat(a.name," was already registered"));return this.state.registeredVariables[a.name]=a,this.incRef(a,this.backend),a}},{key:"trackTensor",value:function(e,t){this.state.numTensors++,"string"===e.dtype&&this.state.numStringTensors++;var n=0;"complex64"!==e.dtype&&"string"!==e.dtype&&(n=e.size*g.bT(e.dtype)),this.state.numBytes+=n,this.state.tensorInfo.has(e.dataId)||(this.state.numDataBuffers++,this.state.tensorInfo.set(e.dataId,{backend:t||this.backend,dtype:e.dtype,shape:e.shape,bytes:n})),e instanceof k._w||this.track(e)}},{key:"incRef",value:function(e,t){this.trackTensor(e,t),this.backend.incRef(e.dataId)}},{key:"removeDataId",value:function(e,t){this.state.tensorInfo.has(e)&&this.state.tensorInfo.get(e).backend===t&&(this.state.tensorInfo.delete(e),this.state.numDataBuffers--)}},{key:"disposeTensor",value:function(e){if(this.state.tensorInfo.has(e.dataId)){var t=this.state.tensorInfo.get(e.dataId);if(this.state.numTensors--,"string"===e.dtype&&(this.state.numStringTensors--,this.state.numBytes-=t.bytes),"complex64"!==e.dtype&&"string"!==e.dtype){var n=e.size*g.bT(e.dtype);this.state.numBytes-=n}t.backend.disposeData(e.dataId)&&this.removeDataId(e.dataId,t.backend)}}},{key:"disposeVariables",value:function(){for(var e in this.state.registeredVariables){var t=this.state.registeredVariables[e];this.disposeVariable(t)}}},{key:"disposeVariable",value:function(e){this.disposeTensor(e),null!=this.state.registeredVariables[e.name]&&delete this.state.registeredVariables[e.name]}},{key:"memory",value:function(){var e=this.backend.memory();return e.numTensors=this.state.numTensors,e.numDataBuffers=this.state.numDataBuffers,e.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(e.unreliable=!0,null==e.reasons&&(e.reasons=[]),e.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),e}},{key:"profile",value:function(){var e=(0,i.Z)(c().mark((function e(t){var n,i,o,u,s;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.state.profiling=!0,n=this.state.numBytes,i=this.state.numTensors,this.state.activeProfile.kernels=[],e.next=6,t();case 6:this.state.activeProfile.result=e.sent,this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max.apply(Math,(0,a.Z)(this.state.activeProfile.kernels.map((function(e){return e.totalBytesSnapshot})))),this.state.activeProfile.newBytes=this.state.numBytes-n,this.state.activeProfile.newTensors=this.state.numTensors-i,o=(0,r.Z)(this.state.activeProfile.kernels),e.prev=12,o.s();case 14:if((u=o.n()).done){e.next=24;break}return s=u.value,e.next=18,s.kernelTimeMs;case 18:return s.kernelTimeMs=e.sent,e.next=21,s.extraInfo;case 21:s.extraInfo=e.sent;case 22:e.next=14;break;case 24:e.next=29;break;case 26:e.prev=26,e.t0=e.catch(12),o.e(e.t0);case 29:return e.prev=29,o.f(),e.finish(29);case 32:return e.abrupt("return",this.state.activeProfile);case 33:case"end":return e.stop()}}),e,this,[[12,26,29,32]])})));return function(t){return e.apply(this,arguments)}}()},{key:"isTapeOn",value:function(){return this.state.gradientDepth>0&&0===this.state.kernelDepth}},{key:"addTapeNode",value:function(e,t,n,r,a,i){var o=this,u={id:this.state.nextTapeNodeId++,kernelName:e,inputs:t,outputs:n,saved:a},s=(0,p.uk)(e);null!=s&&(r=s.gradFunc),null!=r&&(u.gradient=function(e){return e=e.map((function(e,t){if(null==e){var r=n[t],a=g.wT(r.size,r.dtype);return o.makeTensor(a,r.shape,r.dtype)}return e})),r(e.length>1?e:e[0],a,i)}),this.state.activeTape.push(u)}},{key:"keep",value:function(e){return e.kept=!0,e}},{key:"startTape",value:function(){0===this.state.gradientDepth&&(this.state.activeTape=[]),this.state.gradientDepth++}},{key:"endTape",value:function(){this.state.gradientDepth--}},{key:"startScope",value:function(e){var t={track:[],name:"unnamed scope",id:this.state.nextScopeId++};e&&(t.name=e),this.state.scopeStack.push(t),this.state.activeScope=t}},{key:"endScope",value:function(e){for(var t=this,n=(0,_.getTensorsInContainer)(e),r=new Set(n.map((function(e){return e.id}))),a=0;a<this.state.activeScope.track.length;a++){var i=this.state.activeScope.track[a];i.kept||r.has(i.id)||i.dispose()}var o=this.state.scopeStack.pop();this.state.activeScope=0===this.state.scopeStack.length?null:this.state.scopeStack[this.state.scopeStack.length-1],n.forEach((function(e){e.kept||e.scopeId!==o.id||t.track(e)}))}},{key:"gradients",value:function(e,t,n){var a=this,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(g.hu(t.length>0,(function(){return"gradients() received an empty list of xs."})),null!=n&&"float32"!==n.dtype)throw new Error("dy must have 'float32' dtype, but has '".concat(n.dtype,"'"));var o=this.scopedRun((function(){return a.startTape()}),(function(){return a.endTape()}),(function(){return a.tidy("forward",e)}));g.hu(o instanceof k.es,(function(){return"The result y returned by f() must be a tensor."}));var u=x(this.state.activeTape,t,o);if(!i&&0===u.length&&t.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",(function(){var e={};e[o.id]=null==n?E(o.shape):n,w(e,u,(function(e){return a.tidy(e)}),I);var i=t.map((function(t){return e[t.id]}));return 0===a.state.gradientDepth&&(a.state.activeTape.forEach((function(e){var t,n=(0,r.Z)(e.saved);try{for(n.s();!(t=n.n()).done;){t.value.dispose()}}catch(a){n.e(a)}finally{n.f()}})),a.state.activeTape=null),{value:o,grads:i}}))}},{key:"customGrad",value:function(e){var t=this;return g.hu(g.mf(e),(function(){return"The f passed in customGrad(f) must be a function."})),function(){for(var n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];var i;g.hu(r.every((function(e){return e instanceof k.es})),(function(){return"The args passed in customGrad(f)(x1, x2,...) must all be tensors"}));var o={};r.forEach((function(e,t){o[t]=e}));var u=function(t,n){return i=e.apply(void 0,[].concat(r,[n])),g.hu(i.value instanceof k.es,(function(){return"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"})),g.hu(g.mf(i.gradFunc),(function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."})),i.value},s=function(e,t){var n=i.gradFunc(e,t),a=Array.isArray(n)?n:[n];g.hu(a.length===r.length,(function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."})),g.hu(a.every((function(e){return e instanceof k.es})),(function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors."}));var o={};return a.forEach((function(e,t){o[t]=function(){return e}})),o};return t.runKernelFunc({forwardFunc:u,backwardsFunc:s,inputs:o})}}},{key:"readSync",value:function(e){return this.state.tensorInfo.get(e).backend.readSync(e)}},{key:"read",value:function(e){return this.state.tensorInfo.get(e).backend.read(e)}},{key:"readToGPU",value:function(e,t){return this.state.tensorInfo.get(e).backend.readToGPU(e,t)}},{key:"time",value:function(){var e=(0,i.Z)(c().mark((function e(t){var n,r;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=(0,m.now)(),e.next=3,this.backend.time(t);case 3:return(r=e.sent).wallMs=(0,m.now)()-n,e.abrupt("return",r);case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"track",value:function(e){return null!=this.state.activeScope&&(e.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(e)),e}},{key:"registeredVariables",get:function(){return this.state.registeredVariables}},{key:"reset",value:function(){for(var e in this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new C,this.registry)this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null}}]),e}();function E(e){var t=(0,g.p8)((0,g.NA)(e),"float32");return T.makeTensor(t,e,"float32")}function N(){var e=(0,d.D)();if(null==e._tfengine){var t=new f.qA(e);e._tfengine=new A(t)}return(0,f.iG)(e._tfengine.ENV),(0,k.Vi)((function(){return e._tfengine})),e._tfengine}A.nextTensorId=0,A.nextVariableId=0;var T=N();function I(e,t){var n={a:e,b:t};return T.runKernel(h.mm_,n)}},5050:function(e,t,n){"use strict";n.d(t,{OB:function(){return p},Vi:function(){return v},iG:function(){return m},qA:function(){return f}});var r=n(9439),a=n(5861),i=n(5671),o=n(3144),u=n(4687),s=n.n(u),c=n(6147),l="tfjsflags",f=function(){function e(t){(0,i.Z)(this,e),this.global=t,this.flags={},this.flagRegistry={},this.urlFlags={},this.getQueryParams=d,this.populateURLFlags()}return(0,o.Z)(e,[{key:"setPlatform",value:function(e,t){null!=this.platform&&(p().getBool("IS_TEST")||p().getBool("PROD")||console.warn("Platform ".concat(this.platformName," has already been set. ")+"Overwriting the platform with ".concat(e,"."))),this.platformName=e,this.platform=t}},{key:"registerFlag",value:function(e,t,n){if(this.flagRegistry[e]={evaluationFn:t,setHook:n},null!=this.urlFlags[e]){var r=this.urlFlags[e];p().getBool("IS_TEST")||p().getBool("PROD")||console.warn("Setting feature override from URL ".concat(e,": ").concat(r,".")),this.set(e,r)}}},{key:"getAsync",value:function(){var e=(0,a.Z)(s().mark((function e(t){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t in this.flags)){e.next=2;break}return e.abrupt("return",this.flags[t]);case 2:return e.next=4,this.evaluateFlag(t);case 4:return this.flags[t]=e.sent,e.abrupt("return",this.flags[t]);case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"get",value:function(e){if(e in this.flags)return this.flags[e];var t=this.evaluateFlag(e);if((0,c.tI)(t))throw new Error("Flag ".concat(e," cannot be synchronously evaluated. ")+"Please use getAsync() instead.");return this.flags[e]=t,this.flags[e]}},{key:"getNumber",value:function(e){return this.get(e)}},{key:"getBool",value:function(e){return this.get(e)}},{key:"getString",value:function(e){return this.get(e)}},{key:"getFlags",value:function(){return this.flags}},{key:"features",get:function(){return this.flags}},{key:"set",value:function(e,t){if(null==this.flagRegistry[e])throw new Error("Cannot set flag ".concat(e," as it has not been registered."));this.flags[e]=t,null!=this.flagRegistry[e].setHook&&this.flagRegistry[e].setHook(t)}},{key:"evaluateFlag",value:function(e){if(null==this.flagRegistry[e])throw new Error("Cannot evaluate flag '".concat(e,"': no evaluation function found."));return this.flagRegistry[e].evaluationFn()}},{key:"setFlags",value:function(e){this.flags=Object.assign({},e)}},{key:"reset",value:function(){this.flags={},this.urlFlags={},this.populateURLFlags()}},{key:"populateURLFlags",value:function(){var e=this;if("undefined"!==typeof this.global&&"undefined"!==typeof this.global.location&&"undefined"!==typeof this.global.location.search){var t=this.getQueryParams(this.global.location.search);if(l in t)t.tfjsflags.split(",").forEach((function(t){var n=t.split(":"),a=(0,r.Z)(n,2),i=a[0],o=a[1];e.urlFlags[i]=function(e,t){var n=t.toLowerCase();return"true"===n||"false"===n?"true"===n:"".concat(+n)===n?+n:t}(0,o)}))}}}]),e}();function d(e){var t={};return e.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,(function(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];return h(t,r[0],r[1]),r.join("=")})),t}function h(e,t,n){e[decodeURIComponent(t)]=decodeURIComponent(n||"")}function p(){return v}var v=null;function m(e){v=e}},6581:function(e,t,n){"use strict";var r;function a(){if(null==r){var e;if("undefined"!==typeof window)e=window;else if("undefined"!==typeof n.g)e=n.g;else if("undefined"!==typeof process)e=process;else{if("undefined"===typeof self)throw new Error("Could not find a global object");e=self}r=e}return r}function i(e,t){var n=function(){var e=a();return null==e._tfGlobals&&(e._tfGlobals=new Map),e._tfGlobals}();if(n.has(e))return n.get(e);var r=t();return n.set(e,r),n.get(e)}n.d(t,{D:function(){return a},R:function(){return i}})},5875:function(e,t,n){"use strict";n.d(t,{B9:function(){return m},CQ:function(){return b},Cd:function(){return x},Cn:function(){return g},G4:function(){return u},MX:function(){return l},N5:function(){return p},N8:function(){return f},N_:function(){return w},R:function(){return s},SR:function(){return d},VY:function(){return E},XV:function(){return y},cF:function(){return c},cj:function(){return k},jq:function(){return C},lu:function(){return v},sq:function(){return h},x3:function(){return _},y3:function(){return A},ze:function(){return S}});var r=n(318),a=n(5050),i=n(4376),o=n(9064);function u(){(0,a.OB)().set("PROD",!0)}function s(){(0,a.OB)().set("DEBUG",!0)}function c(){(0,a.OB)().set("DEPRECATION_WARNINGS_ENABLED",!1),console.warn("TensorFlow.js deprecation warnings have been disabled.")}function l(e){(0,a.OB)().getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(e+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")}function f(){r.BV.disposeVariables()}function d(){return r.BV}function h(){return r.BV.memory()}function p(e){return r.BV.profile(e)}function v(e,t){return r.BV.tidy(e,t)}function m(e){(0,o.getTensorsInContainer)(e).forEach((function(e){return e.dispose()}))}function g(e){return r.BV.keep(e)}function y(e){return r.BV.time(e)}function b(e){return r.BV.setBackend(e)}function x(){return r.BV.ready()}function w(){return r.BV.backendName}function k(e){r.BV.removeBackend(e)}function _(e){return r.BV.findBackend(e)}function S(e){return r.BV.findBackendFactory(e)}function C(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return r.BV.registerBackend(e,t,n)}function A(){return r.BV.backend}function E(e,t){(0,a.OB)().setPlatform(e,t)}(0,i.FZ)(l)},6450:function(e,t,n){"use strict";n.d(t,{UQ:function(){return s},cb:function(){return h},fN:function(){return f},h7:function(){return l},pn:function(){return d},ti:function(){return c}});var r=n(3433),a=n(318),i=n(4376),o=n(8354),u=n(6147);function s(e){return u.hu(u.mf(e),(function(){return"The f passed in grad(f) must be a function"})),function(t,n){var r=(0,o._1)(t,"x","tf.grad","string_or_numeric"),i=null!=n?(0,o._1)(n,"dy","tf.grad"):null;return a.BV.tidy((function(){var t=a.BV.gradients((function(){return e(r)}),[r],i),n=t.value,o=t.grads;return null!=i&&u.k5(n.shape,i.shape,"The shape of dy passed in grad(f)(x, dy) must match the shape returned by f(x)"),p(o),o[0]}))}}function c(e){return u.hu(u.mf(e),(function(){return"The f passed in grads(f) must be a function"})),function(t,n){u.hu(Array.isArray(t),(function(){return"The args passed in grads(f)(args) must be an array of `Tensor`s or `TensorLike`s"}));var i=(0,o.sI)(t,"args","tf.grads","string_or_numeric"),s=null!=n?(0,o._1)(n,"dy","tf.grads"):null;return a.BV.tidy((function(){var t=a.BV.gradients((function(){return e.apply(void 0,(0,r.Z)(i))}),i,s),n=t.value,o=t.grads;return null!=s&&u.k5(n.shape,s.shape,"The shape of dy passed in grads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),p(o),o}))}}function l(e){return u.hu(u.mf(e),(function(){return"The f passed in valueAndGrad(f) must be a function"})),function(t,n){u.hu(t instanceof i.es,(function(){return"The x passed in valueAndGrad(f)(x) must be a tensor"})),u.hu(null==n||n instanceof i.es,(function(){return"The dy passed in valueAndGrad(f)(x, dy) must be a tensor"}));var r=a.BV.gradients((function(){return e(t)}),[t],n),o=r.grads,s=r.value;return p(o),{grad:o[0],value:s}}}function f(e){return u.hu(u.mf(e),(function(){return"The f passed in valueAndGrads(f) must be a function"})),function(t,n){u.hu(Array.isArray(t)&&t.every((function(e){return e instanceof i.es})),(function(){return"The args passed in valueAndGrads(f)(args) must be array of tensors"})),u.hu(null==n||n instanceof i.es,(function(){return"The dy passed in valueAndGrads(f)(args, dy) must be a tensor"}));var o=a.BV.gradients((function(){return e.apply(void 0,(0,r.Z)(t))}),t,n);return null!=n&&u.k5(o.value.shape,n.shape,"The shape of dy passed in valueAndGrads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),p(o.grads),o}}function d(e,t){u.hu(u.mf(e),(function(){return"The f passed in variableGrads(f) must be a function"})),u.hu(null==t||Array.isArray(t)&&t.every((function(e){return e instanceof i._w})),(function(){return"The varList passed in variableGrads(f, varList) must be an array of variables"}));var n=null!=t;if(!n)for(var r in t=[],a.BV.registeredVariables)t.push(a.BV.registeredVariables[r]);var o=n?t.filter((function(e){return!e.trainable})):null,s=t.length;t=t.filter((function(e){return e.trainable})),u.hu(t.length>0,(function(){return"variableGrads() expects at least one of the input variables to "+"be trainable, but none of the ".concat(s," variables is ")+"trainable."}));var c=a.BV.gradients(e,t,null,!0),l=c.value,f=c.grads;u.hu(f.some((function(e){return null!=e})),(function(){return"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."})),u.hu(0===l.rank,(function(){return"The f passed in variableGrads(f) must return a scalar, but it "+"returned a rank-".concat(l.rank," tensor")}));var d={};return t.forEach((function(e,t){null!=f[t]&&(d[e.name]=f[t])})),null!=o&&o.forEach((function(e){return d[e.name]=null})),{value:l,grads:d}}function h(e){return a.BV.customGrad(e)}function p(e){if(e.filter((function(e){return null==e})).length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that\n    the f you passed encloses all operations that lead from x to y.")}},3613:function(e,t,n){"use strict";n.r(t),n.d(t,{Abs:function(){return Bt.SYM},Acos:function(){return Bt.VGw},Acosh:function(){return Bt.SpW},AdadeltaOptimizer:function(){return Ve},AdagradOptimizer:function(){return Ge},AdamOptimizer:function(){return Ke},AdamaxOptimizer:function(){return Qe},Add:function(){return Bt.mm_},AddN:function(){return Bt.Xze},All:function(){return Bt.oT6},Any:function(){return Bt.IKK},ArgMax:function(){return Bt.sJF},ArgMin:function(){return Bt.aJk},Asin:function(){return Bt.M2y},Asinh:function(){return Bt.qw7},Atan:function(){return Bt.jMg},Atan2:function(){return Bt.QCc},Atanh:function(){return Bt.Oyi},AvgPool:function(){return Bt.JhU},AvgPool3D:function(){return Bt._k9},AvgPool3DGrad:function(){return Bt.IMb},AvgPoolGrad:function(){return Bt.ROF},BatchMatMul:function(){return Bt.XLW},BatchToSpaceND:function(){return Bt.zws},Bincount:function(){return Bt.zvY},BitwiseAnd:function(){return Bt.hCO},BroadcastArgs:function(){return Bt.eEB},BroadcastTo:function(){return Bt.Ly9},Cast:function(){return Bt.RFZ},Ceil:function(){return Bt.gJX},ClipByValue:function(){return Bt.xnO},Complex:function(){return Bt.Zz9},ComplexAbs:function(){return Bt.yj2},Concat:function(){return Bt.Eh3},Conv2D:function(){return Bt.mhS},Conv2DBackpropFilter:function(){return Bt.wUP},Conv2DBackpropInput:function(){return Bt.wm},Conv3D:function(){return Bt.x12},Conv3DBackpropFilterV2:function(){return Bt.o2y},Conv3DBackpropInputV2:function(){return Bt.ik2},Cos:function(){return Bt.mc4},Cosh:function(){return Bt.TR1},CropAndResize:function(){return Bt.VcC},Cumprod:function(){return Bt.Byc},Cumsum:function(){return Bt.iHb},DataStorage:function(){return Fr.JL},DenseBincount:function(){return Bt.QRR},DepthToSpace:function(){return Bt.T0n},DepthwiseConv2dNative:function(){return Bt.cie},DepthwiseConv2dNativeBackpropFilter:function(){return Bt.sL$},DepthwiseConv2dNativeBackpropInput:function(){return Bt.y7R},Diag:function(){return Bt.$w},Dilation2D:function(){return Bt.p4S},Dilation2DBackpropFilter:function(){return Bt.Vn9},Dilation2DBackpropInput:function(){return Bt.ekb},Draw:function(){return Bt.hGc},ENV:function(){return y.Vi},Einsum:function(){return Bt.$g6},Elu:function(){return Bt.SX0},EluGrad:function(){return Bt.HEU},Environment:function(){return y.qA},Equal:function(){return Bt.hdR},Erf:function(){return Bt.Omj},Exp:function(){return Bt.NEP},ExpandDims:function(){return Bt.YFo},Expm1:function(){return Bt.Y0y},FFT:function(){return Bt.vwp},Fill:function(){return Bt.deh},FlipLeftRight:function(){return Bt.Uyb},Floor:function(){return Bt.OR},FloorDiv:function(){return Bt.jeX},FromPixels:function(){return Bt.eBW},FusedBatchNorm:function(){return Bt.sHE},FusedConv2D:function(){return Bt._V0},FusedDepthwiseConv2D:function(){return Bt.luS},GatherNd:function(){return Bt.q1x},GatherV2:function(){return Bt.qi_},Greater:function(){return Bt.iZT},GreaterEqual:function(){return Bt.Acj},IFFT:function(){return Bt.Qg5},Identity:function(){return Bt.iJz},Imag:function(){return Bt.J_u},IsFinite:function(){return Bt.avt},IsInf:function(){return Bt.iWB},IsNan:function(){return Bt.r7n},KernelBackend:function(){return Fr.Zu},LRN:function(){return Bt.eZ0},LRNGrad:function(){return Bt.Hhh},LeakyRelu:function(){return Bt.J$2},Less:function(){return Bt.vtC},LessEqual:function(){return Bt.CAk},LinSpace:function(){return Bt.e7N},Log:function(){return Bt.ZbH},Log1p:function(){return Bt.kU},LogSoftmax:function(){return Bt.qCd},LogicalAnd:function(){return Bt.PYm},LogicalNot:function(){return Bt.VfG},LogicalOr:function(){return Bt.MZg},LogicalXor:function(){return Bt.w6g},LowerBound:function(){return Bt.qIC},MatrixBandPart:function(){return Bt.J7O},Max:function(){return Bt.YoZ},MaxPool:function(){return Bt.mTV},MaxPool3D:function(){return Bt.OAf},MaxPool3DGrad:function(){return Bt.OU7},MaxPoolGrad:function(){return Bt.OV7},MaxPoolWithArgmax:function(){return Bt.vFR},Maximum:function(){return Bt.BMI},Mean:function(){return Bt.q2K},Min:function(){return Bt.c17},Minimum:function(){return Bt.q8u},MirrorPad:function(){return Bt.jQs},Mod:function(){return Bt.Vbg},MomentumOptimizer:function(){return et},Multinomial:function(){return Bt.NZg},Multiply:function(){return Bt.wYn},Neg:function(){return Bt.kuV},NonMaxSuppressionV3:function(){return Bt.uv1},NonMaxSuppressionV4:function(){return Bt.cye},NonMaxSuppressionV5:function(){return Bt.W0H},NotEqual:function(){return Bt.yQU},OP_SCOPE_SUFFIX:function(){return bn.zvA},OneHot:function(){return Bt.we_},OnesLike:function(){return Bt.qWM},Optimizer:function(){return We},OptimizerConstructors:function(){return gn},Pack:function(){return Bt.QiL},PadV2:function(){return Bt.lyA},Pool:function(){return Bt.Kgp},Pow:function(){return Bt.pe_},Prelu:function(){return Bt.o0g},Prod:function(){return Bt.DlI},RMSPropOptimizer:function(){return tt},RaggedGather:function(){return Bt.dDz},RaggedRange:function(){return Bt.CQl},RaggedTensorToTensor:function(){return Bt.BiW},Range:function(){return Bt.e6w},Rank:function(){return yn.yw},Real:function(){return Bt.xJR},RealDiv:function(){return Bt.oHH},Reciprocal:function(){return Bt.$HU},Reduction:function(){return xn.I},Relu:function(){return Bt.qkr},Relu6:function(){return Bt.SbG},Reshape:function(){return Bt.HZH},ResizeBilinear:function(){return Bt._Yw},ResizeBilinearGrad:function(){return Bt.zbQ},ResizeNearestNeighbor:function(){return Bt.dpD},ResizeNearestNeighborGrad:function(){return Bt.Hmb},Reverse:function(){return Bt.mKl},RotateWithOffset:function(){return Bt.b9H},Round:function(){return Bt.e07},Rsqrt:function(){return Bt.bV0},SGDOptimizer:function(){return Je},ScatterNd:function(){return Bt.xQA},SearchSorted:function(){return Bt.nr8},Select:function(){return Bt.PhF},Selu:function(){return Bt.oFR},Sigmoid:function(){return Bt.a5O},Sign:function(){return Bt.i5y},Sin:function(){return Bt.RQH},Sinh:function(){return Bt.wYB},Slice:function(){return Bt.p2w},Softmax:function(){return Bt.Gcp},Softplus:function(){return Bt.MRv},SpaceToBatchND:function(){return Bt.TQc},SparseFillEmptyRows:function(){return Bt.O3z},SparseReshape:function(){return Bt.nhH},SparseSegmentMean:function(){return Bt.w3H},SparseSegmentSum:function(){return Bt.ZjV},SparseToDense:function(){return Bt.D2d},SplitV:function(){return Bt.L8s},Sqrt:function(){return Bt.FKq},Square:function(){return Bt.bK0},SquaredDifference:function(){return Bt._tC},StaticRegexReplace:function(){return Bt.e0R},Step:function(){return Bt.h8e},StridedSlice:function(){return Bt.jQk},StringNGrams:function(){return Bt._JP},StringSplit:function(){return Bt.s1s},StringToHashBucketFast:function(){return Bt.XkS},Sub:function(){return Bt.Tr8},Sum:function(){return Bt.GBy},Tan:function(){return Bt.sEM},Tanh:function(){return Bt.MIZ},Tensor:function(){return _e.es},TensorBuffer:function(){return _e.YD},TensorScatterUpdate:function(){return Bt.SIB},Tile:function(){return Bt.n9L},TopK:function(){return Bt.cWu},Transform:function(){return Bt.wx7},Transpose:function(){return Bt.G3Y},Unique:function(){return Bt.kpP},Unpack:function(){return Bt.ToN},UnsortedSegmentSum:function(){return Bt.Qvg},UpperBound:function(){return Bt.XDQ},Variable:function(){return _e._w},ZerosLike:function(){return Bt.RuY},_FusedMatMul:function(){return Bt.usg},abs:function(){return bn.WnP},acos:function(){return bn.Khb},acosh:function(){return bn.__u},add:function(){return bn.IHx},addN:function(){return bn.QBD},all:function(){return bn.$6P},any:function(){return bn.YjB},argMax:function(){return bn.NqF},argMin:function(){return bn.vHJ},asin:function(){return bn.ZRM},asinh:function(){return bn.VfV},atan:function(){return bn.z4N},atan2:function(){return bn.fvJ},atanh:function(){return bn.C80},avgPool:function(){return bn.wS1},avgPool3d:function(){return bn.uR5},backend:function(){return Ne.y3},backend_util:function(){return f},basicLSTMCell:function(){return bn.zEQ},batchNorm:function(){return bn.tgs},batchNorm2d:function(){return bn.Dxk},batchNorm3d:function(){return bn.JY5},batchNorm4d:function(){return bn.p3b},batchToSpaceND:function(){return bn.E4h},bincount:function(){return bn.yE8},bitwiseAnd:function(){return bn.ycw},booleanMaskAsync:function(){return bn.anm},broadcastArgs:function(){return bn.XsQ},broadcastTo:function(){return bn.UFq},broadcast_util:function(){return jt},browser:function(){return u},buffer:function(){return bn.f3b},cast:function(){return bn.pju},ceil:function(){return bn.mDi},clipByValue:function(){return bn.iUl},clone:function(){return bn.d9v},complex:function(){return bn.PYB},concat:function(){return bn.zoF},concat1d:function(){return bn.gME},concat2d:function(){return bn.Izb},concat3d:function(){return bn.MNy},concat4d:function(){return bn.ZaL},conv1d:function(){return bn.PAt},conv2d:function(){return bn.Tek},conv2dTranspose:function(){return bn.bc},conv3d:function(){return bn.pdZ},conv3dTranspose:function(){return bn.$QV},copyRegisteredKernels:function(){return zt.T3},cos:function(){return bn.mCk},cosh:function(){return bn.f9Y},cosineWindow:function(){return bn.mew},cumprod:function(){return bn.$Gn},cumsum:function(){return bn.zbp},customGrad:function(){return Re.cb},denseBincount:function(){return bn.ppE},deprecationWarn:function(){return Ne.MX},depthToSpace:function(){return bn.nTT},depthwiseConv2d:function(){return bn.B10},device_util:function(){return r},diag:function(){return bn.Ka3},dilation2d:function(){return bn.WmZ},disableDeprecationWarnings:function(){return Ne.cF},dispose:function(){return Ne.B9},disposeVariables:function(){return Ne.N8},div:function(){return bn.hiC},divNoNan:function(){return bn.NTj},dot:function(){return bn.AKD},dropout:function(){return bn.rvX},einsum:function(){return bn.WYO},elu:function(){return bn.pyx},enableDebugMode:function(){return Ne.R},enableProdMode:function(){return Ne.G4},enclosingPowerOfTwo:function(){return bn.GRh},engine:function(){return Ne.SR},ensureShape:function(){return bn.EDe},env:function(){return y.OB},equal:function(){return bn.DgJ},erf:function(){return bn.qNN},euclideanNorm:function(){return bn.d2q},exp:function(){return bn.Qqt},expandDims:function(){return bn.dt4},expm1:function(){return bn.t$B},eye:function(){return bn.iyy},fft:function(){return bn.kp_},fill:function(){return bn.hlL},findBackend:function(){return Ne.x3},findBackendFactory:function(){return Ne.ze},floor:function(){return bn.GWj},floorDiv:function(){return bn.qPi},fused:function(){return bn.imm},gather:function(){return bn.Iqj},gatherND:function(){return bn.dbB},gather_util:function(){return s},getBackend:function(){return Ne.N_},getGradient:function(){return zt.uk},getKernel:function(){return zt.pI},getKernelsForBackend:function(){return zt.tr},grad:function(){return Re.UQ},grads:function(){return Re.ti},greater:function(){return bn.pjt},greaterEqual:function(){return bn.brS},ifft:function(){return bn.Sxn},imag:function(){return bn.asL},image:function(){return bn.BHj},inTopKAsync:function(){return bn.V3u},io:function(){return i},irfft:function(){return bn.wx0},isFinite:function(){return bn.xVT},isInf:function(){return bn.UWc},isNaN:function(){return bn.i2d},keep:function(){return Ne.Cn},kernel_impls:function(){return d},leakyRelu:function(){return bn.hi7},less:function(){return bn.d9m},lessEqual:function(){return bn.zN1},linalg:function(){return bn.$r2},linspace:function(){return bn.SX3},localResponseNormalization:function(){return bn.G9k},log:function(){return bn.cM7},log1p:function(){return bn.Krr},logSigmoid:function(){return bn.e_t},logSoftmax:function(){return bn.CmS},logSumExp:function(){return bn.l_t},logicalAnd:function(){return bn.HvI},logicalNot:function(){return bn.hJK},logicalOr:function(){return bn.K5V},logicalXor:function(){return bn.egP},losses:function(){return bn.MB5},lowerBound:function(){return bn.eab},matMul:function(){return bn.OI3},math:function(){return o},max:function(){return bn.Fp7},maxPool:function(){return bn._sB},maxPool3d:function(){return bn.YQQ},maxPoolWithArgmax:function(){return bn.Ip$},maximum:function(){return bn.gWQ},mean:function(){return bn.J69},memory:function(){return Ne.sq},meshgrid:function(){return bn.ry_},min:function(){return bn.VV$},minimum:function(){return bn.LTh},mirrorPad:function(){return bn.VdP},mod:function(){return bn.wQq},moments:function(){return bn.Gi7},movingAverage:function(){return bn.p_},mul:function(){return bn.dC7},multiRNNCell:function(){return bn.rq4},multinomial:function(){return bn.SJ_},neg:function(){return bn.W76},nextFrame:function(){return _n},norm:function(){return bn.KOy},notEqual:function(){return bn.Quu},oneHot:function(){return bn.lfX},ones:function(){return bn.iUs},onesLike:function(){return bn.JpU},op:function(){return bn.op},outerProduct:function(){return bn.N2O},pad:function(){return bn.vku},pad1d:function(){return bn.pNR},pad2d:function(){return bn.koy},pad3d:function(){return bn.t1L},pad4d:function(){return bn.lGY},pool:function(){return bn.d_R},pow:function(){return bn.sQ3},prelu:function(){return bn.AL3},print:function(){return bn.S0v},prod:function(){return bn.WVs},profile:function(){return Ne.N5},raggedGather:function(){return bn.$gW},raggedRange:function(){return bn.VT$},raggedTensorToTensor:function(){return bn.N89},rand:function(){return bn.TN_},randomGamma:function(){return bn.wzB},randomNormal:function(){return bn.nGf},randomStandardNormal:function(){return bn.ruB},randomUniform:function(){return bn.LGj},randomUniformInt:function(){return bn.pe5},range:function(){return bn.w6H},ready:function(){return Ne.Cd},real:function(){return bn.kwC},reciprocal:function(){return bn.M25},registerBackend:function(){return Ne.jq},registerGradient:function(){return zt.Li},registerKernel:function(){return zt.wC},relu:function(){return bn.UYe},relu6:function(){return bn.btT},removeBackend:function(){return Ne.cj},reshape:function(){return bn.XLQ},reverse:function(){return bn.GYS},reverse1d:function(){return bn.SDf},reverse2d:function(){return bn.diP},reverse3d:function(){return bn.sx7},reverse4d:function(){return bn.mG2},rfft:function(){return bn.QEs},round:function(){return bn.NMM},rsqrt:function(){return bn.bp0},scalar:function(){return bn.iD$},scatterND:function(){return bn.snQ},scatter_util:function(){return $t},searchSorted:function(){return bn.zcT},selu:function(){return bn.U8D},separableConv2d:function(){return bn.U_I},serialization:function(){return a},setBackend:function(){return Ne.CQ},setPlatform:function(){return Ne.VY},setdiff1dAsync:function(){return bn.ODp},sigmoid:function(){return bn.XD2},sign:function(){return bn.Xxe},signal:function(){return bn.tdS},sin:function(){return bn.O$l},sinh:function(){return bn.R_K},slice:function(){return bn.tPi},slice1d:function(){return bn.jZU},slice2d:function(){return bn.SmN},slice3d:function(){return bn.CnO},slice4d:function(){return bn.p0P},slice_util:function(){return Qt},softmax:function(){return bn.XAC},softplus:function(){return bn.Wvh},spaceToBatchND:function(){return bn.fBT},sparse:function(){return bn.rVs},sparseToDense:function(){return bn.ers},spectral:function(){return bn.uN7},split:function(){return bn.Vl2},sqrt:function(){return bn._b3},square:function(){return bn.h62},squaredDifference:function(){return bn.$i},squeeze:function(){return bn.L9e},stack:function(){return bn.knu},step:function(){return bn.Nbs},stridedSlice:function(){return bn.NXj},string:function(){return bn.Z_8},sub:function(){return bn.luU},sum:function(){return bn.Smz},sumOutType:function(){return yn.z4},tan:function(){return bn.ORZ},tanh:function(){return bn.AEp},tensor:function(){return bn.XeE},tensor1d:function(){return bn.RRF},tensor2d:function(){return bn.odF},tensor3d:function(){return bn.wOQ},tensor4d:function(){return bn.yXz},tensor5d:function(){return bn.Bfx},tensor6d:function(){return bn.xZs},tensorScatterUpdate:function(){return bn.Pg0},tensor_util:function(){return Jt},test_util:function(){return c},tidy:function(){return Ne.lu},tile:function(){return bn.Gg6},time:function(){return Ne.XV},topk:function(){return bn.hg7},train:function(){return wn},transpose:function(){return bn.p4s},truncatedNormal:function(){return bn.Xu6},unique:function(){return bn.Two},unregisterGradient:function(){return zt.bt},unregisterKernel:function(){return zt.nE},unsortedSegmentSum:function(){return bn.pUJ},unstack:function(){return bn.HHK},upcastType:function(){return yn.x8},upperBound:function(){return bn.GaM},util:function(){return en},valueAndGrad:function(){return Re.h7},valueAndGrads:function(){return Re.fN},variable:function(){return bn.VD$},variableGrads:function(){return Re.pn},version_core:function(){return mn},where:function(){return bn.arb},whereAsync:function(){return bn.itS},zeros:function(){return bn.lls},zerosLike:function(){return bn.P84}});var r={};n.r(r),n.d(r,{isBrowser:function(){return g},isMobile:function(){return m},mockIsMobile:function(){return v}});var a={};n.r(a),n.d(a,{Serializable:function(){return Ze},SerializationMap:function(){return Le},getRegisteredName:function(){return Ue},registerClass:function(){return Pe}});var i={};n.r(i),n.d(i,{CompositeArrayBuffer:function(){return F.w},browserFiles:function(){return ot},browserHTTPRequest:function(){return wt},concatenateArrayBuffers:function(){return A.JY},copyModel:function(){return le},decodeWeights:function(){return A.dI},decodeWeightsStream:function(){return A.r},encodeWeights:function(){return A.yz},fromMemory:function(){return Ct},fromMemorySync:function(){return At},getLoadHandlers:function(){return D},getModelArtifactsForJSON:function(){return A.jN},getModelArtifactsForJSONSync:function(){return A.ji},getModelArtifactsInfoForJSON:function(){return A.Q},getSaveHandlers:function(){return I},getWeightSpecs:function(){return A.hu},http:function(){return xt},isHTTPScheme:function(){return yt},listModels:function(){return oe},loadWeights:function(){return ht},moveModel:function(){return de},registerLoadRouter:function(){return T},registerSaveRouter:function(){return N},removeModel:function(){return se},weightsLoaderFactory:function(){return vt},withSaveHandler:function(){return Et},withSaveHandlerSync:function(){return Nt}});var o={};n.r(o),n.d(o,{confusionMatrix:function(){return Rt}});var u={};n.r(u),n.d(u,{draw:function(){return Xt},fromPixels:function(){return Kt},fromPixelsAsync:function(){return Wt},toPixels:function(){return Gt}});var s={};n.r(s),n.d(s,{prepareAndValidate:function(){return Yt}});var c={};n.r(c),n.d(c,{TEST_EPSILON_FLOAT16:function(){return tn},createVideoElement:function(){return hn},encodeStrings:function(){return dn},expectArrayBuffersEqual:function(){return fn},expectArraysClose:function(){return nn},expectArraysEqual:function(){return un},expectNumbersClose:function(){return sn},expectPromiseToFail:function(){return on},expectValuesInRange:function(){return ln},play:function(){return pn},testEpsilon:function(){return rn}});var l={};n.r(l),n.d(l,{collectGatherOpShapeInfo:function(){return Er},computeOutShape:function(){return Ar},segOpComputeOptimalWindowSize:function(){return Cr}});var f={};n.r(f),n.d(f,{ERF_A1:function(){return Vn},ERF_A2:function(){return qn},ERF_A3:function(){return Gn},ERF_A4:function(){return Hn},ERF_A5:function(){return Xn},ERF_P:function(){return Wn},PARALLELIZE_THRESHOLD:function(){return On},RowPartitionType:function(){return En},SELU_SCALE:function(){return Un.$},SELU_SCALEALPHA:function(){return Un.y},applyActivation:function(){return Tn.QH},assertAndGetBroadcastShape:function(){return jt.assertAndGetBroadcastShape},assertAxesAreInnerMostDims:function(){return Sn.lB},assertParamsConsistent:function(){return Cn},assignToTypedArray:function(){return tr},axesAreInnerMostDims:function(){return Sn.YB},calculateShapes:function(){return $t.calculateShapes},checkEinsumDimSizes:function(){return sr},checkPadOnDimRoundingMode:function(){return Nn.m},combineLocations:function(){return Sn.Vh},combineRaggedTensorToTensorShapes:function(){return In},complexWithEvenIndex:function(){return Qn},complexWithOddIndex:function(){return Jn},computeConv2DInfo:function(){return Nn.Ix},computeConv3DInfo:function(){return Nn.jw},computeDefaultPad:function(){return Nn.aO},computeDilation2DInfo:function(){return Nn.Rf},computeOptimalWindowSize:function(){return Rn},computeOutAndReduceShapes:function(){return Sn.kz},computeOutShape:function(){return An},computePool2DInfo:function(){return Nn.Xw},computePool3DInfo:function(){return Nn.pl},convertConv2DDataFormat:function(){return Nn.sl},decodeEinsumEquation:function(){return or},eitherStridesOrDilationsAreOne:function(){return Nn.jT},expandShapeToKeepDim:function(){return Sn.rv},exponent:function(){return rr},exponents:function(){return nr},fromStringArrayToUint8:function(){return Tr},fromUint8ToStringArray:function(){return Nr},getAxesPermutation:function(){return Sn.Q3},getBroadcastDims:function(){return jt.getBroadcastDims},getComplexWithIndex:function(){return er},getEinsumComputePath:function(){return cr},getEinsumPermutation:function(){return ur},getFusedBiasGradient:function(){return Tn.pf},getFusedDyActivation:function(){return Tn.Fr},getImageCenter:function(){return jn},getInnerMostAxes:function(){return Sn.sY},getPermuted:function(){return zn},getRaggedRank:function(){return Fn},getReductionAxes:function(){return jt.getReductionAxes},getReshaped:function(){return Bn},getReshapedPermuted:function(){return Zn},getRowPartitionTypesHelper:function(){return Dn},getSliceBeginCoords:function(){return Ln},getSliceSize:function(){return Pn},getSparseFillEmptyRowsIndicesDenseShapeMismatch:function(){return hr},getSparseFillEmptyRowsNegativeIndexErrorMessage:function(){return pr},getSparseFillEmptyRowsOutOfRangeIndexErrorMessage:function(){return vr},getSparseReshapeEmptyTensorZeroOutputDimErrorMessage:function(){return yr},getSparseReshapeInputOutputMismatchErrorMessage:function(){return xr},getSparseReshapeInputOutputMultipleErrorMessage:function(){return br},getSparseReshapeMultipleNegativeOneOutputDimErrorMessage:function(){return mr},getSparseReshapeNegativeOutputDimErrorMessage:function(){return gr},getSparseSegmentReductionIndicesOutOfRangeErrorMessage:function(){return Sr},getSparseSegmentReductionNegativeSegmentIdsErrorMessage:function(){return wr},getSparseSegmentReductionNonIncreasingSegmentIdsErrorMessage:function(){return kr},getSparseSegmentReductionSegmentIdOutOfRangeErrorMessage:function(){return _r},getUndoAxesPermutation:function(){return Sn.LJ},isIdentityPermutation:function(){return lr},log:function(){return Kn.c},mergeRealAndImagArrays:function(){return Yn},prepareAndValidate:function(){return Yt},prepareSplitSize:function(){return dr},segment_util:function(){return l},shouldFuse:function(){return Tn.uy},slice_util:function(){return Qt},splitRealAndImagArrays:function(){return $n},stridesOrDilationsArePositive:function(){return Nn.U3},tupleValuesAreOne:function(){return Nn.I0},upcastType:function(){return yn.x8},validateDefaultValueShape:function(){return Mn},validateInput:function(){return $t.validateInput},validateUpdateShape:function(){return $t.validateUpdateShape},warn:function(){return Kn.Z}});var d={};n.r(d),n.d(d,{nonMaxSuppressionV3Impl:function(){return Ir.GP},nonMaxSuppressionV4Impl:function(){return Ir.qP},nonMaxSuppressionV5Impl:function(){return Ir.pA},whereImpl:function(){return Dr.Z}});var h,p=n(318);function v(e){h=e}function m(e){if(void 0!==h)return h;if(e||"undefined"!==typeof navigator&&null!=navigator){if(e||(e=navigator),"ReactNative"===e.product)return!0;var t=e.userAgent||e.vendor||("undefined"!==typeof window?window.opera:"");if(!t){var n=e;return n.userAgentData&&n.userAgentData.mobile}return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4))}return!1}function g(){return"undefined"!==typeof window&&null!=window.document||"undefined"!==typeof WorkerGlobalScope}var y=n(5050),b=(0,y.OB)();b.registerFlag("DEBUG",(function(){return!1}),(function(e){e&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")})),b.registerFlag("IS_BROWSER",(function(){return g()})),b.registerFlag("IS_NODE",(function(){return"undefined"!==typeof process&&"undefined"!==typeof process.versions&&"undefined"!==typeof process.versions.node})),b.registerFlag("IS_CHROME",(function(){return"undefined"!==typeof navigator&&null!=navigator&&null!=navigator.userAgent&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)})),b.registerFlag("IS_SAFARI",(function(){return"undefined"!==typeof navigator&&null!=navigator&&null!=navigator.userAgent&&/Safari/.test(navigator.userAgent)&&/Apple/.test(navigator.vendor)})),b.registerFlag("PROD",(function(){return!1})),b.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",(function(){return b.getBool("DEBUG")})),b.registerFlag("DEPRECATION_WARNINGS_ENABLED",(function(){return!0})),b.registerFlag("IS_TEST",(function(){return!1})),b.registerFlag("CHECK_COMPUTATION_FOR_ERRORS",(function(){return b.getBool("DEBUG")})),b.registerFlag("WRAP_TO_IMAGEBITMAP",(function(){return!1})),b.registerFlag("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU",(function(){return!1})),b.registerFlag("USE_SETTIMEOUTCUSTOM",(function(){return!1}));var x=n(5671),w=n(3144),k=n(7762),_=n(5861),S=n(4687),C=n.n(S),A=n(1434),E=function(){function e(){(0,x.Z)(this,e),this.saveRouters=[],this.loadRouters=[]}return(0,w.Z)(e,null,[{key:"getInstance",value:function(){return null==e.instance&&(e.instance=new e),e.instance}},{key:"registerSaveRouter",value:function(t){e.getInstance().saveRouters.push(t)}},{key:"registerLoadRouter",value:function(t){e.getInstance().loadRouters.push(t)}},{key:"getSaveHandlers",value:function(t){return e.getHandlers(t,"save")}},{key:"getLoadHandlers",value:function(t,n){return e.getHandlers(t,"load",n)}},{key:"getHandlers",value:function(t,n,r){var a=[];return("load"===n?e.getInstance().loadRouters:e.getInstance().saveRouters).forEach((function(e){var n=e(t,r);null!==n&&a.push(n)})),a}}]),e}(),N=function(e){return E.registerSaveRouter(e)},T=function(e){return E.registerLoadRouter(e)},I=function(e){return E.getSaveHandlers(e)},D=function(e,t){return E.getLoadHandlers(e,t)},F=n(5714),M="tensorflowjs",O="models_store",R="model_info_store";function j(){if(!(0,y.OB)().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");var e="undefined"===typeof window?self:window,t=e.indexedDB||e.mozIndexedDB||e.webkitIndexedDB||e.msIndexedDB||e.shimIndexedDB;if(null==t)throw new Error("The current browser does not appear to support IndexedDB.");return t}function B(e){var t=e.result;t.createObjectStore(O,{keyPath:"modelPath"}),t.createObjectStore(R,{keyPath:"modelPath"})}var z=function(){function e(t){if((0,x.Z)(this,e),this.indexedDB=j(),null==t||!t)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=t}return(0,w.Z)(e,[{key:"save",value:function(){var e=(0,_.Z)(C().mark((function e(t){return C().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t.modelTopology instanceof ArrayBuffer)){e.next=2;break}throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");case 2:return e.abrupt("return",this.databaseAction(this.modelPath,t));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"load",value:function(){var e=(0,_.Z)(C().mark((function e(){return C().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.databaseAction(this.modelPath));case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"databaseAction",value:function(e,t){var n=this;return new Promise((function(e,r){var a=n.indexedDB.open(M,1);a.onupgradeneeded=function(){return B(a)},a.onsuccess=function(){var i=a.result;if(null==t){var o=i.transaction(O,"readonly"),u=o.objectStore(O).get(n.modelPath);u.onsuccess=function(){if(null==u.result)return i.close(),r(new Error("Cannot find model with path '".concat(n.modelPath,"' ")+"in IndexedDB."));e(u.result.modelArtifacts)},u.onerror=function(e){return i.close(),r(u.error)},o.oncomplete=function(){return i.close()}}else{t.weightData=F.w.join(t.weightData);var s,c,l=(0,A.Q)(t),f=i.transaction(R,"readwrite"),d=f.objectStore(R);try{s=d.put({modelPath:n.modelPath,modelArtifactsInfo:l})}catch(h){return r(h)}s.onsuccess=function(){var a,o=(c=i.transaction(O,"readwrite")).objectStore(O);try{a=o.put({modelPath:n.modelPath,modelArtifacts:t,modelArtifactsInfo:l})}catch(h){return r(h)}a.onsuccess=function(){return e({modelArtifactsInfo:l})},a.onerror=function(e){var t=(d=f.objectStore(R)).delete(n.modelPath);t.onsuccess=function(){return i.close(),r(a.error)},t.onerror=function(e){return i.close(),r(a.error)}}},s.onerror=function(e){return i.close(),r(s.error)},f.oncomplete=function(){null==c?i.close():c.oncomplete=function(){return i.close()}}}},a.onerror=function(e){return r(a.error)}}))}}]),e}();z.URL_SCHEME="indexeddb://";var Z=function(e){return(0,y.OB)().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(z.URL_SCHEME)?(t=e.slice(z.URL_SCHEME.length),new z(t)):null;var t};E.registerSaveRouter(Z),E.registerLoadRouter(Z);var L=function(){function e(){(0,x.Z)(this,e),this.indexedDB=j()}return(0,w.Z)(e,[{key:"listModels",value:function(){var e=(0,_.Z)(C().mark((function e(){var t=this;return C().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){var r=t.indexedDB.open(M,1);r.onupgradeneeded=function(){return B(r)},r.onsuccess=function(){var t=r.result,a=t.transaction(R,"readonly"),i=a.objectStore(R).getAll();i.onsuccess=function(){var t,n={},r=(0,k.Z)(i.result);try{for(r.s();!(t=r.n()).done;){var a=t.value;n[a.modelPath]=a.modelArtifactsInfo}}catch(o){r.e(o)}finally{r.f()}e(n)},i.onerror=function(e){return t.close(),n(i.error)},a.oncomplete=function(){return t.close()}},r.onerror=function(e){return n(r.error)}})));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"removeModel",value:function(){var e=(0,_.Z)(C().mark((function e(t){var n=this;return C().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=(r=t).startsWith(z.URL_SCHEME)?r.slice(z.URL_SCHEME.length):r,e.abrupt("return",new Promise((function(e,r){var a=n.indexedDB.open(M,1);a.onupgradeneeded=function(){return B(a)},a.onsuccess=function(){var n,i=a.result,o=i.transaction(R,"readwrite"),u=o.objectStore(R),s=u.get(t);s.onsuccess=function(){if(null==s.result)return i.close(),r(new Error("Cannot find model with path '".concat(t,"' ")+"in IndexedDB."));var a=u.delete(t),o=function(){var a=(n=i.transaction(O,"readwrite")).objectStore(O).delete(t);a.onsuccess=function(){return e(s.result.modelArtifactsInfo)},a.onerror=function(e){return r(s.error)}};a.onsuccess=o,a.onerror=function(e){return o(),i.close(),r(s.error)}},s.onerror=function(e){return i.close(),r(s.error)},o.oncomplete=function(){null==n?i.close():n.oncomplete=function(){return i.close()}}},a.onerror=function(e){return r(a.error)}})));case 2:case"end":return e.stop()}var r}),e)})));return function(t){return e.apply(this,arguments)}}()}]),e}(),P=n(6147),U="/",W="tensorflowjs_models",V="info",q="model_topology",G="weight_specs",H="weight_data",X="model_metadata";function K(e){return{info:[W,e,V].join(U),topology:[W,e,q].join(U),weightSpecs:[W,e,G].join(U),weightData:[W,e,H].join(U),modelMetadata:[W,e,X].join(U)}}function Y(e){for(var t=0,n=Object.values(e);t<n.length;t++){var r=n[t];window.localStorage.removeItem(r)}}function $(e){var t=e.split(U);if(t.length<3)throw new Error("Invalid key format: ".concat(e));return t.slice(1,t.length-1).join(U)}var Q=function(){function e(t){if((0,x.Z)(this,e),!(0,y.OB)().getBool("IS_BROWSER")||"undefined"===typeof window||"undefined"===typeof window.localStorage)throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,null==t||!t)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=t,this.keys=K(this.modelPath)}return(0,w.Z)(e,[{key:"save",value:function(){var e=(0,_.Z)(C().mark((function e(t){var n,r,a,i,o;return C().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t.modelTopology instanceof ArrayBuffer)){e.next=4;break}throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");case 4:return n=JSON.stringify(t.modelTopology),r=JSON.stringify(t.weightSpecs),a=(0,A.Q)(t),i=F.w.join(t.weightData),e.prev=8,this.LS.setItem(this.keys.info,JSON.stringify(a)),this.LS.setItem(this.keys.topology,n),this.LS.setItem(this.keys.weightSpecs,r),this.LS.setItem(this.keys.weightData,(0,A._n)(i)),o={format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,signature:null!=t.signature?t.signature:void 0,userDefinedMetadata:null!=t.userDefinedMetadata?t.userDefinedMetadata:void 0,modelInitializer:null!=t.modelInitializer?t.modelInitializer:void 0,initializerSignature:null!=t.initializerSignature?t.initializerSignature:void 0,trainingConfig:null!=t.trainingConfig?t.trainingConfig:void 0},this.LS.setItem(this.keys.modelMetadata,JSON.stringify(o)),e.abrupt("return",{modelArtifactsInfo:a});case 18:throw e.prev=18,e.t0=e.catch(8),Y(this.keys),new Error("Failed to save model '".concat(this.modelPath,"' to local storage: ")+"size quota being exceeded is a possible cause of this failure: "+"modelTopologyBytes=".concat(a.modelTopologyBytes,", ")+"weightSpecsBytes=".concat(a.weightSpecsBytes,", ")+"weightDataBytes=".concat(a.weightDataBytes,"."));case 22:case"end":return e.stop()}}),e,this,[[8,18]])})));return function(t){return e.apply(this,arguments)}}()},{key:"load",value:function(){var e=(0,_.Z)(C().mark((function e(){var t,n,r,a,i,o,u;return C().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=(t=JSON.parse(this.LS.getItem(this.keys.info)))){e.next=3;break}throw new Error("In local storage, there is no model with name '".concat(this.modelPath,"'"));case 3:if("JSON"===t.modelTopologyType){e.next=5;break}throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");case 5:if(n={},null!=(r=JSON.parse(this.LS.getItem(this.keys.topology)))){e.next=9;break}throw new Error("In local storage, the topology of model '".concat(this.modelPath,"' ")+"is missing.");case 9:if(n.modelTopology=r,null!=(a=JSON.parse(this.LS.getItem(this.keys.weightSpecs)))){e.next=13;break}throw new Error("In local storage, the weight specs of model '".concat(this.modelPath,"' ")+"are missing.");case 13:if(n.weightSpecs=a,null!=(i=this.LS.getItem(this.keys.modelMetadata))&&(o=JSON.parse(i),n.format=o.format,n.generatedBy=o.generatedBy,n.convertedBy=o.convertedBy,null!=o.signature&&(n.signature=o.signature),null!=o.userDefinedMetadata&&(n.userDefinedMetadata=o.userDefinedMetadata),null!=o.modelInitializer&&(n.modelInitializer=o.modelInitializer),null!=o.initializerSignature&&(n.initializerSignature=o.initializerSignature),null!=o.trainingConfig&&(n.trainingConfig=o.trainingConfig)),null!=(u=this.LS.getItem(this.keys.weightData))){e.next=19;break}throw new Error("In local storage, the binary weight values of model "+"'".concat(this.modelPath,"' are missing."));case 19:return n.weightData=(0,A.n7)(u),e.abrupt("return",n);case 21:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}();Q.URL_SCHEME="localstorage://";var J=function(e){return(0,y.OB)().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(Q.URL_SCHEME)?(t=e.slice(Q.URL_SCHEME.length),new Q(t)):null;var t};E.registerSaveRouter(J),E.registerLoadRouter(J);var ee=function(){function e(){(0,x.Z)(this,e),(0,P.hu)((0,y.OB)().getBool("IS_BROWSER"),(function(){return"Current environment is not a web browser"})),(0,P.hu)("undefined"===typeof window||"undefined"!==typeof window.localStorage,(function(){return"Current browser does not appear to support localStorage"})),this.LS=window.localStorage}return(0,w.Z)(e,[{key:"listModels",value:function(){var e=(0,_.Z)(C().mark((function e(){var t,n,r,a,i,o;return C().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(t={},n=W+U,r=U+V,a=0;a<this.LS.length;++a)(i=this.LS.key(a)).startsWith(n)&&i.endsWith(r)&&(o=$(i),t[o]=JSON.parse(this.LS.getItem(i)));return e.abrupt("return",t);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"removeModel",value:function(){var e=(0,_.Z)(C().mark((function e(t){var n,r;return C().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=(a=t).startsWith(Q.URL_SCHEME)?a.slice(Q.URL_SCHEME.length):a,n=K(t),null!=this.LS.getItem(n.info)){e.next=4;break}throw new Error("Cannot find model at path '".concat(t,"'"));case 4:return r=JSON.parse(this.LS.getItem(n.info)),Y(n),e.abrupt("return",r);case 7:case"end":return e.stop()}var a}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}(),te="://",ne=function(){function e(){(0,x.Z)(this,e),this.managers={}}return(0,w.Z)(e,null,[{key:"getInstance",value:function(){return null==e.instance&&(e.instance=new e),e.instance}},{key:"registerManager",value:function(t,n){(0,P.hu)(null!=t,(function(){return"scheme must not be undefined or null."})),t.endsWith(te)&&(t=t.slice(0,t.indexOf(te))),(0,P.hu)(t.length>0,(function(){return"scheme must not be an empty string."}));var r=e.getInstance();(0,P.hu)(null==r.managers[t],(function(){return"A model store manager is already registered for scheme '".concat(t,"'.")})),r.managers[t]=n}},{key:"getManager",value:function(t){var n=e.getInstance().managers[t];if(null==n)throw new Error("Cannot find model manager for scheme '".concat(t,"'"));return n}},{key:"getSchemes",value:function(){return Object.keys(e.getInstance().managers)}}]),e}();function re(e){if(-1===e.indexOf(te))throw new Error("The url string provided does not contain a scheme. Supported schemes are: "+"".concat(ne.getSchemes().join(",")));return{scheme:e.split(te)[0],path:e.split(te)[1]}}function ae(e,t){return ie.apply(this,arguments)}function ie(){return ie=(0,_.Z)(C().mark((function e(t,n){var r,a,i,o,u,s,c,l,f,d,h=arguments;return C().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=h.length>2&&void 0!==h[2]&&h[2],(0,P.hu)(t!==n,(function(){return"Old path and new path are the same: '".concat(t,"'")})),a=E.getLoadHandlers(t),(0,P.hu)(a.length>0,(function(){return"Copying failed because no load handler is found for source URL ".concat(t,".")})),(0,P.hu)(a.length<2,(function(){return"Copying failed because more than one (".concat(a.length,") ")+"load handlers for source URL ".concat(t,".")})),i=a[0],o=E.getSaveHandlers(n),(0,P.hu)(o.length>0,(function(){return"Copying failed because no save handler is found for destination "+"URL ".concat(n,".")})),(0,P.hu)(o.length<2,(function(){return"Copying failed because more than one (".concat(a.length,") ")+"save handlers for destination URL ".concat(n,".")})),u=o[0],s=re(t).scheme,c=re(t).path,l=s===re(t).scheme,e.next=15,i.load();case 15:if(f=e.sent,!r||!l){e.next=19;break}return e.next=19,ne.getManager(s).removeModel(c);case 19:return e.next=21,u.save(f);case 21:if(d=e.sent,!r||l){e.next=25;break}return e.next=25,ne.getManager(s).removeModel(c);case 25:return e.abrupt("return",d.modelArtifactsInfo);case 26:case"end":return e.stop()}}),e)}))),ie.apply(this,arguments)}function oe(){return ue.apply(this,arguments)}function ue(){return(ue=(0,_.Z)(C().mark((function e(){var t,n,r,a,i,o,u;return C().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=ne.getSchemes(),n={},r=(0,k.Z)(t),e.prev=3,r.s();case 5:if((a=r.n()).done){e.next=13;break}return i=a.value,e.next=9,ne.getManager(i).listModels();case 9:for(u in o=e.sent)n[i+te+u]=o[u];case 11:e.next=5;break;case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(3),r.e(e.t0);case 18:return e.prev=18,r.f(),e.finish(18);case 21:return e.abrupt("return",n);case 22:case"end":return e.stop()}}),e,null,[[3,15,18,21]])})))).apply(this,arguments)}function se(e){return ce.apply(this,arguments)}function ce(){return(ce=(0,_.Z)(C().mark((function e(t){var n,r;return C().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=re(t),r=ne.getManager(n.scheme),e.abrupt("return",r.removeModel(n.path));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function le(e,t){return fe.apply(this,arguments)}function fe(){return(fe=(0,_.Z)(C().mark((function e(t,n){return C().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return!1,e.abrupt("return",ae(t,n,false));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function de(e,t){return he.apply(this,arguments)}function he(){return(he=(0,_.Z)(C().mark((function e(t,n){return C().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return!0,e.abrupt("return",ae(t,n,true));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var pe=n(1539),ve=function(){function e(){(0,x.Z)(this,e),this.messageName="setTimeoutCustom",this.functionRefs=[],this.handledMessageCount=0,this.hasEventListener=!1}return(0,w.Z)(e,[{key:"fetch",value:function(e){function t(t,n){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e,t){return fetch(e,t)}))},{key:"now",value:function(){return performance.now()}},{key:"encode",value:function(e,t){if("utf-8"!==t&&"utf8"!==t)throw new Error("Browser's encoder only supports utf-8, but got ".concat(t));return null==this.textEncoder&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(e)}},{key:"decode",value:function(e,t){return new TextDecoder(t).decode(e)}},{key:"setTimeoutCustom",value:function(e,t){var n=this;"undefined"!==typeof window&&(0,y.OB)().getBool("USE_SETTIMEOUTCUSTOM")?(this.functionRefs.push(e),setTimeout((function(){window.postMessage({name:n.messageName,index:n.functionRefs.length-1},"*")}),t),this.hasEventListener||(this.hasEventListener=!0,window.addEventListener("message",(function(e){e.source===window&&e.data.name===n.messageName&&(e.stopPropagation(),(0,n.functionRefs[e.data.index])(),n.handledMessageCount++,n.handledMessageCount===n.functionRefs.length&&(n.functionRefs=[],n.handledMessageCount=0))}),!0))):setTimeout(e,t)}},{key:"isTypedArray",value:function(e){return(0,pe.j)(e)}}]),e}();if((0,y.OB)().get("IS_BROWSER")){(0,y.OB)().setPlatform("browser",new ve);try{ne.registerManager(Q.URL_SCHEME,new ee)}catch(Mr){}try{ne.registerManager(z.URL_SCHEME,new L)}catch(Mr){}}var me,ge=function(){return n(5410)};var ye=function(){function e(){(0,x.Z)(this,e),this.util=n(8628),this.textEncoder=new this.util.TextEncoder}return(0,w.Z)(e,[{key:"fetch",value:function(e,t){return null!=(0,y.OB)().global.fetch?(0,y.OB)().global.fetch(e,t):(null==me&&(me=ge()),me(e,t))}},{key:"now",value:function(){var e=process.hrtime();return 1e3*e[0]+e[1]/1e6}},{key:"encode",value:function(e,t){if("utf-8"!==t&&"utf8"!==t)throw new Error("Node built-in encoder only supports utf-8, but got ".concat(t));return this.textEncoder.encode(e)}},{key:"decode",value:function(e,t){return 0===e.length?"":new this.util.TextDecoder(t).decode(e)}},{key:"isTypedArray",value:function(e){return this.util.types.isFloat32Array(e)||this.util.types.isInt32Array(e)||this.util.types.isUint8Array(e)||this.util.types.isUint8ClampedArray(e)}}]),e}();(0,y.OB)().get("IS_NODE")&&!(0,y.OB)().get("IS_BROWSER")&&(0,y.OB)().setPlatform("node",new ye);var be=n(7039),xe=n(9118),we=n(672),ke=n(4600),_e=n(4376);(0,p.wv)();var Se={buffer:be.f,cast:xe.p,clone:we.d,print:ke.S};(0,_e.Vp)(Se);var Ce=n(3433),Ae=n(136),Ee=n(7277),Ne=n(5875),Te=n(3312),Ie=n(5750),De=n(651),Fe=n(6902),Me=n(7391),Oe=n(7293),Re=n(6450),je=n(7067),Be=new Map,ze=new Map,Ze=function(){function e(){(0,x.Z)(this,e)}return(0,w.Z)(e,[{key:"getClassName",value:function(){return this.constructor.className}}],[{key:"fromConfig",value:function(e,t){return new e(t)}}]),e}(),Le=function(){function e(){(0,x.Z)(this,e),this.classNameMap={}}return(0,w.Z)(e,null,[{key:"getMap",value:function(){return null==e.instance&&(e.instance=new e),e.instance}},{key:"register",value:function(t){e.getMap().classNameMap[t.className]=[t,t.fromConfig]}}]),e}();function Pe(e,t,n){(0,P.hu)(null!=e.className,(function(){return"Class being registered does not have the static className property defined."})),(0,P.hu)("string"===typeof e.className,(function(){return"className is required to be a string, but got type "+typeof e.className})),(0,P.hu)(e.className.length>0,(function(){return"Class being registered has an empty-string as its className, which is disallowed."})),"undefined"===typeof t&&(t="Custom"),"undefined"===typeof n&&(n=e.className);var r=t+">"+n;return Le.register(e),Be.set(r,e),ze.set(e,r),e}function Ue(e){return ze.has(e)?ze.get(e):e.className}var We=function(e){(0,Ae.Z)(n,e);var t=(0,Ee.Z)(n);function n(){return(0,x.Z)(this,n),t.apply(this,arguments)}return(0,w.Z)(n,[{key:"minimize",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2?arguments[2]:void 0,r=this.computeGradients(e,n),a=r.value,i=r.grads;if(null!=n){var o=n.map((function(e){return{name:e.name,tensor:i[e.name]}}));this.applyGradients(o)}else this.applyGradients(i);return(0,Ne.B9)(i),t?a:(a.dispose(),null)}},{key:"iterations",get:function(){return null==this.iterations_&&(this.iterations_=0),this.iterations_}},{key:"incrementIterations",value:function(){this.iterations_=this.iterations+1}},{key:"computeGradients",value:function(e,t){return(0,Re.pn)(e,t)}},{key:"dispose",value:function(){null!=this.iterations_&&(0,Ne.B9)(this.iterations_)}},{key:"saveIterations",value:function(){var e=(0,_.Z)(C().mark((function e(){return C().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return null==this.iterations_&&(this.iterations_=0),e.abrupt("return",{name:"iter",tensor:(0,je.i)(this.iterations_,"int32")});case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getWeights",value:function(){var e=(0,_.Z)(C().mark((function e(){return C().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Error("getWeights() is not implemented for this optimizer yet.");case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"setWeights",value:function(){var e=(0,_.Z)(C().mark((function e(t){return C().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Error("setWeights() is not implemented for this optimizer class "+"".concat(this.getClassName()));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"extractIterations",value:function(){var e=(0,_.Z)(C().mark((function e(t){return C().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t[0].tensor.data();case 2:return this.iterations_=e.sent[0],e.abrupt("return",t.slice(1));case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),n}(Ze);Object.defineProperty(We,Symbol.hasInstance,{value:function(e){return null!=e.minimize&&null!=e.computeGradients&&null!=e.applyGradients}});var Ve=function(e){(0,Ae.Z)(n,e);var t=(0,Ee.Z)(n);function n(e,r){var a,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return(0,x.Z)(this,n),(a=t.call(this)).learningRate=e,a.rho=r,a.epsilon=i,a.accumulatedGrads=[],a.accumulatedUpdates=[],null==i&&(a.epsilon=p.BV.backend.epsilon()),a}return(0,w.Z)(n,[{key:"applyGradients",value:function(e){var t=this;(Array.isArray(e)?e.map((function(e){return e.name})):Object.keys(e)).forEach((function(n,r){var a=p.BV.registeredVariables[n];null==t.accumulatedGrads[r]&&(t.accumulatedGrads[r]={originalName:"".concat(n,"/accum_grad"),variable:(0,Ne.lu)((function(){return(0,Oe.P)(a).variable(false)}))}),null==t.accumulatedUpdates[r]&&(t.accumulatedUpdates[r]={originalName:"".concat(n,"/accum_var"),variable:(0,Ne.lu)((function(){return(0,Oe.P)(a).variable(false)}))});var i=Array.isArray(e)?e[r].tensor:e[n];if(null!=i){var o=t.accumulatedGrads[r].variable,u=t.accumulatedUpdates[r].variable;(0,Ne.lu)((function(){var e=(0,Te.I)((0,De.d)(o,t.rho),(0,De.d)((0,Me.h)(i),1-t.rho)),n=(0,De.d)((0,Ie.h)((0,Fe._)((0,Te.I)(u,t.epsilon)),(0,Fe._)((0,Te.I)(o,t.epsilon))),i),r=(0,Te.I)((0,De.d)(u,t.rho),(0,De.d)((0,Me.h)(n),1-t.rho));o.assign(e),u.assign(r);var s=(0,Te.I)((0,De.d)(n,-t.learningRate),a);a.assign(s)}))}})),this.incrementIterations()}},{key:"dispose",value:function(){null!=this.accumulatedUpdates&&((0,Ne.B9)(this.accumulatedGrads.map((function(e){return e.variable}))),(0,Ne.B9)(this.accumulatedUpdates.map((function(e){return e.variable}))))}},{key:"getWeights",value:function(){var e=(0,_.Z)(C().mark((function e(){var t;return C().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=[].concat((0,Ce.Z)(this.accumulatedGrads),(0,Ce.Z)(this.accumulatedUpdates)),e.next=3,this.saveIterations();case 3:return e.t0=e.sent,e.abrupt("return",[e.t0].concat(t.map((function(e){return{name:e.originalName,tensor:e.variable}}))));case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setWeights",value:function(){var e=(0,_.Z)(C().mark((function e(t){var n;return C().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.extractIterations(t);case 2:t=e.sent,n=t.length/2,!1,this.accumulatedGrads=t.slice(0,n).map((function(e){return{originalName:e.name,variable:e.tensor.variable(false)}})),this.accumulatedUpdates=t.slice(n,2*n).map((function(e){return{originalName:e.name,variable:e.tensor.variable(false)}}));case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getConfig",value:function(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}}}],[{key:"className",get:function(){return"Adadelta"}},{key:"fromConfig",value:function(e,t){return new e(t.learningRate,t.rho,t.epsilon)}}]),n}(We),qe=n(8582),Ge=function(e){(0,Ae.Z)(n,e);var t=(0,Ee.Z)(n);function n(e){var r,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.1;return(0,x.Z)(this,n),(r=t.call(this)).learningRate=e,r.initialAccumulatorValue=a,r.accumulatedGrads=[],r}return(0,w.Z)(n,[{key:"applyGradients",value:function(e){var t=this;(Array.isArray(e)?e.map((function(e){return e.name})):Object.keys(e)).forEach((function(n,r){var a=p.BV.registeredVariables[n];if(null==t.accumulatedGrads[r]){t.accumulatedGrads[r]={originalName:"".concat(n,"/accumulator"),variable:(0,Ne.lu)((function(){return(0,qe.h)(a.shape,t.initialAccumulatorValue).variable(false)}))}}var i=Array.isArray(e)?e[r].tensor:e[n];if(null!=i){var o=t.accumulatedGrads[r].variable;(0,Ne.lu)((function(){var e=(0,Te.I)(o,(0,Me.h)(i));o.assign(e);var n=(0,Te.I)((0,De.d)((0,Ie.h)(i,(0,Fe._)((0,Te.I)(e,p.BV.backend.epsilon()))),-t.learningRate),a);a.assign(n)}))}})),this.incrementIterations()}},{key:"dispose",value:function(){null!=this.accumulatedGrads&&(0,Ne.B9)(this.accumulatedGrads.map((function(e){return e.variable})))}},{key:"getWeights",value:function(){var e=(0,_.Z)(C().mark((function e(){return C().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.saveIterations();case 2:return e.t0=e.sent,e.abrupt("return",[e.t0].concat(this.accumulatedGrads.map((function(e){return{name:e.originalName,tensor:e.variable}}))));case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setWeights",value:function(){var e=(0,_.Z)(C().mark((function e(t){return C().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.extractIterations(t);case 2:t=e.sent,!1,this.accumulatedGrads=t.map((function(e){return{originalName:e.name,variable:e.tensor.variable(false)}}));case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getConfig",value:function(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}}}],[{key:"className",get:function(){return"Adagrad"}},{key:"fromConfig",value:function(e,t){return new e(t.learningRate,t.initialAccumulatorValue)}}]),n}(We),He=n(4334),Xe=n(4774),Ke=function(e){(0,Ae.Z)(n,e);var t=(0,Ee.Z)(n);function n(e,r,a){var i,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return(0,x.Z)(this,n),(i=t.call(this)).learningRate=e,i.beta1=r,i.beta2=a,i.epsilon=o,i.accumulatedFirstMoment=[],i.accumulatedSecondMoment=[],(0,Ne.lu)((function(){i.accBeta1=(0,je.i)(r).variable(),i.accBeta2=(0,je.i)(a).variable()})),null==o&&(i.epsilon=p.BV.backend.epsilon()),i}return(0,w.Z)(n,[{key:"applyGradients",value:function(e){var t=this,n=Array.isArray(e)?e.map((function(e){return e.name})):Object.keys(e);(0,Ne.lu)((function(){var r=(0,Xe.l)(1,t.accBeta1),a=(0,Xe.l)(1,t.accBeta2);n.forEach((function(n,i){var o=p.BV.registeredVariables[n];null==t.accumulatedFirstMoment[i]&&(t.accumulatedFirstMoment[i]={originalName:"".concat(n,"/m"),variable:(0,Ne.lu)((function(){return(0,Oe.P)(o).variable(false)}))}),null==t.accumulatedSecondMoment[i]&&(t.accumulatedSecondMoment[i]={originalName:"".concat(n,"/v"),variable:(0,Ne.lu)((function(){return(0,Oe.P)(o).variable(false)}))});var u=Array.isArray(e)?e[i].tensor:e[n];if(null!=u){var s=t.accumulatedFirstMoment[i].variable,c=t.accumulatedSecondMoment[i].variable,l=(0,Te.I)((0,De.d)(s,t.beta1),(0,De.d)(u,1-t.beta1)),f=(0,Te.I)((0,De.d)(c,t.beta2),(0,De.d)((0,Me.h)(u),1-t.beta2)),d=(0,Ie.h)(l,r),h=(0,Ie.h)(f,a);s.assign(l),c.assign(f);var v=(0,Te.I)((0,De.d)((0,Ie.h)(d,(0,Te.I)((0,Fe._)(h),t.epsilon)),-t.learningRate),o);o.assign(v)}})),t.accBeta1.assign((0,De.d)(t.accBeta1,t.beta1)),t.accBeta2.assign((0,De.d)(t.accBeta2,t.beta2))})),this.incrementIterations()}},{key:"dispose",value:function(){this.accBeta1.dispose(),this.accBeta2.dispose(),null!=this.accumulatedFirstMoment&&(0,Ne.B9)(this.accumulatedFirstMoment.map((function(e){return e.variable}))),null!=this.accumulatedSecondMoment&&(0,Ne.B9)(this.accumulatedSecondMoment.map((function(e){return e.variable})))}},{key:"getWeights",value:function(){var e=(0,_.Z)(C().mark((function e(){var t;return C().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=[].concat((0,Ce.Z)(this.accumulatedFirstMoment),(0,Ce.Z)(this.accumulatedSecondMoment)),e.next=3,this.saveIterations();case 3:return e.t0=e.sent,e.abrupt("return",[e.t0].concat(t.map((function(e){return{name:e.originalName,tensor:e.variable}}))));case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setWeights",value:function(){var e=(0,_.Z)(C().mark((function e(t){var n,r=this;return C().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.extractIterations(t);case 2:t=e.sent,(0,Ne.lu)((function(){r.accBeta1.assign((0,He.s)(r.beta1,r.iterations_+1)),r.accBeta2.assign((0,He.s)(r.beta2,r.iterations_+1))})),n=t.length/2,!1,this.accumulatedFirstMoment=t.slice(0,n).map((function(e){return{originalName:e.name,variable:e.tensor.variable(false)}})),this.accumulatedSecondMoment=t.slice(n,2*n).map((function(e){return{originalName:e.name,variable:e.tensor.variable(false)}}));case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getConfig",value:function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}}}],[{key:"className",get:function(){return"Adam"}},{key:"fromConfig",value:function(e,t){return new e(t.learningRate,t.beta1,t.beta2,t.epsilon)}}]),n}(We),Ye=n(7613),$e=n(705),Qe=function(e){(0,Ae.Z)(n,e);var t=(0,Ee.Z)(n);function n(e,r,a){var i,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;return(0,x.Z)(this,n),(i=t.call(this)).learningRate=e,i.beta1=r,i.beta2=a,i.epsilon=o,i.decay=u,i.accumulatedFirstMoment=[],i.accumulatedWeightedInfNorm=[],(0,Ne.lu)((function(){i.iteration=(0,je.i)(0).variable(),i.accBeta1=(0,je.i)(r).variable()})),null==o&&(i.epsilon=p.BV.backend.epsilon()),i}return(0,w.Z)(n,[{key:"applyGradients",value:function(e){var t=this,n=Array.isArray(e)?e.map((function(e){return e.name})):Object.keys(e);(0,Ne.lu)((function(){var r=(0,Xe.l)(1,t.accBeta1),a=(0,Ie.h)(-t.learningRate,(0,Te.I)((0,De.d)(t.iteration,t.decay),1));n.forEach((function(n,i){var o=p.BV.registeredVariables[n];null==t.accumulatedFirstMoment[i]&&(t.accumulatedFirstMoment[i]={originalName:"".concat(n,"/m"),variable:(0,Oe.P)(o).variable(false)}),null==t.accumulatedWeightedInfNorm[i]&&(t.accumulatedWeightedInfNorm[i]={originalName:"".concat(n,"/v"),variable:(0,Oe.P)(o).variable(false)});var u=Array.isArray(e)?e[i].tensor:e[n];if(null!=u){var s=t.accumulatedFirstMoment[i].variable,c=t.accumulatedWeightedInfNorm[i].variable,l=(0,Te.I)((0,De.d)(s,t.beta1),(0,De.d)(u,1-t.beta1)),f=(0,De.d)(c,t.beta2),d=(0,Ye.W)(u),h=(0,$e.g)(f,d);s.assign(l),c.assign(h);var v=(0,Te.I)((0,De.d)((0,Ie.h)(a,r),(0,Ie.h)(l,(0,Te.I)(h,t.epsilon))),o);o.assign(v)}})),t.iteration.assign((0,Te.I)(t.iteration,1)),t.accBeta1.assign((0,De.d)(t.accBeta1,t.beta1))})),this.incrementIterations()}},{key:"dispose",value:function(){this.accBeta1.dispose(),this.iteration.dispose(),null!=this.accumulatedFirstMoment&&(0,Ne.B9)(this.accumulatedFirstMoment.map((function(e){return e.variable}))),null!=this.accumulatedWeightedInfNorm&&(0,Ne.B9)(this.accumulatedWeightedInfNorm.map((function(e){return e.variable})))}},{key:"getWeights",value:function(){var e=(0,_.Z)(C().mark((function e(){return C().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Error("getWeights() is not implemented for Adamax yet.");case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"setWeights",value:function(){var e=(0,_.Z)(C().mark((function e(t){return C().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Error("setWeights() is not implemented for Adamax yet.");case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"getConfig",value:function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}}}],[{key:"className",get:function(){return"Adamax"}},{key:"fromConfig",value:function(e,t){return new e(t.learningRate,t.beta1,t.beta2,t.epsilon,t.decay)}}]),n}(We),Je=function(e){(0,Ae.Z)(n,e);var t=(0,Ee.Z)(n);function n(e){var r;return(0,x.Z)(this,n),(r=t.call(this)).learningRate=e,r.setLearningRate(e),r}return(0,w.Z)(n,[{key:"applyGradients",value:function(e){var t=this;(Array.isArray(e)?e.map((function(e){return e.name})):Object.keys(e)).forEach((function(n,r){var a=Array.isArray(e)?e[r].tensor:e[n];if(null!=a){var i=p.BV.registeredVariables[n];(0,Ne.lu)((function(){var e=(0,Te.I)((0,De.d)(t.c,a),i);i.assign(e)}))}})),this.incrementIterations()}},{key:"setLearningRate",value:function(e){this.learningRate=e,null!=this.c&&this.c.dispose(),this.c=(0,Ne.Cn)((0,je.i)(-e))}},{key:"dispose",value:function(){this.c.dispose()}},{key:"getWeights",value:function(){var e=(0,_.Z)(C().mark((function e(){return C().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.saveIterations();case 2:return e.t0=e.sent,e.abrupt("return",[e.t0]);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setWeights",value:function(){var e=(0,_.Z)(C().mark((function e(t){return C().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.extractIterations(t);case 2:if(0===(t=e.sent).length){e.next=5;break}throw new Error("SGD optimizer does not have settable weights.");case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getConfig",value:function(){return{learningRate:this.learningRate}}}],[{key:"className",get:function(){return"SGD"}},{key:"fromConfig",value:function(e,t){return new e(t.learningRate)}}]),n}(We),et=function(e){(0,Ae.Z)(n,e);var t=(0,Ee.Z)(n);function n(e,r){var a,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return(0,x.Z)(this,n),(a=t.call(this,e)).learningRate=e,a.momentum=r,a.useNesterov=i,a.accumulations=[],a.m=(0,je.i)(a.momentum),a}return(0,w.Z)(n,[{key:"applyGradients",value:function(e){var t=this;(Array.isArray(e)?e.map((function(e){return e.name})):Object.keys(e)).forEach((function(n,r){var a=p.BV.registeredVariables[n];if(null==t.accumulations[r]){t.accumulations[r]={originalName:"".concat(n,"/momentum"),variable:(0,Ne.lu)((function(){return(0,Oe.P)(a).variable(false)}))}}var i=t.accumulations[r].variable,o=Array.isArray(e)?e[r].tensor:e[n];null!=o&&(0,Ne.lu)((function(){var e,n=(0,Te.I)((0,De.d)(t.m,i),o);e=t.useNesterov?(0,Te.I)((0,De.d)(t.c,(0,Te.I)(o,(0,De.d)(n,t.m))),a):(0,Te.I)((0,De.d)(t.c,n),a),i.assign(n),a.assign(e)}))})),this.incrementIterations()}},{key:"dispose",value:function(){this.m.dispose(),null!=this.accumulations&&(0,Ne.B9)(this.accumulations.map((function(e){return e.variable})))}},{key:"setMomentum",value:function(e){this.momentum=e}},{key:"getWeights",value:function(){var e=(0,_.Z)(C().mark((function e(){return C().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.saveIterations();case 2:return e.t0=e.sent,e.abrupt("return",[e.t0].concat(this.accumulations.map((function(e){return{name:e.originalName,tensor:e.variable}}))));case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setWeights",value:function(){var e=(0,_.Z)(C().mark((function e(t){return C().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.extractIterations(t);case 2:t=e.sent,!1,this.accumulations=t.map((function(e){return{originalName:e.name,variable:e.tensor.variable(false)}}));case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getConfig",value:function(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}}}],[{key:"className",get:function(){return"Momentum"}},{key:"fromConfig",value:function(e,t){return new e(t.learningRate,t.momentum,t.useNesterov)}}]),n}(Je),tt=function(e){(0,Ae.Z)(n,e);var t=(0,Ee.Z)(n);function n(e){var r,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.9,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,u=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if((0,x.Z)(this,n),(r=t.call(this)).learningRate=e,r.decay=a,r.momentum=i,r.epsilon=o,r.accumulatedMeanSquares=[],r.accumulatedMoments=[],r.accumulatedMeanGrads=[],r.centered=u,null==o&&(r.epsilon=p.BV.backend.epsilon()),null==e)throw new Error("learningRate for RMSPropOptimizer must be defined.");return r}return(0,w.Z)(n,[{key:"applyGradients",value:function(e){var t=this;(Array.isArray(e)?e.map((function(e){return e.name})):Object.keys(e)).forEach((function(n,r){var a=p.BV.registeredVariables[n],i=!1;null==t.accumulatedMeanSquares[r]&&(t.accumulatedMeanSquares[r]={originalName:"".concat(n,"/rms"),variable:(0,Ne.lu)((function(){return(0,Oe.P)(a).variable(i)}))}),null==t.accumulatedMoments[r]&&(t.accumulatedMoments[r]={originalName:"".concat(n,"/momentum"),variable:(0,Ne.lu)((function(){return(0,Oe.P)(a).variable(i)}))}),null==t.accumulatedMeanGrads[r]&&t.centered&&(t.accumulatedMeanGrads[r]={originalName:"".concat(n,"/mg"),variable:(0,Ne.lu)((function(){return(0,Oe.P)(a).variable(i)}))});var o=Array.isArray(e)?e[r].tensor:e[n];if(null!=o){var u=t.accumulatedMeanSquares[r].variable,s=t.accumulatedMoments[r].variable;(0,Ne.lu)((function(){var e=(0,Te.I)((0,De.d)(u,t.decay),(0,De.d)((0,Me.h)(o),1-t.decay));if(t.centered){var n=t.accumulatedMeanGrads[r].variable,i=(0,Te.I)((0,De.d)(n,t.decay),(0,De.d)(o,1-t.decay)),c=(0,Ie.h)((0,De.d)(o,t.learningRate),(0,Fe._)((0,Xe.l)(e,(0,Te.I)((0,Me.h)(i),t.epsilon)))),l=(0,Te.I)((0,De.d)(s,t.momentum),c);u.assign(e),n.assign(i),s.assign(l);var f=(0,Xe.l)(a,l);a.assign(f)}else{var d=(0,Te.I)((0,De.d)(u,t.decay),(0,De.d)((0,Me.h)(o),1-t.decay)),h=(0,Te.I)((0,De.d)(s,t.momentum),(0,Ie.h)((0,De.d)(o,t.learningRate),(0,Fe._)((0,Te.I)(d,t.epsilon))));u.assign(d),s.assign(h);var p=(0,Xe.l)(a,h);a.assign(p)}}))}})),this.incrementIterations()}},{key:"dispose",value:function(){null!=this.accumulatedMeanSquares&&(0,Ne.B9)(this.accumulatedMeanSquares.map((function(e){return e.variable}))),null!=this.accumulatedMeanGrads&&this.centered&&(0,Ne.B9)(this.accumulatedMeanGrads.map((function(e){return e.variable}))),null!=this.accumulatedMoments&&(0,Ne.B9)(this.accumulatedMoments.map((function(e){return e.variable})))}},{key:"getWeights",value:function(){var e=(0,_.Z)(C().mark((function e(){var t;return C().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=[].concat((0,Ce.Z)(this.accumulatedMeanSquares),(0,Ce.Z)(this.accumulatedMoments)),this.centered&&t.push.apply(t,(0,Ce.Z)(this.accumulatedMeanGrads)),e.next=4,this.saveIterations();case 4:return e.t0=e.sent,e.abrupt("return",[e.t0].concat(t.map((function(e){return{name:e.originalName,tensor:e.variable}}))));case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setWeights",value:function(){var e=(0,_.Z)(C().mark((function e(t){var n,r;return C().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.extractIterations(t);case 2:t=e.sent,n=this.centered?t.length/3:t.length/2,r=!1,this.accumulatedMeanSquares=t.slice(0,n).map((function(e){return{originalName:e.name,variable:e.tensor.variable(r)}})),this.accumulatedMoments=t.slice(n,2*n).map((function(e){return{originalName:e.name,variable:e.tensor.variable(r)}})),this.centered&&(this.accumulatedMeanGrads=t.slice(2*n,3*n).map((function(e){return{originalName:e.name,variable:e.tensor.variable(r)}})));case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getConfig",value:function(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}}}],[{key:"className",get:function(){return"RMSProp"}},{key:"fromConfig",value:function(e,t){return new e(t.learningRate,t.decay,t.momentum,t.epsilon,t.centered)}}]),n}(We),nt=[Ve,Ge,Ke,Qe,et,tt,Je];function rt(e){return new Promise((function(e){return setTimeout(e)})).then(e)}var at=function(){function e(t){if((0,x.Z)(this,e),!(0,y.OB)().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");t.startsWith(e.URL_SCHEME)&&(t=t.slice(e.URL_SCHEME.length)),null!=t&&0!==t.length||(t="model"),this.modelJsonFileName=t+".json",this.weightDataFileName=t+".weights.bin"}return(0,w.Z)(e,[{key:"save",value:function(){var e=(0,_.Z)(C().mark((function e(t){var n,r,a,i,o,u,s;return C().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("undefined"!==typeof document){e.next=2;break}throw new Error("Browser downloads are not supported in this environment since `document` is not present");case 2:if(n=F.w.join(t.weightData),r=window.URL.createObjectURL(new Blob([n],{type:"application/octet-stream"})),!(t.modelTopology instanceof ArrayBuffer)){e.next=8;break}throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");case 8:return a=[{paths:["./"+this.weightDataFileName],weights:t.weightSpecs}],i=(0,A.Yd)(t,a),o=window.URL.createObjectURL(new Blob([JSON.stringify(i)],{type:"application/json"})),(u=null==this.modelJsonAnchor?document.createElement("a"):this.modelJsonAnchor).download=this.modelJsonFileName,u.href=o,e.next=16,rt((function(){return u.dispatchEvent(new MouseEvent("click"))}));case 16:if(null==t.weightData){e.next=22;break}return(s=null==this.weightDataAnchor?document.createElement("a"):this.weightDataAnchor).download=this.weightDataFileName,s.href=r,e.next=22,rt((function(){return s.dispatchEvent(new MouseEvent("click"))}));case 22:return e.abrupt("return",{modelArtifactsInfo:(0,A.Q)(t)});case 23:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}();at.URL_SCHEME="downloads://";var it=function(){function e(t){if((0,x.Z)(this,e),null==t||t.length<1)throw new Error("When calling browserFiles, at least 1 file is required, "+"but received ".concat(t));this.jsonFile=t[0],this.weightsFiles=t.slice(1)}return(0,w.Z)(e,[{key:"load",value:function(){var e=(0,_.Z)(C().mark((function e(){var t=this;return C().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){var r=new FileReader;r.onload=function(r){var a=JSON.parse(r.target.result),i=a.modelTopology;if(null!=i)if(null!=a.weightsManifest)if(0!==t.weightsFiles.length){var o=(0,A.jN)(a,(function(e){return t.loadWeights(e)}));e(o)}else e({modelTopology:i});else n(new Error("weightManifest field is missing from file ".concat(t.jsonFile.name)));else n(new Error("modelTopology field is missing from file ".concat(t.jsonFile.name)))},r.onerror=function(e){return n("Failed to read model topology and weights manifest JSON "+"from file '".concat(t.jsonFile.name,"'. BrowserFiles supports loading ")+"Keras-style tf.Model artifacts only.")},r.readAsText(t.jsonFile)})));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"loadWeights",value:function(e){var t,n=this,r=[],a=[],i=(0,k.Z)(e);try{for(i.s();!(t=i.n()).done;){var o=t.value;r.push.apply(r,(0,Ce.Z)(o.weights)),a.push.apply(a,(0,Ce.Z)(o.paths))}}catch(Mr){i.e(Mr)}finally{i.f()}var u=this.checkManifestAndWeightFiles(e),s=a.map((function(e){return n.loadWeightsFile(e,u[e])}));return Promise.all(s).then((function(e){return[r,e]}))}},{key:"loadWeightsFile",value:function(e,t){return new Promise((function(n,r){var a=new FileReader;a.onload=function(e){var t=e.target.result;n(t)},a.onerror=function(t){return r("Failed to weights data from file of path '".concat(e,"'."))},a.readAsArrayBuffer(t)}))}},{key:"checkManifestAndWeightFiles",value:function(e){var t,n=this,r=[],a=this.weightsFiles.map((function(e){return(0,A.EZ)(e.name)})),i={},o=(0,k.Z)(e);try{for(o.s();!(t=o.n()).done;){t.value.paths.forEach((function(e){var t=(0,A.EZ)(e);if(-1!==r.indexOf(t))throw new Error("Duplicate file basename found in weights manifest: "+"'".concat(t,"'"));if(r.push(t),-1===a.indexOf(t))throw new Error("Weight file with basename '".concat(t,"' is not provided."));i[e]=n.weightsFiles[a.indexOf(t)]}))}}catch(Mr){o.e(Mr)}finally{o.f()}if(r.length!==this.weightsFiles.length)throw new Error("Mismatch in the number of files in weights manifest "+"(".concat(r.length,") and the number of weight files provided ")+"(".concat(this.weightsFiles.length,")."));return i}}]),e}();function ot(e){return new it(e)}E.registerSaveRouter((function(e){return(0,y.OB)().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(at.URL_SCHEME)?function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"model";return new at(e)}(e.slice(at.URL_SCHEME.length)):null}));var ut=n(9439);function st(e,t,n,r){!function(e){(0,P.hu)(null!=e&&Array.isArray(e)&&e.length>0,(function(){return"promises must be a none empty array"}))}(e),function(e,t){(0,P.hu)(e>=0&&e<=1,(function(){return"Progress fraction must be in range [0, 1], but "+"got startFraction ".concat(e)})),(0,P.hu)(t>=0&&t<=1,(function(){return"Progress fraction must be in range [0, 1], but "+"got endFraction ".concat(t)})),(0,P.hu)(t>=e,(function(){return"startFraction must be no more than endFraction, but "+"got startFraction ".concat(e," and endFraction ")+"".concat(t)}))}(n=null==n?0:n,r=null==r?1:r);var a=0;return Promise.all(e.map((function(i){return i.then((function(i){var o=n+ ++a/e.length*(r-n);return t(o),i})),i})))}var ct=n(1988);function lt(e,t){return ft.apply(this,arguments)}function ft(){return(ft=(0,_.Z)(C().mark((function e(t,n){var r,a,i,o,u,s,c,l,f;return C().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==n&&(n={}),r=null==n.fetchFunc?(0,y.OB)().platform.fetch:n.fetchFunc,a=t.map((function(e){return r(e,n.requestInit,{isBinary:!0})})),i=0,o=.5,null!=n.onProgress){e.next=11;break}return e.next=8,Promise.all(a);case 8:e.t0=e.sent,e.next=14;break;case 11:return e.next=13,st(a,n.onProgress,i,o);case 13:e.t0=e.sent;case 14:if(u=e.t0,s=u.map((function(e){return e.arrayBuffer()})),c=.5,l=1,null!=n.onProgress){e.next=24;break}return e.next=21,Promise.all(s);case 21:e.t1=e.sent,e.next=27;break;case 24:return e.next=26,st(s,n.onProgress,c,l);case 26:e.t1=e.sent;case 27:return f=e.t1,e.abrupt("return",f);case 29:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function dt(e,t){var n,r,a=null==t.fetchFunc?(0,y.OB)().platform.fetch:t.fetchFunc,i=0;return null===(n=t.onProgress)||void 0===n||n.call(t,0),new ReadableStream({pull:function(){var n=(0,_.Z)(C().mark((function n(o){var u,s,c,l,f;return C().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!(i<e.length)){n.next=20;break}if(r){n.next=6;break}return n.next=4,a(e[i],t.requestInit,{isBinary:!0});case 4:s=n.sent.body,r=s.getReader();case 6:return n.next=8,r.read();case 8:if(c=n.sent,l=c.done,f=c.value,!l){n.next=16;break}return i++,r=void 0,null===(u=t.onProgress)||void 0===u||u.call(t,i/e.length),n.abrupt("continue",0);case 16:return o.enqueue(f),n.abrupt("return");case 20:o.close();case 21:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()})}function ht(e){return pt.apply(this,arguments)}function pt(){return pt=(0,_.Z)(C().mark((function e(t){var n,r,a,i,o=arguments;return C().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=o.length>1&&void 0!==o[1]?o[1]:"",r=o.length>2?o[2]:void 0,a=o.length>3?o[3]:void 0,i=vt((function(e){return lt(e,{requestInit:a})})),e.abrupt("return",i(t,n,r));case 6:case"end":return e.stop()}}),e)}))),pt.apply(this,arguments)}function vt(e){return function(){var t=(0,_.Z)(C().mark((function t(n){var r,a,i,o,u,s,c,l,f,d,h,p,v=arguments;return C().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=v.length>1&&void 0!==v[1]?v[1]:"",a=v.length>2?v[2]:void 0,i=n.map((function(){return!1})),o={},u=null!=a?a.map((function(){return!1})):[],s=[],n.forEach((function(e,t){var n=0;e.weights.forEach((function(e){var r="quantization"in e?e.quantization.dtype:e.dtype,c=ct.J[r]*P.NA(e.shape),l=function(){i[t]=!0,null==o[t]&&(o[t]=[]),o[t].push({manifestEntry:e,groupOffset:n,sizeBytes:c})};null!=a?a.forEach((function(t,n){t===e.name&&(l(),u[n]=!0)})):l(),s.push(e.name),n+=c}))})),u.every((function(e){return e}))){t.next=10;break}throw c=a.filter((function(e,t){return!u[t]})),new Error("Could not find weights in manifest with names: "+"".concat(c.join(", "),". \n")+"Manifest JSON has weights with names: "+"".concat(s.join(", "),"."));case 10:return l=i.reduce((function(e,t,n){return t&&e.push(n),e}),[]),f=[],l.forEach((function(e){n[e].paths.forEach((function(e){var t=r+(r.endsWith("/")?"":"/")+e;f.push(t)}))})),t.next=15,e(f);case 15:return d=t.sent,h={},p=0,l.forEach((function(e){var t=n[e].paths.length,r=new F.w(d.slice(p,p+t));o[e].forEach((function(e){var t=r.slice(e.groupOffset,e.groupOffset+e.sizeBytes),n=(0,A.dI)(t,[e.manifestEntry]);for(var a in n)h[a]=n[a]})),p+=t})),t.abrupt("return",h);case 20:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}var mt=function(){function e(t,n){if((0,x.Z)(this,e),this.DEFAULT_METHOD="POST",null==n&&(n={}),this.weightPathPrefix=n.weightPathPrefix,this.weightUrlConverter=n.weightUrlConverter,null!=n.fetchFunc?((0,P.hu)("function"===typeof n.fetchFunc,(function(){return"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"})),this.fetch=n.fetchFunc):this.fetch=(0,y.OB)().platform.fetch,(0,P.hu)(null!=t&&t.length>0,(function(){return"URL path for http must not be null, undefined or empty."})),Array.isArray(t)&&(0,P.hu)(2===t.length,(function(){return"URL paths for http must have a length of 2, "+"(actual length is ".concat(t.length,").")})),this.path=t,null!=n.requestInit&&null!=n.requestInit.body)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=n.requestInit||{},this.loadOptions=n}return(0,w.Z)(e,[{key:"save",value:function(){var e=(0,_.Z)(C().mark((function e(t){var n,r,a,i,o;return C().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t.modelTopology instanceof ArrayBuffer)){e.next=2;break}throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");case 2:return(n=Object.assign({method:this.DEFAULT_METHOD},this.requestInit)).body=new FormData,r=[{paths:["./model.weights.bin"],weights:t.weightSpecs}],a=(0,A.Yd)(t,r),n.body.append("model.json",new Blob([JSON.stringify(a)],{type:"application/json"}),"model.json"),null!=t.weightData&&(i=F.w.join(t.weightData),n.body.append("model.weights.bin",new Blob([i],{type:"application/octet-stream"}),"model.weights.bin")),e.next=10,this.fetch(this.path,n);case 10:if(!(o=e.sent).ok){e.next=15;break}return e.abrupt("return",{modelArtifactsInfo:(0,A.Q)(t),responses:[o]});case 15:throw new Error("BrowserHTTPRequest.save() failed due to HTTP response status "+"".concat(o.status,"."));case 16:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"loadModelJSON",value:function(){var e=(0,_.Z)(C().mark((function e(){var t,n,r,a,i;return C().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.fetch(this.path,this.requestInit);case 2:if((t=e.sent).ok){e.next=5;break}throw new Error("Request to ".concat(this.path," failed with status code ")+"".concat(t.status,". Please verify this URL points to ")+"the model JSON of the model to load.");case 5:return e.prev=5,e.next=8,t.json();case 8:n=e.sent,e.next=16;break;case 11:throw e.prev=11,e.t0=e.catch(5),r="Failed to parse model JSON of response from ".concat(this.path,"."),this.path.endsWith(".pb")?r+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":r+=" Please make sure the server is serving valid JSON for this request.",new Error(r);case 16:if(a=n.modelTopology,i=n.weightsManifest,null!=a||null!=i){e.next=20;break}throw new Error("The JSON from HTTP path ".concat(this.path," contains neither model ")+"topology or manifest for weights.");case 20:return e.abrupt("return",n);case 21:case"end":return e.stop()}}),e,this,[[5,11]])})));return function(){return e.apply(this,arguments)}}()},{key:"load",value:function(){var e=(0,_.Z)(C().mark((function e(){var t,n=this;return C().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.loadOptions.streamWeights){e.next=2;break}return e.abrupt("return",this.loadStream());case 2:return e.next=4,this.loadModelJSON();case 4:return t=e.sent,e.abrupt("return",(0,A.jN)(t,(function(e){return n.loadWeights(e)})));case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"loadStream",value:function(){var e=(0,_.Z)(C().mark((function e(){var t,n,r,a,i=this;return C().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.loadModelJSON();case 2:return t=e.sent,e.next=5,this.getWeightUrls(t.weightsManifest);case 5:return n=e.sent,r=(0,A.hu)(t.weightsManifest),a=function(){return dt(n,i.loadOptions)},e.abrupt("return",Object.assign(Object.assign({},t),{weightSpecs:r,getWeightStream:a}));case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getWeightUrls",value:function(){var e=(0,_.Z)(C().mark((function e(t){var n,r,a,i,o,u,s,c,l,f,d,h,p,v;return C().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=Array.isArray(this.path)?this.path[1]:this.path,r=gt(n),a=(0,ut.Z)(r,2),i=a[0],o=a[1],u=this.weightPathPrefix||i,s=[],c=[],l=(0,k.Z)(t);try{for(l.s();!(f=l.n()).done;){d=f.value,h=(0,k.Z)(d.paths);try{for(h.s();!(p=h.n()).done;)v=p.value,null!=this.weightUrlConverter?c.push(this.weightUrlConverter(v)):s.push(u+v+o)}catch(Mr){h.e(Mr)}finally{h.f()}}}catch(Mr){l.e(Mr)}finally{l.f()}if(!this.weightUrlConverter){e.next=16;break}return e.t0=s.push,e.t1=s,e.t2=Ce.Z,e.next=13,Promise.all(c);case 13:e.t3=e.sent,e.t4=(0,e.t2)(e.t3),e.t0.apply.call(e.t0,e.t1,e.t4);case 16:return e.abrupt("return",s);case 17:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"loadWeights",value:function(){var e=(0,_.Z)(C().mark((function e(t){var n,r,a;return C().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getWeightUrls(t);case 2:return n=e.sent,r=(0,A.hu)(t),e.next=6,lt(n,this.loadOptions);case 6:return a=e.sent,e.abrupt("return",[r,a]);case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}();function gt(e){var t=e.lastIndexOf("/"),n=e.lastIndexOf("?");return[e.substring(0,t)+"/",n>t?e.substring(n):""]}function yt(e){return null!=e.match(mt.URL_SCHEME_REGEX)}mt.URL_SCHEME_REGEX=/^https?:\/\//;var bt=function(e,t){if("undefined"===typeof fetch&&(null==t||null==t.fetchFunc))return null;return(Array.isArray(e)?e.every((function(e){return yt(e)})):yt(e))?xt(e,t):null};function xt(e,t){return new mt(e,t)}function wt(e,t){return xt(e,t)}E.registerSaveRouter(bt),E.registerLoadRouter(bt);var kt=function(){function e(t){(0,x.Z)(this,e),this.modelArtifacts=t}return(0,w.Z)(e,[{key:"load",value:function(){return this.modelArtifacts}}]),e}(),_t=function(){function e(t){(0,x.Z)(this,e),this.saveHandler=t}return(0,w.Z)(e,[{key:"save",value:function(e){return this.saveHandler(e)}}]),e}(),St=(0,w.Z)((function e(t){(0,x.Z)(this,e),t.load&&(this.load=function(){return Promise.resolve(t.load())}),t.save&&(this.save=function(e){return Promise.resolve(t.save(e))})}));function Ct(e,t,n,r){var a=arguments;return new St(At.apply(void 0,(0,Ce.Z)(a)))}function At(e,t,n,r){if(1===arguments.length){var a=null!=e.modelTopology||null!=e.weightSpecs;return a?new kt(e):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new kt({modelTopology:e}))}return console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new kt({modelTopology:e,weightSpecs:t,weightData:n,trainingConfig:r})}function Et(e){return new _t(e)}function Nt(e){return new _t(e)}var Tt=n(8354),It=n(7221),Dt=n(4326),Ft=n(8640),Mt=n(1240);var Ot,Rt=(0,Ft.op)({confusionMatrix_:function(e,t,n){var r=(0,Tt._1)(e,"labels","confusionMatrix"),a=(0,Tt._1)(t,"predictions","confusionMatrix");P.hu(null==n||n>0&&Number.isInteger(n),(function(){return"If provided, numClasses must be a positive integer, "+"but got ".concat(n)})),P.hu(1===r.rank,(function(){return"Expected the rank of labels to be 1, but got ".concat(r.rank)})),P.hu(1===a.rank,(function(){return"Expected the rank of predictions to be 1, "+"but got ".concat(a.rank)})),P.hu(r.shape[0]===a.shape[0],(function(){return"Mismatch in the number of examples: "+"".concat(r.shape[0]," vs. ").concat(a.shape[0],". ")+"Labels and predictions should have the same number of elements."})),P.hu(n>0&&Number.isInteger(n),(function(){return"numClasses is required to be a positive integer, but got "+"".concat(n)}));var i=(0,Dt.l)((0,xe.p)(r,"int32"),n),o=(0,Dt.l)((0,xe.p)(a,"int32"),n),u=(0,Mt.p)(i),s=(0,It.O)(u,o);return(0,xe.p)(s,"int32")}}),jt=n(5774),Bt=n(2145),zt=n(8864),Zt=n(3123),Lt=!1;function Pt(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3;if(t>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");if(null==e)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");var n=!1,r=!1,a=!1,i=!1,o=!1,u=!1;if(e.data instanceof Uint8Array)n=!0;else if("undefined"!==typeof ImageData&&e instanceof ImageData)r=!0;else if("undefined"!==typeof HTMLVideoElement&&e instanceof HTMLVideoElement)a=!0;else if("undefined"!==typeof HTMLImageElement&&e instanceof HTMLImageElement)i=!0;else if(null!=e.getContext)o=!0;else{if(!("undefined"!==typeof ImageBitmap&&e instanceof ImageBitmap))throw new Error("pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, "+"but was ".concat(e.constructor.name));u=!0}var s=(0,zt.pI)(Bt.eBW,p.BV.backendName);if(null!=s){var c={pixels:e},l={numChannels:t};return p.BV.runKernel(Bt.eBW,c,l)}var f,d,h=a?[e.videoWidth,e.videoHeight]:[e.width,e.height],v=(0,ut.Z)(h,2),m=v[0],g=v[1];if(o)f=e.getContext("2d").getImageData(0,0,m,g).data;else if(r||n)f=e.data;else if(i||a||u){if(null==Ot)if("undefined"===typeof document){if("undefined"===typeof OffscreenCanvas||"undefined"===typeof OffscreenCanvasRenderingContext2D)throw new Error("Cannot parse input in current context. Reason: OffscreenCanvas Context2D rendering is not supported.");Ot=new OffscreenCanvas(1,1).getContext("2d")}else Ot=document.createElement("canvas").getContext("2d",{willReadFrequently:!0});Ot.canvas.width=m,Ot.canvas.height=g,Ot.drawImage(e,0,0,m,g),f=Ot.getImageData(0,0,m,g).data}if(4===t)d=new Int32Array(f);else{var y=m*g;d=new Int32Array(y*t);for(var b=0;b<y;b++)for(var x=0;x<t;++x)d[b*t+x]=f[4*b+x]}var w=[g,m,t];return(0,Zt.w)(d,w,"int32")}function Ut(e){return"undefined"!==typeof window&&"undefined"!==typeof ImageBitmap&&window.hasOwnProperty("createImageBitmap")&&!(e instanceof ImageBitmap)&&function(e){return null!=e&&0!==e.width&&0!==e.height}(e)&&!function(e){return null!=e&&e.data instanceof Uint8Array}(e)}function Wt(e){return Vt.apply(this,arguments)}function Vt(){return Vt=(0,_.Z)(C().mark((function e(t){var n,r,a,i=arguments;return C().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=i.length>1&&void 0!==i[1]?i[1]:3,r=null,!(0,y.OB)().getBool("WRAP_TO_IMAGEBITMAP")||!Ut(t)){e.next=15;break}return e.prev=3,e.next=6,createImageBitmap(t,{premultiplyAlpha:"none"});case 6:a=e.sent,e.next=12;break;case 9:e.prev=9,e.t0=e.catch(3),a=null;case 12:r=null!=a&&a.width===t.width&&a.height===t.height?a:t,e.next=16;break;case 15:r=t;case 16:return e.abrupt("return",Pt(r,n));case 17:case"end":return e.stop()}}),e,null,[[3,9]])}))),Vt.apply(this,arguments)}function qt(e){if(2!==e.rank&&3!==e.rank)throw new Error("toPixels only supports rank 2 or 3 tensors, got rank ".concat(e.rank,"."));var t=2===e.rank?1:e.shape[2];if(t>4||2===t)throw new Error("toPixels only supports depth of size "+"1, 3 or 4 but got ".concat(t));if("float32"!==e.dtype&&"int32"!==e.dtype)throw new Error("Unsupported type for toPixels: ".concat(e.dtype,".")+" Please use float32 or int32 tensors.")}function Gt(e,t){return Ht.apply(this,arguments)}function Ht(){return(Ht=(0,_.Z)(C().mark((function e(t,n){var r,a,i,o,u,s,c,l,f,d,h,v,m,g,y,b,x;return C().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=(0,Tt._1)(t,"img","toPixels"),t instanceof _e.es||(a=r,r=(0,xe.p)(a,"int32"),a.dispose()),qt(r),i=r.shape.slice(0,2),o=(0,ut.Z)(i,2),u=o[0],s=o[1],c=2===r.rank?1:r.shape[2],e.next=7,r.data();case 7:l=e.sent,f="float32"===r.dtype?255:1,d=new Uint8ClampedArray(s*u*4),h=0;case 11:if(!(h<u*s)){e.next=36;break}v=[0,0,0,255],m=0;case 14:if(!(m<c)){e.next=28;break}if(g=l[h*c+m],"float32"!==r.dtype){e.next=21;break}if(!(g<0||g>1)){e.next=19;break}throw new Error("Tensor values for a float32 Tensor must be in the "+"range [0 - 1] but encountered ".concat(g,"."));case 19:e.next=24;break;case 21:if("int32"!==r.dtype){e.next=24;break}if(!(g<0||g>255)){e.next=24;break}throw new Error("Tensor values for a int32 Tensor must be in the "+"range [0 - 255] but encountered ".concat(g,"."));case 24:1===c?(v[0]=g*f,v[1]=g*f,v[2]=g*f):v[m]=g*f;case 25:m++,e.next=14;break;case 28:d[(y=4*h)+0]=Math.round(v[0]),d[y+1]=Math.round(v[1]),d[y+2]=Math.round(v[2]),d[y+3]=Math.round(v[3]);case 33:++h,e.next=11;break;case 36:return null!=n&&(Lt||null!=(0,zt.pI)(Bt.hGc,p.BV.backendName)&&(console.warn("tf.browser.toPixels is not efficient to draw tensor on canvas. Please try tf.browser.draw instead."),Lt=!0),n.width=s,n.height=u,b=n.getContext("2d"),x=new ImageData(d,s,u),b.putImageData(x,0,0)),r!==t&&r.dispose(),e.abrupt("return",d);case 39:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Xt(e,t,n){var r=(0,Tt._1)(e,"img","draw");if(!(e instanceof _e.es)){var a=r;r=(0,xe.p)(a,"int32"),a.dispose()}qt(r),function(e){var t=(null===e||void 0===e?void 0:e.alpha)||1;if(t>1||t<0)throw new Error("Alpha value ".concat(t," is suppoed to be in range [0 - 1]."))}(null===n||void 0===n?void 0:n.imageOptions);var i={image:r},o={canvas:t,options:n};p.BV.runKernel(Bt.hGc,i,o)}var Kt=(0,Ft.op)({fromPixels_:Pt});function Yt(e,t){var n=e.shape.length,r=t.shape.length;if(n<1)throw new Error("tf.gatherND() expects the input to be rank 1 or higher,"+" but the rank was ".concat(n,"."));if(r<1)throw new Error("tf.gatherND() expects the indices to be rank 1 or higher,"+" but the rank was ".concat(r,"."));if("int32"!==t.dtype)throw new Error("tf.gatherND() expects the indices to be int32 type,"+" but the dtype was ".concat(t.dtype,"."));if(t.shape[r-1]>n)throw new Error("index innermost dimension length must be <= tensor rank; saw: "+"".concat(t.shape[r-1]," vs. ").concat(n));if(0===(0,P.NA)(e.shape))throw new Error("Requested more than 0 entries, but input is empty."+" Input shape: ".concat(e.shape,"."));for(var a=t.shape,i=a[a.length-1],o=1,u=0;u<a.length-1;++u)o*=a[u];var s=e.shape,c=a.slice();c.pop();for(var l=1,f=i;f<n;++f)l*=s[f],c.push(s[f]);var d=[].concat((0,Ce.Z)((0,P.e3)(e.shape).map((function(e){return e/l}))),[1]).slice(0,i);return[c,o,l,d]}var $t=n(8604),Qt=n(2875),Jt=n(9064),en=n(115),tn=.1;function nn(e,t,n){return null==n&&(n=rn()),an(e,t,(function(e,t){return cn(e,t,n)}))}function rn(){return 32===p.BV.backend.floatPrecision()?.001:tn}function an(e,t,n){var r=!0;if(((0,en.isTypedArray)(e)||(0,en.isTypedArray)(t))&&(r=!1),(0,en.isTypedArray)(e)&&(0,en.isTypedArray)(t)&&(r=!0),r){var a=e.constructor.name,i=t.constructor.name;if(a!==i)throw new Error("Arrays are of different type. Actual: ".concat(a,". ")+"Expected: ".concat(i))}if(Array.isArray(e)&&Array.isArray(t)){var o=(0,Tt.C)(e),u=(0,Tt.C)(t);if(!(0,P.cO)(o,u))throw new Error("Arrays have different shapes. "+"Actual: [".concat(o,"]. Expected: [").concat(u,"]"))}var s=(0,en.isTypedArray)(e)?e:(0,en.flatten)(e),c=(0,en.isTypedArray)(t)?t:(0,en.flatten)(t);if(s.length!==c.length)throw new Error("Arrays have different lengths actual: ".concat(s.length," vs ")+"expected: ".concat(c.length,".\n")+"Actual:   ".concat(s,".\n")+"Expected: ".concat(c,"."));for(var l=0;l<c.length;++l){var f=s[l],d=c[l];if(!n(f,d))throw new Error("Arrays differ: actual[".concat(l,"] = ").concat(f,", expected[").concat(l,"] = ").concat(d,".\n")+"Actual:   ".concat(s,".\n")+"Expected: ".concat(c,"."))}"undefined"!==typeof expect&&expect().nothing()}function on(e,t){e().then((function(){return t.fail()}),(function(){return t()})),"undefined"!==typeof expect&&expect().nothing()}function un(e,t){var n="string"===typeof t||"number"===typeof t||"boolean"===typeof t?[t]:t;return(0,P.HD)(e)||(0,P.HD)(e[0])||(0,P.HD)(t)||(0,P.HD)(t[0])?an(e,n,(function(e,t){return e==t})):an(e,t,(function(e,t){return cn(e,t,0)}))}function sn(e,t,n){if(null==n&&(n=rn()),!cn(e,t,n))throw new Error("Numbers differ: actual === ".concat(e,", expected === ").concat(t));"undefined"!==typeof expect&&expect().nothing()}function cn(e,t,n){return!isFinite(e)&&!isFinite(t)||!(isNaN(e)||isNaN(t)||Math.abs(e-t)>n)}function ln(e,t,n){for(var r=0;r<e.length;r++)if(e[r]<t||e[r]>n)throw new Error("Value out of range:".concat(e[r]," low: ").concat(t,", high: ").concat(n))}function fn(e,t){var n=new Float32Array(e),r=new Float32Array(t);if(n.length!==r.length)throw new Error("Expected ArrayBuffer to be of length "+"".concat(r.length,", but it was ").concat(n.length));for(var a=0;a<r.length;a++)if(n[a]!==r[a])throw new Error("Expected ArrayBuffer value at ".concat(a," to be ")+"".concat(r[a]," but got ").concat(n[a]," instead"))}function dn(e){for(var t=0;t<e.length;t++){var n=e[t];Array.isArray(n)?dn(n):e[t]=(0,en.encodeString)(n)}return e}function hn(e){var t=document.createElement("video");return"playsInline"in t&&(t.playsInline=!0),t.muted=!0,t.loop=!0,t.style.position="fixed",t.style.left="0px",t.style.top="0px",t.preload="auto",t.appendChild(e),new Promise((function(e){t.addEventListener("loadeddata",(function(n){return e(t)})),t.load()}))}function pn(e){return vn.apply(this,arguments)}function vn(){return(vn=(0,_.Z)(C().mark((function e(t){return C().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.play();case 2:if(!("requestVideoFrameCallback"in t)){e.next=5;break}return e.next=5,new Promise((function(e){t.requestVideoFrameCallback(e)}));case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var mn="4.17.0",gn=function(){function e(){(0,x.Z)(this,e)}return(0,w.Z)(e,null,[{key:"sgd",value:function(e){return new Je(e)}},{key:"momentum",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return new et(e,t,n)}},{key:"rmsprop",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.9,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];return new tt(e,t,n,r,a)}},{key:"adam",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.001,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.9,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.999,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return new Ke(e,t,n,r)}},{key:"adadelta",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.001,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.95,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return new Ve(e,t,n)}},{key:"adamax",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.002,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.9,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.999,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;return new Qe(e,t,n,r,a)}},{key:"adagrad",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.1;return new Ge(e,t)}}]),e}(),yn=n(3525),bn=n(9503),xn=n(7627),wn=gn,kn="undefined"!==typeof requestAnimationFrame?requestAnimationFrame:"undefined"!==typeof setImmediate?setImmediate:function(e){return e()};function _n(){return new Promise((function(e){return kn((function(){return e()}))}))}var Sn=n(8473);function Cn(e,t){var n=e[0].length;e.forEach((function(e,t){P.hu(e.length===n,(function(){return"Error in concat".concat(n,"D: rank of tensors[").concat(t,"] must be the same ")+"as the rank of the rest (".concat(n,")")}))})),P.hu(t>=0&&t<n,(function(){return"Error in concat".concat(n,"D: axis must be between 0 and ").concat(n-1,".")}));var r=e[0];e.forEach((function(e,a){for(var i=0;i<n;i++)P.hu(i===t||e[i]===r[i],(function(){return"Error in concat".concat(n,"D: Shape of tensors[").concat(a,"] (").concat(e,") ")+"does not match the shape of the rest (".concat(r,") ")+"along the non-concatenated axis ".concat(a,".")}))}))}function An(e,t){for(var n=e[0].slice(),r=1;r<e.length;r++)n[t]+=e[r][t];return n}var En,Nn=n(9151),Tn=n(5171);function In(e,t,n){var r=new Array;if(null==n&&null==t)return r;if(null==t)for(;r.length<e+n.length;)r.push(-1);else r=t.slice();if(null==n)return r;if(e+n.length!==r.length)throw new Error("rt input.shape and shape=".concat(t," are incompatible: rt input.rank = ").concat(e+n.length,", but shape.rank = ").concat(r.length));for(var a=1;a<n.length;++a){var i=n[a],o=r[r.length-n.length+a],u=r[o];if(i>=0)if(u>=0){if(u!==i)throw new Error("rt input.shape and shape=".concat(t," are incompatible: rt input.shape[").concat(a+e,"] = ").concat(i," but shape[").concat(a+e,"] = ").concat(u))}else r[o]=i}return r}function Dn(e){var t,n={FIRST_DIM_SIZE:En.FIRST_DIM_SIZE,VALUE_ROWIDS:En.VALUE_ROWIDS,ROW_LENGTHS:En.ROW_LENGTHS,ROW_SPLITS:En.ROW_SPLITS,ROW_LIMITS:En.ROW_LIMITS,ROW_STARTS:En.ROW_STARTS},r=[],a=(0,k.Z)(e);try{for(a.s();!(t=a.n()).done;){var i=t.value;if(!(i in n))break;r.push(n[i])}}catch(Mr){a.e(Mr)}finally{a.f()}return r}function Fn(e){return 0===e.length?0:e[0]===En.FIRST_DIM_SIZE?e.length-1:e.length}function Mn(e,t){if(null!=e&&null!=t){var n=e.length,r=t.length;if(n>=r)throw new Error("defaultValue.shape=".concat(e," and ragged tensor flatValues.shape=").concat(t,", are incompatible: defaultValue.rank = ").concat(n," must be less than ragged tensor input flatValues.rank = ").concat(r,")"));for(var a=0;a<Math.min(n,r-1);++a){var i=e[a],o=t[a+1];if(i>=0&&o>=0&&1!==i&&i!==o)throw new Error("defaultValue.shape=".concat(e,", and ragged tensor input flatValues.shape=").concat(t," are incompatible: defaultValue.shape[").concat(a-e.length,"] = ").concat(i," but ragged tensor input.flatValues.shape[").concat(a-e.length,"] = ").concat(o))}}}!function(e){e[e.FIRST_DIM_SIZE=0]="FIRST_DIM_SIZE",e[e.VALUE_ROWIDS=1]="VALUE_ROWIDS",e[e.ROW_LENGTHS=2]="ROW_LENGTHS",e[e.ROW_SPLITS=3]="ROW_SPLITS",e[e.ROW_LIMITS=4]="ROW_LIMITS",e[e.ROW_STARTS=5]="ROW_STARTS"}(En||(En={}));var On=30;function Rn(e){return e<=On?e:(0,P.jP)(e,Math.floor(Math.sqrt(e)))}function jn(e,t,n){return[n*("number"===typeof e?e:e[0]),t*("number"===typeof e?e:e[1])]}function Bn(e,t,n){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],a=[];if(r)(a=a.concat(t.slice(0))).push(e[0]/n),a=a.concat(e.slice(1));else{a=a.concat(e[0]);for(var i=t.length,o=0;o<i;++o)a=a.concat([e[o+1]/t[o],t[o]]);a=a.concat(e.slice(i+1))}return a}function zn(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=[];if(n){r.push(t);for(var a=t+1;a<e;++a)a<=2*t?(r.push(a),r.push(a-(t+1))):r.push(a)}else{for(var i=[],o=[],u=1;u<e;++u)u>=2*t+1||u%2===1?o.push(u):i.push(u);r.push.apply(r,i),r.push(0),r.push.apply(r,o)}return r}function Zn(e,t,n){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],a=[];r?a.push(e[0]/n):a.push(e[0]*n);for(var i=1;i<e.length;++i)i<=t.length?r?a.push(t[i-1]*e[i]):a.push(e[i]/t[i-1]):a.push(e[i]);return a}function Ln(e,t){for(var n=[0],r=0;r<t;++r)n.push(e[r][0]);return n}function Pn(e,t,n){for(var r=e.slice(0,1),a=0;a<n;++a)r.push(e[a+1]-t[a][0]-t[a][1]);return r}var Un=n(349),Wn=.3275911,Vn=.254829592,qn=-.284496736,Gn=1.421413741,Hn=-1.453152027,Xn=1.061405429,Kn=n(7269);function Yn(e,t){if(e.length!==t.length)throw new Error("Cannot merge real and imag arrays of different lengths. real:"+"".concat(e.length,", imag: ").concat(t.length,"."));for(var n=new Float32Array(2*e.length),r=0;r<n.length;r+=2)n[r]=e[r/2],n[r+1]=t[r/2];return n}function $n(e){for(var t=new Float32Array(e.length/2),n=new Float32Array(e.length/2),r=0;r<e.length;r+=2)t[r/2]=e[r],n[r/2]=e[r+1];return{real:t,imag:n}}function Qn(e){for(var t=Math.ceil(e.length/4),n=new Float32Array(t),r=new Float32Array(t),a=0;a<e.length;a+=4)n[Math.floor(a/4)]=e[a],r[Math.floor(a/4)]=e[a+1];return{real:n,imag:r}}function Jn(e){for(var t=Math.floor(e.length/4),n=new Float32Array(t),r=new Float32Array(t),a=2;a<e.length;a+=4)n[Math.floor(a/4)]=e[a],r[Math.floor(a/4)]=e[a+1];return{real:n,imag:r}}function er(e,t){return{real:e[2*t],imag:e[2*t+1]}}function tr(e,t,n,r){e[2*r]=t,e[2*r+1]=n}function nr(e,t){for(var n=new Float32Array(e/2),r=new Float32Array(e/2),a=0;a<Math.ceil(e/2);a++){var i=(t?2:-2)*Math.PI*(a/e);n[a]=Math.cos(i),r[a]=Math.sin(i)}return{real:n,imag:r}}function rr(e,t,n){var r=(n?2:-2)*Math.PI*(e/t);return{real:Math.cos(r),imag:Math.sin(r)}}var ar="->",ir=/->/g;function or(e,t){var n=((e=e.replace(/\s/g,"")).length-e.replace(ir,"").length)/ar.length;if(n<1)throw new Error("Equations without an arrow are not supported.");if(n>1)throw new Error('Equation must contain exactly one arrow ("'.concat(ar,'").'));var r=e.split(ar),a=(0,ut.Z)(r,2),i=a[0],o=a[1];(0,P.hu)(-1===i.indexOf("..."),(function(){return'The ellipsis notation ("'.concat("...",'") is not supported yet.')}));var u=i.split(","),s=u.length;if(t!==s)throw new Error("Expected ".concat(s," input tensors, received ").concat(t));if(s>2)throw new Error("Support for more than 2 input tensors is not implemented yet.");for(var c=[],l=function(e){var t=o[e];if(!u.some((function(e){return-1!==e.indexOf(t)})))throw new Error("Output subscripts contain the label ".concat(t," ")+"not present in the input subscripts.");-1===c.indexOf(t)&&c.push(t)},f=0;f<o.length;++f)l(f);for(var d=0;d<i.length;++d){var h=i[d];-1===c.indexOf(h)&&","!==h&&c.push(h)}for(var p=new Array(u.length),v=0;v<s;++v){if(new Set(u[v].split("")).size!==u[v].length)throw new Error("Found duplicate axes in input component ".concat(u[v],". ")+"Support for duplicate axes in input is not implemented yet.");p[v]=[];for(var m=0;m<u[v].length;++m)p[v].push(c.indexOf(u[v][m]))}for(var g=c.length,y=[],b=o.length;b<g;++b)y.push(b);return{allDims:c,summedDims:y,idDims:p}}function ur(e,t){var n=new Array(e);n.fill(-1);for(var r=0;r<t.length;++r)n[t[r]]=r;for(var a=[],i=0;i<e;++i)-1===n[i]&&a.push(i);return{permutationIndices:n=n.filter((function(e){return-1!==e})),expandDims:a}}function sr(e,t,n){for(var r=new Array(e),a=function(e){for(var a=n[e].shape,i=function(n){void 0===r[t[e][n]]?r[t[e][n]]=a[n]:(0,P.hu)(r[t[e][n]]===a[n],(function(){return"Expected dimension ".concat(r[t[e][n]]," at axis ").concat(n," ")+"of input shaped ".concat(JSON.stringify(a),", ")+"but got dimension ".concat(a[n])}))},o=0;o<t[e].length;++o)i(o)},i=0;i<n.length;++i)a(i)}function cr(e,t){var n,r=e,a=[];0===e.length&&r.push(-1),n=e.length+1;for(var i=0;i<n;++i)a.push([]);for(var o=[],u=0;u<r.length;++u){var s,c=fr(t,r[u]),l=(0,k.Z)(c);try{for(l.s();!(s=l.n()).done;){var f=s.value;-1===o.indexOf(f)&&(a[u].push(f),o.push(f))}}catch(Mr){l.e(Mr)}finally{l.f()}}return{path:r,steps:a}}function lr(e){return e.every((function(e,t){return e===t}))}function fr(e,t){for(var n=[],r=0;r<e.length;++r)0!==e[r].length&&-1===e[r].indexOf(t)&&-1!==t||n.push(r);return n}function dr(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=[];if("number"===typeof t)(0,P.hu)(e.shape[n]%t===0,(function(){return"Number of splits must evenly divide the axis."})),r=new Array(t).fill(e.shape[n]/t);else{var a=t.reduce((function(e,t){return-1===t&&(e+=1),e}),0);(0,P.hu)(a<=1,(function(){return"There should be only one negative value in split array."}));var i=t.indexOf(-1);if(-1!==i){var o=t.reduce((function(e,t){return t>0?e+t:e}));t[i]=e.shape[n]-o}(0,P.hu)(e.shape[n]===t.reduce((function(e,t){return e+t})),(function(){return"The sum of sizes must match the size of the axis dimension."})),r=t}return r}function hr(e){return"Received SparseTensor with denseShape[0] = 0 but\n  indices.shape[0] = ".concat(e)}function pr(e,t){return"indices(".concat(e,", 0) is invalid: ").concat(t," < 0")}function vr(e,t,n){return"indices(".concat(e,", 0) is invalid: ").concat(t," >= ").concat(n)}function mr(e,t){return"only one output dimension may be -1, not both ".concat(e," and ").concat(t)}function gr(e,t){return"size ".concat(e," must be non-negative, not ").concat(t)}function yr(){return"reshape cannot infer the missing input size for an empty tensor unless all specified input sizes are non-zero"}function br(e,t){var n=(0,P.NA)(e),r=(0,P.NA)(t);return"Input to reshape is a SparseTensor with ".concat(n,"\n  dense values, but the requested shape requires a multiple of ").concat(r,". inputShape=").concat(e," outputShape= ").concat(t)}function xr(e,t){var n=(0,P.NA)(e),r=(0,P.NA)(t);return"Input to reshape is a tensor with ".concat(n," dense values, but the requested shape has ").concat(r,". inputShape=").concat(e," outputShape=").concat(t)}function wr(){return"segment ids must be >= 0"}function kr(){return"segment ids are not increasing"}function _r(e,t){return"Segment id ".concat(e," out of range [0, ").concat(t,"), possibly because segmentIds input is not sorted.")}function Sr(e,t,n){return"Bad: indices[".concat(e,"] == ").concat(t," out of range [0, ").concat(n,")")}function Cr(e,t){var n,r=!1;for(e<=On?(n=e,r=!0):n=(0,P.jP)(e,Math.floor(Math.sqrt(e)));!r;)n>t||n===e?r=!0:n=(0,P.jP)(e,n+1);return n}function Ar(e,t,n){for(var r=[],a=e.length,i=0;i<a;i++)i!==t?r.push(e[i]):r.push(n);return r}function Er(e,t,n,r){var a=t.shape.length,i=e.shape.length;if(0!==r&&(r<-a||r>a))throw new Error("Expect batchDims in the range of [-".concat(a,", ").concat(a,"], but got ").concat(r));if(r<0&&(r+=a),r>i)throw new Error("batchDims (".concat(r,") must be less than rank(x) (\n    ").concat(i,")."));if(n<r)throw new Error("batchDims (".concat(r,") must be less than or equal to axis (").concat(n,")."));for(var o=0;o<r;++o)if(e.shape[o]!==t.shape[o])throw new Error("x.shape[".concat(o,"]: ").concat(e.shape[o]," should be equal to indices.shape[").concat(o,"]: ").concat(t.shape[o],"."));for(var u=e.shape[n],s=[],c=1,l=1,f=1,d=0;d<r;++d)s.push(e.shape[d]),c*=e.shape[d];for(var h=r;h<n;h++)s.push(e.shape[h]),l*=e.shape[h];for(var p=r;p<a;p++)s.push(t.shape[p]);for(var v=n+1;v<i;v++)s.push(e.shape[v]),f*=e.shape[v];return{batchSize:c,sliceSize:f,outerSize:l,dimSize:u,outputShape:s}}function Nr(e){try{return e.map((function(e){return(0,en.decodeString)(e)}))}catch(Mr){throw new Error("Failed to decode encoded string bytes into utf-8, error: ".concat(Mr))}}function Tr(e){return e.map((function(e){return(0,en.encodeString)(e)}))}var Ir=n(745),Dr=n(4189),Fr=n(4679);!function(){var e,t=(0,k.Z)(nt);try{for(t.s();!(e=t.n()).done;){Pe(e.value)}}catch(Mr){t.e(Mr)}finally{t.f()}}()},5714:function(e,t,n){"use strict";n.d(t,{w:function(){return o}});var r=n(5671),a=n(3144),i=n(115),o=function(){function e(t){if((0,r.Z)(this,e),this.shards=[],this.previousShardIndex=0,null!=t&&(t instanceof Array||(t=[t]),0!==(t=t.map((function(e){return i.isTypedArray(e)?e.buffer:e}))).length)){this.bufferUniformSize=t[0].byteLength;for(var n=0,a=0;a<t.length;a++){var o=t[a];a!==t.length-1&&o.byteLength!==this.bufferUniformSize&&(this.bufferUniformSize=void 0);var u=n+o.byteLength;this.shards.push({buffer:o,start:n,end:u}),n=u}0===this.shards.length&&(this.byteLength=0),this.byteLength=this.shards[this.shards.length-1].end}}return(0,a.Z)(e,[{key:"slice",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.byteLength;if(0===this.shards.length)return new ArrayBuffer(0);if(e=isNaN(Number(e))?0:e,t=isNaN(Number(t))?0:t,e=Math.max(0,e),(t=Math.min(this.byteLength,t))<=e)return new ArrayBuffer(0);var n=this.findShardForByte(e);if(-1===n)throw new Error("Could not find start shard for byte ".concat(e));for(var r=t-e,a=new ArrayBuffer(r),i=new Uint8Array(a),o=0,u=n;u<this.shards.length;u++){var s=this.shards[u],c=e+o,l=c-s.start,f=o,d=Math.min(t,s.end),h=d-s.start,p=new Uint8Array(s.buffer,l,h-l);if(i.set(p,f),o+=p.length,t<s.end)break}return a}},{key:"findShardForByte",value:function(e){if(0===this.shards.length||e<0||e>=this.byteLength)return-1;if(null!=this.bufferUniformSize)return this.previousShardIndex=Math.floor(e/this.bufferUniformSize),this.previousShardIndex;function t(t){return e<t.start?-1:e>=t.end?1:0}if(0===t(this.shards[this.previousShardIndex]))return this.previousShardIndex;var n=function(e,t){var n=0,r=e.length;for(;n<=r;){var a=Math.floor((r-n)/2)+n,i=t(e[a]);if(0===i)return a;i<0?r=a:n=a+1}return-1}(this.shards,t);return-1===n?-1:(this.previousShardIndex=n,this.previousShardIndex)}}],[{key:"join",value:function(t){return new e(t).slice()}}]),e}()},1434:function(e,t,n){"use strict";n.d(t,{EZ:function(){return M},JY:function(){return F},Q:function(){return z},Yd:function(){return O},_n:function(){return I},dI:function(){return y},hu:function(){return Z},jN:function(){return j},ji:function(){return R},n7:function(){return D},r:function(){return C},yz:function(){return m}});var r=n(9439),a=n(3433),i=n(7762),o=n(5861),u=n(4687),s=n.n(u),c=n(9253),l=n(2442),f=n(6147),d=n(1988),h=n(5714),p=n(5875),v=n(5050);function m(e,t){return g.apply(this,arguments)}function g(){return g=(0,o.Z)(s().mark((function e(t,n){var r,a,i,u,c,l;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(r=[],a=[],i=Array.isArray(t)?t.map((function(e){return e.name})):Object.keys(t),u=function(e){var u=i[e],c=Array.isArray(t)?t[e].tensor:t[u];if("float32"!==c.dtype&&"int32"!==c.dtype&&"bool"!==c.dtype&&"string"!==c.dtype&&"complex64"!==c.dtype)throw new Error("Unsupported dtype in weight '".concat(u,"': ").concat(c.dtype));var l={name:u,shape:c.shape,dtype:c.dtype};if("string"===c.dtype){var f=new Promise(function(){var e=(0,o.Z)(s().mark((function e(t){var n,r,a,i,o,u,l;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.bytes();case 2:for(n=e.sent,r=n.reduce((function(e,t){return e+t.length}),0)+4*n.length,a=new Uint8Array(r),i=0,o=0;o<n.length;o++)u=n[o],l=new Uint8Array(new Uint32Array([u.length]).buffer),a.set(l,i),i+=4,a.set(u,i),i+=u.length;t(a);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());a.push(f)}else a.push(c.data());null!=n&&(l.group=n),r.push(l)},c=0;c<i.length;++c)u(c);return e.next=7,Promise.all(a);case 7:return l=e.sent,e.abrupt("return",{data:E(l),specs:r});case 9:case"end":return e.stop()}}),e)}))),g.apply(this,arguments)}function y(e,t){var n,r=new h.w(e),a={},o=0,u=(0,i.Z)(t);try{for(u.s();!(n=u.n()).done;){var s=n.value,c=b(s,(function(e,t){return r.slice(o+e,o+t)}));a[s.name]=k(s,r.slice(o,o+c)),o+=c}}catch(l){u.e(l)}finally{u.f()}return a}function b(e,t){var n,r=(0,f.NA)(e.shape);if("quantization"in e){var a=e.quantization;n=d.J[a.dtype]}else{if("string"===e.dtype){for(var i=0,o=0;o<r;o++)i+=4+new Uint32Array(t(i,i+4))[0];return i}n=d.J[e.dtype]}return r*n}function x(e,t){return w.apply(this,arguments)}function w(){return(w=(0,o.Z)(s().mark((function e(t,n){var r,a,i,o,u;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=(0,f.NA)(t.shape),!("quantization"in t)){e.next=6;break}i=t.quantization,a=d.J[i.dtype],e.next=25;break;case 6:if("string"!==t.dtype){e.next=24;break}o=0,u=0;case 9:if(!(u<r)){e.next=21;break}return e.t0=o,e.t1=4,e.t2=Uint32Array,e.next=15,n(o,o+4);case 15:e.t3=e.sent,e.t4=new e.t2(e.t3)[0],o=e.t0+=e.t1+e.t4;case 18:u++,e.next=9;break;case 21:return e.abrupt("return",o);case 24:a=d.J[t.dtype];case 25:return e.abrupt("return",r*a);case 26:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function k(e,t){var n,r=e.name,a=e.dtype,i=e.shape,o=(0,f.NA)(i),u=0;if("quantization"in e){var s=e.quantization;if("uint8"===s.dtype||"uint16"===s.dtype){if(!("min"in s)||!("scale"in s))throw new Error("Weight ".concat(e.name," with quantization ").concat(s.dtype," ")+"doesn't have corresponding metadata min and scale.")}else{if("float16"!==s.dtype)throw new Error("Weight ".concat(e.name," has unknown ")+"quantization dtype ".concat(s.dtype,". ")+"Supported quantization dtypes are: 'uint8', 'uint16', and 'float16'.");if("float32"!==a)throw new Error("Weight ".concat(e.name," is quantized with ").concat(s.dtype," ")+"which only supports weights of type float32 not ".concat(a,"."))}var h=d.J[s.dtype],p="uint8"===s.dtype?new Uint8Array(t):new Uint16Array(t);if("float32"===a)if("uint8"===s.dtype||"uint16"===s.dtype){n=new Float32Array(p.length);for(var v=0;v<p.length;v++){var m=p[v];n[v]=m*s.scale+s.min}}else{if("float16"!==s.dtype)throw new Error("Unsupported quantization type ".concat(s.dtype," ")+"for weight type float32.");var g=function(){var e=function(){var e=function(e){for(var t=e<<13,n=0;0===(8388608&t);)n-=8388608,t<<=1;return(t&=-8388609)|(n+=947912704)},t=new Uint32Array(2048);t[0]=0;for(var n=1;n<1024;n++)t[n]=e(n);for(var r=1024;r<2048;r++)t[r]=939524096+(r-1024<<13);return t}(),t=function(){var e=new Uint32Array(64);e[0]=0,e[31]=1199570944,e[32]=2147483648,e[63]=3347054592;for(var t=1;t<31;t++)e[t]=t<<23;for(var n=33;n<63;n++)e[n]=2147483648+(n-32<<23);return e}(),n=function(){for(var e=new Uint32Array(64),t=0;t<64;t++)e[t]=1024;return e[0]=e[32]=0,e}();return function(r){for(var a=new ArrayBuffer(4*r.length),i=new Uint32Array(a),o=0;o<r.length;o++){var u=r[o],s=e[n[u>>10]+(1023&u)]+t[u>>10];i[o]=s}return new Float32Array(a)}}();n=g(p)}else{if("int32"!==a)throw new Error("Unsupported dtype in weight '".concat(r,"': ").concat(a));if("uint8"!==s.dtype&&"uint16"!==s.dtype)throw new Error("Unsupported quantization type ".concat(s.dtype," ")+"for weight type int32.");n=new Int32Array(p.length);for(var y=0;y<p.length;y++){var b=p[y];n[y]=Math.round(b*s.scale+s.min)}}u+=o*h}else if("string"===a){var x=(0,f.NA)(e.shape);n=[];for(var w=0;w<x;w++){var k=new Uint32Array(t.slice(u,u+4))[0];u+=4;var _=new Uint8Array(t.slice(u,u+k));n.push(_),u+=k}}else{var S=d.J[a];if("float32"===a)n=new Float32Array(t);else if("int32"===a)n=new Int32Array(t);else{if("bool"!==a){if("complex64"===a){n=new Float32Array(t);for(var C=new Float32Array(n.length/2),A=new Float32Array(n.length/2),E=0;E<C.length;E++)C[E]=n[2*E],A[E]=n[2*E+1];var N=(0,l.X)(C,i,"float32"),T=(0,l.X)(A,i,"float32"),I=(0,c.P)(N,T);return N.dispose(),T.dispose(),I}throw new Error("Unsupported dtype in weight '".concat(r,"': ").concat(a))}n=new Uint8Array(t)}u+=o*S}return(0,l.X)(n,i,a)}function _(e,t,n){return S.apply(this,arguments)}function S(){return(S=(0,o.Z)(s().mark((function e(t,n,r){var a,i,o,u,c,l;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=new Uint8Array(n);case 1:if(!(a.byteLength<r)){e.next=16;break}return e.next=4,t.read();case 4:if(i=e.sent,o=i.done,u=i.value,!o||null!=u){e.next=10;break}throw c=r-a.byteLength,new Error("Reader is done but ".concat(c," bytes are still expected"));case 10:(l=new Uint8Array(a.length+u.byteLength)).set(a,0),l.set(new Uint8Array(u),a.length),a=l,e.next=1;break;case 16:return e.abrupt("return",a.buffer);case 17:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function C(e,t){return A.apply(this,arguments)}function A(){return A=(0,o.Z)(s().mark((function e(t,n){var r,a,u,c,l,d,h,m,g,y;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r={},a=t.getReader(),u=new ArrayBuffer(0),c=(0,i.Z)(n),e.prev=4,c.s();case 6:if((l=c.n()).done){e.next=21;break}return d=l.value,e.next=10,x(d,function(){var e=(0,o.Z)(s().mark((function e(t,n){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_(a,u,n);case 2:return u=e.sent,e.abrupt("return",u.slice(t,n));case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}());case 10:return h=e.sent,e.next=13,_(a,u,h);case 13:u=e.sent,m=u.slice(0,h),u=u.slice(h),g=k(d,m),r[d.name]=g,"webgpu"===(0,p.N_)()&&"uploadToGPU"in(y=(0,p.y3)())&&(0,f.NA)(g.shape)>=(0,v.OB)().get("WEBGPU_CPU_HANDOFF_SIZE_THRESHOLD")&&y.uploadToGPU(g.dataId);case 19:e.next=6;break;case 21:e.next=26;break;case 23:e.prev=23,e.t0=e.catch(4),c.e(e.t0);case 26:return e.prev=26,c.f(),e.finish(26);case 29:return e.abrupt("return",r);case 30:case"end":return e.stop()}}),e,null,[[4,23,26,29]])}))),A.apply(this,arguments)}function E(e){if(null===e)throw new Error("Invalid input value: ".concat(JSON.stringify(e)));var t=0,n=[];e.forEach((function(e){if(t+=e.byteLength,n.push(e.byteLength===e.buffer.byteLength?e:new e.constructor(e)),!(e instanceof Float32Array||e instanceof Int32Array||e instanceof Uint8Array))throw new Error("Unsupported TypedArray subtype: ".concat(e.constructor.name))}));var r=new Uint8Array(t),a=0;return n.forEach((function(e){r.set(new Uint8Array(e.buffer),a),a+=e.byteLength})),r.buffer}var N="undefined"!==typeof Buffer&&("undefined"===typeof Blob||"undefined"===typeof atob||"undefined"===typeof btoa);function T(e){return N?Buffer.byteLength(e,"utf8"):new Blob([e]).size}function I(e){if(N)return Buffer.from(e).toString("base64");for(var t=new Uint8Array(e),n="",r=0,a=t.length;r<a;r++)n+=String.fromCharCode(t[r]);return btoa(n)}function D(e){if(N){var t=Buffer.from(e,"base64");return t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength)}for(var n=atob(e),r=new Uint8Array(n.length),a=0;a<n.length;++a)r.set([n.charCodeAt(a)],a);return r.buffer}function F(e){return h.w.join(e)}function M(e){for(e=e.trim();e.endsWith("/");)e=e.slice(0,e.length-1);var t=e.split("/");return t[t.length-1]}function O(e,t){var n={modelTopology:e.modelTopology,format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,weightsManifest:t};return null!=e.signature&&(n.signature=e.signature),null!=e.userDefinedMetadata&&(n.userDefinedMetadata=e.userDefinedMetadata),null!=e.modelInitializer&&(n.modelInitializer=e.modelInitializer),null!=e.initializerSignature&&(n.initializerSignature=e.initializerSignature),null!=e.trainingConfig&&(n.trainingConfig=e.trainingConfig),n}function R(e,t,n){var r={modelTopology:e.modelTopology,format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy};if(null!=e.trainingConfig&&(r.trainingConfig=e.trainingConfig),null!=e.weightsManifest){if(!t)throw new Error("modelJSON has weightsManifest but weightSpecs is null");if(!n)throw new Error("modelJSON has weightsManifest but weightData is null");r.weightSpecs=t,r.weightData=n}return null!=e.signature&&(r.signature=e.signature),null!=e.userDefinedMetadata&&(r.userDefinedMetadata=e.userDefinedMetadata),null!=e.modelInitializer&&(r.modelInitializer=e.modelInitializer),null!=e.initializerSignature&&(r.initializerSignature=e.initializerSignature),r}function j(e,t){return B.apply(this,arguments)}function B(){return(B=(0,o.Z)(s().mark((function e(t,n){var a,i,o,u;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==t.weightsManifest){e.next=7;break}return e.next=3,n(t.weightsManifest);case 3:o=e.sent,u=(0,r.Z)(o,2),a=u[0],i=u[1];case 7:return e.abrupt("return",R(t,a,i));case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function z(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:null==e.modelTopology?0:T(JSON.stringify(e.modelTopology)),weightSpecsBytes:null==e.weightSpecs?0:T(JSON.stringify(e.weightSpecs)),weightDataBytes:null==e.weightData?0:new h.w(e.weightData).byteLength}}function Z(e){var t,n=[],r=(0,i.Z)(e);try{for(r.s();!(t=r.n()).done;){var o=t.value;n.push.apply(n,(0,a.Z)(o.weights))}}catch(u){r.e(u)}finally{r.f()}return n}},1988:function(e,t,n){"use strict";n.d(t,{J:function(){return r}});var r={float32:4,float16:2,int32:4,uint16:2,uint8:1,bool:1,complex64:8}},2145:function(e,t,n){"use strict";n.d(t,{$HU:function(){return yt},$g6:function(){return te},$w:function(){return K},Acj:function(){return ye},BMI:function(){return Pe},BiW:function(){return vt},Byc:function(){return P},CAk:function(){return Ee},CQl:function(){return pt},D2d:function(){return Kt},DlI:function(){return dt},Eh3:function(){return F},FKq:function(){return Lt},G3Y:function(){return ln},GBy:function(){return Pt},Gcp:function(){return Vt},HEU:function(){return re},HZH:function(){return xt},Hhh:function(){return ze},Hmb:function(){return kt},IKK:function(){return c},IMb:function(){return x},J$2:function(){return Ce},J7O:function(){return Ze},J_u:function(){return we},JhU:function(){return g},Kgp:function(){return ct},L8s:function(){return Wt},Ly9:function(){return C},M2y:function(){return d},MIZ:function(){return on},MRv:function(){return Zt},MZg:function(){return Me},NEP:function(){return oe},NZg:function(){return Qe},O3z:function(){return qt},OAf:function(){return Ve},OR:function(){return de},OU7:function(){return qe},OV7:function(){return We},Omj:function(){return ae},Oyi:function(){return v},PYm:function(){return De},PhF:function(){return Ft},QCc:function(){return m},QRR:function(){return V},Qg5:function(){return xe},QiL:function(){return ut},Qvg:function(){return hn},RFZ:function(){return E},ROF:function(){return y},RQH:function(){return Rt},RuY:function(){return vn},SIB:function(){return It},SX0:function(){return ne},SYM:function(){return r},SbG:function(){return Ct},SpW:function(){return i},T0n:function(){return q},TQc:function(){return Ut},TR1:function(){return L},ToN:function(){return dn},Tr8:function(){return rn},Uyb:function(){return fe},VGw:function(){return a},Vbg:function(){return $e},VcC:function(){return W},VfG:function(){return Fe},Vn9:function(){return Q},W0H:function(){return at},XDQ:function(){return pn},XLW:function(){return w},XkS:function(){return nn},Xze:function(){return u},Y0y:function(){return se},YFo:function(){return ue},YoZ:function(){return Le},ZbH:function(){return Te},ZjV:function(){return Xt},Zz9:function(){return I},_JP:function(){return en},_V0:function(){return xn},_Yw:function(){return _t},_k9:function(){return b},_tC:function(){return Yt},a5O:function(){return zt},aJk:function(){return f},avt:function(){return ke},b9H:function(){return yn},bK0:function(){return $t},bV0:function(){return Nt},c17:function(){return Xe},cWu:function(){return sn},cie:function(){return G},cye:function(){return rt},dDz:function(){return ht},deh:function(){return le},dpD:function(){return wt},e07:function(){return Et},e0R:function(){return Qt},e6w:function(){return mt},e7N:function(){return Ne},eBW:function(){return gn},eEB:function(){return A},eZ0:function(){return Be},ekb:function(){return $},gJX:function(){return N},h8e:function(){return mn},hCO:function(){return S},hGc:function(){return J},hdR:function(){return ie},i5y:function(){return Bt},iHb:function(){return U},iJz:function(){return be},iWB:function(){return _e},iZT:function(){return ge},ik2:function(){return z},jMg:function(){return p},jQk:function(){return Jt},jQs:function(){return Ye},jeX:function(){return he},kU:function(){return Ie},kpP:function(){return fn},kuV:function(){return et},luS:function(){return wn},lyA:function(){return st},mKl:function(){return At},mTV:function(){return Ue},mc4:function(){return Z},mhS:function(){return M},mm_:function(){return o},n9L:function(){return un},nhH:function(){return Gt},nr8:function(){return Dt},o0g:function(){return ft},o2y:function(){return B},oFR:function(){return Mt},oHH:function(){return ee},oT6:function(){return s},p2w:function(){return Ot},p4S:function(){return Y},pe_:function(){return lt},q1x:function(){return me},q2K:function(){return He},q8u:function(){return Ke},qCd:function(){return Re},qIC:function(){return je},qWM:function(){return it},qi_:function(){return ve},qkr:function(){return bt},qw7:function(){return h},r7n:function(){return Se},s1s:function(){return tn},sEM:function(){return an},sHE:function(){return pe},sJF:function(){return l},sL$:function(){return H},usg:function(){return bn},uv1:function(){return nt},vFR:function(){return Ge},vtC:function(){return Ae},vwp:function(){return ce},w3H:function(){return Ht},w6g:function(){return Oe},wUP:function(){return O},wYB:function(){return jt},wYn:function(){return Je},we_:function(){return ot},wm:function(){return R},wx7:function(){return cn},x12:function(){return j},xJR:function(){return gt},xQA:function(){return Tt},xnO:function(){return T},y7R:function(){return X},yQU:function(){return tt},yj2:function(){return D},zbQ:function(){return St},zvY:function(){return _},zws:function(){return k}});var r="Abs",a="Acos",i="Acosh",o="Add",u="AddN",s="All",c="Any",l="ArgMax",f="ArgMin",d="Asin",h="Asinh",p="Atan",v="Atanh",m="Atan2",g="AvgPool",y="AvgPoolGrad",b="AvgPool3D",x="AvgPool3DGrad",w="BatchMatMul",k="BatchToSpaceND",_="Bincount",S="BitwiseAnd",C="BroadcastTo",A="BroadcastArgs",E="Cast",N="Ceil",T="ClipByValue",I="Complex",D="ComplexAbs",F="Concat",M="Conv2D",O="Conv2DBackpropFilter",R="Conv2DBackpropInput",j="Conv3D",B="Conv3DBackpropFilterV2",z="Conv3DBackpropInputV2",Z="Cos",L="Cosh",P="Cumprod",U="Cumsum",W="CropAndResize",V="DenseBincount",q="DepthToSpace",G="DepthwiseConv2dNative",H="DepthwiseConv2dNativeBackpropFilter",X="DepthwiseConv2dNativeBackpropInput",K="Diag",Y="Dilation2D",$="Dilation2DBackpropInput",Q="Dilation2DBackpropFilter",J="Draw",ee="RealDiv",te="Einsum",ne="Elu",re="EluGrad",ae="Erf",ie="Equal",oe="Exp",ue="ExpandDims",se="Expm1",ce="FFT",le="Fill",fe="FlipLeftRight",de="Floor",he="FloorDiv",pe="FusedBatchNorm",ve="GatherV2",me="GatherNd",ge="Greater",ye="GreaterEqual",be="Identity",xe="IFFT",we="Imag",ke="IsFinite",_e="IsInf",Se="IsNan",Ce="LeakyRelu",Ae="Less",Ee="LessEqual",Ne="LinSpace",Te="Log",Ie="Log1p",De="LogicalAnd",Fe="LogicalNot",Me="LogicalOr",Oe="LogicalXor",Re="LogSoftmax",je="LowerBound",Be="LRN",ze="LRNGrad",Ze="MatrixBandPart",Le="Max",Pe="Maximum",Ue="MaxPool",We="MaxPoolGrad",Ve="MaxPool3D",qe="MaxPool3DGrad",Ge="MaxPoolWithArgmax",He="Mean",Xe="Min",Ke="Minimum",Ye="MirrorPad",$e="Mod",Qe="Multinomial",Je="Multiply",et="Neg",tt="NotEqual",nt="NonMaxSuppressionV3",rt="NonMaxSuppressionV4",at="NonMaxSuppressionV5",it="OnesLike",ot="OneHot",ut="Pack",st="PadV2",ct="Pool",lt="Pow",ft="Prelu",dt="Prod",ht="RaggedGather",pt="RaggedRange",vt="RaggedTensorToTensor",mt="Range",gt="Real",yt="Reciprocal",bt="Relu",xt="Reshape",wt="ResizeNearestNeighbor",kt="ResizeNearestNeighborGrad",_t="ResizeBilinear",St="ResizeBilinearGrad",Ct="Relu6",At="Reverse",Et="Round",Nt="Rsqrt",Tt="ScatterNd",It="TensorScatterUpdate",Dt="SearchSorted",Ft="Select",Mt="Selu",Ot="Slice",Rt="Sin",jt="Sinh",Bt="Sign",zt="Sigmoid",Zt="Softplus",Lt="Sqrt",Pt="Sum",Ut="SpaceToBatchND",Wt="SplitV",Vt="Softmax",qt="SparseFillEmptyRows",Gt="SparseReshape",Ht="SparseSegmentMean",Xt="SparseSegmentSum",Kt="SparseToDense",Yt="SquaredDifference",$t="Square",Qt="StaticRegexReplace",Jt="StridedSlice",en="StringNGrams",tn="StringSplit",nn="StringToHashBucketFast",rn="Sub",an="Tan",on="Tanh",un="Tile",sn="TopK",cn="Transform",ln="Transpose",fn="Unique",dn="Unpack",hn="UnsortedSegmentSum",pn="UpperBound",vn="ZerosLike",mn="Step",gn="FromPixels",yn="RotateWithOffset",bn="_FusedMatMul",xn="FusedConv2D",wn="FusedDepthwiseConv2D"},8864:function(e,t,n){"use strict";n.d(t,{Li:function(){return h},T3:function(){return m},bt:function(){return v},nE:function(){return p},pI:function(){return c},tr:function(){return f},uk:function(){return l},wC:function(){return d}});var r=n(9439),a=n(5050),i=n(6581),o=n(7269),u=(0,i.R)("kernelRegistry",(function(){return new Map})),s=(0,i.R)("gradRegistry",(function(){return new Map}));function c(e,t){var n=g(e,t);return u.get(n)}function l(e){return s.get(e)}function f(e){for(var t=u.entries(),n=[];;){var a=t.next(),i=a.done,o=a.value;if(i)break;var s=(0,r.Z)(o,2),c=s[0],l=s[1],f=c.split("_");(0,r.Z)(f,1)[0]===e&&n.push(l)}return n}function d(e){var t=e.kernelName,n=e.backendName,r=g(t,n);u.has(r)&&o.Z("The kernel '".concat(t,"' for backend ")+"'".concat(n,"' is already registered")),u.set(r,e)}function h(e){var t=e.kernelName;s.has(t)&&(0,a.OB)().getBool("DEBUG")&&o.Z("Overriding the gradient for '".concat(t,"'")),s.set(t,e)}function p(e,t){var n=g(e,t);if(!u.has(n))throw new Error("The kernel '".concat(e,"' for backend ")+"'".concat(t,"' is not registered"));u.delete(n)}function v(e){if(!s.has(e))throw new Error("The gradient '".concat(e,"' for backend is not registered"));s.delete(e)}function m(e,t){f(e).forEach((function(e){d(Object.assign({},e,{backendName:t}))}))}function g(e,t){return"".concat(t,"_").concat(e)}},7269:function(e,t,n){"use strict";n.d(t,{Z:function(){return a},c:function(){return i}});var r=n(5050);function a(){var e;(0,r.OB)().getBool("IS_TEST")||(0,r.OB)().getBool("PROD")||(e=console).warn.apply(e,arguments)}function i(){var e;(0,r.OB)().getBool("IS_TEST")||(0,r.OB)().getBool("PROD")||(e=console).log.apply(e,arguments)}},7613:function(e,t,n){"use strict";n.d(t,{W:function(){return o}});var r=n(318),a=n(2145),i=n(8354);var o=(0,n(8640).op)({abs_:function(e){var t=(0,i._1)(e,"x","abs");if("complex64"===t.dtype){var n={x:t};return r.BV.runKernel(a.yj2,n)}var o={x:t};return r.BV.runKernel(a.SYM,o)}})},1719:function(e,t,n){"use strict";n.d(t,{K:function(){return o}});var r=n(318),a=n(2145),i=n(8354);var o=(0,n(8640).op)({acos_:function(e){var t={x:(0,i._1)(e,"x","acos")};return r.BV.runKernel(a.VGw,t)}})},4502:function(e,t,n){"use strict";n.d(t,{_:function(){return o}});var r=n(318),a=n(2145),i=n(8354);var o=(0,n(8640).op)({acosh_:function(e){var t={x:(0,i._1)(e,"x","acosh")};return r.BV.runKernel(a.SpW,t)}})},3312:function(e,t,n){"use strict";n.d(t,{I:function(){return s}});var r=n(9439),a=n(318),i=n(2145),o=n(9064),u=n(8354);var s=(0,n(8640).op)({add_:function(e,t){var n=(0,u._1)(e,"a","add"),s=(0,u._1)(t,"b","add"),c=(0,o.makeTypesMatch)(n,s),l=(0,r.Z)(c,2),f={a:n=l[0],b:s=l[1]};return a.BV.runKernel(i.mm_,f)}})},4108:function(e,t,n){"use strict";n.d(t,{$:function(){return o}});var r=n(318),a=n(2145),i=n(8354);var o=(0,n(8640).op)({all_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=(0,i._1)(e,"x","all","bool"),u={x:o},s={axis:t,keepDims:n};return r.BV.runKernel(a.oT6,u,s)}})},8543:function(e,t,n){"use strict";n.d(t,{Y:function(){return o}});var r=n(318),a=n(2145),i=n(8354);var o=(0,n(8640).op)({any_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=(0,i._1)(e,"x","any","bool"),u={x:o},s={axis:t,keepDims:n};return r.BV.runKernel(a.IKK,u,s)}})},9995:function(e,t,n){"use strict";n.d(t,{N:function(){return o}});var r=n(318),a=n(2145),i=n(8354);var o=(0,n(8640).op)({argMax_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(0,i._1)(e,"x","argMax"),o={x:n},u={axis:t};return r.BV.runKernel(a.sJF,o,u)}})},5157:function(e,t,n){"use strict";n.d(t,{v:function(){return o}});var r=n(318),a=n(2145),i=n(8354);var o=(0,n(8640).op)({argMin_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(0,i._1)(e,"x","argMin"),o={x:n},u={axis:t};return r.BV.runKernel(a.aJk,o,u)}})},3053:function(e,t,n){"use strict";n.d(t,{Z:function(){return o}});var r=n(318),a=n(2145),i=n(8354);var o=(0,n(8640).op)({asin_:function(e){var t={x:(0,i._1)(e,"x","asin")};return r.BV.runKernel(a.M2y,t)}})},54:function(e,t,n){"use strict";n.d(t,{V:function(){return o}});var r=n(318),a=n(2145),i=n(8354);var o=(0,n(8640).op)({asinh_:function(e){var t={x:(0,i._1)(e,"x","asinh")};return r.BV.runKernel(a.qw7,t)}})},4778:function(e,t,n){"use strict";n.d(t,{z:function(){return o}});var r=n(318),a=n(2145),i=n(8354);var o=(0,n(8640).op)({atan_:function(e){var t={x:(0,i._1)(e,"x","atan")};return r.BV.runKernel(a.jMg,t)}})},2227:function(e,t,n){"use strict";n.d(t,{f:function(){return s}});var r=n(9439),a=n(318),i=n(2145),o=n(9064),u=n(8354);var s=(0,n(8640).op)({atan2_:function(e,t){var n=(0,u._1)(e,"a","atan2"),s=(0,u._1)(t,"b","atan2"),c=(0,o.makeTypesMatch)(n,s),l=(0,r.Z)(c,2),f={a:n=l[0],b:s=l[1]};return a.BV.runKernel(i.QCc,f)}})},7897:function(e,t,n){"use strict";n.d(t,{C:function(){return o}});var r=n(318),a=n(2145),i=n(8354);var o=(0,n(8640).op)({atanh_:function(e){var t={x:(0,i._1)(e,"x","atanh")};return r.BV.runKernel(a.Oyi,t)}})},9204:function(e,t,n){"use strict";n.d(t,{w:function(){return f}});var r=n(318),a=n(2145),i=n(8354),o=n(6147),u=n(9118),s=n(9151),c=n(8640),l=n(5561);var f=(0,c.op)({avgPool_:function(e,t,n,c,f){var d=(0,i._1)(e,"x","avgPool","float32");o.hu(s.jT(n,1),(function(){return"Error in avgPool: Either strides or dilations must be 1. "+"Got strides ".concat(n," and dilations '").concat(1,"'")}));var h=d,p=!1;3===d.rank&&(p=!0,h=(0,l.X)(d,[1,d.shape[0],d.shape[1],d.shape[2]])),o.hu(4===h.rank,(function(){return"Error in avgPool: x must be rank 4 but got rank ".concat(h.rank,".")})),s.m("avgPool",c,f);var v={x:h},m={filterSize:t,strides:n,pad:c,dimRoundingMode:f},g=r.BV.runKernel(a.JhU,v,m);return g=(0,u.p)(g,d.dtype),p?(0,l.X)(g,[g.shape[1],g.shape[2],g.shape[3]]):g}})},8473:function(e,t,n){"use strict";n.d(t,{LJ:function(){return l},Q3:function(){return c},Vh:function(){return i},YB:function(){return a},kz:function(){return o},lB:function(){return s},rv:function(){return u},sY:function(){return f}});var r=n(6147);function a(e,t){for(var n=0;n<e.length;++n)if(e[e.length-n-1]!==t-1-n)return!1;return!0}function i(e,t,n){for(var r=e.length+t.length,a=[],i=0,o=0,u=0;u<r;u++)-1===n.indexOf(u)?a.push(e[i++]):a.push(t[o++]);return a}function o(e,t){for(var n=[],r=e.length,a=0;a<r;a++)-1===t.indexOf(a)&&n.push(e[a]);var i=t.map((function(t){return e[t]}));return[n,i]}function u(e,t){return i(e,t.map((function(e){return 1})),t)}function s(e,t,n){r.hu(a(t,n),(function(){return"".concat(e," supports only inner-most axes for now. ")+"Got axes ".concat(t," and rank-").concat(n," input.")}))}function c(e,t){if(a(e,t))return null;for(var n=[],r=0;r<t;++r)-1===e.indexOf(r)&&n.push(r);return e.forEach((function(e){return n.push(e)})),n}function l(e){return e.map((function(e,t){return[t,e]})).sort((function(e,t){return e[1]-t[1]})).map((function(e){return e[0]}))}function f(e,t){for(var n=[],r=t-e;r<t;++r)n.push(r);return n}},6994:function(e,t,n){"use strict";n.d(t,{E:function(){return u}});var r=n(318),a=n(2145),i=n(8354),o=n(6147);var u=(0,n(8640).op)({batchToSpaceND_:function(e,t,n){var u=(0,i._1)(e,"x","batchToSpaceND"),s=t.reduce((function(e,t){return e*t}));o.hu(u.rank>=1+t.length,(function(){return"input rank is ".concat(u.rank," but should be > than blockShape.length ").concat(t.length)})),o.hu(n.length===t.length,(function(){return"crops.length is ".concat(n.length," but should be equal to blockShape.length  ").concat(t.length)})),o.hu(u.shape[0]%s===0,(function(){return"input tensor batch is ".concat(u.shape[0]," but is not divisible by the product of ")+"the elements of blockShape ".concat(t.join(" * ")," === ").concat(s)}));var c={x:u},l={blockShape:t,crops:n};return r.BV.runKernel(a.zws,c,l)}})},3700:function(e,t,n){"use strict";n.d(t,{t:function(){return s}});var r=n(318),a=n(2145),i=n(8354),o=n(6147),u=n(5561);var s=(0,n(8640).op)({batchNorm_:function(e,t,n,s,c,l){null==l&&(l=.001);var f,d,h=(0,i._1)(e,"x","batchNorm"),p=(0,i._1)(t,"mean","batchNorm"),v=(0,i._1)(n,"variance","batchNorm");null!=c&&(f=(0,i._1)(c,"scale","batchNorm")),null!=s&&(d=(0,i._1)(s,"offset","batchNorm")),o.hu(p.rank===v.rank,(function(){return"Batch normalization gradient requires mean and variance to have equal ranks."})),o.hu(null==d||p.rank===d.rank,(function(){return"Batch normalization gradient requires mean and offset to have equal ranks."})),o.hu(null==f||p.rank===f.rank,(function(){return"Batch normalization gradient requires mean and scale to have equal ranks."}));var m=function(e){return 0===e.rank||1===e.rank?(0,u.X)(e,[1,1,1,e.size]):2===e.rank?(0,u.X)(e,[1,1,e.shape[0],e.shape[1]]):3===e.rank?(0,u.X)(e,[1,e.shape[0],e.shape[1],e.shape[2]]):e}(h),g={x:m,scale:f,offset:d,mean:p,variance:v},y={varianceEpsilon:l},b=r.BV.runKernel(a.sHE,g,y);return(0,u.X)(b,h.shape)}})},9742:function(e,t,n){"use strict";n.d(t,{U:function(){return l}});var r=n(318),a=n(2145),i=n(8354),o=n(6147),u=n(672),s=n(8640),c=n(5561);var l=(0,s.op)({broadcastTo_:function(e,t){var n=(0,i._1)(e,"broadcastTo","x"),s=n.shape;if((0,o.Mu)(t),t.length<n.rank)throw new Error("broadcastTo(): shape.length=".concat(t.length," < input.rank=").concat(n.rank,"."));if(t.length>n.rank){for(var l=n.shape.slice();l.length<t.length;)l.unshift(1);n=(0,c.X)(n,l)}for(var f=n.shape,d=Array.from(t),h=t.length-1;h>=0;h--)if(f[h]===t[h])d[h]=1;else if(1!==n.shape[h])throw new Error("broadcastTo(): [".concat(s,"] cannot be broadcast to [").concat(t,"]."));var p=d.map((function(e,t){return e>1?t:-1})).filter((function(e){return e>=0}));if(0===p.length)return(0,u.d)(n);var v={x:n},m={reps:d};return r.BV.runKernel(a.n9L,v,m)}})},5774:function(e,t,n){"use strict";function r(e,t){for(var n=e.length,r=[],a=0;a<n;a++){var i=n-1-a,o=e[i]||1;(t[t.length-1-a]||1)>1&&1===o&&r.unshift(i)}return r}function a(e,t){for(var n=[],r=0;r<t.length;r++){var a=e[e.length-r-1],i=t.length-r-1,o=t[i];(null==a||1===a&&o>1)&&n.unshift(i)}return n}function i(e,t){for(var n=Math.max(e.length,t.length),r=new Array(n),a=0;a<n;a++){var i=e[e.length-a-1];null==i&&(i=1);var o=t[t.length-a-1];if(null==o&&(o=1),1===i)r[n-a-1]=o;else if(1===o)r[n-a-1]=i;else{if(i!==o){var u="Operands could not be broadcast together with shapes "+"".concat(e," and ").concat(t,".");throw Error(u)}r[n-a-1]=i}}return r}n.r(t),n.d(t,{assertAndGetBroadcastShape:function(){return i},getBroadcastDims:function(){return r},getReductionAxes:function(){return a}})},7039:function(e,t,n){"use strict";n.d(t,{f:function(){return i}});var r=n(4376),a=n(6147);function i(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"float32",n=arguments.length>2?arguments[2]:void 0;return t=t||"float32",a.Mu(e),new r.YD(e,t,n)}},9118:function(e,t,n){"use strict";n.d(t,{p:function(){return u}});var r=n(318),a=n(2145),i=n(8354),o=n(6147);var u=(0,n(8640).op)({cast_:function(e,t){var n=(0,i._1)(e,"x","cast");if(!o.LP(t))throw new Error("Failed to cast to unknown dtype ".concat(t));if("string"===t&&"string"!==n.dtype||"string"!==t&&"string"===n.dtype)throw new Error("Only strings can be casted to strings");var u={x:n},s={dtype:t};return r.BV.runKernel(a.RFZ,u,s)}})},1396:function(e,t,n){"use strict";n.d(t,{m:function(){return o}});var r=n(318),a=n(2145),i=n(8354);var o=(0,n(8640).op)({ceil_:function(e){var t={x:(0,i._1)(e,"x","ceil","float32")};return r.BV.runKernel(a.gJX,t)}})},9836:function(e,t,n){"use strict";n.d(t,{i:function(){return s}});var r=n(318),a=n(2145),i=n(8354),o=n(6147),u=n(8582);var s=(0,n(8640).op)({clipByValue_:function(e,t,n){var s=(0,i._1)(e,"x","clipByValue");if(o.hu(t<=n,(function(){return"Error in clip: min (".concat(t,") must be ")+"less than or equal to max (".concat(n,").")})),t===n)return(0,u.h)(s.shape,t,s.dtype);var c={x:s},l={clipValueMin:t,clipValueMax:n};return r.BV.runKernel(a.xnO,c,l)}})},672:function(e,t,n){"use strict";n.d(t,{d:function(){return o}});var r=n(318),a=n(2145),i=n(8354);var o=(0,n(8640).op)({clone_:function(e){var t={x:(0,i._1)(e,"x","clone","string_or_numeric")};return r.BV.runKernel(a.iJz,t)}})},9253:function(e,t,n){"use strict";n.d(t,{P:function(){return u}});var r=n(318),a=n(2145),i=n(8354),o=n(6147);var u=(0,n(8640).op)({complex_:function(e,t){var n=(0,i._1)(e,"real","complex"),u=(0,i._1)(t,"imag","complex");o.k5(n.shape,u.shape,"real and imag shapes, ".concat(n.shape," and ").concat(u.shape,", ")+"must match in call to tf.complex().");var s={real:n,imag:u};return r.BV.runKernel(a.Zz9,s)}})},4836:function(e,t,n){"use strict";n.d(t,{z:function(){return s}});var r=n(318),a=n(2145),i=n(8354),o=n(6147),u=n(672);var s=(0,n(8640).op)({concat_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;(0,o.hu)(e.length>=1,(function(){return"Pass at least one tensor to concat"}));var n=(0,i.sI)(e,"tensors","concat","string_or_numeric");if("complex64"===n[0].dtype&&n.forEach((function(e){if("complex64"!==e.dtype)throw new Error("Cannot concatenate complex64 tensors with a tensor\n          with dtype ".concat(e.dtype,". "))})),1===n.length)return(0,u.d)(n[0]);var s=n,c={axis:t};return r.BV.runKernel(a.Eh3,s,c)}})},4918:function(e,t,n){"use strict";n.d(t,{P:function(){return c}});var r=n(8354),a=n(6147),i=n(3457),o=n(9151),u=n(8640),s=n(5561);var c=(0,u.op)({conv1d_:function(e,t,n,u){var c=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NWC",l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,f=arguments.length>6?arguments[6]:void 0,d=(0,r._1)(e,"x","conv1d"),h=(0,r._1)(t,"filter","conv1d"),p=d,v=!1;2===d.rank&&(v=!0,p=(0,s.X)(d,[1,d.shape[0],d.shape[1]])),a.hu(3===p.rank,(function(){return"Error in conv1d: input must be rank 3, but got rank ".concat(p.rank,".")})),a.hu(3===h.rank,(function(){return"Error in conv1d: filter must be rank 3, but got rank "+"".concat(h.rank,".")})),o.m("conv1d",u,f),a.hu(p.shape[2]===h.shape[1],(function(){return"Error in conv1d: depth of input (".concat(p.shape[2],") must match ")+"input depth for filter ".concat(h.shape[1],".")})),a.hu(o.jT(n,l),(function(){return"Error in conv1D: Either stride or dilation must be 1. "+"Got stride ".concat(n," and dilation '").concat(l,"'")})),a.hu(o.U3(l),(function(){return"Error in conv1D: Dilated rates should be larger than 0."})),a.hu(o.U3(n),(function(){return"Error in conv1D: Stride should be larger than 0."})),a.hu("NWC"===c,(function(){return"Error in conv1d: got dataFormat of ".concat(c," but only NWC is currently supported.")}));var m=(0,s.X)(h,[1,h.shape[0],h.shape[1],h.shape[2]]),g=(0,s.X)(p,[p.shape[0],1,p.shape[1],p.shape[2]]),y=[1,n],b=[1,l],x="NHWC",w=(0,i.T)(g,m,y,u,x,b,f);return v?(0,s.X)(w,[w.shape[2],w.shape[3]]):(0,s.X)(w,[w.shape[0],w.shape[2],w.shape[3]])}})},3457:function(e,t,n){"use strict";n.d(t,{T:function(){return l}});var r=n(318),a=n(2145),i=n(8354),o=n(6147),u=n(9151),s=n(8640),c=n(5561);var l=(0,s.op)({conv2d_:function(e,t,n,s){var l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NHWC",f=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1],d=arguments.length>6?arguments[6]:void 0,h=(0,i._1)(e,"x","conv2d","float32"),p=(0,i._1)(t,"filter","conv2d","float32"),v=h,m=!1;3===h.rank&&(m=!0,v=(0,c.X)(h,[1,h.shape[0],h.shape[1],h.shape[2]])),o.hu(4===v.rank,(function(){return"Error in conv2d: input must be rank 4, but got rank ".concat(v.rank,".")})),o.hu(4===p.rank,(function(){return"Error in conv2d: filter must be rank 4, but got rank "+"".concat(p.rank,".")})),u.m("conv2d",s,d);var g="NHWC"===l?v.shape[3]:v.shape[1];o.hu(g===p.shape[2],(function(){return"Error in conv2d: depth of input (".concat(g,") must match ")+"input depth for filter ".concat(p.shape[2],".")})),o.hu(u.jT(n,f),(function(){return"Error in conv2D: Either strides or dilations must be 1. "+"Got strides ".concat(n," and dilations '").concat(f,"'")})),o.hu(u.U3(f),(function(){return"Error in conv2D: Dilated rates should be larger than 0."})),o.hu(u.U3(n),(function(){return"Error in conv2D: Strides should be larger than 0."}));var y={x:v,filter:p},b={strides:n,pad:s,dataFormat:l,dilations:f,dimRoundingMode:d},x=r.BV.runKernel(a.mhS,y,b);return m?(0,c.X)(x,[x.shape[1],x.shape[2],x.shape[3]]):x}})},8744:function(e,t,n){"use strict";n.d(t,{p:function(){return c}});var r=n(318),a=n(2145),i=n(6147),o=n(9151),u=n(8640),s=n(5561);var c=(0,u.op)({conv2DBackpropFilter_:function(e,t,n,u,c){var l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NHWC",f=arguments.length>6?arguments[6]:void 0,d=e;3===e.rank&&(d=(0,s.X)(e,[1,e.shape[0],e.shape[1],e.shape[2]]));var h=t;3===h.rank&&(h=(0,s.X)(t,[1,t.shape[0],t.shape[1],t.shape[2]])),i.hu(4===d.rank,(function(){return"Error in conv2dDerFilter: input must be rank 4, but got shape "+"".concat(d.shape,".")})),i.hu(4===h.rank,(function(){return"Error in conv2dDerFilter: dy must be rank 4, but got shape "+"".concat(h.shape,".")})),i.hu(4===n.length,(function(){return"Error in conv2dDerFilter: filterShape must be length 4, but got "+"".concat(n,".")}));var p="NHWC"===l?d.shape[3]:d.shape[1],v="NHWC"===l?h.shape[3]:h.shape[1];i.hu(p===n[2],(function(){return"Error in conv2dDerFilter: depth of input ".concat(p,") must ")+"match input depth in filter (".concat(n[2],".")})),i.hu(v===n[3],(function(){return"Error in conv2dDerFilter: depth of dy (".concat(v,") must ")+"match output depth for filter (".concat(n[3],").")})),o.m("conv2dDerFilter",c,f);var m={x:d,dy:h},g={strides:u,pad:c,dataFormat:l,dimRoundingMode:f,filterShape:n};return r.BV.runKernel(a.wUP,m,g)}})},1045:function(e,t,n){"use strict";n.d(t,{_:function(){return c}});var r=n(318),a=n(2145),i=n(6147),o=n(9151),u=n(8640),s=n(5561);var c=(0,u.op)({conv2DBackpropInput_:function(e,t,n,u,c){var l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NHWC",f=arguments.length>6?arguments[6]:void 0;i.hu(e.length===t.rank,(function(){return"Length of inShape "+"(".concat(e.length,") and rank of dy (").concat(t.rank,") must match")}));var d=e,h=t,p=!1;3===t.rank&&(p=!0,h=(0,s.X)(t,[1,t.shape[0],t.shape[1],t.shape[2]]),d=[1,e[0],e[1],e[2]]),i.hu(4===d.length,(function(){return"Error in conv2dDerInput: inShape must be length 4, but got length "+"".concat(d.length,".")})),i.hu(4===h.rank,(function(){return"Error in conv2dDerInput: dy must be rank 4, but got "+"rank ".concat(h.rank)})),i.hu(4===n.rank,(function(){return"Error in conv2dDerInput: filter must be rank 4, but got "+"rank ".concat(n.rank)}));var v="NHWC"===l?d[3]:d[1],m="NHWC"===l?h.shape[3]:h.shape[1];i.hu(v===n.shape[2],(function(){return"Error in conv2dDerInput: depth of input (".concat(v,") must ")+"match input depth for filter ".concat(n.shape[2],".")})),i.hu(m===n.shape[3],(function(){return"Error in conv2dDerInput: depth of output (".concat(m,") must ")+"match output depth for filter ".concat(n.shape[3],".")})),o.m("conv2dDerInput",c,f);var g={dy:h,filter:n},y={strides:u,pad:c,dataFormat:l,dimRoundingMode:f,inputShape:d},b=r.BV.runKernel(a.wm,g,y);return p?(0,s.X)(b,[b.shape[1],b.shape[2],b.shape[3]]):b}})},1732:function(e,t,n){"use strict";n.d(t,{b:function(){return i}});var r=n(8354),a=n(1045);var i=(0,n(8640).op)({conv2dTranspose_:function(e,t,n,i,o,u){var s=(0,r._1)(e,"x","conv2dTranspose"),c=(0,r._1)(t,"filter","conv2dTranspose");return(0,a._)(n,s,c,i,o,"NHWC",u)}})},1873:function(e,t,n){"use strict";n.d(t,{_:function(){return s}});var r=n(318),a=n(2145),i=n(6147),o=n(8640),u=n(5561);var s=(0,o.op)({conv3DBackpropInput_:function(e,t,n,o,s){i.hu(e.length===t.rank,(function(){return"Length of inShape "+"(".concat(e.length,") and rank of dy (").concat(t.rank,") must match")}));var c=e,l=t,f=!1;4===t.rank&&(f=!0,l=(0,u.X)(t,[1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]]),c=[1,e[0],e[1],e[2],e[3]]);var d=c[4],h=l.shape[4];i.hu(5===c.length,(function(){return"Error in conv3dDerInput: inShape must be length 5, but got length "+"".concat(c.length,".")})),i.hu(5===l.rank,(function(){return"Error in conv3dDerInput: dy must be rank 5, but got "+"rank ".concat(l.rank)})),i.hu(5===n.rank,(function(){return"Error in conv3dDerInput: filter must be rank 5, but got "+"rank ".concat(n.rank)})),i.hu(d===n.shape[3],(function(){return"Error in conv3dDerInput: depth of input (".concat(d,") must ")+"match input depth for filter ".concat(n.shape[3],".")})),i.hu(h===n.shape[4],(function(){return"Error in conv3dDerInput: depth of output (".concat(h,") must ")+"match output depth for filter ".concat(n.shape[4],".")}));var p={dy:l,filter:n},v={pad:s,strides:o,inputShape:c},m=r.BV.runKernel(a.ik2,p,v);return f?(0,u.X)(m,[m.shape[1],m.shape[2],m.shape[3],m.shape[4]]):m}})},9151:function(e,t,n){"use strict";n.d(t,{I0:function(){return y},Ix:function(){return c},Rf:function(){return o},U3:function(){return x},Xw:function(){return u},aO:function(){return f},jT:function(){return b},jw:function(){return l},m:function(){return k},pl:function(){return s},sl:function(){return w}});var r=n(9439),a=n(3433),i=n(6147);function o(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NHWC",o=arguments.length>5?arguments[5]:void 0,u=e[3],s=[].concat((0,a.Z)(t),[u]),l=w(i);return c(e,s,n,o,r,null,null,l)}function u(e,t,n,a,i,o){var u,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"channelsLast",l=d(t),f=(0,r.Z)(l,2),h=f[0],p=f[1];if("channelsLast"===s)u=[h,p,e[3],e[3]];else{if("channelsFirst"!==s)throw new Error("Unknown dataFormat ".concat(s));u=[h,p,e[1],e[1]]}return c(e,u,n,a,i,o,!1,s)}function s(e,t,n,a,i,o){var u,s,c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"NDHWC",f=h(t),d=(0,r.Z)(f,3),p=d[0],v=d[1],m=d[2];if("NDHWC"===c)s="channelsLast",u=[p,v,m,e[4],e[4]];else{if("NCDHW"!==c)throw new Error("Unknown dataFormat ".concat(c));s="channelsFirst",u=[p,v,m,e[1],e[1]]}return l(e,u,n,a,i,!1,s,o)}function c(e,t,n,a,i,o){var u=arguments.length>6&&void 0!==arguments[6]&&arguments[6],s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:"channelsLast",c=-1,l=-1,f=-1,h=-1;if("channelsLast"===s){var m=(0,r.Z)(e,4);c=m[0],l=m[1],f=m[2],h=m[3]}else{if("channelsFirst"!==s)throw new Error("Unknown dataFormat ".concat(s));var g=(0,r.Z)(e,4);c=g[0],h=g[1],l=g[2],f=g[3]}var y,b=(0,r.Z)(t,4),x=b[0],w=b[1],k=b[3],_=d(n),S=(0,r.Z)(_,2),C=S[0],A=S[1],E=d(a),N=(0,r.Z)(E,2),T=N[0],I=N[1],D=p(x,T),F=p(w,I),M=v(i,l,f,C,A,D,F,o,s),O=M.padInfo,R=M.outHeight,j=M.outWidth,B=u?k*h:k;return"channelsFirst"===s?y=[c,B,R,j]:"channelsLast"===s&&(y=[c,R,j,B]),{batchSize:c,dataFormat:s,inHeight:l,inWidth:f,inChannels:h,outHeight:R,outWidth:j,outChannels:B,padInfo:O,strideHeight:C,strideWidth:A,filterHeight:x,filterWidth:w,effectiveFilterHeight:D,effectiveFilterWidth:F,dilationHeight:T,dilationWidth:I,inShape:e,outShape:y,filterShape:t}}function l(e,t,n,a,i){var o=arguments.length>5&&void 0!==arguments[5]&&arguments[5],u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"channelsLast",s=arguments.length>7?arguments[7]:void 0,c=-1,l=-1,f=-1,d=-1,v=-1;if("channelsLast"===u){var g=(0,r.Z)(e,5);c=g[0],l=g[1],f=g[2],d=g[3],v=g[4]}else{if("channelsFirst"!==u)throw new Error("Unknown dataFormat ".concat(u));var y=(0,r.Z)(e,5);c=y[0],v=y[1],l=y[2],f=y[3],d=y[4]}var b,x=(0,r.Z)(t,5),w=x[0],k=x[1],_=x[2],S=x[4],C=h(n),A=(0,r.Z)(C,3),E=A[0],N=A[1],T=A[2],I=h(a),D=(0,r.Z)(I,3),F=D[0],M=D[1],O=D[2],R=p(w,F),j=p(k,M),B=p(_,O),z=m(i,l,f,d,E,N,T,R,j,B,s),Z=z.padInfo,L=z.outDepth,P=z.outHeight,U=z.outWidth,W=o?S*v:S;return"channelsFirst"===u?b=[c,W,L,P,U]:"channelsLast"===u&&(b=[c,L,P,U,W]),{batchSize:c,dataFormat:u,inDepth:l,inHeight:f,inWidth:d,inChannels:v,outDepth:L,outHeight:P,outWidth:U,outChannels:W,padInfo:Z,strideDepth:E,strideHeight:N,strideWidth:T,filterDepth:w,filterHeight:k,filterWidth:_,effectiveFilterDepth:R,effectiveFilterHeight:j,effectiveFilterWidth:B,dilationDepth:F,dilationHeight:M,dilationWidth:O,inShape:e,outShape:b,filterShape:t}}function f(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,a=p(t,r);return Math.floor((e[0]*(n-1)-n+a)/2)}function d(e){return"number"===typeof e?[e,e,e]:2===e.length?[e[0],e[1],1]:e}function h(e){return"number"===typeof e?[e,e,e]:e}function p(e,t){return t<=1?e:e+(e-1)*(t-1)}function v(e,t,n,r,a,i,o,u,s){var c,l,d;if("number"===typeof e){c={top:e,bottom:e,left:e,right:e,type:0===e?"VALID":"NUMBER"};var h=function(e,t,n,r,a){null==r&&(r=f(e,t,n));var i=e[0],o=e[1];return[g((i-t+2*r)/n+1,a),g((o-t+2*r)/n+1,a)]}([t,n],i,r,e,u);l=h[0],d=h[1]}else if("same"===e){l=Math.ceil(t/r),d=Math.ceil(n/a);var p=Math.max(0,(l-1)*r+i-t),v=Math.max(0,(d-1)*a+o-n),m=Math.floor(p/2),y=p-m,b=Math.floor(v/2);c={top:m,bottom:y,left:b,right:v-b,type:"SAME"}}else if("valid"===e)c={top:0,bottom:0,left:0,right:0,type:"VALID"},l=Math.ceil((t-i+1)/r),d=Math.ceil((n-o+1)/a);else{if("object"!==typeof e)throw Error("Unknown padding parameter: ".concat(e));var x="channelsLast"===s?e[1][0]:e[2][0],w="channelsLast"===s?e[1][1]:e[2][1],k="channelsLast"===s?e[2][0]:e[3][0],_="channelsLast"===s?e[2][1]:e[3][1];c={top:x,bottom:w,left:k,right:_,type:0===x&&0===w&&0===k&&0===_?"VALID":"EXPLICIT"},l=g((t-i+x+w)/r+1,u),d=g((n-o+k+_)/a+1,u)}return{padInfo:c,outHeight:l,outWidth:d}}function m(e,t,n,r,a,i,o,u,s,c,l){var d,h,p,v;if("valid"===e&&(e=0),"number"===typeof e){d={top:e,bottom:e,left:e,right:e,front:e,back:e,type:0===e?"VALID":"NUMBER"};var m=function(e,t,n,r,a,i){null==a&&(a=f(e,t[0],r[0]));for(var o=[0,0,0,n],u=0;u<3;u++)e[u]+2*a>=t[u]&&(o[u]=g((e[u]-t[u]+2*a)/r[u]+1,i));return o}([t,n,r,1],[u,s,c],1,[a,i,o],e,l);h=m[0],p=m[1],v=m[2]}else{if("same"!==e)throw Error("Unknown padding parameter: ".concat(e));var y=((h=Math.ceil(t/a))-1)*a+u-t,b=((p=Math.ceil(n/i))-1)*i+s-n,x=((v=Math.ceil(r/o))-1)*o+c-r,w=Math.floor(y/2),k=y-w,_=Math.floor(b/2),S=b-_,C=Math.floor(x/2);d={top:_,bottom:S,left:C,right:x-C,front:w,back:k,type:"SAME"}}return{padInfo:d,outDepth:h,outHeight:p,outWidth:v}}function g(e,t){if(!t)return Math.trunc(e);switch(t){case"round":return Math.round(e);case"ceil":return Math.ceil(e);case"floor":return Math.floor(e);default:throw new Error("Unknown roundingMode ".concat(t))}}function y(e){var t=d(e),n=(0,r.Z)(t,3),a=n[0],i=n[1],o=n[2];return 1===a&&1===i&&1===o}function b(e,t){return y(e)||y(t)}function x(e){return d(e).every((function(e){return e>0}))}function w(e){if("NHWC"===e)return"channelsLast";if("NCHW"===e)return"channelsFirst";throw new Error("Unknown dataFormat ".concat(e))}function k(e,t,n){if(null!=n){if("string"===typeof t)throw Error("Error in ".concat(e,": pad must be an integer when using ")+"dimRoundingMode ".concat(n," but got pad ").concat(t,"."));if("number"===typeof t)i.hu(i.GN(t),(function(){return"Error in ".concat(e,": pad must be an integer when using ")+"dimRoundingMode ".concat(n," but got pad ").concat(t,".")}));else{if("object"!==typeof t)throw Error("Error in ".concat(e,": Unknown padding parameter: ").concat(t));t.forEach((function(t){t.forEach((function(t){i.hu(i.GN(t),(function(){return"Error in ".concat(e,": pad must be an integer when using ")+"dimRoundingMode ".concat(n," but got pad ").concat(t,".")}))}))}))}}}},1227:function(e,t,n){"use strict";n.d(t,{m:function(){return o}});var r=n(318),a=n(2145),i=n(8354);var o=(0,n(8640).op)({cos_:function(e){var t={x:(0,i._1)(e,"x","cos","float32")};return r.BV.runKernel(a.mc4,t)}})},6679:function(e,t,n){"use strict";n.d(t,{f:function(){return o}});var r=n(318),a=n(2145),i=n(8354);var o=(0,n(8640).op)({cosh_:function(e){var t={x:(0,i._1)(e,"x","cosh","float32")};return r.BV.runKernel(a.TR1,t)}})},9457:function(e,t,n){"use strict";n.d(t,{$:function(){return o}});var r=n(318),a=n(2145),i=n(8354);var o=(0,n(8640).op)({cumprod_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],u=(0,i._1)(e,"x","cumprod"),s={x:u},c={axis:t,exclusive:n,reverse:o};return r.BV.runKernel(a.Byc,s,c)}})},8862:function(e,t,n){"use strict";n.d(t,{z:function(){return o}});var r=n(318),a=n(2145),i=n(8354);var o=(0,n(8640).op)({cumsum_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],u=(0,i._1)(e,"x","cumsum"),s={x:u},c={axis:t,exclusive:n,reverse:o};return r.BV.runKernel(a.iHb,s,c)}})},1878:function(e,t,n){"use strict";n.d(t,{n:function(){return u}});var r=n(318),a=n(2145),i=n(8354),o=n(6147);var u=(0,n(8640).op)({depthToSpace_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"NHWC",u=(0,i._1)(e,"x","depthToSpace","float32"),s="NHWC"===n?u.shape[1]:u.shape[2],c="NHWC"===n?u.shape[2]:u.shape[3],l="NHWC"===n?u.shape[3]:u.shape[1];o.hu(t>1,(function(){return"blockSize should be > 1 for depthToSpace, but was: ".concat(t)})),o.hu(s*t>=0,(function(){return"Negative dimension size caused by overflow when multiplying\n    ".concat(s," and ").concat(t,"  for depthToSpace with input shape\n    ").concat(u.shape)})),o.hu(c*t>=0,(function(){return"Negative dimension size caused by overflow when multiplying\n    ".concat(c," and ").concat(t," for depthToSpace with input shape\n        ").concat(u.shape)})),o.hu(l%(t*t)===0,(function(){return"Dimension size must be evenly divisible by ".concat(t*t," but is ").concat(l," for depthToSpace with input shape ").concat(u.shape)}));var f={x:u},d={blockSize:t,dataFormat:n};return r.BV.runKernel(a.T0n,f,d)}})},1147:function(e,t,n){"use strict";n.d(t,{B:function(){return l}});var r=n(318),a=n(2145),i=n(8354),o=n(6147),u=n(9151),s=n(8640),c=n(5561);var l=(0,s.op)({depthwiseConv2d_:function(e,t,n,s){var l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NHWC",f=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1],d=arguments.length>6?arguments[6]:void 0,h=(0,i._1)(e,"x","depthwiseConv2d","float32"),p=(0,i._1)(t,"filter","depthwiseConv2d","float32"),v=h,m=!1;3===h.rank&&(m=!0,v=(0,c.X)(h,[1,h.shape[0],h.shape[1],h.shape[2]])),o.hu(4===v.rank,(function(){return"Error in depthwiseConv2d: input must be rank 4, but got "+"rank ".concat(v.rank,".")})),o.hu(4===p.rank,(function(){return"Error in depthwiseConv2d: filter must be rank 4, but got rank "+"".concat(p.rank,".")}));var g="NHWC"===l?v.shape[3]:v.shape[1];o.hu(g===p.shape[2],(function(){return"Error in depthwiseConv2d: number of input channels "+"(".concat(g,") must match the inChannels dimension in ")+"filter ".concat(p.shape[2],".")})),u.m("depthwiseConv2d",s,d);var y={x:v,filter:p},b={strides:n,pad:s,dataFormat:l,dilations:f,dimRoundingMode:d},x=r.BV.runKernel(a.cie,y,b);return m?(0,c.X)(x,[x.shape[1],x.shape[2],x.shape[3]]):x}})},288:function(e,t,n){"use strict";n.d(t,{z:function(){return u}});var r=n(318),a=n(2145),i=n(8640),o=n(5561);var u=(0,i.op)({depthwiseConv2dNativeBackpropFilter_:function(e,t,n,i,u){var s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1],c=arguments.length>6?arguments[6]:void 0,l=e;3===e.rank&&(l=(0,o.X)(e,[1,e.shape[0],e.shape[1],e.shape[2]]));var f=t;3===f.rank&&(f=(0,o.X)(t,[1,t.shape[0],t.shape[1],t.shape[2]]));var d={x:l,dy:f},h={strides:i,pad:u,dimRoundingMode:c,dilations:s,filterShape:n};return r.BV.runKernel(a.sL$,d,h)}})},6939:function(e,t,n){"use strict";n.d(t,{v:function(){return u}});var r=n(318),a=n(2145),i=n(8640),o=n(5561);var u=(0,i.op)({depthwiseConv2dNativeBackpropInput_:function(e,t,n,i,u){var s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1],c=arguments.length>6?arguments[6]:void 0,l=t,f=!1;3===t.rank&&(f=!0,l=(0,o.X)(t,[1,t.shape[0],t.shape[1],t.shape[2]]));var d={dy:l,filter:n},h={strides:i,pad:u,dimRoundingMode:c,dilations:s,inputShape:e},p=r.BV.runKernel(a.y7R,d,h);return f?(0,o.X)(p,[p.shape[1],p.shape[2],p.shape[3]]):p}})},7580:function(e,t,n){"use strict";n.d(t,{W:function(){return c}});var r=n(318),a=n(2145),i=n(8354),o=n(6147),u=n(8640),s=n(5561);var c=(0,u.op)({dilation2d_:function(e,t,n,u){var c=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[1,1],l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NHWC",f=(0,i._1)(e,"x","dilation2d"),d=(0,i._1)(t,"filter","dilation2d");o.hu(3===f.rank||4===f.rank,(function(){return"Error in dilation2d: input must be rank 3 or 4, but got rank "+"".concat(f.rank,".")})),o.hu(3===d.rank,(function(){return"Error in dilation2d: filter must be rank 3, but got rank "+"".concat(d.rank,".")})),o.hu("NHWC"===l,(function(){return"Error in dilation2d: Only NHWC is currently supported, "+"but got dataFormat of ".concat(l)}));var h=f,p=!1;3===f.rank&&(h=(0,s.X)(f,[1,f.shape[0],f.shape[1],f.shape[2]]),p=!0),o.hu(h.shape[3]===d.shape[2],(function(){return"Error in dilation2d:  input and filter must have the same depth: ".concat(h.shape[3]," vs ").concat(d.shape[2])}));var v={x:h,filter:d},m={strides:n,pad:u,dilations:c},g=r.BV.runKernel(a.p4S,v,m);return p?(0,s.X)(g,[g.shape[1],g.shape[2],g.shape[3]]):g}})},5750:function(e,t,n){"use strict";n.d(t,{h:function(){return c}});var r=n(9439),a=n(318),i=n(2145),o=n(9064),u=n(8354),s=n(7145);var c=(0,n(8640).op)({div_:function(e,t){var n=(0,u._1)(e,"a","div"),c=(0,u._1)(t,"b","div"),l=(0,o.makeTypesMatch)(n,c),f=(0,r.Z)(l,2);if(n=f[0],c=f[1],"int32"===n.dtype&&"int32"===c.dtype)return(0,s.q)(n,c);var d={a:n,b:c};return a.BV.runKernel(i.oHH,d,{})}})},5923:function(e,t,n){"use strict";n.d(t,{N:function(){return f}});var r=n(9439),a=n(9064),i=n(8354),o=n(5750),u=n(3254),s=n(8640),c=n(329),l=n(7293);var f=(0,s.op)({divNoNan_:function(e,t){var n=(0,i._1)(e,"a","div"),s=(0,i._1)(t,"b","div"),f=(0,a.makeTypesMatch)(n,s),d=(0,r.Z)(f,2);n=d[0],s=d[1];var h=(0,o.h)(n,s),p=(0,l.P)(h),v=(0,u.D)(s,p);return(0,c.a)(v,p,h)}})},5043:function(e,t,n){"use strict";n.d(t,{A:function(){return s}});var r=n(8354),a=n(6147),i=n(7221),o=n(8640),u=n(5561);var s=(0,o.op)({dot_:function(e,t){var n=(0,r._1)(e,"t1","dot"),o=(0,r._1)(t,"t2","dot");a.hu((1===n.rank||2===n.rank)&&(1===o.rank||2===o.rank),(function(){return"Error in dot: inputs must all be rank 1 or 2, but got ranks "+"".concat(n.rank," and ").concat(o.rank,".")}));var s=1===n.rank?n.size:n.shape[1],c=1===o.rank?o.size:o.shape[0];if(a.hu(s===c,(function(){return"Error in dot: inner dimensions of inputs must match, but got "+"".concat(s," and ").concat(c,".")})),1===n.rank&&1===o.rank){var l=(0,u.X)(n,[1,-1]),f=(0,u.X)(o,[-1,1]),d=(0,i.O)(l,f);return(0,u.X)(d,[])}if(1===n.rank&&2===o.rank){var h=(0,u.X)(n,[1,-1]),p=(0,u.X)(o,[o.shape[0],o.shape[1]]),v=(0,i.O)(h,p);return(0,u.X)(v,[v.size])}if(2===n.rank&&1===o.rank){var m=(0,u.X)(o,[-1,1]),g=(0,i.O)(n,m);return(0,u.X)(g,[g.size])}var y=(0,u.X)(o,[o.shape[0],o.shape[1]]);return(0,i.O)(n,y)}})},2353:function(e,t,n){"use strict";n.d(t,{p:function(){return o}});var r=n(318),a=n(2145),i=n(8354);var o=(0,n(8640).op)({elu_:function(e){var t={x:(0,i._1)(e,"x","elu","float32")};return r.BV.runKernel(a.SX0,t)}})},3254:function(e,t,n){"use strict";n.d(t,{D:function(){return c}});var r=n(9439),a=n(318),i=n(2145),o=n(9064),u=n(8354),s=n(5774);var c=(0,n(8640).op)({equal_:function(e,t){var n=(0,u._1)(e,"a","equal","string_or_numeric"),c=(0,u._1)(t,"b","equal","string_or_numeric"),l=(0,o.makeTypesMatch)(n,c),f=(0,r.Z)(l,2);n=f[0],c=f[1],(0,s.assertAndGetBroadcastShape)(n.shape,c.shape);var d={a:n,b:c};return a.BV.runKernel(i.hdR,d)}})},3891:function(e,t,n){"use strict";n.d(t,{q:function(){return s}});var r=n(318),a=n(2145),i=n(8354),o=n(6147),u=n(9118);var s=(0,n(8640).op)({erf_:function(e){var t=(0,i._1)(e,"x","erf");o.hu("int32"===t.dtype||"float32"===t.dtype,(function(){return"Input dtype must be `int32` or `float32`."})),"int32"===t.dtype&&(t=(0,u.p)(t,"float32"));var n={x:t};return r.BV.runKernel(a.Omj,n)}})},3313:function(e,t,n){"use strict";n.d(t,{d:function(){return a}});var r=n(6662);var a=(0,n(8640).op)({euclideanNorm_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return(0,r.K)(e,"euclidean",t,n)}})},411:function(e,t,n){"use strict";n.d(t,{Q:function(){return o}});var r=n(318),a=n(2145),i=n(8354);var o=(0,n(8640).op)({exp_:function(e){var t={x:(0,i._1)(e,"x","exp")};return r.BV.runKernel(a.NEP,t)}})},2975:function(e,t,n){"use strict";n.d(t,{d:function(){return u}});var r=n(318),a=n(2145),i=n(8354),o=n(6147);var u=(0,n(8640).op)({expandDims_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(0,i._1)(e,"x","expandDims","string_or_numeric");o.hu(t<=n.rank,(function(){return"Axis must be <= rank of the tensor"}));var u={input:n},s={dim:t};return r.BV.runKernel(a.YFo,u,s)}})},5682:function(e,t,n){"use strict";n.d(t,{t:function(){return o}});var r=n(318),a=n(2145),i=n(8354);var o=(0,n(8640).op)({expm1_:function(e){var t={x:(0,i._1)(e,"x","expm1")};return r.BV.runKernel(a.Y0y,t)}})},8582:function(e,t,n){"use strict";n.d(t,{h:function(){return o}});var r=n(318),a=n(2145),i=n(6147);function o(e,t,n){(0,i.Mu)(e);var o={shape:e,value:t,dtype:n=n||(0,i.D2)(t)};return r.BV.runKernel(a.deh,{},o)}},2628:function(e,t,n){"use strict";n.d(t,{G:function(){return o}});var r=n(318),a=n(2145),i=n(8354);var o=(0,n(8640).op)({floor_:function(e){var t={x:(0,i._1)(e,"x","floor","float32")};return r.BV.runKernel(a.OR,t)}})},7145:function(e,t,n){"use strict";n.d(t,{q:function(){return s}});var r=n(9439),a=n(318),i=n(2145),o=n(9064),u=n(8354);var s=(0,n(8640).op)({floorDiv_:function(e,t){var n=(0,u._1)(e,"a","floorDiv"),s=(0,u._1)(t,"b","floorDiv"),c=(0,o.makeTypesMatch)(n,s),l=(0,r.Z)(c,2),f={a:n=l[0],b:s=l[1]};return a.BV.runKernel(i.jeX,f)}})},5171:function(e,t,n){"use strict";n.d(t,{Fr:function(){return p},QH:function(){return m},pf:function(){return v},uy:function(){return g}});var r=n(5774),a=n(2353),i=n(4419),o=n(651),u=n(6859),s=n(7539),c=n(5900),l=n(5561),f=n(7643),d=n(4031),h=n(227);function p(e,t,n){if(null==n||"linear"===n)return e;if("relu"===n)return(0,o.d)(e,(0,d.N)(t));throw new Error("Cannot compute gradient for fused activation ".concat(n,"."))}function v(e,t){var n=t,a=r.getReductionAxes(e.shape,t.shape);return a.length>0&&(n=(0,h.S)(n,a)),(0,l.X)(n,e.shape)}function m(e,t,n,r){if("linear"===t)return e;if("relu"===t)return(0,s.U)(e);if("elu"===t)return(0,a.p)(e);if("relu6"===t)return(0,c.b)(e);if("prelu"===t)return(0,u.A)(e,n);if("leakyrelu"===t)return(0,i.h)(e,r);if("sigmoid"===t)return(0,f.X)(e);throw new Error("Unknown fused activation ".concat(t,"."))}var g=function(e,t){return!(e>0)||"linear"===t}},9498:function(e,t,n){"use strict";n.d(t,{I:function(){return o}});var r=n(318),a=n(2145),i=n(8354);var o=(0,n(8640).op)({gather_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,u=(0,i._1)(e,"x","gather"),s=(0,i._1)(t,"indices","gather","int32"),c={x:u,indices:s},l={axis:n,batchDims:o};return r.BV.runKernel(a.qi_,c,l)}})},5014:function(e,t,n){"use strict";n.d(t,{p:function(){return c}});var r=n(9439),a=n(318),i=n(2145),o=n(9064),u=n(8354),s=n(5774);var c=(0,n(8640).op)({greater_:function(e,t){var n=(0,u._1)(e,"a","greater","string_or_numeric"),c=(0,u._1)(t,"b","greater","string_or_numeric"),l=(0,o.makeTypesMatch)(n,c),f=(0,r.Z)(l,2);n=f[0],c=f[1],(0,s.assertAndGetBroadcastShape)(n.shape,c.shape);var d={a:n,b:c};return a.BV.runKernel(i.iZT,d)}})},8327:function(e,t,n){"use strict";n.d(t,{b:function(){return c}});var r=n(9439),a=n(318),i=n(2145),o=n(9064),u=n(8354),s=n(5774);var c=(0,n(8640).op)({greaterEqual_:function(e,t){var n=(0,u._1)(e,"a","greaterEqual","string_or_numeric"),c=(0,u._1)(t,"b","greaterEqual","string_or_numeric"),l=(0,o.makeTypesMatch)(n,c),f=(0,r.Z)(l,2);n=f[0],c=f[1],(0,s.assertAndGetBroadcastShape)(n.shape,c.shape);var d={a:n,b:c};return a.BV.runKernel(i.Acj,d)}})},6996:function(e,t,n){"use strict";n.d(t,{a:function(){return o}});var r=n(318),a=n(2145),i=n(8354);var o=(0,n(8640).op)({imag_:function(e){var t={input:(0,i._1)(e,"input","imag")};return r.BV.runKernel(a.J_u,t)}})},464:function(e,t,n){"use strict";n.d(t,{I:function(){return l}});var r=n(4506),a=n(318),i=n(2145),o=n(8354),u=n(6147),s=n(8640),c=n(5561);var l=(0,s.op)({resizeBilinear_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],s=arguments.length>3&&void 0!==arguments[3]&&arguments[3],l=(0,o._1)(e,"images","resizeBilinear");u.hu(3===l.rank||4===l.rank,(function(){return"Error in resizeBilinear: x must be rank 3 or 4, but got "+"rank ".concat(l.rank,".")})),u.hu(2===t.length,(function(){return"Error in resizeBilinear: new shape must 2D, but got shape "+"".concat(t,".")})),u.hu(!1===s||!1===n,(function(){return"Error in resizeBilinear: If halfPixelCenters is true, alignCorners must be false."}));var f=l,d=!1;3===l.rank&&(d=!0,f=(0,c.X)(l,[1,l.shape[0],l.shape[1],l.shape[2]])),(0,r.Z)(t);var h={images:f},p={alignCorners:n,halfPixelCenters:s,size:t},v=a.BV.runKernel(i._Yw,h,p);return d?(0,c.X)(v,[v.shape[1],v.shape[2],v.shape[3]]):v}})},8600:function(e,t,n){"use strict";n.d(t,{j:function(){return l}});var r=n(4506),a=n(318),i=n(2145),o=n(8354),u=n(6147),s=n(8640),c=n(5561);var l=(0,s.op)({resizeNearestNeighbor_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],s=arguments.length>3&&void 0!==arguments[3]&&arguments[3],l=(0,o._1)(e,"images","resizeNearestNeighbor");u.hu(3===l.rank||4===l.rank,(function(){return"Error in resizeNearestNeighbor: x must be rank 3 or 4, but got "+"rank ".concat(l.rank,".")})),u.hu(2===t.length,(function(){return"Error in resizeNearestNeighbor: new shape must 2D, but got shape "+"".concat(t,".")})),u.hu("float32"===l.dtype||"int32"===l.dtype,(function(){return"`images` must have `int32` or `float32` as dtype"})),u.hu(!1===s||!1===n,(function(){return"Error in resizeNearestNeighbor: If halfPixelCenters is true, alignCorners must be false."}));var f=l,d=!1;3===l.rank&&(d=!0,f=(0,c.X)(l,[1,l.shape[0],l.shape[1],l.shape[2]])),(0,r.Z)(t);var h={images:f},p={alignCorners:n,halfPixelCenters:s,size:t},v=a.BV.runKernel(i.dpD,h,p);return d?(0,c.X)(v,[v.shape[1],v.shape[2],v.shape[3]]):v}})},300:function(e,t,n){"use strict";n.d(t,{x:function(){return o}});var r=n(318),a=n(2145),i=n(8354);var o=(0,n(8640).op)({isFinite_:function(e){var t={x:(0,i._1)(e,"x","isFinite")};return r.BV.runKernel(a.avt,t)}})},4652:function(e,t,n){"use strict";n.d(t,{U:function(){return o}});var r=n(318),a=n(2145),i=n(8354);var o=(0,n(8640).op)({isInf_:function(e){var t={x:(0,i._1)(e,"x","isInf")};return r.BV.runKernel(a.iWB,t)}})},7005:function(e,t,n){"use strict";n.d(t,{i:function(){return o}});var r=n(318),a=n(2145),i=n(8354);var o=(0,n(8640).op)({isNaN_:function(e){var t={x:(0,i._1)(e,"x","isNaN")};return r.BV.runKernel(a.r7n,t)}})},4419:function(e,t,n){"use strict";n.d(t,{h:function(){return o}});var r=n(318),a=n(2145),i=n(8354);var o=(0,n(8640).op)({leakyRelu_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.2,n=(0,i._1)(e,"x","leakyRelu"),o={x:n},u={alpha:t};return r.BV.runKernel(a.J$2,o,u)}})},4920:function(e,t,n){"use strict";n.d(t,{d:function(){return c}});var r=n(9439),a=n(318),i=n(2145),o=n(9064),u=n(8354),s=n(5774);var c=(0,n(8640).op)({less_:function(e,t){var n=(0,u._1)(e,"a","less","string_or_numeric"),c=(0,u._1)(t,"b","less","string_or_numeric"),l=(0,o.makeTypesMatch)(n,c),f=(0,r.Z)(l,2);n=f[0],c=f[1],(0,s.assertAndGetBroadcastShape)(n.shape,c.shape);var d={a:n,b:c};return a.BV.runKernel(i.vtC,d)}})},2642:function(e,t,n){"use strict";n.d(t,{z:function(){return c}});var r=n(9439),a=n(318),i=n(2145),o=n(9064),u=n(8354),s=n(5774);var c=(0,n(8640).op)({lessEqual_:function(e,t){var n=(0,u._1)(e,"a","lessEqual","string_or_numeric"),c=(0,u._1)(t,"b","lessEqual","string_or_numeric"),l=(0,o.makeTypesMatch)(n,c),f=(0,r.Z)(l,2);n=f[0],c=f[1],(0,s.assertAndGetBroadcastShape)(n.shape,c.shape);var d={a:n,b:c};return a.BV.runKernel(i.CAk,d)}})},936:function(e,t,n){"use strict";n.d(t,{G:function(){return c}});var r=n(318),a=n(2145),i=n(8354),o=n(6147),u=n(8640),s=n(5561);var c=(0,u.op)({localResponseNormalization_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,u=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,c=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.5,l=(0,i._1)(e,"x","localResponseNormalization");o.hu(4===l.rank||3===l.rank,(function(){return"Error in localResponseNormalization: x must be rank 3 or 4 but got\n               rank ".concat(l.rank,".")})),o.hu(o.GN(t),(function(){return"Error in localResponseNormalization: depthRadius must be an "+"integer but got depthRadius ".concat(t,".")}));var f=l,d=!1;3===l.rank&&(d=!0,f=(0,s.X)(l,[1,l.shape[0],l.shape[1],l.shape[2]]));var h={x:f},p={depthRadius:t,bias:n,alpha:u,beta:c},v=r.BV.runKernel(a.eZ0,h,p);return d?(0,s.X)(v,[v.shape[1],v.shape[2],v.shape[3]]):v}})},378:function(e,t,n){"use strict";n.d(t,{c:function(){return o}});var r=n(318),a=n(2145),i=n(8354);var o=(0,n(8640).op)({log_:function(e){var t={x:(0,i._1)(e,"x","log","float32")};return r.BV.runKernel(a.ZbH,t)}})},5341:function(e,t,n){"use strict";n.d(t,{K:function(){return o}});var r=n(318),a=n(2145),i=n(8354);var o=(0,n(8640).op)({log1p_:function(e){var t={x:(0,i._1)(e,"x","log1p")};return r.BV.runKernel(a.kU,t)}})},5113:function(e,t,n){"use strict";n.d(t,{e:function(){return l}});var r=n(6450),a=n(8354),i=n(651),o=n(4362),u=n(8640),s=n(7643),c=n(4626);var l=(0,u.op)({logSigmoid_:function(e){var t=(0,a._1)(e,"x","logSigmoid"),n=(0,r.cb)((function(e){return{value:(0,o.W)((0,c.W)((0,o.W)(e))),gradFunc:function(t){return(0,i.d)(t,(0,s.X)((0,o.W)(e)))}}}));return n(t)}})},4561:function(e,t,n){"use strict";n.d(t,{C:function(){return p}});var r=n(9439),a=n(6450),i=n(8354),o=n(9118),u=n(411),s=n(378),c=n(6176),l=n(651),f=n(8640),d=n(4774),h=n(227);var p=(0,f.op)({logSoftmax_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,n=(0,i._1)(e,"logits","logSoftmax");if(-1===t&&(t=n.rank-1),t!==n.rank-1)throw Error("Log Softmax along a non-last dimension is not yet supported. "+"Logits was rank ".concat(n.rank," and axis was ").concat(t));var f=(0,a.cb)((function(e,n){var a=(0,c.F)(e,t,!0),i=(0,d.l)(e,a),f=(0,d.l)((0,o.p)(i,"float32"),(0,s.c)((0,h.S)((0,u.Q)(i),t,!0)));n([f]);return{value:f,gradFunc:function(e,n){var a=(0,r.Z)(n,1)[0],i=(0,u.Q)(a);return(0,d.l)(e,(0,l.d)((0,h.S)(e,t,!0),i))}}}));return f(n)}})},5530:function(e,t,n){"use strict";n.d(t,{l:function(){return p}});var r=n(8354),a=n(6147),i=n(3312),o=n(8473),u=n(411),s=n(378),c=n(6176),l=n(8640),f=n(5561),d=n(4774),h=n(227);var p=(0,l.op)({logSumExp_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],l=(0,r._1)(e,"x","logSumExp"),p=(0,a.EC)(t,l.shape),v=(0,c.F)(l,p,!0),m=(0,d.l)(l,v),g=(0,u.Q)(m),y=(0,h.S)(g,p),b=(0,s.c)(y),x=(0,i.I)((0,f.X)(v,b.shape),b);if(n){var w=(0,o.rv)(x.shape,p);return(0,f.X)(x,w)}return x}})},2177:function(e,t,n){"use strict";n.d(t,{H:function(){return u}});var r=n(318),a=n(2145),i=n(8354),o=n(5774);var u=(0,n(8640).op)({logicalAnd_:function(e,t){var n=(0,i._1)(e,"a","logicalAnd","bool"),u=(0,i._1)(t,"b","logicalAnd","bool");(0,o.assertAndGetBroadcastShape)(n.shape,u.shape);var s={a:n,b:u};return r.BV.runKernel(a.PYm,s)}})},875:function(e,t,n){"use strict";n.d(t,{h:function(){return o}});var r=n(318),a=n(2145),i=n(8354);var o=(0,n(8640).op)({logicalNot_:function(e){var t={x:(0,i._1)(e,"x","logicalNot","bool")};return r.BV.runKernel(a.VfG,t)}})},5117:function(e,t,n){"use strict";n.d(t,{K:function(){return u}});var r=n(318),a=n(2145),i=n(8354),o=n(5774);var u=(0,n(8640).op)({logicalOr_:function(e,t){var n=(0,i._1)(e,"a","logicalOr","bool"),u=(0,i._1)(t,"b","logicalOr","bool");(0,o.assertAndGetBroadcastShape)(n.shape,u.shape);var s={a:n,b:u};return r.BV.runKernel(a.MZg,s)}})},1712:function(e,t,n){"use strict";n.d(t,{e:function(){return s}});var r=n(8354),a=n(5774),i=n(2177),o=n(875),u=n(5117);var s=(0,n(8640).op)({logicalXor_:function(e,t){var n=(0,r._1)(e,"a","logicalXor","bool"),s=(0,r._1)(t,"b","logicalXor","bool");return(0,a.assertAndGetBroadcastShape)(n.shape,s.shape),(0,i.H)((0,u.K)(e,t),(0,o.h)((0,i.H)(e,t)))}})},7627:function(e,t,n){"use strict";var r;n.d(t,{I:function(){return r}}),function(e){e[e.NONE=0]="NONE",e[e.MEAN=1]="MEAN",e[e.SUM=2]="SUM",e[e.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"}(r||(r={}))},7221:function(e,t,n){"use strict";n.d(t,{O:function(){return s}});var r=n(9439),a=n(318),i=n(2145),o=n(9064),u=n(8354);var s=(0,n(8640).op)({matMul_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],s=arguments.length>3&&void 0!==arguments[3]&&arguments[3],c=(0,u._1)(e,"a","matMul"),l=(0,u._1)(t,"b","matMul"),f=(0,o.makeTypesMatch)(c,l),d=(0,r.Z)(f,2),h={a:c=d[0],b:l=d[1]},p={transposeA:n,transposeB:s};return a.BV.runKernel(i.XLW,h,p)}})},6176:function(e,t,n){"use strict";n.d(t,{F:function(){return o}});var r=n(318),a=n(2145),i=n(8354);var o=(0,n(8640).op)({max_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=(0,i._1)(e,"x","max"),u={x:o},s={reductionIndices:t,keepDims:n};return r.BV.runKernel(a.YoZ,u,s)}})},5777:function(e,t,n){"use strict";n.d(t,{_:function(){return l}});var r=n(318),a=n(2145),i=n(8354),o=n(6147),u=n(9151),s=n(8640),c=n(5561);var l=(0,s.op)({maxPool_:function(e,t,n,s,l){var f=(0,i._1)(e,"x","maxPool"),d=f,h=!1;3===f.rank&&(h=!0,d=(0,c.X)(f,[1,f.shape[0],f.shape[1],f.shape[2]])),o.hu(4===d.rank,(function(){return"Error in maxPool: input must be rank 4 but got rank ".concat(d.rank,".")})),o.hu(u.jT(n,1),(function(){return"Error in maxPool: Either strides or dilations must be 1. "+"Got strides ".concat(n," and dilations '").concat(1,"'")})),u.m("maxPool",s,l);var p={x:d},v={filterSize:t,strides:n,pad:s,dimRoundingMode:l},m=r.BV.runKernel(a.mTV,p,v);return h?(0,c.X)(m,[m.shape[1],m.shape[2],m.shape[3]]):m}})},705:function(e,t,n){"use strict";n.d(t,{g:function(){return l}});var r=n(9439),a=n(318),i=n(2145),o=n(9064),u=n(8354),s=n(5774),c=n(9118);var l=(0,n(8640).op)({maximum_:function(e,t){var n=(0,u._1)(e,"a","maximum"),l=(0,u._1)(t,"b","maximum"),f=(0,o.makeTypesMatch)(n,l),d=(0,r.Z)(f,2);n=d[0],l=d[1],"bool"===n.dtype&&(n=(0,c.p)(n,"int32"),l=(0,c.p)(l,"int32")),(0,s.assertAndGetBroadcastShape)(n.shape,l.shape);var h={a:n,b:l};return a.BV.runKernel(i.BMI,h)}})},6568:function(e,t,n){"use strict";n.d(t,{J:function(){return o}});var r=n(318),a=n(2145),i=n(8354);var o=(0,n(8640).op)({mean_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=(0,i._1)(e,"x","mean"),u={x:o},s={axis:t,keepDims:n};return r.BV.runKernel(a.q2K,u,s)}})},7891:function(e,t,n){"use strict";n.d(t,{V:function(){return o}});var r=n(318),a=n(2145),i=n(8354);var o=(0,n(8640).op)({min_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=(0,i._1)(e,"x","min"),u={x:o},s={axis:t,keepDims:n};return r.BV.runKernel(a.c17,u,s)}})},2273:function(e,t,n){"use strict";n.d(t,{L:function(){return l}});var r=n(9439),a=n(318),i=n(2145),o=n(9064),u=n(8354),s=n(5774),c=n(9118);var l=(0,n(8640).op)({minimum_:function(e,t){var n=(0,u._1)(e,"a","minimum"),l=(0,u._1)(t,"b","minimum"),f=(0,o.makeTypesMatch)(n,l),d=(0,r.Z)(f,2);n=d[0],l=d[1],"bool"===n.dtype&&(n=(0,c.p)(n,"int32"),l=(0,c.p)(l,"int32")),(0,s.assertAndGetBroadcastShape)(n.shape,l.shape);var h={a:n,b:l};return a.BV.runKernel(i.q8u,h)}})},9719:function(e,t,n){"use strict";n.d(t,{V:function(){return u}});var r=n(318),a=n(2145),i=n(8354),o=n(6147);var u=(0,n(8640).op)({mirrorPad_:function(e,t,n){o.hu("reflect"===n||"symmetric"===n,(function(){return"Invalid mode. Mode must be either reflect or symmetric. "+"Got ".concat(n,".")}));var u=(0,i._1)(e,"x","mirrorPad");if(0===u.rank)throw new Error("mirrorPad(scalar) is not defined. Pass non-scalar to mirrorPad");o.hu(t.length===u.rank,(function(){return"Padding doesn't match input. Must be ".concat(u.rank,". ")+"Got ".concat(t.length,".")}));for(var s="reflect"===n?1:0,c=function(e){o.hu(2===t[e].length,(function(){return"Invalid number of paddings. Must be length of 2 each."})),o.hu(t[e][0]>=0&&t[e][0]<=u.shape[e]-s&&t[e][1]>=0&&t[e][1]<=u.shape[e]-s,(function(){return"Padding in dimension ".concat(e," cannot be greater than or equal ")+"to ".concat(u.shape[e]-s," or less than 0 for input of ")+"shape ".concat(u.shape)}))},l=0;l<u.rank;l++)c(l);var f={paddings:t,mode:n},d={x:u};return r.BV.runKernel(a.jQs,d,f)}})},4645:function(e,t,n){"use strict";n.d(t,{w:function(){return s}});var r=n(9439),a=n(318),i=n(2145),o=n(9064),u=n(8354);var s=(0,n(8640).op)({mod_:function(e,t){var n=(0,u._1)(e,"a","mod"),s=(0,u._1)(t,"b","mod"),c=(0,o.makeTypesMatch)(n,s),l=(0,r.Z)(c,2),f={a:n=l[0],b:s=l[1]};return a.BV.runKernel(i.Vbg,f)}})},651:function(e,t,n){"use strict";n.d(t,{d:function(){return s}});var r=n(9439),a=n(318),i=n(2145),o=n(9064),u=n(8354);var s=(0,n(8640).op)({mul_:function(e,t){var n=(0,u._1)(e,"a","mul"),s=(0,u._1)(t,"b","mul"),c=(0,o.makeTypesMatch)(n,s),l=(0,r.Z)(c,2),f={a:n=l[0],b:s=l[1]};return a.BV.runKernel(i.wYn,f)}})},4362:function(e,t,n){"use strict";n.d(t,{W:function(){return o}});var r=n(318),a=n(2145),i=n(8354);var o=(0,n(8640).op)({neg_:function(e){var t={x:(0,i._1)(e,"x","neg")};return r.BV.runKernel(a.kuV,t)}})},6662:function(e,t,n){"use strict";n.d(t,{K:function(){return g}});var r=n(8354),a=n(6147),i=n(7613),o=n(8473),u=n(6176),s=n(7891),c=n(8640),l=n(4334),f=n(5561),d=n(7067),h=n(6902),p=n(7391),v=n(227);function m(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(0===e.rank)return(0,i.W)(e);if(1!==e.rank&&null===n)return m((0,f.X)(e,[-1]),t,n);if(1===e.rank||"number"===typeof n||Array.isArray(n)&&1===n.length){if(1===t)return(0,v.S)((0,i.W)(e),n);if(t===1/0)return(0,u.F)((0,i.W)(e),n);if(t===-1/0)return(0,s.V)((0,i.W)(e),n);if("euclidean"===t||2===t)return(0,h._)((0,v.S)((0,l.s)((0,i.W)(e),(0,d.i)(2,"int32")),n));throw new Error("Error in norm: invalid ord value: ".concat(t))}if(Array.isArray(n)&&2===n.length){if(1===t)return(0,u.F)((0,v.S)((0,i.W)(e),n[0]),n[1]-1);if(t===1/0)return(0,u.F)((0,v.S)((0,i.W)(e),n[1]),n[0]);if(t===-1/0)return(0,s.V)((0,v.S)((0,i.W)(e),n[1]),n[0]);if("fro"===t||"euclidean"===t)return(0,h._)((0,v.S)((0,p.h)(e),n));throw new Error("Error in norm: invalid ord value: ".concat(t))}throw new Error("Error in norm: invalid axis: ".concat(n))}var g=(0,c.op)({norm_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"euclidean",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],u=m(e=(0,r._1)(e,"x","norm"),t,n),s=u.shape;if(i){var c=(0,a.EC)(n,e.shape);s=o.rv(u.shape,c)}return(0,f.X)(u,s)}})},5549:function(e,t,n){"use strict";n.d(t,{Q:function(){return c}});var r=n(9439),a=n(318),i=n(2145),o=n(9064),u=n(8354),s=n(5774);var c=(0,n(8640).op)({notEqual_:function(e,t){var n=(0,u._1)(e,"a","notEqual","string_or_numeric"),c=(0,u._1)(t,"b","notEqual","string_or_numeric"),l=(0,o.makeTypesMatch)(n,c),f=(0,r.Z)(l,2);n=f[0],c=f[1],(0,s.assertAndGetBroadcastShape)(n.shape,c.shape);var d={a:n,b:c};return a.BV.runKernel(i.yQU,d)}})},4326:function(e,t,n){"use strict";n.d(t,{l:function(){return o}});var r=n(318),a=n(2145),i=n(8354);var o=(0,n(8640).op)({oneHot_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"int32";if(t<2)throw new Error("Error in oneHot: depth must be >=2, but it is ".concat(t));var s=(0,i._1)(e,"indices","oneHot","int32"),c={indices:s},l={dtype:u,depth:t,onValue:n,offValue:o};return r.BV.runKernel(a.we_,c,l)}})},6100:function(e,t,n){"use strict";n.d(t,{i:function(){return u}});var r=n(318),a=n(6147),i=n(9253),o=n(7742);function u(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"float32";if((0,a.Mu)(e),"complex64"===t){var n=u(e,"float32"),s=(0,o.l)(e,"float32");return(0,i.P)(n,s)}var c=(0,a.p8)((0,a.NA)(e),t);return r.BV.makeTensor(c,e,t)}},773:function(e,t,n){"use strict";n.d(t,{J:function(){return o}});var r=n(318),a=n(2145),i=n(8354);var o=(0,n(8640).op)({onesLike_:function(e){var t={x:(0,i._1)(e,"x","onesLike")};return r.BV.runKernel(a.qWM,t)}})},8640:function(e,t,n){"use strict";n.d(t,{op:function(){return o},z:function(){return i}});var r=n(318),a=n(6147),i="__op";function o(e){var t=Object.keys(e);if(1!==t.length)throw new Error("Please provide an object with a single key (operation name) mapping to a function. Got an object with "+"".concat(t.length," keys."));var n=t[0],o=e[n];n.endsWith("_")&&(n=n.substring(0,n.length-1)),n+=i;var u=function(){r.BV.startScope(n);try{var e=o.apply(void 0,arguments);return(0,a.tI)(e)&&console.error("Cannot return a Promise inside of tidy."),r.BV.endScope(e),e}catch(t){throw r.BV.endScope(null),t}};return Object.defineProperty(u,"name",{value:n,configurable:!0}),u}},9503:function(e,t,n){"use strict";n.d(t,{zvA:function(){return d.z},WnP:function(){return a.W},Khb:function(){return i.K},__u:function(){return o._},IHx:function(){return u.I},QBD:function(){return h},$6P:function(){return p.$},YjB:function(){return v.Y},NqF:function(){return m.N},vHJ:function(){return g.v},ZRM:function(){return y.Z},VfV:function(){return b.V},z4N:function(){return x.z},fvJ:function(){return w.f},C80:function(){return k.C},wS1:function(){return _.w},uR5:function(){return E},zEQ:function(){return O},tgs:function(){return j.t},Dxk:function(){return B},JY5:function(){return z},p3b:function(){return Z},E4h:function(){return R.E},yE8:function(){return L},ycw:function(){return P},anm:function(){return lr},XsQ:function(){return U},UFq:function(){return W.U},f3b:function(){return V.f},pju:function(){return S.p},mDi:function(){return q.m},iUl:function(){return G.i},d9v:function(){return H.d},PYB:function(){return X.P},zoF:function(){return N.z},gME:function(){return K},Izb:function(){return Y},MNy:function(){return $},ZaL:function(){return Q},PAt:function(){return J.P},Tek:function(){return ee.T},bc:function(){return te.b},pdZ:function(){return ne},$QV:function(){return ae},mCk:function(){return ie.m},f9Y:function(){return oe.f},mew:function(){return wr},$Gn:function(){return ue.$},zbp:function(){return se.z},ppE:function(){return ce},nTT:function(){return le.n},B10:function(){return fe.B},Ka3:function(){return de},WmZ:function(){return he.W},hiC:function(){return pe.h},NTj:function(){return ve.N},AKD:function(){return me.A},rvX:function(){return br},WYO:function(){return ge},pyx:function(){return ye.p},GRh:function(){return xr},EDe:function(){return be},DgJ:function(){return xe.D},qNN:function(){return we.q},d2q:function(){return ke.d},Qqt:function(){return _e.Q},dt4:function(){return Se.d},t$B:function(){return Ce.t},iyy:function(){return Ee},kp_:function(){return En.k},hlL:function(){return Ne.h},GWj:function(){return Te.G},qPi:function(){return Ie.q},imm:function(){return r},Iqj:function(){return De.I},dbB:function(){return yr},pjt:function(){return Fe.p},brS:function(){return Me.b},Sxn:function(){return Nn.S},asL:function(){return Oe.a},BHj:function(){return Ma},V3u:function(){return _r},wx0:function(){return Tn.w},xVT:function(){return Re.x},UWc:function(){return je.U},i2d:function(){return Be.i},hi7:function(){return ze.h},d9m:function(){return Ze.d},zN1:function(){return Le.z},$r2:function(){return Oa},SX3:function(){return Pe},G9k:function(){return Ue.G},cM7:function(){return We.c},Krr:function(){return Ve.K},e_t:function(){return qe.e},CmS:function(){return Ge.C},l_t:function(){return He.l},HvI:function(){return Xe.H},hJK:function(){return Ke.h},K5V:function(){return Ye.K},egP:function(){return $e.e},MB5:function(){return Ra},eab:function(){return et},OI3:function(){return T.O},Fp7:function(){return tt.F},_sB:function(){return nt._},YQQ:function(){return rt},Ip$:function(){return at},gWQ:function(){return it.g},J69:function(){return ot.J},ry_:function(){return ct},VV$:function(){return lt.V},LTh:function(){return ft.L},VdP:function(){return dt.V},wQq:function(){return ht.w},Gi7:function(){return gt},p_:function(){return pr},dC7:function(){return I.d},rq4:function(){return yt},SJ_:function(){return bt},W76:function(){return xt.W},KOy:function(){return dr.K},Quu:function(){return wt.Q},lfX:function(){return kt.l},iUs:function(){return ut.i},JpU:function(){return _t.J},op:function(){return d.op},N2O:function(){return St},vku:function(){return Ct.v},pNR:function(){return At},koy:function(){return Et},t1L:function(){return Nt},lGY:function(){return Tt},d_R:function(){return It.d},sQ3:function(){return Dt.s},AL3:function(){return Ft.A},S0v:function(){return Mt.S},WVs:function(){return Ot.W},$gW:function(){return Rt},VT$:function(){return jt},N89:function(){return Bt},TN_:function(){return zt},wzB:function(){return qt},nGf:function(){return Gt},ruB:function(){return Ht},LGj:function(){return Xt},pe5:function(){return Kt},w6H:function(){return Yt},kwC:function(){return $t.k},M25:function(){return Qt.M},UYe:function(){return Jt.U},btT:function(){return en.b},XLQ:function(){return A.X},GYS:function(){return tn.G},SDf:function(){return nn},diP:function(){return rn},sx7:function(){return an},mG2:function(){return on},QEs:function(){return In.Q},NMM:function(){return un.N},bp0:function(){return sn.b},iD$:function(){return cn.i},snQ:function(){return vr},zcT:function(){return Je},U8D:function(){return ln.U},U_I:function(){return fn.U},ODp:function(){return mn},XD2:function(){return D.X},Xxe:function(){return gn.X},tdS:function(){return Fa},O$l:function(){return yn.O},R_K:function(){return bn.R},tPi:function(){return F.t},jZU:function(){return xn},SmN:function(){return wn},CnO:function(){return kn},p0P:function(){return _n},XAC:function(){return Sn.X},Wvh:function(){return Cn.W},fBT:function(){return An.f},rVs:function(){return ja},ers:function(){return gr},uN7:function(){return Da},Vl2:function(){return Dn.V},_b3:function(){return Fn._},h62:function(){return vt.h},$i:function(){return Mn.$},L9e:function(){return On.L},knu:function(){return Rn.k},Nbs:function(){return jn.N},NXj:function(){return Bn.N},Z_8:function(){return Ba},luU:function(){return mt.l},Smz:function(){return zn.S},ORZ:function(){return Zn.O},AEp:function(){return M.A},XeE:function(){return Ln.X},RRF:function(){return Un},odF:function(){return Wn},wOQ:function(){return Vn.w},yXz:function(){return qn},Bfx:function(){return Gn},xZs:function(){return Hn},Pg0:function(){return Kn},Gg6:function(){return Ae.G},hg7:function(){return Yn.h},p4s:function(){return fr.p},Xu6:function(){return $n},Two:function(){return Qn.T},pUJ:function(){return Jn.p},HHK:function(){return er.H},GaM:function(){return tr},VD$:function(){return nr},arb:function(){return rr.a},itS:function(){return or},lls:function(){return ur.l},P84:function(){return sr.P}});var r={};n.r(r),n.d(r,{conv2d:function(){return Ir},depthwiseConv2d:function(){return Mr},matMul:function(){return Or}});var a=n(7613),i=n(1719),o=n(4502),u=n(3312),s=n(318),c=n(2145),l=n(8354),f=n(6147),d=n(8640);var h=(0,d.op)({addN_:function(e){f.hu(Array.isArray(e),(function(){return"The argument passed to tf.addN() must be a list of tensors"})),f.hu(e.length>=1,(function(){return"Must pass at least one tensor to tf.addN(), but got "+"".concat(e.length)}));var t=e.map((function(e,t){return(0,l._1)(e,"tensors".concat(t),"addN")})),n=t[0];t.forEach((function(e){if(e.dtype!==n.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")})),t.forEach((function(e){if(!f.cO(e.shape,n.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")}));var r=t;return s.BV.runKernel(c.Xze,r)}}),p=n(4108),v=n(8543),m=n(9995),g=n(5157),y=n(3053),b=n(54),x=n(4778),w=n(2227),k=n(7897),_=n(9204),S=n(9118),C=n(9151),A=n(5561);var E=(0,d.op)({avgPool3d_:function(e,t,n,r,a){var i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NDHWC",o=(0,l._1)(e,"x","avgPool3d","float32"),u=o,d=!1;4===o.rank&&(d=!0,u=(0,A.X)(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),f.hu(5===u.rank,(function(){return"Error in avgPool3d: x must be rank 5 but got rank ".concat(u.rank,".")})),f.hu("NDHWC"===i,(function(){return"Error in avgPool3d: Only NDHWC is currently supported, "+"but got dataFormat of ".concat(i)})),f.hu("number"===typeof n&&n>0||Array.isArray(n)&&n[0]>0&&n[1]>0&&n[2]>0,(function(){return"Error in avgPool3d: Stride must be > 0, but got '".concat(n,"'")})),(0,C.m)("avgPool3d",r,a);var h={x:u},p={filterSize:t,strides:n,pad:r,dimRoundingMode:a,dataFormat:i},v=s.BV.runKernel(c._k9,h,p);return v=(0,S.p)(v,u.dtype),d?(0,A.X)(v,[v.shape[1],v.shape[2],v.shape[3],v.shape[4]]):v}}),N=n(4836),T=n(7221),I=n(651),D=n(7643),F=n(9238),M=n(1744);var O=(0,d.op)({basicLSTMCell_:function(e,t,n,r,a,i){var o=(0,l._1)(e,"forgetBias","basicLSTMCell"),s=(0,l._1)(t,"lstmKernel","basicLSTMCell"),c=(0,l._1)(n,"lstmBias","basicLSTMCell"),f=(0,l._1)(r,"data","basicLSTMCell"),d=(0,l._1)(a,"c","basicLSTMCell"),h=(0,l._1)(i,"h","basicLSTMCell"),p=(0,N.z)([f,h],1),v=(0,T.O)(p,s),m=(0,u.I)(v,c),g=m.shape[0],y=m.shape[1]/4,b=[g,y],x=(0,F.t)(m,[0,0],b),w=(0,F.t)(m,[0,y],b),k=(0,F.t)(m,[0,2*y],b),_=(0,F.t)(m,[0,3*y],b),S=(0,u.I)((0,I.d)((0,D.X)(x),(0,M.A)(w)),(0,I.d)(d,(0,D.X)((0,u.I)(o,k))));return[S,(0,I.d)((0,M.A)(S),(0,D.X)(_))]}}),R=n(6994),j=n(3700);var B=(0,d.op)({batchNorm2d_:function(e,t,n,r,a,i){var o,u,s=(0,l._1)(e,"x","batchNorm"),c=(0,l._1)(t,"mean","batchNorm"),d=(0,l._1)(n,"variance","batchNorm");return null!=a&&(o=(0,l._1)(a,"scale","batchNorm")),null!=r&&(u=(0,l._1)(r,"offset","batchNorm")),f.hu(2===s.rank,(function(){return"Error in batchNorm2D: x must be rank 2 but got rank "+"".concat(s.rank,".")})),f.hu(2===c.rank||1===c.rank,(function(){return"Error in batchNorm2D: mean must be rank 2 or rank 1 but "+"got rank ".concat(c.rank,".")})),f.hu(2===d.rank||1===d.rank,(function(){return"Error in batchNorm2D: variance must be rank 2 or rank 1 "+"but got rank ".concat(d.rank,".")})),null!=o&&f.hu(2===o.rank||1===o.rank,(function(){return"Error in batchNorm2D: scale must be rank 2 or rank 1 "+"but got rank ".concat(o.rank,".")})),null!=u&&f.hu(2===u.rank||1===u.rank,(function(){return"Error in batchNorm2D: offset must be rank 2 or rank 1 "+"but got rank ".concat(u.rank,".")})),(0,j.t)(s,c,d,u,o,i)}});var z=(0,d.op)({batchNorm3d_:function(e,t,n,r,a,i){var o,u,s=(0,l._1)(e,"x","batchNorm"),c=(0,l._1)(t,"mean","batchNorm"),d=(0,l._1)(n,"variance","batchNorm");return null!=a&&(o=(0,l._1)(a,"scale","batchNorm")),null!=r&&(u=(0,l._1)(r,"offset","batchNorm")),f.hu(3===s.rank,(function(){return"Error in batchNorm3D: x must be rank 3 but got rank "+"".concat(s.rank,".")})),f.hu(3===c.rank||1===c.rank,(function(){return"Error in batchNorm3D: mean must be rank 3 or rank 1 but "+"got rank ".concat(c.rank,".")})),f.hu(3===d.rank||1===d.rank,(function(){return"Error in batchNorm3D: variance must be rank 3 or rank 1 "+"but got rank ".concat(d.rank,".")})),null!=o&&f.hu(3===o.rank||1===o.rank,(function(){return"Error in batchNorm3D: scale must be rank 3 or rank 1 "+"but got rank ".concat(o.rank,".")})),null!=u&&f.hu(3===u.rank||1===u.rank,(function(){return"Error in batchNorm3D: offset must be rank 3 or rank 1 "+"but got rank ".concat(u.rank,".")})),(0,j.t)(s,c,d,u,o,i)}});var Z=(0,d.op)({batchNorm4d_:function(e,t,n,r,a,i){var o,u,s=(0,l._1)(e,"x","batchNorm"),c=(0,l._1)(t,"mean","batchNorm"),d=(0,l._1)(n,"variance","batchNorm");return null!=a&&(o=(0,l._1)(a,"scale","batchNorm")),null!=r&&(u=(0,l._1)(r,"offset","batchNorm")),f.hu(4===s.rank,(function(){return"Error in batchNorm4D: x must be rank 4 but got rank "+"".concat(s.rank,".")})),f.hu(4===c.rank||1===c.rank,(function(){return"Error in batchNorm4D: mean must be rank 4 or rank 1 but "+"got rank ".concat(c.rank,".")})),f.hu(4===d.rank||1===d.rank,(function(){return"Error in batchNorm4D: variance must be rank 4 or rank 1 "+"but got rank ".concat(d.rank,".")})),null!=o&&f.hu(4===o.rank||1===o.rank,(function(){return"Error in batchNorm4D: scale must be rank 4 or rank 1 "+"but got rank ".concat(o.rank,".")})),null!=u&&f.hu(4===u.rank||1===u.rank,(function(){return"Error in batchNorm4D: offset must be rank 4 or rank 1 "+"but got rank ".concat(u.rank,".")})),(0,j.t)(s,c,d,u,o,i)}});var L=(0,d.op)({bincount_:function(e,t,n){var r=(0,l._1)(e,"x","bincount"),a=(0,l._1)(t,"weights","bincount");f.hu("int32"===r.dtype,(function(){return"Error in bincount: input "+"dtype must be int32, but got ".concat(r.dtype)})),f.hu(n>=0,(function(){return"size must be non-negative, but got ".concat(n,".")})),f.hu(a.size===r.size||0===a.size,(function(){return"Error in bincount: weights must have the same size as input or"+"0-length, but got input shape: ".concat(r.shape,", weights shape: ")+"".concat(a.shape,".")}));var i={x:r,weights:a},o={size:n};return s.BV.runKernel(c.zvY,i,o)}});var P=(0,d.op)({bitwiseAnd_:function(e,t){var n=(0,l._1)(e,"x","bitwiseAnd"),r=(0,l._1)(t,"y","bitwiseAnd");if(!(0,f.cO)(n.shape,r.shape))throw new Error("BitwiseAnd: Tensors must have the same shape. x: ".concat(n.shape,", y: ").concat(r.shape));if("int32"!==n.dtype||"int32"!==r.dtype)throw new Error("BitwiseAnd: Only supports 'int32' values in tensor, found type of x: ".concat(n.dtype," and type of y: ").concat(r.dtype));var a={a:n,b:r};return s.BV.runKernel(c.hCO,a)}});var U=(0,d.op)({broadcastArgs_:function(e,t){var n=(0,l._1)(e,"s0","broadcastArgs","int32"),r=(0,l._1)(t,"s1","broadcastArgs","int32");if(1!==n.rank)throw new Error("broadcastArgs(): first input must be a vector (rank=1). "+"Has rank ".concat(n.rank));if(1!==r.rank)throw new Error("broadcastArgs(): second input must be a vector (rank=1). "+"Has rank ".concat(r.rank));var a={s0:n,s1:r};return s.BV.runKernel(c.eEB,a)}}),W=n(9742),V=n(7039),q=n(1396),G=n(9836),H=n(672),X=n(9253);var K=(0,d.op)({concat1d_:function(e){return(0,N.z)(e,0)}});var Y=(0,d.op)({concat2d_:function(e,t){return(0,N.z)(e,t)}});var $=(0,d.op)({concat3d_:function(e,t){return(0,N.z)(e,t)}});var Q=(0,d.op)({concat4d_:function(e,t){return(0,N.z)(e,t)}}),J=n(4918),ee=n(3457),te=n(1732);var ne=(0,d.op)({conv3d_:function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NDHWC",i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1,1],o=(0,l._1)(e,"x","conv3d"),u=(0,l._1)(t,"filter","conv3d"),d=o,h=!1;4===o.rank&&(h=!0,d=(0,A.X)(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),f.hu(5===d.rank,(function(){return"Error in conv3d: input must be rank 5, but got rank ".concat(d.rank,".")})),f.hu(5===u.rank,(function(){return"Error in conv3d: filter must be rank 5, but got rank "+"".concat(u.rank,".")})),f.hu(d.shape[4]===u.shape[3],(function(){return"Error in conv3d: depth of input (".concat(d.shape[4],") must match ")+"input depth for filter ".concat(u.shape[3],".")})),f.hu((0,C.jT)(n,i),(function(){return"Error in conv3D: Either strides or dilations must be 1. "+"Got strides ".concat(n," and dilations '").concat(i,"'")})),f.hu("NDHWC"===a,(function(){return"Error in conv3d: got dataFormat of ".concat(a," but only NDHWC is currently supported.")})),f.hu((0,C.U3)(i),(function(){return"Error in conv3D: Dilated rates should be larger than 0."})),f.hu((0,C.U3)(n),(function(){return"Error in conv3D: Strides should be larger than 0."}));var p={x:d,filter:u},v={strides:n,pad:r,dataFormat:a,dilations:i},m=s.BV.runKernel(c.x12,p,v);return h?(0,A.X)(m,[m.shape[1],m.shape[2],m.shape[3],m.shape[4]]):m}}),re=n(1873);var ae=(0,d.op)({conv3dTranspose_:function(e,t,n,r,a){var i=(0,l._1)(e,"x","conv3dTranspose"),o=(0,l._1)(t,"filter","conv3dTranspose");return(0,re._)(n,i,o,r,a)}}),ie=n(1227),oe=n(6679),ue=n(9457),se=n(8862);var ce=(0,d.op)({denseBincount_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=(0,l._1)(e,"x","denseBincount"),i=(0,l._1)(t,"weights","denseBincount");f.hu("int32"===a.dtype,(function(){return"Error in denseBincount: input "+"dtype must be int32, but got ".concat(a.dtype)})),f.hu(a.rank<=2,(function(){return"Error in denseBincount: input must be at most rank 2, but got "+"rank ".concat(a.rank,".")})),f.hu(n>=0,(function(){return"size must be non-negative, but got ".concat(n,".")})),f.hu(i.size===a.size||0===i.size,(function(){return"Error in denseBincount: weights must have the same shape as x or "+"0-length, but got x shape: ".concat(a.shape,", weights shape: ")+"".concat(i.shape,".")}));var o={x:a,weights:i},u={size:n,binaryOutput:r};return s.BV.runKernel(c.QRR,o,u)}}),le=n(1878),fe=n(1147);var de=(0,d.op)({diag_:function(e){var t={x:(0,l._1)(e,"x","diag")};return s.BV.runKernel(c.$w,t)}}),he=n(7580),pe=n(5750),ve=n(5923),me=n(5043);var ge=(0,d.op)({einsum_:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var a=n.map((function(e,t){return(0,l._1)(e,"tensors".concat(t),"einsum")})),i={equation:e};return s.BV.runKernel(c.$g6,a,i)}}),ye=n(2353);var be=(0,d.op)({ensureShape_:function(e,t){var n=(0,l._1)(e,"x","ensureShape","string_or_numeric");if(!(0,f.DK)(n.shape,t))throw new Error("EnsureShape: Shape of tensor ".concat(n.shape," is not compatible with expected shape ").concat(t));return e}}),xe=n(3254),we=n(3891),ke=n(3313),_e=n(411),Se=n(2975),Ce=n(5682),Ae=n(2343);var Ee=(0,d.op)({eye_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"float32";null==t&&(t=e);for(var a=(0,V.f)([e,t],r),i=e<=t?e:t,o=0;o<i;++o)a.set(1,o,o);var u=(0,A.X)(a.toTensor(),[e,t]);if(null==n)return u;if(1===n.length)return(0,Ae.G)((0,Se.d)(u,0),[n[0],1,1]);if(2===n.length)return(0,Ae.G)((0,Se.d)((0,Se.d)(u,0),0),[n[0],n[1],1,1]);if(3===n.length)return(0,Ae.G)((0,Se.d)((0,Se.d)((0,Se.d)(u,0),0),0),[n[0],n[1],n[2],1,1]);throw new Error("eye() currently supports only 1D and 2D "+"batchShapes, but received ".concat(n.length,"D."))}}),Ne=n(8582),Te=n(2628),Ie=n(7145),De=n(9498),Fe=n(5014),Me=n(8327),Oe=n(6996),Re=n(300),je=n(4652),Be=n(7005),ze=n(4419),Ze=n(4920),Le=n(2642);function Pe(e,t,n){if(n<=0)throw new Error("The number of values should be positive.");var r={start:e,stop:t,num:n};return s.BV.runKernel(c.e7N,{},r)}var Ue=n(936),We=n(378),Ve=n(5341),qe=n(5113),Ge=n(4561),He=n(5530),Xe=n(2177),Ke=n(875),Ye=n(5117),$e=n(1712),Qe=2147483648;var Je=(0,d.op)({searchSorted_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"left",r=(0,l._1)(e,"sortedSequence","searchSorted"),a=(0,l._1)(t,"values","searchSorted"),i=r.shape[r.shape.length-1],o=a.shape[a.shape.length-1],u=(0,A.X)(r,[-1,i]),d=(0,A.X)(a,[-1,o]);if(u.rank<2)throw new Error("Sorted input argument must be at least 2-dimensional");if(u.shape[0]!==d.shape[0])throw new Error("Leading dimension of 'sortedSequence' and 'values' must match.");if((0,f.NA)(d.shape)>=Qe)throw new Error("values tensor size must less than ".concat(Qe));if(u.shape[1]>=Qe)throw new Error("trailing dim_size must less than ".concat(Qe," for int32 output type, was ").concat(u.shape[1]));var h={sortedSequence:u,values:d},p={side:n};return s.BV.runKernel(c.nr8,h,p)}});function et(e,t){return Je(e,t,"left")}var tt=n(6176),nt=n(5777);var rt=(0,d.op)({maxPool3d_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[1,1,1],n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0,a=arguments.length>4?arguments[4]:void 0,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NDHWC",o=(0,l._1)(e,"x","maxPool3d"),u=o,d=!1;4===o.rank&&(d=!0,u=(0,A.X)(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),f.hu(5===u.rank,(function(){return"Error in maxPool3d: x must be rank 5 but got rank ".concat(u.rank,".")})),f.hu("NDHWC"===i,(function(){return"Error in maxPool3d: Only NDHWC is currently supported, "+"but got dataFormat of ".concat(i)})),(0,C.m)("maxPool3d",r,a);var h={x:u},p={filterSize:t,strides:n,pad:r,dimRoundingMode:a,dataFormat:i},v=s.BV.runKernel(c.OAf,h,p);return d?(0,A.X)(v,[v.shape[1],v.shape[2],v.shape[3],v.shape[4]]):v}});var at=(0,d.op)({maxPoolWithArgmax_:function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]&&arguments[4],i=(0,l._1)(e,"x","maxPoolWithArgmax"),o={x:i},u={filterSize:t,strides:n,pad:r,includeBatchInIndex:a},f=s.BV.runKernel(c.vFR,o,u);return{result:f[0],indexes:f[1]}}}),it=n(705),ot=n(6568),ut=n(6100),st=n(4376);function ct(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=n.indexing,a=void 0===r?"xy":r;if("xy"!==a&&"ij"!==a)throw new TypeError("".concat(a," is not a valid third argument to meshgrid"));if(void 0===e)return[];var i=(0,l._1)(e,"x","meshgrid",e instanceof st.es?e.dtype:"float32");if(void 0===t)return[i];var o=(0,l._1)(t,"y","meshgrid",t instanceof st.es?t.dtype:"float32"),u=(0,f.NA)(i.shape),s=(0,f.NA)(o.shape);return"xy"===a?(i=(0,A.X)(i,[1,-1]),o=(0,A.X)(o,[-1,1]),[(0,T.O)((0,ut.i)([s,1],i.dtype),i),(0,T.O)(o,(0,ut.i)([1,u],o.dtype))]):(i=(0,A.X)(i,[-1,1]),o=(0,A.X)(o,[1,-1]),[(0,T.O)(i,(0,ut.i)([1,s],i.dtype)),(0,T.O)((0,ut.i)([u,1],o.dtype),o)])}var lt=n(7891),ft=n(2273),dt=n(9719),ht=n(4645),pt=n(8473),vt=n(7391),mt=n(4774);var gt=(0,d.op)({moments_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];e=(0,l._1)(e,"x","moments");var r=(0,f.EC)(t,e.shape),a=(0,ot.J)(e,r,n),i=a.shape;n||(i=(0,pt.rv)(a.shape,r));var o=(0,vt.h)((0,mt.l)((0,S.p)(e,"float32"),(0,A.X)(a,i))),u=(0,ot.J)(o,r,n);return{mean:a,variance:u}}});var yt=(0,d.op)({multiRNNCell_:function(e,t,n,r){for(var a=(0,l._1)(t,"data","multiRNNCell"),i=(0,l.sI)(n,"c","multiRNNCell"),o=(0,l.sI)(r,"h","multiRNNCell"),u=a,s=[],c=0;c<e.length;c++){var f=e[c](u,i[c],o[c]);s.push(f[0]),s.push(f[1]),u=f[1]}for(var d=[],h=[],p=0;p<s.length;p+=2)d.push(s[p]),h.push(s[p+1]);return[d,h]}});var bt=(0,d.op)({multinomial_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=(0,l._1)(e,"logits","multinomial"),i=a.size,o=a.rank;if(i<2)throw new Error("Error in multinomial: you need at least 2 outcomes, but got "+"".concat(i,"."));if(o>2)throw new Error("Rank of probabilities must be 1 or 2, but is ".concat(o));n=n||Math.random();var u=1===o?(0,A.X)(a,[1,-1]):a,f={logits:u},d={numSamples:t,seed:n,normalized:r},h=s.BV.runKernel(c.NZg,f,d);return 1===o?(0,A.X)(h,[h.size]):h}}),xt=n(4362),wt=n(5549),kt=n(4326),_t=n(773);var St=(0,d.op)({outerProduct_:function(e,t){var n=(0,l._1)(e,"v1","outerProduct"),r=(0,l._1)(t,"v2","outerProduct");f.hu(1===n.rank&&1===r.rank,(function(){return"Error in outerProduct: inputs must be rank 1, but got ranks "+"".concat(n.rank," and ").concat(r.rank,".")}));var a=(0,A.X)(n,[-1,1]),i=(0,A.X)(r,[1,-1]);return(0,T.O)(a,i)}}),Ct=n(1970);var At=(0,d.op)({pad1d_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return(0,f.hu)(2===t.length,(function(){return"Invalid number of paddings. Must be length of 2."})),(0,Ct.v)(e,[t],n)}});var Et=(0,d.op)({pad2d_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return(0,f.hu)(2===t.length&&2===t[0].length&&2===t[1].length,(function(){return"Invalid number of paddings. Must be length of 2 each."})),(0,Ct.v)(e,t,n)}});var Nt=(0,d.op)({pad3d_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return(0,f.hu)(3===t.length&&2===t[0].length&&2===t[1].length&&2===t[2].length,(function(){return"Invalid number of paddings. Must be length of 2 each."})),(0,Ct.v)(e,t,n)}});var Tt=(0,d.op)({pad4d_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return(0,f.hu)(4===t.length&&2===t[0].length&&2===t[1].length&&2===t[2].length&&2===t[3].length,(function(){return"Invalid number of paddings. Must be length of 2 each."})),(0,Ct.v)(e,t,n)}}),It=n(7226),Dt=n(4334),Ft=n(6859),Mt=n(4600),Ot=n(7722);var Rt=(0,d.op)({raggedGather_:function(e,t,n,r){var a={paramsNestedSplits:e.map((function(e,t){return(0,l._1)(e,"tensors".concat(t),"raggedGather","int32")})),paramsDenseValues:(0,l._1)(t,"paramsDenseValues","raggedGather"),indices:(0,l._1)(n,"indices","raggedGather","int32")},i={outputRaggedRank:r},o=s.BV.runKernel(c.dDz,a,i);return{outputNestedSplits:o.slice(0,o.length-1),outputDenseValues:o[o.length-1]}}});var jt=(0,d.op)({raggedRange_:function(e,t,n){var r=(0,l._1)(e,"starts","raggedRange"),a={starts:r,limits:(0,l._1)(t,"limits","raggedRange",r.dtype),deltas:(0,l._1)(n,"deltas","raggedRange",r.dtype)},i=s.BV.runKernel(c.CQl,a);return{rtNestedSplits:i[0],rtDenseValues:i[1]}}});var Bt=(0,d.op)({raggedTensorToTensor_:function(e,t,n,r,a){var i=(0,l._1)(e,"shape","raggedTensorToTensor","int32"),o=(0,l._1)(t,"values","raggedTensorToTensor"),u={shape:i,values:o,defaultValue:(0,l._1)(n,"defaultValue","raggedTensorToTensor",o.dtype),rowPartitionTensors:r.map((function(e,t){return(0,l._1)(e,"tensors".concat(t),"raggedTensorToTensor","int32")}))},f={rowPartitionTypes:a};return s.BV.runKernel(c.BiW,u,f)}});var zt=(0,d.op)({rand_:function(e,t,n){(0,f.Mu)(e);var r=(0,f.NA)(e),a=null;if(null==n||"float32"===n)a=new Float32Array(r);else if("int32"===n)a=new Int32Array(r);else{if("bool"!==n)throw new Error("Unknown data type ".concat(n));a=new Uint8Array(r)}for(var i=0;i<r;i++)a[i]=t();return s.BV.makeTensor(a,e,n)}}),Zt=n(5671),Lt=n(3144),Pt=n(6699),Ut=function(){function e(t,n,r,a,i){(0,Zt.Z)(this,e),this.mean=t,this.stdDev=n,this.dtype=r,this.nextVal=NaN,this.truncated=a,this.truncated&&(this.upper=this.mean+2*this.stdDev,this.lower=this.mean-2*this.stdDev);var o=i||Math.random();this.random=Pt.alea(o.toString())}return(0,Lt.Z)(e,[{key:"nextValue",value:function(){if(!isNaN(this.nextVal)){var e=this.nextVal;return this.nextVal=NaN,e}for(var t,n,r=!1;!r;){var a=void 0,i=void 0,o=void 0;do{o=(a=2*this.random()-1)*a+(i=2*this.random()-1)*i}while(o>=1||0===o);var u=Math.sqrt(-2*Math.log(o)/o);t=this.mean+this.stdDev*a*u,n=this.mean+this.stdDev*i*u,this.truncated&&!this.isValidTruncated(t)||(r=!0)}return this.truncated&&!this.isValidTruncated(n)||(this.nextVal=this.convertValue(n)),this.convertValue(t)}},{key:"convertValue",value:function(e){return null==this.dtype||"float32"===this.dtype?e:Math.round(e)}},{key:"isValidTruncated",value:function(e){return e<=this.upper&&e>=this.lower}}]),e}(),Wt=function(){function e(t,n,r,a){(0,Zt.Z)(this,e),this.alpha=t,this.beta=1/n,this.dtype=r;var i=a||Math.random();this.randu=Pt.alea(i.toString()),this.randn=new Ut(0,1,r,!1,this.randu()),this.d=t<1?t+2/3:t-1/3,this.c=1/Math.sqrt(9*this.d)}return(0,Lt.Z)(e,[{key:"nextValue",value:function(){for(var e,t,n,r,a,i;;){do{r=this.randn.nextValue(),i=1+this.c*r}while(i<=0);if(i*=i*i,t=1-.331*(e=r*r)*e,n=.5*e+this.d*(1-i+Math.log(i)),(a=this.randu())<t||Math.log(a)<n)break}return i=1/this.beta*this.d*i,this.alpha<1&&(i*=Math.pow(this.randu(),1/this.alpha)),this.convertValue(i)}},{key:"convertValue",value:function(e){return"float32"===this.dtype?e:Math.round(e)}}]),e}(),Vt=function(){function e(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0;if((0,Zt.Z)(this,e),this.canReturnFloat=function(){return null==t.dtype||"float32"===t.dtype},this.min=n,this.range=r-n,this.dtype=a,null==i&&(i=Math.random()),"number"===typeof i&&(i=i.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error("The difference between ".concat(n," - ").concat(r," <= 1 and dtype is not float"));this.random=Pt.alea(i)}return(0,Lt.Z)(e,[{key:"convertValue",value:function(e){return this.canReturnFloat()?e:Math.round(e)}},{key:"nextValue",value:function(){return this.convertValue(this.min+this.range*this.random())}}]),e}();var qt=(0,d.op)({randomGamma_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"float32",a=arguments.length>4?arguments[4]:void 0;if((0,f.Mu)(e),null==n&&(n=1),null==r&&(r="float32"),"float32"!==r&&"int32"!==r)throw new Error("Unsupported data type ".concat(r));for(var i=new Wt(t,n,r,a),o=(0,V.f)(e,r),u=0;u<o.values.length;u++)o.values[u]=i.nextValue();return o.toTensor()}});var Gt=(0,d.op)({randomNormal_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3?arguments[3]:void 0,a=arguments.length>4?arguments[4]:void 0;if((0,f.Mu)(e),null!=r&&"bool"===r)throw new Error("Unsupported data type ".concat(r));for(var i=new Ut(t,n,r,!1,a),o=(0,V.f)(e,r),u=0;u<o.values.length;u++)o.values[u]=i.nextValue();return o.toTensor()}});var Ht=(0,d.op)({randomStandardNormal_:function(e,t,n){if(null!=t&&"bool"===t)throw new Error("Unsupported data type ".concat(t));return Gt(e,0,1,t,n)}});var Xt=(0,d.op)({randomUniform_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"float32",a=arguments.length>4?arguments[4]:void 0;(0,f.Mu)(e);for(var i=(0,V.f)(e,r),o=new Vt(t,n,null,a),u=0;u<i.values.length;u++)i.values[u]=o.nextValue();return i.toTensor()}});var Kt=(0,d.op)({randomUniformInt_:function(e,t,n,r){return Xt(e,t,n,"int32",r)}});function Yt(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"float32";if(0===n)throw new Error("Cannot have a step of zero");var a={start:e,stop:t,step:n,dtype:r};return s.BV.runKernel(c.e6w,{},a)}var $t=n(6972),Qt=n(2209),Jt=n(7539),en=n(5900),tn=n(4933);var nn=(0,d.op)({reverse1d_:function(e){var t=(0,l._1)(e,"x","reverse");return f.hu(1===t.rank,(function(){return"Error in reverse1D: x must be rank 1 but got rank ".concat(t.rank,".")})),(0,tn.G)(t,0)}});var rn=(0,d.op)({reverse2d_:function(e,t){var n=(0,l._1)(e,"x","reverse");return f.hu(2===n.rank,(function(){return"Error in reverse2D: x must be rank 2 but got rank ".concat(n.rank,".")})),(0,tn.G)(n,t)}});var an=(0,d.op)({reverse3d_:function(e,t){var n=(0,l._1)(e,"x","reverse");return f.hu(3===n.rank,(function(){return"Error in reverse3D: x must be rank 3 but got rank ".concat(n.rank,".")})),(0,tn.G)(n,t)}});var on=(0,d.op)({reverse4d_:function(e,t){var n=(0,l._1)(e,"x","reverse");return f.hu(4===n.rank,(function(){return"Error in reverse4D: x must be rank 4 but got rank ".concat(n.rank,".")})),(0,tn.G)(n,t)}}),un=n(766),sn=n(5115),cn=n(7067),ln=n(413),fn=n(119),dn=n(5861),hn=n(4687),pn=n.n(hn);function vn(){return vn=(0,dn.Z)(pn().mark((function e(t,n){var r,a,i,o,u,s,c,d,h,p,v;return pn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=(0,l._1)(t,"x","setdiff1d"),a=(0,l._1)(n,"y","setdiff1d"),f.hu(r.dtype===a.dtype,(function(){return"x and y should have the same dtype, but got x (".concat(r.dtype,") and y (").concat(a.dtype,").")})),f.hu(1===r.rank,(function(){return"x should be 1D tensor, but got x (".concat(r.shape,").")})),f.hu(1===a.rank,(function(){return"y should be 1D tensor, but got y (".concat(a.shape,").")})),e.next=7,r.data();case 7:return i=e.sent,e.next=10,a.data();case 10:for(o=e.sent,u=new Set(o),s=0,c=0;c<i.length;c++)u.has(i[c])||s++;for(d=new st.YD([s],r.dtype),h=new st.YD([s],"int32"),p=0,v=0;p<i.length;p++)u.has(i[p])||(d.values[v]=i[p],h.values[v]=p,v++);return e.abrupt("return",[d.toTensor(),h.toTensor()]);case 18:case"end":return e.stop()}}),e)}))),vn.apply(this,arguments)}var mn=function(e,t){return vn.apply(this,arguments)},gn=n(2070),yn=n(7254),bn=n(7657);var xn=(0,d.op)({slice1d_:function(e,t,n){var r=(0,l._1)(e,"x","slice1d");return f.hu(1===r.rank,(function(){return"slice1d expects a rank-1 tensor, but got a rank-".concat(r.rank," tensor")})),(0,F.t)(r,[t],[n])}});var wn=(0,d.op)({slice2d_:function(e,t,n){var r=(0,l._1)(e,"x","slice2d");return f.hu(2===r.rank,(function(){return"slice2d expects a rank-2 tensor, but got a rank-".concat(r.rank," tensor")})),(0,F.t)(r,t,n)}});var kn=(0,d.op)({slice3d_:function(e,t,n){var r=(0,l._1)(e,"x","slice3d");return f.hu(3===r.rank,(function(){return"slice3d expects a rank-3 tensor, but got a rank-".concat(r.rank," tensor")})),(0,F.t)(r,t,n)}});var _n=(0,d.op)({slice4d_:function(e,t,n){var r=(0,l._1)(e,"x","slice4d");return f.hu(4===r.rank,(function(){return"slice4d expects a rank-4 tensor, but got a rank-".concat(r.rank," tensor")})),(0,F.t)(r,t,n)}}),Sn=n(4910),Cn=n(4626),An=n(5696),En=n(7635),Nn=n(530),Tn=n(774),In=n(4617),Dn=n(2588),Fn=n(6902),Mn=n(7993),On=n(3931),Rn=n(8306),jn=n(4031),Bn=n(9017),zn=n(227),Zn=n(6999),Ln=n(2442),Pn=n(7960);function Un(e,t){(0,f.Cq)(e);var n=(0,l.C)(e,t);if(1!==n.length)throw new Error("tensor1d() requires values to be a flat/TypedArray");return(0,Pn.H)(e,null,n,t)}function Wn(e,t,n){if((0,f.Cq)(e),null!=t&&2!==t.length)throw new Error("tensor2d() requires shape to have two numbers");var r=(0,l.C)(e,n);if(2!==r.length&&1!==r.length)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(1===r.length&&null==t)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return(0,Pn.H)(e,t,r,n)}var Vn=n(3123);function qn(e,t,n){if((0,f.Cq)(e),null!=t&&4!==t.length)throw new Error("tensor4d() requires shape to have four numbers");var r=(0,l.C)(e,n);if(4!==r.length&&1!==r.length)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(1===r.length&&null==t)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return(0,Pn.H)(e,t,r,n)}function Gn(e,t,n){if((0,f.Cq)(e),null!=t&&5!==t.length)throw new Error("tensor5d() requires shape to have five numbers");var r=(0,l.C)(e,n);if(5!==r.length&&1!==r.length)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(1===r.length&&null==t)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return(0,Pn.H)(e,t,r,n)}function Hn(e,t,n){if((0,f.Cq)(e),null!=t&&6!==t.length)throw new Error("tensor6d() requires shape to have six numbers");var r=(0,l.C)(e,n);if(6!==r.length&&1!==r.length)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(1===r.length&&null==t)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return t=t||r,(0,Pn.H)(e,t,r,n)}var Xn=n(8604);var Kn=(0,d.op)({tensorScatterUpdate_:function(e,t,n){var r=(0,l._1)(e,"tensor","tensorScatterupdate"),a=(0,l._1)(t,"indices","tensorScatterupdate","int32"),i=(0,l._1)(n,"updates","tensorScatterupdate");if(Xn.validateInput(i,a,r.shape),r.dtype!==i.dtype)throw new Error("tensor and updates must have the same dtype, instead they are ".concat(r.dtype," and ").concat(i.dtype,"."));var o={tensor:r,indices:a,updates:i};return s.BV.runKernel(c.SIB,o,{})}}),Yn=n(9085);var $n=(0,d.op)({truncatedNormal_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3?arguments[3]:void 0,a=arguments.length>4?arguments[4]:void 0;if((0,f.Mu)(e),null!=r&&"bool"===r)throw new Error("Unsupported data type $ { dtype }");for(var i=new Ut(t,n,r,!0,a),o=(0,V.f)(e,r),u=0;u<o.values.length;u++)o.values[u]=i.nextValue();return o.toTensor()}}),Qn=n(4860),Jn=n(6918),er=n(4566);function tr(e,t){return Je(e,t,"right")}function nr(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;return s.BV.makeVariable(e,t,n,r)}var rr=n(329),ar=n(4189);function ir(){return(ir=(0,dn.Z)(pn().mark((function e(t){var n,r,a;return pn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=(0,l._1)(t,"condition","whereAsync","bool"),e.next=3,n.data();case 3:return r=e.sent,a=(0,ar.Z)(n.shape,r),t!==n&&n.dispose(),e.abrupt("return",a);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var or=function(e){return ir.apply(this,arguments)},ur=n(7742),sr=n(7293);function cr(){return cr=(0,dn.Z)(pn().mark((function e(t,n,r){var a,i,o,u,s,c,d,h,p,v,m,g,y;return pn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(a=(0,l._1)(t,"tensor","boolMask"),i=(0,l._1)(n,"mask","boolMask","bool"),o=null==r?0:r,u=i.rank,s=a.shape,f.hu(u>0,(function(){return"mask cannot be scalar"})),f.k5(s.slice(o,o+u),i.shape,"mask's shape must match the first K dimensions of tensor's shape,"),c=1,d=o;d<o+u;d++)c*=s[d];return h=s.slice(0,o).concat([c],s.slice(o+u)),p=(0,A.X)(a,h),v=(0,A.X)(i,[-1]),e.next=14,or(v);case 14:return m=e.sent,g=(0,On.L)(m,[1]),y=(0,De.I)(p,g,o),t!==a&&a.dispose(),n!==i&&i.dispose(),g.dispose(),p.dispose(),v.dispose(),m.dispose(),e.abrupt("return",y);case 24:case"end":return e.stop()}}),e)}))),cr.apply(this,arguments)}var lr=function(e,t,n){return cr.apply(this,arguments)},fr=n(1240),dr=n(6662),hr=n(9064);var pr=(0,d.op)({movingAverage_:function(e,t,n,r){var a=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],i=(0,l._1)(e,"v","movingAverage"),o=(0,l._1)(t,"x","movingAverage"),s=(0,l._1)(n,"decay","movingAverage");(0,hr.assertTypesMatch)(i,o),f.hu(f.cO(i.shape,o.shape),(function(){return"Shape mismatch in v and x"}));var c=(0,cn.i)(1),d=(0,mt.l)(c,s),h=(0,I.d)((0,mt.l)(o,i),d);if(a){f.hu(null!=r,(function(){return"When using zeroDebias: true, step is required."}));var p=(0,l._1)(r,"step","movingAverage");h=(0,pe.h)(h,(0,mt.l)(c,(0,Dt.s)(s,p)))}return(0,u.I)(i,h)}});var vr=(0,d.op)({scatterND_:function(e,t,n){(0,f.Mu)(n);var r=(0,l._1)(e,"indices","scatterND","int32"),a=(0,l._1)(t,"updates","scatterND");Xn.validateInput(a,r,n);var i={indices:r,updates:a},o={shape:n};return s.BV.runKernel(c.xQA,i,o)}});function mr(e,t,n,r){if("int32"!==e.dtype)throw new Error("tf.sparseToDense() expects the indices to be int32 type,"+" but the dtype was ".concat(e.dtype,"."));if(e.rank>2)throw new Error("sparseIndices should be a scalar, vector, or matrix,"+" but got shape ".concat(e.shape,"."));var a=e.rank>0?e.shape[0]:1,i=e.rank>1?e.shape[1]:1;if(n.length!==i)throw new Error("outputShape has incorrect number of elements:,"+" ".concat(n.length,", should be: ").concat(i,"."));var o=t.size;if(0!==t.rank&&(1!==t.rank||o!==a))throw new Error("sparseValues has incorrect shape "+"".concat(t.shape,", should be [] or [").concat(a,"]"));if(t.dtype!==r.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")}var gr=(0,d.op)({sparseToDense_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;(0,f.Mu)(n);var a=(0,l._1)(e,"sparseIndices","sparseToDense","int32"),i=(0,l._1)(t,"sparseValues","sparseToDense","string_or_numeric"),o=(0,l._1)(r,"defaultValue","sparseToDense",i.dtype);mr(a,i,n,o);var u={sparseIndices:a,sparseValues:i,defaultValue:o},d={outputShape:n};return s.BV.runKernel(c.D2d,u,d)}});var yr=(0,d.op)({gatherND_:function(e,t){var n=(0,l._1)(t,"indices","gatherND","int32"),r={params:(0,l._1)(e,"x","gatherND","string_or_numeric"),indices:n};return s.BV.runKernel(c.q1x,r)}});var br=(0,d.op)({dropout_:function(e,t,n,r){var a=(0,l._1)(e,"x","dropout");if(f.hu("float32"===a.dtype,(function(){return"x has to be a floating point tensor since it's going to be "+"scaled, but got a ".concat(a.dtype," tensor instead.")})),f.hu(t>=0&&t<1,(function(){return"rate must be a float in the range [0, 1), but got ".concat(t,".")})),0===t)return e instanceof st.es?a.clone():a;var i=function(e,t){if(null==t)return e.shape.slice();if(f.cO(e.shape,t))return t;if(e.shape.length===t.length){for(var n=[],r=0;r<e.shape.length;r++)null==t[r]&&null!=e.shape[r]?n.push(e.shape[r]):n.push(t[r]);return n}return t}(a,n),o=1-t,s=(0,pe.h)((0,Te.G)((0,u.I)(Xt(i,0,1,"float32",r),o)),o);return(0,I.d)(a,s)}});function xr(e){return Math.floor(Math.pow(2,Math.ceil(Math.log(e)/Math.log(2))))}function wr(e,t,n){for(var r=1-e%2,a=new Float32Array(e),i=0;i<e;++i){var o=2*Math.PI*i/(e+r-1);a[i]=t-n*Math.cos(o)}return Un(a,"float32")}function kr(){return kr=(0,dn.Z)(pn().mark((function e(t,n){var r,a,i,o,u,s,c,d,h,p,v,m,g,y,b,x=arguments;return pn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=x.length>2&&void 0!==x[2]?x[2]:1,a=(0,l._1)(t,"predictions","inTopK"),i=(0,l._1)(n,"targets","inTopK"),(0,f.hu)(a.rank>1,(function(){return"inTopK() expects the predictions to be of rank 2 or higher, "+"but got ".concat(a.rank)})),(0,f.hu)(a.rank-1===i.rank,(function(){return"predictions rank should be 1 larger than targets rank, but got predictions rank "+"".concat(a.rank," and targets rank ").concat(i.rank)})),(0,f.k5)(a.shape.slice(0,a.shape.length-1),i.shape,"predictions's shape should be align with the targets' shape, except the last dimension."),o=a.shape[a.shape.length-1],(0,f.hu)(r>0&&r<=o,(function(){return"'k' passed to inTopK() must be > 0 && <= the predictions last "+"dimension (".concat(o,"), but got ").concat(r)})),e.next=10,a.data();case 10:return u=e.sent,e.next=13,i.data();case 13:s=e.sent,c=u.length/o,d=o,h=(0,f.WP)("bool",c),p=0;case 17:if(!(p<c)){e.next=35;break}for(v=p*d,m=u.subarray(v,v+d),g=[],y=0;y<m.length;y++)g.push({value:m[y],index:y});g.sort((function(e,t){return t.value-e.value})),h[p]=0,b=0;case 25:if(!(b<r)){e.next=32;break}if(g[b].index!==s[p]){e.next=29;break}return h[p]=1,e.abrupt("break",32);case 29:b++,e.next=25;break;case 32:p++,e.next=17;break;case 35:return t!==a&&a.dispose(),n!==i&&i.dispose(),e.abrupt("return",(0,Ln.X)(h,i.shape,"bool"));case 38:case"end":return e.stop()}}),e)}))),kr.apply(this,arguments)}var _r=function(e,t){return kr.apply(this,arguments)},Sr=n(9439),Cr=n(6450),Ar=n(5774),Er=n(8744),Nr=n(1045),Tr=n(5171);var Ir=(0,d.op)({fusedConv2d_:function(e){var t=e.x,n=e.filter,r=e.strides,a=e.pad,i=e.dataFormat,o=void 0===i?"NHWC":i,d=e.dilations,h=void 0===d?[1,1]:d,p=e.dimRoundingMode,v=e.bias,m=e.activation,g=void 0===m?"linear":m,y=e.preluActivationWeights,b=e.leakyreluAlpha;if(g=g||"linear",!1===(0,Tr.uy)(s.BV.state.gradientDepth,g)){f.hu("NHWC"===o,(function(){return"Error in fused conv2d: got dataFormat of ".concat(o," but ")+"only NHWC is currently supported for the case of gradient depth is 0 and the activation is not linear."}));var x=(0,ee.T)(t,n,r,a,o,h,p);return null!=v&&(x=(0,u.I)(x,v)),(0,Tr.QH)(x,g,y,b)}var w=(0,l._1)(t,"x","conv2d","float32"),k=(0,l._1)(n,"filter","conv2d","float32"),_=w,S=!1;3===w.rank&&(S=!0,_=(0,A.X)(w,[1,w.shape[0],w.shape[1],w.shape[2]])),f.hu(4===_.rank,(function(){return"Error in fused conv2d: input must be rank 4, but got rank "+"".concat(_.rank,".")})),f.hu(4===k.rank,(function(){return"Error in fused conv2d: filter must be rank 4, but got rank "+"".concat(k.rank,".")})),C.m("fused conv2d",a,p);var E="NHWC"===o?_.shape[3]:_.shape[1];f.hu(k.shape[2]===E,(function(){return"Error in conv2d: depth of input (".concat(E,") must match ")+"input depth for filter ".concat(k.shape[2],".")})),f.hu(C.jT(r,h),(function(){return"Error in conv2D: Either strides or dilations must be 1. "+"Got strides ".concat(r," and dilations '").concat(h,"'")}));var N,T,I=C.Ix(_.shape,k.shape,r,h,a,p);if(null!=v){N=(0,l._1)(v,"bias","fused conv2d");var D=(0,hr.makeTypesMatch)(N,w),F=(0,Sr.Z)(D,1);N=F[0],"NHWC"===o?Ar.assertAndGetBroadcastShape(I.outShape,N.shape):(f.hu(N.shape.length<=1,(function(){return"Error in fused conv2d: only supports scalar or 1-D Tensor bias for NCHW format but got the bias of "+"rank-".concat(N.shape.length,".")})),f.hu(0===N.shape.length||N.shape[0]===I.outChannels||1===N.shape[0],(function(){return"Error in fused conv2d: bias shape (".concat(N.shape,") is not ")+"compatible with the number of output channels "+"(".concat(I.outChannels,")")})))}if(null!=y){var M=y.shape;if(f.hu(M.length<=1||3===M.length,(function(){return"Error in fused conv2d: only supports scalar, 1-D Tensor or 3-D Tensor PReLU activation weights but got a tensor of "+"rank-".concat(M.length,".")})),1===M.length)f.hu(1===M[0]||M[0]===I.outChannels,(function(){return"Error in fused conv2d: PReLU activation weights "+"(".concat(M,") is not compatible with the number of output ")+"channels (".concat(I.outChannels,").")}));else if(3===M.length)try{Ar.assertAndGetBroadcastShape(M,I.outShape)}catch(L){var O="Error in fused conv2d: PReLU activation weights (".concat(M,") ")+"is not compatible with the output shape of the conv2d "+"(".concat(I.outShape,").");throw Error(O)}T=(0,l._1)(y,"prelu weights","fused conv2d")}var R=function(e,t){f.hu("NHWC"===o,(function(){return"Error in gradient of fused conv2D: got dataFormat of ".concat(o," but only NHWC is currently supported.")}));var n=(0,Sr.Z)(t,4),i=n[0],u=n[1],s=n[2],c=n[3],l=(0,Tr.Fr)(e,s,g);f.hu(C.I0(h),(function(){return"Error in gradient of fused conv2D: dilation rates greater than 1 "+"are not yet supported in gradients. Got dilations '".concat(h,"'")}));var d=[(0,Nr._)(u.shape,l,i,r,a),(0,Er.p)(u,l,i.shape,r,a)];if(null!=c){var p=(0,Tr.pf)(c,l);d.push(p)}return d},j={x:_,filter:k,bias:N,preluActivationWeights:T},B={strides:r,pad:a,dataFormat:o,dilations:h,dimRoundingMode:p,activation:g,leakyreluAlpha:b};if(null==v){var z=(0,Cr.cb)((function(e,t,n){var r=s.BV.runKernel(c._V0,j,B);return n([t,e,r]),S&&(r=(0,A.X)(r,[r.shape[1],r.shape[2],r.shape[3]])),{value:r,gradFunc:R}}));return z(_,k)}var Z=(0,Cr.cb)((function(e,t,n,r){var a=s.BV.runKernel(c._V0,j,B);return r([t,e,a,n]),S&&(a=(0,A.X)(a,[a.shape[1],a.shape[2],a.shape[3]])),{value:a,gradFunc:R}}));return Z(_,k,N)}}),Dr=n(288),Fr=n(6939);var Mr=(0,d.op)({fusedDepthwiseConv2d_:function(e){var t=e.x,n=e.filter,r=e.strides,a=e.pad,i=e.dataFormat,o=void 0===i?"NHWC":i,d=e.dilations,h=void 0===d?[1,1]:d,p=e.dimRoundingMode,v=e.bias,m=e.activation,g=void 0===m?"linear":m,y=e.preluActivationWeights,b=e.leakyreluAlpha;if(!1===(0,Tr.uy)(s.BV.state.gradientDepth,g)){var x=(0,fe.B)(t,n,r,a,o,h,p);return null!=v&&(x=(0,u.I)(x,v)),(0,Tr.QH)(x,g,y,b)}var w=(0,l._1)(t,"x","depthwiseConv2d","float32"),k=(0,l._1)(n,"filter","depthwiseConv2d","float32"),_=w,S=!1;3===w.rank&&(S=!0,_=(0,A.X)(w,[1,w.shape[0],w.shape[1],w.shape[2]])),f.hu(4===_.rank,(function(){return"Error in fused depthwiseConv2d: input must be rank 4, but got "+"rank ".concat(_.rank,".")})),f.hu(4===k.rank,(function(){return"Error in fused depthwiseConv2d: filter must be rank 4, "+"but got rank ".concat(k.rank,".")})),f.hu(_.shape[3]===k.shape[2],(function(){return"Error in fused depthwiseConv2d: number of input channels "+"(".concat(_.shape[3],") must match the inChannels dimension in ")+"filter ".concat(k.shape[2],".")})),null==h&&(h=[1,1]),f.hu(C.jT(r,h),(function(){return"Error in fused depthwiseConv2d: Either strides or dilations must "+"be 1. Got strides ".concat(r," and dilations '").concat(h,"'")})),C.m("fused depthwiseConv2d",a,p);var E,N,T=C.Ix(_.shape,k.shape,r,h,a,p,!0);if(null!=v){E=(0,l._1)(v,"bias","fused conv2d");var I=(0,hr.makeTypesMatch)(E,w),D=(0,Sr.Z)(I,1);E=D[0],Ar.assertAndGetBroadcastShape(T.outShape,E.shape)}null!=y&&(N=(0,l._1)(y,"prelu weights","fused depthwiseConv2d"));var F=function(e,t){f.hu(C.I0(h),(function(){return"Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations "+"'".concat(h,"'")}));var n=(0,Sr.Z)(t,4),i=n[0],o=n[1],u=n[2],s=n[3],c=(0,Tr.Fr)(e,u,g),l=(0,Fr.v)(o.shape,c,i,r,a,h,p),d=(0,Dr.z)(o,c,i.shape,r,a,h,p);return null!=s?[l,d,(0,Tr.pf)(E,c)]:[l,d]},M={x:_,filter:k,bias:E,preluActivationWeights:N},O={strides:r,pad:a,dataFormat:o,dilations:h,dimRoundingMode:p,activation:g,leakyreluAlpha:b};if(null==v){var R=(0,Cr.cb)((function(e,t,n){var r=s.BV.runKernel(c.luS,M,O);return n([t,e,r]),S&&(r=(0,A.X)(r,[r.shape[1],r.shape[2],r.shape[3]])),{value:r,gradFunc:F}}));return R(_,k)}var j=(0,Cr.cb)((function(e,t,n,r){var a=s.BV.runKernel(c.luS,M,O);return r([t,e,a,n]),S&&(a=(0,A.X)(a,[a.shape[1],a.shape[2],a.shape[3]])),{value:a,gradFunc:F}}));return j(_,k,E)}});var Or=(0,d.op)({fusedMatMul_:function(e){var t=e.a,n=e.b,r=e.transposeA,a=void 0!==r&&r,i=e.transposeB,o=void 0!==i&&i,d=e.bias,h=e.activation,p=void 0===h?"linear":h,v=e.preluActivationWeights,m=e.leakyreluAlpha,g=void 0===m?.2:m;if(!1===(0,Tr.uy)(s.BV.state.gradientDepth,p)){var y=(0,T.O)(t,n,a,o);return null!=d&&(y=(0,u.I)(y,d)),(0,Tr.QH)(y,p,v,g)}var b=(0,l._1)(t,"a","fused matMul"),x=(0,l._1)(n,"b","fused matMul"),w=(0,hr.makeTypesMatch)(b,x),k=(0,Sr.Z)(w,2);b=k[0],x=k[1];var _=a?b.shape[b.rank-2]:b.shape[b.rank-1],S=o?x.shape[x.rank-1]:x.shape[x.rank-2],C=a?b.shape[b.rank-1]:b.shape[b.rank-2],E=o?x.shape[x.rank-2]:x.shape[x.rank-1],N=b.shape.slice(0,-2),I=x.shape.slice(0,-2),D=f.NA(N),F=f.NA(I);f.hu(_===S,(function(){return"Error in fused matMul: inner shapes (".concat(_,") and (")+"".concat(S,") of Tensors with shapes ").concat(b.shape," and ")+"".concat(x.shape," and transposeA=").concat(a)+" and transposeB=".concat(o," must match.")}));var M,O,R=Ar.assertAndGetBroadcastShape(b.shape.slice(0,-2),x.shape.slice(0,-2)).concat([C,E]),j=a?(0,A.X)(b,[D,_,C]):(0,A.X)(b,[D,C,_]),B=o?(0,A.X)(x,[F,E,S]):(0,A.X)(x,[F,S,E]);if(null!=d){M=(0,l._1)(d,"bias","fused matMul");var z=(0,hr.makeTypesMatch)(M,b);M=(0,Sr.Z)(z,1)[0],Ar.assertAndGetBroadcastShape(R,M.shape)}null!=v&&(O=(0,l._1)(v,"prelu weights","fused matMul"));var Z=function(e,t){var n,r,i=(0,Sr.Z)(t,4),u=i[0],s=i[1],c=i[2],l=i[3],f=(0,Tr.Fr)((0,A.X)(e,c.shape),c,p);return a||o?!a&&o?(n=(0,T.O)(f,s,!1,!1),r=(0,T.O)(f,u,!0,!1)):a&&!o?(n=(0,T.O)(s,f,!1,!0),r=(0,T.O)(u,f,!1,!1)):(n=(0,T.O)(s,f,!0,!0),r=(0,T.O)(f,u,!0,!0)):(n=(0,T.O)(f,s,!1,!0),r=(0,T.O)(u,f,!0,!1)),null!=d?[n,r,(0,Tr.pf)(l,f)]:[n,r]},L={a:j,b:B,bias:M,preluActivationWeights:O},P={transposeA:a,transposeB:o,activation:p,leakyreluAlpha:g};if(null==d){var U=(0,Cr.cb)((function(e,t,n){var r=s.BV.runKernel(c.usg,L,P);return n([e,t,r]),{value:(0,A.X)(r,R),gradFunc:Z}}));return U(j,B)}var W=(0,Cr.cb)((function(e,t,n,r){var a=s.BV.runKernel(c.usg,L,P);return r([e,t,a,n]),{value:(0,A.X)(a,R),gradFunc:Z}}));return W(j,B,M)}});var Rr=(0,d.op)({hammingWindow_:function(e){return wr(e,.54,.46)}});var jr=(0,d.op)({hannWindow_:function(e){return wr(e,.5,.5)}});var Br=(0,d.op)({frame_:function(e,t,n){for(var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,i=0,o=[];i+t<=e.size;)o.push((0,F.t)(e,i,t)),i+=n;if(r)for(;i<e.size;){var u=i+t-e.size,s=(0,N.z)([(0,F.t)(e,i,t-u),(0,Ne.h)([u],a)]);o.push(s),i+=n}return 0===o.length?Wn([],[0,t]):(0,A.X)((0,N.z)(o),[o.length,t])}});var zr=(0,d.op)({stft_:function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:jr;null==r&&(r=xr(t));var i=Br(e,t,n),o=(0,I.d)(i,a(t));return(0,In.Q)(o,r)}});var Zr=(0,d.op)({cropAndResize_:function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"bilinear",i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,o=(0,l._1)(e,"image","cropAndResize"),u=(0,l._1)(t,"boxes","cropAndResize","float32"),d=(0,l._1)(n,"boxInd","cropAndResize","int32"),h=u.shape[0];f.hu(4===o.rank,(function(){return"Error in cropAndResize: image must be rank 4,"+"but got rank ".concat(o.rank,".")})),f.hu(2===u.rank&&4===u.shape[1],(function(){return"Error in cropAndResize: boxes must be have size [".concat(h,",4] ")+"but had shape ".concat(u.shape,".")})),f.hu(1===d.rank&&d.shape[0]===h,(function(){return"Error in cropAndResize: boxInd must be have size [".concat(h,"] ")+"but had shape ".concat(u.shape,".")})),f.hu(2===r.length,(function(){return"Error in cropAndResize: cropSize must be of length 2, but got "+"length ".concat(r.length,".")})),f.hu(r[0]>=1&&r[1]>=1,(function(){return"cropSize must be atleast [1,1], but was ".concat(r)})),f.hu("bilinear"===a||"nearest"===a,(function(){return"method must be bilinear or nearest, but was ".concat(a)}));var p={image:o,boxes:u,boxInd:d},v={method:a,extrapolationValue:i,cropSize:r},m=s.BV.runKernel(c.VcC,p,v);return m}});var Lr=(0,d.op)({flipLeftRight_:function(e){var t=(0,l._1)(e,"image","flipLeftRight","float32");f.hu(4===t.rank,(function(){return"Error in flipLeftRight: image must be rank 4,"+"but got rank ".concat(t.rank,".")}));var n={image:t};return s.BV.runKernel(c.Uyb,n,{})}});var Pr=(0,d.op)({grayscaleToRGB_:function(e){var t=(0,l._1)(e,"image","grayscaleToRGB"),n=t.rank-1,r=t.shape[n];f.hu(t.rank>=2,(function(){return"Error in grayscaleToRGB: images must be at least rank 2, "+"but got rank ".concat(t.rank,".")})),f.hu(1===r,(function(){return"Error in grayscaleToRGB: last dimension of a grayscale image "+"should be size 1, but got size ".concat(r,".")}));var a=new Array(t.rank);return a.fill(1,0,n),a[n]=3,(0,Ae.G)(t,a)}});var Ur=(0,d.op)({rgbToGrayscale_:function(e){var t=(0,l._1)(e,"image","RGBToGrayscale"),n=t.rank-1,r=t.shape[n];f.hu(t.rank>=2,(function(){return"Error in RGBToGrayscale: images must be at least rank 2, "+"but got rank ".concat(t.rank,".")})),f.hu(3===r,(function(){return"Error in RGBToGrayscale: last dimension of an RGB image "+"should be size 3, but got size ".concat(r,".")}));var a,i=t.dtype,o=(0,S.p)(t,"float32"),u=Un([.2989,.587,.114]);switch(t.rank){case 2:a=ge("ij,j->i",o,u);break;case 3:a=ge("ijk,k->ij",o,u);break;case 4:a=ge("ijkl,l->ijk",o,u);break;case 5:a=ge("ijklm,m->ijkl",o,u);break;case 6:a=ge("ijklmn,n->ijklm",o,u);break;default:throw new Error("Not a valid tensor rank.")}return a=(0,Se.d)(a,-1),(0,S.p)(a,i)}});var Wr=(0,d.op)({rotateWithOffset_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,a=(0,l._1)(e,"image","rotateWithOffset","float32");f.hu(4===a.rank,(function(){return"Error in rotateWithOffset: image must be rank 4,"+"but got rank ".concat(a.rank,".")}));var i={image:a},o={radians:t,fillValue:n,center:r},u=s.BV.runKernel(c.b9H,i,o);return u}});function Vr(e,t,n,r,a,i){null==r&&(r=.5),null==a&&(a=Number.NEGATIVE_INFINITY),null==i&&(i=0);var o=e.shape[0];return n=Math.min(n,o),f.hu(0<=r&&r<=1,(function(){return"iouThreshold must be in [0, 1], but was '".concat(r,"'")})),f.hu(2===e.rank,(function(){return"boxes must be a 2D tensor, but was of rank '".concat(e.rank,"'")})),f.hu(4===e.shape[1],(function(){return"boxes must have 4 columns, but 2nd dimension was ".concat(e.shape[1])})),f.hu(1===t.rank,(function(){return"scores must be a 1D tensor"})),f.hu(t.shape[0]===o,(function(){return"scores has incompatible shape with boxes. Expected ".concat(o,", ")+"but was ".concat(t.shape[0])})),f.hu(0<=i&&i<=1,(function(){return"softNmsSigma must be in [0, 1], but was '".concat(i,"'")})),{maxOutputSize:n,iouThreshold:r,scoreThreshold:a,softNmsSigma:i}}var qr=(0,d.op)({nonMaxSuppression_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Number.NEGATIVE_INFINITY,i=(0,l._1)(e,"boxes","nonMaxSuppression","float32"),o=(0,l._1)(t,"scores","nonMaxSuppression","float32"),u=Vr(i,o,n,r,a),f={maxOutputSize:n=u.maxOutputSize,iouThreshold:r=u.iouThreshold,scoreThreshold:a=u.scoreThreshold};return s.BV.runKernel(c.uv1,{boxes:i,scores:o},f)}}),Gr=n(745);function Hr(){return Hr=(0,dn.Z)(pn().mark((function e(t,n,r){var a,i,o,u,s,c,f,d,h,p,v=arguments;return pn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=v.length>3&&void 0!==v[3]?v[3]:.5,i=v.length>4&&void 0!==v[4]?v[4]:Number.NEGATIVE_INFINITY,o=(0,l._1)(t,"boxes","nonMaxSuppressionAsync"),u=(0,l._1)(n,"scores","nonMaxSuppressionAsync"),s=Vr(o,u,r,a,i),r=s.maxOutputSize,a=s.iouThreshold,i=s.scoreThreshold,e.next=10,Promise.all([o.data(),u.data()]);case 10:return c=e.sent,f=c[0],d=c[1],h=(0,Gr.GP)(f,d,r,a,i),p=h.selectedIndices,o!==t&&o.dispose(),u!==n&&u.dispose(),e.abrupt("return",Un(p,"int32"));case 17:case"end":return e.stop()}}),e)}))),Hr.apply(this,arguments)}var Xr=function(e,t,n){return Hr.apply(this,arguments)};var Kr=(0,d.op)({nonMaxSuppressionWithScore_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Number.NEGATIVE_INFINITY,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,o=(0,l._1)(e,"boxes","nonMaxSuppression"),u=(0,l._1)(t,"scores","nonMaxSuppression"),f=Vr(o,u,n,r,a,i),d={boxes:o,scores:u},h={maxOutputSize:n=f.maxOutputSize,iouThreshold:r=f.iouThreshold,scoreThreshold:a=f.scoreThreshold,softNmsSigma:i=f.softNmsSigma},p=s.BV.runKernel(c.W0H,d,h);return{selectedIndices:p[0],selectedScores:p[1]}}});function Yr(){return Yr=(0,dn.Z)(pn().mark((function e(t,n,r){var a,i,o,u,s,c,f,d,h,p,v,m,g=arguments;return pn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=g.length>3&&void 0!==g[3]?g[3]:.5,i=g.length>4&&void 0!==g[4]?g[4]:Number.NEGATIVE_INFINITY,o=g.length>5&&void 0!==g[5]?g[5]:0,u=(0,l._1)(t,"boxes","nonMaxSuppressionAsync"),s=(0,l._1)(n,"scores","nonMaxSuppressionAsync"),c=Vr(u,s,r,a,i,o),r=c.maxOutputSize,a=c.iouThreshold,i=c.scoreThreshold,o=c.softNmsSigma,e.next=12,Promise.all([u.data(),s.data()]);case 12:return f=e.sent,d=f[0],h=f[1],p=(0,Gr.pA)(d,h,r,a,i,o),v=p.selectedIndices,m=p.selectedScores,u!==t&&u.dispose(),s!==n&&s.dispose(),e.abrupt("return",{selectedIndices:Un(v,"int32"),selectedScores:Un(m)});case 19:case"end":return e.stop()}}),e)}))),Yr.apply(this,arguments)}var $r=function(e,t,n){return Yr.apply(this,arguments)};var Qr=(0,d.op)({nonMaxSuppressionPadded_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Number.NEGATIVE_INFINITY,i=arguments.length>5&&void 0!==arguments[5]&&arguments[5],o=(0,l._1)(e,"boxes","nonMaxSuppression"),u=(0,l._1)(t,"scores","nonMaxSuppression"),f=Vr(o,u,n,r,a,null),d=f.maxOutputSize,h=f.iouThreshold,p=f.scoreThreshold,v={boxes:o,scores:u},m={maxOutputSize:d,iouThreshold:h,scoreThreshold:p,padToMaxOutputSize:i},g=s.BV.runKernel(c.cye,v,m);return{selectedIndices:g[0],validOutputs:g[1]}}});function Jr(){return Jr=(0,dn.Z)(pn().mark((function e(t,n,r){var a,i,o,u,s,c,f,d,h,p,v,m,g,y,b,x,w=arguments;return pn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=w.length>3&&void 0!==w[3]?w[3]:.5,i=w.length>4&&void 0!==w[4]?w[4]:Number.NEGATIVE_INFINITY,o=w.length>5&&void 0!==w[5]&&w[5],u=(0,l._1)(t,"boxes","nonMaxSuppressionAsync"),s=(0,l._1)(n,"scores","nonMaxSuppressionAsync"),c=Vr(u,s,r,a,i,null),f=c.maxOutputSize,d=c.iouThreshold,h=c.scoreThreshold,e.next=11,Promise.all([u.data(),s.data()]);case 11:return p=e.sent,v=(0,Sr.Z)(p,2),m=v[0],g=v[1],y=(0,Gr.qP)(m,g,f,d,h,o),b=y.selectedIndices,x=y.validOutputs,u!==t&&u.dispose(),s!==n&&s.dispose(),e.abrupt("return",{selectedIndices:Un(b,"int32"),validOutputs:(0,cn.i)(x,"int32")});case 19:case"end":return e.stop()}}),e)}))),Jr.apply(this,arguments)}var ea=function(e,t,n){return Jr.apply(this,arguments)},ta=n(464),na=n(8600);function ra(e,t){for(var n,r,a,i,o,s,c=Un([-1]),l=Un([0]),f=Un([0]),d=0;d<e.size-1;d++){n=(0,F.t)(e,0,d+1),r=(0,F.t)(e,d+1),o=(0,pe.h)((0,zn.S)(n),t),s=(0,pe.h)((0,zn.S)(r),t);var h=(0,zn.S)((0,I.d)(n,Yt(0,n.size)));a=(0,pe.h)(h,(0,zn.S)(n));var p=(0,Ne.h)(r.shape,n.size),v=(0,u.I)(Yt(0,r.size),p),m=(0,I.d)(r,v);i=(0,pe.h)((0,zn.S)(m),(0,zn.S)(r));var g=(0,mt.l)(a,i),y=(0,mt.l)(a,i),b=(0,I.d)(o,s);f=(0,I.d)((0,I.d)(b,g),y);var x=(0,Fe.p)(f,l);l=(0,rr.a)(x,f,l),c=(0,rr.a)(x,Un([d]),c)}return c}var aa=(0,d.op)({threshold_:function(e){var t,n,r,a,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"binary",o=arguments.length>2&&void 0!==arguments[2]&&arguments[2],s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,c=(0,l._1)(e,"image","threshold"),d=.2989,h=.587,p=.114,v=c.shape[0]*c.shape[1],m=(0,I.d)(Un([s]),255);if(f.hu(3===c.rank,(function(){return"Error in threshold: image must be rank 3,"+"but got rank ".concat(c.rank,".")})),f.hu(3===c.shape[2]||1===c.shape[2],(function(){return"Error in threshold: image color channel must be equal to 3 or 1"+"but got ".concat(c.shape[2],".")})),f.hu("int32"===c.dtype||"float32"===c.dtype,(function(){return"Error in dtype: image dtype must be int32 or float32,"+"but got dtype ".concat(c.dtype,".")})),f.hu("otsu"===i||"binary"===i,(function(){return"Method must be binary or otsu, but was ".concat(i)})),3===c.shape[2]){var g=(0,Dn.V)(c,[1,1,1],-1),y=(0,Sr.Z)(g,3);t=y[0],n=y[1],r=y[2];var b=(0,I.d)(t,d),x=(0,I.d)(n,h),w=(0,I.d)(r,p);a=(0,u.I)((0,u.I)(b,x),w)}else a=e;if("otsu"===i){var k=L((0,S.p)((0,un.N)(a),"int32"),(0,Ln.X)([]),256);m=ra(k,v)}var _=o?(0,Le.z)(a,m):(0,Fe.p)(a,m),C=(0,S.p)((0,I.d)(_,255),"int32");return C}});var ia=(0,d.op)({transform_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"nearest",r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"constant",a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,i=arguments.length>5?arguments[5]:void 0,o=(0,l._1)(e,"image","transform","float32"),u=(0,l._1)(t,"transforms","transform","float32");f.hu(4===o.rank,(function(){return"Error in transform: image must be rank 4,"+"but got rank ".concat(o.rank,".")})),f.hu(2===u.rank&&(u.shape[0]===o.shape[0]||1===u.shape[0])&&8===u.shape[1],(function(){return"Error in transform: Input transform should be batch x 8 or 1 x 8"})),f.hu(null==i||2===i.length,(function(){return"Error in transform: outputShape must be [height, width] or null, "+"but got ".concat(i,".")}));var d={image:o,transforms:u},h={interpolation:n,fillMode:r,fillValue:a,outputShape:i};return s.BV.runKernel(c.wx7,d,h)}});var oa=(0,d.op)({bandPart_:function(e,t,n){var r=(0,l._1)(e,"a","bandPart");(0,f.hu)(r.rank>=2,(function(){return"bandPart(): Rank must be at least 2, got ".concat(r.rank,".")}));var a,i,o=r.shape,u=r.shape.slice(-2),s=(0,Sr.Z)(u,2),c=s[0],d=s[1];"number"===typeof t?((0,f.hu)(t%1===0,(function(){return"bandPart(): numLower must be an integer, got ".concat(t,".")})),(0,f.hu)(t<=c,(function(){return"bandPart(): numLower (".concat(t,")")+" must not be greater than the number of rows (".concat(c,").")})),a=(0,l._1)(t<0?c:t,"numLower","bandPart")):((0,f.hu)("int32"===t.dtype,(function(){return"bandPart(): numLower's dtype must be an int32."})),a=(0,rr.a)((0,Ze.d)(t,0),c,(0,ft.L)(t,c))),"number"===typeof n?((0,f.hu)(n%1===0,(function(){return"bandPart(): numUpper must be an integer, got ".concat(n,".")})),(0,f.hu)(n<=d,(function(){return"bandPart(): numUpper (".concat(n,")")+" must not be greater than the number of columns (".concat(d,").")})),i=(0,l._1)(n<0?d:n,"numUpper","bandPart")):((0,f.hu)("int32"===n.dtype,(function(){return"bandPart(): numUpper's dtype must be an int32."})),i=(0,rr.a)((0,Ze.d)(n,0),d,(0,ft.L)(n,d)));var h=(0,A.X)(Yt(0,c,1,"int32"),[-1,1]),p=Yt(0,d,1,"int32"),v=(0,mt.l)(h,p),m=(0,Xe.H)((0,Le.z)(v,a),(0,Me.b)(v,(0,xt.W)(i))),g=(0,ur.l)([c,d],r.dtype);return(0,A.X)((0,Rn.k)((0,er.H)((0,A.X)(r,[-1,c,d])).map((function(e){return(0,rr.a)(m,e,g)}))),o)}});var ua=(0,d.op)({gramSchmidt_:function(e){var t;Array.isArray(e)?function(){t=!1,(0,f.hu)(null!=e&&e.length>0,(function(){return"Gram-Schmidt process: input must not be null, undefined, or empty"}));for(var n=e[0].shape[0],r=function(t){(0,f.hu)(e[t].shape[0]===n,(function(){return"Gram-Schmidt: Non-unique lengths found in the input vectors: "+"(".concat(e[t].shape[0]," vs. ").concat(n,")")}))},a=1;a<e.length;++a)r(a)}():(t=!0,e=(0,Dn.V)(e,e.shape[0],0).map((function(e){return(0,On.L)(e,[0])}))),(0,f.hu)(e.length<=e[0].shape[0],(function(){return"Gram-Schmidt: Number of vectors (".concat(e.length,") exceeds ")+"number of dimensions (".concat(e[0].shape[0],").")}));for(var n=[],r=e,a=function(e){n.push(s.BV.tidy((function(){var t=r[e];if(e>0)for(var a=0;a<e;++a){var i=(0,I.d)((0,zn.S)((0,I.d)(n[a],t)),n[a]);t=(0,mt.l)(t,i)}return(0,pe.h)(t,(0,dr.K)(t,"euclidean"))})))},i=0;i<e.length;++i)a(i);return t?(0,Rn.k)(n,0):n}}),sa=n(5875);function ca(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return s.BV.tidy((function(){(0,f.hu)(2===e.shape.length,(function(){return"qr2d() requires a 2D Tensor, but got a ".concat(e.shape.length,"D Tensor.")}));for(var n=e.shape[0],r=e.shape[1],a=Ee(n),i=(0,H.d)(e),o=Wn([[1]],[1,1]),u=(0,H.d)(o),c=n>=r?r:n,l=function(e){var t=i,c=u,l=a,f=s.BV.tidy((function(){var t=(0,F.t)(i,[e,e],[n-e,1]),s=(0,dr.K)(t),c=(0,F.t)(i,[e,e],[1,1]),l=(0,rr.a)((0,Fe.p)(c,0),Wn([[-1]]),Wn([[1]])),f=(0,mt.l)(c,(0,I.d)(l,s)),d=(0,pe.h)(t,f);u=1===d.shape[0]?(0,H.d)(o):(0,N.z)([o,(0,F.t)(d,[1,0],[d.shape[0]-1,d.shape[1]])],0);var h=(0,xt.W)((0,pe.h)((0,T.O)(l,f),s)),p=(0,F.t)(i,[e,0],[n-e,r]),v=(0,I.d)(h,u),m=(0,fr.p)(u);if(0===e)i=(0,mt.l)(p,(0,T.O)(v,(0,T.O)(m,p)));else{var g=(0,mt.l)(p,(0,T.O)(v,(0,T.O)(m,p)));i=(0,N.z)([(0,F.t)(i,[0,0],[e,r]),g],0)}var y=(0,fr.p)(v),b=(0,F.t)(a,[0,e],[n,a.shape[1]-e]);if(0===e)a=(0,mt.l)(b,(0,T.O)((0,T.O)(b,u),y));else{var x=(0,mt.l)(b,(0,T.O)((0,T.O)(b,u),y));a=(0,N.z)([(0,F.t)(a,[0,0],[n,e]),x],1)}return[u,i,a]})),d=(0,Sr.Z)(f,3);u=d[0],i=d[1],a=d[2],(0,sa.B9)([t,c,l])},d=0;d<c;++d)l(d);return!t&&n>r&&(a=(0,F.t)(a,[0,0],[n,r]),i=(0,F.t)(i,[0,0],[r,r])),[a,i]}))}var la=(0,d.op)({qr_:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if((0,f.hu)(e.rank>=2,(function(){return"qr() requires input tensor to have a rank >= 2, but got rank ".concat(e.rank)})),2===e.rank)return ca(e,t);var n=e.shape.slice(0,e.shape.length-2).reduce((function(e,t){return e*t})),r=(0,er.H)((0,A.X)(e,[n,e.shape[e.shape.length-2],e.shape[e.shape.length-1]]),0),a=[],i=[];r.forEach((function(e){var n=ca(e,t),r=(0,Sr.Z)(n,2),o=r[0],u=r[1];a.push(o),i.push(u)}));var o=(0,A.X)((0,Rn.k)(a,0),e.shape),u=(0,A.X)((0,Rn.k)(i,0),e.shape);return[o,u]}}),fa=n(7627);var da=(0,d.op)({computeWeightedLoss_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:fa.I.SUM_BY_NONZERO_WEIGHTS,r=(0,l._1)(e,"losses","computeWeightedLoss"),a=null;null!=t&&(a=(0,l._1)(t,"weights","computeWeightedLoss"));var i=null==a?r:(0,I.d)(r,a);if(n===fa.I.NONE)return i;if(n===fa.I.SUM)return(0,zn.S)(i);if(n===fa.I.MEAN){if(null==a)return(0,ot.J)(i);var o=r.size/a.size,u=(0,pe.h)((0,zn.S)(i),(0,zn.S)(a));return o>1?(0,pe.h)(u,(0,cn.i)(o)):u}if(n===fa.I.SUM_BY_NONZERO_WEIGHTS){if(null==a)return(0,pe.h)((0,zn.S)(i),(0,cn.i)(r.size));var s=(0,I.d)(a,(0,ut.i)(r.shape)),c=(0,S.p)((0,zn.S)((0,wt.Q)(s,(0,cn.i)(0))),"float32");return(0,pe.h)((0,zn.S)(i),c)}throw Error("Unknown reduction: ".concat(n))}});var ha=(0,d.op)({absoluteDifference_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:fa.I.SUM_BY_NONZERO_WEIGHTS,i=(0,l._1)(e,"labels","absoluteDifference"),o=(0,l._1)(t,"predictions","absoluteDifference"),u=null;null!=n&&(u=(0,l._1)(n,"weights","absoluteDifference")),(0,f.k5)(i.shape,o.shape,"Error in absoluteDifference: ");var s=(0,a.W)((0,mt.l)(i,o));return da(s,u,r)}});var pa=(0,d.op)({cosineDistance_:function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:fa.I.SUM_BY_NONZERO_WEIGHTS,i=(0,l._1)(e,"labels","cosineDistance"),o=(0,l._1)(t,"predictions","cosineDistance"),u=null;null!=r&&(u=(0,l._1)(r,"weights","cosineDistance")),(0,f.k5)(i.shape,o.shape,"Error in cosineDistance: ");var s=(0,cn.i)(1),c=(0,mt.l)(s,(0,zn.S)((0,I.d)(i,o),n,!0));return da(c,u,a)}});var va=(0,d.op)({hingeLoss_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:fa.I.SUM_BY_NONZERO_WEIGHTS,a=(0,l._1)(e,"labels","hingeLoss"),i=(0,l._1)(t,"predictions","hingeLoss"),o=null;null!=n&&(o=(0,l._1)(n,"weights","hingeLoss")),(0,f.k5)(a.shape,i.shape,"Error in hingeLoss: ");var u=(0,cn.i)(1);a=(0,mt.l)((0,I.d)((0,cn.i)(2),a),u);var s=(0,Jt.U)((0,mt.l)(u,(0,I.d)(a,i)));return da(s,o,r)}});var ma=(0,d.op)({huberLoss_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:fa.I.SUM_BY_NONZERO_WEIGHTS,o=(0,l._1)(e,"labels","huberLoss"),s=(0,l._1)(t,"predictions","huberLoss"),c=null;null!=n&&(c=(0,l._1)(n,"weights","huberLoss")),(0,f.k5)(o.shape,s.shape,"Error in huberLoss: ");var d=(0,cn.i)(r),h=(0,a.W)((0,mt.l)(s,o)),p=(0,ft.L)(h,d),v=(0,mt.l)(h,p),m=(0,u.I)((0,I.d)((0,cn.i)(.5),(0,vt.h)(p)),(0,I.d)(d,v));return da(m,c,i)}});var ga=(0,d.op)({logLoss_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1e-7,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:fa.I.SUM_BY_NONZERO_WEIGHTS,i=(0,l._1)(e,"labels","logLoss"),o=(0,l._1)(t,"predictions","logLoss"),s=null;null!=n&&(s=(0,l._1)(n,"weights","logLoss")),(0,f.k5)(i.shape,o.shape,"Error in logLoss: ");var c=(0,cn.i)(1),d=(0,cn.i)(r),h=(0,xt.W)((0,I.d)(i,(0,We.c)((0,u.I)(o,d)))),p=(0,I.d)((0,mt.l)(c,i),(0,We.c)((0,u.I)((0,mt.l)(c,o),d))),v=(0,mt.l)(h,p);return da(v,s,a)}});var ya=(0,d.op)({meanSquaredError_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:fa.I.SUM_BY_NONZERO_WEIGHTS,a=(0,l._1)(e,"labels","meanSquaredError"),i=(0,l._1)(t,"predictions","meanSquaredError"),o=null;null!=n&&(o=(0,l._1)(n,"weights","meanSquaredError")),(0,f.k5)(a.shape,i.shape,"Error in meanSquaredError: ");var u=(0,Mn.$)(a,i);return da(u,o,r)}});function ba(e,t){var n=(0,l._1)(e,"labels","sigmoidCrossEntropyWithLogits"),r=(0,l._1)(t,"logits","sigmoidCrossEntropyWithLogits");(0,f.k5)(n.shape,r.shape,"Error in sigmoidCrossEntropyWithLogits: ");var i=(0,Jt.U)(r),o=(0,I.d)(r,n),s=(0,Ve.K)((0,_e.Q)((0,xt.W)((0,a.W)(r))));return(0,u.I)((0,mt.l)(i,o),s)}var xa=(0,d.op)({sigmoidCrossEntropy_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:fa.I.SUM_BY_NONZERO_WEIGHTS,i=(0,l._1)(e,"multiClassLabels","sigmoidCrossEntropy"),o=(0,l._1)(t,"logits","sigmoidCrossEntropy"),s=null;if(null!=n&&(s=(0,l._1)(n,"weights","sigmoidCrossEntropy")),(0,f.k5)(i.shape,o.shape,"Error in sigmoidCrossEntropy: "),r>0){var c=(0,cn.i)(r),d=(0,cn.i)(1),h=(0,cn.i)(.5);i=(0,u.I)((0,I.d)(i,(0,mt.l)(d,c)),(0,I.d)(h,c))}var p=ba(i,o);return da(p,s,a)}});function wa(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;if(-1===n&&(n=t.rank-1),n!==t.rank-1)throw Error("Softmax cross entropy along a non-last dimension is not yet "+"supported. Labels / logits was rank ".concat(t.rank," ")+"and dim was ".concat(n));var r=(0,Cr.cb)((function(e,t,r){var a=(0,He.l)(t,[n],!0),i=(0,mt.l)((0,S.p)(t,"float32"),a);r([e,i]);var o=(0,xt.W)((0,I.d)(i,e));return{value:(0,zn.S)(o,[n]),gradFunc:function(e,t){var r=(0,Sr.Z)(t,2),a=r[0],i=r[1],o=(0,pt.rv)(e.shape,[n]);return[(0,I.d)((0,A.X)(e,o),(0,mt.l)((0,S.p)(a,"float32"),(0,_e.Q)(i))),(0,I.d)((0,A.X)(e,o),(0,mt.l)((0,_e.Q)(i),(0,S.p)(a,"float32")))]}}}));return r(e,t)}var ka=(0,d.op)({softmaxCrossEntropy_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:fa.I.SUM_BY_NONZERO_WEIGHTS,i=(0,l._1)(e,"onehotLabels","softmaxCrossEntropy"),o=(0,l._1)(t,"logits","softmaxCrossEntropy"),s=null;if(null!=n&&(s=(0,l._1)(n,"weights","softmaxCrossEntropy")),(0,f.k5)(i.shape,o.shape,"Error in softmaxCrossEntropy: "),r>0){var c=(0,cn.i)(r),d=(0,cn.i)(1),h=(0,cn.i)(i.shape[1]);i=(0,u.I)((0,I.d)(i,(0,mt.l)(d,c)),(0,pe.h)(c,h))}var p=wa(i,o);return da(p,s,a)}});var _a=(0,d.op)({sparseFillEmptyRows_:function(e,t,n,r){var a=(0,l._1)(e,"indices","sparseFillEmptyRows","int32"),i=(0,l._1)(t,"values","sparseFillEmptyRows"),o=(0,l._1)(n,"denseShape","sparseFillEmptyRows","int32"),u=(0,l._1)(r,"defaultValue","sparseFillEmptyRows",i.dtype);if(2!==a.rank)throw new Error("Indices should be Tensor2D but received shape\n        ".concat(a.shape));if(1!==i.rank)throw new Error("Values should be Tensor1D but received shape ".concat(i.shape));if(1!==o.rank)throw new Error("Dense shape should be Tensor1D but received shape ".concat(o.shape));if(0!==u.rank)throw new Error("Default value should be a scalar but received shape ".concat(u.shape));var f={indices:a,values:i,denseShape:o,defaultValue:u},d=s.BV.runKernel(c.O3z,f);return{outputIndices:d[0],outputValues:d[1],emptyRowIndicator:d[2],reverseIndexMap:d[3]}}});var Sa=(0,d.op)({sparseReshape_:function(e,t,n){var r=(0,l._1)(e,"inputIndices","sparseReshape","int32"),a=(0,l._1)(t,"inputShape","sparseReshape","int32"),i=(0,l._1)(n,"newShape","sparseReshape","int32");if(2!==r.rank)throw new Error("Input indices should be Tensor2D but received shape\n        ".concat(r.shape));if(1!==a.rank)throw new Error("Input shape should be Tensor1D but received shape ".concat(a.shape));if(1!==i.rank)throw new Error("New shape should be Tensor1D but received shape ".concat(i.shape));var o={inputIndices:r,inputShape:a,newShape:i},u=s.BV.runKernel(c.nhH,o);return{outputIndices:u[0],outputShape:u[1]}}});var Ca=(0,d.op)({sparseSegmentMean_:function(e,t,n){var r=(0,l._1)(e,"data","sparseSegmentMean"),a=(0,l._1)(t,"indices","sparseSegmentMean","int32"),i=(0,l._1)(n,"segmentIds","sparseSegmentMean","int32");if(r.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==a.rank)throw new Error("Indices should be Tensor1D but received shape\n          ".concat(a.shape));if(1!==i.rank)throw new Error("Segment ids should be Tensor1D but received shape\n          ".concat(i.shape));var o={data:r,indices:a,segmentIds:i};return s.BV.runKernel(c.w3H,o)}});var Aa=(0,d.op)({sparseSegmentSum_:function(e,t,n){var r=(0,l._1)(e,"data","sparseSegmentSum"),a=(0,l._1)(t,"indices","sparseSegmentSum","int32"),i=(0,l._1)(n,"segmentIds","sparseSegmentSum","int32");if(r.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==a.rank)throw new Error("Indices should be Tensor1D but received shape\n         ".concat(a.shape));if(1!==i.rank)throw new Error("Segment ids should be Tensor1D but received shape\n         ".concat(i.shape));var o={data:r,indices:a,segmentIds:i};return s.BV.runKernel(c.ZjV,o)}});var Ea=(0,d.op)({stringNGrams_:function(e,t,n,r,a,i,o,u){var f=(0,l._1)(e,"data","stringNGrams","string");if("string"!==f.dtype)throw new Error("Data must be of datatype string");if(1!==f.shape.length)throw new Error("Data must be a vector, saw: ".concat(f.shape));var d=(0,l._1)(t,"dataSplits","stringNGrams");if("int32"!==d.dtype)throw new Error("Data splits must be of datatype int32");var h={separator:n,nGramWidths:r,leftPad:a,rightPad:i,padWidth:o,preserveShortSequences:u},p={data:f,dataSplits:d},v=s.BV.runKernel(c._JP,p,h);return{nGrams:v[0],nGramsSplits:v[1]}}});var Na=(0,d.op)({stringSplit_:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=(0,l._1)(e,"input","stringSplit","string"),a=(0,l._1)(t,"delimiter","stringSplit","string");if(1!==r.rank)throw new Error("Input should be Tensor1D but received shape ".concat(r.shape));if(0!==a.rank)throw new Error("Delimiter should be a scalar but received shape ".concat(a.shape));var i={skipEmpty:n},o={input:r,delimiter:a},u=s.BV.runKernel(c.s1s,o,i);return{indices:u[0],values:u[1],shape:u[2]}}});var Ta=(0,d.op)({stringToHashBucketFast_:function(e,t){var n=(0,l._1)(e,"input","stringToHashBucketFast","string"),r={numBuckets:t};if(t<=0)throw new Error("Number of buckets must be at least 1");var a={input:n};return s.BV.runKernel(c.XkS,a,r)}});var Ia=(0,d.op)({staticRegexReplace_:function(e,t,n){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],a=(0,l._1)(e,"input","staticRegexReplace","string"),i={pattern:t,rewrite:n,replaceGlobal:r};return s.BV.runKernel(c.e0R,{x:a},i)}}),Da={fft:En.k,ifft:Nn.S,rfft:In.Q,irfft:Tn.w},Fa={hammingWindow:Rr,hannWindow:jr,frame:Br,stft:zr},Ma={flipLeftRight:Lr,grayscaleToRGB:Pr,resizeNearestNeighbor:na.j,resizeBilinear:ta.I,rgbToGrayscale:Ur,rotateWithOffset:Wr,cropAndResize:Zr,nonMaxSuppression:qr,nonMaxSuppressionAsync:Xr,nonMaxSuppressionWithScore:Kr,nonMaxSuppressionWithScoreAsync:$r,nonMaxSuppressionPadded:Qr,nonMaxSuppressionPaddedAsync:ea,threshold:aa,transform:ia},Oa={bandPart:oa,gramSchmidt:ua,qr:la},Ra={absoluteDifference:ha,computeWeightedLoss:da,cosineDistance:pa,hingeLoss:va,huberLoss:ma,logLoss:ga,meanSquaredError:ya,sigmoidCrossEntropy:xa,softmaxCrossEntropy:ka},ja={sparseFillEmptyRows:_a,sparseReshape:Sa,sparseSegmentMean:Ca,sparseSegmentSum:Aa},Ba={stringNGrams:Ea,stringSplit:Na,stringToHashBucketFast:Ta,staticRegexReplace:Ia}},1970:function(e,t,n){"use strict";n.d(t,{v:function(){return o}});var r=n(318),a=n(2145),i=n(8354);var o=(0,n(8640).op)({pad_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=(0,i._1)(e,"x","pad");if(0===o.rank)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");var u={paddings:t,constantValue:n},s={x:o};return r.BV.runKernel(a.lyA,s,u)}})},7226:function(e,t,n){"use strict";n.d(t,{d:function(){return h}});var r=n(9439),a=n(8354),i=n(6147),o=n(9204),u=n(6994),s=n(9151),c=n(5777),l=n(8640),f=n(5561),d=n(5696);var h=(0,l.op)({pool_:function(e,t,n,l,h,p,v){null==h&&(h=[1,1]),null==p&&(p=1),0===l&&(l="valid");var m=(0,a._1)(e,"x","maxPool"),g=m,y=!1;3===m.rank&&(y=!0,g=(0,f.X)(m,[1,m.shape[0],m.shape[1],m.shape[2]])),i.hu(s.jT(p,h),(function(){return"Error in pool: Either strides or dilations must be 1. "+"Got strides ".concat(p," and dilations '").concat(h,"'")}));var b,x=s.Xw(g.shape,t,p,h,l),w=[x.dilationHeight,x.dilationWidth];b="same"===l?function(e,t){var n=e.map((function(e,n){return e+(e-1)*(t[n]-1)})).map((function(e){return e-1})),r=n.map((function(e){return Math.floor(e/2)})),a=n.map((function(e,t){return e-r[t]}));return n.map((function(e,t){return[r[t],a[t]]}))}([x.filterHeight,x.filterWidth],w):[[0,0],[0,0]];var k=1===w[0]&&1===w[1],_=function(e,t,n){var r=n.map((function(e){return e[0]})),a=n.map((function(e){return e[1]})),i=e.concat(r,a),o=t.map((function(e,t){return(e-i[t]%e)%e})),u=a.map((function(e,t){return e+o[t]})),s=t.map((function(e,t){return[r[t],u[t]]})),c=t.map((function(e,t){return[0,o[t]]}));return[s,c]}([x.inHeight,x.inWidth],w,b),S=(0,r.Z)(_,2),C=S[0],A=S[1],E=k?l:"valid",N=k?g:(0,d.f)(g,w,C),T=("avg"===n?function(){return(0,o.w)(N,t,p,E,v)}:function(){return(0,c._)(N,t,p,E,v)})(),I=k?T:(0,u.E)(T,w,A);return y?(0,f.X)(I,[I.shape[1],I.shape[2],I.shape[3]]):I}})},4334:function(e,t,n){"use strict";n.d(t,{s:function(){return s}});var r=n(9439),a=n(318),i=n(2145),o=n(9064),u=n(8354);var s=(0,n(8640).op)({pow_:function(e,t){var n=(0,u._1)(e,"base","pow"),s=(0,u._1)(t,"exp","pow"),c=(0,o.makeTypesMatch)(n,s),l=(0,r.Z)(c,2),f={a:n=l[0],b:s=l[1]};return a.BV.runKernel(i.pe_,f)}})},6859:function(e,t,n){"use strict";n.d(t,{A:function(){return o}});var r=n(318),a=n(2145),i=n(8354);var o=(0,n(8640).op)({prelu_:function(e,t){var n={x:(0,i._1)(e,"x","prelu"),alpha:(0,i._1)(t,"alpha","prelu")};return r.BV.runKernel(a.o0g,n)}})},4600:function(e,t,n){"use strict";function r(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];console.log(e.toString(t))}n.d(t,{S:function(){return r}})},7722:function(e,t,n){"use strict";n.d(t,{W:function(){return u}});var r=n(318),a=n(2145),i=n(8354),o=n(9118);var u=(0,n(8640).op)({prod_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],u=(0,i._1)(e,"x","prod");"bool"===u.dtype&&(u=(0,o.p)(u,"int32"));var s={x:u},c={axis:t,keepDims:n};return r.BV.runKernel(a.DlI,s,c)}})},6972:function(e,t,n){"use strict";n.d(t,{k:function(){return o}});var r=n(318),a=n(2145),i=n(8354);var o=(0,n(8640).op)({real_:function(e){var t={input:(0,i._1)(e,"input","real")};return r.BV.runKernel(a.xJR,t)}})},2209:function(e,t,n){"use strict";n.d(t,{M:function(){return o}});var r=n(318),a=n(2145),i=n(8354);var o=(0,n(8640).op)({reciprocal_:function(e){var t={x:(0,i._1)(e,"x","reciprocal")};return r.BV.runKernel(a.$HU,t)}})},7539:function(e,t,n){"use strict";n.d(t,{U:function(){return o}});var r=n(318),a=n(2145),i=n(8354);var o=(0,n(8640).op)({relu_:function(e){var t={x:(0,i._1)(e,"x","relu")};return r.BV.runKernel(a.qkr,t)}})},5900:function(e,t,n){"use strict";n.d(t,{b:function(){return o}});var r=n(318),a=n(2145),i=n(8354);var o=(0,n(8640).op)({relu6_:function(e){var t={x:(0,i._1)(e,"x","relu6")};return r.BV.runKernel(a.SbG,t)}})},5561:function(e,t,n){"use strict";n.d(t,{X:function(){return o}});var r=n(318),a=n(2145),i=n(8354);var o=(0,n(8640).op)({reshape_:function(e,t){var n={x:(0,i._1)(e,"x","reshape","string_or_numeric")},o={shape:t};return r.BV.runKernel(a.HZH,n,o)}})},4933:function(e,t,n){"use strict";n.d(t,{G:function(){return o}});var r=n(318),a=n(2145),i=n(8354);var o=(0,n(8640).op)({reverse_:function(e,t){var n={x:(0,i._1)(e,"x","reverse")},o={dims:t};return r.BV.runKernel(a.mKl,n,o)}})},766:function(e,t,n){"use strict";n.d(t,{N:function(){return o}});var r=n(318),a=n(2145),i=n(8354);var o=(0,n(8640).op)({round_:function(e){var t={x:(0,i._1)(e,"x","round")};return r.BV.runKernel(a.e07,t)}})},5115:function(e,t,n){"use strict";n.d(t,{b:function(){return o}});var r=n(318),a=n(2145),i=n(8354);var o=(0,n(8640).op)({rsqrt_:function(e){var t={x:(0,i._1)(e,"x","rsqrt","float32")};return r.BV.runKernel(a.bV0,t)}})},7067:function(e,t,n){"use strict";n.d(t,{i:function(){return i}});var r=n(115),a=n(7960);function i(e,t){if(((0,r.isTypedArray)(e)&&"string"!==t||Array.isArray(e))&&"complex64"!==t)throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if("string"===t&&(0,r.isTypedArray)(e)&&!(e instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return(0,a.H)(e,[],[],t)}},8604:function(e,t,n){"use strict";n.r(t),n.d(t,{calculateShapes:function(){return u},validateInput:function(){return o},validateUpdateShape:function(){return i}});var r=n(3433),a=n(6147);function i(e,t,n){var r=t.rank>1?t.shape[t.rank-1]:1,a=t.rank>1?t.rank-1:1,i="Must have updates.shape = indices.shape[:batchDim] + "+"shape[sliceDim:], got updates.shape: ".concat(n.shape)+", indices.shape: ".concat(t.shape,", shape: ").concat(e)+", sliceDim: ".concat(r,", and batchDim: ").concat(a,".");if(n.rank<a)throw new Error(i+" update.rank < ".concat(a,". "));if(e.length<r+(n.rank-a))throw new Error(i+" Output shape length < ".concat(r+(n.rank-a)));if(n.rank!==a+e.length-r)throw new Error(i+" update.rank != ".concat(a+e.length-r));for(var o=0;o<a;++o)if(n.shape[o]!==t.shape[o])throw new Error(i+" updates.shape[".concat(o,"] (").concat(n.shape[o],") != indices.shape[").concat(o,"] (").concat(t.shape[o],")."));for(var u=0;u<n.rank-a;++u)if(n.shape[u+a]!==e[u+r])throw new Error(i+" updates.shape[".concat(u+a,"] (").concat(n.shape[u+a],") != shape[").concat(u+a,"] (").concat(e[u+a],")"))}function o(e,t,n){if(t.rank<1)throw new Error("tf.scatterND() expects the indices to be rank 1 or higher,"+" but the rank was ".concat(t.rank,"."));if(e.rank<1)throw new Error("tf.scatterND() expects the updates to be rank 1 or higher,"+" but the rank was ".concat(e.rank,"."));if("int32"!==t.dtype)throw new Error("The dtype of 'indices' should be int32, but got dtype: ".concat(t.dtype));if(n.length<1)throw new Error("Output rank must be greater or equal to 1, but got shape: ".concat(n));if(0===n.length){if(0===t.size)throw new Error("Indices specified for empty output. indices shape: ".concat(t.shape));if(0===e.size)throw new Error("Updates specified for empty output. updates shape: ".concat(e.shape))}i(n,t,e)}function u(e,t,n){for(var i=t.shape.length,o=i>1?t.shape[i-1]:1,u=n.length,s=1,c=o;c<u;++c)s*=n[c];var l=o<1?1:o;return{sliceRank:o,numUpdates:(0,a.NA)(t.shape)/l,sliceSize:s,strides:[].concat((0,r.Z)((0,a.e3)(n.slice(0,o))),[1]),outputSize:(0,a.NA)(n)}}},413:function(e,t,n){"use strict";n.d(t,{U:function(){return o}});var r=n(318),a=n(2145),i=n(8354);var o=(0,n(8640).op)({selu_:function(e){var t={x:(0,i._1)(e,"x","selu")};return r.BV.runKernel(a.oFR,t)}})},349:function(e,t,n){"use strict";n.d(t,{$:function(){return a},y:function(){return r}});var r=1.7580993408473768,a=1.0507009873554805},119:function(e,t,n){"use strict";n.d(t,{U:function(){return c}});var r=n(8354),a=n(6147),i=n(3457),o=n(1147),u=n(8640),s=n(5561);var c=(0,u.op)({separableConv2d_:function(e,t,n,u,c){var l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1],f=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"NHWC",d=(0,r._1)(e,"x","separableConv2d"),h=(0,r._1)(t,"depthwiseFilter","separableConv2d"),p=(0,r._1)(n,"pointwiseFilter","separableConv2d"),v=d,m=!1;if(3===d.rank&&(m=!0,v=(0,s.X)(d,[1,d.shape[0],d.shape[1],d.shape[2]])),"NCHW"===f)throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");a.hu(4===v.rank,(function(){return"Error in separableConv2d: input must be rank 4, but got "+"rank ".concat(v.rank,".")})),a.hu(4===h.rank,(function(){return"Error in separableConv2d: depthwise filter must be rank 4, but "+"got rank ".concat(h.rank,".")})),a.hu(4===p.rank,(function(){return"Error in separableConv2d: pointwise filter must be rank 4, but "+"got rank ".concat(h.rank,".")})),a.hu(1===p.shape[0],(function(){return"Error in separableConv2d: the first dimension of pointwise filter "+" must be 1, but got ".concat(p.shape[0],".")})),a.hu(1===p.shape[1],(function(){return"Error in separableConv2d: the second dimension of pointwise "+"filter must be 1, but got ".concat(p.shape[1],".")}));var g=h.shape[2],y=h.shape[3];a.hu(p.shape[2]===g*y,(function(){return"Error in separableConv2d: the third dimension of pointwise filter "+"must be ".concat(g*y,", ")+"but got ".concat(p.shape[2],".")}));var b=(0,o.B)(v,h,u,c,f,l),x=1,w=(0,i.T)(b,p,x,"valid",f);return m?(0,s.X)(w,[w.shape[1],w.shape[2],w.shape[3]]):w}})},7643:function(e,t,n){"use strict";n.d(t,{X:function(){return o}});var r=n(318),a=n(2145),i=n(8354);var o=(0,n(8640).op)({sigmoid_:function(e){var t={x:(0,i._1)(e,"x","sigmoid","float32")};return r.BV.runKernel(a.a5O,t)}})},2070:function(e,t,n){"use strict";n.d(t,{X:function(){return o}});var r=n(318),a=n(2145),i=n(8354);var o=(0,n(8640).op)({sign_:function(e){var t={x:(0,i._1)(e,"x","sign")};return r.BV.runKernel(a.i5y,t)}})},7254:function(e,t,n){"use strict";n.d(t,{O:function(){return o}});var r=n(318),a=n(2145),i=n(8354);var o=(0,n(8640).op)({sin_:function(e){var t={x:(0,i._1)(e,"x","sin","float32")};return r.BV.runKernel(a.RQH,t)}})},7657:function(e,t,n){"use strict";n.d(t,{R:function(){return o}});var r=n(318),a=n(2145),i=n(8354);var o=(0,n(8640).op)({sinh_:function(e){var t={x:(0,i._1)(e,"x","sinh")};return r.BV.runKernel(a.wYB,t)}})},9238:function(e,t,n){"use strict";n.d(t,{t:function(){return o}});var r=n(318),a=n(2145),i=n(8354);var o=(0,n(8640).op)({slice_:function(e,t,n){var o=(0,i._1)(e,"x","slice","string_or_numeric");if(0===o.rank)throw new Error("Slicing scalar is not possible");var u={x:o},s={begin:t,size:n};return r.BV.runKernel(a.p2w,u,s)}})},2875:function(e,t,n){"use strict";n.r(t),n.d(t,{assertParamsValid:function(){return i},computeFlatOffset:function(){return y},computeOutShape:function(){return u},getNormalizedAxes:function(){return f},isSliceContinous:function(){return g},maskToAxes:function(){return o},parseSliceParams:function(){return b},sliceInfo:function(){return x},startForAxis:function(){return v},startIndicesWithElidedDims:function(){return d},stopForAxis:function(){return m},stopIndicesWithElidedDims:function(){return h},stridesForAxis:function(){return p},stridesWithElidedDims:function(){return s}});var r=n(3433),a=n(6147);function i(e,t,n){var r=e.shape.length;a.hu(r===t.length,(function(){return"Error in slice".concat(r,"D: Length of begin ").concat(t," must ")+"match the rank of the array (".concat(r,").")})),a.hu(r===n.length,(function(){return"Error in slice".concat(r,"D: Length of size ").concat(n," must ")+"match the rank of the array (".concat(r,").")}));for(var i=function(i){a.hu(t[i]+n[i]<=e.shape[i],(function(){return"Error in slice".concat(r,"D: begin[").concat(i,"] + size[").concat(i,"] ")+"(".concat(t[i]+n[i],") would overflow input.shape[").concat(i,"] (").concat(e.shape[i],")")}))},o=0;o<r;++o)i(o)}function o(e){for(var t=[],n=0;e>0;)1&e&&t.push(n),e/=2,n++;return t}function u(e,t,n){for(var r=[],a=0;a<e.length;a++)r[a]=Math.ceil((t[a]-e[a])/n[a]);return r}function s(e,t,n,a){for(var i=(0,r.Z)(e),o=i.length;o<a.length;o++)i.push(1);for(var u=0;u<n;u++)0===u?i[t]=1:(i.splice(t,0,1),i.pop());return i}function c(e,t,n){return n<=e?n:n-(t-1)}function l(e,t){for(var n=[],r=0;r<e;r++)n.push(t+r);return n}function f(e,t,n,r,a,i,o,u,c){var l=e.length,f=new Array(l),g=new Array(l),y=new Array(l);if(t.length&&n>0){var b=t[0],x=n+1;f=d(o,b,x,r,e),g=h(u,b,x,a,e),y=s(i,b,x,e)}else for(var w=0;w<l;w++)f[w]=v(o,r,i,e,w,c),g[w]=m(u,a,i,e,w,c),y[w]=p(i,w,c);return{begin:f,end:g,strides:y}}function d(e,t,n,a,i){for(var o=(0,r.Z)(i),u=l(n,t),s=0;s<o.length;s++)if(u.indexOf(s)>-1)o[s]=0;else{var f=c(t,n,s),d=a[f];e&1<<f&&(d=0),o[s]=d}return o}function h(e,t,n,i,o){for(var u=(0,r.Z)(o),s=l(n,t),f=0;f<u.length;f++)if(s.indexOf(f)>-1)u[f]=Number.MAX_SAFE_INTEGER;else{var d=c(t,n,f),h=i[d];e&1<<d&&(h=Number.MAX_SAFE_INTEGER),u[f]=h}for(var p=0;p<u.length;p++){var v=o[p];u[p]<0&&(u[p]+=v),u[p]=a.uZ(0,u[p],o[p])}return u}function p(e,t,n){var r=e[t];return(n&1<<t||null==r)&&(r=1),r}function v(e,t,n,r,i,o){var u=t[i],s=n[i]||1;(e&1<<i||o&1<<i||null==u)&&(u=s>0?Number.MIN_SAFE_INTEGER:Number.MAX_SAFE_INTEGER);var c=r[i];return u<0&&(u+=c),u=a.uZ(0,u,c-1)}function m(e,t,n,r,i,o){var u=t[i],s=n[i]||1;(e&1<<i||o&1<<i||null==u)&&(u=s>0?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER);var c=r[i];return u<0&&(u+=c),u=s>0?a.uZ(0,u,c):a.uZ(-1,u,c-1)}function g(e,t,n){for(var r=n.length,a=0;a<n.length;a++)if(n[a]>1){r=a;break}for(var i=r+1;i<n.length;i++)if(t[i]>0||n[i]!==e[i])return!1;return!0}function y(e,t){for(var n=e.length>0?e[e.length-1]:1,r=0;r<e.length-1;r++)n+=e[r]*t[r];return n}function b(e,t,n){var i,o,u=e.shape.length;return(i="number"===typeof t?[t].concat((0,r.Z)(new Array(u-1).fill(0))):t.length<u?t.concat(new Array(u-t.length).fill(0)):t.slice()).forEach((function(e){a.hu(-1!==e,(function(){return"slice() does not support negative begin indexing."}))})),o=(o=null==n?new Array(u).fill(-1):"number"===typeof n?[n].concat((0,r.Z)(new Array(u-1).fill(-1))):n.length<u?n.concat(new Array(u-n.length).fill(-1)):n).map((function(t,n){return t>=0?t:(a.hu(-1===t,(function(){return"Negative size values should be exactly -1 but got "+"".concat(t," for the slice() size at index ").concat(n,".")})),e.shape[n]-i[n])})),[i,o]}function x(e,t,n,r,a,i,o,u,s){var c;if(null==r?(c=new Array(t.length)).fill(1):c=r,null!=o&&0!==(o&o-1))throw new Error("Multiple ellipses in slice is not allowed.");for(var l=!1,f={dims:c.length,numAddAxisAfterEllipsis:0,begin:t.slice(),end:n.slice(),strides:c.slice(),beginMask:a,endMask:i,ellipsisMask:o,newAxisMask:u,shrinkAxisMask:s},d=0;d<f.dims;d++)l&&0!==(1<<d&u)&&f.numAddAxisAfterEllipsis++,1<<d&o&&(l=!0);l||(f.ellipsisMask|=1<<f.dims,f.dims++);var h={dims:e.length,beginMask:0,endMask:0,beginValid:!1,endValid:!1};!function(e,t){t.beginMask=0,t.endMask=0,t.shrinkAxisMask=0;var n=0;t.beginValid=null!=e.begin,t.endValid=null!=e.end,t.begin=new Array(t.dims),t.end=new Array(t.dims),t.strides=new Array(t.dims),t.finalShapeGatherIndices=[],t.finalShapeGatherIndicesSparse=[],t.inputShapeGatherIndicesSparse=new Array(t.dims);for(var r=0;r<e.dims;r++)if(1<<r&e.ellipsisMask)for(var a=Math.min(t.dims-(e.dims-r)+1+e.numAddAxisAfterEllipsis,t.dims);n<a;n++)t.begin[n]=0,t.end[n]=0,t.strides[n]=1,t.beginMask|=1<<n,t.endMask|=1<<n,t.finalShapeGatherIndices.push(n),t.finalShapeGatherIndicesSparse.push(-1),t.inputShapeGatherIndicesSparse[n]=r;else if(1<<r&e.newAxisMask)t.finalShapeGatherIndices.push(-2),t.finalShapeGatherIndicesSparse.push(-1);else{if(n===t.begin.length)throw Error("Index out of range using input dim ".concat(n,"; input ")+"has only ".concat(t.dims," dims, ").concat(t.begin.length,"."));null!=e.begin&&(t.begin[n]=e.begin[r]),null!=e.end&&(t.end[n]=e.end[r]),t.strides[n]=e.strides[r],e.beginMask&1<<r&&(t.beginMask|=1<<n),e.endMask&1<<r&&(t.endMask|=1<<n),e.shrinkAxisMask&1<<r?(t.finalShapeGatherIndices.push(-1),t.finalShapeGatherIndicesSparse.push(-1),t.shrinkAxisMask|=1<<n):(t.finalShapeGatherIndices.push(n),t.finalShapeGatherIndicesSparse.push(r)),t.inputShapeGatherIndicesSparse[n]=r,n++}}(f,h);for(var p=!0,v=!0,m=!0,g=[],y=[],b=0;b<e.length;++b){if(0===h.strides[b])throw Error("strides[".concat(b,"] must be non-zero"));var x=!!(h.shrinkAxisMask&1<<b),k=e[b];if(-1!==k){var _=[h.beginMask&1<<b,h.endMask&1<<b],S=[h.strides[b]>0?0:-1,h.strides[b]>0?k:k-1];if(x&&h.strides[b]<=0)throw Error("only stride 1 allowed on non-range indexing.");m=m&&1===h.strides[b];var C=!!(h.beginMask&1<<b&&h.endMask&1<<b);if(h.beginValid&&h.endValid){if(x){var A=h.begin[b]<0?k+h.begin[b]:h.begin[b];if(h.begin[b]=A,h.end[b]=h.begin[b]+1,A<0||A>=k)throw Error("slice index ".concat(h.begin[b]," of dimension ").concat(b," out of bounds."))}else h.begin[b]=w(h.begin[b],0,h.strides[b],k,_,S),h.end[b]=w(h.end[b],1,h.strides[b],k,_,S);var E=1===h.strides[b]&&0===h.begin[b]&&h.end[b]===k;p=p&&E,v=v&&(0===b&&1===h.strides[b]||E)}else p=p&&1===h.strides[b]&&C,v=v&&(0===b&&1===h.strides[b]||C);var N=void 0,T=!1;if(h.beginValid&&h.endValid?(N=h.end[b]-h.begin[b],T=!0):x?(N=1,T=!0):C&&k>=0&&(N=h.strides[b]<0?-k:k,T=!0),T){var I=void 0;I=0===N||N<0!==h.strides[b]<0?0:Math.trunc(N/h.strides[b])+(N%h.strides[b]!==0?1:0),g.push(I)}else g.push(-1)}else g.push(x?1:-1)}for(var D=0;D<h.finalShapeGatherIndices.length;++D){var F=h.finalShapeGatherIndices[D];F>=0?y.push(g[F]):-2===F&&y.push(1)}var M=y.filter((function(e,t){return-2!==h.finalShapeGatherIndices[t]}));return{finalShapeSparse:M,finalShape:y,isIdentity:p,sliceDim0:v,isSimpleSlice:m,begin:h.begin,end:h.end,strides:h.strides}}function w(e,t,n,r,a,i){if(a[t])return n>0?i[t]:i[t+1&1];var o=e<0?r+e:e;return o<i[0]?i[0]:o>i[1]?i[1]:o}},4910:function(e,t,n){"use strict";n.d(t,{X:function(){return o}});var r=n(318),a=n(2145),i=n(8354);var o=(0,n(8640).op)({softmax_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,n=(0,i._1)(e,"logits","softmax","float32");if(-1===t&&(t=n.rank-1),t!==n.rank-1)throw Error("Softmax along a non-last dimension is not yet supported. "+"Logits was rank ".concat(n.rank," and dim was ").concat(t));var o={logits:n},u={dim:t};return r.BV.runKernel(a.Gcp,o,u)}})},4626:function(e,t,n){"use strict";n.d(t,{W:function(){return o}});var r=n(318),a=n(2145),i=n(8354);var o=(0,n(8640).op)({softplus_:function(e){var t={x:(0,i._1)(e,"x","softplus")};return r.BV.runKernel(a.MRv,t)}})},5696:function(e,t,n){"use strict";n.d(t,{f:function(){return u}});var r=n(318),a=n(2145),i=n(8354),o=n(6147);var u=(0,n(8640).op)({spaceToBatchND_:function(e,t,n){var u=(0,i._1)(e,"x","spaceToBatchND");o.hu(u.rank>=1+t.length,(function(){return"input rank ".concat(u.rank," should be > than [blockShape] ").concat(t.length)})),o.hu(n.length===t.length,(function(){return"paddings.shape[0] ".concat(n.length," must be equal to [blockShape] ").concat(t.length)})),o.hu(u.shape.reduce((function(e,r,a){return a>0&&a<=t.length?e&&(r+n[a-1][0]+n[a-1][1])%t[a-1]===0:e}),!0),(function(){return"input spatial dimensions ".concat(u.shape.slice(1)," with paddings ").concat(n.toString()," must be divisible by blockShapes ").concat(t.toString())}));var s={x:u},c={blockShape:t,paddings:n};return r.BV.runKernel(a.TQc,s,c)}})},7635:function(e,t,n){"use strict";n.d(t,{k:function(){return o}});var r=n(318),a=n(2145),i=n(6147);var o=(0,n(8640).op)({fft_:function(e){(0,i.hu)("complex64"===e.dtype,(function(){return"The dtype for tf.spectral.fft() must be complex64 "+"but got ".concat(e.dtype,".")}));var t={input:e};return r.BV.runKernel(a.vwp,t)}})},530:function(e,t,n){"use strict";n.d(t,{S:function(){return o}});var r=n(318),a=n(2145),i=n(6147);var o=(0,n(8640).op)({ifft_:function(e){(0,i.hu)("complex64"===e.dtype,(function(){return"The dtype for tf.spectral.ifft() must be complex64 "+"but got ".concat(e.dtype,".")}));var t={input:e};return r.BV.runKernel(a.Qg5,t)}})},774:function(e,t,n){"use strict";n.d(t,{w:function(){return p}});var r=n(9253),a=n(4836),i=n(6996),o=n(651),u=n(8640),s=n(6972),c=n(5561),l=n(4933),f=n(7067),d=n(9238),h=n(530);var p=(0,u.op)({irfft_:function(e){var t,n=e.shape[e.shape.length-1],u=e.size/n;if(n<=2){var p=(0,c.X)(e,[u,n]);t=(0,h.S)(p)}else{var v=[u,2*(n-1)],m=(0,c.X)((0,s.k)(e),[u,n]),g=(0,c.X)((0,i.a)(e),[u,n]),y=(0,l.G)((0,d.t)(m,[0,1],[u,n-2]),1),b=(0,o.d)((0,l.G)((0,d.t)(g,[0,1],[u,n-2]),1),(0,f.i)(-1)),x=(0,a.z)([m,y],1),w=(0,a.z)([g,b],1),k=(0,c.X)((0,r.P)(x,w),[v[0],v[1]]);t=(0,h.S)(k)}if(t=(0,s.k)(t),3===e.rank&&0!==e.shape[0]){var _=t,S=e.shape[0];t=(0,c.X)(t,[S,t.shape[0]/S,t.shape[1]]),_.dispose()}return t}})},4617:function(e,t,n){"use strict";n.d(t,{Q:function(){return v}});var r=n(6147),a=n(9253),i=n(4836),o=n(6996),u=n(8640),s=n(6972),c=n(5561),l=n(9238),f=n(2588),d=n(7742),h=n(7293),p=n(7635);var v=(0,u.op)({rfft_:function(e,t){(0,r.hu)("float32"===e.dtype,(function(){return"The dtype for rfft() must be real value but got ".concat(e.dtype)}));var n,u=e.shape[e.shape.length-1],v=e.size/u;if(null!=t&&t<u){var m=e.shape.map((function(e){return 0})),g=e.shape.map((function(e){return e}));g[e.shape.length-1]=t,n=(0,l.t)(e,m,g),u=t}else if(null!=t&&t>u){var y=e.shape.map((function(e){return e}));y[e.shape.length-1]=t-u,n=(0,i.z)([e,(0,d.l)(y)],e.shape.length-1),u=t}else n=e;var b=(0,h.P)(n),x=(0,c.X)((0,a.P)(n,b),[v,u]),w=(0,p.k)(x),k=Math.floor(u/2)+1,_=(0,s.k)(w),S=(0,o.a)(w),C=(0,f.V)(_,[k,u-k],_.shape.length-1),A=(0,f.V)(S,[k,u-k],S.shape.length-1),E=n.shape.slice();return E[n.shape.length-1]=k,(0,c.X)((0,a.P)(C[0],A[0]),E)}})},2588:function(e,t,n){"use strict";n.d(t,{V:function(){return o}});var r=n(318),a=n(2145),i=n(8354);var o=(0,n(8640).op)({split_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=(0,i._1)(e,"x","split"),u={x:o},s={numOrSizeSplits:t,axis:n};return r.BV.runKernel(a.L8s,u,s)}})},6902:function(e,t,n){"use strict";n.d(t,{_:function(){return o}});var r=n(318),a=n(2145),i=n(8354);var o=(0,n(8640).op)({sqrt_:function(e){var t={x:(0,i._1)(e,"x","sqrt","float32")};return r.BV.runKernel(a.FKq,t)}})},7391:function(e,t,n){"use strict";n.d(t,{h:function(){return i}});var r=n(318),a=n(8354);var i=(0,n(8640).op)({square_:function(e){var t=(0,a._1)(e,"x","square");return r.BV.runKernel("Square",{x:t},{})}})},7993:function(e,t,n){"use strict";n.d(t,{$:function(){return c}});var r=n(9439),a=n(318),i=n(2145),o=n(9064),u=n(8354),s=n(5774);var c=(0,n(8640).op)({squaredDifference_:function(e,t){var n=(0,u._1)(e,"a","squaredDifference"),c=(0,u._1)(t,"b","squaredDifference"),l=(0,o.makeTypesMatch)(n,c),f=(0,r.Z)(l,2);n=f[0],c=f[1],(0,s.assertAndGetBroadcastShape)(n.shape,c.shape);var d={a:n,b:c};return a.BV.runKernel(i._tC,d,{})}})},3931:function(e,t,n){"use strict";n.d(t,{L:function(){return u}});var r=n(8354),a=n(6147),i=n(8640),o=n(5561);var u=(0,i.op)({squeeze_:function(e,t){var n=(0,r._1)(e,"x","squeeze","string_or_numeric");return(0,o.X)(n,(0,a.bp)(n.shape,t).newShape)}})},8306:function(e,t,n){"use strict";n.d(t,{k:function(){return u}});var r=n(318),a=n(2145),i=n(8354),o=n(6147);var u=(0,n(8640).op)({stack_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(0,i.sI)(e,"tensors","stack","string_or_numeric");o.hu(n.length>=1,(function(){return"Pass at least one tensor to tf.stack"})),n.length>0&&o.hu(t<=n[0].rank,(function(){return"Axis must be <= rank of the tensor"}));var u=n,s={axis:t};return r.BV.runKernel(a.QiL,u,s)}})},4031:function(e,t,n){"use strict";n.d(t,{N:function(){return o}});var r=n(318),a=n(2145),i=n(8354);var o=(0,n(8640).op)({step_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(0,i._1)(e,"x","step"),o={x:n},u={alpha:t};return r.BV.runKernel(a.h8e,o,u)}})},9017:function(e,t,n){"use strict";n.d(t,{N:function(){return o}});var r=n(318),a=n(2145),i=n(8354);var o=(0,n(8640).op)({stridedSlice_:function(e,t,n,o){var u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,l=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,f=arguments.length>8&&void 0!==arguments[8]?arguments[8]:0,d=(0,i._1)(e,"x","stridedSlice","string_or_numeric"),h={x:d},p={begin:t,end:n,strides:o,beginMask:u,endMask:s,ellipsisMask:c,newAxisMask:l,shrinkAxisMask:f};return r.BV.runKernel(a.jQk,h,p)}})},4774:function(e,t,n){"use strict";n.d(t,{l:function(){return s}});var r=n(9439),a=n(318),i=n(2145),o=n(9064),u=n(8354);var s=(0,n(8640).op)({sub_:function(e,t){var n=(0,u._1)(e,"a","sub"),s=(0,u._1)(t,"b","sub"),c=(0,o.makeTypesMatch)(n,s),l=(0,r.Z)(c,2),f={a:n=l[0],b:s=l[1]};return a.BV.runKernel(i.Tr8,f)}})},227:function(e,t,n){"use strict";n.d(t,{S:function(){return u}});var r=n(318),a=n(2145),i=n(8354),o=n(9118);var u=(0,n(8640).op)({sum_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],u=(0,i._1)(e,"x","sum");"bool"===u.dtype&&(u=(0,o.p)(u,"int32"));var s={x:u},c={axis:t,keepDims:n};return r.BV.runKernel(a.GBy,s,c)}})},6999:function(e,t,n){"use strict";n.d(t,{O:function(){return o}});var r=n(318),a=n(2145),i=n(8354);var o=(0,n(8640).op)({tan_:function(e){var t={x:(0,i._1)(e,"x","tan","float32")};return r.BV.runKernel(a.sEM,t)}})},1744:function(e,t,n){"use strict";n.d(t,{A:function(){return o}});var r=n(318),a=n(2145),i=n(8354);var o=(0,n(8640).op)({tanh_:function(e){var t={x:(0,i._1)(e,"x","tanh","float32")};return r.BV.runKernel(a.MIZ,t)}})},2442:function(e,t,n){"use strict";n.d(t,{X:function(){return i}});var r=n(8354),a=n(7960);function i(e,t,n){var i=(0,r.C)(e,n);return(0,a.H)(e,t,i,n)}},3123:function(e,t,n){"use strict";n.d(t,{w:function(){return o}});var r=n(8354),a=n(6147),i=n(7960);function o(e,t,n){if((0,a.Cq)(e),null!=t&&3!==t.length)throw new Error("tensor3d() requires shape to have three numbers");var o=(0,r.C)(e,n);if(3!==o.length&&1!==o.length)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(1===o.length&&null==t)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return(0,i.H)(e,t,o,n)}},7960:function(e,t,n){"use strict";n.d(t,{H:function(){return u}});var r=n(318),a=n(3525),i=n(6147),o=n(115);function u(e,t,n,u){if(null==u)u=(0,i.D2)(e);else if("complex64"===u)throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if((0,a.$F)(e)||(0,a.Oq)(e)){if("float32"!==u&&"int32"!==u)throw new Error("Creating tensor from GPU data only supports "+"'float32'|'int32' dtype, while the dtype is ".concat(u,"."));return r.BV.backend.createTensorFromGPUData(e,t||n,u)}if(!(0,o.isTypedArray)(e)&&!Array.isArray(e)&&"number"!==typeof e&&"boolean"!==typeof e&&"string"!==typeof e)throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(null!=t){(0,i.Mu)(t);var s=(0,i.NA)(t),c=(0,i.NA)(n);(0,i.hu)(s===c,(function(){return"Based on the provided shape, [".concat(t,"], the tensor should have ")+"".concat(s," values but has ").concat(c)}));for(var l=0;l<n.length;++l){var f=n[l],d=l!==n.length-1||f!==(0,i.NA)(t.slice(l));(0,i.hu)(n[l]===t[l]||!d,(function(){return"Error creating a new Tensor. Inferred shape "+"(".concat(n,") does not match the provided ")+"shape (".concat(t,"). ")}))}}return(0,o.isTypedArray)(e)||Array.isArray(e)||(e=[e]),t=t||n,e="string"!==u?(0,o.toTypedArray)(e,u):(0,o.flatten)(e,[],!0),r.BV.makeTensor(e,t,u)}},2343:function(e,t,n){"use strict";n.d(t,{G:function(){return u}});var r=n(318),a=n(2145),i=n(8354),o=n(6147);var u=(0,n(8640).op)({tile_:function(e,t){var n=(0,i._1)(e,"x","tile","string_or_numeric");o.hu(n.rank===t.length,(function(){return"Error in transpose: rank of input ".concat(n.rank," ")+"must match length of reps ".concat(t,".")}));var u={x:n},s={reps:t};return r.BV.runKernel(a.n9L,u,s)}})},9085:function(e,t,n){"use strict";n.d(t,{h:function(){return u}});var r=n(9439),a=n(318),i=n(2145),o=n(8354);var u=(0,n(8640).op)({topk_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],u=(0,o._1)(e,"x","topk");if(0===u.rank)throw new Error("topk() expects the input to be of rank 1 or higher");var s=u.shape[u.shape.length-1];if(t<0)throw new Error("'k' passed to topk() must be >= 0 but got ".concat(t));if(t>s)throw new Error("'k' passed to topk() must be <= the last dimension (".concat(s,") ")+"but got ".concat(t));var c={x:u},l={k:t,sorted:n},f=a.BV.runKernel(i.cWu,c,l),d=(0,r.Z)(f,2),h=d[0],p=d[1];return{values:h,indices:p}}})},1240:function(e,t,n){"use strict";n.d(t,{p:function(){return h}});var r=n(318),a=n(5875),i=n(2145),o=n(8354),u=n(6147),s=n(9253),c=n(6996),l=n(4362),f=n(8640),d=n(6972);var h=(0,f.op)({transpose_:function(e,t,n){var f=(0,o._1)(e,"x","transpose");if(null==t&&(t=f.shape.map((function(e,t){return t})).reverse()),u.hu(f.rank===t.length,(function(){return"Error in transpose: rank of input ".concat(f.rank," ")+"must match length of perm ".concat(t,".")})),t.forEach((function(e){u.hu(e>=0&&e<f.rank,(function(){return"All entries in 'perm' must be between 0 and ".concat(f.rank-1)+" but got ".concat(t)}))})),f.rank<=1)return f.clone();var h={x:f},p={perm:t};return"complex64"===f.dtype?(0,a.lu)((function(){var e=(0,d.k)(f),t=(0,c.a)(f);return e=r.BV.runKernel(i.G3Y,{x:e},p),t=r.BV.runKernel(i.G3Y,{x:t},p),n&&(t=(0,l.W)(t)),(0,s.P)(e,t)})):r.BV.runKernel(i.G3Y,h,p)}})},4860:function(e,t,n){"use strict";n.d(t,{T:function(){return s}});var r=n(9439),a=n(318),i=n(2145),o=n(8354),u=n(6147);var s=(0,n(8640).op)({unique_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(0,o._1)(e,"x","unique","string_or_numeric");(0,u.hu)(n.rank>0,(function(){return"The input tensor must be at least 1D"}));var s={x:n},c={axis:t},l=a.BV.runKernel(i.kpP,s,c),f=(0,r.Z)(l,2),d=f[0],h=f[1];return{values:d,indices:h}}})},6918:function(e,t,n){"use strict";n.d(t,{p:function(){return u}});var r=n(318),a=n(2145),i=n(8354),o=n(6147);var u=(0,n(8640).op)({unsortedSegmentSum_:function(e,t,n){var u=(0,i._1)(e,"x","unsortedSegmentSum"),s=(0,i._1)(t,"segmentIds","unsortedSegmentSum","int32");(0,o.hu)((0,o.GN)(n),(function(){return"numSegments must be of dtype int"}));var c={x:u,segmentIds:s},l={numSegments:n};return r.BV.runKernel(a.Qvg,c,l)}})},4566:function(e,t,n){"use strict";n.d(t,{H:function(){return u}});var r=n(318),a=n(2145),i=n(8354),o=n(6147);var u=(0,n(8640).op)({unstack_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(0,i._1)(e,"x","unstack","string_or_numeric");o.hu(t>=-n.shape.length&&t<n.shape.length,(function(){return"Axis = ".concat(t," is not in [-").concat(n.shape.length,", ").concat(n.shape.length,")")}));var u={value:n},s={axis:t};return r.BV.runKernel(a.ToN,u,s)}})},329:function(e,t,n){"use strict";n.d(t,{a:function(){return s}});var r=n(318),a=n(2145),i=n(8354),o=n(9742),u=n(5774);var s=(0,n(8640).op)({where_:function(e,t,n){var s=(0,i._1)(t,"a","where"),c=(0,i._1)(n,"b","where"),l=(0,i._1)(e,"condition","where","bool"),f=(0,u.assertAndGetBroadcastShape)((0,u.assertAndGetBroadcastShape)(l.shape,s.shape),c.shape),d={condition:(0,o.U)(l,f),t:(0,o.U)(s,f),e:(0,o.U)(c,f)};return r.BV.runKernel(a.PhF,d)}})},7742:function(e,t,n){"use strict";n.d(t,{l:function(){return o}});var r=n(318),a=n(6147),i=n(9253);function o(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"float32";if((0,a.Mu)(e),"complex64"===t){var n=o(e,"float32"),u=o(e,"float32");return(0,i.P)(n,u)}var s=(0,a.wT)((0,a.NA)(e),t);return r.BV.makeTensor(s,e,t)}},7293:function(e,t,n){"use strict";n.d(t,{P:function(){return o}});var r=n(318),a=n(2145),i=n(8354);var o=(0,n(8640).op)({zerosLike_:function(e){var t={x:(0,i._1)(e,"x","zerosLike")};return r.BV.runKernel(a.RuY,t)}})},1539:function(e,t,n){"use strict";function r(e){return e instanceof Float32Array||e instanceof Int32Array||e instanceof Uint8Array||e instanceof Uint8ClampedArray}n.d(t,{j:function(){return r}})},4672:function(e,t,n){"use strict";n.r(t);var r=n(7613),a=n(4376);(0,a.t3)().prototype.abs=function(){return this.throwIfDisposed(),(0,r.W)(this)};var i=n(1719);(0,a.t3)().prototype.acos=function(){return this.throwIfDisposed(),(0,i.K)(this)};var o=n(4502);(0,a.t3)().prototype.acosh=function(){return this.throwIfDisposed(),(0,o._)(this)};var u=n(3312);(0,a.t3)().prototype.add=function(e){return this.throwIfDisposed(),(0,u.I)(this,e)};var s=n(4108);(0,a.t3)().prototype.all=function(e,t){return this.throwIfDisposed(),(0,s.$)(this,e,t)};var c=n(8543);(0,a.t3)().prototype.any=function(e,t){return this.throwIfDisposed(),(0,c.Y)(this,e,t)};var l=n(9995);(0,a.t3)().prototype.argMax=function(e){return this.throwIfDisposed(),(0,l.N)(this,e)};var f=n(5157);(0,a.t3)().prototype.argMin=function(e){return this.throwIfDisposed(),(0,f.v)(this,e)};var d=n(5561),h=n(6147);(0,a.t3)().prototype.asScalar=function(){return this.throwIfDisposed(),(0,h.hu)(1===this.size,(function(){return"The array must have only 1 element."})),(0,d.X)(this,[])};var p=n(9118);(0,a.t3)().prototype.asType=function(e){return this.throwIfDisposed(),(0,p.p)(this,e)},(0,a.t3)().prototype.as1D=function(){return this.throwIfDisposed(),(0,d.X)(this,[this.size])},(0,a.t3)().prototype.as2D=function(e,t){return this.throwIfDisposed(),(0,d.X)(this,[e,t])},(0,a.t3)().prototype.as3D=function(e,t,n){return this.throwIfDisposed(),(0,d.X)(this,[e,t,n])},(0,a.t3)().prototype.as4D=function(e,t,n,r){return this.throwIfDisposed(),(0,d.X)(this,[e,t,n,r])},(0,a.t3)().prototype.as5D=function(e,t,n,r,a){return this.throwIfDisposed(),(0,d.X)(this,[e,t,n,r,a])};var v=n(3053);(0,a.t3)().prototype.asin=function(){return this.throwIfDisposed(),(0,v.Z)(this)};var m=n(54);(0,a.t3)().prototype.asinh=function(){return this.throwIfDisposed(),(0,m.V)(this)};var g=n(4778);(0,a.t3)().prototype.atan=function(){return this.throwIfDisposed(),(0,g.z)(this)};var y=n(2227);(0,a.t3)().prototype.atan2=function(e){return this.throwIfDisposed(),(0,y.f)(this,e)};var b=n(7897);(0,a.t3)().prototype.atanh=function(){return this.throwIfDisposed(),(0,b.C)(this)};var x=n(9204);(0,a.t3)().prototype.avgPool=function(e,t,n,r){return this.throwIfDisposed(),(0,x.w)(this,e,t,n,r)};var w=n(6994);(0,a.t3)().prototype.batchToSpaceND=function(e,t){return this.throwIfDisposed(),(0,w.E)(this,e,t)};var k=n(3700);(0,a.t3)().prototype.batchNorm=function(e,t,n,r,a){return this.throwIfDisposed(),(0,k.t)(this,e,t,n,r,a)};var _=n(9742);(0,a.t3)().prototype.broadcastTo=function(e){return this.throwIfDisposed(),(0,_.U)(this,e)},(0,a.t3)().prototype.cast=function(e){return this.throwIfDisposed(),(0,p.p)(this,e)};var S=n(1396);(0,a.t3)().prototype.ceil=function(){return this.throwIfDisposed(),(0,S.m)(this)};var C=n(9836);(0,a.t3)().prototype.clipByValue=function(e,t){return this.throwIfDisposed(),(0,C.i)(this,e,t)};var A=n(3433),E=n(4836);(0,a.t3)().prototype.concat=function(e,t){return this.throwIfDisposed(),e instanceof a.es&&(e=[e]),(0,E.z)([this].concat((0,A.Z)(e)),t)};var N=n(4918);(0,a.t3)().prototype.conv1d=function(e,t,n,r,a,i){return this.throwIfDisposed(),(0,N.P)(this,e,t,n,r,a,i)};var T=n(1732);(0,a.t3)().prototype.conv2dTranspose=function(e,t,n,r,a){return this.throwIfDisposed(),(0,T.b)(this,e,t,n,r,a)};var I=n(3457);(0,a.t3)().prototype.conv2d=function(e,t,n,r,a,i){return this.throwIfDisposed(),(0,I.T)(this,e,t,n,r,a,i)};var D=n(1227);(0,a.t3)().prototype.cos=function(){return this.throwIfDisposed(),(0,D.m)(this)};var F=n(6679);(0,a.t3)().prototype.cosh=function(){return this.throwIfDisposed(),(0,F.f)(this)};var M=n(9457);(0,a.t3)().prototype.cumprod=function(e,t,n){return this.throwIfDisposed(),(0,M.$)(this,e,t,n)};var O=n(8862);(0,a.t3)().prototype.cumsum=function(e,t,n){return this.throwIfDisposed(),(0,O.z)(this,e,t,n)};var R=n(1878);(0,a.t3)().prototype.depthToSpace=function(e,t){return this.throwIfDisposed(),(0,R.n)(this,e,t)};var j=n(1147);(0,a.t3)().prototype.depthwiseConv2d=function(e,t,n,r,a,i){return this.throwIfDisposed(),(0,j.B)(this,e,t,n,r,a,i)};var B=n(7580);(0,a.t3)().prototype.dilation2d=function(e,t,n,r,a){return this.throwIfDisposed(),(0,B.W)(this,e,t,n,r,a)};var z=n(5923);(0,a.t3)().prototype.divNoNan=function(e){return this.throwIfDisposed(),(0,z.N)(this,e)};var Z=n(5750);(0,a.t3)().prototype.div=function(e){return this.throwIfDisposed(),(0,Z.h)(this,e)};var L=n(5043);(0,a.t3)().prototype.dot=function(e){return this.throwIfDisposed(),(0,L.A)(this,e)};var P=n(2353);(0,a.t3)().prototype.elu=function(){return this.throwIfDisposed(),(0,P.p)(this)};var U=n(3254);(0,a.t3)().prototype.equal=function(e){return this.throwIfDisposed(),(0,U.D)(this,e)};var W=n(3891);(0,a.t3)().prototype.erf=function(){return this.throwIfDisposed(),(0,W.q)(this)};var V=n(3313);(0,a.t3)().prototype.euclideanNorm=function(e,t){return this.throwIfDisposed(),(0,V.d)(this,e,t)};var q=n(411);(0,a.t3)().prototype.exp=function(){return this.throwIfDisposed(),(0,q.Q)(this)};var G=n(2975);(0,a.t3)().prototype.expandDims=function(e){return this.throwIfDisposed(),(0,G.d)(this,e)};var H=n(5682);(0,a.t3)().prototype.expm1=function(){return this.throwIfDisposed(),(0,H.t)(this)};var X=n(7635);(0,a.t3)().prototype.fft=function(){return this.throwIfDisposed(),(0,X.k)(this)},(0,a.t3)().prototype.flatten=function(){return this.throwIfDisposed(),(0,d.X)(this,[this.size])};var K=n(2628);(0,a.t3)().prototype.floor=function(){return this.throwIfDisposed(),(0,K.G)(this)};var Y=n(7145);(0,a.t3)().prototype.floorDiv=function(e){return this.throwIfDisposed(),(0,Y.q)(this,e)};var $=n(9498);(0,a.t3)().prototype.gather=function(e,t,n){return this.throwIfDisposed(),(0,$.I)(this,e,t,n)};var Q=n(8327);(0,a.t3)().prototype.greaterEqual=function(e){return this.throwIfDisposed(),(0,Q.b)(this,e)};var J=n(5014);(0,a.t3)().prototype.greater=function(e){return this.throwIfDisposed(),(0,J.p)(this,e)};var ee=n(530);(0,a.t3)().prototype.ifft=function(){return this.throwIfDisposed(),(0,ee.S)(this)};var te=n(774);(0,a.t3)().prototype.irfft=function(){return this.throwIfDisposed(),(0,te.w)(this)};var ne=n(300);(0,a.t3)().prototype.isFinite=function(){return this.throwIfDisposed(),(0,ne.x)(this)};var re=n(4652);(0,a.t3)().prototype.isInf=function(){return this.throwIfDisposed(),(0,re.U)(this)};var ae=n(7005);(0,a.t3)().prototype.isNaN=function(){return this.throwIfDisposed(),(0,ae.i)(this)};var ie=n(4419);(0,a.t3)().prototype.leakyRelu=function(e){return this.throwIfDisposed(),(0,ie.h)(this,e)};var oe=n(2642);(0,a.t3)().prototype.lessEqual=function(e){return this.throwIfDisposed(),(0,oe.z)(this,e)};var ue=n(4920);(0,a.t3)().prototype.less=function(e){return this.throwIfDisposed(),(0,ue.d)(this,e)};var se=n(936);(0,a.t3)().prototype.localResponseNormalization=function(e,t,n,r){return this.throwIfDisposed(),(0,se.G)(this,e,t,n,r)};var ce=n(5113);(0,a.t3)().prototype.logSigmoid=function(){return this.throwIfDisposed(),(0,ce.e)(this)};var le=n(4561);(0,a.t3)().prototype.logSoftmax=function(e){return this.throwIfDisposed(),(0,le.C)(this,e)};var fe=n(5530);(0,a.t3)().prototype.logSumExp=function(e,t){return this.throwIfDisposed(),(0,fe.l)(this,e,t)};var de=n(378);(0,a.t3)().prototype.log=function(){return this.throwIfDisposed(),(0,de.c)(this)};var he=n(5341);(0,a.t3)().prototype.log1p=function(){return this.throwIfDisposed(),(0,he.K)(this)};var pe=n(2177);(0,a.t3)().prototype.logicalAnd=function(e){return this.throwIfDisposed(),(0,pe.H)(this,e)};var ve=n(875);(0,a.t3)().prototype.logicalNot=function(){return this.throwIfDisposed(),(0,ve.h)(this)};var me=n(5117);(0,a.t3)().prototype.logicalOr=function(e){return this.throwIfDisposed(),(0,me.K)(this,e)};var ge=n(1712);(0,a.t3)().prototype.logicalXor=function(e){return this.throwIfDisposed(),(0,ge.e)(this,e)};var ye=n(7221);(0,a.t3)().prototype.matMul=function(e,t,n){return this.throwIfDisposed(),(0,ye.O)(this,e,t,n)};var be=n(5777);(0,a.t3)().prototype.maxPool=function(e,t,n,r){return this.throwIfDisposed(),(0,be._)(this,e,t,n,r)};var xe=n(6176);(0,a.t3)().prototype.max=function(e,t){return this.throwIfDisposed(),(0,xe.F)(this,e,t)};var we=n(705);(0,a.t3)().prototype.maximum=function(e){return this.throwIfDisposed(),(0,we.g)(this,e)};var ke=n(6568);(0,a.t3)().prototype.mean=function(e,t){return this.throwIfDisposed(),(0,ke.J)(this,e,t)};var _e=n(7891);(0,a.t3)().prototype.min=function(e,t){return this.throwIfDisposed(),(0,_e.V)(this,e,t)};var Se=n(2273);(0,a.t3)().prototype.minimum=function(e){return this.throwIfDisposed(),(0,Se.L)(this,e)};var Ce=n(9719);(0,a.t3)().prototype.mirrorPad=function(e,t){return this.throwIfDisposed(),(0,Ce.V)(this,e,t)};var Ae=n(4645);(0,a.t3)().prototype.mod=function(e){return this.throwIfDisposed(),(0,Ae.w)(this,e)};var Ee=n(651);(0,a.t3)().prototype.mul=function(e){return this.throwIfDisposed(),(0,Ee.d)(this,e)};var Ne=n(4362);(0,a.t3)().prototype.neg=function(){return this.throwIfDisposed(),(0,Ne.W)(this)};var Te=n(6662);(0,a.t3)().prototype.norm=function(e,t,n){return this.throwIfDisposed(),(0,Te.K)(this,e,t,n)};var Ie=n(5549);(0,a.t3)().prototype.notEqual=function(e){return this.throwIfDisposed(),(0,Ie.Q)(this,e)};var De=n(4326);(0,a.t3)().prototype.oneHot=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return this.throwIfDisposed(),(0,De.l)(this,e,t,n)};var Fe=n(773);(0,a.t3)().prototype.onesLike=function(){return this.throwIfDisposed(),(0,Fe.J)(this)};var Me=n(1970);(0,a.t3)().prototype.pad=function(e,t){return this.throwIfDisposed(),(0,Me.v)(this,e,t)};var Oe=n(7226);(0,a.t3)().prototype.pool=function(e,t,n,r,a,i){return this.throwIfDisposed(),(0,Oe.d)(this,e,t,n,r,a,i)};var Re=n(4334);(0,a.t3)().prototype.pow=function(e){return this.throwIfDisposed(),(0,Re.s)(this,e)};var je=n(6859);(0,a.t3)().prototype.prelu=function(e){return this.throwIfDisposed(),(0,je.A)(this,e)};var Be=n(7722);(0,a.t3)().prototype.prod=function(e,t){return this.throwIfDisposed(),(0,Be.W)(this,e,t)};var ze=n(2209);(0,a.t3)().prototype.reciprocal=function(){return this.throwIfDisposed(),(0,ze.M)(this)};var Ze=n(7539);(0,a.t3)().prototype.relu=function(){return this.throwIfDisposed(),(0,Ze.U)(this)};var Le=n(5900);(0,a.t3)().prototype.relu6=function(){return this.throwIfDisposed(),(0,Le.b)(this)},(0,a.t3)().prototype.reshapeAs=function(e){return this.throwIfDisposed(),(0,d.X)(this,e.shape)},(0,a.t3)().prototype.reshape=function(e){return this.throwIfDisposed(),(0,d.X)(this,e)};var Pe=n(464);(0,a.t3)().prototype.resizeBilinear=function(e,t,n){return this.throwIfDisposed(),(0,Pe.I)(this,e,t,n)};var Ue=n(8600);(0,a.t3)().prototype.resizeNearestNeighbor=function(e,t,n){return this.throwIfDisposed(),(0,Ue.j)(this,e,t,n)};var We=n(4933);(0,a.t3)().prototype.reverse=function(e){return this.throwIfDisposed(),(0,We.G)(this,e)};var Ve=n(4617);(0,a.t3)().prototype.rfft=function(){return this.throwIfDisposed(),(0,Ve.Q)(this)};var qe=n(766);(0,a.t3)().prototype.round=function(){return this.throwIfDisposed(),(0,qe.N)(this)};var Ge=n(5115);(0,a.t3)().prototype.rsqrt=function(){return this.throwIfDisposed(),(0,Ge.b)(this)};var He=n(413);(0,a.t3)().prototype.selu=function(){return this.throwIfDisposed(),(0,He.U)(this)};var Xe=n(119);(0,a.t3)().prototype.separableConv2d=function(e,t,n,r,a,i){return this.throwIfDisposed(),(0,Xe.U)(this,e,t,n,r,a,i)};var Ke=n(7643);(0,a.t3)().prototype.sigmoid=function(){return this.throwIfDisposed(),(0,Ke.X)(this)};var Ye=n(2070);(0,a.t3)().prototype.sign=function(){return this.throwIfDisposed(),(0,Ye.X)(this)};var $e=n(7254);(0,a.t3)().prototype.sin=function(){return this.throwIfDisposed(),(0,$e.O)(this)};var Qe=n(7657);(0,a.t3)().prototype.sinh=function(){return this.throwIfDisposed(),(0,Qe.R)(this)};var Je=n(9238);(0,a.t3)().prototype.slice=function(e,t){return this.throwIfDisposed(),(0,Je.t)(this,e,t)};var et=n(4910);(0,a.t3)().prototype.softmax=function(e){return this.throwIfDisposed(),(0,et.X)(this,e)};var tt=n(4626);(0,a.t3)().prototype.softplus=function(){return this.throwIfDisposed(),(0,tt.W)(this)};var nt=n(5696);(0,a.t3)().prototype.spaceToBatchND=function(e,t){return this.throwIfDisposed(),(0,nt.f)(this,e,t)};var rt=n(2588);(0,a.t3)().prototype.split=function(e,t){return this.throwIfDisposed(),(0,rt.V)(this,e,t)};var at=n(6902);(0,a.t3)().prototype.sqrt=function(){return this.throwIfDisposed(),(0,at._)(this)};var it=n(7391);(0,a.t3)().prototype.square=function(){return this.throwIfDisposed(),(0,it.h)(this)};var ot=n(7993);(0,a.t3)().prototype.squaredDifference=function(e){return this.throwIfDisposed(),(0,ot.$)(this,e)};var ut=n(3931);(0,a.t3)().prototype.squeeze=function(e){return this.throwIfDisposed(),(0,ut.L)(this,e)};var st=n(8306);(0,a.t3)().prototype.stack=function(e,t){this.throwIfDisposed();var n=e instanceof a.es?[this,e]:[this].concat((0,A.Z)(e));return(0,st.k)(n,t)};var ct=n(4031);(0,a.t3)().prototype.step=function(e){return this.throwIfDisposed(),(0,ct.N)(this,e)};var lt=n(9017);(0,a.t3)().prototype.stridedSlice=function(e,t,n,r,a,i,o,u){return this.throwIfDisposed(),(0,lt.N)(this,e,t,n,r,a,i,o,u)};var ft=n(4774);(0,a.t3)().prototype.sub=function(e){return this.throwIfDisposed(),(0,ft.l)(this,e)};var dt=n(227);(0,a.t3)().prototype.sum=function(e,t){return this.throwIfDisposed(),(0,dt.S)(this,e,t)};var ht=n(6999);(0,a.t3)().prototype.tan=function(){return this.throwIfDisposed(),(0,ht.O)(this)};var pt=n(1744);(0,a.t3)().prototype.tanh=function(){return this.throwIfDisposed(),(0,pt.A)(this)};var vt=n(2343);(0,a.t3)().prototype.tile=function(e){return this.throwIfDisposed(),(0,vt.G)(this,e)},(0,a.t3)().prototype.toBool=function(){return this.throwIfDisposed(),(0,p.p)(this,"bool")},(0,a.t3)().prototype.toFloat=function(){return this.throwIfDisposed(),(0,p.p)(this,"float32")},(0,a.t3)().prototype.toInt=function(){return this.throwIfDisposed(),(0,p.p)(this,"int32")};var mt=n(9085);(0,a.t3)().prototype.topk=function(e,t){return this.throwIfDisposed(),(0,mt.h)(this,e,t)};var gt=n(1240);(0,a.t3)().prototype.transpose=function(e){return this.throwIfDisposed(),(0,gt.p)(this,e)};var yt=n(4860);(0,a.t3)().prototype.unique=function(e){return this.throwIfDisposed(),(0,yt.T)(this,e)};var bt=n(6918);(0,a.t3)().prototype.unsortedSegmentSum=function(e,t){return this.throwIfDisposed(),(0,bt.p)(this,e,t)};var xt=n(4566);(0,a.t3)().prototype.unstack=function(e){return this.throwIfDisposed(),(0,xt.H)(this,e)};var wt=n(329);(0,a.t3)().prototype.where=function(e,t){return this.throwIfDisposed(),(0,wt.a)(e,this,t)};var kt=n(7293);(0,a.t3)().prototype.zerosLike=function(){return this.throwIfDisposed(),(0,kt.P)(this)}},4376:function(e,t,n){"use strict";n.d(t,{es:function(){return C},YD:function(){return b},_w:function(){return E},t3:function(){return A},FZ:function(){return S},Vp:function(){return _},Vi:function(){return k}});var r=n(136),a=n(7277),i=n(5861),o=n(5671),u=n(3144),s=n(4687),c=n.n(s),l=n(6581),f=n(3433),d=n(6147);function h(e,t,n,r){var a=(0,d.e3)(t),i=function(e,t,n,r){var a=(0,d.NA)(t),i=r[r.length-1],o=new Array(i).fill(0),u=t.length,s="complex64"===n?g(e):e;if(u>1)for(var c=0;c<a/i;c++)for(var l=c*i,f=0;f<i;f++)o[f]=Math.max(o[f],p(s[l+f],0,n).length);return o}(e,t,n,a),o=t.length,u=m(e,t,n,a,i),s=["Tensor"];return r&&(s.push("  dtype: ".concat(n)),s.push("  rank: ".concat(o)),s.push("  shape: [".concat(t,"]")),s.push("  values:")),s.push(u.map((function(e){return"    "+e})).join("\n")),s.join("\n")}function p(e,t,n){var r;return r=Array.isArray(e)?"".concat(parseFloat(e[0].toFixed(7))," + ")+"".concat(parseFloat(e[1].toFixed(7)),"j"):(0,d.HD)(e)?"'".concat(e,"'"):"bool"===n?v(e):parseFloat(e.toFixed(7)).toString(),(0,d.oj)(r,t)}function v(e){return 0===e?"false":"true"}function m(e,t,n,r,a){var i=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],o="complex64"===n?2:1,u=t[0],s=t.length;if(0===s){if("complex64"===n){var c=g(e);return[p(c[0],0,n)]}return"bool"===n?[v(e[0])]:[e[0].toString()]}if(1===s){if(u>20){var l=3*o,d=Array.from(e.slice(0,l)),h=Array.from(e.slice((u-3)*o,u*o));return"complex64"===n&&(d=g(d),h=g(h)),["["+d.map((function(e,t){return p(e,a[t],n)})).join(", ")+", ..., "+h.map((function(e,t){return p(e,a[u-3+t],n)})).join(", ")+"]"]}var y="complex64"===n?g(e):Array.from(e);return["["+y.map((function(e,t){return p(e,a[t],n)})).join(", ")+"]"]}var b=t.slice(1),x=r.slice(1),w=r[0]*o,k=[];if(u>20){for(var _=0;_<3;_++){var S=_*w,C=S+w;k.push.apply(k,(0,f.Z)(m(e.slice(S,C),b,n,x,a,!1)))}k.push("...");for(var A=u-3;A<u;A++){var E=A*w,N=E+w;k.push.apply(k,(0,f.Z)(m(e.slice(E,N),b,n,x,a,A===u-1)))}}else for(var T=0;T<u;T++){var I=T*w,D=I+w;k.push.apply(k,(0,f.Z)(m(e.slice(I,D),b,n,x,a,T===u-1)))}var F=2===s?",":"";k[0]="["+(u>0?k[0]+F:"");for(var M=1;M<k.length-1;M++)k[M]=" "+k[M]+F;for(var O=",\n",R=2;R<s;R++)O+="\n";return k[k.length-1]=" "+k[k.length-1]+"]"+(i?"":O),k}function g(e){for(var t=[],n=0;n<e.length;n+=2)t.push([e[n],e[n+1]]);return t}var y=n(115),b=function(){function e(t,n,r){var a=this;if((0,o.Z)(this,e),this.dtype=n,this.shape=t.slice(),this.size=d.NA(t),null!=r){var i=r.length;d.hu(i===this.size,(function(){return"Length of values '".concat(i,"' does not match the size ")+"inferred by the shape '".concat(a.size,"'.")}))}if("complex64"===n)throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=r||d.rQ(n,this.size),this.strides=(0,d.e3)(t)}return(0,u.Z)(e,[{key:"set",value:function(e){for(var t=this,n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];0===r.length&&(r=[0]),d.hu(r.length===this.rank,(function(){return"The number of provided coordinates (".concat(r.length,") must ")+"match the rank (".concat(t.rank,")")}));var i=this.locToIndex(r);this.values[i]=e}},{key:"get",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];0===t.length&&(t=[0]);for(var r=0,a=0,i=t;a<i.length;a++){var o=i[a];if(o<0||o>=this.shape[r]){var u="Requested out of range element at ".concat(t,". ")+"  Buffer shape=".concat(this.shape);throw new Error(u)}r++}for(var s=t[t.length-1],c=0;c<t.length-1;++c)s+=this.strides[c]*t[c];return this.values[s]}},{key:"locToIndex",value:function(e){if(0===this.rank)return 0;if(1===this.rank)return e[0];for(var t=e[e.length-1],n=0;n<e.length-1;++n)t+=this.strides[n]*e[n];return t}},{key:"indexToLoc",value:function(e){if(0===this.rank)return[];if(1===this.rank)return[e];for(var t=new Array(this.shape.length),n=0;n<t.length-1;++n)t[n]=Math.floor(e/this.strides[n]),e-=t[n]*this.strides[n];return t[t.length-1]=e,t}},{key:"rank",get:function(){return this.shape.length}},{key:"toTensor",value:function(){return x().makeTensor(this.values,this.shape,this.dtype)}}]),e}(),x=null,w=null;function k(e){x=e}function _(e){w=e}function S(e){e}var C=function(){function e(t,n,r,a){(0,o.Z)(this,e),this.kept=!1,this.isDisposedInternal=!1,this.shape=t.slice(),this.dtype=n||"float32",this.size=d.NA(t),this.strides=(0,d.e3)(t),this.dataId=r,this.id=a,this.rankType=this.rank<5?this.rank.toString():"higher"}return(0,u.Z)(e,[{key:"rank",get:function(){return this.shape.length}},{key:"buffer",value:function(){var e=(0,i.Z)(c().mark((function e(){var t;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.data();case 2:return t=e.sent,e.abrupt("return",w.buffer(this.shape,this.dtype,t));case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"bufferSync",value:function(){return w.buffer(this.shape,this.dtype,this.dataSync())}},{key:"array",value:function(){var e=(0,i.Z)(c().mark((function e(){var t;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.data();case 2:return t=e.sent,e.abrupt("return",(0,d.GX)(this.shape,t,"complex64"===this.dtype));case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"arraySync",value:function(){return(0,d.GX)(this.shape,this.dataSync(),"complex64"===this.dtype)}},{key:"data",value:function(){var e=(0,i.Z)(c().mark((function e(){var t,n;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.throwIfDisposed(),t=x().read(this.dataId),"string"!==this.dtype){e.next=13;break}return e.next=5,t;case 5:return n=e.sent,e.prev=6,e.abrupt("return",n.map((function(e){return y.decodeString(e)})));case 10:throw e.prev=10,e.t0=e.catch(6),new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().");case 13:return e.abrupt("return",t);case 14:case"end":return e.stop()}}),e,this,[[6,10]])})));return function(){return e.apply(this,arguments)}}()},{key:"dataToGPU",value:function(e){return this.throwIfDisposed(),x().readToGPU(this.dataId,e)}},{key:"dataSync",value:function(){this.throwIfDisposed();var e=x().readSync(this.dataId);if("string"===this.dtype)try{return e.map((function(e){return y.decodeString(e)}))}catch(t){throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return e}},{key:"bytes",value:function(){var e=(0,i.Z)(c().mark((function e(){var t;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.throwIfDisposed(),e.next=3,x().read(this.dataId);case 3:if(t=e.sent,"string"!==this.dtype){e.next=8;break}return e.abrupt("return",t);case 8:return e.abrupt("return",new Uint8Array(t.buffer));case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"dispose",value:function(){this.isDisposed||(this.kerasMask&&this.kerasMask.dispose(),x().disposeTensor(this),this.isDisposedInternal=!0)}},{key:"isDisposed",get:function(){return this.isDisposedInternal}},{key:"throwIfDisposed",value:function(){if(this.isDisposed)throw new Error("Tensor is disposed.")}},{key:"print",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return w.print(this,e)}},{key:"clone",value:function(){return this.throwIfDisposed(),w.clone(this)}},{key:"toString",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.dataSync();return h(t,this.shape,this.dtype,e)}},{key:"cast",value:function(e){return this.throwIfDisposed(),w.cast(this,e)}},{key:"variable",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0;return this.throwIfDisposed(),x().makeVariable(this,e,t,n)}}]),e}();function A(){return(0,l.R)("Tensor",(function(){return C}))}Object.defineProperty(C,Symbol.hasInstance,{value:function(e){return!!e&&null!=e.data&&null!=e.dataSync&&null!=e.throwIfDisposed}}),A();var E=function(e){(0,r.Z)(n,e);var t=(0,a.Z)(n);function n(e,r,a,i){var u;return(0,o.Z)(this,n),(u=t.call(this,e.shape,e.dtype,e.dataId,i)).trainable=r,u.name=a,u}return(0,u.Z)(n,[{key:"assign",value:function(e){if(e.dtype!==this.dtype)throw new Error("dtype of the new value (".concat(e.dtype,") and ")+"previous value (".concat(this.dtype,") must match"));if(!d.cO(e.shape,this.shape))throw new Error("shape of the new value (".concat(e.shape,") and ")+"previous value (".concat(this.shape,") must match"));x().disposeTensor(this),this.dataId=e.dataId,x().incRef(this,null)}},{key:"dispose",value:function(){x().disposeVariable(this),this.isDisposedInternal=!0}}]),n}(C);Object.defineProperty(E,Symbol.hasInstance,{value:function(e){return e instanceof C&&null!=e.assign&&e.assign instanceof Function}})},9064:function(e,t,n){"use strict";n.r(t),n.d(t,{assertTypesMatch:function(){return u},getTensorsInContainer:function(){return c},isTensorInList:function(){return s},makeTypesMatch:function(){return o}});var r=n(4376),a=n(3525),i=n(6147);function o(e,t){if(e.dtype===t.dtype)return[e,t];var n=(0,a.x8)(e.dtype,t.dtype);return[e.cast(n),t.cast(n)]}function u(e,t){(0,i.hu)(e.dtype===t.dtype,(function(){return"The dtypes of the first(".concat(e.dtype,") and")+" second(".concat(t.dtype,") input must match")}))}function s(e,t){return t.some((function(t){return t.id===e.id}))}function c(e){var t=[];return l(e,t,new Set),t}function l(e,t,n){if(null!=e)if(e instanceof r.es)t.push(e);else if(a=e,Array.isArray(a)||"object"===typeof a){var a,i=e;for(var o in i){var u=i[o];n.has(u)||(n.add(u),l(u,t,n))}}}},8354:function(e,t,n){"use strict";n.d(t,{C:function(){return c},_1:function(){return d},sI:function(){return h}});var r=n(318),a=n(5050),i=n(4376),o=n(3525),u=n(115),s=n(6147);function c(e,t){var n=e;if((0,u.isTypedArray)(e))return"string"===t?[]:[e.length];if((0,o.Oq)(e)){var r=e.channels||"RGBA";return[e.height,e.width*r.length]}if((0,o.$F)(e))return[e.buffer.size/(null==t?4:(0,s.bT)(t))];if(!Array.isArray(e))return[];for(var i=[];Array.isArray(n)||(0,u.isTypedArray)(n)&&"string"!==t;)i.push(n.length),n=n[0];return Array.isArray(e)&&(0,a.OB)().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&l(e,i,[]),i}function l(e,t,n){if(n=n||[],Array.isArray(e)||(0,u.isTypedArray)(e)){(0,s.hu)(t.length>0,(function(){return"Element arr[".concat(n.join("]["),"] should be a primitive, ")+"but is an array of ".concat(e.length," elements")})),(0,s.hu)(e.length===t[0],(function(){return"Element arr[".concat(n.join("]["),"] should have ").concat(t[0]," ")+"elements, but has ".concat(e.length," elements")}));for(var r=t.slice(1),a=0;a<e.length;++a)l(e[a],r,n.concat(a))}else(0,s.hu)(0===t.length,(function(){return"Element arr[".concat(n.join("]["),"] is a primitive, ")+"but should be an array/TypedArray of ".concat(t[0]," elements")}))}function f(e,t,n,r){if("string_or_numeric"!==e){if(null==e)throw new Error("Expected dtype cannot be null.");if("numeric"!==e&&e!==t||"numeric"===e&&"string"===t)throw new Error("Argument '".concat(n,"' passed to '").concat(r,"' must ")+"be ".concat(e," tensor, but got ").concat(t," tensor"))}}function d(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"numeric";if(e instanceof(0,i.t3)())return f(a,e.dtype,t,n),e;var o=(0,s.D2)(e);if("string"!==o&&["bool","int32","float32"].indexOf(a)>=0&&(o=a),f(a,o,t,n),null==e||!(0,u.isTypedArray)(e)&&!Array.isArray(e)&&"number"!==typeof e&&"boolean"!==typeof e&&"string"!==typeof e){var l=null==e?"null":e.constructor.name;throw new Error("Argument '".concat(t,"' passed to '").concat(n,"' must be a ")+"Tensor or TensorLike, but got '".concat(l,"'"))}var d=c(e,o);(0,u.isTypedArray)(e)||Array.isArray(e)||(e=[e]);var h=!0,p="string"!==o?(0,u.toTypedArray)(e,o):(0,u.flatten)(e,[],h);return r.BV.makeTensor(p,d,o)}function h(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"numeric";if(!Array.isArray(e))throw new Error("Argument ".concat(t," passed to ").concat(n," must be a ")+"`Tensor[]` or `TensorLike[]`");var a=e;return a.map((function(e,a){return d(e,"".concat(t,"[").concat(a,"]"),n,r)}))}},3525:function(e,t,n){"use strict";var r,a,i,o,u;n.d(t,{$F:function(){return d},Oq:function(){return f},x8:function(){return c},yw:function(){return r},z4:function(){return l}}),function(e){e.R0="R0",e.R1="R1",e.R2="R2",e.R3="R3",e.R4="R4",e.R5="R5",e.R6="R6"}(r||(r={})),function(e){e.float32="float32",e.int32="int32",e.bool="int32",e.complex64="complex64"}(a||(a={})),function(e){e.float32="float32",e.int32="int32",e.bool="bool",e.complex64="complex64"}(i||(i={})),function(e){e.float32="float32",e.int32="float32",e.bool="float32",e.complex64="complex64"}(o||(o={})),function(e){e.float32="complex64",e.int32="complex64",e.bool="complex64",e.complex64="complex64"}(u||(u={}));var s={float32:o,int32:a,bool:i,complex64:u};function c(e,t){if("string"===e||"string"===t){if("string"===e&&"string"===t)return"string";throw new Error("Can not upcast ".concat(e," with ").concat(t))}return s[e][t]}function l(e){return c(e,"int32")}function f(e){return null!=e&&"object"===typeof e&&"texture"in e&&e.texture instanceof WebGLTexture}function d(e){return"undefined"!==typeof GPUBuffer&&null!=e&&"object"===typeof e&&"buffer"in e&&e.buffer instanceof GPUBuffer}},115:function(e,t,n){"use strict";n.r(t),n.d(t,{arraysEqual:function(){return i.cO},arraysEqualWithNull:function(){return i.DK},assert:function(){return i.hu},assertNonNegativeIntegerDimensions:function(){return i.Mu},assertNonNull:function(){return i.Cq},assertShapesMatch:function(){return i.k5},bytesFromStringArray:function(){return i.Ub},bytesPerElement:function(){return i.bT},checkConversionForErrors:function(){return i.D5},clamp:function(){return i.uZ},computeStrides:function(){return i.e3},convertBackendValuesAndArrayBuffer:function(){return i.KS},createScalarValue:function(){return _},createShuffledIndices:function(){return i.U$},decodeString:function(){return N},distSquared:function(){return i.E7},encodeString:function(){return E},fetch:function(){return A},fingerPrint64:function(){return k},flatten:function(){return I},getArrayFromDType:function(){return i.rQ},getTypedArrayFromDType:function(){return i.WP},hasEncodingLoss:function(){return i.QB},hexToLong:function(){return s},indexToLoc:function(){return i.NE},inferDtype:function(){return i.D2},inferFromImplicitShape:function(){return i.JZ},isBoolean:function(){return i.jn},isFunction:function(){return i.mf},isInt:function(){return i.GN},isNumber:function(){return i.hj},isPromise:function(){return i.tI},isScalarShape:function(){return i.xH},isString:function(){return i.HD},isTypedArray:function(){return T},isValidDtype:function(){return i.LP},locToIndex:function(){return i.qy},makeOnesTypedArray:function(){return i.p8},makeZerosNestedTypedArray:function(){return i.l6},makeZerosTypedArray:function(){return i.wT},nearestDivisor:function(){return i.jP},nearestLargerEven:function(){return i.nY},now:function(){return C},parseAxisParam:function(){return i.EC},randUniform:function(){return i.bj},repeatedTry:function(){return i.WD},rightPad:function(){return i.oj},shuffle:function(){return i.TV},shuffleCombo:function(){return i.d7},sizeFromShape:function(){return i.NA},sizeToSquarishShape:function(){return i.YP},squeezeShape:function(){return i.bp},sum:function(){return i.Sm},swap:function(){return i.LF},tanh:function(){return i.AE},toNestedArray:function(){return i.GX},toTypedArray:function(){return S}});var r=n(5050),a=n(1539),i=n(6147),o=n(8987),u=n.n(o)()||o;function s(e){return u.fromString(e,!0,16)}var c=s("c3a5c85c97cb3127"),l=s("b492b66fbe98f273"),f=s("9ae16a3b2f90404f");function d(e){return e.xor(e.shru(47))}function h(e,t,n){var r=e.slice(t,t+n);return u.fromBytes(Array.from(r),!0,!0)}function p(e,t){return h(e,t,8)}function v(e,t){return h(e,t,4)}function m(e,t){return 0===t?e:e.shru(t).or(e.shl(64-t))}function g(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:s("9ddfea08eb382d69"),r=e.xor(t).mul(n);r=r.xor(r.shru(47));var a=t.xor(r).mul(n);return a=(a=a.xor(a.shru(47))).mul(n)}function y(e,t,n,r){return function(e,t,n,r,a,i){a=a.add(e),i=m(i.add(a).add(r),21);var o=a;return a=(a=a.add(t)).add(n),i=i.add(m(a,44)),[a.add(r),i.add(o)]}(p(e,t),p(e,t+8),p(e,t+16),p(e,t+24),n,r)}function b(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.length;if(t>=8){var n=f.add(2*t),r=p(e,0).add(f),a=p(e,t-8),i=m(a,37).mul(n).add(r),o=m(r,25).add(a).mul(n);return g(i,o,n)}if(t>=4){var u=f.add(2*t),s=v(e,0);return g(s.shl(3).add(t),v(e,t-4),u)}if(t>0){var l=e[0],h=e[t>>1],y=e[t-1],b=l+(h<<8),x=t+(y<<2);return d(f.mul(b).xor(c.mul(x))).mul(f)}return f}function x(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.length,n=f.add(2*t),r=p(e,0).mul(l),a=p(e,8),i=p(e,t-8).mul(n),o=p(e,t-16).mul(f);return g(m(r.add(a),43).add(m(i,30)).add(o),r.add(m(a.add(f),18)).add(i),n)}function w(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.length,n=f.add(2*t),r=p(e,0).mul(f),a=p(e,8),i=p(e,t-8).mul(n),o=p(e,t-16).mul(f),u=m(r.add(a),43).add(m(i,30)).add(o),s=g(u,r.add(m(a.add(f),18)).add(i),n),c=p(e,16).mul(n),l=p(e,24),d=u.add(p(e,t-32)).mul(n),h=s.add(p(e,t-24)).mul(n);return g(m(c.add(l),43).add(m(d,30)).add(h),c.add(m(l.add(r),18)).add(d),n)}function k(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.length,n=u.fromNumber(81,!0);if(t<=32)return t<=16?b(e,t):x(e,t);if(t<=64)return w(e,t);var r=n,a=n.mul(l).add(113),i=d(a.mul(f).add(113)).mul(f),o=[u.UZERO,u.UZERO],s=[u.UZERO,u.UZERO];r=r.mul(f).add(p(e,0));var h=0,v=64*(t-1>>6),k=v+(t-1&63)-63;do{r=m(r.add(a).add(o[0]).add(p(e,h+8)),37).mul(l),a=m(a.add(o[1]).add(p(e,h+48)),42).mul(l),r=r.xor(s[1]),a=a.add(o[0]).add(p(e,h+40)),i=m(i.add(s[0]),33).mul(l),o=y(e,h,o[1].mul(l),r.add(s[0])),s=y(e,h+32,i.add(s[1]),a.add(p(e,h+16)));var _=[r,i];i=_[0],r=_[1],h+=64}while(h!==v);var S=l.add(i.and(255).shl(1));h=k,s[0]=s[0].add(t-1&63),o[0]=o[0].add(s[0]),s[0]=s[0].add(o[0]),r=m(r.add(a).add(o[0]).add(p(e,h+8)),37).mul(S),a=m(a.add(o[1]).add(p(e,h+48)),42).mul(S),r=r.xor(s[1].mul(9)),a=a.add(o[0].mul(9).add(p(e,h+40))),i=m(i.add(s[0]),33).mul(S),o=y(e,h,o[1].mul(S),r.add(s[0])),s=y(e,h+32,i.add(s[1]),a.add(p(e,h+16)));var C=[r,i];return i=C[0],r=C[1],g(g(o[0],s[0],S).add(d(a).mul(c)).add(i),g(o[1],s[1],S).add(r),S)}function _(e,t){return"string"===t?E(e):S([e],t)}function S(e,t){if("string"===t)throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(e)&&(e=I(e)),(0,r.OB)().getBool("DEBUG")&&i.D5(e,t),function(e,t){return e instanceof Float32Array&&"float32"===t||e instanceof Int32Array&&"int32"===t||e instanceof Uint8Array&&"bool"===t}(e,t))return e;if(null==t||"float32"===t||"complex64"===t)return new Float32Array(e);if("int32"===t)return new Int32Array(e);if("bool"===t){for(var n=new Uint8Array(e.length),a=0;a<n.length;++a)0!==Math.round(e[a])&&(n[a]=1);return n}throw new Error("Unknown data type ".concat(t))}function C(){return(0,r.OB)().platform.now()}function A(e,t){return(0,r.OB)().platform.fetch(e,t)}function E(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"utf-8";return t=t||"utf-8",(0,r.OB)().platform.encode(e,t)}function N(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"utf-8";return t=t||"utf-8",(0,r.OB)().platform.decode(e,t)}function T(e){return null!=(0,r.OB)().platform.isTypedArray?(0,r.OB)().platform.isTypedArray(e):(0,a.j)(e)}function I(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(null==t&&(t=[]),"boolean"===typeof e||"number"===typeof e||"string"===typeof e||i.tI(e)||null==e||T(e)&&n)t.push(e);else if(Array.isArray(e)||T(e))for(var r=0;r<e.length;++r)I(e[r],t,n);else{for(var a=-1,o=0,u=Object.keys(e);o<u.length;o++){var s=u[o];/^([1-9]+[0-9]*|0)$/.test(s)&&(a=Math.max(a,Number(s)))}for(var c=0;c<=a;c++)I(e[c],t,n)}return t}},6147:function(e,t,n){"use strict";function r(e){for(var t=e.length,n=0;t>0;)n=Math.random()*t|0,u(e,--t,n)}function a(e,t){if(e.length!==t.length)throw new Error("Array sizes must match to be shuffled together "+"First array length was ".concat(e.length)+"Second array length was ".concat(t.length));for(var n=e.length,r=0;n>0;)r=Math.random()*n|0,u(e,--n,r),u(t,n,r)}function i(e,t,n){return Math.max(e,Math.min(t,n))}function o(e){return e%2===0?e:e+1}function u(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function s(e){for(var t=0,n=0;n<e.length;n++)t+=e[n];return t}function c(e,t){var n=Math.random();return t*n+(1-n)*e}function l(e,t){for(var n=0,r=0;r<e.length;r++){var a=Number(e[r])-Number(t[r]);n+=a*a}return n}function f(e,t){if(!e)throw new Error("string"===typeof t?t:t())}function d(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";f(g(e,t),(function(){return n+" Shapes ".concat(e," and ").concat(t," must match")}))}function h(e){f(null!=e,(function(){return"The input to the tensor constructor must be a non-null value."}))}function p(e){if(0===e.length)return 1;for(var t=e[0],n=1;n<e.length;n++)t*=e[n];return t}function v(e){return 0===e.length}function m(e,t){if(e===t)return!0;if(null==e||null==t)return!1;if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(null!==e[n]&&null!==t[n]&&e[n]!==t[n])return!1;return!0}function g(e,t){if(e===t)return!0;if(null==e||null==t)return!1;if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function y(e){return e%1===0}function b(e){if(null!=Math.tanh)return Math.tanh(e);if(e===1/0)return 1;if(e===-1/0)return-1;var t=Math.exp(2*e);return(t-1)/(t+1)}function x(e){var t=Math.ceil(Math.sqrt(e));return[t,Math.ceil(e/t)]}function w(e){for(var t=new Uint32Array(e),n=0;n<e;++n)t[n]=n;return r(t),t}function k(e,t){return t<=e.length?e:e+" ".repeat(t-e.length)}function _(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(e){return 0},n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;return new Promise((function(a,i){var o=0;!function u(){if(e())a();else{o++;var s=t(o);null!=n&&o>=n?i():null!=r?r(u,s):setTimeout(u,s)}}()}))}function S(e,t){for(var n=1,r=-1,a=0;a<e.length;++a)if(e[a]>=0)n*=e[a];else if(-1===e[a]){if(-1!==r)throw Error("Shapes can only have 1 implicit size. "+"Found -1 at dim ".concat(r," and dim ").concat(a));r=a}else if(e[a]<0)throw Error("Shapes can not be < 0. Found ".concat(e[a]," at dim ").concat(a));if(-1===r){if(t>0&&t!==n)throw Error("Size(".concat(t,") must match the product of shape ").concat(e));return e}if(0===n)throw Error("Cannot infer the missing size in [".concat(e,"] when ")+"there are 0 elements");if(t%n!==0)throw Error("The implicit shape can't be a fractional number. "+"Got ".concat(t," / ").concat(n));var i=e.slice();return i[r]=t/n,i}function C(e,t){var n=t.length;return f((e=null==e?t.map((function(e,t){return t})):[].concat(e)).every((function(e){return e>=-n&&e<n})),(function(){return"All values in axis param must be in range [-".concat(n,", ").concat(n,") but ")+"got axis ".concat(e)})),f(e.every((function(e){return y(e)})),(function(){return"All values in axis param must be integers but "+"got axis ".concat(e)})),e.map((function(e){return e<0?n+e:e}))}function A(e,t){for(var n=[],r=[],a=null!=t&&Array.isArray(t)&&0===t.length,i=null==t||a?null:C(t,e).sort(),o=0,u=0;u<e.length;++u){if(null!=i){if(i[o]===u&&1!==e[u])throw new Error("Can't squeeze axis ".concat(u," since its dim '").concat(e[u],"' is not 1"));(null==i[o]||i[o]>u)&&1===e[u]&&(n.push(e[u]),r.push(u)),i[o]<=u&&o++}1!==e[u]&&(n.push(e[u]),r.push(u))}return{newShape:n,keptDims:r}}function E(e,t){return N(e,t)}function N(e,t){var n=null;if(null==e||"float32"===e)n=new Float32Array(t);else if("int32"===e)n=new Int32Array(t);else if("bool"===e)n=new Uint8Array(t);else{if("string"!==e)throw new Error("Unknown data type ".concat(e));n=new Array(t)}return n}function T(e,t){for(var n=0;n<e.length;n++){var r=e[n];if(isNaN(r)||!isFinite(r))throw Error("A tensor of type ".concat(t," being uploaded contains ").concat(r,"."))}}function I(e){return"bool"===e||"complex64"===e||"float32"===e||"int32"===e||"string"===e}function D(e,t){return"complex64"!==t&&(("float32"!==t||"complex64"===e)&&(("int32"!==t||"float32"===e||"complex64"===e)&&("bool"!==t||"bool"!==e)))}function F(e){if("float32"===e||"int32"===e)return 4;if("complex64"===e)return 8;if("bool"===e)return 1;throw new Error("Unknown dtype ".concat(e))}function M(e){if(null==e)return 0;var t=0;return e.forEach((function(e){return t+=e.length})),t}function O(e){return"string"===typeof e||e instanceof String}function R(e){return"boolean"===typeof e}function j(e){return"number"===typeof e}function B(e){return Array.isArray(e)?B(e[0]):e instanceof Float32Array?"float32":e instanceof Int32Array||e instanceof Uint8Array||e instanceof Uint8ClampedArray?"int32":j(e)?"float32":O(e)?"string":R(e)?"bool":"float32"}function z(e){return!!(e&&e.constructor&&e.call&&e.apply)}function Z(e,t){for(var n=t;n<e;++n)if(e%n===0)return n;return e}function L(e){var t=e.length;if(t<2)return[];var n=new Array(t-1);n[t-2]=e[t-1];for(var r=t-3;r>=0;--r)n[r]=n[r+1]*e[r+1];return n}function P(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=new Array;if(1===t.length)for(var i=t[0]*(r?2:1),o=0;o<i;o++)a[o]=n[e+o];else for(var u=t[0],s=t.slice(1),c=s.reduce((function(e,t){return e*t}))*(r?2:1),l=0;l<u;l++)a[l]=P(e+l*c,s,n,r);return a}function U(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(0===e.length)return t[0];var r=e.reduce((function(e,t){return e*t}))*(n?2:1);if(0===r)return[];if(r!==t.length)throw new Error("[".concat(e,"] does not match the input size ").concat(t.length).concat(n?" for a complex tensor":"","."));return P(0,e,t,n)}function W(e,t){if(Array.isArray(e))return e;if("float32"===t)return e instanceof Float32Array?e:new Float32Array(e);if("int32"===t)return e instanceof Int32Array?e:new Int32Array(e);if("bool"===t||"string"===t)return Uint8Array.from(new Int32Array(e));throw new Error("Unknown dtype ".concat(t))}function V(e,t){for(var n=q(e,t),r=0;r<n.length;r++)n[r]=1;return n}function q(e,t){if(null==t||"float32"===t||"complex64"===t)return new Float32Array(e);if("int32"===t)return new Int32Array(e);if("bool"===t)return new Uint8Array(e);throw new Error("Unknown data type ".concat(t))}function G(e,t){var n=e.reduce((function(e,t){return e*t}),1);if(null==t||"float32"===t)return U(e,new Float32Array(n));if("int32"===t)return U(e,new Int32Array(n));if("bool"===t)return U(e,new Uint8Array(n));throw new Error("Unknown data type ".concat(t))}function H(e){e.forEach((function(t){f(Number.isInteger(t)&&t>=0,(function(){return"Tensor must have a shape comprised of positive integers but got "+"shape [".concat(e,"].")}))}))}function X(e,t,n){if(0===t)return 0;if(1===t)return e[0];for(var r=e[e.length-1],a=0;a<e.length-1;++a)r+=n[a]*e[a];return r}function K(e,t,n){if(0===t)return[];if(1===t)return[e];for(var r=new Array(t),a=0;a<r.length-1;++a)r[a]=Math.floor(e/n[a]),e-=r[a]*n[a];return r[r.length-1]=e,r}function Y(e){return e&&e.then&&"function"===typeof e.then}n.d(t,{AE:function(){return b},Cq:function(){return h},D2:function(){return B},D5:function(){return T},DK:function(){return m},E7:function(){return l},EC:function(){return C},GN:function(){return y},GX:function(){return U},HD:function(){return O},JZ:function(){return S},KS:function(){return W},LF:function(){return u},LP:function(){return I},Mu:function(){return H},NA:function(){return p},NE:function(){return K},QB:function(){return D},Sm:function(){return s},TV:function(){return r},U$:function(){return w},Ub:function(){return M},WD:function(){return _},WP:function(){return E},YP:function(){return x},bT:function(){return F},bj:function(){return c},bp:function(){return A},cO:function(){return g},d7:function(){return a},e3:function(){return L},hj:function(){return j},hu:function(){return f},jP:function(){return Z},jn:function(){return R},k5:function(){return d},l6:function(){return G},mf:function(){return z},nY:function(){return o},oj:function(){return k},p8:function(){return V},qy:function(){return X},rQ:function(){return N},tI:function(){return Y},uZ:function(){return i},wT:function(){return q},xH:function(){return v}})},6377:function(e,t,n){"use strict";var r=n(6690).default,a=n(9728).default,i=n(1655).default,o=n(6389).default;Object.defineProperty(t,"__esModule",{value:!0});var u=n(8294),s=n(7938),c=function(e){i(n,e);var t=o(n);function n(){return r(this,n),t.apply(this,arguments)}return a(n,[{key:"componentDidMount",value:function(){var e=this.props,t=e.name,n=e.tab;this.props.registerSurface(t,n,this)}},{key:"componentDidUpdate",value:function(){return!1}},{key:"render",value:function(){var e=this,t=this.props,r=t.name,a=t.visible,i=t.styles,o=Object.assign({},n.defaultStyles,i),c=o.width,l=o.height,f=o.maxHeight,d=o.maxWidth;f=l===n.defaultStyles.height?f:l,d=c===n.defaultStyles.width?d:c;var h=s.css({display:a?"block":"none",backgroundColor:"white",marginTop:"10px",marginBottom:"10px",boxShadow:"0 0 6px -3px #777",padding:"10px !important",height:l,width:c,maxHeight:f,maxWidth:d,overflow:"auto"}),p=s.css({backgroundColor:"white",boxSizing:"border-box",borderBottom:"1px solid #357EDD",lineHeight:"2em",marginBottom:"20px",fontWeight:"600",textAlign:"center"}),v=s.css({boxSizing:"border-box"});return u.h("div",{className:"".concat(h," tf-surface"),ref:function(t){return e.container=t},"data-visible":a},u.h("div",{className:"".concat(p," tf-label"),ref:function(t){return e.label=t}},r),u.h("div",{className:"".concat(v," tf-draw-area"),ref:function(t){return e.drawArea=t}}))}}]),n}(u.Component);c.defaultStyles={maxWidth:"550px",maxHeight:"580px",height:"auto",width:"auto"},t.SurfaceComponent=c},7733:function(e,t,n){"use strict";var r=n(6690).default,a=n(9728).default,i=n(1655).default,o=n(6389).default;Object.defineProperty(t,"__esModule",{value:!0});var u=n(8294),s=n(7938),c=function(e){i(n,e);var t=o(n);function n(){return r(this,n),t.apply(this,arguments)}return a(n,[{key:"render",value:function(){var e=this.props,t=e.tabNames,n=e.activeTab,r=e.handleClick,a=t.length>0?t.map((function(e){return u.h(l,{key:e,id:e,handleClick:r,isActive:e===n},e)})):null,i=s.css({overflowX:"scroll",overflowY:"hidden",whiteSpace:"nowrap",borderBottomStyle:"solid",borderBottomWidth:"1px",borderColor:"#eee",paddingBottom:"1rem",marginTop:"1rem"});return u.h("div",{className:"".concat(i," visor-tabs")},a)}}]),n}(u.Component);t.Tabs=c;var l=function(e){i(n,e);var t=o(n);function n(){return r(this,n),t.apply(this,arguments)}return a(n,[{key:"render",value:function(){var e=this.props,t=e.children,n=e.isActive,r=e.handleClick,a=e.id,i=s.css({borderBottomColor:n?"#357EDD":"#AAAAAA",borderBottomWidth:"1px",borderBottomStyle:"solid",cursor:"pointer",":hover":{color:"#357EDD"},display:"inline-block",marginRight:"1rem",padding:".5rem",fontSize:"1rem",fontWeight:"bold"});return u.h("a",{className:"".concat(i," tf-tab"),"data-isactive":n,onClick:function(){return r(a)}},t)}}]),n}(u.Component)},1042:function(e,t,n){"use strict";var r=n(4704).default,a=n(6690).default,i=n(9728).default,o=n(6115).default,u=n(1655).default,s=n(6389).default;Object.defineProperty(t,"__esModule",{value:!0});var c=n(8294),l=n(7938),f=n(6377),d=n(7733),h=function(e){u(n,e);var t=s(n);function n(e){var r;a(this,n),(r=t.call(this,e)).surfaces=new Map;var i=null==e.startOpen||e.startOpen;return r.state={isOpen:i,isFullscreen:!1,activeTab:null,tabs:new Set},r.keyHandler=r.keyHandler.bind(o(r)),r}return i(n,[{key:"close",value:function(){this.setState({isOpen:!1})}},{key:"open",value:function(){this.setState({isOpen:!0})}},{key:"toggle",value:function(){this.setState({isOpen:!this.state.isOpen})}},{key:"toggleFullScreen",value:function(){this.setState({isFullscreen:!this.state.isFullscreen})}},{key:"isOpen",value:function(){return this.state.isOpen}},{key:"isFullscreen",value:function(){return this.state.isFullscreen}},{key:"getSurface",value:function(e,t){var n,r=this.surfaceId(e,t);if(!this.surfaces.has(r))throw Error("Surface not found with id: ".concat(r));return{container:(n=this.surfaces.get(r)).container,label:n.label,drawArea:n.drawArea}}},{key:"bindKeys",value:function(){document.addEventListener("keydown",this.keyHandler,!1)}},{key:"unbindKeys",value:function(){document.removeEventListener("keydown",this.keyHandler)}},{key:"surfaceId",value:function(e,t){return e+t}},{key:"setTabs",value:function(e){var t,n,a=e.map((function(e){return e.tab})),i=this.state.tabs,o=r(a);try{for(o.s();!(n=o.n()).done;){var u=n.value;i.has(u)||(i.add(u),t=u)}}catch(s){o.e(s)}finally{o.f()}null!=t&&this.setState({tabs:i,activeTab:t})}},{key:"getTabs",value:function(){return this.state.tabs}},{key:"registerSurface",value:function(e,t,n){var r=this.surfaceId(e,t);this.surfaces.set(r,n)}},{key:"keyHandler",value:function(e){192===e.keyCode&&(e.shiftKey?this.toggleFullScreen():this.toggle())}},{key:"setActiveTab",value:function(e){this.setState({activeTab:e})}},{key:"componentDidMount",value:function(){this.bindKeys()}},{key:"componentWillMount",value:function(){this.setTabs(this.props.surfaceList)}},{key:"componentWillReceiveProps",value:function(e){this.setTabs(e.surfaceList)}},{key:"render",value:function(){var e=this,t=this.state,n=t.isOpen,r=t.isFullscreen,a=t.activeTab,i=this.props.surfaceList,o=Array.from(this.getTabs().values()),u=r?"90vw":"550px",s=l.css({width:u,height:"100%",backgroundColor:"#fafafa",boxSizing:"border-box",padding:"10px",position:"fixed",top:"0px",transition:"right 0.5s cubic-bezier(0.645, 0.045, 0.355, 1), width 0.5s cubic-bezier(0.645, 0.045, 0.355, 1)",boxShadow:"0 2px 5px rgba(0, 0, 0, 0.12), 0 2px 5px rgba(0, 0, 0, 0.24)",overflow:"auto",fontFamily:"sans-serif",fontSize:"14px",zIndex:1e3}),h=l.css({right:"0"}),v=l.css({right:"calc(-".concat(u," - 10px)")}),m=n?h:v,g=l.css({});return c.h("div",{className:"".concat(s," ").concat(m," visor"),"data-isopen":n,"data-isfullscreen":r},c.h(p,{fullScreenHandler:this.toggleFullScreen.bind(this),closeHandler:this.close.bind(this),isFullScreen:r}),c.h(d.Tabs,{tabNames:o,activeTab:a,handleClick:this.setActiveTab.bind(this)}),c.h("div",{className:"".concat(g," visor-surfaces")},i.map((function(t){return c.h(f.SurfaceComponent,{key:t.name+t.tab,name:t.name,tab:t.tab,styles:t.styles,registerSurface:e.registerSurface.bind(e),visible:a===t.tab})}))))}}],[{key:"render",value:function(e,t,r){return c.render(c.h(n,Object.assign({},r)),e,t)}}]),n}(c.Component);function p(e){var t=e.isFullScreen,n=e.fullScreenHandler,r=e.closeHandler,a=l.css({display:"flex",backgroundColor:"white",border:"1px solid white",padding:"6px",paddingTop:"10px",marginBottom:"10px",borderRadius:"6px",marginTop:"-16px"}),i=l.css({fontSize:".875rem",borderRadius:".25rem",paddingLeft:"1rem",paddingRight:"1rem",paddingTop:".5rem",paddingBottom:".5rem",textDecoration:"none",transition:"color .15s ease-in",color:"#111"}),o=l.css({marginLeft:"auto"});return c.h("div",{className:"".concat(a," visor-controls")},c.h("button",{className:"".concat(i),onClick:n},t?"Minimize":"Maximize"),c.h("button",{className:"".concat(i," ").concat(o),onClick:r},"Hide"))}t.VisorComponent=h},386:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n(3613),n(4672);var r=n(3168),a=n(8249),i=n(5342),o=n(6863),u=n(298),s=n(6623),c=n(3413),l=n(4469),f=n(3443),d=n(2150),h=n(3936),p=n(1207),v=n(74);t.version_vis=v.version;var m={barchart:r.barchart,table:c.table,histogram:o.histogram,linechart:u.linechart,scatterplot:s.scatterplot,confusionMatrix:a.confusionMatrix,heatmap:i.heatmap};t.render=m;var g={accuracy:p.accuracy,perClassAccuracy:p.perClassAccuracy,confusionMatrix:p.confusionMatrix};t.metrics=g;var y={history:l.history,fitCallbacks:l.fitCallbacks,perClassAccuracy:d.perClassAccuracy,valuesDistribution:h.valuesDistribution,layer:f.layer,modelSummary:f.modelSummary};t.show=y;var b=n(2890);t.visor=b.visor,function(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}(n(9263))},3168:function(e,t,n){"use strict";var r=n(4687),a=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(a,i){function o(e){try{s(r.next(e))}catch(t){i(t)}}function u(e){try{s(r.throw(e))}catch(t){i(t)}}function s(e){e.done?a(e.value):new n((function(t){t(e.value)})).then(o,u)}s((r=r.apply(e,t||[])).next())}))},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=i(n(5596)),u=n(1522),s=n(1253);t.barchart=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return a(this,void 0,void 0,r.mark((function a(){var i,f,d,h,p,v,m,g,y,b,x,w,k,_,S,C;return r.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(i=s.getDrawArea(e),f=t,d=Object.assign({},c,n),!l.has(i)){r.next=13;break}if(h=l.get(i),!s.shallowEquals(d,h.lastOptions)){r.next=13;break}return r.next=8,s.nextFrame();case 8:return p=h.view,v=p.changeset().remove((function(){return!0})).insert(f),r.next=12,p.change("values",v).runAsync();case 12:return r.abrupt("return");case 13:return m=d.xLabel,g=d.yLabel,y=d.xType,b=d.yType,x=null,null!=m&&(x={title:m}),w=null,null!=g&&(w={title:g}),k={actions:!1,mode:"vega-lite",defaultStyle:!1},_=null!=d.color?Array.isArray(d.color)?{field:"index",type:"nominal",scale:{range:d.color}}:{value:d.color}:{value:"#4C78A0"},S={width:d.width||u.getDefaultWidth(i),height:d.height||u.getDefaultHeight(i),padding:0,autosize:{type:"fit",contains:"padding",resize:!0},config:{axis:{labelFontSize:d.fontSize,titleFontSize:d.fontSize},text:{fontSize:d.fontSize},legend:{labelFontSize:d.fontSize,titleFontSize:d.fontSize}},data:{values:f,name:"values"},mark:{type:"bar",tooltip:!0},encoding:{x:{field:"index",type:y,axis:x},y:{field:"value",type:b,axis:w},color:_}},r.next=23,s.nextFrame();case 23:return r.next=25,o.default(i,S,k);case 25:C=r.sent,l.set(i,{view:C.view,lastOptions:d});case 27:case"end":return r.stop()}}),a)})))};var c={xLabel:"",yLabel:"",xType:"ordinal",yType:"quantitative",fontSize:11},l=new Map},8249:function(e,t,n){"use strict";var r=n(4687),a=n(4704).default,i=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(a,i){function o(e){try{s(r.next(e))}catch(t){i(t)}}function u(e){try{s(r.throw(e))}catch(t){i(t)}}function s(e){e.done?a(e.value):new n((function(t){t(e.value)})).then(o,u)}s((r=r.apply(e,t||[])).next())}))},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var u=o(n(5596)),s=n(1522),c=n(1253);t.confusionMatrix=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return i(this,void 0,void 0,r.mark((function i(){var o,f,d,h,p,v,m,g,y,b,x,w,k,_,S,C,A,E;return r.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:for(o=Object.assign({},l,n),f=c.getDrawArea(e),d=[],h=t.values,p=t.tickLabels||[],v=0===p.length,m=!0,g=0;g<h.length;g++)for(y=v?"Class ".concat(g):p[g],v&&p.push(y),b=0;b<h[g].length;b++)x=v?"Class ".concat(b):p[b],w=h[g][b],g!==b||o.shadeDiagonal?(d.push({label:y,prediction:x,count:w,scaleCount:w}),0!==w&&(m=!1)):d.push({label:y,prediction:x,count:w,noFill:!0});if(!o.shadeDiagonal&&m){k=a(d);try{for(k.s();!(_=k.n()).done;)!0===(S=_.value).noFill&&(S.noFill=!1,S.scaleCount=S.count)}catch(i){k.e(i)}finally{k.f()}}return C={actions:!1,mode:"vega-lite",defaultStyle:!1},A={width:o.width||s.getDefaultWidth(f),height:o.height||s.getDefaultHeight(f),padding:0,autosize:{type:"fit",contains:"padding",resize:!0},config:{axis:{labelFontSize:o.fontSize,titleFontSize:o.fontSize},text:{fontSize:o.fontSize},legend:{labelFontSize:o.fontSize,titleFontSize:o.fontSize}},data:{values:d},encoding:{x:{field:"prediction",type:"ordinal",title:o.xLabel||"prediction",scale:{domain:p}},y:{field:"label",type:"ordinal",title:o.yLabel||"label",scale:{domain:p}}},layer:[{transform:[{filter:"datum.noFill != true"}],mark:{type:"rect"},encoding:{color:{field:"scaleCount",type:"quantitative",scale:{range:o.colorMap}},tooltip:[{field:"label",type:"nominal"},{field:"prediction",type:"nominal"},{field:"count",type:"quantitative"}]}}]},!1===o.shadeDiagonal&&A.layer.push({transform:[{filter:"datum.noFill == true"}],mark:{type:"rect",fill:"white"},encoding:{tooltip:[{field:"label",type:"nominal"},{field:"prediction",type:"nominal"},{field:"count",type:"quantitative"}]}}),o.showTextOverlay&&A.layer.push({mark:{type:"text",baseline:"middle"},encoding:{text:{field:"count",type:"nominal"}}}),E="string"===typeof o.colorMap?{scheme:o.colorMap}:o.colorMap,A.layer[0].encoding.color.scale.range=E,r.next=17,u.default(f,A,C);case 17:case"end":return r.stop()}}),i)})))};var l={xLabel:null,yLabel:null,xType:"nominal",yType:"nominal",shadeDiagonal:!0,fontSize:12,showTextOverlay:!0,height:400,colorMap:["#f7fbff","#4292c6"]}},5342:function(e,t,n){"use strict";var r=n(4687),a=n(7424).default,i=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(a,i){function o(e){try{s(r.next(e))}catch(t){i(t)}}function u(e){try{s(r.throw(e))}catch(t){i(t)}}function s(e){e.done?a(e.value):new n((function(t){t(e.value)})).then(o,u)}s((r=r.apply(e,t||[])).next())}))},o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t},u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var s=o(n(3613)),c=u(n(5596)),l=n(1522),f=n(5330),d=n(1253);function h(e){return i(this,void 0,void 0,r.mark((function t(){var n,a,i,o;return r.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e instanceof s.Tensor?(n=e.shape,a=e.transpose()):(n=[e.length,e[0].length],a=s.tidy((function(){return s.tensor2d(e).transpose()}))),f.assert(2===a.rank,"Input to renderHeatmap must be a 2d array or Tensor2d"),t.next=4,a.array();case 4:return i=t.sent,a.dispose(),o=[i.length,i[0].length],f.assert(n[0]===o[1]&&n[1]===o[0],"Unexpected transposed shape. Original ".concat(n," : Transposed ").concat(o)),t.abrupt("return",i);case 9:case"end":return t.stop()}}),t)})))}function p(e,t,n){var r=e instanceof s.Tensor?e.shape:[e.length,e[0].length];0===n?f.assert(r[0]===t.length,"Length of xTickLabels (".concat(t.length,") must match number of rows")+" (".concat(r[0],")")):1===n&&f.assert(r[1]===t.length,"Length of yTickLabels (".concat(t.length,") must match number of columns (").concat(r[1],")"))}t.heatmap=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return i(this,void 0,void 0,r.mark((function i(){var o,u,m,g,y,b,x,w,k,_,S,C,A,E,N,T,I,D,F,M,O,R,j,B,z,Z,L,P;return r.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(o=Object.assign({},v,n),u=d.getDrawArea(e),m=t.values,!o.rowMajor){r.next=7;break}return r.next=6,h(t.values);case 6:m=r.sent;case 7:if(g=t.xTickLabels,y=t.yTickLabels,null!=g&&(0,p(m,g,0)),null!=y&&(1,p(m,y,1)),b="@tfidx@",x=[],!(m instanceof s.Tensor)){r.next=21;break}return f.assert(2===m.rank,"Input to renderHeatmap must be a 2d array or Tensor2d"),r.next=16,m.data();case 16:for(w=r.sent,k=a(m.shape,2),_=k[0],S=k[1],C=0;C<_;C++)for(A=g?"".concat(g[C]).concat(b).concat(C):C,E=0;E<S;E++)N=y?"".concat(y[E]).concat(b).concat(E):E,T=w[C*S+E],x.push({x:A,y:N,value:T});r.next=23;break;case 21:for(I=m,D=0;D<I.length;D++)for(F=g?"".concat(g[D]).concat(b).concat(D):D,M=0;M<I[D].length;M++)O=y?"".concat(y[M]).concat(b).concat(M):M,R=I[D][M],x.push({x:F,y:O,value:R});case 23:j={actions:!1,mode:"vega-lite",defaultStyle:!1},B={width:o.width||l.getDefaultWidth(u),height:o.height||l.getDefaultHeight(u),padding:0,autosize:{type:"fit",contains:"padding",resize:!0},config:{axis:{labelFontSize:o.fontSize,titleFontSize:o.fontSize},text:{fontSize:o.fontSize},legend:{labelFontSize:o.fontSize,titleFontSize:o.fontSize},scale:{bandPaddingInner:0,bandPaddingOuter:0}},data:{values:x},mark:{type:"rect",tooltip:!0},encoding:{x:{field:"x",type:o.xType,title:o.xLabel,sort:!1},y:{field:"y",type:o.yType,title:o.yLabel,sort:!1},fill:{field:"value",type:"quantitative"}}},z="".concat(b,"\\d+$"),Z=new RegExp(z),g&&(B.encoding.x.axis={labelExpr:"replace(datum.value, regexp(/".concat(z,"/), '')")}),y&&(B.encoding.y.axis={labelExpr:"replace(datum.value, regexp(/".concat(z,"/), '')")}),(g||y)&&(j.tooltip={sanitize:function(e){return String(e).replace(Z,"")}}),r.t0=o.colorMap,r.next="blues"===r.t0?33:"greyscale"===r.t0?35:(r.t0,37);break;case 33:return L=["#f7fbff","#4292c6"],r.abrupt("break",39);case 35:return L=["#000000","#ffffff"],r.abrupt("break",39);case 37:return L="viridis",r.abrupt("break",39);case 39:return"viridis"!==L&&(B.encoding.fill.scale={range:L}),o.domain&&(null!=(P=B.encoding.fill).scale?P.scale=Object.assign({},P.scale,{domain:o.domain}):P.scale={domain:o.domain}),r.next=43,c.default(u,B,j);case 43:case"end":return r.stop()}}),i)})))};var v={xLabel:null,yLabel:null,xType:"ordinal",yType:"ordinal",colorMap:"viridis",fontSize:12,domain:null,rowMajor:!1}},6863:function(e,t,n){"use strict";var r=n(4687),a=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(a,i){function o(e){try{s(r.next(e))}catch(t){i(t)}}function u(e){try{s(r.throw(e))}catch(t){i(t)}}function s(e){e.done?a(e.value):new n((function(t){t(e.value)})).then(o,u)}s((r=r.apply(e,t||[])).next())}))},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=n(1848),u=i(n(5596)),s=n(1522),c=n(1207),l=n(3413),f={maxBins:12,fontSize:11};function d(e,t,n){var r=o.format(",.4~f"),a=o.format(".4~p"),i=[],u=[];if(null!=e.numVals&&(i.push("Num Vals"),u.push(r(e.numVals))),null!=e.min&&(i.push("Min"),u.push(r(e.min))),null!=e.max&&(i.push("Max"),u.push(r(e.max))),null!=e.numZeros){i.push("# Zeros");var s="";e.numVals&&(s=e.numZeros>0?"(".concat(a(e.numZeros/e.numVals),")"):""),u.push("".concat(r(e.numZeros)," ").concat(s))}if(null!=e.numNans){i.push("# NaNs");var c="";e.numVals&&(c=e.numNans>0?"(".concat(a(e.numNans/e.numVals),")"):""),u.push("".concat(r(e.numNans)," ").concat(c))}if(null!=e.numInfs){i.push("# Infinity");var f="";e.numVals&&(f=e.numInfs>0?"(".concat(a(e.numInfs/e.numVals),")"):""),u.push("".concat(r(e.numInfs)," ").concat(f))}l.table(t,{headers:i,values:[u]},n)}function h(e){if(null==e.length)throw new Error("input data must be an array");if(0===e.length)return[];if("object"===typeof e[0]){if(null==e[0].value)throw new Error("input data must have a value field");return e}for(var t=Array(e.length),n=0;n<e.length;n++)t[n]={value:e[n]};return t}t.histogram=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return a(this,void 0,void 0,r.mark((function a(){var i,o,l,p,v,m,g,y,b;return r.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(i=h(t),o=Object.assign({},f,n),l={actions:!1,mode:"vega-lite",defaultStyle:!1},p=s.subSurface(e,"histogram"),!1!==n.stats&&(v=s.subSurface(e,"stats",{prepend:!0}),d(n.stats?n.stats:c.arrayStats(i.map((function(e){return e.value}))),v,{fontSize:o.fontSize})),0!==i.length){r.next=7;break}return r.abrupt("return",void 0);case 7:for(m=[],g=0;g<i.length;g++)null!=(y=i[g].value)&&isFinite(y)&&m.push(i[g]);return b={width:o.width||s.getDefaultWidth(p),height:o.height||s.getDefaultHeight(p),padding:0,autosize:{type:"fit",contains:"padding",resize:!0},data:{values:m},mark:{type:"bar",tooltip:!0},config:{axis:{labelFontSize:o.fontSize,titleFontSize:o.fontSize},text:{fontSize:o.fontSize},legend:{labelFontSize:o.fontSize,titleFontSize:o.fontSize}},encoding:{x:{bin:{maxbins:o.maxBins},field:"value",type:"quantitative"},y:{aggregate:"count",type:"quantitative"},color:{value:o.color||"#001B44"}}},r.abrupt("return",u.default(p,b,l));case 11:case"end":return r.stop()}}),a)})))}},298:function(e,t,n){"use strict";var r=n(4687),a=n(861).default,i=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(a,i){function o(e){try{s(r.next(e))}catch(t){i(t)}}function u(e){try{s(r.throw(e))}catch(t){i(t)}}function s(e){e.done?a(e.value):new n((function(t){t(e.value)})).then(o,u)}s((r=r.apply(e,t||[])).next())}))},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var u=o(n(5596)),s=n(1522),c=n(5330),l=n(1253);t.linechart=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return i(this,void 0,void 0,r.mark((function i(){var o,d,h,p,v,m,g,y,b,x,w,k,_,S;return r.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:for(o=Array.isArray(t.values[0])?t.values:[t.values],d=o[0].length,h=t.series?t.series:o.map((function(e,t){return"Series ".concat(t+1)})),c.assert(h.length===o.length,"Must have an equal number of series labels as there are data series"),null!=n.seriesColors&&c.assert(n.seriesColors.length===o.length,"Must have an equal number of series colors as there are data series"),p=[],v=function(e){var t={x:e};h.forEach((function(n,r){var a=o[r][e].y;t[n]=a,t["".concat(n,"-name")]=n})),p.push(t)},m=0;m<d;m++)v(m);return g=Object.assign({},f,n),y=function(){return g.zoomToFit?{zero:!1}:null!=g.yAxisDomain?{domain:g.yAxisDomain}:void 0},b={x:{field:"x",type:g.xType,title:g.xLabel},tooltip:[{field:"x",type:"quantitative"}].concat(a(h.map((function(e){return{field:e,type:"quantitative"}}))))},x=h.map((function(e){return{data:void 0,mark:{type:"line",clip:!0},encoding:{y:{field:e,type:g.yType,title:g.yLabel,scale:y()},color:{field:"".concat(e,"-name"),type:"nominal",legend:{values:h,title:null},scale:{range:g.seriesColors}}}}})),w={mark:"rule",selection:{hover:{type:"single",on:"mouseover",nearest:!0,clear:"mouseout"}},encoding:{color:{value:"grey",condition:{selection:{not:"hover"},value:"transparent"}}}},k=l.getDrawArea(e),_={width:g.width||s.getDefaultWidth(k),height:g.height||s.getDefaultHeight(k),padding:0,autosize:{type:"fit",contains:"padding",resize:!0},config:{axis:{labelFontSize:g.fontSize,titleFontSize:g.fontSize},text:{fontSize:g.fontSize},legend:{labelFontSize:g.fontSize,titleFontSize:g.fontSize}},data:{values:p},encoding:b,layer:[].concat(a(x),[w])},S={actions:!1,mode:"vega-lite",defaultStyle:!1},r.next=18,u.default(k,_,S);case 18:return r.abrupt("return",Promise.resolve());case 19:case"end":return r.stop()}}),i)})))};var f={xLabel:"x",yLabel:"y",xType:"quantitative",yType:"quantitative",zoomToFit:!1,fontSize:11}},1253:function(e,t,n){"use strict";var r=n(4687),a=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(a,i){function o(e){try{s(r.next(e))}catch(t){i(t)}}function u(e){try{s(r.throw(e))}catch(t){i(t)}}function s(e){e.done?a(e.value):new n((function(t){t(e.value)})).then(o,u)}s((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});var i=n(9263),o=n(2890);t.getDrawArea=function(e){if(e instanceof HTMLElement)return e;if(i.isSurface(e))return e.drawArea;if(i.isSurfaceInfo(e))return o.visor().surface({name:e.name,tab:e.tab,styles:e.styles}).drawArea;throw new Error("Not a drawable")},t.shallowEquals=function(e,t){var n=Object.getOwnPropertyNames(e),r=Object.getOwnPropertyNames(t);if(n.length!==r.length)return!1;for(var a=0;a<n.length;a++){var i=n[a];if(e[i]!==t[i])return!1}return!0},t.nextFrame=function(){return a(this,void 0,void 0,r.mark((function e(){return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Promise((function(e){return requestAnimationFrame(e)}));case 2:case"end":return e.stop()}}),e)})))}},6623:function(e,t,n){"use strict";var r=n(4687),a=n(861).default,i=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(a,i){function o(e){try{s(r.next(e))}catch(t){i(t)}}function u(e){try{s(r.throw(e))}catch(t){i(t)}}function s(e){e.done?a(e.value):new n((function(t){t(e.value)})).then(o,u)}s((r=r.apply(e,t||[])).next())}))},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var u=o(n(5596)),s=n(1522),c=n(5330),l=n(1253);t.scatterplot=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return i(this,void 0,void 0,r.mark((function i(){var o,d,h,p,v,m,g,y,b;return r.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return o=t.values,d=null==t.series?[]:t.series,o=Array.isArray(o[0])?o:[o],h=[],o.forEach((function(e,t){var n=null!=d[t]?d[t]:"Series ".concat(t+1),r=e.map((function(e){return Object.assign({},e,{series:n})}));h.push.apply(h,a(r))})),null!=n.seriesColors&&c.assert(n.seriesColors.length===o.length,"Must have an equal number of series colors as there are data series"),p=l.getDrawArea(e),v=Object.assign({},f,n),m={actions:!1,mode:"vega-lite",defaultStyle:!1},g=function(){return v.zoomToFit?{zero:!1}:null!=v.xAxisDomain?{domain:v.xAxisDomain}:void 0},y=function(){return v.zoomToFit?{zero:!1}:null!=v.yAxisDomain?{domain:v.yAxisDomain}:void 0},b={width:v.width||s.getDefaultWidth(p),height:v.height||s.getDefaultHeight(p),padding:0,autosize:{type:"fit",contains:"padding",resize:!0},config:{axis:{labelFontSize:v.fontSize,titleFontSize:v.fontSize},text:{fontSize:v.fontSize},legend:{labelFontSize:v.fontSize,titleFontSize:v.fontSize}},data:{values:h},mark:{type:"point",clip:!0,tooltip:{content:"data"}},encoding:{x:{field:"x",type:v.xType,title:v.xLabel,scale:g()},y:{field:"y",type:v.yType,title:v.yLabel,scale:y()},color:{field:"series",type:"nominal",scale:{range:v.seriesColors}},shape:{field:"series",type:"nominal"}}},r.next=14,u.default(p,b,m);case 14:return r.abrupt("return",Promise.resolve());case 15:case"end":return r.stop()}}),i)})))};var f={xLabel:"x",yLabel:"y",xType:"quantitative",yType:"quantitative",zoomToFit:!1,fontSize:11}},3413:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1848),a=n(6360),i=n(7938),o=n(1253);t.table=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(t&&null==t.headers)throw new Error('Data to render must have a "headers" property');if(t&&null==t.values)throw new Error('Data to render must have a "values" property');var s=o.getDrawArea(e),c=Object.assign({},u,n),l=a.select(s).select("table.tf-table"),f=i.css({fontSize:c.fontSize||".875rem",width:"100%",maxWidth:"64rem",marginRight:"auto",marginLeft:"auto"});if(0===l.size()&&((l=a.select(s).append("table")).attr("class"," ".concat(f," tf-table")),l.append("thead").append("tr"),l.append("tbody")),1!==l.size())throw new Error("Error inserting table");var d=i.css({fontWeight:"600",borderBottomStyle:"solid",borderBottomWidth:"1px",borderColor:"rgba( 0, 0, 0, .2 )",textAlign:"left",paddingBottom:"1rem",paddingRight:"1rem",backgroundColor:"#fff"}),h=l.select("thead").select("tr").selectAll("th").data(t.headers),p=h.enter().append("th").attr("class","".concat(d));h.merge(p).html((function(e){return e})),h.exit().remove();var v=r.format(",.4~f"),m=l.select("tbody").selectAll("tr").data(t.values),g=m.enter().append("tr"),y=i.css({padding:"0.25rem",borderBottomStyle:"solid",borderBottomWidth:"1px",borderColor:"rgba( 0, 0, 0, .2 )"}),b=m.merge(g).selectAll("td").data((function(e){return e})),x=b.enter().append("td").attr("class","".concat(y));b.merge(x).html((function(e){return"number"===typeof e?v(e):e})),b.exit().remove(),m.exit().remove()};var u={fontSize:14}},4469:function(e,t,n){"use strict";var r=n(8416).default,a=n(4687),i=n(4704).default,o=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(a,i){function o(e){try{s(r.next(e))}catch(t){i(t)}}function u(e){try{s(r.throw(e))}catch(t){i(t)}}function s(e){e.done?a(e.value):new n((function(t){t(e.value)})).then(o,u)}s((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});var u=n(298),s=n(1253),c=n(1522);function l(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return o(this,void 0,void 0,a.mark((function o(){var l,h,p,v,m,g,y,b,x,w,k,_,S,C,A,E,N,T;return a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:l=s.getDrawArea(e),h={},p=i(n);try{for(p.s();!(v=p.n()).done;)m=v.value,/val_/.test(m)?(y=m.replace("val_",""),f(h,y),b=d(t,m,n.indexOf(m)),h[y].series.push(m),h[y].values.push(b)):(g=d(t,m,n.indexOf(m)),f(h,m),h[m].series.push(m),h[m].values.push(g))}catch(o){p.e(o)}finally{p.f()}for(x=Object.keys(h),w=Object.assign({},{xLabel:"Iteration",yLabel:"Value"},r),k=[],_=0,S=x;_<S.length;_++)C=S[_],A=c.subSurface(l,C),E=h[C].series,N=h[C].values,E.every((function(e){return Boolean(e.match("acc"))}))&&(w.zoomToFitAccuracy?w.zoomToFit=!0:(w.yAxisDomain=[0,1],delete w.zoomToFit)),T=u.linechart(A,{values:N,series:E},w),k.push(T);return a.next=10,Promise.all(k);case 10:case"end":return a.stop()}}),o)})))}function f(e,t){null==e[t]&&(e[t]={series:[],values:[]})}function d(e,t,n){if(Array.isArray(e)){for(var r=Array.isArray(e[0])?e[n]:e,a=[],i=0;i<r.length;i++){var o=r[i];a.push({x:i,y:o[t]})}return a}return e.history[t].map((function(e,t){return{x:t,y:e}}))}function h(e,t,n){return null==e[t]&&(e[t]={}),null==e[t][n]&&(e[t][n]=[]),e[t][n]}t.history=l,t.fitCallbacks=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},u={},f=n.callbacks||["onEpochEnd","onBatchEnd"],d=s.getDrawArea(e),p=Object.assign({},n);function v(e){var n=this;return function(f,v){return o(n,void 0,void 0,a.mark((function n(){var o,f,m,g,y,b;return a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:/batch/i.test(e)?p.xLabel="Batch":/epoch/i.test(e)&&(p.xLabel="Epoch"),o=[],f=[],m=i(t);try{for(m.s();!(g=m.n()).done;)y=g.value,null!=v[y]&&(f.push(y),(b=h(u,e,y)).push(r({},y,v[y])),o.push(b))}catch(a){m.e(a)}finally{m.f()}return l(c.subSurface(d,e,{title:e}),o,f,p),n.next=9,s.nextFrame();case 9:case"end":return n.stop()}}),n)})))}}delete p.callbacks;var m={};return f.forEach((function(e){m[e]=v(e)})),m}},3443:function(e,t,n){"use strict";var r=n(4687),a=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(a,i){function o(e){try{s(r.next(e))}catch(t){i(t)}}function u(e){try{s(r.throw(e))}catch(t){i(t)}}function s(e){e.done?a(e.value):new n((function(t){t(e.value)})).then(o,u)}s((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});var i=n(6863),o=n(1253),u=n(3413),s=n(1522),c=n(1207);function l(e){return{layers:e.layers.map(f)}}function f(e){var t;if(Array.isArray(e.outputShape[0])){var n=e.outputShape.map((function(e){return h(e)}));t="[".concat(n.join(", "),"]")}else t=h(e.outputShape);return{name:e.name,trainable:e.trainable,parameters:e.countParams(),outputShape:t}}function d(e){return a(this,void 0,void 0,r.mark((function t(){var n,a,i,o,u;return r.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.getWeights(),a=e.weights,i=n.map(c.tensorStats),t.next=5,Promise.all(i);case 5:return o=t.sent,u=n.map((function(e){return e.shape})),t.abrupt("return",n.map((function(e,t){return{name:a[t].name,stats:o[t],shape:h(u[t]),weight:e}})));case 8:case"end":return t.stop()}}),t)})))}function h(e){var t=e.slice();return 0===t.length?"Scalar":(null===t[0]&&(t[0]="batch"),"[".concat(t.join(","),"]"))}function p(e,t,n){var r="\n    <select>\n      ".concat(e.map((function(e){return"<option value=".concat(e,">").concat(e,"</option>")})),"\n    </select>\n  "),a="<div>".concat("<button>Show Values Distribution for:</button>").concat(r,"</div>");t.innerHTML=a;var i=t.querySelector("button"),o=t.querySelector("select");i.addEventListener("click",(function(){n(o.selectedOptions[0].label)}))}t.modelSummary=function(e,t){return a(this,void 0,void 0,r.mark((function n(){var a,i,s,c;return r.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:a=o.getDrawArea(e),i=l(t),s=["Layer Name","Output Shape","# Of Params","Trainable"],c=i.layers.map((function(e){return[e.name,e.outputShape,e.parameters,e.trainable]})),u.table(a,{headers:s,values:c});case 5:case"end":return n.stop()}}),n)})))},t.layer=function(e,t){return a(this,void 0,void 0,r.mark((function n(){var c,l,f,h,v,m,g,y,b=this;return r.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return c=o.getDrawArea(e),n.next=3,d(t);case 3:l=n.sent,f=["Weight Name","Shape","Min","Max","# Params","# Zeros","# NaNs","# Infinity"],h=s.subSurface(c,"layer-weights-info"),v=l.map((function(e){return[e.name,e.shape,e.stats.min,e.stats.max,e.weight.size,e.stats.numZeros,e.stats.numNans,e.stats.numInfs]})),u.table(h,{headers:f,values:v}),m=s.subSurface(c,"select-layer"),g=s.subSurface(c,"param-distribution"),y=function(e){return a(b,void 0,void 0,r.mark((function t(){var n,a;return r.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=l.filter((function(t){return t.name===e}))[0],t.next=3,n.weight.data();case 3:a=t.sent,i.histogram(g,a,{height:150,width:460,stats:!1});case 5:case"end":return t.stop()}}),t)})))},p(l.map((function(e){return e.name})),m,y);case 12:case"end":return n.stop()}}),n)})))}},2150:function(e,t,n){"use strict";var r=n(4687),a=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(a,i){function o(e){try{s(r.next(e))}catch(t){i(t)}}function u(e){try{s(r.throw(e))}catch(t){i(t)}}function s(e){e.done?a(e.value):new n((function(t){t(e.value)})).then(o,u)}s((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});var i=n(1253),o=n(3413);t.perClassAccuracy=function(e,t,n){return a(this,void 0,void 0,r.mark((function a(){var u,s,c,l,f,d;return r.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:for(u=i.getDrawArea(e),s=["Class","Accuracy","# Samples"],c=[],l=0;l<t.length;l++)f=n?n[l]:l.toString(),d=t[l],c.push([f,d.accuracy,d.count]);return r.abrupt("return",o.table(u,{headers:s,values:c}));case 5:case"end":return r.stop()}}),a)})))}},3936:function(e,t,n){"use strict";var r=n(4687),a=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(a,i){function o(e){try{s(r.next(e))}catch(t){i(t)}}function u(e){try{s(r.throw(e))}catch(t){i(t)}}function s(e){e.done?a(e.value):new n((function(t){t(e.value)})).then(o,u)}s((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});var i=n(6863),o=n(1253),u=n(1207);t.valuesDistribution=function(e,t){return a(this,void 0,void 0,r.mark((function n(){var a,s,c;return r.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return a=o.getDrawArea(e),n.next=3,u.tensorStats(t);case 3:return s=n.sent,n.next=6,t.data();case 6:c=n.sent,i.histogram(a,c,{height:150,stats:s});case 8:case"end":return n.stop()}}),n)})))}},9263:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isSurfaceInfo=function(e){return null!=e.name},t.isSurface=function(e){return e.drawArea instanceof HTMLElement}},1522:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(7938),a=n(1253),i={prepend:!1};t.subSurface=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=a.getDrawArea(e),u=r.css({"& canvas":{display:"block"},marginTop:".5rem",marginBottom:".5rem"}),s=r.css({backgroundColor:"white",display:"inline-block",boxSizing:"border-box",borderBottom:"1px solid #357EDD",lineHeight:"2em",padding:"0 10px 0 10px",marginBottom:"20px",fontWeight:"600",textAlign:"left"}),c=Object.assign({},i,n),l=o.querySelector("div[data-name=".concat(t,"]"));if(!l){if((l=document.createElement("div")).setAttribute("class","".concat(u)),l.dataset.name=t,c.title){var f=document.createElement("div");f.setAttribute("class","subsurface-title ".concat(s)),f.innerText=c.title,l.appendChild(f)}c.prepend?o.insertBefore(l,o.firstChild):o.appendChild(l)}return l},t.getDefaultWidth=function(e){for(var t=0,n=e;n&&0===n.clientWidth;)n=n.parentElement,t=50;return n.clientWidth-t},t.getDefaultHeight=function(e){return 0===e.clientHeight?200:e.clientHeight}},1207:function(e,t,n){"use strict";var r=n(4687),a=n(7424).default,i=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(a,i){function o(e){try{s(r.next(e))}catch(t){i(t)}}function u(e){try{s(r.throw(e))}catch(t){i(t)}}function s(e){e.done?a(e.value):new n((function(t){t(e.value)})).then(o,u)}s((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});var o=n(3613),u=n(5330);t.arrayStats=function(e){if(!Array.isArray(e))throw new Error("input must be an array");if(0===e.length)return{numVals:0,numNans:0,numZeros:0,max:void 0,min:void 0};for(var t=e.length,n=-1/0,r=1/0,a=0,i=0,o=0,u=0;u<t;u++){var s=e[u];s>n&&(n=s),s<r&&(r=s),0===s&&(a+=1),isNaN(s)?i+=1:isFinite(s)||(o+=1)}var c={numVals:t,numZeros:a,numNans:i,max:n,min:r,numInfs:o};return c.max===-1/0&&(c.max=NaN),c.min===1/0&&(c.min=NaN),c},t.tensorStats=function(e){return i(this,void 0,void 0,r.mark((function t(){var n,i,u,s,c;return r.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=o.tidy((function(){var t=o.scalar(0,e.dtype);return[e.min(),e.max(),e.equal(t).sum()]})),i=a(n,3),u=i[0],s=i[1],c=i[2],t.abrupt("return",Promise.all([e.data(),u.data(),s.data(),c.data()]).then((function(e){for(var t=a(e,4),n=t[0],r=t[1],i=t[2],o=t[3],u=n.length,s=0,c=0,l=0;l<u;l++){var f=n[l];isNaN(f)?s+=1:isFinite(f)||(c+=1)}var d=r[0],h=i[0];return s===u&&(d=NaN,h=NaN),{numVals:u,numZeros:o[0],numNans:s,min:d,max:h,numInfs:c}})));case 2:case"end":return t.stop()}}),t)})))},t.confusionMatrix=function(e,t,n,s){return i(this,void 0,void 0,r.mark((function i(){var c,l,f;return r.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return u.assert(1===e.rank,"labels must be a 1D tensor"),u.assert(1===t.rank,"predictions must be a 1D tensor"),u.assert(e.size===t.size,"labels and predictions must be the same length"),null!=s&&u.assert(s.size===t.size,"labels and predictions must be the same length"),c=e.cast("int32"),l=t.cast("int32"),null==n&&(n=o.tidy((function(){return o.maximum(c.max(),l.max()).cast("int32").dataSync()[0]+1}))),f=Promise.resolve(null),null!=s&&(f=s.data()),r.abrupt("return",Promise.all([c.data(),l.data(),f]).then((function(e){for(var t=a(e,3),r=t[0],i=t[1],o=t[2],u=Array(n).fill(0),s=0;s<n;s++)u[s]=Array(n).fill(0);for(var c=0;c<r.length;c++){var l=r[c],f=i[c];u[l][f]+=null!=o?o[c]:1}return u})));case 10:case"end":return r.stop()}}),i)})))},t.accuracy=function(e,t){return i(this,void 0,void 0,r.mark((function n(){var a,i,s;return r.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return u.assertShapesMatch(e.shape,t.shape,"Error computing accuracy."),a=e.equal(t),i=a.mean(),n.next=5,i.data();case 5:return s=n.sent[0],o.dispose([a,i]),n.abrupt("return",s);case 8:case"end":return n.stop()}}),n)})))},t.perClassAccuracy=function(e,t,n){return i(this,void 0,void 0,r.mark((function i(){return r.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return u.assert(1===e.rank,"labels must be a 1D tensor"),u.assert(1===t.rank,"predictions must be a 1D tensor"),u.assert(e.size===t.size,"labels and predictions must be the same length"),null==n&&(n=o.tidy((function(){return o.maximum(e.max(),t.max()).dataSync()[0]+1}))),r.abrupt("return",Promise.all([e.data(),t.data()]).then((function(e){for(var t=a(e,2),r=t[0],i=t[1],o=Array(n).fill(0),u=Array(n).fill(0),s=0;s<r.length;s++){var c=r[s],l=i[s];o[c]+=1,c===l&&(u[c]+=1)}for(var f=[],d=0;d<o.length;d++)f.push({count:o[d],accuracy:0===o[d]?0:u[d]/o[d]});return f})));case 5:case"end":return r.stop()}}),i)})))}},5330:function(e,t){"use strict";function n(e,t){if(!e)throw new Error("string"===typeof t?t:t())}function r(e,t){if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}Object.defineProperty(t,"__esModule",{value:!0}),t.assert=n,t.assertShapesMatch=function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";n(r(e,t),a+" Shapes ".concat(e," and ").concat(t," must match"))},t.arraysEqual=r,t.DECIMAL_PLACES_TO_CHECK=4},74:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.version="1.5.1"},2890:function(e,t,n){"use strict";var r=n(6690).default,a=n(9728).default;Object.defineProperty(t,"__esModule",{value:!0});var i,o=n(1042),u="tfjs-visor-container";t.visor=function(){if("undefined"===typeof document)throw new Error("No document defined. This library needs a browser/dom to work");if(document.getElementById(u)&&null!=i)return i;var e,t=document.getElementById(u);function n(t,n){var r=null;return e=o.VisorComponent.render(t,e,{ref:function(e){return r=e},surfaceList:Array.from(n.values())}),r}null==t&&((t=document.createElement("div")).id=u,document.body.appendChild(t));var r=new Map,a=n(t,r);return i=new s(a,t,r,n)};var s=function(){function e(t,n,a,i){r(this,e),this.visorComponent=t,this.el=n,this.surfaceList=a,this.renderVisor=i}return a(e,[{key:"surface",value:function(e){var t=e.name,n=null==e.tab?"Visor":e.tab;if(null==t||!("string"===typeof t||t instanceof String))throw new Error("You must pass a config object with a 'name' property to create or retrieve a surface");var r=Object.assign({},e,{tab:n}),a="".concat(t,"-").concat(n);return this.surfaceList.has(a)||this.surfaceList.set(a,r),this.renderVisor(this.el,this.surfaceList),this.visorComponent.getSurface(t,n)}},{key:"isFullscreen",value:function(){return this.visorComponent.isFullscreen()}},{key:"isOpen",value:function(){return this.visorComponent.isOpen()}},{key:"close",value:function(){return this.visorComponent.close()}},{key:"open",value:function(){return this.visorComponent.open()}},{key:"toggle",value:function(){return this.visorComponent.toggle()}},{key:"toggleFullScreen",value:function(){return this.visorComponent.toggleFullScreen()}},{key:"bindKeys",value:function(){return this.visorComponent.bindKeys()}},{key:"unbindKeys",value:function(){return this.visorComponent.unbindKeys()}},{key:"setActiveTab",value:function(e){if(!this.visorComponent.state.tabs.has(e))throw new Error("Tab '".concat(e,"' does not exist"));this.visorComponent.setState({activeTab:e})}}]),e}();t.Visor=s},3991:function(e){var t=function(){"use strict";function e(e,t){return null!=t&&e instanceof t}var t,n,r;try{t=Map}catch(u){t=function(){}}try{n=Set}catch(u){n=function(){}}try{r=Promise}catch(u){r=function(){}}function a(i,u,s,c,l){"object"===typeof u&&(s=u.depth,c=u.prototype,l=u.includeNonEnumerable,u=u.circular);var f=[],d=[],h="undefined"!=typeof Buffer;return"undefined"==typeof u&&(u=!0),"undefined"==typeof s&&(s=1/0),function i(s,p){if(null===s)return null;if(0===p)return s;var v,m;if("object"!=typeof s)return s;if(e(s,t))v=new t;else if(e(s,n))v=new n;else if(e(s,r))v=new r((function(e,t){s.then((function(t){e(i(t,p-1))}),(function(e){t(i(e,p-1))}))}));else if(a.__isArray(s))v=[];else if(a.__isRegExp(s))v=new RegExp(s.source,o(s)),s.lastIndex&&(v.lastIndex=s.lastIndex);else if(a.__isDate(s))v=new Date(s.getTime());else{if(h&&Buffer.isBuffer(s))return v=Buffer.allocUnsafe?Buffer.allocUnsafe(s.length):new Buffer(s.length),s.copy(v),v;e(s,Error)?v=Object.create(s):"undefined"==typeof c?(m=Object.getPrototypeOf(s),v=Object.create(m)):(v=Object.create(c),m=c)}if(u){var g=f.indexOf(s);if(-1!=g)return d[g];f.push(s),d.push(v)}for(var y in e(s,t)&&s.forEach((function(e,t){var n=i(t,p-1),r=i(e,p-1);v.set(n,r)})),e(s,n)&&s.forEach((function(e){var t=i(e,p-1);v.add(t)})),s){var b;m&&(b=Object.getOwnPropertyDescriptor(m,y)),b&&null==b.set||(v[y]=i(s[y],p-1))}if(Object.getOwnPropertySymbols){var x=Object.getOwnPropertySymbols(s);for(y=0;y<x.length;y++){var w=x[y];(!(_=Object.getOwnPropertyDescriptor(s,w))||_.enumerable||l)&&(v[w]=i(s[w],p-1),_.enumerable||Object.defineProperty(v,w,{enumerable:!1}))}}if(l){var k=Object.getOwnPropertyNames(s);for(y=0;y<k.length;y++){var _,S=k[y];(_=Object.getOwnPropertyDescriptor(s,S))&&_.enumerable||(v[S]=i(s[S],p-1),Object.defineProperty(v,S,{enumerable:!1}))}}return v}(i,s)}function i(e){return Object.prototype.toString.call(e)}function o(e){var t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),t}return a.clonePrototype=function(e){if(null===e)return null;var t=function(){};return t.prototype=e,new t},a.__objToStr=i,a.__isDate=function(e){return"object"===typeof e&&"[object Date]"===i(e)},a.__isArray=function(e){return"object"===typeof e&&"[object Array]"===i(e)},a.__isRegExp=function(e){return"object"===typeof e&&"[object RegExp]"===i(e)},a.__getRegExpFlags=o,a}();e.exports&&(e.exports=t)},8546:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return(0,i.default)(e)};var r,a=n(7630),i=(r=a)&&r.__esModule?r:{default:r};e.exports=t.default},5216:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return"string"===typeof e&&n.test(e)};var n=/-webkit-|-moz-|-ms-/;e.exports=t.default},1848:function(e,t,n){"use strict";function r(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,r=e.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+e.slice(n+1)]}function a(e){return(e=r(Math.abs(e)))?e[1]:NaN}n.r(t),n.d(t,{format:function(){return h},formatDefaultLocale:function(){return g},formatLocale:function(){return m},formatPrefix:function(){return p},formatSpecifier:function(){return u},precisionFixed:function(){return y},precisionPrefix:function(){return b},precisionRound:function(){return x}});var i,o=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function u(e){return new s(e)}function s(e){if(!(t=o.exec(e)))throw new Error("invalid format: "+e);var t;this.fill=t[1]||" ",this.align=t[2]||">",this.sign=t[3]||"-",this.symbol=t[4]||"",this.zero=!!t[5],this.width=t[6]&&+t[6],this.comma=!!t[7],this.precision=t[8]&&+t[8].slice(1),this.trim=!!t[9],this.type=t[10]||""}function c(e,t){var n=r(e,t);if(!n)return e+"";var a=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+a:a.length>i+1?a.slice(0,i+1)+"."+a.slice(i+1):a+new Array(i-a.length+2).join("0")}u.prototype=s.prototype,s.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(null==this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(null==this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};var l={"%":function(e,t){return(100*e).toFixed(t)},b:function(e){return Math.round(e).toString(2)},c:function(e){return e+""},d:function(e){return Math.round(e).toString(10)},e:function(e,t){return e.toExponential(t)},f:function(e,t){return e.toFixed(t)},g:function(e,t){return e.toPrecision(t)},o:function(e){return Math.round(e).toString(8)},p:function(e,t){return c(100*e,t)},r:c,s:function(e,t){var n=r(e,t);if(!n)return e+"";var a=n[0],o=n[1],u=o-(i=3*Math.max(-8,Math.min(8,Math.floor(o/3))))+1,s=a.length;return u===s?a:u>s?a+new Array(u-s+1).join("0"):u>0?a.slice(0,u)+"."+a.slice(u):"0."+new Array(1-u).join("0")+r(e,Math.max(0,t+u-1))[0]},X:function(e){return Math.round(e).toString(16).toUpperCase()},x:function(e){return Math.round(e).toString(16)}};function f(e){return e}var d,h,p,v=["y","z","a","f","p","n","\xb5","m","","k","M","G","T","P","E","Z","Y"];function m(e){var t,n,r=e.grouping&&e.thousands?(t=e.grouping,n=e.thousands,function(e,r){for(var a=e.length,i=[],o=0,u=t[0],s=0;a>0&&u>0&&(s+u+1>r&&(u=Math.max(1,r-s)),i.push(e.substring(a-=u,a+u)),!((s+=u+1)>r));)u=t[o=(o+1)%t.length];return i.reverse().join(n)}):f,o=e.currency,s=e.decimal,c=e.numerals?function(e){return function(t){return t.replace(/[0-9]/g,(function(t){return e[+t]}))}}(e.numerals):f,d=e.percent||"%";function h(e){var t=(e=u(e)).fill,n=e.align,a=e.sign,f=e.symbol,h=e.zero,p=e.width,m=e.comma,g=e.precision,y=e.trim,b=e.type;"n"===b?(m=!0,b="g"):l[b]||(null==g&&(g=12),y=!0,b="g"),(h||"0"===t&&"="===n)&&(h=!0,t="0",n="=");var x="$"===f?o[0]:"#"===f&&/[boxX]/.test(b)?"0"+b.toLowerCase():"",w="$"===f?o[1]:/[%p]/.test(b)?d:"",k=l[b],_=/[defgprs%]/.test(b);function S(e){var o,u,l,f=x,d=w;if("c"===b)d=k(e)+d,e="";else{var S=(e=+e)<0;if(e=k(Math.abs(e),g),y&&(e=function(e){e:for(var t,n=e.length,r=1,a=-1;r<n;++r)switch(e[r]){case".":a=t=r;break;case"0":0===a&&(a=r),t=r;break;default:if(a>0){if(!+e[r])break e;a=0}}return a>0?e.slice(0,a)+e.slice(t+1):e}(e)),S&&0===+e&&(S=!1),f=(S?"("===a?a:"-":"-"===a||"("===a?"":a)+f,d=("s"===b?v[8+i/3]:"")+d+(S&&"("===a?")":""),_)for(o=-1,u=e.length;++o<u;)if(48>(l=e.charCodeAt(o))||l>57){d=(46===l?s+e.slice(o+1):e.slice(o))+d,e=e.slice(0,o);break}}m&&!h&&(e=r(e,1/0));var C=f.length+e.length+d.length,A=C<p?new Array(p-C+1).join(t):"";switch(m&&h&&(e=r(A+e,A.length?p-d.length:1/0),A=""),n){case"<":e=f+e+d+A;break;case"=":e=f+A+e+d;break;case"^":e=A.slice(0,C=A.length>>1)+f+e+d+A.slice(C);break;default:e=A+f+e+d}return c(e)}return g=null==g?6:/[gprs]/.test(b)?Math.max(1,Math.min(21,g)):Math.max(0,Math.min(20,g)),S.toString=function(){return e+""},S}return{format:h,formatPrefix:function(e,t){var n=h(((e=u(e)).type="f",e)),r=3*Math.max(-8,Math.min(8,Math.floor(a(t)/3))),i=Math.pow(10,-r),o=v[8+r/3];return function(e){return n(i*e)+o}}}}function g(e){return d=m(e),h=d.format,p=d.formatPrefix,d}function y(e){return Math.max(0,-a(Math.abs(e)))}function b(e,t){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(a(t)/3)))-a(Math.abs(e)))}function x(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,a(t)-a(e))+1}g({decimal:".",thousands:",",grouping:[3],currency:["$",""]})},6360:function(e,t,n){"use strict";n.r(t),n.d(t,{clientPoint:function(){return _e},create:function(){return ye},creator:function(){return s},customEvent:function(){return ce},event:function(){return re},local:function(){return xe},matcher:function(){return m},mouse:function(){return Se},namespace:function(){return i},namespaces:function(){return a},select:function(){return ge},selectAll:function(){return Ce},selection:function(){return me},selector:function(){return l},selectorAll:function(){return d},style:function(){return F},touch:function(){return Ae},touches:function(){return Ee},window:function(){return N}});var r="http://www.w3.org/1999/xhtml",a={svg:"http://www.w3.org/2000/svg",xhtml:r,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function i(e){var t=e+="",n=t.indexOf(":");return n>=0&&"xmlns"!==(t=e.slice(0,n))&&(e=e.slice(n+1)),a.hasOwnProperty(t)?{space:a[t],local:e}:e}function o(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===r&&t.documentElement.namespaceURI===r?t.createElement(e):t.createElementNS(n,e)}}function u(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function s(e){var t=i(e);return(t.local?u:o)(t)}function c(){}function l(e){return null==e?c:function(){return this.querySelector(e)}}function f(){return[]}function d(e){return null==e?f:function(){return this.querySelectorAll(e)}}var h=function(e){return function(){return this.matches(e)}};if("undefined"!==typeof document){var p=document.documentElement;if(!p.matches){var v=p.webkitMatchesSelector||p.msMatchesSelector||p.mozMatchesSelector||p.oMatchesSelector;h=function(e){return function(){return v.call(this,e)}}}}var m=h;function g(e){return new Array(e.length)}function y(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}y.prototype={constructor:y,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function b(e,t,n,r,a,i){for(var o,u=0,s=t.length,c=i.length;u<c;++u)(o=t[u])?(o.__data__=i[u],r[u]=o):n[u]=new y(e,i[u]);for(;u<s;++u)(o=t[u])&&(a[u]=o)}function x(e,t,n,r,a,i,o){var u,s,c,l={},f=t.length,d=i.length,h=new Array(f);for(u=0;u<f;++u)(s=t[u])&&(h[u]=c="$"+o.call(s,s.__data__,u,t),c in l?a[u]=s:l[c]=s);for(u=0;u<d;++u)(s=l[c="$"+o.call(e,i[u],u,i)])?(r[u]=s,s.__data__=i[u],l[c]=null):n[u]=new y(e,i[u]);for(u=0;u<f;++u)(s=t[u])&&l[h[u]]===s&&(a[u]=s)}function w(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function k(e){return function(){this.removeAttribute(e)}}function _(e){return function(){this.removeAttributeNS(e.space,e.local)}}function S(e,t){return function(){this.setAttribute(e,t)}}function C(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function A(e,t){return function(){var n=t.apply(this,arguments);null==n?this.removeAttribute(e):this.setAttribute(e,n)}}function E(e,t){return function(){var n=t.apply(this,arguments);null==n?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function N(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function T(e){return function(){this.style.removeProperty(e)}}function I(e,t,n){return function(){this.style.setProperty(e,t,n)}}function D(e,t,n){return function(){var r=t.apply(this,arguments);null==r?this.style.removeProperty(e):this.style.setProperty(e,r,n)}}function F(e,t){return e.style.getPropertyValue(t)||N(e).getComputedStyle(e,null).getPropertyValue(t)}function M(e){return function(){delete this[e]}}function O(e,t){return function(){this[e]=t}}function R(e,t){return function(){var n=t.apply(this,arguments);null==n?delete this[e]:this[e]=n}}function j(e){return e.trim().split(/^|\s+/)}function B(e){return e.classList||new z(e)}function z(e){this._node=e,this._names=j(e.getAttribute("class")||"")}function Z(e,t){for(var n=B(e),r=-1,a=t.length;++r<a;)n.add(t[r])}function L(e,t){for(var n=B(e),r=-1,a=t.length;++r<a;)n.remove(t[r])}function P(e){return function(){Z(this,e)}}function U(e){return function(){L(this,e)}}function W(e,t){return function(){(t.apply(this,arguments)?Z:L)(this,e)}}function V(){this.textContent=""}function q(e){return function(){this.textContent=e}}function G(e){return function(){var t=e.apply(this,arguments);this.textContent=null==t?"":t}}function H(){this.innerHTML=""}function X(e){return function(){this.innerHTML=e}}function K(e){return function(){var t=e.apply(this,arguments);this.innerHTML=null==t?"":t}}function Y(){this.nextSibling&&this.parentNode.appendChild(this)}function $(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Q(){return null}function J(){var e=this.parentNode;e&&e.removeChild(this)}function ee(){return this.parentNode.insertBefore(this.cloneNode(!1),this.nextSibling)}function te(){return this.parentNode.insertBefore(this.cloneNode(!0),this.nextSibling)}z.prototype={add:function(e){this._names.indexOf(e)<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};var ne={},re=null;"undefined"!==typeof document&&("onmouseenter"in document.documentElement||(ne={mouseenter:"mouseover",mouseleave:"mouseout"}));function ae(e,t,n){return e=ie(e,t,n),function(t){var n=t.relatedTarget;n&&(n===this||8&n.compareDocumentPosition(this))||e.call(this,t)}}function ie(e,t,n){return function(r){var a=re;re=r;try{e.call(this,this.__data__,t,n)}finally{re=a}}}function oe(e){return e.trim().split(/^|\s+/).map((function(e){var t="",n=e.indexOf(".");return n>=0&&(t=e.slice(n+1),e=e.slice(0,n)),{type:e,name:t}}))}function ue(e){return function(){var t=this.__on;if(t){for(var n,r=0,a=-1,i=t.length;r<i;++r)n=t[r],e.type&&n.type!==e.type||n.name!==e.name?t[++a]=n:this.removeEventListener(n.type,n.listener,n.capture);++a?t.length=a:delete this.__on}}}function se(e,t,n){var r=ne.hasOwnProperty(e.type)?ae:ie;return function(a,i,o){var u,s=this.__on,c=r(t,i,o);if(s)for(var l=0,f=s.length;l<f;++l)if((u=s[l]).type===e.type&&u.name===e.name)return this.removeEventListener(u.type,u.listener,u.capture),this.addEventListener(u.type,u.listener=c,u.capture=n),void(u.value=t);this.addEventListener(e.type,c,n),u={type:e.type,name:e.name,value:t,listener:c,capture:n},s?s.push(u):this.__on=[u]}}function ce(e,t,n,r){var a=re;e.sourceEvent=re,re=e;try{return t.apply(n,r)}finally{re=a}}function le(e,t,n){var r=N(e),a=r.CustomEvent;"function"===typeof a?a=new a(t,n):(a=r.document.createEvent("Event"),n?(a.initEvent(t,n.bubbles,n.cancelable),a.detail=n.detail):a.initEvent(t,!1,!1)),e.dispatchEvent(a)}function fe(e,t){return function(){return le(this,e,t)}}function de(e,t){return function(){return le(this,e,t.apply(this,arguments))}}var he=[null];function pe(e,t){this._groups=e,this._parents=t}function ve(){return new pe([[document.documentElement]],he)}pe.prototype=ve.prototype={constructor:pe,select:function(e){"function"!==typeof e&&(e=l(e));for(var t=this._groups,n=t.length,r=new Array(n),a=0;a<n;++a)for(var i,o,u=t[a],s=u.length,c=r[a]=new Array(s),f=0;f<s;++f)(i=u[f])&&(o=e.call(i,i.__data__,f,u))&&("__data__"in i&&(o.__data__=i.__data__),c[f]=o);return new pe(r,this._parents)},selectAll:function(e){"function"!==typeof e&&(e=d(e));for(var t=this._groups,n=t.length,r=[],a=[],i=0;i<n;++i)for(var o,u=t[i],s=u.length,c=0;c<s;++c)(o=u[c])&&(r.push(e.call(o,o.__data__,c,u)),a.push(o));return new pe(r,a)},filter:function(e){"function"!==typeof e&&(e=m(e));for(var t=this._groups,n=t.length,r=new Array(n),a=0;a<n;++a)for(var i,o=t[a],u=o.length,s=r[a]=[],c=0;c<u;++c)(i=o[c])&&e.call(i,i.__data__,c,o)&&s.push(i);return new pe(r,this._parents)},data:function(e,t){if(!e)return p=new Array(this.size()),l=-1,this.each((function(e){p[++l]=e})),p;var n,r=t?x:b,a=this._parents,i=this._groups;"function"!==typeof e&&(n=e,e=function(){return n});for(var o=i.length,u=new Array(o),s=new Array(o),c=new Array(o),l=0;l<o;++l){var f=a[l],d=i[l],h=d.length,p=e.call(f,f&&f.__data__,l,a),v=p.length,m=s[l]=new Array(v),g=u[l]=new Array(v);r(f,d,m,g,c[l]=new Array(h),p,t);for(var y,w,k=0,_=0;k<v;++k)if(y=m[k]){for(k>=_&&(_=k+1);!(w=g[_])&&++_<v;);y._next=w||null}}return(u=new pe(u,a))._enter=s,u._exit=c,u},enter:function(){return new pe(this._enter||this._groups.map(g),this._parents)},exit:function(){return new pe(this._exit||this._groups.map(g),this._parents)},merge:function(e){for(var t=this._groups,n=e._groups,r=t.length,a=n.length,i=Math.min(r,a),o=new Array(r),u=0;u<i;++u)for(var s,c=t[u],l=n[u],f=c.length,d=o[u]=new Array(f),h=0;h<f;++h)(s=c[h]||l[h])&&(d[h]=s);for(;u<r;++u)o[u]=t[u];return new pe(o,this._parents)},order:function(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var r,a=e[t],i=a.length-1,o=a[i];--i>=0;)(r=a[i])&&(o&&o!==r.nextSibling&&o.parentNode.insertBefore(r,o),o=r);return this},sort:function(e){function t(t,n){return t&&n?e(t.__data__,n.__data__):!t-!n}e||(e=w);for(var n=this._groups,r=n.length,a=new Array(r),i=0;i<r;++i){for(var o,u=n[i],s=u.length,c=a[i]=new Array(s),l=0;l<s;++l)(o=u[l])&&(c[l]=o);c.sort(t)}return new pe(a,this._parents).order()},call:function(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this},nodes:function(){var e=new Array(this.size()),t=-1;return this.each((function(){e[++t]=this})),e},node:function(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],a=0,i=r.length;a<i;++a){var o=r[a];if(o)return o}return null},size:function(){var e=0;return this.each((function(){++e})),e},empty:function(){return!this.node()},each:function(e){for(var t=this._groups,n=0,r=t.length;n<r;++n)for(var a,i=t[n],o=0,u=i.length;o<u;++o)(a=i[o])&&e.call(a,a.__data__,o,i);return this},attr:function(e,t){var n=i(e);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((null==t?n.local?_:k:"function"===typeof t?n.local?E:A:n.local?C:S)(n,t))},style:function(e,t,n){return arguments.length>1?this.each((null==t?T:"function"===typeof t?D:I)(e,t,null==n?"":n)):F(this.node(),e)},property:function(e,t){return arguments.length>1?this.each((null==t?M:"function"===typeof t?R:O)(e,t)):this.node()[e]},classed:function(e,t){var n=j(e+"");if(arguments.length<2){for(var r=B(this.node()),a=-1,i=n.length;++a<i;)if(!r.contains(n[a]))return!1;return!0}return this.each(("function"===typeof t?W:t?P:U)(n,t))},text:function(e){return arguments.length?this.each(null==e?V:("function"===typeof e?G:q)(e)):this.node().textContent},html:function(e){return arguments.length?this.each(null==e?H:("function"===typeof e?K:X)(e)):this.node().innerHTML},raise:function(){return this.each(Y)},lower:function(){return this.each($)},append:function(e){var t="function"===typeof e?e:s(e);return this.select((function(){return this.appendChild(t.apply(this,arguments))}))},insert:function(e,t){var n="function"===typeof e?e:s(e),r=null==t?Q:"function"===typeof t?t:l(t);return this.select((function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)}))},remove:function(){return this.each(J)},clone:function(e){return this.select(e?te:ee)},datum:function(e){return arguments.length?this.property("__data__",e):this.node().__data__},on:function(e,t,n){var r,a,i=oe(e+""),o=i.length;if(!(arguments.length<2)){for(u=t?se:ue,null==n&&(n=!1),r=0;r<o;++r)this.each(u(i[r],t,n));return this}var u=this.node().__on;if(u)for(var s,c=0,l=u.length;c<l;++c)for(r=0,s=u[c];r<o;++r)if((a=i[r]).type===s.type&&a.name===s.name)return s.value},dispatch:function(e,t){return this.each(("function"===typeof t?de:fe)(e,t))}};var me=ve;function ge(e){return"string"===typeof e?new pe([[document.querySelector(e)]],[document.documentElement]):new pe([[e]],he)}function ye(e){return ge(s(e).call(document.documentElement))}var be=0;function xe(){return new we}function we(){this._="@"+(++be).toString(36)}function ke(){for(var e,t=re;e=t.sourceEvent;)t=e;return t}function _e(e,t){var n=e.ownerSVGElement||e;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=t.clientX,r.y=t.clientY,[(r=r.matrixTransform(e.getScreenCTM().inverse())).x,r.y]}var a=e.getBoundingClientRect();return[t.clientX-a.left-e.clientLeft,t.clientY-a.top-e.clientTop]}function Se(e){var t=ke();return t.changedTouches&&(t=t.changedTouches[0]),_e(e,t)}function Ce(e){return"string"===typeof e?new pe([document.querySelectorAll(e)],[document.documentElement]):new pe([null==e?[]:e],he)}function Ae(e,t,n){arguments.length<3&&(n=t,t=ke().changedTouches);for(var r,a=0,i=t?t.length:0;a<i;++a)if((r=t[a]).identifier===n)return _e(e,r);return null}function Ee(e,t){null==t&&(t=ke().touches);for(var n=0,r=t?t.length:0,a=new Array(r);n<r;++n)a[n]=_e(e,t[n]);return a}we.prototype=xe.prototype={constructor:we,get:function(e){for(var t=this._;!(t in e);)if(!(e=e.parentNode))return;return e[t]},set:function(e,t){return e[this._]=t},remove:function(e){return this._ in e&&delete e[this._]},toString:function(){return this._}}},8262:function(e){"use strict";e.exports=function e(t,n){if(t===n)return!0;if(t&&n&&"object"==typeof t&&"object"==typeof n){if(t.constructor!==n.constructor)return!1;var r,a,i;if(Array.isArray(t)){if((r=t.length)!=n.length)return!1;for(a=r;0!==a--;)if(!e(t[a],n[a]))return!1;return!0}if(t.constructor===RegExp)return t.source===n.source&&t.flags===n.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===n.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===n.toString();if((r=(i=Object.keys(t)).length)!==Object.keys(n).length)return!1;for(a=r;0!==a--;)if(!Object.prototype.hasOwnProperty.call(n,i[a]))return!1;for(a=r;0!==a--;){var o=i[a];if(!e(t[o],n[o]))return!1}return!0}return t!==t&&n!==n}},2248:function(e){"use strict";e.exports=function(e,t){t||(t={}),"function"===typeof t&&(t={cmp:t});var n,r="boolean"===typeof t.cycles&&t.cycles,a=t.cmp&&(n=t.cmp,function(e){return function(t,r){var a={key:t,value:e[t]},i={key:r,value:e[r]};return n(a,i)}}),i=[];return function e(t){if(t&&t.toJSON&&"function"===typeof t.toJSON&&(t=t.toJSON()),void 0!==t){if("number"==typeof t)return isFinite(t)?""+t:"null";if("object"!==typeof t)return JSON.stringify(t);var n,o;if(Array.isArray(t)){for(o="[",n=0;n<t.length;n++)n&&(o+=","),o+=e(t[n])||"null";return o+"]"}if(null===t)return"null";if(-1!==i.indexOf(t)){if(r)return JSON.stringify("__cycle__");throw new TypeError("Converting circular structure to JSON")}var u=i.push(t)-1,s=Object.keys(t).sort(a&&a(t));for(o="",n=0;n<s.length;n++){var c=s[n],l=e(t[c]);l&&(o&&(o+=","),o+=JSON.stringify(c)+":"+l)}return i.splice(u,1),"{"+o+"}"}}(e)}},6514:function(e){"use strict";var t=/-(.)/g;e.exports=function(e){return e.replace(t,(function(e,t){return t.toUpperCase()}))}},4023:function(e,t,n){"use strict";var r=n(6514),a=/^-ms-/;e.exports=function(e){return r(e.replace(a,"ms-"))}},9394:function(e){"use strict";function t(e){return function(){return e}}var n=function(){};n.thatReturns=t,n.thatReturnsFalse=t(!1),n.thatReturnsTrue=t(!0),n.thatReturnsNull=t(null),n.thatReturnsThis=function(){return this},n.thatReturnsArgument=function(e){return e},e.exports=n},8186:function(e){"use strict";var t=/([A-Z])/g;e.exports=function(e){return e.replace(t,"-$1").toLowerCase()}},3476:function(e,t,n){"use strict";var r=n(8186),a=/^ms-/;e.exports=function(e){return r(e).replace(a,"-ms-")}},7983:function(e){"use strict";e.exports=function(e){var t={};return function(n){return t.hasOwnProperty(n)||(t[n]=e.call(this,n)),t[n]}}},3255:function(e,t,n){"use strict";var r=n(9394);e.exports=r},4100:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n={animationIterationCount:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridRow:!0,gridRowStart:!0,gridRowEnd:!0,gridColumn:!0,gridColumnStart:!0,gridColumnEnd:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0};var r=["Webkit","ms","Moz","O"];Object.keys(n).forEach((function(e){r.forEach((function(t){n[function(e,t){return e+t.charAt(0).toUpperCase()+t.substring(1)}(t,e)]=n[e]}))}));var a={isUnitlessNumber:n,shorthandPropertyExpansions:{background:{backgroundAttachment:!0,backgroundColor:!0,backgroundImage:!0,backgroundPositionX:!0,backgroundPositionY:!0,backgroundRepeat:!0},backgroundPosition:{backgroundPositionX:!0,backgroundPositionY:!0},border:{borderWidth:!0,borderStyle:!0,borderColor:!0},borderBottom:{borderBottomWidth:!0,borderBottomStyle:!0,borderBottomColor:!0},borderLeft:{borderLeftWidth:!0,borderLeftStyle:!0,borderLeftColor:!0},borderRight:{borderRightWidth:!0,borderRightStyle:!0,borderRightColor:!0},borderTop:{borderTopWidth:!0,borderTopStyle:!0,borderTopColor:!0},font:{fontStyle:!0,fontVariant:!0,fontWeight:!0,fontSize:!0,lineHeight:!0,fontFamily:!0},outline:{outlineWidth:!0,outlineStyle:!0,outlineColor:!0}}};t.default=a},1934:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a(n(4100));a(n(3255));function a(e){return e&&e.__esModule?e:{default:e}}var i=r.default.isUnitlessNumber;t.default=function(e,t,n){return null==t||"boolean"===typeof t||""===t?"":isNaN(t)||0===t||i.hasOwnProperty(e)&&i[e]?""+t:("string"===typeof t&&(t=t.trim()),t+"px")}},7811:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.processStyleName=void 0,t.createMarkupForStyles=function(e,t){var n="";for(var a in e){var i=0===a.indexOf("--");if(e.hasOwnProperty(a)&&"label"!==a){var o=e[a];0,null!=o&&(i?n+=a+":"+o+";":(n+=u(a)+":",n+=(0,r.default)(a,o,t)+";"))}}return n||null};o(n(4023));var r=o(n(1934)),a=o(n(3476)),i=o(n(7983));o(n(3255));function o(e){return e&&e.__esModule?e:{default:e}}var u=t.processStyleName=(0,i.default)(a.default)},5758:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function r(e){if(function(e){return null===e||void 0===e||!1===e||"object"===("undefined"===typeof e?"undefined":n(e))&&0===Object.keys(e).length}(e))return null;if("object"!==("undefined"===typeof e?"undefined":n(e)))return e;for(var t={},r=Object.keys(e),i=!1,o=0;o<r.length;o++){var u=e[r[o]],s=a(u);null!==s&&s===u||(i=!0),null!==s&&(t[r[o]]=s)}return 0===Object.keys(t).length?null:i?t:e}function a(e){return Array.isArray(e)?function(e){var t=!1,n=[];return e.forEach((function(e){var r=a(e);null!==r&&r===e||(t=!0),null!==r&&n.push(r)})),0==n.length?null:t?n:e}(e):r(e)}t.default=a},7595:function(e,t){"use strict";function n(e,t){return e.charCodeAt(t++)+(e.charCodeAt(t++)<<8)+(e.charCodeAt(t++)<<16)+(e.charCodeAt(t)<<24)}function r(e,t){return e.charCodeAt(t++)+(e.charCodeAt(t++)<<8)}function a(e,t){return(65535&(e|=0))*(t|=0)+(((e>>>16)*t&65535)<<16)|0}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var i=1540483477,o=t^e.length,u=e.length,s=0;for(;u>=4;){var c=n(e,s);c=a(c,i),c=a(c^=c>>>24,i),o=a(o,i),o^=c,s+=4,u-=4}switch(u){case 3:o^=r(e,s),o=a(o^=e.charCodeAt(s+2)<<16,i);break;case 2:o=a(o^=r(e,s),i);break;case 1:o=a(o^=e.charCodeAt(s),i)}return o=a(o^=o>>>13,i),(o^=o>>>15)>>>0}},7938:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.compose=t.merge=t.$=t.style=t.presets=t.keyframes=t.fontFace=t.insertGlobal=t.insertRule=t.plugins=t.styleSheet=void 0,t.speedy=function(e){return f.speedy(e)},t.simulations=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];v=!!e},t.simulate=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];if(!(t=(0,o.default)(t)))return{};if(!v)return m||(console.warn("can't simulate without once calling simulations(true)"),m=!0),g||(console.warn("don't use simulation outside dev"),g=!0),{};return t.reduce((function(e,t){return e["data-simulate-"+b(t)]="",e}),{})},t.cssLabels=function(e){y=!!e},t.isLikeRule=w,t.idFor=k,t.css=V,t.rehydrate=function(e){(0,r.default)(T,e.reduce((function(e,t){return e[t]=!0,e}),{}))},t.flush=function(){T=f.inserted={},I=f.registered={},F={},f.flush(),f.inject()},t.select=G,t.parent=function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return V(l({},e+" &",n))},t.media=function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return V(l({},"@media "+e,n))},t.pseudo=H,t.active=function(e){return H(":active",e)},t.any=function(e){return H(":any",e)},t.checked=function(e){return H(":checked",e)},t.disabled=function(e){return H(":disabled",e)},t.empty=function(e){return H(":empty",e)},t.enabled=function(e){return H(":enabled",e)},t._default=function(e){return H(":default",e)},t.first=function(e){return H(":first",e)},t.firstChild=function(e){return H(":first-child",e)},t.firstOfType=function(e){return H(":first-of-type",e)},t.fullscreen=function(e){return H(":fullscreen",e)},t.focus=function(e){return H(":focus",e)},t.hover=function(e){return H(":hover",e)},t.indeterminate=function(e){return H(":indeterminate",e)},t.inRange=function(e){return H(":in-range",e)},t.invalid=function(e){return H(":invalid",e)},t.lastChild=function(e){return H(":last-child",e)},t.lastOfType=function(e){return H(":last-of-type",e)},t.left=function(e){return H(":left",e)},t.link=function(e){return H(":link",e)},t.onlyChild=function(e){return H(":only-child",e)},t.onlyOfType=function(e){return H(":only-of-type",e)},t.optional=function(e){return H(":optional",e)},t.outOfRange=function(e){return H(":out-of-range",e)},t.readOnly=function(e){return H(":read-only",e)},t.readWrite=function(e){return H(":read-write",e)},t.required=function(e){return H(":required",e)},t.right=function(e){return H(":right",e)},t.root=function(e){return H(":root",e)},t.scope=function(e){return H(":scope",e)},t.target=function(e){return H(":target",e)},t.valid=function(e){return H(":valid",e)},t.visited=function(e){return H(":visited",e)},t.dir=function(e,t){return H(":dir("+e+")",t)},t.lang=function(e,t){return H(":lang("+e+")",t)},t.not=function(e,t){var n=e.split(",").map((function(e){return e.trim()})).map((function(e){return":not("+e+")"}));if(1===n.length)return H(":not("+e+")",t);return G(n.join(""),t)},t.nthChild=function(e,t){return H(":nth-child("+e+")",t)},t.nthLastChild=function(e,t){return H(":nth-last-child("+e+")",t)},t.nthLastOfType=function(e,t){return H(":nth-last-of-type("+e+")",t)},t.nthOfType=function(e,t){return H(":nth-of-type("+e+")",t)},t.after=function(e){return H("::after",e)},t.before=function(e){return H("::before",e)},t.firstLetter=function(e){return H("::first-letter",e)},t.firstLine=function(e){return H("::first-line",e)},t.selection=function(e){return H("::selection",e)},t.backdrop=function(e){return H("::backdrop",e)},t.placeholder=function(e){return V({"::placeholder":e})},t.cssFor=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return(t=(0,o.default)(t))?t.map((function(e){var t={label:[]};return z(t,{src:e}),N(x(t),E(t)).join("")})).join(""):""},t.attribsFor=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=(t=(0,o.default)(t))?t.map((function(e){k(e);var t=Object.keys(e)[0];return t+'="'+(e[t]||"")+'"'})).join(" "):"";return r};var r=c(n(4368)),a=n(1431),i=n(7811),o=c(n(5758)),u=n(63),s=c(n(7595));function c(e){return e&&e.__esModule?e:{default:e}}function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var f=t.styleSheet=new a.StyleSheet;f.inject();var d=t.plugins=f.plugins=new u.PluginSet([u.prefixes,u.contentWrap,u.fallbacks]);d.media=new u.PluginSet,d.fontFace=new u.PluginSet,d.keyframes=new u.PluginSet([u.prefixes,u.fallbacks]);var h=!1,p="undefined"!==typeof window,v=h,m=!1,g=!1;var y=h;function b(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return e.toLowerCase().replace(/[^a-z0-9]/g,t)}function x(e){var t=JSON.stringify(e),n=(0,s.default)(t).toString(36);return e.label&&e.label.length,n}function w(e){var t=Object.keys(e).filter((function(e){return"toString"!==e}));return 1===t.length&&!!/data\-css\-([a-zA-Z0-9\-_]+)/.exec(t[0])}function k(e){var t=Object.keys(e).filter((function(e){return"toString"!==e}));if(1!==t.length)throw new Error("not a rule");var n=/data\-css\-([a-zA-Z0-9\-_]+)/.exec(t[0]);if(!n)throw new Error("not a rule");return n[1]}var _=/[(),]|"(?:\\.|[^"\n])*"|'(?:\\.|[^'\n])*'|\/\*[\s\S]*?\*\//g;function S(e){if(-1===e.indexOf(","))return[e];for(var t,n=[],r=[],a=0;t=_.exec(e);)switch(t[0]){case"(":a++;break;case")":a--;break;case",":if(a)break;n.push(t.index)}for(t=n.length;t--;)r.unshift(e.slice(n[t]+1)),e=e.slice(0,n[t]);return r.unshift(e),r}function C(e,t){if(!e)return t.replace(/\&/g,"");if(!t)return".css-"+e+",[data-css-"+e+"]";var n=S(t).map((function(t){return t.indexOf("&")>=0?[t.replace(/\&/gm,".css-"+e),t.replace(/\&/gm,"[data-css-"+e+"]")].join(","):".css-"+e+t+",[data-css-"+e+"]"+t})).join(",");return v&&/^\&\:/.exec(t)&&!/\s/.exec(t)&&(n+=",.css-"+e+"[data-simulate-"+b(t)+"],[data-css-"+e+"][data-simulate-"+b(t)+"]"),n}function A(e){var t=e.selector,n=e.style,r=d.transform({selector:t,style:n});return r.selector+"{"+(0,i.createMarkupForStyles)(r.style)+"}"}function E(e){var t=void 0,n=void 0,r=void 0,a=void 0;return Object.keys(e).forEach((function(i){i.indexOf("&")>=0?(n=n||{})[i]=e[i]:0===i.indexOf("@media")?(r=r||{})[i]=E(e[i]):0===i.indexOf("@supports")?(a=a||{})[i]=E(e[i]):"label"===i?e.label.length>0&&((t=t||{}).label=y?e.label.join("."):""):(t=t||{})[i]=e[i]})),{plain:t,selects:n,medias:r,supports:a}}function N(e,t){var n=[],r=t.plain,a=t.selects,i=t.medias,o=t.supports;return r&&n.push(A({style:r,selector:C(e)})),a&&Object.keys(a).forEach((function(t){return n.push(A({style:a[t],selector:C(e,t)}))})),i&&Object.keys(i).forEach((function(t){return n.push(t+"{"+N(e,i[t]).join("")+"}")})),o&&Object.keys(o).forEach((function(t){return n.push(t+"{"+N(e,o[t]).join("")+"}")})),n}var T=f.inserted={};var I=f.registered={};function D(e){I[e.id]||(I[e.id]=e)}var F={};function M(e){if(D(e),function(e){if(!T[e.id]){T[e.id]=!0;var t=E(e.style),n=N(e.id,t);T[e.id]=!!p||n,n.forEach((function(e){return f.insert(e)}))}}(e),F[e.id])return F[e.id];var t=l({},"data-css-"+e.id,y&&e.label||"");return Object.defineProperty(t,"toString",{enumerable:!1,value:function(){return"css-"+e.id}}),F[e.id]=t,t}function O(e,t){var n=S(e).map((function(e){return e.indexOf("&")>=0?e:"&"+e})),r=S(t).map((function(e){return e.indexOf("&")>=0?e:"&"+e}));return r.reduce((function(e,t){return e.concat(n.map((function(e){return t.replace(/\&/g,e)})))}),[]).join(",")}function R(e,t){return e?"@supports "+e.substring(9)+" and "+t.substring(9):t}function j(e){for(var t=[],n=0;n<e.length;n++)t=Array.isArray(e[n])?t.concat(j(e[n])):t.concat(e[n]);return t}var B={"::placeholder":["::-webkit-input-placeholder","::-moz-placeholder","::-ms-input-placeholder"],":fullscreen":[":-webkit-full-screen",":-moz-full-screen",":-ms-fullscreen"]};function z(e,t){var n=t.selector,r=void 0===n?"":n,a=t.mq,i=void 0===a?"":a,u=t.supp,s=void 0===u?"":u,c=t.src,l=void 0===c?{}:c;Array.isArray(l)||(l=[l]),(l=j(l)).forEach((function(t){if(w(t)){var n=function(e){if(w(e)){var t=I[k(e)];if(null==t)throw new Error("[glamor] an unexpected rule cache miss occurred. This is probably a sign of multiple glamor instances in your app. See https://github.com/threepointone/glamor/issues/79");return t}return e}(t);if("css"!==n.type)throw new Error("cannot merge this rule");t=n.style}(t=(0,o.default)(t))&&t.composes&&z(e,{selector:r,mq:i,supp:s,src:t.composes}),Object.keys(t||{}).forEach((function(n){if(function(e){for(var t=[":",".","[",">"," "],n=!1,r=e.charAt(0),a=0;a<t.length;a++)if(r===t[a]){n=!0;break}return n||e.indexOf("&")>=0}(n))B[n]&&B[n].forEach((function(a){return z(e,{selector:O(r,a),mq:i,supp:s,src:t[n]})})),z(e,{selector:O(r,n),mq:i,supp:s,src:t[n]});else if(function(e){return 0===e.indexOf("@media")}(n))z(e,{selector:r,mq:(o=i,u=n,o?"@media "+o.substring(6)+" and "+u.substring(6):u),supp:s,src:t[n]});else if(function(e){return 0===e.indexOf("@supports")}(n))z(e,{selector:r,mq:i,supp:R(s,n),src:t[n]});else if("composes"===n);else{var a=e;s&&(a[s]=a[s]||{},a=a[s]),i&&(a[i]=a[i]||{},a=a[i]),r&&(a[r]=a[r]||{},a=a[r]),"label"===n?y&&(e.label=e.label.concat(t.label)):a[n]=t[n]}var o,u}))}))}function Z(e){var t={label:[]};return z(t,{src:e}),M({id:x(t),style:t,label:y?t.label.join("."):"",type:"css"})}var L={};Object.defineProperty(L,"toString",{enumerable:!1,value:function(){return"css-nil"}});var P="undefined"!==typeof WeakMap?[L,new WeakMap,new WeakMap,new WeakMap]:[L];var U,W="undefined"!==typeof WeakMap?(U=Z,function(e){if(P[e.length]){for(var t=P[e.length],n=0;n<e.length-1;)t.has(e[n])||t.set(e[n],new WeakMap),t=t.get(e[n]),n++;if(t.has(e[e.length-1])){var r=t.get(e[n]);if(I[r.toString().substring(4)])return r}}var a=U(e);if(P[e.length]){for(var i=0,o=P[e.length];i<e.length-1;)o=o.get(e[i]),i++;try{o.set(e[i],a)}catch(u){}}return a}):Z;function V(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];if(t[0]&&t[0].length&&t[0].raw)throw new Error("you forgot to include glamor/babel in your babel plugins.");return(t=(0,o.default)(t))?W(t):L}V.insert=function(e){var t={id:x(e),css:e,type:"raw"};D(t),T[t.id]||(f.insert(t.css),T[t.id]=!!p||[t.css])};t.insertRule=V.insert;V.global=function(e,t){if(t=(0,o.default)(t))return V.insert(A({selector:e,style:t}))};t.insertGlobal=V.global;V.keyframes=function(e,t){t||(t=e,e="animation");var n={id:x({name:e,kfs:t=(0,o.default)(t)||{}}),type:"keyframes",name:e,keyframes:t};return D(n),function(e){if(!T[e.id]){var t=Object.keys(e.keyframes).map((function(t){var n=d.keyframes.transform({id:e.id,name:t,style:e.keyframes[t]});return n.name+"{"+(0,i.createMarkupForStyles)(n.style)+"}"})).join(""),n=["-webkit-","-moz-","-o-",""].map((function(n){return"@"+n+"keyframes "+e.name+"_"+e.id+"{"+t+"}"}));n.forEach((function(e){return f.insert(e)})),T[e.id]=!!p||n}}(n),e+"_"+n.id},V.fontFace=function(e){var t={id:x(e=(0,o.default)(e)),type:"font-face",font:e};return D(t),function(e){if(!T[e.id]){var t="@font-face{"+(0,i.createMarkupForStyles)(e.font)+"}";f.insert(t),T[e.id]=!!p||[t]}}(t),e.fontFamily};t.fontFace=V.fontFace,t.keyframes=V.keyframes;t.presets={mobile:"(min-width: 400px)",Mobile:"@media (min-width: 400px)",phablet:"(min-width: 550px)",Phablet:"@media (min-width: 550px)",tablet:"(min-width: 750px)",Tablet:"@media (min-width: 750px)",desktop:"(min-width: 1000px)",Desktop:"@media (min-width: 1000px)",hd:"(min-width: 1200px)",Hd:"@media (min-width: 1200px)"};var q=t.style=V;function G(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return e?V(l({},e,n)):q(n)}t.$=G;t.merge=V,t.compose=V;function H(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return V(l({},e,n))}},63:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};t.PluginSet=s,t.fallbacks=function(e){if(Object.keys(e.style).map((function(t){return Array.isArray(e.style[t])})).indexOf(!0)>=0){var t=e.style,n=Object.keys(t).reduce((function(e,n){return e[n]=Array.isArray(t[n])?t[n].join("; "+(0,i.processStyleName)(n)+": "):t[n],e}),{});return(0,a.default)({},e,{style:n})}return e},t.contentWrap=function(e){if(e.style.content){var t=e.style.content;return c.indexOf(t)>=0||/^(attr|calc|counters?|url)\(/.test(t)?e:t.charAt(0)!==t.charAt(t.length-1)||'"'!==t.charAt(0)&&"'"!==t.charAt(0)?r({},e,{style:r({},e.style,{content:'"'+t+'"'})}):e}return e},t.prefixes=function(e){return(0,a.default)({},e,{style:(0,o.default)(r({},e.style))})};var a=u(n(4368)),i=n(7811),o=u(n(5824));function u(e){return e&&e.__esModule?e:{default:e}}function s(e){this.fns=e||[]}(0,a.default)(s.prototype,{add:function(){for(var e=this,t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];n.forEach((function(t){e.fns.indexOf(t)>=0||(e.fns=[t].concat(e.fns))}))},remove:function(e){this.fns=this.fns.filter((function(t){return t!==e}))},clear:function(){this.fns=[]},transform:function(e){return this.fns.reduce((function(e,t){return t(e)}),e)}});var c=["normal","none","counter","open-quote","close-quote","no-open-quote","no-close-quote","initial","inherit"]},5824:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){for(var t in e){var n=e[t],r=(0,i.default)(g,t,n,e,y);r&&(e[t]=r),(0,a.default)(y,t,e)}return e};var r=m(n(9169)),a=m(n(8183)),i=m(n(4715)),o=m(n(4053)),u=m(n(4370)),s=m(n(6840)),c=m(n(4751)),l=m(n(48)),f=m(n(4810)),d=m(n(8574)),h=m(n(9091)),p=m(n(6312)),v=m(n(4500));function m(e){return e&&e.__esModule?e:{default:e}}var g=[u.default,o.default,s.default,l.default,f.default,d.default,h.default,p.default,v.default,c.default],y=r.default.prefixMap},1431:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StyleSheet=d;var r,a=n(4368),i=(r=a)&&r.__esModule?r:{default:r};function o(e){return e[e.length-1]}function u(e){if(e.sheet)return e.sheet;for(var t=0;t<document.styleSheets.length;t++)if(document.styleSheets[t].ownerNode===e)return document.styleSheets[t]}var s="undefined"!==typeof window,c=!1,l=function(){if(s){var e=document.createElement("div");return e.innerHTML="\x3c!--[if lt IE 10]><i></i><![endif]--\x3e",1===e.getElementsByTagName("i").length}}();function f(){var e=document.createElement("style");return e.type="text/css",e.setAttribute("data-glamor",""),e.appendChild(document.createTextNode("")),(document.head||document.getElementsByTagName("head")[0]).appendChild(e),e}function d(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.speedy,n=void 0===t||t,r=e.maxLength,a=void 0===r?s&&l?4e3:65e3:r;this.isSpeedy=n,this.sheet=void 0,this.tags=[],this.maxLength=a,this.ctr=0}(0,i.default)(d.prototype,{getSheet:function(){return u(o(this.tags))},inject:function(){var e=this;if(this.injected)throw new Error("already injected stylesheet!");s?this.tags[0]=f():this.sheet={cssRules:[],insertRule:function(t){e.sheet.cssRules.push({cssText:t})}},this.injected=!0},speedy:function(e){if(0!==this.ctr)throw new Error("cannot change speedy mode after inserting any rule to sheet. Either call speedy("+e+") earlier in your app, or call flush() before speedy("+e+")");this.isSpeedy=!!e},_insert:function(e){try{var t=this.getSheet();t.insertRule(e,-1!==e.indexOf("@import")?0:t.cssRules.length)}catch(n){c}},insert:function(e){if(s)if(this.isSpeedy&&this.getSheet().insertRule)this._insert(e);else if(-1!==e.indexOf("@import")){var t=o(this.tags);t.insertBefore(document.createTextNode(e),t.firstChild)}else o(this.tags).appendChild(document.createTextNode(e));else this.sheet.insertRule(e,-1!==e.indexOf("@import")?0:this.sheet.cssRules.length);return this.ctr++,s&&this.ctr%this.maxLength===0&&this.tags.push(f()),this.ctr-1},delete:function(e){return this.replace(e,"")},flush:function(){s?(this.tags.forEach((function(e){return e.parentNode.removeChild(e)})),this.tags=[],this.sheet=null,this.ctr=0):this.sheet.cssRules=[],this.injected=!1},rules:function(){if(!s)return this.sheet.cssRules;var e=[];return this.tags.forEach((function(t){return e.splice.apply(e,[e.length,0].concat(function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(Array.from(u(t).cssRules))))})),e}})},7630:function(e,t,n){"use strict";n.r(t);var r=/[A-Z]/g,a=/^ms-/,i={};function o(e){return"-"+e.toLowerCase()}t.default=function(e){if(i.hasOwnProperty(e))return i[e];var t=e.replace(r,o);return i[e]=a.test(t)?"-"+t:t}},4370:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if("string"===typeof t&&!(0,i.default)(t)&&t.indexOf("cross-fade(")>-1)return o.map((function(e){return t.replace(/cross-fade\(/g,e+"cross-fade(")}))};var r,a=n(5216),i=(r=a)&&r.__esModule?r:{default:r};var o=["-webkit-",""];e.exports=t.default},4053:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if("cursor"===e&&r.hasOwnProperty(t))return n.map((function(e){return e+t}))};var n=["-webkit-","-moz-",""],r={"zoom-in":!0,"zoom-out":!0,grab:!0,grabbing:!0};e.exports=t.default},6840:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if("string"===typeof t&&!(0,i.default)(t)&&t.indexOf("filter(")>-1)return o.map((function(e){return t.replace(/filter\(/g,e+"filter(")}))};var r,a=n(5216),i=(r=a)&&r.__esModule?r:{default:r};var o=["-webkit-",""];e.exports=t.default},4751:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if("display"===e&&n.hasOwnProperty(t))return n[t]};var n={flex:["-webkit-box","-moz-box","-ms-flexbox","-webkit-flex","flex"],"inline-flex":["-webkit-inline-box","-moz-inline-box","-ms-inline-flexbox","-webkit-inline-flex","inline-flex"]};e.exports=t.default},48:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,a){"flexDirection"===e&&"string"===typeof t&&(t.indexOf("column")>-1?a.WebkitBoxOrient="vertical":a.WebkitBoxOrient="horizontal",t.indexOf("reverse")>-1?a.WebkitBoxDirection="reverse":a.WebkitBoxDirection="normal");r.hasOwnProperty(e)&&(a[r[e]]=n[t]||t)};var n={"space-around":"justify","space-between":"justify","flex-start":"start","flex-end":"end","wrap-reverse":"multiple",wrap:"multiple"},r={alignItems:"WebkitBoxAlign",justifyContent:"WebkitBoxPack",flexWrap:"WebkitBoxLines"};e.exports=t.default},4810:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if("string"===typeof t&&!(0,i.default)(t)&&u.test(t))return o.map((function(e){return e+t}))};var r,a=n(5216),i=(r=a)&&r.__esModule?r:{default:r};var o=["-webkit-","-moz-",""],u=/linear-gradient|radial-gradient|repeating-linear-gradient|repeating-radial-gradient/;e.exports=t.default},8574:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if("string"===typeof t&&!(0,i.default)(t)&&t.indexOf("image-set(")>-1)return o.map((function(e){return t.replace(/image-set\(/g,e+"image-set(")}))};var r,a=n(5216),i=(r=a)&&r.__esModule?r:{default:r};var o=["-webkit-",""];e.exports=t.default},9091:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if("position"===e&&"sticky"===t)return["-webkit-sticky","sticky"]},e.exports=t.default},6312:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if(r.hasOwnProperty(e)&&a.hasOwnProperty(t))return n.map((function(e){return e+t}))};var n=["-webkit-","-moz-",""],r={maxHeight:!0,maxWidth:!0,width:!0,height:!0,columnWidth:!0,minWidth:!0,minHeight:!0},a={"min-content":!0,"max-content":!0,"fill-available":!0,"fit-content":!0,"contain-floats":!0};e.exports=t.default},4500:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n,o){if("string"===typeof t&&u.hasOwnProperty(e)){var c=function(e,t){if((0,a.default)(e))return e;for(var n=e.split(/,(?![^()]*(?:\([^()]*\))?\))/g),i=0,o=n.length;i<o;++i){var u=n[i],c=[u];for(var l in t){var f=(0,r.default)(l);if(u.indexOf(f)>-1&&"order"!==f)for(var d=t[l],h=0,p=d.length;h<p;++h)c.unshift(u.replace(f,s[d[h]]+f))}n[i]=c.join(",")}return n.join(",")}(t,o),l=c.split(/,(?![^()]*(?:\([^()]*\))?\))/g).filter((function(e){return!/-moz-|-ms-/.test(e)})).join(",");if(e.indexOf("Webkit")>-1)return l;var f=c.split(/,(?![^()]*(?:\([^()]*\))?\))/g).filter((function(e){return!/-webkit-|-ms-/.test(e)})).join(",");return e.indexOf("Moz")>-1?f:(n["Webkit"+(0,i.default)(e)]=l,n["Moz"+(0,i.default)(e)]=f,c)}};var r=o(n(8546)),a=o(n(5216)),i=o(n(7255));function o(e){return e&&e.__esModule?e:{default:e}}var u={transition:!0,transitionProperty:!0,WebkitTransition:!0,WebkitTransitionProperty:!0,MozTransition:!0,MozTransitionProperty:!0},s={Webkit:"-webkit-",Moz:"-moz-",ms:"-ms-"};e.exports=t.default},9169:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=["Webkit"],r=["Moz"],a=["ms"],i=["Webkit","Moz"],o=["Webkit","ms"],u=["Webkit","Moz","ms"];t.default={plugins:[],prefixMap:{appearance:i,userSelect:u,textEmphasisPosition:n,textEmphasis:n,textEmphasisStyle:n,textEmphasisColor:n,boxDecorationBreak:n,clipPath:n,maskImage:n,maskMode:n,maskRepeat:n,maskPosition:n,maskClip:n,maskOrigin:n,maskSize:n,maskComposite:n,mask:n,maskBorderSource:n,maskBorderMode:n,maskBorderSlice:n,maskBorderWidth:n,maskBorderOutset:n,maskBorderRepeat:n,maskBorder:n,maskType:n,textDecorationStyle:n,textDecorationSkip:n,textDecorationLine:n,textDecorationColor:n,filter:n,fontFeatureSettings:n,breakAfter:u,breakBefore:u,breakInside:u,columnCount:i,columnFill:i,columnGap:i,columnRule:i,columnRuleColor:i,columnRuleStyle:i,columnRuleWidth:i,columns:i,columnSpan:i,columnWidth:i,writingMode:o,flex:n,flexBasis:n,flexDirection:n,flexGrow:n,flexFlow:n,flexShrink:n,flexWrap:n,alignContent:n,alignItems:n,alignSelf:n,justifyContent:n,order:n,transform:n,transformOrigin:n,transformOriginX:n,transformOriginY:n,backfaceVisibility:n,perspective:n,perspectiveOrigin:n,transformStyle:n,transformOriginZ:n,animation:n,animationDelay:n,animationDirection:n,animationFillMode:n,animationDuration:n,animationIterationCount:n,animationName:n,animationPlayState:n,animationTimingFunction:n,backdropFilter:n,fontKerning:n,scrollSnapType:o,scrollSnapPointsX:o,scrollSnapPointsY:o,scrollSnapDestination:o,scrollSnapCoordinate:o,shapeImageThreshold:n,shapeImageMargin:n,shapeImageOutside:n,hyphens:u,flowInto:o,flowFrom:o,regionFragment:o,textAlignLast:r,tabSize:r,wrapFlow:a,wrapThrough:a,wrapMargin:a,gridTemplateColumns:a,gridTemplateRows:a,gridTemplateAreas:a,gridTemplate:a,gridAutoColumns:a,gridAutoRows:a,gridAutoFlow:a,grid:a,gridRowStart:a,gridColumnStart:a,gridRowEnd:a,gridRow:a,gridColumn:a,gridColumnEnd:a,gridColumnGap:a,gridRowGap:a,gridArea:a,gridGap:a,textSizeAdjust:o,borderImage:n,borderImageOutset:n,borderImageRepeat:n,borderImageSlice:n,borderImageSource:n,borderImageWidth:n,transitionDelay:n,transitionDuration:n,transitionProperty:n,transitionTimingFunction:n}},e.exports=t.default},7255:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return e.charAt(0).toUpperCase()+e.slice(1)},e.exports=t.default},8183:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n){if(e.hasOwnProperty(t))for(var r=e[t],a=0,o=r.length;a<o;++a)n[r[a]+(0,i.default)(t)]=n[t]};var r,a=n(7255),i=(r=a)&&r.__esModule?r:{default:r};e.exports=t.default},4715:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n,r,a){for(var i=0,o=e.length;i<o;++i){var u=e[i](t,n,r,a);if(u)return u}},e.exports=t.default},2176:function(e){"use strict";e.exports=function(e,t,n,r,a,i,o,u){if(!e){var s;if(void 0===t)s=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var c=[n,r,a,i,o,u],l=0;(s=new Error(t.replace(/%s/g,(function(){return c[l++]})))).name="Invariant Violation"}throw s.framesToPop=1,s}}},8987:function(e){e.exports=n;var t=null;try{t=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch(C){}function n(e,t,n){this.low=0|e,this.high=0|t,this.unsigned=!!n}function r(e){return!0===(e&&e.__isLong__)}n.prototype.__isLong__,Object.defineProperty(n.prototype,"__isLong__",{value:!0}),n.isLong=r;var a={},i={};function o(e,t){var n,r,o;return t?(o=0<=(e>>>=0)&&e<256)&&(r=i[e])?r:(n=s(e,(0|e)<0?-1:0,!0),o&&(i[e]=n),n):(o=-128<=(e|=0)&&e<128)&&(r=a[e])?r:(n=s(e,e<0?-1:0,!1),o&&(a[e]=n),n)}function u(e,t){if(isNaN(e))return t?g:m;if(t){if(e<0)return g;if(e>=h)return k}else{if(e<=-p)return _;if(e+1>=p)return w}return e<0?u(-e,t).neg():s(e%d|0,e/d|0,t)}function s(e,t,r){return new n(e,t,r)}n.fromInt=o,n.fromNumber=u,n.fromBits=s;var c=Math.pow;function l(e,t,n){if(0===e.length)throw Error("empty string");if("NaN"===e||"Infinity"===e||"+Infinity"===e||"-Infinity"===e)return m;if("number"===typeof t?(n=t,t=!1):t=!!t,(n=n||10)<2||36<n)throw RangeError("radix");var r;if((r=e.indexOf("-"))>0)throw Error("interior hyphen");if(0===r)return l(e.substring(1),t,n).neg();for(var a=u(c(n,8)),i=m,o=0;o<e.length;o+=8){var s=Math.min(8,e.length-o),f=parseInt(e.substring(o,o+s),n);if(s<8){var d=u(c(n,s));i=i.mul(d).add(u(f))}else i=(i=i.mul(a)).add(u(f))}return i.unsigned=t,i}function f(e,t){return"number"===typeof e?u(e,t):"string"===typeof e?l(e,t):s(e.low,e.high,"boolean"===typeof t?t:e.unsigned)}n.fromString=l,n.fromValue=f;var d=4294967296,h=d*d,p=h/2,v=o(1<<24),m=o(0);n.ZERO=m;var g=o(0,!0);n.UZERO=g;var y=o(1);n.ONE=y;var b=o(1,!0);n.UONE=b;var x=o(-1);n.NEG_ONE=x;var w=s(-1,2147483647,!1);n.MAX_VALUE=w;var k=s(-1,-1,!0);n.MAX_UNSIGNED_VALUE=k;var _=s(0,-2147483648,!1);n.MIN_VALUE=_;var S=n.prototype;S.toInt=function(){return this.unsigned?this.low>>>0:this.low},S.toNumber=function(){return this.unsigned?(this.high>>>0)*d+(this.low>>>0):this.high*d+(this.low>>>0)},S.toString=function(e){if((e=e||10)<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(_)){var t=u(e),n=this.div(t),r=n.mul(t).sub(this);return n.toString(e)+r.toInt().toString(e)}return"-"+this.neg().toString(e)}for(var a=u(c(e,6),this.unsigned),i=this,o="";;){var s=i.div(a),l=(i.sub(s.mul(a)).toInt()>>>0).toString(e);if((i=s).isZero())return l+o;for(;l.length<6;)l="0"+l;o=""+l+o}},S.getHighBits=function(){return this.high},S.getHighBitsUnsigned=function(){return this.high>>>0},S.getLowBits=function(){return this.low},S.getLowBitsUnsigned=function(){return this.low>>>0},S.getNumBitsAbs=function(){if(this.isNegative())return this.eq(_)?64:this.neg().getNumBitsAbs();for(var e=0!=this.high?this.high:this.low,t=31;t>0&&0==(e&1<<t);t--);return 0!=this.high?t+33:t+1},S.isZero=function(){return 0===this.high&&0===this.low},S.eqz=S.isZero,S.isNegative=function(){return!this.unsigned&&this.high<0},S.isPositive=function(){return this.unsigned||this.high>=0},S.isOdd=function(){return 1===(1&this.low)},S.isEven=function(){return 0===(1&this.low)},S.equals=function(e){return r(e)||(e=f(e)),(this.unsigned===e.unsigned||this.high>>>31!==1||e.high>>>31!==1)&&(this.high===e.high&&this.low===e.low)},S.eq=S.equals,S.notEquals=function(e){return!this.eq(e)},S.neq=S.notEquals,S.ne=S.notEquals,S.lessThan=function(e){return this.comp(e)<0},S.lt=S.lessThan,S.lessThanOrEqual=function(e){return this.comp(e)<=0},S.lte=S.lessThanOrEqual,S.le=S.lessThanOrEqual,S.greaterThan=function(e){return this.comp(e)>0},S.gt=S.greaterThan,S.greaterThanOrEqual=function(e){return this.comp(e)>=0},S.gte=S.greaterThanOrEqual,S.ge=S.greaterThanOrEqual,S.compare=function(e){if(r(e)||(e=f(e)),this.eq(e))return 0;var t=this.isNegative(),n=e.isNegative();return t&&!n?-1:!t&&n?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1},S.comp=S.compare,S.negate=function(){return!this.unsigned&&this.eq(_)?_:this.not().add(y)},S.neg=S.negate,S.add=function(e){r(e)||(e=f(e));var t=this.high>>>16,n=65535&this.high,a=this.low>>>16,i=65535&this.low,o=e.high>>>16,u=65535&e.high,c=e.low>>>16,l=0,d=0,h=0,p=0;return h+=(p+=i+(65535&e.low))>>>16,d+=(h+=a+c)>>>16,l+=(d+=n+u)>>>16,l+=t+o,s((h&=65535)<<16|(p&=65535),(l&=65535)<<16|(d&=65535),this.unsigned)},S.subtract=function(e){return r(e)||(e=f(e)),this.add(e.neg())},S.sub=S.subtract,S.multiply=function(e){if(this.isZero())return m;if(r(e)||(e=f(e)),t)return s(t.mul(this.low,this.high,e.low,e.high),t.get_high(),this.unsigned);if(e.isZero())return m;if(this.eq(_))return e.isOdd()?_:m;if(e.eq(_))return this.isOdd()?_:m;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(v)&&e.lt(v))return u(this.toNumber()*e.toNumber(),this.unsigned);var n=this.high>>>16,a=65535&this.high,i=this.low>>>16,o=65535&this.low,c=e.high>>>16,l=65535&e.high,d=e.low>>>16,h=65535&e.low,p=0,g=0,y=0,b=0;return y+=(b+=o*h)>>>16,g+=(y+=i*h)>>>16,y&=65535,g+=(y+=o*d)>>>16,p+=(g+=a*h)>>>16,g&=65535,p+=(g+=i*d)>>>16,g&=65535,p+=(g+=o*l)>>>16,p+=n*h+a*d+i*l+o*c,s((y&=65535)<<16|(b&=65535),(p&=65535)<<16|(g&=65535),this.unsigned)},S.mul=S.multiply,S.divide=function(e){if(r(e)||(e=f(e)),e.isZero())throw Error("division by zero");var n,a,i;if(t)return this.unsigned||-2147483648!==this.high||-1!==e.low||-1!==e.high?s((this.unsigned?t.div_u:t.div_s)(this.low,this.high,e.low,e.high),t.get_high(),this.unsigned):this;if(this.isZero())return this.unsigned?g:m;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return g;if(e.gt(this.shru(1)))return b;i=g}else{if(this.eq(_))return e.eq(y)||e.eq(x)?_:e.eq(_)?y:(n=this.shr(1).div(e).shl(1)).eq(m)?e.isNegative()?y:x:(a=this.sub(e.mul(n)),i=n.add(a.div(e)));if(e.eq(_))return this.unsigned?g:m;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();i=m}for(a=this;a.gte(e);){n=Math.max(1,Math.floor(a.toNumber()/e.toNumber()));for(var o=Math.ceil(Math.log(n)/Math.LN2),l=o<=48?1:c(2,o-48),d=u(n),h=d.mul(e);h.isNegative()||h.gt(a);)h=(d=u(n-=l,this.unsigned)).mul(e);d.isZero()&&(d=y),i=i.add(d),a=a.sub(h)}return i},S.div=S.divide,S.modulo=function(e){return r(e)||(e=f(e)),t?s((this.unsigned?t.rem_u:t.rem_s)(this.low,this.high,e.low,e.high),t.get_high(),this.unsigned):this.sub(this.div(e).mul(e))},S.mod=S.modulo,S.rem=S.modulo,S.not=function(){return s(~this.low,~this.high,this.unsigned)},S.and=function(e){return r(e)||(e=f(e)),s(this.low&e.low,this.high&e.high,this.unsigned)},S.or=function(e){return r(e)||(e=f(e)),s(this.low|e.low,this.high|e.high,this.unsigned)},S.xor=function(e){return r(e)||(e=f(e)),s(this.low^e.low,this.high^e.high,this.unsigned)},S.shiftLeft=function(e){return r(e)&&(e=e.toInt()),0===(e&=63)?this:e<32?s(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):s(0,this.low<<e-32,this.unsigned)},S.shl=S.shiftLeft,S.shiftRight=function(e){return r(e)&&(e=e.toInt()),0===(e&=63)?this:e<32?s(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):s(this.high>>e-32,this.high>=0?0:-1,this.unsigned)},S.shr=S.shiftRight,S.shiftRightUnsigned=function(e){if(r(e)&&(e=e.toInt()),0===(e&=63))return this;var t=this.high;return e<32?s(this.low>>>e|t<<32-e,t>>>e,this.unsigned):s(32===e?t:t>>>e-32,0,this.unsigned)},S.shru=S.shiftRightUnsigned,S.shr_u=S.shiftRightUnsigned,S.toSigned=function(){return this.unsigned?s(this.low,this.high,!1):this},S.toUnsigned=function(){return this.unsigned?this:s(this.low,this.high,!0)},S.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()},S.toBytesLE=function(){var e=this.high,t=this.low;return[255&t,t>>>8&255,t>>>16&255,t>>>24,255&e,e>>>8&255,e>>>16&255,e>>>24]},S.toBytesBE=function(){var e=this.high,t=this.low;return[e>>>24,e>>>16&255,e>>>8&255,255&e,t>>>24,t>>>16&255,t>>>8&255,255&t]},n.fromBytes=function(e,t,r){return r?n.fromBytesLE(e,t):n.fromBytesBE(e,t)},n.fromBytesLE=function(e,t){return new n(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,t)},n.fromBytesBE=function(e,t){return new n(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],t)}},4368:function(e){"use strict";var t=Object.getOwnPropertySymbols,n=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable;function a(e){if(null===e||void 0===e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}e.exports=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},n=0;n<10;n++)t["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(t).map((function(e){return t[e]})).join(""))return!1;var r={};return"abcdefghijklmnopqrst".split("").forEach((function(e){r[e]=e})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},r)).join("")}catch(a){return!1}}()?Object.assign:function(e,i){for(var o,u,s=a(e),c=1;c<arguments.length;c++){for(var l in o=Object(arguments[c]))n.call(o,l)&&(s[l]=o[l]);if(t){u=t(o);for(var f=0;f<u.length;f++)r.call(o,u[f])&&(s[u[f]]=o[u[f]])}}return s}},8294:function(e,t,n){"use strict";function r(){}n.r(t),n.d(t,{Component:function(){return j},cloneElement:function(){return l},createElement:function(){return u},h:function(){return u},options:function(){return a},render:function(){return B},rerender:function(){return p}});var a={},i=[],o=[];function u(e,t){var n,u,s,c,l=o;for(c=arguments.length;c-- >2;)i.push(arguments[c]);for(t&&null!=t.children&&(i.length||i.push(t.children),delete t.children);i.length;)if((u=i.pop())&&void 0!==u.pop)for(c=u.length;c--;)i.push(u[c]);else"boolean"===typeof u&&(u=null),(s="function"!==typeof e)&&(null==u?u="":"number"===typeof u?u=String(u):"string"!==typeof u&&(s=!1)),s&&n?l[l.length-1]+=u:l===o?l=[u]:l.push(u),n=s;var f=new r;return f.nodeName=e,f.children=l,f.attributes=null==t?void 0:t,f.key=null==t?void 0:t.key,void 0!==a.vnode&&a.vnode(f),f}function s(e,t){for(var n in t)e[n]=t[n];return e}var c="function"==typeof Promise?Promise.resolve().then.bind(Promise.resolve()):setTimeout;function l(e,t){return u(e.nodeName,s(s({},e.attributes),t),arguments.length>2?[].slice.call(arguments,2):e.children)}var f=/acit|ex(?:s|g|n|p|$)|rph|ows|mnc|ntw|ine[ch]|zoo|^ord/i,d=[];function h(e){!e._dirty&&(e._dirty=!0)&&1==d.push(e)&&(a.debounceRendering||c)(p)}function p(){var e,t=d;for(d=[];e=t.pop();)e._dirty&&O(e)}function v(e,t,n){return"string"===typeof t||"number"===typeof t?void 0!==e.splitText:"string"===typeof t.nodeName?!e._componentConstructor&&m(e,t.nodeName):n||e._componentConstructor===t.nodeName}function m(e,t){return e.normalizedNodeName===t||e.nodeName.toLowerCase()===t.toLowerCase()}function g(e){var t=s({},e.attributes);t.children=e.children;var n=e.nodeName.defaultProps;if(void 0!==n)for(var r in n)void 0===t[r]&&(t[r]=n[r]);return t}function y(e){var t=e.parentNode;t&&t.removeChild(e)}function b(e,t,n,r,a){if("className"===t&&(t="class"),"key"===t);else if("ref"===t)n&&n(null),r&&r(e);else if("class"!==t||a)if("style"===t){if(r&&"string"!==typeof r&&"string"!==typeof n||(e.style.cssText=r||""),r&&"object"===typeof r){if("string"!==typeof n)for(var i in n)i in r||(e.style[i]="");for(var i in r)e.style[i]="number"===typeof r[i]&&!1===f.test(i)?r[i]+"px":r[i]}}else if("dangerouslySetInnerHTML"===t)r&&(e.innerHTML=r.__html||"");else if("o"==t[0]&&"n"==t[1]){var o=t!==(t=t.replace(/Capture$/,""));t=t.toLowerCase().substring(2),r?n||e.addEventListener(t,x,o):e.removeEventListener(t,x,o),(e._listeners||(e._listeners={}))[t]=r}else if("list"!==t&&"type"!==t&&!a&&t in e)!function(e,t,n){try{e[t]=n}catch(r){}}(e,t,null==r?"":r),null!=r&&!1!==r||e.removeAttribute(t);else{var u=a&&t!==(t=t.replace(/^xlink:?/,""));null==r||!1===r?u?e.removeAttributeNS("http://www.w3.org/1999/xlink",t.toLowerCase()):e.removeAttribute(t):"function"!==typeof r&&(u?e.setAttributeNS("http://www.w3.org/1999/xlink",t.toLowerCase(),r):e.setAttribute(t,r))}else e.className=r||""}function x(e){return this._listeners[e.type](a.event&&a.event(e)||e)}var w=[],k=0,_=!1,S=!1;function C(){for(var e;e=w.pop();)a.afterMount&&a.afterMount(e),e.componentDidMount&&e.componentDidMount()}function A(e,t,n,r,a,i){k++||(_=null!=a&&void 0!==a.ownerSVGElement,S=null!=e&&!("__preactattr_"in e));var o=E(e,t,n,r,i);return a&&o.parentNode!==a&&a.appendChild(o),--k||(S=!1,i||C()),o}function E(e,t,n,r,a){var i=e,o=_;if(null!=t&&"boolean"!==typeof t||(t=""),"string"===typeof t||"number"===typeof t)return e&&void 0!==e.splitText&&e.parentNode&&(!e._component||a)?e.nodeValue!=t&&(e.nodeValue=t):(i=document.createTextNode(t),e&&(e.parentNode&&e.parentNode.replaceChild(i,e),N(e,!0))),i.__preactattr_=!0,i;var u=t.nodeName;if("function"===typeof u)return function(e,t,n,r){var a=e&&e._component,i=a,o=e,u=a&&e._componentConstructor===t.nodeName,s=u,c=g(t);for(;a&&!s&&(a=a._parentComponent);)s=a.constructor===t.nodeName;a&&s&&(!r||a._component)?(M(a,c,3,n,r),e=a.base):(i&&!u&&(R(i),e=o=null),a=D(t.nodeName,c,n),e&&!a.nextBase&&(a.nextBase=e,o=null),M(a,c,1,n,r),e=a.base,o&&e!==o&&(o._component=null,N(o,!1)));return e}(e,t,n,r);if(_="svg"===u||"foreignObject"!==u&&_,u=String(u),(!e||!m(e,u))&&(i=function(e,t){var n=t?document.createElementNS("http://www.w3.org/2000/svg",e):document.createElement(e);return n.normalizedNodeName=e,n}(u,_),e)){for(;e.firstChild;)i.appendChild(e.firstChild);e.parentNode&&e.parentNode.replaceChild(i,e),N(e,!0)}var s=i.firstChild,c=i.__preactattr_,l=t.children;if(null==c){c=i.__preactattr_={};for(var f=i.attributes,d=f.length;d--;)c[f[d].name]=f[d].value}return!S&&l&&1===l.length&&"string"===typeof l[0]&&null!=s&&void 0!==s.splitText&&null==s.nextSibling?s.nodeValue!=l[0]&&(s.nodeValue=l[0]):(l&&l.length||null!=s)&&function(e,t,n,r,a){var i,o,u,s,c,l=e.childNodes,f=[],d={},h=0,p=0,m=l.length,g=0,b=t?t.length:0;if(0!==m)for(var x=0;x<m;x++){var w=l[x],k=w.__preactattr_;null!=(_=b&&k?w._component?w._component.__key:k.key:null)?(h++,d[_]=w):(k||(void 0!==w.splitText?!a||w.nodeValue.trim():a))&&(f[g++]=w)}if(0!==b)for(x=0;x<b;x++){var _;if(c=null,null!=(_=(s=t[x]).key))h&&void 0!==d[_]&&(c=d[_],d[_]=void 0,h--);else if(!c&&p<g)for(i=p;i<g;i++)if(void 0!==f[i]&&v(o=f[i],s,a)){c=o,f[i]=void 0,i===g-1&&g--,i===p&&p++;break}c=E(c,s,n,r),u=l[x],c&&c!==e&&c!==u&&(null==u?e.appendChild(c):c===u.nextSibling?y(u):e.insertBefore(c,u))}if(h)for(var x in d)void 0!==d[x]&&N(d[x],!1);for(;p<=g;)void 0!==(c=f[g--])&&N(c,!1)}(i,l,n,r,S||null!=c.dangerouslySetInnerHTML),function(e,t,n){var r;for(r in n)t&&null!=t[r]||null==n[r]||b(e,r,n[r],n[r]=void 0,_);for(r in t)"children"===r||"innerHTML"===r||r in n&&t[r]===("value"===r||"checked"===r?e[r]:n[r])||b(e,r,n[r],n[r]=t[r],_)}(i,t.attributes,c),_=o,i}function N(e,t){var n=e._component;n?R(n):(null!=e.__preactattr_&&e.__preactattr_.ref&&e.__preactattr_.ref(null),!1!==t&&null!=e.__preactattr_||y(e),T(e))}function T(e){for(e=e.lastChild;e;){var t=e.previousSibling;N(e,!0),e=t}}var I={};function D(e,t,n){var r,a=I[e.name];if(e.prototype&&e.prototype.render?(r=new e(t,n),j.call(r,t,n)):((r=new j(t,n)).constructor=e,r.render=F),a)for(var i=a.length;i--;)if(a[i].constructor===e){r.nextBase=a[i].nextBase,a.splice(i,1);break}return r}function F(e,t,n){return this.constructor(e,n)}function M(e,t,n,r,i){e._disable||(e._disable=!0,(e.__ref=t.ref)&&delete t.ref,(e.__key=t.key)&&delete t.key,!e.base||i?e.componentWillMount&&e.componentWillMount():e.componentWillReceiveProps&&e.componentWillReceiveProps(t,r),r&&r!==e.context&&(e.prevContext||(e.prevContext=e.context),e.context=r),e.prevProps||(e.prevProps=e.props),e.props=t,e._disable=!1,0!==n&&(1!==n&&!1===a.syncComponentUpdates&&e.base?h(e):O(e,1,i)),e.__ref&&e.__ref(e))}function O(e,t,n,r){if(!e._disable){var i,o,u,c=e.props,l=e.state,f=e.context,d=e.prevProps||c,h=e.prevState||l,p=e.prevContext||f,v=e.base,m=e.nextBase,y=v||m,b=e._component,x=!1;if(v&&(e.props=d,e.state=h,e.context=p,2!==t&&e.shouldComponentUpdate&&!1===e.shouldComponentUpdate(c,l,f)?x=!0:e.componentWillUpdate&&e.componentWillUpdate(c,l,f),e.props=c,e.state=l,e.context=f),e.prevProps=e.prevState=e.prevContext=e.nextBase=null,e._dirty=!1,!x){i=e.render(c,l,f),e.getChildContext&&(f=s(s({},f),e.getChildContext()));var _,S,E=i&&i.nodeName;if("function"===typeof E){var T=g(i);(o=b)&&o.constructor===E&&T.key==o.__key?M(o,T,1,f,!1):(_=o,e._component=o=D(E,T,f),o.nextBase=o.nextBase||m,o._parentComponent=e,M(o,T,0,f,!1),O(o,1,n,!0)),S=o.base}else u=y,(_=b)&&(u=e._component=null),(y||1===t)&&(u&&(u._component=null),S=A(u,i,f,n||!v,y&&y.parentNode,!0));if(y&&S!==y&&o!==b){var I=y.parentNode;I&&S!==I&&(I.replaceChild(S,y),_||(y._component=null,N(y,!1)))}if(_&&R(_),e.base=S,S&&!r){for(var F=e,j=e;j=j._parentComponent;)(F=j).base=S;S._component=F,S._componentConstructor=F.constructor}}if(!v||n?w.unshift(e):x||(e.componentDidUpdate&&e.componentDidUpdate(d,h,p),a.afterUpdate&&a.afterUpdate(e)),null!=e._renderCallbacks)for(;e._renderCallbacks.length;)e._renderCallbacks.pop().call(e);k||r||C()}}function R(e){a.beforeUnmount&&a.beforeUnmount(e);var t=e.base;e._disable=!0,e.componentWillUnmount&&e.componentWillUnmount(),e.base=null;var n=e._component;n?R(n):t&&(t.__preactattr_&&t.__preactattr_.ref&&t.__preactattr_.ref(null),e.nextBase=t,y(t),function(e){var t=e.constructor.name;(I[t]||(I[t]=[])).push(e)}(e),T(t)),e.__ref&&e.__ref(null)}function j(e,t){this._dirty=!0,this.context=t,this.props=e,this.state=this.state||{}}function B(e,t,n){return A(n,e,{},!1,t,!1)}s(j.prototype,{setState:function(e,t){var n=this.state;this.prevState||(this.prevState=s({},n)),s(n,"function"===typeof e?e(n,this.props):e),t&&(this._renderCallbacks=this._renderCallbacks||[]).push(t),h(this)},forceUpdate:function(e){e&&(this._renderCallbacks=this._renderCallbacks||[]).push(e),O(this,2)},render:function(){}});var z={h:u,createElement:u,cloneElement:l,Component:j,render:B,rerender:p,options:a};t.default=z},3573:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];function r(){for(var e=arguments.length,n=Array(e),r=0;r<e;r++)n[r]=arguments[r];var a=null;return t.forEach((function(e){if(null==a){var t=e.apply(void 0,n);null!=t&&(a=t)}})),a}return(0,i.default)(r)};var r,a=n(6054),i=(r=a)&&r.__esModule?r:{default:r};e.exports=t.default},6054:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){function t(t,n,r,a,i,o){var u=a||"<<anonymous>>",s=o||r;if(null==n[r])return t?new Error("Required "+i+" `"+s+"` was not specified in `"+u+"`."):null;for(var c=arguments.length,l=Array(c>6?c-6:0),f=6;f<c;f++)l[f-6]=arguments[f];return e.apply(void 0,[n,r,u,i,s].concat(l))}var n=t.bind(null,!1);return n.isRequired=t.bind(null,!0),n},e.exports=t.default},888:function(e,t,n){"use strict";var r=n(9047);function a(){}function i(){}i.resetWarningCache=a,e.exports=function(){function e(e,t,n,a,i,o){if(o!==r){var u=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw u.name="Invariant Violation",u}}function t(){return e}e.isRequired=e;var n={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:i,resetWarningCache:a};return n.PropTypes=n,n}},2007:function(e,t,n){e.exports=n(888)()},9047:function(e){"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},4463:function(e,t,n){"use strict";var r=n(2791),a=n(5296);function i(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var o=new Set,u={};function s(e,t){c(e,t),c(e+"Capture",t)}function c(e,t){for(u[e]=t,e=0;e<t.length;e++)o.add(t[e])}var l=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),f=Object.prototype.hasOwnProperty,d=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,h={},p={};function v(e,t,n,r,a,i,o){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=r,this.attributeNamespace=a,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=o}var m={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(e){m[e]=new v(e,0,!1,e,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(e){var t=e[0];m[t]=new v(t,1,!1,e[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(e){m[e]=new v(e,2,!1,e.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(e){m[e]=new v(e,2,!1,e,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(e){m[e]=new v(e,3,!1,e.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(e){m[e]=new v(e,3,!0,e,null,!1,!1)})),["capture","download"].forEach((function(e){m[e]=new v(e,4,!1,e,null,!1,!1)})),["cols","rows","size","span"].forEach((function(e){m[e]=new v(e,6,!1,e,null,!1,!1)})),["rowSpan","start"].forEach((function(e){m[e]=new v(e,5,!1,e.toLowerCase(),null,!1,!1)}));var g=/[\-:]([a-z])/g;function y(e){return e[1].toUpperCase()}function b(e,t,n,r){var a=m.hasOwnProperty(t)?m[t]:null;(null!==a?0!==a.type:r||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,n,r){if(null===t||"undefined"===typeof t||function(e,t,n,r){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!r&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,r))return!0;if(r)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,a,r)&&(n=null),r||null===a?function(e){return!!f.call(p,e)||!f.call(h,e)&&(d.test(e)?p[e]=!0:(h[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):a.mustUseProperty?e[a.propertyName]=null===n?3!==a.type&&"":n:(t=a.attributeName,r=a.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(a=a.type)||4===a&&!0===n?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(e){var t=e.replace(g,y);m[t]=new v(t,1,!1,e,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(e){var t=e.replace(g,y);m[t]=new v(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(e){var t=e.replace(g,y);m[t]=new v(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(e){m[e]=new v(e,1,!1,e.toLowerCase(),null,!1,!1)})),m.xlinkHref=new v("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(e){m[e]=new v(e,1,!1,e.toLowerCase(),null,!0,!0)}));var x=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,w=Symbol.for("react.element"),k=Symbol.for("react.portal"),_=Symbol.for("react.fragment"),S=Symbol.for("react.strict_mode"),C=Symbol.for("react.profiler"),A=Symbol.for("react.provider"),E=Symbol.for("react.context"),N=Symbol.for("react.forward_ref"),T=Symbol.for("react.suspense"),I=Symbol.for("react.suspense_list"),D=Symbol.for("react.memo"),F=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var M=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var O=Symbol.iterator;function R(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=O&&e[O]||e["@@iterator"])?e:null}var j,B=Object.assign;function z(e){if(void 0===j)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);j=t&&t[1]||""}return"\n"+j+e}var Z=!1;function L(e,t){if(!e||Z)return"";Z=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var r=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){r=c}e.call(t.prototype)}else{try{throw Error()}catch(c){r=c}e()}}catch(c){if(c&&r&&"string"===typeof c.stack){for(var a=c.stack.split("\n"),i=r.stack.split("\n"),o=a.length-1,u=i.length-1;1<=o&&0<=u&&a[o]!==i[u];)u--;for(;1<=o&&0<=u;o--,u--)if(a[o]!==i[u]){if(1!==o||1!==u)do{if(o--,0>--u||a[o]!==i[u]){var s="\n"+a[o].replace(" at new "," at ");return e.displayName&&s.includes("<anonymous>")&&(s=s.replace("<anonymous>",e.displayName)),s}}while(1<=o&&0<=u);break}}}finally{Z=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?z(e):""}function P(e){switch(e.tag){case 5:return z(e.type);case 16:return z("Lazy");case 13:return z("Suspense");case 19:return z("SuspenseList");case 0:case 2:case 15:return e=L(e.type,!1);case 11:return e=L(e.type.render,!1);case 1:return e=L(e.type,!0);default:return""}}function U(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case _:return"Fragment";case k:return"Portal";case C:return"Profiler";case S:return"StrictMode";case T:return"Suspense";case I:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case E:return(e.displayName||"Context")+".Consumer";case A:return(e._context.displayName||"Context")+".Provider";case N:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case D:return null!==(t=e.displayName||null)?t:U(e.type)||"Memo";case F:t=e._payload,e=e._init;try{return U(e(t))}catch(n){}}return null}function W(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return U(t);case 8:return t===S?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t}return null}function V(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function q(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function G(e){e._valueTracker||(e._valueTracker=function(e){var t=q(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var a=n.get,i=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return a.call(this)},set:function(e){r=""+e,i.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(e){r=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function H(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=q(e)?e.checked?"true":"false":e.value),(e=r)!==n&&(t.setValue(e),!0)}function X(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function K(e,t){var n=t.checked;return B({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function Y(e,t){var n=null==t.defaultValue?"":t.defaultValue,r=null!=t.checked?t.checked:t.defaultChecked;n=V(null!=t.value?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function $(e,t){null!=(t=t.checked)&&b(e,"checked",t,!1)}function Q(e,t){$(e,t);var n=V(t.value),r=t.type;if(null!=n)"number"===r?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===r||"reset"===r)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,n):t.hasOwnProperty("defaultValue")&&ee(e,t.type,V(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function J(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!("submit"!==r&&"reset"!==r||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function ee(e,t,n){"number"===t&&X(e.ownerDocument)===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var te=Array.isArray;function ne(e,t,n,r){if(e=e.options,t){t={};for(var a=0;a<n.length;a++)t["$"+n[a]]=!0;for(n=0;n<e.length;n++)a=t.hasOwnProperty("$"+e[n].value),e[n].selected!==a&&(e[n].selected=a),a&&r&&(e[n].defaultSelected=!0)}else{for(n=""+V(n),t=null,a=0;a<e.length;a++){if(e[a].value===n)return e[a].selected=!0,void(r&&(e[a].defaultSelected=!0));null!==t||e[a].disabled||(t=e[a])}null!==t&&(t.selected=!0)}}function re(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(i(91));return B({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function ae(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(i(92));if(te(n)){if(1<n.length)throw Error(i(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:V(n)}}function ie(e,t){var n=V(t.value),r=V(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=r&&(e.defaultValue=""+r)}function oe(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function ue(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function se(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?ue(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var ce,le,fe=(le=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((ce=ce||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ce.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,n,r){MSApp.execUnsafeLocalFunction((function(){return le(e,t)}))}:le);function de(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var he={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},pe=["Webkit","ms","Moz","O"];function ve(e,t,n){return null==t||"boolean"===typeof t||""===t?"":n||"number"!==typeof t||0===t||he.hasOwnProperty(e)&&he[e]?(""+t).trim():t+"px"}function me(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var r=0===n.indexOf("--"),a=ve(n,t[n],r);"float"===n&&(n="cssFloat"),r?e.setProperty(n,a):e[n]=a}}Object.keys(he).forEach((function(e){pe.forEach((function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),he[t]=he[e]}))}));var ge=B({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ye(e,t){if(t){if(ge[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(i(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(i(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(i(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(i(62))}}function be(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var xe=null;function we(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var ke=null,_e=null,Se=null;function Ce(e){if(e=ba(e)){if("function"!==typeof ke)throw Error(i(280));var t=e.stateNode;t&&(t=wa(t),ke(e.stateNode,e.type,t))}}function Ae(e){_e?Se?Se.push(e):Se=[e]:_e=e}function Ee(){if(_e){var e=_e,t=Se;if(Se=_e=null,Ce(e),t)for(e=0;e<t.length;e++)Ce(t[e])}}function Ne(e,t){return e(t)}function Te(){}var Ie=!1;function De(e,t,n){if(Ie)return e(t,n);Ie=!0;try{return Ne(e,t,n)}finally{Ie=!1,(null!==_e||null!==Se)&&(Te(),Ee())}}function Fe(e,t){var n=e.stateNode;if(null===n)return null;var r=wa(n);if(null===r)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!r;break e;default:e=!1}if(e)return null;if(n&&"function"!==typeof n)throw Error(i(231,t,typeof n));return n}var Me=!1;if(l)try{var Oe={};Object.defineProperty(Oe,"passive",{get:function(){Me=!0}}),window.addEventListener("test",Oe,Oe),window.removeEventListener("test",Oe,Oe)}catch(le){Me=!1}function Re(e,t,n,r,a,i,o,u,s){var c=Array.prototype.slice.call(arguments,3);try{t.apply(n,c)}catch(l){this.onError(l)}}var je=!1,Be=null,ze=!1,Ze=null,Le={onError:function(e){je=!0,Be=e}};function Pe(e,t,n,r,a,i,o,u,s){je=!1,Be=null,Re.apply(Le,arguments)}function Ue(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function We(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function Ve(e){if(Ue(e)!==e)throw Error(i(188))}function qe(e){return null!==(e=function(e){var t=e.alternate;if(!t){if(null===(t=Ue(e)))throw Error(i(188));return t!==e?null:e}for(var n=e,r=t;;){var a=n.return;if(null===a)break;var o=a.alternate;if(null===o){if(null!==(r=a.return)){n=r;continue}break}if(a.child===o.child){for(o=a.child;o;){if(o===n)return Ve(a),e;if(o===r)return Ve(a),t;o=o.sibling}throw Error(i(188))}if(n.return!==r.return)n=a,r=o;else{for(var u=!1,s=a.child;s;){if(s===n){u=!0,n=a,r=o;break}if(s===r){u=!0,r=a,n=o;break}s=s.sibling}if(!u){for(s=o.child;s;){if(s===n){u=!0,n=o,r=a;break}if(s===r){u=!0,r=o,n=a;break}s=s.sibling}if(!u)throw Error(i(189))}}if(n.alternate!==r)throw Error(i(190))}if(3!==n.tag)throw Error(i(188));return n.stateNode.current===n?e:t}(e))?Ge(e):null}function Ge(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=Ge(e);if(null!==t)return t;e=e.sibling}return null}var He=a.unstable_scheduleCallback,Xe=a.unstable_cancelCallback,Ke=a.unstable_shouldYield,Ye=a.unstable_requestPaint,$e=a.unstable_now,Qe=a.unstable_getCurrentPriorityLevel,Je=a.unstable_ImmediatePriority,et=a.unstable_UserBlockingPriority,tt=a.unstable_NormalPriority,nt=a.unstable_LowPriority,rt=a.unstable_IdlePriority,at=null,it=null;var ot=Math.clz32?Math.clz32:function(e){return 0===(e>>>=0)?32:31-(ut(e)/st|0)|0},ut=Math.log,st=Math.LN2;var ct=64,lt=4194304;function ft(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function dt(e,t){var n=e.pendingLanes;if(0===n)return 0;var r=0,a=e.suspendedLanes,i=e.pingedLanes,o=268435455&n;if(0!==o){var u=o&~a;0!==u?r=ft(u):0!==(i&=o)&&(r=ft(i))}else 0!==(o=n&~a)?r=ft(o):0!==i&&(r=ft(i));if(0===r)return 0;if(0!==t&&t!==r&&0===(t&a)&&((a=r&-r)>=(i=t&-t)||16===a&&0!==(4194240&i)))return t;if(0!==(4&r)&&(r|=16&n),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=r;0<t;)a=1<<(n=31-ot(t)),r|=e[n],t&=~a;return r}function ht(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function pt(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function vt(){var e=ct;return 0===(4194240&(ct<<=1))&&(ct=64),e}function mt(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function gt(e,t,n){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-ot(t)]=n}function yt(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-ot(n),a=1<<r;a&t|e[r]&t&&(e[r]|=t),n&=~a}}var bt=0;function xt(e){return 1<(e&=-e)?4<e?0!==(268435455&e)?16:536870912:4:1}var wt,kt,_t,St,Ct,At=!1,Et=[],Nt=null,Tt=null,It=null,Dt=new Map,Ft=new Map,Mt=[],Ot="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Rt(e,t){switch(e){case"focusin":case"focusout":Nt=null;break;case"dragenter":case"dragleave":Tt=null;break;case"mouseover":case"mouseout":It=null;break;case"pointerover":case"pointerout":Dt.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ft.delete(t.pointerId)}}function jt(e,t,n,r,a,i){return null===e||e.nativeEvent!==i?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[a]},null!==t&&(null!==(t=ba(t))&&kt(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,null!==a&&-1===t.indexOf(a)&&t.push(a),e)}function Bt(e){var t=ya(e.target);if(null!==t){var n=Ue(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=We(n)))return e.blockedOn=t,void Ct(e.priority,(function(){_t(n)}))}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function zt(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=Kt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n)return null!==(t=ba(n))&&kt(t),e.blockedOn=n,!1;var r=new(n=e.nativeEvent).constructor(n.type,n);xe=r,n.target.dispatchEvent(r),xe=null,t.shift()}return!0}function Zt(e,t,n){zt(e)&&n.delete(t)}function Lt(){At=!1,null!==Nt&&zt(Nt)&&(Nt=null),null!==Tt&&zt(Tt)&&(Tt=null),null!==It&&zt(It)&&(It=null),Dt.forEach(Zt),Ft.forEach(Zt)}function Pt(e,t){e.blockedOn===t&&(e.blockedOn=null,At||(At=!0,a.unstable_scheduleCallback(a.unstable_NormalPriority,Lt)))}function Ut(e){function t(t){return Pt(t,e)}if(0<Et.length){Pt(Et[0],e);for(var n=1;n<Et.length;n++){var r=Et[n];r.blockedOn===e&&(r.blockedOn=null)}}for(null!==Nt&&Pt(Nt,e),null!==Tt&&Pt(Tt,e),null!==It&&Pt(It,e),Dt.forEach(t),Ft.forEach(t),n=0;n<Mt.length;n++)(r=Mt[n]).blockedOn===e&&(r.blockedOn=null);for(;0<Mt.length&&null===(n=Mt[0]).blockedOn;)Bt(n),null===n.blockedOn&&Mt.shift()}var Wt=x.ReactCurrentBatchConfig,Vt=!0;function qt(e,t,n,r){var a=bt,i=Wt.transition;Wt.transition=null;try{bt=1,Ht(e,t,n,r)}finally{bt=a,Wt.transition=i}}function Gt(e,t,n,r){var a=bt,i=Wt.transition;Wt.transition=null;try{bt=4,Ht(e,t,n,r)}finally{bt=a,Wt.transition=i}}function Ht(e,t,n,r){if(Vt){var a=Kt(e,t,n,r);if(null===a)Vr(e,t,r,Xt,n),Rt(e,r);else if(function(e,t,n,r,a){switch(t){case"focusin":return Nt=jt(Nt,e,t,n,r,a),!0;case"dragenter":return Tt=jt(Tt,e,t,n,r,a),!0;case"mouseover":return It=jt(It,e,t,n,r,a),!0;case"pointerover":var i=a.pointerId;return Dt.set(i,jt(Dt.get(i)||null,e,t,n,r,a)),!0;case"gotpointercapture":return i=a.pointerId,Ft.set(i,jt(Ft.get(i)||null,e,t,n,r,a)),!0}return!1}(a,e,t,n,r))r.stopPropagation();else if(Rt(e,r),4&t&&-1<Ot.indexOf(e)){for(;null!==a;){var i=ba(a);if(null!==i&&wt(i),null===(i=Kt(e,t,n,r))&&Vr(e,t,r,Xt,n),i===a)break;a=i}null!==a&&r.stopPropagation()}else Vr(e,t,r,null,n)}}var Xt=null;function Kt(e,t,n,r){if(Xt=null,null!==(e=ya(e=we(r))))if(null===(t=Ue(e)))e=null;else if(13===(n=t.tag)){if(null!==(e=We(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Xt=e,null}function Yt(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Qe()){case Je:return 1;case et:return 4;case tt:case nt:return 16;case rt:return 536870912;default:return 16}default:return 16}}var $t=null,Qt=null,Jt=null;function en(){if(Jt)return Jt;var e,t,n=Qt,r=n.length,a="value"in $t?$t.value:$t.textContent,i=a.length;for(e=0;e<r&&n[e]===a[e];e++);var o=r-e;for(t=1;t<=o&&n[r-t]===a[i-t];t++);return Jt=a.slice(e,1<t?1-t:void 0)}function tn(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function nn(){return!0}function rn(){return!1}function an(e){function t(t,n,r,a,i){for(var o in this._reactName=t,this._targetInst=r,this.type=n,this.nativeEvent=a,this.target=i,this.currentTarget=null,e)e.hasOwnProperty(o)&&(t=e[o],this[o]=t?t(a):a[o]);return this.isDefaultPrevented=(null!=a.defaultPrevented?a.defaultPrevented:!1===a.returnValue)?nn:rn,this.isPropagationStopped=rn,this}return B(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=nn)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=nn)},persist:function(){},isPersistent:nn}),t}var on,un,sn,cn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ln=an(cn),fn=B({},cn,{view:0,detail:0}),dn=an(fn),hn=B({},fn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Cn,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==sn&&(sn&&"mousemove"===e.type?(on=e.screenX-sn.screenX,un=e.screenY-sn.screenY):un=on=0,sn=e),on)},movementY:function(e){return"movementY"in e?e.movementY:un}}),pn=an(hn),vn=an(B({},hn,{dataTransfer:0})),mn=an(B({},fn,{relatedTarget:0})),gn=an(B({},cn,{animationName:0,elapsedTime:0,pseudoElement:0})),yn=B({},cn,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),bn=an(yn),xn=an(B({},cn,{data:0})),wn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},kn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},_n={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Sn(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=_n[e])&&!!t[e]}function Cn(){return Sn}var An=B({},fn,{key:function(e){if(e.key){var t=wn[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=tn(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?kn[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Cn,charCode:function(e){return"keypress"===e.type?tn(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?tn(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),En=an(An),Nn=an(B({},hn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),Tn=an(B({},fn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Cn})),In=an(B({},cn,{propertyName:0,elapsedTime:0,pseudoElement:0})),Dn=B({},hn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Fn=an(Dn),Mn=[9,13,27,32],On=l&&"CompositionEvent"in window,Rn=null;l&&"documentMode"in document&&(Rn=document.documentMode);var jn=l&&"TextEvent"in window&&!Rn,Bn=l&&(!On||Rn&&8<Rn&&11>=Rn),zn=String.fromCharCode(32),Zn=!1;function Ln(e,t){switch(e){case"keyup":return-1!==Mn.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Pn(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var Un=!1;var Wn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Vn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Wn[e.type]:"textarea"===t}function qn(e,t,n,r){Ae(r),0<(t=Gr(t,"onChange")).length&&(n=new ln("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Gn=null,Hn=null;function Xn(e){zr(e,0)}function Kn(e){if(H(xa(e)))return e}function Yn(e,t){if("change"===e)return t}var $n=!1;if(l){var Qn;if(l){var Jn="oninput"in document;if(!Jn){var er=document.createElement("div");er.setAttribute("oninput","return;"),Jn="function"===typeof er.oninput}Qn=Jn}else Qn=!1;$n=Qn&&(!document.documentMode||9<document.documentMode)}function tr(){Gn&&(Gn.detachEvent("onpropertychange",nr),Hn=Gn=null)}function nr(e){if("value"===e.propertyName&&Kn(Hn)){var t=[];qn(t,Hn,e,we(e)),De(Xn,t)}}function rr(e,t,n){"focusin"===e?(tr(),Hn=n,(Gn=t).attachEvent("onpropertychange",nr)):"focusout"===e&&tr()}function ar(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Kn(Hn)}function ir(e,t){if("click"===e)return Kn(t)}function or(e,t){if("input"===e||"change"===e)return Kn(t)}var ur="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function sr(e,t){if(ur(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var a=n[r];if(!f.call(t,a)||!ur(e[a],t[a]))return!1}return!0}function cr(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function lr(e,t){var n,r=cr(e);for(e=0;r;){if(3===r.nodeType){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=cr(r)}}function fr(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?fr(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function dr(){for(var e=window,t=X();t instanceof e.HTMLIFrameElement;){try{var n="string"===typeof t.contentWindow.location.href}catch(r){n=!1}if(!n)break;t=X((e=t.contentWindow).document)}return t}function hr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function pr(e){var t=dr(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&fr(n.ownerDocument.documentElement,n)){if(null!==r&&hr(n))if(t=r.start,void 0===(e=r.end)&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if((e=(t=n.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var a=n.textContent.length,i=Math.min(r.start,a);r=void 0===r.end?i:Math.min(r.end,a),!e.extend&&i>r&&(a=r,r=i,i=a),a=lr(n,i);var o=lr(n,r);a&&o&&(1!==e.rangeCount||e.anchorNode!==a.node||e.anchorOffset!==a.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&((t=t.createRange()).setStart(a.node,a.offset),e.removeAllRanges(),i>r?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}for(t=[],e=n;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"===typeof n.focus&&n.focus(),n=0;n<t.length;n++)(e=t[n]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var vr=l&&"documentMode"in document&&11>=document.documentMode,mr=null,gr=null,yr=null,br=!1;function xr(e,t,n){var r=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;br||null==mr||mr!==X(r)||("selectionStart"in(r=mr)&&hr(r)?r={start:r.selectionStart,end:r.selectionEnd}:r={anchorNode:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset},yr&&sr(yr,r)||(yr=r,0<(r=Gr(gr,"onSelect")).length&&(t=new ln("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=mr)))}function wr(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var kr={animationend:wr("Animation","AnimationEnd"),animationiteration:wr("Animation","AnimationIteration"),animationstart:wr("Animation","AnimationStart"),transitionend:wr("Transition","TransitionEnd")},_r={},Sr={};function Cr(e){if(_r[e])return _r[e];if(!kr[e])return e;var t,n=kr[e];for(t in n)if(n.hasOwnProperty(t)&&t in Sr)return _r[e]=n[t];return e}l&&(Sr=document.createElement("div").style,"AnimationEvent"in window||(delete kr.animationend.animation,delete kr.animationiteration.animation,delete kr.animationstart.animation),"TransitionEvent"in window||delete kr.transitionend.transition);var Ar=Cr("animationend"),Er=Cr("animationiteration"),Nr=Cr("animationstart"),Tr=Cr("transitionend"),Ir=new Map,Dr="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Fr(e,t){Ir.set(e,t),s(t,[e])}for(var Mr=0;Mr<Dr.length;Mr++){var Or=Dr[Mr];Fr(Or.toLowerCase(),"on"+(Or[0].toUpperCase()+Or.slice(1)))}Fr(Ar,"onAnimationEnd"),Fr(Er,"onAnimationIteration"),Fr(Nr,"onAnimationStart"),Fr("dblclick","onDoubleClick"),Fr("focusin","onFocus"),Fr("focusout","onBlur"),Fr(Tr,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),s("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),s("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),s("onBeforeInput",["compositionend","keypress","textInput","paste"]),s("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Rr="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),jr=new Set("cancel close invalid load scroll toggle".split(" ").concat(Rr));function Br(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,function(e,t,n,r,a,o,u,s,c){if(Pe.apply(this,arguments),je){if(!je)throw Error(i(198));var l=Be;je=!1,Be=null,ze||(ze=!0,Ze=l)}}(r,t,void 0,e),e.currentTarget=null}function zr(e,t){t=0!==(4&t);for(var n=0;n<e.length;n++){var r=e[n],a=r.event;r=r.listeners;e:{var i=void 0;if(t)for(var o=r.length-1;0<=o;o--){var u=r[o],s=u.instance,c=u.currentTarget;if(u=u.listener,s!==i&&a.isPropagationStopped())break e;Br(a,u,c),i=s}else for(o=0;o<r.length;o++){if(s=(u=r[o]).instance,c=u.currentTarget,u=u.listener,s!==i&&a.isPropagationStopped())break e;Br(a,u,c),i=s}}}if(ze)throw e=Ze,ze=!1,Ze=null,e}function Zr(e,t){var n=t[va];void 0===n&&(n=t[va]=new Set);var r=e+"__bubble";n.has(r)||(Wr(t,e,2,!1),n.add(r))}function Lr(e,t,n){var r=0;t&&(r|=4),Wr(n,e,r,t)}var Pr="_reactListening"+Math.random().toString(36).slice(2);function Ur(e){if(!e[Pr]){e[Pr]=!0,o.forEach((function(t){"selectionchange"!==t&&(jr.has(t)||Lr(t,!1,e),Lr(t,!0,e))}));var t=9===e.nodeType?e:e.ownerDocument;null===t||t[Pr]||(t[Pr]=!0,Lr("selectionchange",!1,t))}}function Wr(e,t,n,r){switch(Yt(t)){case 1:var a=qt;break;case 4:a=Gt;break;default:a=Ht}n=a.bind(null,t,n,e),a=void 0,!Me||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(a=!0),r?void 0!==a?e.addEventListener(t,n,{capture:!0,passive:a}):e.addEventListener(t,n,!0):void 0!==a?e.addEventListener(t,n,{passive:a}):e.addEventListener(t,n,!1)}function Vr(e,t,n,r,a){var i=r;if(0===(1&t)&&0===(2&t)&&null!==r)e:for(;;){if(null===r)return;var o=r.tag;if(3===o||4===o){var u=r.stateNode.containerInfo;if(u===a||8===u.nodeType&&u.parentNode===a)break;if(4===o)for(o=r.return;null!==o;){var s=o.tag;if((3===s||4===s)&&((s=o.stateNode.containerInfo)===a||8===s.nodeType&&s.parentNode===a))return;o=o.return}for(;null!==u;){if(null===(o=ya(u)))return;if(5===(s=o.tag)||6===s){r=i=o;continue e}u=u.parentNode}}r=r.return}De((function(){var r=i,a=we(n),o=[];e:{var u=Ir.get(e);if(void 0!==u){var s=ln,c=e;switch(e){case"keypress":if(0===tn(n))break e;case"keydown":case"keyup":s=En;break;case"focusin":c="focus",s=mn;break;case"focusout":c="blur",s=mn;break;case"beforeblur":case"afterblur":s=mn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":s=pn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":s=vn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":s=Tn;break;case Ar:case Er:case Nr:s=gn;break;case Tr:s=In;break;case"scroll":s=dn;break;case"wheel":s=Fn;break;case"copy":case"cut":case"paste":s=bn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":s=Nn}var l=0!==(4&t),f=!l&&"scroll"===e,d=l?null!==u?u+"Capture":null:u;l=[];for(var h,p=r;null!==p;){var v=(h=p).stateNode;if(5===h.tag&&null!==v&&(h=v,null!==d&&(null!=(v=Fe(p,d))&&l.push(qr(p,v,h)))),f)break;p=p.return}0<l.length&&(u=new s(u,c,null,n,a),o.push({event:u,listeners:l}))}}if(0===(7&t)){if(s="mouseout"===e||"pointerout"===e,(!(u="mouseover"===e||"pointerover"===e)||n===xe||!(c=n.relatedTarget||n.fromElement)||!ya(c)&&!c[pa])&&(s||u)&&(u=a.window===a?a:(u=a.ownerDocument)?u.defaultView||u.parentWindow:window,s?(s=r,null!==(c=(c=n.relatedTarget||n.toElement)?ya(c):null)&&(c!==(f=Ue(c))||5!==c.tag&&6!==c.tag)&&(c=null)):(s=null,c=r),s!==c)){if(l=pn,v="onMouseLeave",d="onMouseEnter",p="mouse","pointerout"!==e&&"pointerover"!==e||(l=Nn,v="onPointerLeave",d="onPointerEnter",p="pointer"),f=null==s?u:xa(s),h=null==c?u:xa(c),(u=new l(v,p+"leave",s,n,a)).target=f,u.relatedTarget=h,v=null,ya(a)===r&&((l=new l(d,p+"enter",c,n,a)).target=h,l.relatedTarget=f,v=l),f=v,s&&c)e:{for(d=c,p=0,h=l=s;h;h=Hr(h))p++;for(h=0,v=d;v;v=Hr(v))h++;for(;0<p-h;)l=Hr(l),p--;for(;0<h-p;)d=Hr(d),h--;for(;p--;){if(l===d||null!==d&&l===d.alternate)break e;l=Hr(l),d=Hr(d)}l=null}else l=null;null!==s&&Xr(o,u,s,l,!1),null!==c&&null!==f&&Xr(o,f,c,l,!0)}if("select"===(s=(u=r?xa(r):window).nodeName&&u.nodeName.toLowerCase())||"input"===s&&"file"===u.type)var m=Yn;else if(Vn(u))if($n)m=or;else{m=ar;var g=rr}else(s=u.nodeName)&&"input"===s.toLowerCase()&&("checkbox"===u.type||"radio"===u.type)&&(m=ir);switch(m&&(m=m(e,r))?qn(o,m,n,a):(g&&g(e,u,r),"focusout"===e&&(g=u._wrapperState)&&g.controlled&&"number"===u.type&&ee(u,"number",u.value)),g=r?xa(r):window,e){case"focusin":(Vn(g)||"true"===g.contentEditable)&&(mr=g,gr=r,yr=null);break;case"focusout":yr=gr=mr=null;break;case"mousedown":br=!0;break;case"contextmenu":case"mouseup":case"dragend":br=!1,xr(o,n,a);break;case"selectionchange":if(vr)break;case"keydown":case"keyup":xr(o,n,a)}var y;if(On)e:{switch(e){case"compositionstart":var b="onCompositionStart";break e;case"compositionend":b="onCompositionEnd";break e;case"compositionupdate":b="onCompositionUpdate";break e}b=void 0}else Un?Ln(e,n)&&(b="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(b="onCompositionStart");b&&(Bn&&"ko"!==n.locale&&(Un||"onCompositionStart"!==b?"onCompositionEnd"===b&&Un&&(y=en()):(Qt="value"in($t=a)?$t.value:$t.textContent,Un=!0)),0<(g=Gr(r,b)).length&&(b=new xn(b,e,null,n,a),o.push({event:b,listeners:g}),y?b.data=y:null!==(y=Pn(n))&&(b.data=y))),(y=jn?function(e,t){switch(e){case"compositionend":return Pn(t);case"keypress":return 32!==t.which?null:(Zn=!0,zn);case"textInput":return(e=t.data)===zn&&Zn?null:e;default:return null}}(e,n):function(e,t){if(Un)return"compositionend"===e||!On&&Ln(e,t)?(e=en(),Jt=Qt=$t=null,Un=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Bn&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(r=Gr(r,"onBeforeInput")).length&&(a=new xn("onBeforeInput","beforeinput",null,n,a),o.push({event:a,listeners:r}),a.data=y))}zr(o,t)}))}function qr(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Gr(e,t){for(var n=t+"Capture",r=[];null!==e;){var a=e,i=a.stateNode;5===a.tag&&null!==i&&(a=i,null!=(i=Fe(e,n))&&r.unshift(qr(e,i,a)),null!=(i=Fe(e,t))&&r.push(qr(e,i,a))),e=e.return}return r}function Hr(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Xr(e,t,n,r,a){for(var i=t._reactName,o=[];null!==n&&n!==r;){var u=n,s=u.alternate,c=u.stateNode;if(null!==s&&s===r)break;5===u.tag&&null!==c&&(u=c,a?null!=(s=Fe(n,i))&&o.unshift(qr(n,s,u)):a||null!=(s=Fe(n,i))&&o.push(qr(n,s,u))),n=n.return}0!==o.length&&e.push({event:t,listeners:o})}var Kr=/\r\n?/g,Yr=/\u0000|\uFFFD/g;function $r(e){return("string"===typeof e?e:""+e).replace(Kr,"\n").replace(Yr,"")}function Qr(e,t,n){if(t=$r(t),$r(e)!==t&&n)throw Error(i(425))}function Jr(){}var ea=null,ta=null;function na(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var ra="function"===typeof setTimeout?setTimeout:void 0,aa="function"===typeof clearTimeout?clearTimeout:void 0,ia="function"===typeof Promise?Promise:void 0,oa="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof ia?function(e){return ia.resolve(null).then(e).catch(ua)}:ra;function ua(e){setTimeout((function(){throw e}))}function sa(e,t){var n=t,r=0;do{var a=n.nextSibling;if(e.removeChild(n),a&&8===a.nodeType)if("/$"===(n=a.data)){if(0===r)return e.removeChild(a),void Ut(t);r--}else"$"!==n&&"$?"!==n&&"$!"!==n||r++;n=a}while(n);Ut(t)}function ca(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function la(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}var fa=Math.random().toString(36).slice(2),da="__reactFiber$"+fa,ha="__reactProps$"+fa,pa="__reactContainer$"+fa,va="__reactEvents$"+fa,ma="__reactListeners$"+fa,ga="__reactHandles$"+fa;function ya(e){var t=e[da];if(t)return t;for(var n=e.parentNode;n;){if(t=n[pa]||n[da]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=la(e);null!==e;){if(n=e[da])return n;e=la(e)}return t}n=(e=n).parentNode}return null}function ba(e){return!(e=e[da]||e[pa])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function xa(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(i(33))}function wa(e){return e[ha]||null}var ka=[],_a=-1;function Sa(e){return{current:e}}function Ca(e){0>_a||(e.current=ka[_a],ka[_a]=null,_a--)}function Aa(e,t){_a++,ka[_a]=e.current,e.current=t}var Ea={},Na=Sa(Ea),Ta=Sa(!1),Ia=Ea;function Da(e,t){var n=e.type.contextTypes;if(!n)return Ea;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var a,i={};for(a in n)i[a]=t[a];return r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=i),i}function Fa(e){return null!==(e=e.childContextTypes)&&void 0!==e}function Ma(){Ca(Ta),Ca(Na)}function Oa(e,t,n){if(Na.current!==Ea)throw Error(i(168));Aa(Na,t),Aa(Ta,n)}function Ra(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,"function"!==typeof r.getChildContext)return n;for(var a in r=r.getChildContext())if(!(a in t))throw Error(i(108,W(e)||"Unknown",a));return B({},n,r)}function ja(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Ea,Ia=Na.current,Aa(Na,e),Aa(Ta,Ta.current),!0}function Ba(e,t,n){var r=e.stateNode;if(!r)throw Error(i(169));n?(e=Ra(e,t,Ia),r.__reactInternalMemoizedMergedChildContext=e,Ca(Ta),Ca(Na),Aa(Na,e)):Ca(Ta),Aa(Ta,n)}var za=null,Za=!1,La=!1;function Pa(e){null===za?za=[e]:za.push(e)}function Ua(){if(!La&&null!==za){La=!0;var e=0,t=bt;try{var n=za;for(bt=1;e<n.length;e++){var r=n[e];do{r=r(!0)}while(null!==r)}za=null,Za=!1}catch(a){throw null!==za&&(za=za.slice(e+1)),He(Je,Ua),a}finally{bt=t,La=!1}}return null}var Wa=x.ReactCurrentBatchConfig;function Va(e,t){if(e&&e.defaultProps){for(var n in t=B({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}var qa=Sa(null),Ga=null,Ha=null,Xa=null;function Ka(){Xa=Ha=Ga=null}function Ya(e){var t=qa.current;Ca(qa),e._currentValue=t}function $a(e,t,n){for(;null!==e;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==r&&(r.childLanes|=t)):null!==r&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function Qa(e,t){Ga=e,Xa=Ha=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(wu=!0),e.firstContext=null)}function Ja(e){var t=e._currentValue;if(Xa!==e)if(e={context:e,memoizedValue:t,next:null},null===Ha){if(null===Ga)throw Error(i(308));Ha=e,Ga.dependencies={lanes:0,firstContext:e}}else Ha=Ha.next=e;return t}var ei=null,ti=!1;function ni(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function ri(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function ai(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function ii(e,t){var n=e.updateQueue;null!==n&&(n=n.shared,tc(e)?(null===(e=n.interleaved)?(t.next=t,null===ei?ei=[n]:ei.push(n)):(t.next=e.next,e.next=t),n.interleaved=t):(null===(e=n.pending)?t.next=t:(t.next=e.next,e.next=t),n.pending=t))}function oi(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194240&n))){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,yt(e,n)}}function ui(e,t){var n=e.updateQueue,r=e.alternate;if(null!==r&&n===(r=r.updateQueue)){var a=null,i=null;if(null!==(n=n.firstBaseUpdate)){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===i?a=i=o:i=i.next=o,n=n.next}while(null!==n);null===i?a=i=t:i=i.next=t}else a=i=t;return n={baseState:r.baseState,firstBaseUpdate:a,lastBaseUpdate:i,shared:r.shared,effects:r.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function si(e,t,n,r){var a=e.updateQueue;ti=!1;var i=a.firstBaseUpdate,o=a.lastBaseUpdate,u=a.shared.pending;if(null!==u){a.shared.pending=null;var s=u,c=s.next;s.next=null,null===o?i=c:o.next=c,o=s;var l=e.alternate;null!==l&&((u=(l=l.updateQueue).lastBaseUpdate)!==o&&(null===u?l.firstBaseUpdate=c:u.next=c,l.lastBaseUpdate=s))}if(null!==i){var f=a.baseState;for(o=0,l=c=s=null,u=i;;){var d=u.lane,h=u.eventTime;if((r&d)===d){null!==l&&(l=l.next={eventTime:h,lane:0,tag:u.tag,payload:u.payload,callback:u.callback,next:null});e:{var p=e,v=u;switch(d=t,h=n,v.tag){case 1:if("function"===typeof(p=v.payload)){f=p.call(h,f,d);break e}f=p;break e;case 3:p.flags=-65537&p.flags|128;case 0:if(null===(d="function"===typeof(p=v.payload)?p.call(h,f,d):p)||void 0===d)break e;f=B({},f,d);break e;case 2:ti=!0}}null!==u.callback&&0!==u.lane&&(e.flags|=64,null===(d=a.effects)?a.effects=[u]:d.push(u))}else h={eventTime:h,lane:d,tag:u.tag,payload:u.payload,callback:u.callback,next:null},null===l?(c=l=h,s=f):l=l.next=h,o|=d;if(null===(u=u.next)){if(null===(u=a.shared.pending))break;u=(d=u).next,d.next=null,a.lastBaseUpdate=d,a.shared.pending=null}}if(null===l&&(s=f),a.baseState=s,a.firstBaseUpdate=c,a.lastBaseUpdate=l,null!==(t=a.shared.interleaved)){a=t;do{o|=a.lane,a=a.next}while(a!==t)}else null===i&&(a.shared.lanes=0);Ms|=o,e.lanes=o,e.memoizedState=f}}function ci(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var r=e[t],a=r.callback;if(null!==a){if(r.callback=null,r=n,"function"!==typeof a)throw Error(i(191,a));a.call(r)}}}var li=(new r.Component).refs;function fi(e,t,n,r){n=null===(n=n(r,t=e.memoizedState))||void 0===n?t:B({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var di={isMounted:function(e){return!!(e=e._reactInternals)&&Ue(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=$s(),a=Qs(e),i=ai(r,a);i.payload=t,void 0!==n&&null!==n&&(i.callback=n),ii(e,i),null!==(t=Js(e,a,r))&&oi(t,e,a)},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=$s(),a=Qs(e),i=ai(r,a);i.tag=1,i.payload=t,void 0!==n&&null!==n&&(i.callback=n),ii(e,i),null!==(t=Js(e,a,r))&&oi(t,e,a)},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=$s(),r=Qs(e),a=ai(n,r);a.tag=2,void 0!==t&&null!==t&&(a.callback=t),ii(e,a),null!==(t=Js(e,r,n))&&oi(t,e,r)}};function hi(e,t,n,r,a,i,o){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,i,o):!t.prototype||!t.prototype.isPureReactComponent||(!sr(n,r)||!sr(a,i))}function pi(e,t,n){var r=!1,a=Ea,i=t.contextType;return"object"===typeof i&&null!==i?i=Ja(i):(a=Fa(t)?Ia:Na.current,i=(r=null!==(r=t.contextTypes)&&void 0!==r)?Da(e,a):Ea),t=new t(n,i),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=di,e.stateNode=t,t._reactInternals=e,r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=a,e.__reactInternalMemoizedMaskedChildContext=i),t}function vi(e,t,n,r){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&di.enqueueReplaceState(t,t.state,null)}function mi(e,t,n,r){var a=e.stateNode;a.props=n,a.state=e.memoizedState,a.refs=li,ni(e);var i=t.contextType;"object"===typeof i&&null!==i?a.context=Ja(i):(i=Fa(t)?Ia:Na.current,a.context=Da(e,i)),a.state=e.memoizedState,"function"===typeof(i=t.getDerivedStateFromProps)&&(fi(e,t,i,n),a.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof a.getSnapshotBeforeUpdate||"function"!==typeof a.UNSAFE_componentWillMount&&"function"!==typeof a.componentWillMount||(t=a.state,"function"===typeof a.componentWillMount&&a.componentWillMount(),"function"===typeof a.UNSAFE_componentWillMount&&a.UNSAFE_componentWillMount(),t!==a.state&&di.enqueueReplaceState(a,a.state,null),si(e,n,a,r),a.state=e.memoizedState),"function"===typeof a.componentDidMount&&(e.flags|=4194308)}var gi=[],yi=0,bi=null,xi=0,wi=[],ki=0,_i=null,Si=1,Ci="";function Ai(e,t){gi[yi++]=xi,gi[yi++]=bi,bi=e,xi=t}function Ei(e,t,n){wi[ki++]=Si,wi[ki++]=Ci,wi[ki++]=_i,_i=e;var r=Si;e=Ci;var a=32-ot(r)-1;r&=~(1<<a),n+=1;var i=32-ot(t)+a;if(30<i){var o=a-a%5;i=(r&(1<<o)-1).toString(32),r>>=o,a-=o,Si=1<<32-ot(t)+a|n<<a|r,Ci=i+e}else Si=1<<i|n<<a|r,Ci=e}function Ni(e){null!==e.return&&(Ai(e,1),Ei(e,1,0))}function Ti(e){for(;e===bi;)bi=gi[--yi],gi[yi]=null,xi=gi[--yi],gi[yi]=null;for(;e===_i;)_i=wi[--ki],wi[ki]=null,Ci=wi[--ki],wi[ki]=null,Si=wi[--ki],wi[ki]=null}var Ii=null,Di=null,Fi=!1,Mi=null;function Oi(e,t){var n=Ic(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,null===(t=e.deletions)?(e.deletions=[n],e.flags|=16):t.push(n)}function Ri(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,Ii=e,Di=ca(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,Ii=e,Di=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(n=null!==_i?{id:Si,overflow:Ci}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},(n=Ic(18,null,null,0)).stateNode=t,n.return=e,e.child=n,Ii=e,Di=null,!0);default:return!1}}function ji(e){return 0!==(1&e.mode)&&0===(128&e.flags)}function Bi(e){if(Fi){var t=Di;if(t){var n=t;if(!Ri(e,t)){if(ji(e))throw Error(i(418));t=ca(n.nextSibling);var r=Ii;t&&Ri(e,t)?Oi(r,n):(e.flags=-4097&e.flags|2,Fi=!1,Ii=e)}}else{if(ji(e))throw Error(i(418));e.flags=-4097&e.flags|2,Fi=!1,Ii=e}}}function zi(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;Ii=e}function Zi(e){if(e!==Ii)return!1;if(!Fi)return zi(e),Fi=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!na(e.type,e.memoizedProps)),t&&(t=Di)){if(ji(e)){for(e=Di;e;)e=ca(e.nextSibling);throw Error(i(418))}for(;t;)Oi(e,t),t=ca(t.nextSibling)}if(zi(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(i(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n){if(0===t){Di=ca(e.nextSibling);break e}t--}else"$"!==n&&"$!"!==n&&"$?"!==n||t++}e=e.nextSibling}Di=null}}else Di=Ii?ca(e.stateNode.nextSibling):null;return!0}function Li(){Di=Ii=null,Fi=!1}function Pi(e){null===Mi?Mi=[e]:Mi.push(e)}function Ui(e,t,n){if(null!==(e=n.ref)&&"function"!==typeof e&&"object"!==typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(i(309));var r=n.stateNode}if(!r)throw Error(i(147,e));var a=r,o=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===o?t.ref:(t=function(e){var t=a.refs;t===li&&(t=a.refs={}),null===e?delete t[o]:t[o]=e},t._stringRef=o,t)}if("string"!==typeof e)throw Error(i(284));if(!n._owner)throw Error(i(290,e))}return e}function Wi(e,t){throw e=Object.prototype.toString.call(t),Error(i(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Vi(e){return(0,e._init)(e._payload)}function qi(e){function t(t,n){if(e){var r=t.deletions;null===r?(t.deletions=[n],t.flags|=16):r.push(n)}}function n(n,r){if(!e)return null;for(;null!==r;)t(n,r),r=r.sibling;return null}function r(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function a(e,t){return(e=Fc(e,t)).index=0,e.sibling=null,e}function o(t,n,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<n?(t.flags|=2,n):r:(t.flags|=2,n):(t.flags|=1048576,n)}function u(t){return e&&null===t.alternate&&(t.flags|=2),t}function s(e,t,n,r){return null===t||6!==t.tag?((t=jc(n,e.mode,r)).return=e,t):((t=a(t,n)).return=e,t)}function c(e,t,n,r){var i=n.type;return i===_?f(e,t,n.props.children,r,n.key):null!==t&&(t.elementType===i||"object"===typeof i&&null!==i&&i.$$typeof===F&&Vi(i)===t.type)?((r=a(t,n.props)).ref=Ui(e,t,n),r.return=e,r):((r=Mc(n.type,n.key,n.props,null,e.mode,r)).ref=Ui(e,t,n),r.return=e,r)}function l(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Bc(n,e.mode,r)).return=e,t):((t=a(t,n.children||[])).return=e,t)}function f(e,t,n,r,i){return null===t||7!==t.tag?((t=Oc(n,e.mode,r,i)).return=e,t):((t=a(t,n)).return=e,t)}function d(e,t,n){if("string"===typeof t&&""!==t||"number"===typeof t)return(t=jc(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case w:return(n=Mc(t.type,t.key,t.props,null,e.mode,n)).ref=Ui(e,null,t),n.return=e,n;case k:return(t=Bc(t,e.mode,n)).return=e,t;case F:return d(e,(0,t._init)(t._payload),n)}if(te(t)||R(t))return(t=Oc(t,e.mode,n,null)).return=e,t;Wi(e,t)}return null}function h(e,t,n,r){var a=null!==t?t.key:null;if("string"===typeof n&&""!==n||"number"===typeof n)return null!==a?null:s(e,t,""+n,r);if("object"===typeof n&&null!==n){switch(n.$$typeof){case w:return n.key===a?c(e,t,n,r):null;case k:return n.key===a?l(e,t,n,r):null;case F:return h(e,t,(a=n._init)(n._payload),r)}if(te(n)||R(n))return null!==a?null:f(e,t,n,r,null);Wi(e,n)}return null}function p(e,t,n,r,a){if("string"===typeof r&&""!==r||"number"===typeof r)return s(t,e=e.get(n)||null,""+r,a);if("object"===typeof r&&null!==r){switch(r.$$typeof){case w:return c(t,e=e.get(null===r.key?n:r.key)||null,r,a);case k:return l(t,e=e.get(null===r.key?n:r.key)||null,r,a);case F:return p(e,t,n,(0,r._init)(r._payload),a)}if(te(r)||R(r))return f(t,e=e.get(n)||null,r,a,null);Wi(t,r)}return null}function v(a,i,u,s){for(var c=null,l=null,f=i,v=i=0,m=null;null!==f&&v<u.length;v++){f.index>v?(m=f,f=null):m=f.sibling;var g=h(a,f,u[v],s);if(null===g){null===f&&(f=m);break}e&&f&&null===g.alternate&&t(a,f),i=o(g,i,v),null===l?c=g:l.sibling=g,l=g,f=m}if(v===u.length)return n(a,f),Fi&&Ai(a,v),c;if(null===f){for(;v<u.length;v++)null!==(f=d(a,u[v],s))&&(i=o(f,i,v),null===l?c=f:l.sibling=f,l=f);return Fi&&Ai(a,v),c}for(f=r(a,f);v<u.length;v++)null!==(m=p(f,a,v,u[v],s))&&(e&&null!==m.alternate&&f.delete(null===m.key?v:m.key),i=o(m,i,v),null===l?c=m:l.sibling=m,l=m);return e&&f.forEach((function(e){return t(a,e)})),Fi&&Ai(a,v),c}function m(a,u,s,c){var l=R(s);if("function"!==typeof l)throw Error(i(150));if(null==(s=l.call(s)))throw Error(i(151));for(var f=l=null,v=u,m=u=0,g=null,y=s.next();null!==v&&!y.done;m++,y=s.next()){v.index>m?(g=v,v=null):g=v.sibling;var b=h(a,v,y.value,c);if(null===b){null===v&&(v=g);break}e&&v&&null===b.alternate&&t(a,v),u=o(b,u,m),null===f?l=b:f.sibling=b,f=b,v=g}if(y.done)return n(a,v),Fi&&Ai(a,m),l;if(null===v){for(;!y.done;m++,y=s.next())null!==(y=d(a,y.value,c))&&(u=o(y,u,m),null===f?l=y:f.sibling=y,f=y);return Fi&&Ai(a,m),l}for(v=r(a,v);!y.done;m++,y=s.next())null!==(y=p(v,a,m,y.value,c))&&(e&&null!==y.alternate&&v.delete(null===y.key?m:y.key),u=o(y,u,m),null===f?l=y:f.sibling=y,f=y);return e&&v.forEach((function(e){return t(a,e)})),Fi&&Ai(a,m),l}return function e(r,i,o,s){if("object"===typeof o&&null!==o&&o.type===_&&null===o.key&&(o=o.props.children),"object"===typeof o&&null!==o){switch(o.$$typeof){case w:e:{for(var c=o.key,l=i;null!==l;){if(l.key===c){if((c=o.type)===_){if(7===l.tag){n(r,l.sibling),(i=a(l,o.props.children)).return=r,r=i;break e}}else if(l.elementType===c||"object"===typeof c&&null!==c&&c.$$typeof===F&&Vi(c)===l.type){n(r,l.sibling),(i=a(l,o.props)).ref=Ui(r,l,o),i.return=r,r=i;break e}n(r,l);break}t(r,l),l=l.sibling}o.type===_?((i=Oc(o.props.children,r.mode,s,o.key)).return=r,r=i):((s=Mc(o.type,o.key,o.props,null,r.mode,s)).ref=Ui(r,i,o),s.return=r,r=s)}return u(r);case k:e:{for(l=o.key;null!==i;){if(i.key===l){if(4===i.tag&&i.stateNode.containerInfo===o.containerInfo&&i.stateNode.implementation===o.implementation){n(r,i.sibling),(i=a(i,o.children||[])).return=r,r=i;break e}n(r,i);break}t(r,i),i=i.sibling}(i=Bc(o,r.mode,s)).return=r,r=i}return u(r);case F:return e(r,i,(l=o._init)(o._payload),s)}if(te(o))return v(r,i,o,s);if(R(o))return m(r,i,o,s);Wi(r,o)}return"string"===typeof o&&""!==o||"number"===typeof o?(o=""+o,null!==i&&6===i.tag?(n(r,i.sibling),(i=a(i,o)).return=r,r=i):(n(r,i),(i=jc(o,r.mode,s)).return=r,r=i),u(r)):n(r,i)}}var Gi=qi(!0),Hi=qi(!1),Xi={},Ki=Sa(Xi),Yi=Sa(Xi),$i=Sa(Xi);function Qi(e){if(e===Xi)throw Error(i(174));return e}function Ji(e,t){switch(Aa($i,t),Aa(Yi,e),Aa(Ki,Xi),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:se(null,"");break;default:t=se(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}Ca(Ki),Aa(Ki,t)}function eo(){Ca(Ki),Ca(Yi),Ca($i)}function to(e){Qi($i.current);var t=Qi(Ki.current),n=se(t,e.type);t!==n&&(Aa(Yi,e),Aa(Ki,n))}function no(e){Yi.current===e&&(Ca(Ki),Ca(Yi))}var ro=Sa(0);function ao(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var io=[];function oo(){for(var e=0;e<io.length;e++)io[e]._workInProgressVersionPrimary=null;io.length=0}var uo=x.ReactCurrentDispatcher,so=x.ReactCurrentBatchConfig,co=0,lo=null,fo=null,ho=null,po=!1,vo=!1,mo=0,go=0;function yo(){throw Error(i(321))}function bo(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!ur(e[n],t[n]))return!1;return!0}function xo(e,t,n,r,a,o){if(co=o,lo=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,uo.current=null===e||null===e.memoizedState?ru:au,e=n(r,a),vo){o=0;do{if(vo=!1,mo=0,25<=o)throw Error(i(301));o+=1,ho=fo=null,t.updateQueue=null,uo.current=iu,e=n(r,a)}while(vo)}if(uo.current=nu,t=null!==fo&&null!==fo.next,co=0,ho=fo=lo=null,po=!1,t)throw Error(i(300));return e}function wo(){var e=0!==mo;return mo=0,e}function ko(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===ho?lo.memoizedState=ho=e:ho=ho.next=e,ho}function _o(){if(null===fo){var e=lo.alternate;e=null!==e?e.memoizedState:null}else e=fo.next;var t=null===ho?lo.memoizedState:ho.next;if(null!==t)ho=t,fo=e;else{if(null===e)throw Error(i(310));e={memoizedState:(fo=e).memoizedState,baseState:fo.baseState,baseQueue:fo.baseQueue,queue:fo.queue,next:null},null===ho?lo.memoizedState=ho=e:ho=ho.next=e}return ho}function So(e,t){return"function"===typeof t?t(e):t}function Co(e){var t=_o(),n=t.queue;if(null===n)throw Error(i(311));n.lastRenderedReducer=e;var r=fo,a=r.baseQueue,o=n.pending;if(null!==o){if(null!==a){var u=a.next;a.next=o.next,o.next=u}r.baseQueue=a=o,n.pending=null}if(null!==a){o=a.next,r=r.baseState;var s=u=null,c=null,l=o;do{var f=l.lane;if((co&f)===f)null!==c&&(c=c.next={lane:0,action:l.action,hasEagerState:l.hasEagerState,eagerState:l.eagerState,next:null}),r=l.hasEagerState?l.eagerState:e(r,l.action);else{var d={lane:f,action:l.action,hasEagerState:l.hasEagerState,eagerState:l.eagerState,next:null};null===c?(s=c=d,u=r):c=c.next=d,lo.lanes|=f,Ms|=f}l=l.next}while(null!==l&&l!==o);null===c?u=r:c.next=s,ur(r,t.memoizedState)||(wu=!0),t.memoizedState=r,t.baseState=u,t.baseQueue=c,n.lastRenderedState=r}if(null!==(e=n.interleaved)){a=e;do{o=a.lane,lo.lanes|=o,Ms|=o,a=a.next}while(a!==e)}else null===a&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function Ao(e){var t=_o(),n=t.queue;if(null===n)throw Error(i(311));n.lastRenderedReducer=e;var r=n.dispatch,a=n.pending,o=t.memoizedState;if(null!==a){n.pending=null;var u=a=a.next;do{o=e(o,u.action),u=u.next}while(u!==a);ur(o,t.memoizedState)||(wu=!0),t.memoizedState=o,null===t.baseQueue&&(t.baseState=o),n.lastRenderedState=o}return[o,r]}function Eo(){}function No(e,t){var n=lo,r=_o(),a=t(),o=!ur(r.memoizedState,a);if(o&&(r.memoizedState=a,wu=!0),r=r.queue,Zo(Do.bind(null,n,r,e),[e]),r.getSnapshot!==t||o||null!==ho&&1&ho.memoizedState.tag){if(n.flags|=2048,Oo(9,Io.bind(null,n,r,a,t),void 0,null),null===As)throw Error(i(349));0!==(30&co)||To(n,t,a)}return a}function To(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=lo.updateQueue)?(t={lastEffect:null,stores:null},lo.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function Io(e,t,n,r){t.value=n,t.getSnapshot=r,Fo(t)&&Js(e,1,-1)}function Do(e,t,n){return n((function(){Fo(t)&&Js(e,1,-1)}))}function Fo(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!ur(e,n)}catch(r){return!0}}function Mo(e){var t=ko();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:So,lastRenderedState:e},t.queue=e,e=e.dispatch=$o.bind(null,lo,e),[t.memoizedState,e]}function Oo(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},null===(t=lo.updateQueue)?(t={lastEffect:null,stores:null},lo.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function Ro(){return _o().memoizedState}function jo(e,t,n,r){var a=ko();lo.flags|=e,a.memoizedState=Oo(1|t,n,void 0,void 0===r?null:r)}function Bo(e,t,n,r){var a=_o();r=void 0===r?null:r;var i=void 0;if(null!==fo){var o=fo.memoizedState;if(i=o.destroy,null!==r&&bo(r,o.deps))return void(a.memoizedState=Oo(t,n,i,r))}lo.flags|=e,a.memoizedState=Oo(1|t,n,i,r)}function zo(e,t){return jo(8390656,8,e,t)}function Zo(e,t){return Bo(2048,8,e,t)}function Lo(e,t){return Bo(4,2,e,t)}function Po(e,t){return Bo(4,4,e,t)}function Uo(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function Wo(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Bo(4,4,Uo.bind(null,t,e),n)}function Vo(){}function qo(e,t){var n=_o();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&bo(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function Go(e,t){var n=_o();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&bo(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function Ho(e,t,n){return 0===(21&co)?(e.baseState&&(e.baseState=!1,wu=!0),e.memoizedState=n):(ur(n,t)||(n=vt(),lo.lanes|=n,Ms|=n,e.baseState=!0),t)}function Xo(e,t){var n=bt;bt=0!==n&&4>n?n:4,e(!0);var r=so.transition;so.transition={};try{e(!1),t()}finally{bt=n,so.transition=r}}function Ko(){return _o().memoizedState}function Yo(e,t,n){var r=Qs(e);n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},Qo(e)?Jo(t,n):(eu(e,t,n),null!==(e=Js(e,r,n=$s()))&&tu(e,t,r))}function $o(e,t,n){var r=Qs(e),a={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(Qo(e))Jo(t,a);else{eu(e,t,a);var i=e.alternate;if(0===e.lanes&&(null===i||0===i.lanes)&&null!==(i=t.lastRenderedReducer))try{var o=t.lastRenderedState,u=i(o,n);if(a.hasEagerState=!0,a.eagerState=u,ur(u,o))return}catch(s){}null!==(e=Js(e,r,n=$s()))&&tu(e,t,r)}}function Qo(e){var t=e.alternate;return e===lo||null!==t&&t===lo}function Jo(e,t){vo=po=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function eu(e,t,n){tc(e)?(null===(e=t.interleaved)?(n.next=n,null===ei?ei=[t]:ei.push(t)):(n.next=e.next,e.next=n),t.interleaved=n):(null===(e=t.pending)?n.next=n:(n.next=e.next,e.next=n),t.pending=n)}function tu(e,t,n){if(0!==(4194240&n)){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,yt(e,n)}}var nu={readContext:Ja,useCallback:yo,useContext:yo,useEffect:yo,useImperativeHandle:yo,useInsertionEffect:yo,useLayoutEffect:yo,useMemo:yo,useReducer:yo,useRef:yo,useState:yo,useDebugValue:yo,useDeferredValue:yo,useTransition:yo,useMutableSource:yo,useSyncExternalStore:yo,useId:yo,unstable_isNewReconciler:!1},ru={readContext:Ja,useCallback:function(e,t){return ko().memoizedState=[e,void 0===t?null:t],e},useContext:Ja,useEffect:zo,useImperativeHandle:function(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,jo(4194308,4,Uo.bind(null,t,e),n)},useLayoutEffect:function(e,t){return jo(4194308,4,e,t)},useInsertionEffect:function(e,t){return jo(4,2,e,t)},useMemo:function(e,t){var n=ko();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=ko();return t=void 0!==n?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=Yo.bind(null,lo,e),[r.memoizedState,e]},useRef:function(e){return e={current:e},ko().memoizedState=e},useState:Mo,useDebugValue:Vo,useDeferredValue:function(e){return ko().memoizedState=e},useTransition:function(){var e=Mo(!1),t=e[0];return e=Xo.bind(null,e[1]),ko().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=lo,a=ko();if(Fi){if(void 0===n)throw Error(i(407));n=n()}else{if(n=t(),null===As)throw Error(i(349));0!==(30&co)||To(r,t,n)}a.memoizedState=n;var o={value:n,getSnapshot:t};return a.queue=o,zo(Do.bind(null,r,o,e),[e]),r.flags|=2048,Oo(9,Io.bind(null,r,o,n,t),void 0,null),n},useId:function(){var e=ko(),t=As.identifierPrefix;if(Fi){var n=Ci;t=":"+t+"R"+(n=(Si&~(1<<32-ot(Si)-1)).toString(32)+n),0<(n=mo++)&&(t+="H"+n.toString(32)),t+=":"}else t=":"+t+"r"+(n=go++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},au={readContext:Ja,useCallback:qo,useContext:Ja,useEffect:Zo,useImperativeHandle:Wo,useInsertionEffect:Lo,useLayoutEffect:Po,useMemo:Go,useReducer:Co,useRef:Ro,useState:function(){return Co(So)},useDebugValue:Vo,useDeferredValue:function(e){return Ho(_o(),fo.memoizedState,e)},useTransition:function(){return[Co(So)[0],_o().memoizedState]},useMutableSource:Eo,useSyncExternalStore:No,useId:Ko,unstable_isNewReconciler:!1},iu={readContext:Ja,useCallback:qo,useContext:Ja,useEffect:Zo,useImperativeHandle:Wo,useInsertionEffect:Lo,useLayoutEffect:Po,useMemo:Go,useReducer:Ao,useRef:Ro,useState:function(){return Ao(So)},useDebugValue:Vo,useDeferredValue:function(e){var t=_o();return null===fo?t.memoizedState=e:Ho(t,fo.memoizedState,e)},useTransition:function(){return[Ao(So)[0],_o().memoizedState]},useMutableSource:Eo,useSyncExternalStore:No,useId:Ko,unstable_isNewReconciler:!1};function ou(e,t){try{var n="",r=t;do{n+=P(r),r=r.return}while(r);var a=n}catch(i){a="\nError generating stack: "+i.message+"\n"+i.stack}return{value:e,source:t,stack:a}}function uu(e,t){try{console.error(t.value)}catch(n){setTimeout((function(){throw n}))}}var su,cu,lu,fu="function"===typeof WeakMap?WeakMap:Map;function du(e,t,n){(n=ai(-1,n)).tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){Ps||(Ps=!0,Us=r),uu(0,t)},n}function hu(e,t,n){(n=ai(-1,n)).tag=3;var r=e.type.getDerivedStateFromError;if("function"===typeof r){var a=t.value;n.payload=function(){return r(a)},n.callback=function(){uu(0,t)}}var i=e.stateNode;return null!==i&&"function"===typeof i.componentDidCatch&&(n.callback=function(){uu(0,t),"function"!==typeof r&&(null===Ws?Ws=new Set([this]):Ws.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}function pu(e,t,n){var r=e.pingCache;if(null===r){r=e.pingCache=new fu;var a=new Set;r.set(t,a)}else void 0===(a=r.get(t))&&(a=new Set,r.set(t,a));a.has(n)||(a.add(n),e=Sc.bind(null,e,t,n),t.then(e,e))}function vu(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function mu(e,t,n,r,a){return 0===(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,1===n.tag&&(null===n.alternate?n.tag=17:((t=ai(-1,1)).tag=2,ii(n,t))),n.lanes|=1),e):(e.flags|=65536,e.lanes=a,e)}function gu(e,t){if(!Fi)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function yu(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,r=0;if(t)for(var a=e.child;null!==a;)n|=a.lanes|a.childLanes,r|=14680064&a.subtreeFlags,r|=14680064&a.flags,a.return=e,a=a.sibling;else for(a=e.child;null!==a;)n|=a.lanes|a.childLanes,r|=a.subtreeFlags,r|=a.flags,a.return=e,a=a.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function bu(e,t,n){var r=t.pendingProps;switch(Ti(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return yu(t),null;case 1:case 17:return Fa(t.type)&&Ma(),yu(t),null;case 3:return r=t.stateNode,eo(),Ca(Ta),Ca(Na),oo(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),null!==e&&null!==e.child||(Zi(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==Mi&&(ic(Mi),Mi=null))),yu(t),null;case 5:no(t);var a=Qi($i.current);if(n=t.type,null!==e&&null!=t.stateNode)cu(e,t,n,r),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(null===t.stateNode)throw Error(i(166));return yu(t),null}if(e=Qi(Ki.current),Zi(t)){r=t.stateNode,n=t.type;var o=t.memoizedProps;switch(r[da]=t,r[ha]=o,e=0!==(1&t.mode),n){case"dialog":Zr("cancel",r),Zr("close",r);break;case"iframe":case"object":case"embed":Zr("load",r);break;case"video":case"audio":for(a=0;a<Rr.length;a++)Zr(Rr[a],r);break;case"source":Zr("error",r);break;case"img":case"image":case"link":Zr("error",r),Zr("load",r);break;case"details":Zr("toggle",r);break;case"input":Y(r,o),Zr("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!o.multiple},Zr("invalid",r);break;case"textarea":ae(r,o),Zr("invalid",r)}for(var s in ye(n,o),a=null,o)if(o.hasOwnProperty(s)){var c=o[s];"children"===s?"string"===typeof c?r.textContent!==c&&(!0!==o.suppressHydrationWarning&&Qr(r.textContent,c,e),a=["children",c]):"number"===typeof c&&r.textContent!==""+c&&(!0!==o.suppressHydrationWarning&&Qr(r.textContent,c,e),a=["children",""+c]):u.hasOwnProperty(s)&&null!=c&&"onScroll"===s&&Zr("scroll",r)}switch(n){case"input":G(r),J(r,o,!0);break;case"textarea":G(r),oe(r);break;case"select":case"option":break;default:"function"===typeof o.onClick&&(r.onclick=Jr)}r=a,t.updateQueue=r,null!==r&&(t.flags|=4)}else{s=9===a.nodeType?a:a.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=ue(n)),"http://www.w3.org/1999/xhtml"===e?"script"===n?((e=s.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof r.is?e=s.createElement(n,{is:r.is}):(e=s.createElement(n),"select"===n&&(s=e,r.multiple?s.multiple=!0:r.size&&(s.size=r.size))):e=s.createElementNS(e,n),e[da]=t,e[ha]=r,su(e,t),t.stateNode=e;e:{switch(s=be(n,r),n){case"dialog":Zr("cancel",e),Zr("close",e),a=r;break;case"iframe":case"object":case"embed":Zr("load",e),a=r;break;case"video":case"audio":for(a=0;a<Rr.length;a++)Zr(Rr[a],e);a=r;break;case"source":Zr("error",e),a=r;break;case"img":case"image":case"link":Zr("error",e),Zr("load",e),a=r;break;case"details":Zr("toggle",e),a=r;break;case"input":Y(e,r),a=K(e,r),Zr("invalid",e);break;case"option":default:a=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},a=B({},r,{value:void 0}),Zr("invalid",e);break;case"textarea":ae(e,r),a=re(e,r),Zr("invalid",e)}for(o in ye(n,a),c=a)if(c.hasOwnProperty(o)){var l=c[o];"style"===o?me(e,l):"dangerouslySetInnerHTML"===o?null!=(l=l?l.__html:void 0)&&fe(e,l):"children"===o?"string"===typeof l?("textarea"!==n||""!==l)&&de(e,l):"number"===typeof l&&de(e,""+l):"suppressContentEditableWarning"!==o&&"suppressHydrationWarning"!==o&&"autoFocus"!==o&&(u.hasOwnProperty(o)?null!=l&&"onScroll"===o&&Zr("scroll",e):null!=l&&b(e,o,l,s))}switch(n){case"input":G(e),J(e,r,!1);break;case"textarea":G(e),oe(e);break;case"option":null!=r.value&&e.setAttribute("value",""+V(r.value));break;case"select":e.multiple=!!r.multiple,null!=(o=r.value)?ne(e,!!r.multiple,o,!1):null!=r.defaultValue&&ne(e,!!r.multiple,r.defaultValue,!0);break;default:"function"===typeof a.onClick&&(e.onclick=Jr)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return yu(t),null;case 6:if(e&&null!=t.stateNode)lu(0,t,e.memoizedProps,r);else{if("string"!==typeof r&&null===t.stateNode)throw Error(i(166));if(n=Qi($i.current),Qi(Ki.current),Zi(t)){if(r=t.stateNode,n=t.memoizedProps,r[da]=t,(o=r.nodeValue!==n)&&null!==(e=Ii))switch(e.tag){case 3:Qr(r.nodeValue,n,0!==(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&Qr(r.nodeValue,n,0!==(1&e.mode))}o&&(t.flags|=4)}else(r=(9===n.nodeType?n:n.ownerDocument).createTextNode(r))[da]=t,t.stateNode=r}return yu(t),null;case 13:if(Ca(ro),r=t.memoizedState,Fi&&null!==Di&&0!==(1&t.mode)&&0===(128&t.flags)){for(r=Di;r;)r=ca(r.nextSibling);return Li(),t.flags|=98560,t}if(null!==r&&null!==r.dehydrated){if(r=Zi(t),null===e){if(!r)throw Error(i(318));if(!(r=null!==(r=t.memoizedState)?r.dehydrated:null))throw Error(i(317));r[da]=t}else Li(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;return yu(t),null}return null!==Mi&&(ic(Mi),Mi=null),0!==(128&t.flags)?(t.lanes=n,t):(r=null!==r,n=!1,null===e?Zi(t):n=null!==e.memoizedState,r!==n&&r&&(t.child.flags|=8192,0!==(1&t.mode)&&(null===e||0!==(1&ro.current)?0===Ds&&(Ds=3):pc())),null!==t.updateQueue&&(t.flags|=4),yu(t),null);case 4:return eo(),null===e&&Ur(t.stateNode.containerInfo),yu(t),null;case 10:return Ya(t.type._context),yu(t),null;case 19:if(Ca(ro),null===(o=t.memoizedState))return yu(t),null;if(r=0!==(128&t.flags),null===(s=o.rendering))if(r)gu(o,!1);else{if(0!==Ds||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(s=ao(e))){for(t.flags|=128,gu(o,!1),null!==(r=s.updateQueue)&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;null!==n;)e=r,(o=n).flags&=14680066,null===(s=o.alternate)?(o.childLanes=0,o.lanes=e,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=s.childLanes,o.lanes=s.lanes,o.child=s.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=s.memoizedProps,o.memoizedState=s.memoizedState,o.updateQueue=s.updateQueue,o.type=s.type,e=s.dependencies,o.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Aa(ro,1&ro.current|2),t.child}e=e.sibling}null!==o.tail&&$e()>Zs&&(t.flags|=128,r=!0,gu(o,!1),t.lanes=4194304)}else{if(!r)if(null!==(e=ao(s))){if(t.flags|=128,r=!0,null!==(n=e.updateQueue)&&(t.updateQueue=n,t.flags|=4),gu(o,!0),null===o.tail&&"hidden"===o.tailMode&&!s.alternate&&!Fi)return yu(t),null}else 2*$e()-o.renderingStartTime>Zs&&1073741824!==n&&(t.flags|=128,r=!0,gu(o,!1),t.lanes=4194304);o.isBackwards?(s.sibling=t.child,t.child=s):(null!==(n=o.last)?n.sibling=s:t.child=s,o.last=s)}return null!==o.tail?(t=o.tail,o.rendering=t,o.tail=t.sibling,o.renderingStartTime=$e(),t.sibling=null,n=ro.current,Aa(ro,r?1&n|2:1&n),t):(yu(t),null);case 22:case 23:return lc(),r=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==r&&(t.flags|=8192),r&&0!==(1&t.mode)?0!==(1073741824&Ts)&&(yu(t),6&t.subtreeFlags&&(t.flags|=8192)):yu(t),null;case 24:case 25:return null}throw Error(i(156,t.tag))}su=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},cu=function(e,t,n,r){var a=e.memoizedProps;if(a!==r){e=t.stateNode,Qi(Ki.current);var i,o=null;switch(n){case"input":a=K(e,a),r=K(e,r),o=[];break;case"select":a=B({},a,{value:void 0}),r=B({},r,{value:void 0}),o=[];break;case"textarea":a=re(e,a),r=re(e,r),o=[];break;default:"function"!==typeof a.onClick&&"function"===typeof r.onClick&&(e.onclick=Jr)}for(l in ye(n,r),n=null,a)if(!r.hasOwnProperty(l)&&a.hasOwnProperty(l)&&null!=a[l])if("style"===l){var s=a[l];for(i in s)s.hasOwnProperty(i)&&(n||(n={}),n[i]="")}else"dangerouslySetInnerHTML"!==l&&"children"!==l&&"suppressContentEditableWarning"!==l&&"suppressHydrationWarning"!==l&&"autoFocus"!==l&&(u.hasOwnProperty(l)?o||(o=[]):(o=o||[]).push(l,null));for(l in r){var c=r[l];if(s=null!=a?a[l]:void 0,r.hasOwnProperty(l)&&c!==s&&(null!=c||null!=s))if("style"===l)if(s){for(i in s)!s.hasOwnProperty(i)||c&&c.hasOwnProperty(i)||(n||(n={}),n[i]="");for(i in c)c.hasOwnProperty(i)&&s[i]!==c[i]&&(n||(n={}),n[i]=c[i])}else n||(o||(o=[]),o.push(l,n)),n=c;else"dangerouslySetInnerHTML"===l?(c=c?c.__html:void 0,s=s?s.__html:void 0,null!=c&&s!==c&&(o=o||[]).push(l,c)):"children"===l?"string"!==typeof c&&"number"!==typeof c||(o=o||[]).push(l,""+c):"suppressContentEditableWarning"!==l&&"suppressHydrationWarning"!==l&&(u.hasOwnProperty(l)?(null!=c&&"onScroll"===l&&Zr("scroll",e),o||s===c||(o=[])):(o=o||[]).push(l,c))}n&&(o=o||[]).push("style",n);var l=o;(t.updateQueue=l)&&(t.flags|=4)}},lu=function(e,t,n,r){n!==r&&(t.flags|=4)};var xu=x.ReactCurrentOwner,wu=!1;function ku(e,t,n,r){t.child=null===e?Hi(t,null,n,r):Gi(t,e.child,n,r)}function _u(e,t,n,r,a){n=n.render;var i=t.ref;return Qa(t,a),r=xo(e,t,n,r,i,a),n=wo(),null===e||wu?(Fi&&n&&Ni(t),t.flags|=1,ku(e,t,r,a),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,Vu(e,t,a))}function Su(e,t,n,r,a){if(null===e){var i=n.type;return"function"!==typeof i||Dc(i)||void 0!==i.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=Mc(n.type,null,r,t,t.mode,a)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=i,Cu(e,t,i,r,a))}if(i=e.child,0===(e.lanes&a)){var o=i.memoizedProps;if((n=null!==(n=n.compare)?n:sr)(o,r)&&e.ref===t.ref)return Vu(e,t,a)}return t.flags|=1,(e=Fc(i,r)).ref=t.ref,e.return=t,t.child=e}function Cu(e,t,n,r,a){if(null!==e){var i=e.memoizedProps;if(sr(i,r)&&e.ref===t.ref){if(wu=!1,t.pendingProps=r=i,0===(e.lanes&a))return t.lanes=e.lanes,Vu(e,t,a);0!==(131072&e.flags)&&(wu=!0)}}return Nu(e,t,n,r,a)}function Au(e,t,n){var r=t.pendingProps,a=r.children,i=null!==e?e.memoizedState:null;if("hidden"===r.mode)if(0===(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Aa(Is,Ts),Ts|=n;else{if(0===(1073741824&n))return e=null!==i?i.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Aa(Is,Ts),Ts|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=null!==i?i.baseLanes:n,Aa(Is,Ts),Ts|=r}else null!==i?(r=i.baseLanes|n,t.memoizedState=null):r=n,Aa(Is,Ts),Ts|=r;return ku(e,t,a,n),t.child}function Eu(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function Nu(e,t,n,r,a){var i=Fa(n)?Ia:Na.current;return i=Da(t,i),Qa(t,a),n=xo(e,t,n,r,i,a),r=wo(),null===e||wu?(Fi&&r&&Ni(t),t.flags|=1,ku(e,t,n,a),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,Vu(e,t,a))}function Tu(e,t,n,r,a){if(Fa(n)){var i=!0;ja(t)}else i=!1;if(Qa(t,a),null===t.stateNode)null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),pi(t,n,r),mi(t,n,r,a),r=!0;else if(null===e){var o=t.stateNode,u=t.memoizedProps;o.props=u;var s=o.context,c=n.contextType;"object"===typeof c&&null!==c?c=Ja(c):c=Da(t,c=Fa(n)?Ia:Na.current);var l=n.getDerivedStateFromProps,f="function"===typeof l||"function"===typeof o.getSnapshotBeforeUpdate;f||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(u!==r||s!==c)&&vi(t,o,r,c),ti=!1;var d=t.memoizedState;o.state=d,si(t,r,o,a),s=t.memoizedState,u!==r||d!==s||Ta.current||ti?("function"===typeof l&&(fi(t,n,l,r),s=t.memoizedState),(u=ti||hi(t,n,u,r,d,s,c))?(f||"function"!==typeof o.UNSAFE_componentWillMount&&"function"!==typeof o.componentWillMount||("function"===typeof o.componentWillMount&&o.componentWillMount(),"function"===typeof o.UNSAFE_componentWillMount&&o.UNSAFE_componentWillMount()),"function"===typeof o.componentDidMount&&(t.flags|=4194308)):("function"===typeof o.componentDidMount&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=s),o.props=r,o.state=s,o.context=c,r=u):("function"===typeof o.componentDidMount&&(t.flags|=4194308),r=!1)}else{o=t.stateNode,ri(e,t),u=t.memoizedProps,c=t.type===t.elementType?u:Va(t.type,u),o.props=c,f=t.pendingProps,d=o.context,"object"===typeof(s=n.contextType)&&null!==s?s=Ja(s):s=Da(t,s=Fa(n)?Ia:Na.current);var h=n.getDerivedStateFromProps;(l="function"===typeof h||"function"===typeof o.getSnapshotBeforeUpdate)||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(u!==f||d!==s)&&vi(t,o,r,s),ti=!1,d=t.memoizedState,o.state=d,si(t,r,o,a);var p=t.memoizedState;u!==f||d!==p||Ta.current||ti?("function"===typeof h&&(fi(t,n,h,r),p=t.memoizedState),(c=ti||hi(t,n,c,r,d,p,s)||!1)?(l||"function"!==typeof o.UNSAFE_componentWillUpdate&&"function"!==typeof o.componentWillUpdate||("function"===typeof o.componentWillUpdate&&o.componentWillUpdate(r,p,s),"function"===typeof o.UNSAFE_componentWillUpdate&&o.UNSAFE_componentWillUpdate(r,p,s)),"function"===typeof o.componentDidUpdate&&(t.flags|=4),"function"===typeof o.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof o.componentDidUpdate||u===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||u===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=p),o.props=r,o.state=p,o.context=s,r=c):("function"!==typeof o.componentDidUpdate||u===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||u===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),r=!1)}return Iu(e,t,n,r,i,a)}function Iu(e,t,n,r,a,i){Eu(e,t);var o=0!==(128&t.flags);if(!r&&!o)return a&&Ba(t,n,!1),Vu(e,t,i);r=t.stateNode,xu.current=t;var u=o&&"function"!==typeof n.getDerivedStateFromError?null:r.render();return t.flags|=1,null!==e&&o?(t.child=Gi(t,e.child,null,i),t.child=Gi(t,null,u,i)):ku(e,t,u,i),t.memoizedState=r.state,a&&Ba(t,n,!0),t.child}function Du(e){var t=e.stateNode;t.pendingContext?Oa(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Oa(0,t.context,!1),Ji(e,t.containerInfo)}function Fu(e,t,n,r,a){return Li(),Pi(a),t.flags|=256,ku(e,t,n,r),t.child}var Mu={dehydrated:null,treeContext:null,retryLane:0};function Ou(e){return{baseLanes:e,cachePool:null,transitions:null}}function Ru(e,t){return{baseLanes:e.baseLanes|t,cachePool:null,transitions:e.transitions}}function ju(e,t,n){var r,a=t.pendingProps,o=ro.current,u=!1,s=0!==(128&t.flags);if((r=s)||(r=(null===e||null!==e.memoizedState)&&0!==(2&o)),r?(u=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(o|=1),Aa(ro,1&o),null===e)return Bi(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0===(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(o=a.children,e=a.fallback,u?(a=t.mode,u=t.child,o={mode:"hidden",children:o},0===(1&a)&&null!==u?(u.childLanes=0,u.pendingProps=o):u=Rc(o,a,0,null),e=Oc(e,a,n,null),u.return=t,e.return=t,u.sibling=e,t.child=u,t.child.memoizedState=Ou(n),t.memoizedState=Mu,e):Bu(t,o));if(null!==(o=e.memoizedState)){if(null!==(r=o.dehydrated)){if(s)return 256&t.flags?(t.flags&=-257,Lu(e,t,n,Error(i(422)))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(u=a.fallback,o=t.mode,a=Rc({mode:"visible",children:a.children},o,0,null),(u=Oc(u,o,n,null)).flags|=2,a.return=t,u.return=t,a.sibling=u,t.child=a,0!==(1&t.mode)&&Gi(t,e.child,null,n),t.child.memoizedState=Ou(n),t.memoizedState=Mu,u);if(0===(1&t.mode))t=Lu(e,t,n,null);else if("$!"===r.data)t=Lu(e,t,n,Error(i(419)));else if(a=0!==(n&e.childLanes),wu||a){if(null!==(a=As)){switch(n&-n){case 4:u=2;break;case 16:u=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:u=32;break;case 536870912:u=268435456;break;default:u=0}0!==(a=0!==(u&(a.suspendedLanes|n))?0:u)&&a!==o.retryLane&&(o.retryLane=a,Js(e,a,-1))}pc(),t=Lu(e,t,n,Error(i(421)))}else"$?"===r.data?(t.flags|=128,t.child=e.child,t=Ac.bind(null,e),r._reactRetry=t,t=null):(n=o.treeContext,Di=ca(r.nextSibling),Ii=t,Fi=!0,Mi=null,null!==n&&(wi[ki++]=Si,wi[ki++]=Ci,wi[ki++]=_i,Si=n.id,Ci=n.overflow,_i=t),(t=Bu(t,t.pendingProps.children)).flags|=4096);return t}return u?(a=Zu(e,t,a.children,a.fallback,n),u=t.child,o=e.child.memoizedState,u.memoizedState=null===o?Ou(n):Ru(o,n),u.childLanes=e.childLanes&~n,t.memoizedState=Mu,a):(n=zu(e,t,a.children,n),t.memoizedState=null,n)}return u?(a=Zu(e,t,a.children,a.fallback,n),u=t.child,o=e.child.memoizedState,u.memoizedState=null===o?Ou(n):Ru(o,n),u.childLanes=e.childLanes&~n,t.memoizedState=Mu,a):(n=zu(e,t,a.children,n),t.memoizedState=null,n)}function Bu(e,t){return(t=Rc({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function zu(e,t,n,r){var a=e.child;return e=a.sibling,n=Fc(a,{mode:"visible",children:n}),0===(1&t.mode)&&(n.lanes=r),n.return=t,n.sibling=null,null!==e&&(null===(r=t.deletions)?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n}function Zu(e,t,n,r,a){var i=t.mode,o=(e=e.child).sibling,u={mode:"hidden",children:n};return 0===(1&i)&&t.child!==e?((n=t.child).childLanes=0,n.pendingProps=u,t.deletions=null):(n=Fc(e,u)).subtreeFlags=14680064&e.subtreeFlags,null!==o?r=Fc(o,r):(r=Oc(r,i,a,null)).flags|=2,r.return=t,n.return=t,n.sibling=r,t.child=n,r}function Lu(e,t,n,r){return null!==r&&Pi(r),Gi(t,e.child,null,n),(e=Bu(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function Pu(e,t,n){e.lanes|=t;var r=e.alternate;null!==r&&(r.lanes|=t),$a(e.return,t,n)}function Uu(e,t,n,r,a){var i=e.memoizedState;null===i?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:a}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=a)}function Wu(e,t,n){var r=t.pendingProps,a=r.revealOrder,i=r.tail;if(ku(e,t,r.children,n),0!==(2&(r=ro.current)))r=1&r|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&Pu(e,n,t);else if(19===e.tag)Pu(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(Aa(ro,r),0===(1&t.mode))t.memoizedState=null;else switch(a){case"forwards":for(n=t.child,a=null;null!==n;)null!==(e=n.alternate)&&null===ao(e)&&(a=n),n=n.sibling;null===(n=a)?(a=t.child,t.child=null):(a=n.sibling,n.sibling=null),Uu(t,!1,a,n,i);break;case"backwards":for(n=null,a=t.child,t.child=null;null!==a;){if(null!==(e=a.alternate)&&null===ao(e)){t.child=a;break}e=a.sibling,a.sibling=n,n=a,a=e}Uu(t,!0,n,null,i);break;case"together":Uu(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Vu(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),Ms|=t.lanes,0===(n&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(i(153));if(null!==t.child){for(n=Fc(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Fc(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function qu(e,t){switch(Ti(t),t.tag){case 1:return Fa(t.type)&&Ma(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return eo(),Ca(Ta),Ca(Na),oo(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 5:return no(t),null;case 13:if(Ca(ro),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(i(340));Li()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return Ca(ro),null;case 4:return eo(),null;case 10:return Ya(t.type._context),null;case 22:case 23:return lc(),null;default:return null}}var Gu=!1,Hu=!1,Xu="function"===typeof WeakSet?WeakSet:Set,Ku=null;function Yu(e,t){var n=e.ref;if(null!==n)if("function"===typeof n)try{n(null)}catch(r){_c(e,t,r)}else n.current=null}function $u(e,t,n){try{n()}catch(r){_c(e,t,r)}}var Qu=!1;function Ju(e,t,n){var r=t.updateQueue;if(null!==(r=null!==r?r.lastEffect:null)){var a=r=r.next;do{if((a.tag&e)===e){var i=a.destroy;a.destroy=void 0,void 0!==i&&$u(t,n,i)}a=a.next}while(a!==r)}}function es(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function ts(e){var t=e.ref;if(null!==t){var n=e.stateNode;e.tag,e=n,"function"===typeof t?t(e):t.current=e}}function ns(e){var t=e.alternate;null!==t&&(e.alternate=null,ns(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[da],delete t[ha],delete t[va],delete t[ma],delete t[ga])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function rs(e){return 5===e.tag||3===e.tag||4===e.tag}function as(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||rs(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function is(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!==(n=n._reactRootContainer)&&void 0!==n||null!==t.onclick||(t.onclick=Jr));else if(4!==r&&null!==(e=e.child))for(is(e,t,n),e=e.sibling;null!==e;)is(e,t,n),e=e.sibling}function os(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==r&&null!==(e=e.child))for(os(e,t,n),e=e.sibling;null!==e;)os(e,t,n),e=e.sibling}var us=null,ss=!1;function cs(e,t,n){for(n=n.child;null!==n;)ls(e,t,n),n=n.sibling}function ls(e,t,n){if(it&&"function"===typeof it.onCommitFiberUnmount)try{it.onCommitFiberUnmount(at,n)}catch(u){}switch(n.tag){case 5:Hu||Yu(n,t);case 6:var r=us,a=ss;us=null,cs(e,t,n),ss=a,null!==(us=r)&&(ss?(e=us,n=n.stateNode,8===e.nodeType?e.parentNode.removeChild(n):e.removeChild(n)):us.removeChild(n.stateNode));break;case 18:null!==us&&(ss?(e=us,n=n.stateNode,8===e.nodeType?sa(e.parentNode,n):1===e.nodeType&&sa(e,n),Ut(e)):sa(us,n.stateNode));break;case 4:r=us,a=ss,us=n.stateNode.containerInfo,ss=!0,cs(e,t,n),us=r,ss=a;break;case 0:case 11:case 14:case 15:if(!Hu&&(null!==(r=n.updateQueue)&&null!==(r=r.lastEffect))){a=r=r.next;do{var i=a,o=i.destroy;i=i.tag,void 0!==o&&(0!==(2&i)||0!==(4&i))&&$u(n,t,o),a=a.next}while(a!==r)}cs(e,t,n);break;case 1:if(!Hu&&(Yu(n,t),"function"===typeof(r=n.stateNode).componentWillUnmount))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(u){_c(n,t,u)}cs(e,t,n);break;case 21:cs(e,t,n);break;case 22:1&n.mode?(Hu=(r=Hu)||null!==n.memoizedState,cs(e,t,n),Hu=r):cs(e,t,n);break;default:cs(e,t,n)}}function fs(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new Xu),t.forEach((function(t){var r=Ec.bind(null,e,t);n.has(t)||(n.add(t),t.then(r,r))}))}}function ds(e,t){var n=t.deletions;if(null!==n)for(var r=0;r<n.length;r++){var a=n[r];try{var o=e,u=t,s=u;e:for(;null!==s;){switch(s.tag){case 5:us=s.stateNode,ss=!1;break e;case 3:case 4:us=s.stateNode.containerInfo,ss=!0;break e}s=s.return}if(null===us)throw Error(i(160));ls(o,u,a),us=null,ss=!1;var c=a.alternate;null!==c&&(c.return=null),a.return=null}catch(l){_c(a,t,l)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)hs(t,e),t=t.sibling}function hs(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(ds(t,e),ps(e),4&r){try{Ju(3,e,e.return),es(3,e)}catch(v){_c(e,e.return,v)}try{Ju(5,e,e.return)}catch(v){_c(e,e.return,v)}}break;case 1:ds(t,e),ps(e),512&r&&null!==n&&Yu(n,n.return);break;case 5:if(ds(t,e),ps(e),512&r&&null!==n&&Yu(n,n.return),32&e.flags){var a=e.stateNode;try{de(a,"")}catch(v){_c(e,e.return,v)}}if(4&r&&null!=(a=e.stateNode)){var o=e.memoizedProps,u=null!==n?n.memoizedProps:o,s=e.type,c=e.updateQueue;if(e.updateQueue=null,null!==c)try{"input"===s&&"radio"===o.type&&null!=o.name&&$(a,o),be(s,u);var l=be(s,o);for(u=0;u<c.length;u+=2){var f=c[u],d=c[u+1];"style"===f?me(a,d):"dangerouslySetInnerHTML"===f?fe(a,d):"children"===f?de(a,d):b(a,f,d,l)}switch(s){case"input":Q(a,o);break;case"textarea":ie(a,o);break;case"select":var h=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!o.multiple;var p=o.value;null!=p?ne(a,!!o.multiple,p,!1):h!==!!o.multiple&&(null!=o.defaultValue?ne(a,!!o.multiple,o.defaultValue,!0):ne(a,!!o.multiple,o.multiple?[]:"",!1))}a[ha]=o}catch(v){_c(e,e.return,v)}}break;case 6:if(ds(t,e),ps(e),4&r){if(null===e.stateNode)throw Error(i(162));l=e.stateNode,f=e.memoizedProps;try{l.nodeValue=f}catch(v){_c(e,e.return,v)}}break;case 3:if(ds(t,e),ps(e),4&r&&null!==n&&n.memoizedState.isDehydrated)try{Ut(t.containerInfo)}catch(v){_c(e,e.return,v)}break;case 4:default:ds(t,e),ps(e);break;case 13:ds(t,e),ps(e),8192&(l=e.child).flags&&null!==l.memoizedState&&(null===l.alternate||null===l.alternate.memoizedState)&&(zs=$e()),4&r&&fs(e);break;case 22:if(l=null!==n&&null!==n.memoizedState,1&e.mode?(Hu=(f=Hu)||l,ds(t,e),Hu=f):ds(t,e),ps(e),8192&r){f=null!==e.memoizedState;e:for(d=null,h=e;;){if(5===h.tag){if(null===d){d=h;try{a=h.stateNode,f?"function"===typeof(o=a.style).setProperty?o.setProperty("display","none","important"):o.display="none":(s=h.stateNode,u=void 0!==(c=h.memoizedProps.style)&&null!==c&&c.hasOwnProperty("display")?c.display:null,s.style.display=ve("display",u))}catch(v){_c(e,e.return,v)}}}else if(6===h.tag){if(null===d)try{h.stateNode.nodeValue=f?"":h.memoizedProps}catch(v){_c(e,e.return,v)}}else if((22!==h.tag&&23!==h.tag||null===h.memoizedState||h===e)&&null!==h.child){h.child.return=h,h=h.child;continue}if(h===e)break e;for(;null===h.sibling;){if(null===h.return||h.return===e)break e;d===h&&(d=null),h=h.return}d===h&&(d=null),h.sibling.return=h.return,h=h.sibling}if(f&&!l&&0!==(1&e.mode))for(Ku=e,e=e.child;null!==e;){for(l=Ku=e;null!==Ku;){switch(d=(f=Ku).child,f.tag){case 0:case 11:case 14:case 15:Ju(4,f,f.return);break;case 1:if(Yu(f,f.return),"function"===typeof(o=f.stateNode).componentWillUnmount){h=f,p=f.return;try{a=h,o.props=a.memoizedProps,o.state=a.memoizedState,o.componentWillUnmount()}catch(v){_c(h,p,v)}}break;case 5:Yu(f,f.return);break;case 22:if(null!==f.memoizedState){ys(l);continue}}null!==d?(d.return=f,Ku=d):ys(l)}e=e.sibling}}break;case 19:ds(t,e),ps(e),4&r&&fs(e);case 21:}}function ps(e){var t=e.flags;if(2&t){try{e:{for(var n=e.return;null!==n;){if(rs(n)){var r=n;break e}n=n.return}throw Error(i(160))}switch(r.tag){case 5:var a=r.stateNode;32&r.flags&&(de(a,""),r.flags&=-33),os(e,as(e),a);break;case 3:case 4:var o=r.stateNode.containerInfo;is(e,as(e),o);break;default:throw Error(i(161))}}catch(u){_c(e,e.return,u)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function vs(e,t,n){Ku=e,ms(e,t,n)}function ms(e,t,n){for(var r=0!==(1&e.mode);null!==Ku;){var a=Ku,i=a.child;if(22===a.tag&&r){var o=null!==a.memoizedState||Gu;if(!o){var u=a.alternate,s=null!==u&&null!==u.memoizedState||Hu;u=Gu;var c=Hu;if(Gu=o,(Hu=s)&&!c)for(Ku=a;null!==Ku;)s=(o=Ku).child,22===o.tag&&null!==o.memoizedState?bs(a):null!==s?(s.return=o,Ku=s):bs(a);for(;null!==i;)Ku=i,ms(i,t,n),i=i.sibling;Ku=a,Gu=u,Hu=c}gs(e)}else 0!==(8772&a.subtreeFlags)&&null!==i?(i.return=a,Ku=i):gs(e)}}function gs(e){for(;null!==Ku;){var t=Ku;if(0!==(8772&t.flags)){var n=t.alternate;try{if(0!==(8772&t.flags))switch(t.tag){case 0:case 11:case 15:Hu||es(5,t);break;case 1:var r=t.stateNode;if(4&t.flags&&!Hu)if(null===n)r.componentDidMount();else{var a=t.elementType===t.type?n.memoizedProps:Va(t.type,n.memoizedProps);r.componentDidUpdate(a,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var o=t.updateQueue;null!==o&&ci(t,o,r);break;case 3:var u=t.updateQueue;if(null!==u){if(n=null,null!==t.child)switch(t.child.tag){case 5:case 1:n=t.child.stateNode}ci(t,u,n)}break;case 5:var s=t.stateNode;if(null===n&&4&t.flags){n=s;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:break;case 13:if(null===t.memoizedState){var l=t.alternate;if(null!==l){var f=l.memoizedState;if(null!==f){var d=f.dehydrated;null!==d&&Ut(d)}}}break;default:throw Error(i(163))}Hu||512&t.flags&&ts(t)}catch(h){_c(t,t.return,h)}}if(t===e){Ku=null;break}if(null!==(n=t.sibling)){n.return=t.return,Ku=n;break}Ku=t.return}}function ys(e){for(;null!==Ku;){var t=Ku;if(t===e){Ku=null;break}var n=t.sibling;if(null!==n){n.return=t.return,Ku=n;break}Ku=t.return}}function bs(e){for(;null!==Ku;){var t=Ku;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{es(4,t)}catch(s){_c(t,n,s)}break;case 1:var r=t.stateNode;if("function"===typeof r.componentDidMount){var a=t.return;try{r.componentDidMount()}catch(s){_c(t,a,s)}}var i=t.return;try{ts(t)}catch(s){_c(t,i,s)}break;case 5:var o=t.return;try{ts(t)}catch(s){_c(t,o,s)}}}catch(s){_c(t,t.return,s)}if(t===e){Ku=null;break}var u=t.sibling;if(null!==u){u.return=t.return,Ku=u;break}Ku=t.return}}var xs,ws=Math.ceil,ks=x.ReactCurrentDispatcher,_s=x.ReactCurrentOwner,Ss=x.ReactCurrentBatchConfig,Cs=0,As=null,Es=null,Ns=0,Ts=0,Is=Sa(0),Ds=0,Fs=null,Ms=0,Os=0,Rs=0,js=null,Bs=null,zs=0,Zs=1/0,Ls=null,Ps=!1,Us=null,Ws=null,Vs=!1,qs=null,Gs=0,Hs=0,Xs=null,Ks=-1,Ys=0;function $s(){return 0!==(6&Cs)?$e():-1!==Ks?Ks:Ks=$e()}function Qs(e){return 0===(1&e.mode)?1:0!==(2&Cs)&&0!==Ns?Ns&-Ns:null!==Wa.transition?(0===Ys&&(Ys=vt()),Ys):0!==(e=bt)?e:e=void 0===(e=window.event)?16:Yt(e.type)}function Js(e,t,n){if(50<Hs)throw Hs=0,Xs=null,Error(i(185));var r=ec(e,t);return null===r?null:(gt(r,t,n),0!==(2&Cs)&&r===As||(r===As&&(0===(2&Cs)&&(Os|=t),4===Ds&&oc(r,Ns)),nc(r,n),1===t&&0===Cs&&0===(1&e.mode)&&(Zs=$e()+500,Za&&Ua())),r)}function ec(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}function tc(e){return(null!==As||null!==ei)&&0!==(1&e.mode)&&0===(2&Cs)}function nc(e,t){var n=e.callbackNode;!function(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,a=e.expirationTimes,i=e.pendingLanes;0<i;){var o=31-ot(i),u=1<<o,s=a[o];-1===s?0!==(u&n)&&0===(u&r)||(a[o]=ht(u,t)):s<=t&&(e.expiredLanes|=u),i&=~u}}(e,t);var r=dt(e,e===As?Ns:0);if(0===r)null!==n&&Xe(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(null!=n&&Xe(n),1===t)0===e.tag?function(e){Za=!0,Pa(e)}(uc.bind(null,e)):Pa(uc.bind(null,e)),oa((function(){0===Cs&&Ua()})),n=null;else{switch(xt(r)){case 1:n=Je;break;case 4:n=et;break;case 16:default:n=tt;break;case 536870912:n=rt}n=Nc(n,rc.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function rc(e,t){if(Ks=-1,Ys=0,0!==(6&Cs))throw Error(i(327));var n=e.callbackNode;if(wc()&&e.callbackNode!==n)return null;var r=dt(e,e===As?Ns:0);if(0===r)return null;if(0!==(30&r)||0!==(r&e.expiredLanes)||t)t=vc(e,r);else{t=r;var a=Cs;Cs|=2;var o=hc();for(As===e&&Ns===t||(Ls=null,Zs=$e()+500,fc(e,t));;)try{gc();break}catch(s){dc(e,s)}Ka(),ks.current=o,Cs=a,null!==Es?t=0:(As=null,Ns=0,t=Ds)}if(0!==t){if(2===t&&(0!==(a=pt(e))&&(r=a,t=ac(e,a))),1===t)throw n=Fs,fc(e,0),oc(e,r),nc(e,$e()),n;if(6===t)oc(e,r);else{if(a=e.current.alternate,0===(30&r)&&!function(e){for(var t=e;;){if(16384&t.flags){var n=t.updateQueue;if(null!==n&&null!==(n=n.stores))for(var r=0;r<n.length;r++){var a=n[r],i=a.getSnapshot;a=a.value;try{if(!ur(i(),a))return!1}catch(u){return!1}}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(a)&&(2===(t=vc(e,r))&&(0!==(o=pt(e))&&(r=o,t=ac(e,o))),1===t))throw n=Fs,fc(e,0),oc(e,r),nc(e,$e()),n;switch(e.finishedWork=a,e.finishedLanes=r,t){case 0:case 1:throw Error(i(345));case 2:case 5:xc(e,Bs,Ls);break;case 3:if(oc(e,r),(130023424&r)===r&&10<(t=zs+500-$e())){if(0!==dt(e,0))break;if(((a=e.suspendedLanes)&r)!==r){$s(),e.pingedLanes|=e.suspendedLanes&a;break}e.timeoutHandle=ra(xc.bind(null,e,Bs,Ls),t);break}xc(e,Bs,Ls);break;case 4:if(oc(e,r),(4194240&r)===r)break;for(t=e.eventTimes,a=-1;0<r;){var u=31-ot(r);o=1<<u,(u=t[u])>a&&(a=u),r&=~o}if(r=a,10<(r=(120>(r=$e()-r)?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*ws(r/1960))-r)){e.timeoutHandle=ra(xc.bind(null,e,Bs,Ls),r);break}xc(e,Bs,Ls);break;default:throw Error(i(329))}}}return nc(e,$e()),e.callbackNode===n?rc.bind(null,e):null}function ac(e,t){var n=js;return e.current.memoizedState.isDehydrated&&(fc(e,t).flags|=256),2!==(e=vc(e,t))&&(t=Bs,Bs=n,null!==t&&ic(t)),e}function ic(e){null===Bs?Bs=e:Bs.push.apply(Bs,e)}function oc(e,t){for(t&=~Rs,t&=~Os,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-ot(t),r=1<<n;e[n]=-1,t&=~r}}function uc(e){if(0!==(6&Cs))throw Error(i(327));wc();var t=dt(e,0);if(0===(1&t))return nc(e,$e()),null;var n=vc(e,t);if(0!==e.tag&&2===n){var r=pt(e);0!==r&&(t=r,n=ac(e,r))}if(1===n)throw n=Fs,fc(e,0),oc(e,t),nc(e,$e()),n;if(6===n)throw Error(i(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,xc(e,Bs,Ls),nc(e,$e()),null}function sc(e,t){var n=Cs;Cs|=1;try{return e(t)}finally{0===(Cs=n)&&(Zs=$e()+500,Za&&Ua())}}function cc(e){null!==qs&&0===qs.tag&&0===(6&Cs)&&wc();var t=Cs;Cs|=1;var n=Ss.transition,r=bt;try{if(Ss.transition=null,bt=1,e)return e()}finally{bt=r,Ss.transition=n,0===(6&(Cs=t))&&Ua()}}function lc(){Ts=Is.current,Ca(Is)}function fc(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,aa(n)),null!==Es)for(n=Es.return;null!==n;){var r=n;switch(Ti(r),r.tag){case 1:null!==(r=r.type.childContextTypes)&&void 0!==r&&Ma();break;case 3:eo(),Ca(Ta),Ca(Na),oo();break;case 5:no(r);break;case 4:eo();break;case 13:case 19:Ca(ro);break;case 10:Ya(r.type._context);break;case 22:case 23:lc()}n=n.return}if(As=e,Es=e=Fc(e.current,null),Ns=Ts=t,Ds=0,Fs=null,Rs=Os=Ms=0,Bs=js=null,null!==ei){for(t=0;t<ei.length;t++)if(null!==(r=(n=ei[t]).interleaved)){n.interleaved=null;var a=r.next,i=n.pending;if(null!==i){var o=i.next;i.next=a,r.next=o}n.pending=r}ei=null}return e}function dc(e,t){for(;;){var n=Es;try{if(Ka(),uo.current=nu,po){for(var r=lo.memoizedState;null!==r;){var a=r.queue;null!==a&&(a.pending=null),r=r.next}po=!1}if(co=0,ho=fo=lo=null,vo=!1,mo=0,_s.current=null,null===n||null===n.return){Ds=1,Fs=t,Es=null;break}e:{var o=e,u=n.return,s=n,c=t;if(t=Ns,s.flags|=32768,null!==c&&"object"===typeof c&&"function"===typeof c.then){var l=c,f=s,d=f.tag;if(0===(1&f.mode)&&(0===d||11===d||15===d)){var h=f.alternate;h?(f.updateQueue=h.updateQueue,f.memoizedState=h.memoizedState,f.lanes=h.lanes):(f.updateQueue=null,f.memoizedState=null)}var p=vu(u);if(null!==p){p.flags&=-257,mu(p,u,s,0,t),1&p.mode&&pu(o,l,t),c=l;var v=(t=p).updateQueue;if(null===v){var m=new Set;m.add(c),t.updateQueue=m}else v.add(c);break e}if(0===(1&t)){pu(o,l,t),pc();break e}c=Error(i(426))}else if(Fi&&1&s.mode){var g=vu(u);if(null!==g){0===(65536&g.flags)&&(g.flags|=256),mu(g,u,s,0,t),Pi(c);break e}}o=c,4!==Ds&&(Ds=2),null===js?js=[o]:js.push(o),c=ou(c,s),s=u;do{switch(s.tag){case 3:s.flags|=65536,t&=-t,s.lanes|=t,ui(s,du(0,c,t));break e;case 1:o=c;var y=s.type,b=s.stateNode;if(0===(128&s.flags)&&("function"===typeof y.getDerivedStateFromError||null!==b&&"function"===typeof b.componentDidCatch&&(null===Ws||!Ws.has(b)))){s.flags|=65536,t&=-t,s.lanes|=t,ui(s,hu(s,o,t));break e}}s=s.return}while(null!==s)}bc(n)}catch(x){t=x,Es===n&&null!==n&&(Es=n=n.return);continue}break}}function hc(){var e=ks.current;return ks.current=nu,null===e?nu:e}function pc(){0!==Ds&&3!==Ds&&2!==Ds||(Ds=4),null===As||0===(268435455&Ms)&&0===(268435455&Os)||oc(As,Ns)}function vc(e,t){var n=Cs;Cs|=2;var r=hc();for(As===e&&Ns===t||(Ls=null,fc(e,t));;)try{mc();break}catch(a){dc(e,a)}if(Ka(),Cs=n,ks.current=r,null!==Es)throw Error(i(261));return As=null,Ns=0,Ds}function mc(){for(;null!==Es;)yc(Es)}function gc(){for(;null!==Es&&!Ke();)yc(Es)}function yc(e){var t=xs(e.alternate,e,Ts);e.memoizedProps=e.pendingProps,null===t?bc(e):Es=t,_s.current=null}function bc(e){var t=e;do{var n=t.alternate;if(e=t.return,0===(32768&t.flags)){if(null!==(n=bu(n,t,Ts)))return void(Es=n)}else{if(null!==(n=qu(n,t)))return n.flags&=32767,void(Es=n);if(null===e)return Ds=6,void(Es=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(Es=t);Es=t=e}while(null!==t);0===Ds&&(Ds=5)}function xc(e,t,n){var r=bt,a=Ss.transition;try{Ss.transition=null,bt=1,function(e,t,n,r){do{wc()}while(null!==qs);if(0!==(6&Cs))throw Error(i(327));n=e.finishedWork;var a=e.finishedLanes;if(null===n)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(i(177));e.callbackNode=null,e.callbackPriority=0;var o=n.lanes|n.childLanes;if(function(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var a=31-ot(n),i=1<<a;t[a]=0,r[a]=-1,e[a]=-1,n&=~i}}(e,o),e===As&&(Es=As=null,Ns=0),0===(2064&n.subtreeFlags)&&0===(2064&n.flags)||Vs||(Vs=!0,Nc(tt,(function(){return wc(),null}))),o=0!==(15990&n.flags),0!==(15990&n.subtreeFlags)||o){o=Ss.transition,Ss.transition=null;var u=bt;bt=1;var s=Cs;Cs|=4,_s.current=null,function(e,t){if(ea=Vt,hr(e=dr())){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var r=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(r&&0!==r.rangeCount){n=r.anchorNode;var a=r.anchorOffset,o=r.focusNode;r=r.focusOffset;try{n.nodeType,o.nodeType}catch(k){n=null;break e}var u=0,s=-1,c=-1,l=0,f=0,d=e,h=null;t:for(;;){for(var p;d!==n||0!==a&&3!==d.nodeType||(s=u+a),d!==o||0!==r&&3!==d.nodeType||(c=u+r),3===d.nodeType&&(u+=d.nodeValue.length),null!==(p=d.firstChild);)h=d,d=p;for(;;){if(d===e)break t;if(h===n&&++l===a&&(s=u),h===o&&++f===r&&(c=u),null!==(p=d.nextSibling))break;h=(d=h).parentNode}d=p}n=-1===s||-1===c?null:{start:s,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(ta={focusedElem:e,selectionRange:n},Vt=!1,Ku=t;null!==Ku;)if(e=(t=Ku).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,Ku=e;else for(;null!==Ku;){t=Ku;try{var v=t.alternate;if(0!==(1024&t.flags))switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==v){var m=v.memoizedProps,g=v.memoizedState,y=t.stateNode,b=y.getSnapshotBeforeUpdate(t.elementType===t.type?m:Va(t.type,m),g);y.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var x=t.stateNode.containerInfo;if(1===x.nodeType)x.textContent="";else if(9===x.nodeType){var w=x.body;null!=w&&(w.textContent="")}break;default:throw Error(i(163))}}catch(k){_c(t,t.return,k)}if(null!==(e=t.sibling)){e.return=t.return,Ku=e;break}Ku=t.return}v=Qu,Qu=!1}(e,n),hs(n,e),pr(ta),Vt=!!ea,ta=ea=null,e.current=n,vs(n,e,a),Ye(),Cs=s,bt=u,Ss.transition=o}else e.current=n;if(Vs&&(Vs=!1,qs=e,Gs=a),0===(o=e.pendingLanes)&&(Ws=null),function(e){if(it&&"function"===typeof it.onCommitFiberRoot)try{it.onCommitFiberRoot(at,e,void 0,128===(128&e.current.flags))}catch(t){}}(n.stateNode),nc(e,$e()),null!==t)for(r=e.onRecoverableError,n=0;n<t.length;n++)r(t[n]);if(Ps)throw Ps=!1,e=Us,Us=null,e;0!==(1&Gs)&&0!==e.tag&&wc(),0!==(1&(o=e.pendingLanes))?e===Xs?Hs++:(Hs=0,Xs=e):Hs=0,Ua()}(e,t,n,r)}finally{Ss.transition=a,bt=r}return null}function wc(){if(null!==qs){var e=xt(Gs),t=Ss.transition,n=bt;try{if(Ss.transition=null,bt=16>e?16:e,null===qs)var r=!1;else{if(e=qs,qs=null,Gs=0,0!==(6&Cs))throw Error(i(331));var a=Cs;for(Cs|=4,Ku=e.current;null!==Ku;){var o=Ku,u=o.child;if(0!==(16&Ku.flags)){var s=o.deletions;if(null!==s){for(var c=0;c<s.length;c++){var l=s[c];for(Ku=l;null!==Ku;){var f=Ku;switch(f.tag){case 0:case 11:case 15:Ju(8,f,o)}var d=f.child;if(null!==d)d.return=f,Ku=d;else for(;null!==Ku;){var h=(f=Ku).sibling,p=f.return;if(ns(f),f===l){Ku=null;break}if(null!==h){h.return=p,Ku=h;break}Ku=p}}}var v=o.alternate;if(null!==v){var m=v.child;if(null!==m){v.child=null;do{var g=m.sibling;m.sibling=null,m=g}while(null!==m)}}Ku=o}}if(0!==(2064&o.subtreeFlags)&&null!==u)u.return=o,Ku=u;else e:for(;null!==Ku;){if(0!==(2048&(o=Ku).flags))switch(o.tag){case 0:case 11:case 15:Ju(9,o,o.return)}var y=o.sibling;if(null!==y){y.return=o.return,Ku=y;break e}Ku=o.return}}var b=e.current;for(Ku=b;null!==Ku;){var x=(u=Ku).child;if(0!==(2064&u.subtreeFlags)&&null!==x)x.return=u,Ku=x;else e:for(u=b;null!==Ku;){if(0!==(2048&(s=Ku).flags))try{switch(s.tag){case 0:case 11:case 15:es(9,s)}}catch(k){_c(s,s.return,k)}if(s===u){Ku=null;break e}var w=s.sibling;if(null!==w){w.return=s.return,Ku=w;break e}Ku=s.return}}if(Cs=a,Ua(),it&&"function"===typeof it.onPostCommitFiberRoot)try{it.onPostCommitFiberRoot(at,e)}catch(k){}r=!0}return r}finally{bt=n,Ss.transition=t}}return!1}function kc(e,t,n){ii(e,t=du(0,t=ou(n,t),1)),t=$s(),null!==(e=ec(e,1))&&(gt(e,1,t),nc(e,t))}function _c(e,t,n){if(3===e.tag)kc(e,e,n);else for(;null!==t;){if(3===t.tag){kc(t,e,n);break}if(1===t.tag){var r=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof r.componentDidCatch&&(null===Ws||!Ws.has(r))){ii(t,e=hu(t,e=ou(n,e),1)),e=$s(),null!==(t=ec(t,1))&&(gt(t,1,e),nc(t,e));break}}t=t.return}}function Sc(e,t,n){var r=e.pingCache;null!==r&&r.delete(t),t=$s(),e.pingedLanes|=e.suspendedLanes&n,As===e&&(Ns&n)===n&&(4===Ds||3===Ds&&(130023424&Ns)===Ns&&500>$e()-zs?fc(e,0):Rs|=n),nc(e,t)}function Cc(e,t){0===t&&(0===(1&e.mode)?t=1:(t=lt,0===(130023424&(lt<<=1))&&(lt=4194304)));var n=$s();null!==(e=ec(e,t))&&(gt(e,t,n),nc(e,n))}function Ac(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),Cc(e,n)}function Ec(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,a=e.memoizedState;null!==a&&(n=a.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(i(314))}null!==r&&r.delete(t),Cc(e,n)}function Nc(e,t){return He(e,t)}function Tc(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ic(e,t,n,r){return new Tc(e,t,n,r)}function Dc(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Fc(e,t){var n=e.alternate;return null===n?((n=Ic(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=14680064&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Mc(e,t,n,r,a,o){var u=2;if(r=e,"function"===typeof e)Dc(e)&&(u=1);else if("string"===typeof e)u=5;else e:switch(e){case _:return Oc(n.children,a,o,t);case S:u=8,a|=8;break;case C:return(e=Ic(12,n,t,2|a)).elementType=C,e.lanes=o,e;case T:return(e=Ic(13,n,t,a)).elementType=T,e.lanes=o,e;case I:return(e=Ic(19,n,t,a)).elementType=I,e.lanes=o,e;case M:return Rc(n,a,o,t);default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case A:u=10;break e;case E:u=9;break e;case N:u=11;break e;case D:u=14;break e;case F:u=16,r=null;break e}throw Error(i(130,null==e?e:typeof e,""))}return(t=Ic(u,n,t,a)).elementType=e,t.type=r,t.lanes=o,t}function Oc(e,t,n,r){return(e=Ic(7,e,r,t)).lanes=n,e}function Rc(e,t,n,r){return(e=Ic(22,e,r,t)).elementType=M,e.lanes=n,e.stateNode={},e}function jc(e,t,n){return(e=Ic(6,e,null,t)).lanes=n,e}function Bc(e,t,n){return(t=Ic(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function zc(e,t,n,r,a){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=mt(0),this.expirationTimes=mt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=mt(0),this.identifierPrefix=r,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function Zc(e,t,n,r,a,i,o,u,s){return e=new zc(e,t,n,u,s),1===t?(t=1,!0===i&&(t|=8)):t=0,i=Ic(3,null,null,t),e.current=i,i.stateNode=e,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},ni(i),e}function Lc(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:k,key:null==r?null:""+r,children:e,containerInfo:t,implementation:n}}function Pc(e){if(!e)return Ea;e:{if(Ue(e=e._reactInternals)!==e||1!==e.tag)throw Error(i(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Fa(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(i(171))}if(1===e.tag){var n=e.type;if(Fa(n))return Ra(e,n,t)}return t}function Uc(e,t,n,r,a,i,o,u,s){return(e=Zc(n,r,!0,e,0,i,0,u,s)).context=Pc(null),n=e.current,(i=ai(r=$s(),a=Qs(n))).callback=void 0!==t&&null!==t?t:null,ii(n,i),e.current.lanes=a,gt(e,a,r),nc(e,r),e}function Wc(e,t,n,r){var a=t.current,i=$s(),o=Qs(a);return n=Pc(n),null===t.context?t.context=n:t.pendingContext=n,(t=ai(i,o)).payload={element:e},null!==(r=void 0===r?null:r)&&(t.callback=r),ii(a,t),null!==(e=Js(a,o,i))&&oi(e,a,o),o}function Vc(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function qc(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function Gc(e,t){qc(e,t),(e=e.alternate)&&qc(e,t)}xs=function(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps||Ta.current)wu=!0;else{if(0===(e.lanes&n)&&0===(128&t.flags))return wu=!1,function(e,t,n){switch(t.tag){case 3:Du(t),Li();break;case 5:to(t);break;case 1:Fa(t.type)&&ja(t);break;case 4:Ji(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,a=t.memoizedProps.value;Aa(qa,r._currentValue),r._currentValue=a;break;case 13:if(null!==(r=t.memoizedState))return null!==r.dehydrated?(Aa(ro,1&ro.current),t.flags|=128,null):0!==(n&t.child.childLanes)?ju(e,t,n):(Aa(ro,1&ro.current),null!==(e=Vu(e,t,n))?e.sibling:null);Aa(ro,1&ro.current);break;case 19:if(r=0!==(n&t.childLanes),0!==(128&e.flags)){if(r)return Wu(e,t,n);t.flags|=128}if(null!==(a=t.memoizedState)&&(a.rendering=null,a.tail=null,a.lastEffect=null),Aa(ro,ro.current),r)break;return null;case 22:case 23:return t.lanes=0,Au(e,t,n)}return Vu(e,t,n)}(e,t,n);wu=0!==(131072&e.flags)}else wu=!1,Fi&&0!==(1048576&t.flags)&&Ei(t,xi,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),e=t.pendingProps;var a=Da(t,Na.current);Qa(t,n),a=xo(null,t,r,e,a,n);var o=wo();return t.flags|=1,"object"===typeof a&&null!==a&&"function"===typeof a.render&&void 0===a.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Fa(r)?(o=!0,ja(t)):o=!1,t.memoizedState=null!==a.state&&void 0!==a.state?a.state:null,ni(t),a.updater=di,t.stateNode=a,a._reactInternals=t,mi(t,r,e,n),t=Iu(null,t,r,!0,o,n)):(t.tag=0,Fi&&o&&Ni(t),ku(null,t,a,n),t=t.child),t;case 16:r=t.elementType;e:{switch(null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),e=t.pendingProps,r=(a=r._init)(r._payload),t.type=r,a=t.tag=function(e){if("function"===typeof e)return Dc(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===N)return 11;if(e===D)return 14}return 2}(r),e=Va(r,e),a){case 0:t=Nu(null,t,r,e,n);break e;case 1:t=Tu(null,t,r,e,n);break e;case 11:t=_u(null,t,r,e,n);break e;case 14:t=Su(null,t,r,Va(r.type,e),n);break e}throw Error(i(306,r,""))}return t;case 0:return r=t.type,a=t.pendingProps,Nu(e,t,r,a=t.elementType===r?a:Va(r,a),n);case 1:return r=t.type,a=t.pendingProps,Tu(e,t,r,a=t.elementType===r?a:Va(r,a),n);case 3:e:{if(Du(t),null===e)throw Error(i(387));r=t.pendingProps,a=(o=t.memoizedState).element,ri(e,t),si(t,r,null,n);var u=t.memoizedState;if(r=u.element,o.isDehydrated){if(o={element:r,isDehydrated:!1,cache:u.cache,pendingSuspenseBoundaries:u.pendingSuspenseBoundaries,transitions:u.transitions},t.updateQueue.baseState=o,t.memoizedState=o,256&t.flags){t=Fu(e,t,r,n,a=Error(i(423)));break e}if(r!==a){t=Fu(e,t,r,n,a=Error(i(424)));break e}for(Di=ca(t.stateNode.containerInfo.firstChild),Ii=t,Fi=!0,Mi=null,n=Hi(t,null,r,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(Li(),r===a){t=Vu(e,t,n);break e}ku(e,t,r,n)}t=t.child}return t;case 5:return to(t),null===e&&Bi(t),r=t.type,a=t.pendingProps,o=null!==e?e.memoizedProps:null,u=a.children,na(r,a)?u=null:null!==o&&na(r,o)&&(t.flags|=32),Eu(e,t),ku(e,t,u,n),t.child;case 6:return null===e&&Bi(t),null;case 13:return ju(e,t,n);case 4:return Ji(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=Gi(t,null,r,n):ku(e,t,r,n),t.child;case 11:return r=t.type,a=t.pendingProps,_u(e,t,r,a=t.elementType===r?a:Va(r,a),n);case 7:return ku(e,t,t.pendingProps,n),t.child;case 8:case 12:return ku(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,a=t.pendingProps,o=t.memoizedProps,u=a.value,Aa(qa,r._currentValue),r._currentValue=u,null!==o)if(ur(o.value,u)){if(o.children===a.children&&!Ta.current){t=Vu(e,t,n);break e}}else for(null!==(o=t.child)&&(o.return=t);null!==o;){var s=o.dependencies;if(null!==s){u=o.child;for(var c=s.firstContext;null!==c;){if(c.context===r){if(1===o.tag){(c=ai(-1,n&-n)).tag=2;var l=o.updateQueue;if(null!==l){var f=(l=l.shared).pending;null===f?c.next=c:(c.next=f.next,f.next=c),l.pending=c}}o.lanes|=n,null!==(c=o.alternate)&&(c.lanes|=n),$a(o.return,n,t),s.lanes|=n;break}c=c.next}}else if(10===o.tag)u=o.type===t.type?null:o.child;else if(18===o.tag){if(null===(u=o.return))throw Error(i(341));u.lanes|=n,null!==(s=u.alternate)&&(s.lanes|=n),$a(u,n,t),u=o.sibling}else u=o.child;if(null!==u)u.return=o;else for(u=o;null!==u;){if(u===t){u=null;break}if(null!==(o=u.sibling)){o.return=u.return,u=o;break}u=u.return}o=u}ku(e,t,a.children,n),t=t.child}return t;case 9:return a=t.type,r=t.pendingProps.children,Qa(t,n),r=r(a=Ja(a)),t.flags|=1,ku(e,t,r,n),t.child;case 14:return a=Va(r=t.type,t.pendingProps),Su(e,t,r,a=Va(r.type,a),n);case 15:return Cu(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,a=t.pendingProps,a=t.elementType===r?a:Va(r,a),null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),t.tag=1,Fa(r)?(e=!0,ja(t)):e=!1,Qa(t,n),pi(t,r,a),mi(t,r,a,n),Iu(null,t,r,!0,e,n);case 19:return Wu(e,t,n);case 22:return Au(e,t,n)}throw Error(i(156,t.tag))};var Hc="function"===typeof reportError?reportError:function(e){console.error(e)};function Xc(e){this._internalRoot=e}function Kc(e){this._internalRoot=e}function Yc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function $c(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function Qc(){}function Jc(e,t,n,r,a){var i=n._reactRootContainer;if(i){var o=i;if("function"===typeof a){var u=a;a=function(){var e=Vc(o);u.call(e)}}Wc(t,o,e,a)}else o=function(e,t,n,r,a){if(a){if("function"===typeof r){var i=r;r=function(){var e=Vc(o);i.call(e)}}var o=Uc(t,r,e,0,null,!1,0,"",Qc);return e._reactRootContainer=o,e[pa]=o.current,Ur(8===e.nodeType?e.parentNode:e),cc(),o}for(;a=e.lastChild;)e.removeChild(a);if("function"===typeof r){var u=r;r=function(){var e=Vc(s);u.call(e)}}var s=Zc(e,0,!1,null,0,!1,0,"",Qc);return e._reactRootContainer=s,e[pa]=s.current,Ur(8===e.nodeType?e.parentNode:e),cc((function(){Wc(t,s,n,r)})),s}(n,t,e,a,r);return Vc(o)}Kc.prototype.render=Xc.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(i(409));Wc(e,t,null,null)},Kc.prototype.unmount=Xc.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;cc((function(){Wc(null,e,null,null)})),t[pa]=null}},Kc.prototype.unstable_scheduleHydration=function(e){if(e){var t=St();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Mt.length&&0!==t&&t<Mt[n].priority;n++);Mt.splice(n,0,e),0===n&&Bt(e)}},wt=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=ft(t.pendingLanes);0!==n&&(yt(t,1|n),nc(t,$e()),0===(6&Cs)&&(Zs=$e()+500,Ua()))}break;case 13:var r=$s();cc((function(){return Js(e,1,r)})),Gc(e,1)}},kt=function(e){13===e.tag&&(Js(e,134217728,$s()),Gc(e,134217728))},_t=function(e){if(13===e.tag){var t=$s(),n=Qs(e);Js(e,n,t),Gc(e,n)}},St=function(){return bt},Ct=function(e,t){var n=bt;try{return bt=e,t()}finally{bt=n}},ke=function(e,t,n){switch(t){case"input":if(Q(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var a=wa(r);if(!a)throw Error(i(90));H(r),Q(r,a)}}}break;case"textarea":ie(e,n);break;case"select":null!=(t=n.value)&&ne(e,!!n.multiple,t,!1)}},Ne=sc,Te=cc;var el={usingClientEntryPoint:!1,Events:[ba,xa,wa,Ae,Ee,sc]},tl={findFiberByHostInstance:ya,bundleType:0,version:"18.1.0",rendererPackageName:"react-dom"},nl={bundleType:tl.bundleType,version:tl.version,rendererPackageName:tl.rendererPackageName,rendererConfig:tl.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:x.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=qe(e))?null:e.stateNode},findFiberByHostInstance:tl.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.1.0-next-22edb9f77-20220426"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var rl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!rl.isDisabled&&rl.supportsFiber)try{at=rl.inject(nl),it=rl}catch(le){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=el,t.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Yc(t))throw Error(i(200));return Lc(e,t,null,n)},t.createRoot=function(e,t){if(!Yc(e))throw Error(i(299));var n=!1,r="",a=Hc;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(r=t.identifierPrefix),void 0!==t.onRecoverableError&&(a=t.onRecoverableError)),t=Zc(e,1,!1,null,0,n,0,r,a),e[pa]=t.current,Ur(8===e.nodeType?e.parentNode:e),new Xc(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(i(188));throw e=Object.keys(e).join(","),Error(i(268,e))}return e=null===(e=qe(t))?null:e.stateNode},t.flushSync=function(e){return cc(e)},t.hydrate=function(e,t,n){if(!$c(t))throw Error(i(200));return Jc(null,e,t,!0,n)},t.hydrateRoot=function(e,t,n){if(!Yc(e))throw Error(i(405));var r=null!=n&&n.hydratedSources||null,a=!1,o="",u=Hc;if(null!==n&&void 0!==n&&(!0===n.unstable_strictMode&&(a=!0),void 0!==n.identifierPrefix&&(o=n.identifierPrefix),void 0!==n.onRecoverableError&&(u=n.onRecoverableError)),t=Uc(t,null,e,1,null!=n?n:null,a,0,o,u),e[pa]=t.current,Ur(e),r)for(e=0;e<r.length;e++)a=(a=(n=r[e])._getVersion)(n._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[n,a]:t.mutableSourceEagerHydrationData.push(n,a);return new Kc(t)},t.render=function(e,t,n){if(!$c(t))throw Error(i(200));return Jc(null,e,t,!1,n)},t.unmountComponentAtNode=function(e){if(!$c(e))throw Error(i(40));return!!e._reactRootContainer&&(cc((function(){Jc(null,null,e,!1,(function(){e._reactRootContainer=null,e[pa]=null}))})),!0)},t.unstable_batchedUpdates=sc,t.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!$c(n))throw Error(i(200));if(null==e||void 0===e._reactInternals)throw Error(i(38));return Jc(e,t,n,!1,r)},t.version="18.1.0-next-22edb9f77-20220426"},1250:function(e,t,n){"use strict";var r=n(4164);t.createRoot=r.createRoot,t.hydrateRoot=r.hydrateRoot},4164:function(e,t,n){"use strict";!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(4463)},6374:function(e,t,n){"use strict";var r=n(2791),a=Symbol.for("react.element"),i=Symbol.for("react.fragment"),o=Object.prototype.hasOwnProperty,u=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,s={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,n){var r,i={},c=null,l=null;for(r in void 0!==n&&(c=""+n),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(l=t.ref),t)o.call(t,r)&&!s.hasOwnProperty(r)&&(i[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps)void 0===i[r]&&(i[r]=t[r]);return{$$typeof:a,type:e,key:c,ref:l,props:i,_owner:u.current}}t.Fragment=i,t.jsx=c,t.jsxs=c},9117:function(e,t){"use strict";var n=Symbol.for("react.element"),r=Symbol.for("react.portal"),a=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),u=Symbol.for("react.provider"),s=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),l=Symbol.for("react.suspense"),f=Symbol.for("react.memo"),d=Symbol.for("react.lazy"),h=Symbol.iterator;var p={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},v=Object.assign,m={};function g(e,t,n){this.props=e,this.context=t,this.refs=m,this.updater=n||p}function y(){}function b(e,t,n){this.props=e,this.context=t,this.refs=m,this.updater=n||p}g.prototype.isReactComponent={},g.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},g.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},y.prototype=g.prototype;var x=b.prototype=new y;x.constructor=b,v(x,g.prototype),x.isPureReactComponent=!0;var w=Array.isArray,k=Object.prototype.hasOwnProperty,_={current:null},S={key:!0,ref:!0,__self:!0,__source:!0};function C(e,t,r){var a,i={},o=null,u=null;if(null!=t)for(a in void 0!==t.ref&&(u=t.ref),void 0!==t.key&&(o=""+t.key),t)k.call(t,a)&&!S.hasOwnProperty(a)&&(i[a]=t[a]);var s=arguments.length-2;if(1===s)i.children=r;else if(1<s){for(var c=Array(s),l=0;l<s;l++)c[l]=arguments[l+2];i.children=c}if(e&&e.defaultProps)for(a in s=e.defaultProps)void 0===i[a]&&(i[a]=s[a]);return{$$typeof:n,type:e,key:o,ref:u,props:i,_owner:_.current}}function A(e){return"object"===typeof e&&null!==e&&e.$$typeof===n}var E=/\/+/g;function N(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function T(e,t,a,i,o){var u=typeof e;"undefined"!==u&&"boolean"!==u||(e=null);var s=!1;if(null===e)s=!0;else switch(u){case"string":case"number":s=!0;break;case"object":switch(e.$$typeof){case n:case r:s=!0}}if(s)return o=o(s=e),e=""===i?"."+N(s,0):i,w(o)?(a="",null!=e&&(a=e.replace(E,"$&/")+"/"),T(o,t,a,"",(function(e){return e}))):null!=o&&(A(o)&&(o=function(e,t){return{$$typeof:n,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(o,a+(!o.key||s&&s.key===o.key?"":(""+o.key).replace(E,"$&/")+"/")+e)),t.push(o)),1;if(s=0,i=""===i?".":i+":",w(e))for(var c=0;c<e.length;c++){var l=i+N(u=e[c],c);s+=T(u,t,a,l,o)}else if(l=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=h&&e[h]||e["@@iterator"])?e:null}(e),"function"===typeof l)for(e=l.call(e),c=0;!(u=e.next()).done;)s+=T(u=u.value,t,a,l=i+N(u,c++),o);else if("object"===u)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return s}function I(e,t,n){if(null==e)return e;var r=[],a=0;return T(e,r,"","",(function(e){return t.call(n,e,a++)})),r}function D(e){if(-1===e._status){var t=e._result;(t=t()).then((function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)}),(function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)})),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var F={current:null},M={transition:null},O={ReactCurrentDispatcher:F,ReactCurrentBatchConfig:M,ReactCurrentOwner:_};t.Children={map:I,forEach:function(e,t,n){I(e,(function(){t.apply(this,arguments)}),n)},count:function(e){var t=0;return I(e,(function(){t++})),t},toArray:function(e){return I(e,(function(e){return e}))||[]},only:function(e){if(!A(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=g,t.Fragment=a,t.Profiler=o,t.PureComponent=b,t.StrictMode=i,t.Suspense=l,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=O,t.cloneElement=function(e,t,r){if(null===e||void 0===e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var a=v({},e.props),i=e.key,o=e.ref,u=e._owner;if(null!=t){if(void 0!==t.ref&&(o=t.ref,u=_.current),void 0!==t.key&&(i=""+t.key),e.type&&e.type.defaultProps)var s=e.type.defaultProps;for(c in t)k.call(t,c)&&!S.hasOwnProperty(c)&&(a[c]=void 0===t[c]&&void 0!==s?s[c]:t[c])}var c=arguments.length-2;if(1===c)a.children=r;else if(1<c){s=Array(c);for(var l=0;l<c;l++)s[l]=arguments[l+2];a.children=s}return{$$typeof:n,type:e.type,key:i,ref:o,props:a,_owner:u}},t.createContext=function(e){return(e={$$typeof:s,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:u,_context:e},e.Consumer=e},t.createElement=C,t.createFactory=function(e){var t=C.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=A,t.lazy=function(e){return{$$typeof:d,_payload:{_status:-1,_result:e},_init:D}},t.memo=function(e,t){return{$$typeof:f,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=M.transition;M.transition={};try{e()}finally{M.transition=t}},t.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")},t.useCallback=function(e,t){return F.current.useCallback(e,t)},t.useContext=function(e){return F.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return F.current.useDeferredValue(e)},t.useEffect=function(e,t){return F.current.useEffect(e,t)},t.useId=function(){return F.current.useId()},t.useImperativeHandle=function(e,t,n){return F.current.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return F.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return F.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return F.current.useMemo(e,t)},t.useReducer=function(e,t,n){return F.current.useReducer(e,t,n)},t.useRef=function(e){return F.current.useRef(e)},t.useState=function(e){return F.current.useState(e)},t.useSyncExternalStore=function(e,t,n){return F.current.useSyncExternalStore(e,t,n)},t.useTransition=function(){return F.current.useTransition()},t.version="18.1.0"},2791:function(e,t,n){"use strict";e.exports=n(9117)},184:function(e,t,n){"use strict";e.exports=n(6374)},6813:function(e,t){"use strict";function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var r=n-1>>>1,a=e[r];if(!(0<i(a,t)))break e;e[r]=t,e[n]=a,n=r}}function r(e){return 0===e.length?null:e[0]}function a(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,a=e.length,o=a>>>1;r<o;){var u=2*(r+1)-1,s=e[u],c=u+1,l=e[c];if(0>i(s,n))c<a&&0>i(l,s)?(e[r]=l,e[c]=n,r=c):(e[r]=s,e[u]=n,r=u);else{if(!(c<a&&0>i(l,n)))break e;e[r]=l,e[c]=n,r=c}}}return t}function i(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if("object"===typeof performance&&"function"===typeof performance.now){var o=performance;t.unstable_now=function(){return o.now()}}else{var u=Date,s=u.now();t.unstable_now=function(){return u.now()-s}}var c=[],l=[],f=1,d=null,h=3,p=!1,v=!1,m=!1,g="function"===typeof setTimeout?setTimeout:null,y="function"===typeof clearTimeout?clearTimeout:null,b="undefined"!==typeof setImmediate?setImmediate:null;function x(e){for(var t=r(l);null!==t;){if(null===t.callback)a(l);else{if(!(t.startTime<=e))break;a(l),t.sortIndex=t.expirationTime,n(c,t)}t=r(l)}}function w(e){if(m=!1,x(e),!v)if(null!==r(c))v=!0,M(k);else{var t=r(l);null!==t&&O(w,t.startTime-e)}}function k(e,n){v=!1,m&&(m=!1,y(A),A=-1),p=!0;var i=h;try{for(x(n),d=r(c);null!==d&&(!(d.expirationTime>n)||e&&!T());){var o=d.callback;if("function"===typeof o){d.callback=null,h=d.priorityLevel;var u=o(d.expirationTime<=n);n=t.unstable_now(),"function"===typeof u?d.callback=u:d===r(c)&&a(c),x(n)}else a(c);d=r(c)}if(null!==d)var s=!0;else{var f=r(l);null!==f&&O(w,f.startTime-n),s=!1}return s}finally{d=null,h=i,p=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var _,S=!1,C=null,A=-1,E=5,N=-1;function T(){return!(t.unstable_now()-N<E)}function I(){if(null!==C){var e=t.unstable_now();N=e;var n=!0;try{n=C(!0,e)}finally{n?_():(S=!1,C=null)}}else S=!1}if("function"===typeof b)_=function(){b(I)};else if("undefined"!==typeof MessageChannel){var D=new MessageChannel,F=D.port2;D.port1.onmessage=I,_=function(){F.postMessage(null)}}else _=function(){g(I,0)};function M(e){C=e,S||(S=!0,_())}function O(e,n){A=g((function(){e(t.unstable_now())}),n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){v||p||(v=!0,M(k))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):E=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return h},t.unstable_getFirstCallbackNode=function(){return r(c)},t.unstable_next=function(e){switch(h){case 1:case 2:case 3:var t=3;break;default:t=h}var n=h;h=t;try{return e()}finally{h=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=h;h=e;try{return t()}finally{h=n}},t.unstable_scheduleCallback=function(e,a,i){var o=t.unstable_now();switch("object"===typeof i&&null!==i?i="number"===typeof(i=i.delay)&&0<i?o+i:o:i=o,e){case 1:var u=-1;break;case 2:u=250;break;case 5:u=1073741823;break;case 4:u=1e4;break;default:u=5e3}return e={id:f++,callback:a,priorityLevel:e,startTime:i,expirationTime:u=i+u,sortIndex:-1},i>o?(e.sortIndex=i,n(l,e),null===r(c)&&e===r(l)&&(m?(y(A),A=-1):m=!0,O(w,i-o))):(e.sortIndex=u,n(c,e),v||p||(v=!0,M(k))),e},t.unstable_shouldYield=T,t.unstable_wrapCallback=function(e){var t=h;return function(){var n=h;h=t;try{return e.apply(this,arguments)}finally{h=n}}}},5296:function(e,t,n){"use strict";e.exports=n(6813)},6699:function(e,t,n){var r=n(2501),a=n(9112),i=n(2132),o=n(890),u=n(4113),s=n(1725),c=n(3411);c.alea=r,c.xor128=a,c.xorwow=i,c.xorshift7=o,c.xor4096=u,c.tychei=s,e.exports=c},2501:function(e,t,n){var r;!function(e,a,i){function o(e){var t=this,n=function(){var e=4022871197;return function(t){t=String(t);for(var n=0;n<t.length;n++){var r=.02519603282416938*(e+=t.charCodeAt(n));r-=e=r>>>0,e=(r*=e)>>>0,e+=4294967296*(r-=e)}return 2.3283064365386963e-10*(e>>>0)}}();t.next=function(){var e=2091639*t.s0+2.3283064365386963e-10*t.c;return t.s0=t.s1,t.s1=t.s2,t.s2=e-(t.c=0|e)},t.c=1,t.s0=n(" "),t.s1=n(" "),t.s2=n(" "),t.s0-=n(e),t.s0<0&&(t.s0+=1),t.s1-=n(e),t.s1<0&&(t.s1+=1),t.s2-=n(e),t.s2<0&&(t.s2+=1),n=null}function u(e,t){return t.c=e.c,t.s0=e.s0,t.s1=e.s1,t.s2=e.s2,t}function s(e,t){var n=new o(e),r=t&&t.state,a=n.next;return a.int32=function(){return 4294967296*n.next()|0},a.double=function(){return a()+11102230246251565e-32*(2097152*a()|0)},a.quick=a,r&&("object"==typeof r&&u(r,n),a.state=function(){return u(n,{})}),a}a&&a.exports?a.exports=s:n.amdD&&n.amdO?void 0===(r=function(){return s}.call(t,n,t,a))||(a.exports=r):this.alea=s}(0,e=n.nmd(e),n.amdD)},1725:function(e,t,n){var r;!function(e,a,i){function o(e){var t=this,n="";t.next=function(){var e=t.b,n=t.c,r=t.d,a=t.a;return e=e<<25^e>>>7^n,n=n-r|0,r=r<<24^r>>>8^a,a=a-e|0,t.b=e=e<<20^e>>>12^n,t.c=n=n-r|0,t.d=r<<16^n>>>16^a,t.a=a-e|0},t.a=0,t.b=0,t.c=-1640531527,t.d=1367130551,e===Math.floor(e)?(t.a=e/4294967296|0,t.b=0|e):n+=e;for(var r=0;r<n.length+20;r++)t.b^=0|n.charCodeAt(r),t.next()}function u(e,t){return t.a=e.a,t.b=e.b,t.c=e.c,t.d=e.d,t}function s(e,t){var n=new o(e),r=t&&t.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},a.int32=n.next,a.quick=a,r&&("object"==typeof r&&u(r,n),a.state=function(){return u(n,{})}),a}a&&a.exports?a.exports=s:n.amdD&&n.amdO?void 0===(r=function(){return s}.call(t,n,t,a))||(a.exports=r):this.tychei=s}(0,e=n.nmd(e),n.amdD)},9112:function(e,t,n){var r;!function(e,a,i){function o(e){var t=this,n="";t.x=0,t.y=0,t.z=0,t.w=0,t.next=function(){var e=t.x^t.x<<11;return t.x=t.y,t.y=t.z,t.z=t.w,t.w^=t.w>>>19^e^e>>>8},e===(0|e)?t.x=e:n+=e;for(var r=0;r<n.length+64;r++)t.x^=0|n.charCodeAt(r),t.next()}function u(e,t){return t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t}function s(e,t){var n=new o(e),r=t&&t.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},a.int32=n.next,a.quick=a,r&&("object"==typeof r&&u(r,n),a.state=function(){return u(n,{})}),a}a&&a.exports?a.exports=s:n.amdD&&n.amdO?void 0===(r=function(){return s}.call(t,n,t,a))||(a.exports=r):this.xor128=s}(0,e=n.nmd(e),n.amdD)},4113:function(e,t,n){var r;!function(e,a,i){function o(e){var t=this;t.next=function(){var e,n,r=t.w,a=t.X,i=t.i;return t.w=r=r+1640531527|0,n=a[i+34&127],e=a[i=i+1&127],n^=n<<13,e^=e<<17,n^=n>>>15,e^=e>>>12,n=a[i]=n^e,t.i=i,n+(r^r>>>16)|0},function(e,t){var n,r,a,i,o,u=[],s=128;for(t===(0|t)?(r=t,t=null):(t+="\0",r=0,s=Math.max(s,t.length)),a=0,i=-32;i<s;++i)t&&(r^=t.charCodeAt((i+32)%t.length)),0===i&&(o=r),r^=r<<10,r^=r>>>15,r^=r<<4,r^=r>>>13,i>=0&&(o=o+1640531527|0,a=0==(n=u[127&i]^=r+o)?a+1:0);for(a>=128&&(u[127&(t&&t.length||0)]=-1),a=127,i=512;i>0;--i)r=u[a+34&127],n=u[a=a+1&127],r^=r<<13,n^=n<<17,r^=r>>>15,n^=n>>>12,u[a]=r^n;e.w=o,e.X=u,e.i=a}(t,e)}function u(e,t){return t.i=e.i,t.w=e.w,t.X=e.X.slice(),t}function s(e,t){null==e&&(e=+new Date);var n=new o(e),r=t&&t.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},a.int32=n.next,a.quick=a,r&&(r.X&&u(r,n),a.state=function(){return u(n,{})}),a}a&&a.exports?a.exports=s:n.amdD&&n.amdO?void 0===(r=function(){return s}.call(t,n,t,a))||(a.exports=r):this.xor4096=s}(0,e=n.nmd(e),n.amdD)},890:function(e,t,n){var r;!function(e,a,i){function o(e){var t=this;t.next=function(){var e,n,r=t.x,a=t.i;return e=r[a],n=(e^=e>>>7)^e<<24,n^=(e=r[a+1&7])^e>>>10,n^=(e=r[a+3&7])^e>>>3,n^=(e=r[a+4&7])^e<<7,e=r[a+7&7],n^=(e^=e<<13)^e<<9,r[a]=n,t.i=a+1&7,n},function(e,t){var n,r=[];if(t===(0|t))r[0]=t;else for(t=""+t,n=0;n<t.length;++n)r[7&n]=r[7&n]<<15^t.charCodeAt(n)+r[n+1&7]<<13;for(;r.length<8;)r.push(0);for(n=0;n<8&&0===r[n];++n);for(8==n?r[7]=-1:r[n],e.x=r,e.i=0,n=256;n>0;--n)e.next()}(t,e)}function u(e,t){return t.x=e.x.slice(),t.i=e.i,t}function s(e,t){null==e&&(e=+new Date);var n=new o(e),r=t&&t.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},a.int32=n.next,a.quick=a,r&&(r.x&&u(r,n),a.state=function(){return u(n,{})}),a}a&&a.exports?a.exports=s:n.amdD&&n.amdO?void 0===(r=function(){return s}.call(t,n,t,a))||(a.exports=r):this.xorshift7=s}(0,e=n.nmd(e),n.amdD)},2132:function(e,t,n){var r;!function(e,a,i){function o(e){var t=this,n="";t.next=function(){var e=t.x^t.x>>>2;return t.x=t.y,t.y=t.z,t.z=t.w,t.w=t.v,(t.d=t.d+362437|0)+(t.v=t.v^t.v<<4^e^e<<1)|0},t.x=0,t.y=0,t.z=0,t.w=0,t.v=0,e===(0|e)?t.x=e:n+=e;for(var r=0;r<n.length+64;r++)t.x^=0|n.charCodeAt(r),r==n.length&&(t.d=t.x<<10^t.x>>>4),t.next()}function u(e,t){return t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t.v=e.v,t.d=e.d,t}function s(e,t){var n=new o(e),r=t&&t.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},a.int32=n.next,a.quick=a,r&&("object"==typeof r&&u(r,n),a.state=function(){return u(n,{})}),a}a&&a.exports?a.exports=s:n.amdD&&n.amdO?void 0===(r=function(){return s}.call(t,n,t,a))||(a.exports=r):this.xorwow=s}(0,e=n.nmd(e),n.amdD)},3411:function(e,t,n){var r;!function(a,i,o){var u,s=256,c=o.pow(s,6),l=o.pow(2,52),f=2*l,d=255;function h(e,t,n){var r=[],d=g(m((t=1==t?{entropy:!0}:t||{}).entropy?[e,y(i)]:null==e?function(){try{var e;return u&&(e=u.randomBytes)?e=e(s):(e=new Uint8Array(s),(a.crypto||a.msCrypto).getRandomValues(e)),y(e)}catch(r){var t=a.navigator,n=t&&t.plugins;return[+new Date,a,n,a.screen,y(i)]}}():e,3),r),h=new p(r),b=function(){for(var e=h.g(6),t=c,n=0;e<l;)e=(e+n)*s,t*=s,n=h.g(1);for(;e>=f;)e/=2,t/=2,n>>>=1;return(e+n)/t};return b.int32=function(){return 0|h.g(4)},b.quick=function(){return h.g(4)/4294967296},b.double=b,g(y(h.S),i),(t.pass||n||function(e,t,n,r){return r&&(r.S&&v(r,h),e.state=function(){return v(h,{})}),n?(o.random=e,t):e})(b,d,"global"in t?t.global:this==o,t.state)}function p(e){var t,n=e.length,r=this,a=0,i=r.i=r.j=0,o=r.S=[];for(n||(e=[n++]);a<s;)o[a]=a++;for(a=0;a<s;a++)o[a]=o[i=d&i+e[a%n]+(t=o[a])],o[i]=t;(r.g=function(e){for(var t,n=0,a=r.i,i=r.j,o=r.S;e--;)t=o[a=d&a+1],n=n*s+o[d&(o[a]=o[i=d&i+t])+(o[i]=t)];return r.i=a,r.j=i,n})(s)}function v(e,t){return t.i=e.i,t.j=e.j,t.S=e.S.slice(),t}function m(e,t){var n,r=[],a=typeof e;if(t&&"object"==a)for(n in e)try{r.push(m(e[n],t-1))}catch(i){}return r.length?r:"string"==a?e:e+"\0"}function g(e,t){for(var n,r=e+"",a=0;a<r.length;)t[d&a]=d&(n^=19*t[d&a])+r.charCodeAt(a++);return y(t)}function y(e){return String.fromCharCode.apply(0,e)}if(g(o.random(),i),e.exports){e.exports=h;try{u=n(5042)}catch(b){}}else void 0===(r=function(){return h}.call(t,n,t,e))||(e.exports=r)}("undefined"!==typeof self?self:this,[],Math)},5596:function(e,t,n){"use strict";n.r(t),n.d(t,{DEFAULT_ACTIONS:function(){return $be},default:function(){return dxe},guessMode:function(){return oxe},vega:function(){return Xbe},vegaLite:function(){return Kbe}});var r={};n.r(r),n.d(r,{JsonPatchError:function(){return M},_areEquals:function(){return W},applyOperation:function(){return z},applyPatch:function(){return Z},applyReducer:function(){return L},deepClone:function(){return O},getValueByPointer:function(){return B},validate:function(){return U},validator:function(){return P}});var a={};n.r(a),n.d(a,{compare:function(){return $},generate:function(){return K},observe:function(){return X},unobserve:function(){return H}});var i={};n.r(i),n.d(i,{aggregate:function(){return yf},bin:function(){return bf},collect:function(){return wf},compare:function(){return kf},countpattern:function(){return Sf},cross:function(){return Cf},density:function(){return Tf},dotbin:function(){return Of},expression:function(){return Rf},extent:function(){return Bf},facet:function(){return Zf},field:function(){return Lf},filter:function(){return Uf},flatten:function(){return Wf},fold:function(){return Vf},formula:function(){return qf},generate:function(){return Gf},impute:function(){return Kf},joinaggregate:function(){return Yf},kde:function(){return $f},key:function(){return Qf},load:function(){return ed},lookup:function(){return nd},multiextent:function(){return rd},multivalues:function(){return id},params:function(){return ud},pivot:function(){return sd},prefacet:function(){return cd},project:function(){return ld},proxy:function(){return fd},quantile:function(){return dd},relay:function(){return hd},sample:function(){return pd},sequence:function(){return vd},sieve:function(){return md},subflow:function(){return zf},timeunit:function(){return gd},tupleindex:function(){return bd},values:function(){return xd},window:function(){return Cd}});var o={};n.r(o),n.d(o,{bound:function(){return j_},identifier:function(){return Z_},mark:function(){return L_},overlap:function(){return P_},render:function(){return X_},viewlayout:function(){return mS}});var u={};n.r(u),n.d(u,{interpolate:function(){return OC},interpolateArray:function(){return AC},interpolateBasis:function(){return hC},interpolateBasisClosed:function(){return pC},interpolateCubehelix:function(){return WT},interpolateCubehelixLong:function(){return VT},interpolateDate:function(){return NC},interpolateDiscrete:function(){return HN},interpolateHcl:function(){return ET},interpolateHclLong:function(){return NT},interpolateHsl:function(){return iT},interpolateHslLong:function(){return oT},interpolateHue:function(){return XN},interpolateLab:function(){return CT},interpolateNumber:function(){return TC},interpolateNumberArray:function(){return SC},interpolateObject:function(){return IC},interpolateRgb:function(){return xC},interpolateRgbBasis:function(){return kC},interpolateRgbBasisClosed:function(){return _C},interpolateRound:function(){return RC},interpolateString:function(){return MC},interpolateTransformCss:function(){return eT},interpolateTransformSvg:function(){return tT},interpolateZoom:function(){return rT},piecewise:function(){return WN},quantize:function(){return qT}});var s={};n.r(s),n.d(s,{axisticks:function(){return tF},datajoin:function(){return nF},encode:function(){return aF},legendentries:function(){return iF},linkpath:function(){return lF},pie:function(){return vF},scale:function(){return yF},sortitems:function(){return kF},stack:function(){return EF}});var c={};n.r(c),n.d(c,{contour:function(){return sz},geojson:function(){return fz},geopath:function(){return dz},geopoint:function(){return hz},geoshape:function(){return pz},graticule:function(){return vz},heatmap:function(){return mz},isocontour:function(){return QB},kde2d:function(){return iz},projection:function(){return yz}});var l={};n.r(l),n.d(l,{force:function(){return pZ}});var f={};n.r(f),n.d(f,{nest:function(){return gL},pack:function(){return _L},partition:function(){return CL},stratify:function(){return AL},tree:function(){return TL},treelinks:function(){return IL},treemap:function(){return ML}});var d={};n.r(d),n.d(d,{label:function(){return vY}});var h={};n.r(h),n.d(h,{loess:function(){return gY},regression:function(){return bY}});var p={};n.r(p),n.d(p,{voronoi:function(){return qY}});var v={};n.r(v),n.d(v,{wordcloud:function(){return IQ}});var m={};n.r(m),n.d(m,{crossfilter:function(){return UQ},resolvefilter:function(){return WQ}});var g={};n.r(g),n.d(g,{Bounds:function(){return dG},CanvasHandler:function(){return WX},CanvasRenderer:function(){return XX},DATE:function(){return $c},DAY:function(){return Qc},DAYOFYEAR:function(){return Jc},Dataflow:function(){return bu},Debug:function(){return we},Error:function(){return ye},EventStream:function(){return Jo},Gradient:function(){return bq},GroupItem:function(){return pG},HOURS:function(){return el},Handler:function(){return CX},Info:function(){return xe},Item:function(){return hG},MILLISECONDS:function(){return rl},MINUTES:function(){return tl},MONTH:function(){return Kc},Marks:function(){return cX},MultiPulse:function(){return du},None:function(){return ge},Operator:function(){return Yo},Parameters:function(){return Ho},Pulse:function(){return su},QUARTER:function(){return Xc},RenderType:function(){return BK},Renderer:function(){return EX},ResourceLoader:function(){return vG},SECONDS:function(){return nl},SVGHandler:function(){return YX},SVGRenderer:function(){return xK},SVGStringRenderer:function(){return OK},Scenegraph:function(){return gX},TIME_UNITS:function(){return al},Transform:function(){return wu},View:function(){return T6},WEEK:function(){return Yc},Warn:function(){return be},YEAR:function(){return Hc},accessor:function(){return te},accessorFields:function(){return re},accessorName:function(){return ne},array:function(){return Xe},ascending:function(){return Qe},bandwidthNRD:function(){return Lu},bin:function(){return Pu},bootstrapCI:function(){return Vu},boundClip:function(){return qK},boundContext:function(){return jG},boundItem:function(){return lX},boundMark:function(){return dX},boundStroke:function(){return yG},changeset:function(){return qo},clampRange:function(){return Ke},codegenExpression:function(){return ene},compare:function(){return $e},constant:function(){return nt},cumulativeLogNormal:function(){return is},cumulativeNormal:function(){return Ju},cumulativeUniform:function(){return fs},dayofyear:function(){return fl},debounce:function(){return rt},defaultLocale:function(){return jV},definition:function(){return _u},densityLogNormal:function(){return as},densityNormal:function(){return Qu},densityUniform:function(){return ls},domChild:function(){return wX},domClear:function(){return kX},domCreate:function(){return bX},domFind:function(){return xX},dotbin:function(){return qu},error:function(){return ue},expressionFunction:function(){return L4},extend:function(){return at},extent:function(){return it},extentIndex:function(){return ot},falsy:function(){return ve},fastmap:function(){return lt},field:function(){return ce},flush:function(){return ft},font:function(){return tX},fontFamily:function(){return eX},fontSize:function(){return KH},format:function(){return cq},formatLocale:function(){return NV},formats:function(){return lq},hasOwnProperty:function(){return st},id:function(){return le},identity:function(){return fe},inferType:function(){return nq},inferTypes:function(){return rq},ingest:function(){return Zo},inherits:function(){return dt},inrange:function(){return ht},interpolate:function(){return RI},interpolateColors:function(){return FI},interpolateRange:function(){return DI},intersect:function(){return LK},intersectBoxLine:function(){return HG},intersectPath:function(){return WG},intersectPoint:function(){return VG},intersectRule:function(){return GG},isArray:function(){return _e},isBoolean:function(){return pt},isDate:function(){return vt},isFunction:function(){return Ye},isIterable:function(){return mt},isNumber:function(){return gt},isObject:function(){return Se},isRegExp:function(){return yt},isString:function(){return bt},isTuple:function(){return jo},key:function(){return xt},lerp:function(){return wt},lineHeight:function(){return YH},loader:function(){return hq},locale:function(){return RV},logger:function(){return ke},lruCache:function(){return kt},markup:function(){return hK},merge:function(){return _t},mergeConfig:function(){return Ae},multiLineOffset:function(){return QH},one:function(){return he},pad:function(){return Ct},panLinear:function(){return Be},panLog:function(){return ze},panPow:function(){return Ze},panSymlog:function(){return Le},parse:function(){return Ree},parseExpression:function(){return $te},parseSelector:function(){return une},pathCurves:function(){return wq},pathEqual:function(){return HK},pathParse:function(){return Sq},pathRectangle:function(){return Xq},pathRender:function(){return Rq},pathSymbols:function(){return Zq},pathTrail:function(){return Kq},peek:function(){return Te},point:function(){return SX},projection:function(){return aB},quantileLogNormal:function(){return os},quantileNormal:function(){return es},quantileUniform:function(){return ds},quantiles:function(){return zu},quantizeInterpolator:function(){return MI},quarter:function(){return Ge},quartiles:function(){return Zu},random:function(){return Uu},randomInteger:function(){return Hu},randomKDE:function(){return ns},randomLCG:function(){return Gu},randomLogNormal:function(){return us},randomMixture:function(){return ss},randomNormal:function(){return ts},randomUniform:function(){return hs},read:function(){return dq},regressionExp:function(){return xs},regressionLinear:function(){return ys},regressionLoess:function(){return Cs},regressionLog:function(){return bs},regressionPoly:function(){return _s},regressionPow:function(){return ws},regressionQuad:function(){return ks},renderModule:function(){return ZK},repeat:function(){return St},resetDefaultLocale:function(){return BV},resetSVGClipId:function(){return lG},resetSVGDefIds:function(){return XK},responseType:function(){return fq},runtimeContext:function(){return m5},sampleCurve:function(){return Ts},sampleLogNormal:function(){return rs},sampleNormal:function(){return $u},sampleUniform:function(){return cs},scale:function(){return wI},sceneEqual:function(){return GK},sceneFromJSON:function(){return vX},scenePickVisit:function(){return aH},sceneToJSON:function(){return pX},sceneVisit:function(){return rH},sceneZOrder:function(){return nH},scheme:function(){return ZI},serializeXML:function(){return pK},setRandom:function(){return Wu},span:function(){return At},splitAccessPath:function(){return se},stringValue:function(){return Et},textMetrics:function(){return WH},timeBin:function(){return tf},timeFloor:function(){return El},timeFormatLocale:function(){return MV},timeInterval:function(){return Ml},timeOffset:function(){return jl},timeSequence:function(){return Zl},timeUnitSpecifier:function(){return sl},timeUnits:function(){return ol},toBoolean:function(){return Nt},toDate:function(){return It},toNumber:function(){return Ie},toSet:function(){return Ft},toString:function(){return Dt},transform:function(){return Su},transforms:function(){return ku},truncate:function(){return Mt},truthy:function(){return pe},tupleid:function(){return Bo},typeParsers:function(){return JV},utcFloor:function(){return Il},utcInterval:function(){return Ol},utcOffset:function(){return Bl},utcSequence:function(){return Ll},utcdayofyear:function(){return gl},utcquarter:function(){return He},utcweek:function(){return yl},version:function(){return dne},visitArray:function(){return Ot},week:function(){return dl},writeConfig:function(){return Ee},zero:function(){return de},zoomLinear:function(){return Ue},zoomLog:function(){return We},zoomPow:function(){return Ve},zoomSymlog:function(){return qe}});var y={};n.r(y),n.d(y,{compile:function(){return Eye},extractTransforms:function(){return Fye},normalize:function(){return ufe},version:function(){return Mye}});var b={};n.r(b),n.d(b,{carbong10:function(){return Mbe},carbong100:function(){return Rbe},carbong90:function(){return Obe},carbonwhite:function(){return Fbe},dark:function(){return zye},excel:function(){return Lye},fivethirtyeight:function(){return qye},ggplot2:function(){return Hye},googlecharts:function(){return pbe},latimes:function(){return Jye},powerbi:function(){return Ebe},quartz:function(){return nbe},urbaninstitute:function(){return lbe},version:function(){return jbe},vox:function(){return abe}});var x=n(4687),w=n.n(x),k=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),_=Object.prototype.hasOwnProperty;function S(e,t){return _.call(e,t)}function C(e){if(Array.isArray(e)){for(var t=new Array(e.length),n=0;n<t.length;n++)t[n]=""+n;return t}if(Object.keys)return Object.keys(e);var r=[];for(var a in e)S(e,a)&&r.push(a);return r}function A(e){switch(typeof e){case"object":return JSON.parse(JSON.stringify(e));case"undefined":return null;default:return e}}function E(e){for(var t,n=0,r=e.length;n<r;){if(!((t=e.charCodeAt(n))>=48&&t<=57))return!1;n++}return!0}function N(e){return-1===e.indexOf("/")&&-1===e.indexOf("~")?e:e.replace(/~/g,"~0").replace(/\//g,"~1")}function T(e){return e.replace(/~1/g,"/").replace(/~0/g,"~")}function I(e){if(void 0===e)return!0;if(e)if(Array.isArray(e)){for(var t=0,n=e.length;t<n;t++)if(I(e[t]))return!0}else if("object"===typeof e)for(var r=C(e),a=r.length,i=0;i<a;i++)if(I(e[r[i]]))return!0;return!1}function D(e,t){var n=[e];for(var r in t){var a="object"===typeof t[r]?JSON.stringify(t[r],null,2):t[r];"undefined"!==typeof a&&n.push(r+": "+a)}return n.join("\n")}var F=function(e){function t(t,n,r,a,i){var o=this.constructor,u=e.call(this,D(t,{name:n,index:r,operation:a,tree:i}))||this;return u.name=n,u.index=r,u.operation=a,u.tree=i,Object.setPrototypeOf(u,o.prototype),u.message=D(t,{name:n,index:r,operation:a,tree:i}),u}return k(t,e),t}(Error),M=F,O=A,R={add:function(e,t,n){return e[t]=this.value,{newDocument:n}},remove:function(e,t,n){var r=e[t];return delete e[t],{newDocument:n,removed:r}},replace:function(e,t,n){var r=e[t];return e[t]=this.value,{newDocument:n,removed:r}},move:function(e,t,n){var r=B(n,this.path);r&&(r=A(r));var a=z(n,{op:"remove",path:this.from}).removed;return z(n,{op:"add",path:this.path,value:a}),{newDocument:n,removed:r}},copy:function(e,t,n){var r=B(n,this.from);return z(n,{op:"add",path:this.path,value:A(r)}),{newDocument:n}},test:function(e,t,n){return{newDocument:n,test:W(e[t],this.value)}},_get:function(e,t,n){return this.value=e[t],{newDocument:n}}},j={add:function(e,t,n){return E(t)?e.splice(t,0,this.value):e[t]=this.value,{newDocument:n,index:t}},remove:function(e,t,n){return{newDocument:n,removed:e.splice(t,1)[0]}},replace:function(e,t,n){var r=e[t];return e[t]=this.value,{newDocument:n,removed:r}},move:R.move,copy:R.copy,test:R.test,_get:R._get};function B(e,t){if(""==t)return e;var n={op:"_get",path:t};return z(e,n),n.value}function z(e,t,n,r,a,i){if(void 0===n&&(n=!1),void 0===r&&(r=!0),void 0===a&&(a=!0),void 0===i&&(i=0),n&&("function"==typeof n?n(t,0,e,t.path):P(t,0)),""===t.path){var o={newDocument:e};if("add"===t.op)return o.newDocument=t.value,o;if("replace"===t.op)return o.newDocument=t.value,o.removed=e,o;if("move"===t.op||"copy"===t.op)return o.newDocument=B(e,t.from),"move"===t.op&&(o.removed=e),o;if("test"===t.op){if(o.test=W(e,t.value),!1===o.test)throw new M("Test operation failed","TEST_OPERATION_FAILED",i,t,e);return o.newDocument=e,o}if("remove"===t.op)return o.removed=e,o.newDocument=null,o;if("_get"===t.op)return t.value=e,o;if(n)throw new M("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",i,t,e);return o}r||(e=A(e));var u=(t.path||"").split("/"),s=e,c=1,l=u.length,f=void 0,d=void 0,h=void 0;for(h="function"==typeof n?n:P;;){if((d=u[c])&&-1!=d.indexOf("~")&&(d=T(d)),a&&("__proto__"==d||"prototype"==d&&c>0&&"constructor"==u[c-1]))throw new TypeError("JSON-Patch: modifying `__proto__` or `constructor/prototype` prop is banned for security reasons, if this was on purpose, please set `banPrototypeModifications` flag false and pass it to this function. More info in fast-json-patch README");if(n&&void 0===f&&(void 0===s[d]?f=u.slice(0,c).join("/"):c==l-1&&(f=t.path),void 0!==f&&h(t,0,e,f)),c++,Array.isArray(s)){if("-"===d)d=s.length;else{if(n&&!E(d))throw new M("Expected an unsigned base-10 integer value, making the new referenced value the array element with the zero-based index","OPERATION_PATH_ILLEGAL_ARRAY_INDEX",i,t,e);E(d)&&(d=~~d)}if(c>=l){if(n&&"add"===t.op&&d>s.length)throw new M("The specified index MUST NOT be greater than the number of elements in the array","OPERATION_VALUE_OUT_OF_BOUNDS",i,t,e);if(!1===(o=j[t.op].call(t,s,d,e)).test)throw new M("Test operation failed","TEST_OPERATION_FAILED",i,t,e);return o}}else if(c>=l){if(!1===(o=R[t.op].call(t,s,d,e)).test)throw new M("Test operation failed","TEST_OPERATION_FAILED",i,t,e);return o}if(s=s[d],n&&c<l&&(!s||"object"!==typeof s))throw new M("Cannot perform operation at the desired path","OPERATION_PATH_UNRESOLVABLE",i,t,e)}}function Z(e,t,n,r,a){if(void 0===r&&(r=!0),void 0===a&&(a=!0),n&&!Array.isArray(t))throw new M("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");r||(e=A(e));for(var i=new Array(t.length),o=0,u=t.length;o<u;o++)i[o]=z(e,t[o],n,!0,a,o),e=i[o].newDocument;return i.newDocument=e,i}function L(e,t,n){var r=z(e,t);if(!1===r.test)throw new M("Test operation failed","TEST_OPERATION_FAILED",n,t,e);return r.newDocument}function P(e,t,n,r){if("object"!==typeof e||null===e||Array.isArray(e))throw new M("Operation is not an object","OPERATION_NOT_AN_OBJECT",t,e,n);if(!R[e.op])throw new M("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",t,e,n);if("string"!==typeof e.path)throw new M("Operation `path` property is not a string","OPERATION_PATH_INVALID",t,e,n);if(0!==e.path.indexOf("/")&&e.path.length>0)throw new M('Operation `path` property must start with "/"',"OPERATION_PATH_INVALID",t,e,n);if(("move"===e.op||"copy"===e.op)&&"string"!==typeof e.from)throw new M("Operation `from` property is not present (applicable in `move` and `copy` operations)","OPERATION_FROM_REQUIRED",t,e,n);if(("add"===e.op||"replace"===e.op||"test"===e.op)&&void 0===e.value)throw new M("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_REQUIRED",t,e,n);if(("add"===e.op||"replace"===e.op||"test"===e.op)&&I(e.value))throw new M("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_CANNOT_CONTAIN_UNDEFINED",t,e,n);if(n)if("add"==e.op){var a=e.path.split("/").length,i=r.split("/").length;if(a!==i+1&&a!==i)throw new M("Cannot perform an `add` operation at the desired path","OPERATION_PATH_CANNOT_ADD",t,e,n)}else if("replace"===e.op||"remove"===e.op||"_get"===e.op){if(e.path!==r)throw new M("Cannot perform the operation at a path that does not exist","OPERATION_PATH_UNRESOLVABLE",t,e,n)}else if("move"===e.op||"copy"===e.op){var o=U([{op:"_get",path:e.from,value:void 0}],n);if(o&&"OPERATION_PATH_UNRESOLVABLE"===o.name)throw new M("Cannot perform the operation from a path that does not exist","OPERATION_FROM_UNRESOLVABLE",t,e,n)}}function U(e,t,n){try{if(!Array.isArray(e))throw new M("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");if(t)Z(A(t),A(e),n||!0);else{n=n||P;for(var r=0;r<e.length;r++)n(e[r],r,t,void 0)}}catch(a){if(a instanceof M)return a;throw a}}function W(e,t){if(e===t)return!0;if(e&&t&&"object"==typeof e&&"object"==typeof t){var n,r,a,i=Array.isArray(e),o=Array.isArray(t);if(i&&o){if((r=e.length)!=t.length)return!1;for(n=r;0!==n--;)if(!W(e[n],t[n]))return!1;return!0}if(i!=o)return!1;var u=Object.keys(e);if((r=u.length)!==Object.keys(t).length)return!1;for(n=r;0!==n--;)if(!t.hasOwnProperty(u[n]))return!1;for(n=r;0!==n--;)if(!W(e[a=u[n]],t[a]))return!1;return!0}return e!==e&&t!==t}var V=new WeakMap,q=function(e){this.observers=new Map,this.obj=e},G=function(e,t){this.callback=e,this.observer=t};function H(e,t){t.unobserve()}function X(e,t){var n,r=function(e){return V.get(e)}(e);if(r){var a=function(e,t){return e.observers.get(t)}(r,t);n=a&&a.observer}else r=new q(e),V.set(e,r);if(n)return n;if(n={},r.value=A(e),t){n.callback=t,n.next=null;var i=function(){K(n)},o=function(){clearTimeout(n.next),n.next=setTimeout(i)};"undefined"!==typeof window&&(window.addEventListener("mouseup",o),window.addEventListener("keyup",o),window.addEventListener("mousedown",o),window.addEventListener("keydown",o),window.addEventListener("change",o))}return n.patches=[],n.object=e,n.unobserve=function(){K(n),clearTimeout(n.next),function(e,t){e.observers.delete(t.callback)}(r,n),"undefined"!==typeof window&&(window.removeEventListener("mouseup",o),window.removeEventListener("keyup",o),window.removeEventListener("mousedown",o),window.removeEventListener("keydown",o),window.removeEventListener("change",o))},r.observers.set(t,new G(t,n)),n}function K(e,t){void 0===t&&(t=!1);var n=V.get(e.object);Y(n.value,e.object,e.patches,"",t),e.patches.length&&Z(n.value,e.patches);var r=e.patches;return r.length>0&&(e.patches=[],e.callback&&e.callback(r)),r}function Y(e,t,n,r,a){if(t!==e){"function"===typeof t.toJSON&&(t=t.toJSON());for(var i=C(t),o=C(e),u=!1,s=o.length-1;s>=0;s--){var c=e[f=o[s]];if(!S(t,f)||void 0===t[f]&&void 0!==c&&!1===Array.isArray(t))Array.isArray(e)===Array.isArray(t)?(a&&n.push({op:"test",path:r+"/"+N(f),value:A(c)}),n.push({op:"remove",path:r+"/"+N(f)}),u=!0):(a&&n.push({op:"test",path:r,value:e}),n.push({op:"replace",path:r,value:t}),!0);else{var l=t[f];"object"==typeof c&&null!=c&&"object"==typeof l&&null!=l&&Array.isArray(c)===Array.isArray(l)?Y(c,l,n,r+"/"+N(f),a):c!==l&&(!0,a&&n.push({op:"test",path:r+"/"+N(f),value:A(c)}),n.push({op:"replace",path:r+"/"+N(f),value:A(l)}))}}if(u||i.length!=o.length)for(s=0;s<i.length;s++){var f;S(e,f=i[s])||void 0===t[f]||n.push({op:"add",path:r+"/"+N(f),value:A(t[f])})}}}function $(e,t,n){void 0===n&&(n=!1);var r=[];return Y(e,t,r,"",n),r}Object.assign({},r,a,{JsonPatchError:F,deepClone:A,escapePathComponent:N,unescapePathComponent:T});var Q=n(3333),J=n.n(Q),ee=n(6487);function te(e,t,n){return e.fields=t||[],e.fname=n,e}function ne(e){return null==e?null:e.fname}function re(e){return null==e?null:e.fields}function ae(e){return 1===e.length?ie(e[0]):oe(e)}var ie=function(e){return function(t){return t[e]}},oe=function(e){var t=e.length;return function(n){for(var r=0;r<t;++r)n=n[e[r]];return n}};function ue(e){throw Error(e)}function se(e){var t,n,r,a=[],i=e.length,o=null,u=0,s="";function c(){a.push(s+e.substring(t,n)),s="",t=n+1}for(e+="",t=n=0;n<i;++n)if("\\"===(r=e[n]))s+=e.substring(t,n),s+=e.substring(++n,++n),t=n;else if(r===o)c(),o=null,u=-1;else{if(o)continue;t===u&&'"'===r||t===u&&"'"===r?(t=n+1,o=r):"."!==r||u?"["===r?(n>t&&c(),u=t=n+1):"]"===r&&(u||ue("Access path missing open bracket: "+e),u>0&&c(),u=0,t=n+1):n>t?c():t=n+1}return u&&ue("Access path missing closing bracket: "+e),o&&ue("Access path missing closing quote: "+e),n>t&&(n++,c()),a}function ce(e,t,n){var r=se(e);return e=1===r.length?r[0]:e,te((n&&n.get||ae)(r),[e],t||e)}var le=ce("id"),fe=te((function(e){return e}),[],"identity"),de=te((function(){return 0}),[],"zero"),he=te((function(){return 1}),[],"one"),pe=te((function(){return!0}),[],"true"),ve=te((function(){return!1}),[],"false");function me(e,t,n){var r=[t].concat([].slice.call(n));console[e].apply(console,r)}var ge=0,ye=1,be=2,xe=3,we=4;function ke(e,t){var n=e||ge;return{level:function(e){return arguments.length?(n=+e,this):n},error:function(){return n>=ye&&me(t||"error","ERROR",arguments),this},warn:function(){return n>=be&&me(t||"warn","WARN",arguments),this},info:function(){return n>=xe&&me(t||"log","INFO",arguments),this},debug:function(){return n>=we&&me(t||"log","DEBUG",arguments),this}}}var _e=Array.isArray;function Se(e){return e===Object(e)}var Ce=function(e){return"__proto__"!==e};function Ae(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.reduce((function(e,t){for(var n in t)if("signals"===n)e.signals=Ne(e.signals,t.signals);else{var r="legend"===n?{layout:1}:"style"===n||null;Ee(e,n,t[n],r)}return e}),{})}function Ee(e,t,n,r){var a,i;if(Ce(t))if(Se(n)&&!_e(n))for(a in i=Se(e[t])?e[t]:e[t]={},n)r&&(!0===r||r[a])?Ee(i,a,n[a]):Ce(a)&&(i[a]=n[a]);else e[t]=n}function Ne(e,t){if(null==e)return t;var n={},r=[];function a(e){n[e.name]||(n[e.name]=1,r.push(e))}return t.forEach(a),e.forEach(a),r}function Te(e){return e[e.length-1]}function Ie(e){return null==e||""===e?null:+e}var De=function(e){return function(t){return e*Math.exp(t)}},Fe=function(e){return function(t){return Math.log(e*t)}},Me=function(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}},Oe=function(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}},Re=function(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}};function je(e,t,n,r){var a=n(e[0]),i=n(Te(e)),o=(i-a)*t;return[r(a-o),r(i-o)]}function Be(e,t){return je(e,t,Ie,fe)}function ze(e,t){var n=Math.sign(e[0]);return je(e,t,Fe(n),De(n))}function Ze(e,t,n){return je(e,t,Re(n),Re(1/n))}function Le(e,t,n){return je(e,t,Me(n),Oe(n))}function Pe(e,t,n,r,a){var i=r(e[0]),o=r(Te(e)),u=null!=t?r(t):(i+o)/2;return[a(u+(i-u)*n),a(u+(o-u)*n)]}function Ue(e,t,n){return Pe(e,t,n,Ie,fe)}function We(e,t,n){var r=Math.sign(e[0]);return Pe(e,t,n,Fe(r),De(r))}function Ve(e,t,n,r){return Pe(e,t,n,Re(r),Re(1/r))}function qe(e,t,n,r){return Pe(e,t,n,Me(r),Oe(r))}function Ge(e){return 1+~~(new Date(e).getMonth()/3)}function He(e){return 1+~~(new Date(e).getUTCMonth()/3)}function Xe(e){return null!=e?_e(e)?e:[e]:[]}function Ke(e,t,n){var r,a=e[0],i=e[1];return i<a&&(r=i,i=a,a=r),(r=i-a)>=n-t?[t,n]:[a=Math.min(Math.max(a,t),n-r),a+r]}function Ye(e){return"function"===typeof e}function $e(e,t,n){n=n||{},t=Xe(t)||[];var r=[],a=[],i={},o=n.comparator||Je;return Xe(e).forEach((function(e,o){null!=e&&(r.push("descending"===t[o]?-1:1),a.push(e=Ye(e)?e:ce(e,null,n)),(re(e)||[]).forEach((function(e){return i[e]=1})))})),0===a.length?null:te(o(a,r),Object.keys(i))}var Qe=function(e,t){return(e<t||null==e)&&null!=t?-1:(e>t||null==t)&&null!=e?1:(t=t instanceof Date?+t:t,(e=e instanceof Date?+e:e)!==e&&t===t?-1:t!==t&&e===e?1:0)},Je=function(e,t){return 1===e.length?et(e[0],t[0]):tt(e,t,e.length)},et=function(e,t){return function(n,r){return Qe(e(n),e(r))*t}},tt=function(e,t,n){return t.push(0),function(r,a){for(var i,o=0,u=-1;0===o&&++u<n;)i=e[u],o=Qe(i(r),i(a));return o*t[u]}};function nt(e){return Ye(e)?e:function(){return e}}function rt(e,t){var n;return function(r){n&&clearTimeout(n),n=setTimeout((function(){return t(r),n=null}),e)}}function at(e){for(var t,n,r=1,a=arguments.length;r<a;++r)for(n in t=arguments[r])e[n]=t[n];return e}function it(e,t){var n,r,a,i,o=0;if(e&&(n=e.length))if(null==t){for(r=e[o];o<n&&(null==r||r!==r);r=e[++o]);for(a=i=r;o<n;++o)null!=(r=e[o])&&(r<a&&(a=r),r>i&&(i=r))}else{for(r=t(e[o]);o<n&&(null==r||r!==r);r=t(e[++o]));for(a=i=r;o<n;++o)null!=(r=t(e[o]))&&(r<a&&(a=r),r>i&&(i=r))}return[a,i]}function ot(e,t){var n,r,a,i,o,u=e.length,s=-1;if(null==t){for(;++s<u;)if(null!=(r=e[s])&&r>=r){n=a=r;break}if(s===u)return[-1,-1];for(i=o=s;++s<u;)null!=(r=e[s])&&(n>r&&(n=r,i=s),a<r&&(a=r,o=s))}else{for(;++s<u;)if(null!=(r=t(e[s],s,e))&&r>=r){n=a=r;break}if(s===u)return[-1,-1];for(i=o=s;++s<u;)null!=(r=t(e[s],s,e))&&(n>r&&(n=r,i=s),a<r&&(a=r,o=s))}return[i,o]}var ut=Object.prototype.hasOwnProperty;function st(e,t){return ut.call(e,t)}var ct={};function lt(e){var t,n={};function r(e){return st(n,e)&&n[e]!==ct}var a={size:0,empty:0,object:n,has:r,get:function(e){return r(e)?n[e]:void 0},set:function(e,t){return r(e)||(++a.size,n[e]===ct&&--a.empty),n[e]=t,this},delete:function(e){return r(e)&&(--a.size,++a.empty,n[e]=ct),this},clear:function(){a.size=a.empty=0,a.object=n={}},test:function(e){return arguments.length?(t=e,a):t},clean:function(){var e={},r=0;for(var i in n){var o=n[i];o===ct||t&&t(o)||(e[i]=o,++r)}a.size=r,a.empty=0,a.object=n=e}};return e&&Object.keys(e).forEach((function(t){a.set(t,e[t])})),a}function ft(e,t,n,r,a,i){if(!n&&0!==n)return i;var o,u=+n,s=e[0],c=Te(e);c<s&&(o=s,s=c,c=o),o=Math.abs(t-s);var l=Math.abs(c-t);return o<l&&o<=u?r:l<=u?a:i}function dt(e,t,n){var r=e.prototype=Object.create(t.prototype);return Object.defineProperty(r,"constructor",{value:e,writable:!0,enumerable:!0,configurable:!0}),at(r,n)}function ht(e,t,n,r){var a,i=t[0],o=t[t.length-1];return i>o&&(a=i,i=o,o=a),r=void 0===r||r,((n=void 0===n||n)?i<=e:i<e)&&(r?e<=o:e<o)}function pt(e){return"boolean"===typeof e}function vt(e){return"[object Date]"===Object.prototype.toString.call(e)}function mt(e){return e&&Ye(e[Symbol.iterator])}function gt(e){return"number"===typeof e}function yt(e){return"[object RegExp]"===Object.prototype.toString.call(e)}function bt(e){return"string"===typeof e}function xt(e,t,n){e&&(e=t?Xe(e).map((function(e){return e.replace(/\\(.)/g,"$1")})):Xe(e));var r,a=e&&e.length,i=n&&n.get||ae,o=function(e){return i(t?[e]:se(e))};if(a)if(1===a){var u=o(e[0]);r=function(e){return""+u(e)}}else{var s=e.map(o);r=function(e){for(var t=""+s[0](e),n=0;++n<a;)t+="|"+s[n](e);return t}}else r=function(){return""};return te(r,e,"key")}function wt(e,t){var n=e[0],r=Te(e),a=+t;return a?1===a?r:n+a*(r-n):n}function kt(e){var t,n,r;e=+e||1e4;var a=function(){t={},n={},r=0},i=function(a,i){return++r>e&&(n=t,t={},r=1),t[a]=i};return a(),{clear:a,has:function(e){return st(t,e)||st(n,e)},get:function(e){return st(t,e)?t[e]:st(n,e)?i(e,n[e]):void 0},set:function(e,n){return st(t,e)?t[e]=n:i(e,n)}}}function _t(e,t,n,r){var a=t.length,i=n.length;if(!i)return t;if(!a)return n;for(var o=r||new t.constructor(a+i),u=0,s=0,c=0;u<a&&s<i;++c)o[c]=e(t[u],n[s])>0?n[s++]:t[u++];for(;u<a;++u,++c)o[c]=t[u];for(;s<i;++s,++c)o[c]=n[s];return o}function St(e,t){for(var n="";--t>=0;)n+=e;return n}function Ct(e,t,n,r){var a=n||" ",i=e+"",o=t-i.length;return o<=0?i:"left"===r?St(a,o)+i:"center"===r?St(a,~~(o/2))+i+St(a,Math.ceil(o/2)):i+St(a,o)}function At(e){return e&&Te(e)-e[0]||0}function Et(e){return _e(e)?"["+e.map(Et)+"]":Se(e)||bt(e)?JSON.stringify(e).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):e}function Nt(e){return null==e||""===e?null:!(!e||"false"===e||"0"===e)&&!!e}var Tt=function(e){return gt(e)||vt(e)?e:Date.parse(e)};function It(e,t){return t=t||Tt,null==e||""===e?null:t(e)}function Dt(e){return null==e||""===e?null:e+""}function Ft(e){for(var t={},n=e.length,r=0;r<n;++r)t[e[r]]=!0;return t}function Mt(e,t,n,r){var a=null!=r?r:"\u2026",i=e+"",o=i.length,u=Math.max(0,t-a.length);return o<=t?i:"left"===n?a+i.slice(o-u):"center"===n?i.slice(0,Math.ceil(u/2))+a+i.slice(o-~~(u/2)):i.slice(0,u)+a}function Ot(e,t,n){if(e)if(t)for(var r=e.length,a=0;a<r;++a){var i=t(e[a]);i&&n(i,a,e)}else e.forEach(n)}var Rt=n(7762),jt=n(5861);function Bt(e,t,n){return e.fields=t||[],e.fname=n,e}function zt(e){return 1===e.length?Zt(e[0]):Lt(e)}var Zt=function(e){return function(t){return t[e]}},Lt=function(e){var t=e.length;return function(n){for(var r=0;r<t;++r)n=n[e[r]];return n}};function Pt(e){throw Error(e)}function Ut(e){var t,n,r,a=[],i=e.length,o=null,u=0,s="";function c(){a.push(s+e.substring(t,n)),s="",t=n+1}for(e+="",t=n=0;n<i;++n)if("\\"===(r=e[n]))s+=e.substring(t,n++),t=n;else if(r===o)c(),o=null,u=-1;else{if(o)continue;t===u&&'"'===r||t===u&&"'"===r?(t=n+1,o=r):"."!==r||u?"["===r?(n>t&&c(),u=t=n+1):"]"===r&&(u||Pt("Access path missing open bracket: "+e),u>0&&c(),u=0,t=n+1):n>t?c():t=n+1}return u&&Pt("Access path missing closing bracket: "+e),o&&Pt("Access path missing closing quote: "+e),n>t&&(n++,c()),a}function Wt(e,t,n){var r=Ut(e);return e=1===r.length?r[0]:e,Bt((n&&n.get||zt)(r),[e],t||e)}var Vt=Wt("id"),qt=Bt((function(e){return e}),[],"identity"),Gt=(Bt((function(){return 0}),[],"zero"),Bt((function(){return 1}),[],"one"),Bt((function(){return!0}),[],"true"));Bt((function(){return!1}),[],"false");function Ht(e,t,n){var r=[t].concat([].slice.call(n));console[e].apply(console,r)}var Xt=Array.isArray;function Kt(e){return e===Object(e)}function Yt(e){return null==e||""===e?null:+e}function $t(e){return null!=e?Xt(e)?e:[e]:[]}function Qt(e){return"function"===typeof e}function Jt(e){return Qt(e)?e:function(){return e}}function en(e){for(var t,n,r=1,a=arguments.length;r<a;++r)for(n in t=arguments[r])e[n]=t[n];return e}var tn=Object.prototype.hasOwnProperty;function nn(e,t){return tn.call(e,t)}function rn(e,t,n){var r=e.prototype=Object.create(t.prototype);return Object.defineProperty(r,"constructor",{value:e,writable:!0,enumerable:!0,configurable:!0}),en(r,n)}function an(e){return"string"===typeof e}function on(e){return Xt(e)?"["+e.map(on)+"]":Kt(e)||an(e)?JSON.stringify(e).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):e}var un=function(e){return function(e){return"number"===typeof e}(e)||function(e){return"[object Date]"===Object.prototype.toString.call(e)}(e)?e:Date.parse(e)};function sn(e,t,n){if(e)if(t)for(var r=e.length,a=0;a<r;++a){var i=t(e[a]);i&&n(i,a,e)}else e.forEach(n)}var cn=n(3433),ln={},fn={};function dn(e){return new Function("d","return {"+e.map((function(e,t){return JSON.stringify(e)+": d["+t+'] || ""'})).join(",")+"}")}function hn(e){var t=Object.create(null),n=[];return e.forEach((function(e){for(var r in e)r in t||n.push(t[r]=r)})),n}function pn(e,t){var n=e+"",r=n.length;return r<t?new Array(t-r+1).join(0)+n:n}function vn(e){var t=e.getUTCHours(),n=e.getUTCMinutes(),r=e.getUTCSeconds(),a=e.getUTCMilliseconds();return isNaN(e)?"Invalid Date":function(e){return e<0?"-"+pn(-e,6):e>9999?"+"+pn(e,6):pn(e,4)}(e.getUTCFullYear())+"-"+pn(e.getUTCMonth()+1,2)+"-"+pn(e.getUTCDate(),2)+(a?"T"+pn(t,2)+":"+pn(n,2)+":"+pn(r,2)+"."+pn(a,3)+"Z":r?"T"+pn(t,2)+":"+pn(n,2)+":"+pn(r,2)+"Z":n||t?"T"+pn(t,2)+":"+pn(n,2)+"Z":"")}function mn(e){var t=new RegExp('["'+e+"\n\r]"),n=e.charCodeAt(0);function r(e,t){var r,a=[],i=e.length,o=0,u=0,s=i<=0,c=!1;function l(){if(s)return fn;if(c)return c=!1,ln;var t,r,a=o;if(34===e.charCodeAt(a)){for(;o++<i&&34!==e.charCodeAt(o)||34===e.charCodeAt(++o););return(t=o)>=i?s=!0:10===(r=e.charCodeAt(o++))?c=!0:13===r&&(c=!0,10===e.charCodeAt(o)&&++o),e.slice(a+1,t-1).replace(/""/g,'"')}for(;o<i;){if(10===(r=e.charCodeAt(t=o++)))c=!0;else if(13===r)c=!0,10===e.charCodeAt(o)&&++o;else if(r!==n)continue;return e.slice(a,t)}return s=!0,e.slice(a,i)}for(10===e.charCodeAt(i-1)&&--i,13===e.charCodeAt(i-1)&&--i;(r=l())!==fn;){for(var f=[];r!==ln&&r!==fn;)f.push(r),r=l();t&&null==(f=t(f,u++))||a.push(f)}return a}function a(t,n){return t.map((function(t){return n.map((function(e){return o(t[e])})).join(e)}))}function i(t){return t.map(o).join(e)}function o(e){return null==e?"":e instanceof Date?vn(e):t.test(e+="")?'"'+e.replace(/"/g,'""')+'"':e}return{parse:function(e,t){var n,a,i=r(e,(function(e,r){if(n)return n(e,r-1);a=e,n=t?function(e,t){var n=dn(e);return function(r,a){return t(n(r),a,e)}}(e,t):dn(e)}));return i.columns=a||[],i},parseRows:r,format:function(t,n){return null==n&&(n=hn(t)),[n.map(o).join(e)].concat(a(t,n)).join("\n")},formatBody:function(e,t){return null==t&&(t=hn(e)),a(e,t).join("\n")},formatRows:function(e){return e.map(i).join("\n")},formatRow:i,formatValue:o}}function gn(e){return e}function yn(e,t){return"string"===typeof t&&(t=e.objects[t]),"GeometryCollection"===t.type?{type:"FeatureCollection",features:t.geometries.map((function(t){return bn(e,t)}))}:bn(e,t)}function bn(e,t){var n=t.id,r=t.bbox,a=null==t.properties?{}:t.properties,i=xn(e,t);return null==n&&null==r?{type:"Feature",properties:a,geometry:i}:null==r?{type:"Feature",id:n,properties:a,geometry:i}:{type:"Feature",id:n,bbox:r,properties:a,geometry:i}}function xn(e,t){var n=function(e){if(null==e)return gn;var t,n,r=e.scale[0],a=e.scale[1],i=e.translate[0],o=e.translate[1];return function(e,u){u||(t=n=0);var s=2,c=e.length,l=new Array(c);for(l[0]=(t+=e[0])*r+i,l[1]=(n+=e[1])*a+o;s<c;)l[s]=e[s],++s;return l}}(e.transform),r=e.arcs;function a(e,t){t.length&&t.pop();for(var a=r[e<0?~e:e],i=0,o=a.length;i<o;++i)t.push(n(a[i],i));e<0&&function(e,t){for(var n,r=e.length,a=r-t;a<--r;)n=e[a],e[a++]=e[r],e[r]=n}(t,o)}function i(e){return n(e)}function o(e){for(var t=[],n=0,r=e.length;n<r;++n)a(e[n],t);return t.length<2&&t.push(t[0]),t}function u(e){for(var t=o(e);t.length<4;)t.push(t[0]);return t}function s(e){return e.map(u)}return function e(t){var n,r=t.type;switch(r){case"GeometryCollection":return{type:r,geometries:t.geometries.map(e)};case"Point":n=i(t.coordinates);break;case"MultiPoint":n=t.coordinates.map(i);break;case"LineString":n=o(t.arcs);break;case"MultiLineString":n=t.arcs.map(o);break;case"Polygon":n=s(t.arcs);break;case"MultiPolygon":n=t.arcs.map(s);break;default:return null}return{type:r,coordinates:n}}(t)}function wn(e,t){var n={},r={},a={},i=[],o=-1;function u(e,t){for(var r in e){var a=e[r];delete t[a.start],delete a.start,delete a.end,a.forEach((function(e){n[e<0?~e:e]=1})),i.push(a)}}return t.forEach((function(n,r){var a,i=e.arcs[n<0?~n:n];i.length<3&&!i[1][0]&&!i[1][1]&&(a=t[++o],t[o]=n,t[r]=a)})),t.forEach((function(t){var n,i,o=function(t){var n,r=e.arcs[t<0?~t:t],a=r[0];e.transform?(n=[0,0],r.forEach((function(e){n[0]+=e[0],n[1]+=e[1]}))):n=r[r.length-1];return t<0?[n,a]:[a,n]}(t),u=o[0],s=o[1];if(n=a[u])if(delete a[n.end],n.push(t),n.end=s,i=r[s]){delete r[i.start];var c=i===n?n:n.concat(i);r[c.start=n.start]=a[c.end=i.end]=c}else r[n.start]=a[n.end]=n;else if(n=r[s])if(delete r[n.start],n.unshift(t),n.start=u,i=a[u]){delete a[i.end];var l=i===n?n:i.concat(n);r[l.start=i.start]=a[l.end=n.end]=l}else r[n.start]=a[n.end]=n;else r[(n=[t]).start=u]=a[n.end=s]=n})),u(a,r),u(r,a),t.forEach((function(e){n[e<0?~e:e]||i.push([e])})),i}function kn(e){return xn(e,_n.apply(this,arguments))}function _n(e,t,n){var r,a,i;if(arguments.length>1)r=Sn(e,t,n);else for(a=0,r=new Array(i=e.arcs.length);a<i;++a)r[a]=a;return{type:"MultiLineString",arcs:wn(e,r)}}function Sn(e,t,n){var r,a=[],i=[];function o(e){var t=e<0?~e:e;(i[t]||(i[t]=[])).push({i:e,g:r})}function u(e){e.forEach(o)}function s(e){e.forEach(u)}return function e(t){switch(r=t,t.type){case"GeometryCollection":t.geometries.forEach(e);break;case"LineString":u(t.arcs);break;case"MultiLineString":case"Polygon":s(t.arcs);break;case"MultiPolygon":!function(e){e.forEach(s)}(t.arcs)}}(t),i.forEach(null==n?function(e){a.push(e[0].i)}:function(e){n(e[0].g,e[e.length-1].g)&&a.push(e[0].i)}),a}var Cn=n(9439),An=Math.sqrt(50),En=Math.sqrt(10),Nn=Math.sqrt(2);function Tn(e,t,n){var r,a,i,o=(t-e)/Math.max(0,n),u=Math.floor(Math.log10(o)),s=o/Math.pow(10,u),c=s>=An?10:s>=En?5:s>=Nn?2:1;return u<0?(i=Math.pow(10,-u)/c,(r=Math.round(e*i))/i<e&&++r,(a=Math.round(t*i))/i>t&&--a,i=-i):(i=Math.pow(10,u)*c,(r=Math.round(e/i))*i<e&&++r,(a=Math.round(t/i))*i>t&&--a),a<r&&.5<=n&&n<2?Tn(e,t,2*n):[r,a,i]}function In(e,t,n){if(!((n=+n)>0))return[];if((e=+e)===(t=+t))return[e];var r=t<e,a=r?Tn(t,e,n):Tn(e,t,n),i=(0,Cn.Z)(a,3),o=i[0],u=i[1],s=i[2];if(!(u>=o))return[];var c=u-o+1,l=new Array(c);if(r)if(s<0)for(var f=0;f<c;++f)l[f]=(u-f)/-s;else for(var d=0;d<c;++d)l[d]=(u-d)*s;else if(s<0)for(var h=0;h<c;++h)l[h]=(o+h)/-s;else for(var p=0;p<c;++p)l[p]=(o+p)*s;return l}function Dn(e,t,n){return Tn(e=+e,t=+t,n=+n)[2]}function Fn(e,t,n){n=+n;var r=(t=+t)<(e=+e),a=r?Dn(t,e,n):Dn(e,t,n);return(r?-1:1)*(a<0?1/-a:a)}var Mn,On=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Rn(e){if(!(t=On.exec(e)))throw new Error("invalid format: "+e);var t;return new jn({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}function jn(e){this.fill=void 0===e.fill?" ":e.fill+"",this.align=void 0===e.align?">":e.align+"",this.sign=void 0===e.sign?"-":e.sign+"",this.symbol=void 0===e.symbol?"":e.symbol+"",this.zero=!!e.zero,this.width=void 0===e.width?void 0:+e.width,this.comma=!!e.comma,this.precision=void 0===e.precision?void 0:+e.precision,this.trim=!!e.trim,this.type=void 0===e.type?"":e.type+""}function Bn(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,r=e.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+e.slice(n+1)]}function zn(e){return(e=Bn(Math.abs(e)))?e[1]:NaN}function Zn(e,t){var n=Bn(e,t);if(!n)return e+"";var r=n[0],a=n[1];return a<0?"0."+new Array(-a).join("0")+r:r.length>a+1?r.slice(0,a+1)+"."+r.slice(a+1):r+new Array(a-r.length+2).join("0")}Rn.prototype=jn.prototype,jn.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};var Ln={"%":function(e,t){return(100*e).toFixed(t)},b:function(e){return Math.round(e).toString(2)},c:function(e){return e+""},d:function(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)},e:function(e,t){return e.toExponential(t)},f:function(e,t){return e.toFixed(t)},g:function(e,t){return e.toPrecision(t)},o:function(e){return Math.round(e).toString(8)},p:function(e,t){return Zn(100*e,t)},r:Zn,s:function(e,t){var n=Bn(e,t);if(!n)return e+"";var r=n[0],a=n[1],i=a-(Mn=3*Math.max(-8,Math.min(8,Math.floor(a/3))))+1,o=r.length;return i===o?r:i>o?r+new Array(i-o+1).join("0"):i>0?r.slice(0,i)+"."+r.slice(i):"0."+new Array(1-i).join("0")+Bn(e,Math.max(0,t+i-1))[0]},X:function(e){return Math.round(e).toString(16).toUpperCase()},x:function(e){return Math.round(e).toString(16)}};function Pn(e){return e}var Un,Wn,Vn,qn=Array.prototype.map,Gn=["y","z","a","f","p","n","\xb5","m","","k","M","G","T","P","E","Z","Y"];function Hn(e){var t,n,r=void 0===e.grouping||void 0===e.thousands?Pn:(t=qn.call(e.grouping,Number),n=e.thousands+"",function(e,r){for(var a=e.length,i=[],o=0,u=t[0],s=0;a>0&&u>0&&(s+u+1>r&&(u=Math.max(1,r-s)),i.push(e.substring(a-=u,a+u)),!((s+=u+1)>r));)u=t[o=(o+1)%t.length];return i.reverse().join(n)}),a=void 0===e.currency?"":e.currency[0]+"",i=void 0===e.currency?"":e.currency[1]+"",o=void 0===e.decimal?".":e.decimal+"",u=void 0===e.numerals?Pn:function(e){return function(t){return t.replace(/[0-9]/g,(function(t){return e[+t]}))}}(qn.call(e.numerals,String)),s=void 0===e.percent?"%":e.percent+"",c=void 0===e.minus?"\u2212":e.minus+"",l=void 0===e.nan?"NaN":e.nan+"";function f(e){var t=(e=Rn(e)).fill,n=e.align,f=e.sign,d=e.symbol,h=e.zero,p=e.width,v=e.comma,m=e.precision,g=e.trim,y=e.type;"n"===y?(v=!0,y="g"):Ln[y]||(void 0===m&&(m=12),g=!0,y="g"),(h||"0"===t&&"="===n)&&(h=!0,t="0",n="=");var b="$"===d?a:"#"===d&&/[boxX]/.test(y)?"0"+y.toLowerCase():"",x="$"===d?i:/[%p]/.test(y)?s:"",w=Ln[y],k=/[defgprs%]/.test(y);function _(e){var a,i,s,d=b,_=x;if("c"===y)_=w(e)+_,e="";else{var S=(e=+e)<0||1/e<0;if(e=isNaN(e)?l:w(Math.abs(e),m),g&&(e=function(e){e:for(var t,n=e.length,r=1,a=-1;r<n;++r)switch(e[r]){case".":a=t=r;break;case"0":0===a&&(a=r),t=r;break;default:if(!+e[r])break e;a>0&&(a=0)}return a>0?e.slice(0,a)+e.slice(t+1):e}(e)),S&&0===+e&&"+"!==f&&(S=!1),d=(S?"("===f?f:c:"-"===f||"("===f?"":f)+d,_=("s"===y?Gn[8+Mn/3]:"")+_+(S&&"("===f?")":""),k)for(a=-1,i=e.length;++a<i;)if(48>(s=e.charCodeAt(a))||s>57){_=(46===s?o+e.slice(a+1):e.slice(a))+_,e=e.slice(0,a);break}}v&&!h&&(e=r(e,1/0));var C=d.length+e.length+_.length,A=C<p?new Array(p-C+1).join(t):"";switch(v&&h&&(e=r(A+e,A.length?p-_.length:1/0),A=""),n){case"<":e=d+e+_+A;break;case"=":e=d+A+e+_;break;case"^":e=A.slice(0,C=A.length>>1)+d+e+_+A.slice(C);break;default:e=A+d+e+_}return u(e)}return m=void 0===m?6:/[gprs]/.test(y)?Math.max(1,Math.min(21,m)):Math.max(0,Math.min(20,m)),_.toString=function(){return e+""},_}return{format:f,formatPrefix:function(e,t){var n=f(((e=Rn(e)).type="f",e)),r=3*Math.max(-8,Math.min(8,Math.floor(zn(t)/3))),a=Math.pow(10,-r),i=Gn[8+r/3];return function(e){return n(a*e)+i}}}}!function(e){Un=Hn(e),Wn=Un.format,Vn=Un.formatPrefix}({thousands:",",grouping:[3],currency:["$",""]});var Xn=n(4942),Kn=new Date,Yn=new Date;function $n(e,t,n,r){function a(t){return e(t=0===arguments.length?new Date:new Date(+t)),t}return a.floor=function(t){return e(t=new Date(+t)),t},a.ceil=function(n){return e(n=new Date(n-1)),t(n,1),e(n),n},a.round=function(e){var t=a(e),n=a.ceil(e);return e-t<n-e?t:n},a.offset=function(e,n){return t(e=new Date(+e),null==n?1:Math.floor(n)),e},a.range=function(n,r,i){var o,u=[];if(n=a.ceil(n),i=null==i?1:Math.floor(i),!(n<r)||!(i>0))return u;do{u.push(o=new Date(+n)),t(n,i),e(n)}while(o<n&&n<r);return u},a.filter=function(n){return $n((function(t){if(t>=t)for(;e(t),!n(t);)t.setTime(t-1)}),(function(e,r){if(e>=e)if(r<0)for(;++r<=0;)for(;t(e,-1),!n(e););else for(;--r>=0;)for(;t(e,1),!n(e););}))},n&&(a.count=function(t,r){return Kn.setTime(+t),Yn.setTime(+r),e(Kn),e(Yn),Math.floor(n(Kn,Yn))},a.every=function(e){return e=Math.floor(e),isFinite(e)&&e>0?e>1?a.filter(r?function(t){return r(t)%e===0}:function(t){return a.count(0,t)%e===0}):a:null}),a}var Qn=1e3,Jn=6e4,er=36e5,tr=864e5,nr=6048e5,rr=2592e6,ar=31536e6,ir=$n((function(e){return e.setHours(0,0,0,0)}),(function(e,t){return e.setDate(e.getDate()+t)}),(function(e,t){return(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*Jn)/tr}),(function(e){return e.getDate()-1})),or=(ir.range,$n((function(e){e.setUTCHours(0,0,0,0)}),(function(e,t){e.setUTCDate(e.getUTCDate()+t)}),(function(e,t){return(t-e)/tr}),(function(e){return e.getUTCDate()-1}))),ur=(or.range,$n((function(e){e.setUTCHours(0,0,0,0)}),(function(e,t){e.setUTCDate(e.getUTCDate()+t)}),(function(e,t){return(t-e)/tr}),(function(e){return Math.floor(e/tr)})));ur.range;function sr(e){return $n((function(t){t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)}),(function(e,t){e.setDate(e.getDate()+7*t)}),(function(e,t){return(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*Jn)/nr}))}var cr=sr(0),lr=sr(1),fr=sr(2),dr=sr(3),hr=sr(4),pr=sr(5),vr=sr(6);cr.range,lr.range,fr.range,dr.range,hr.range,pr.range,vr.range;function mr(e){return $n((function(t){t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)}),(function(e,t){e.setUTCDate(e.getUTCDate()+7*t)}),(function(e,t){return(t-e)/nr}))}var gr=mr(0),yr=mr(1),br=mr(2),xr=mr(3),wr=mr(4),kr=mr(5),_r=mr(6),Sr=(gr.range,yr.range,br.range,xr.range,wr.range,kr.range,_r.range,$n((function(e){e.setMonth(0,1),e.setHours(0,0,0,0)}),(function(e,t){e.setFullYear(e.getFullYear()+t)}),(function(e,t){return t.getFullYear()-e.getFullYear()}),(function(e){return e.getFullYear()})));Sr.every=function(e){return isFinite(e=Math.floor(e))&&e>0?$n((function(t){t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)}),(function(t,n){t.setFullYear(t.getFullYear()+n*e)})):null};Sr.range;var Cr=$n((function(e){e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)}),(function(e,t){e.setUTCFullYear(e.getUTCFullYear()+t)}),(function(e,t){return t.getUTCFullYear()-e.getUTCFullYear()}),(function(e){return e.getUTCFullYear()}));Cr.every=function(e){return isFinite(e=Math.floor(e))&&e>0?$n((function(t){t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)}),(function(t,n){t.setUTCFullYear(t.getUTCFullYear()+n*e)})):null};Cr.range;var Ar=$n((function(e){e.setDate(1),e.setHours(0,0,0,0)}),(function(e,t){e.setMonth(e.getMonth()+t)}),(function(e,t){return t.getMonth()-e.getMonth()+12*(t.getFullYear()-e.getFullYear())}),(function(e){return e.getMonth()})),Er=(Ar.range,$n((function(e){e.setUTCDate(1),e.setUTCHours(0,0,0,0)}),(function(e,t){e.setUTCMonth(e.getUTCMonth()+t)}),(function(e,t){return t.getUTCMonth()-e.getUTCMonth()+12*(t.getUTCFullYear()-e.getUTCFullYear())}),(function(e){return e.getUTCMonth()}))),Nr=(Er.range,$n((function(e){e.setTime(e-e.getMilliseconds()-e.getSeconds()*Qn-e.getMinutes()*Jn)}),(function(e,t){e.setTime(+e+t*er)}),(function(e,t){return(t-e)/er}),(function(e){return e.getHours()}))),Tr=(Nr.range,$n((function(e){e.setUTCMinutes(0,0,0)}),(function(e,t){e.setTime(+e+t*er)}),(function(e,t){return(t-e)/er}),(function(e){return e.getUTCHours()}))),Ir=(Tr.range,$n((function(e){e.setTime(e-e.getMilliseconds()-e.getSeconds()*Qn)}),(function(e,t){e.setTime(+e+t*Jn)}),(function(e,t){return(t-e)/Jn}),(function(e){return e.getMinutes()}))),Dr=(Ir.range,$n((function(e){e.setUTCSeconds(0,0)}),(function(e,t){e.setTime(+e+t*Jn)}),(function(e,t){return(t-e)/Jn}),(function(e){return e.getUTCMinutes()}))),Fr=(Dr.range,$n((function(e){e.setTime(e-e.getMilliseconds())}),(function(e,t){e.setTime(+e+t*Qn)}),(function(e,t){return(t-e)/Qn}),(function(e){return e.getUTCSeconds()}))),Mr=(Fr.range,$n((function(){}),(function(e,t){e.setTime(+e+t)}),(function(e,t){return t-e})));Mr.every=function(e){return e=Math.floor(e),isFinite(e)&&e>0?e>1?$n((function(t){t.setTime(Math.floor(t/e)*e)}),(function(t,n){t.setTime(+t+n*e)}),(function(t,n){return(n-t)/e})):Mr:null};Mr.range;var Or,Rr,jr,Br,zr,Zr,Lr,Pr="year",Ur="quarter",Wr="month",Vr="week",qr="date",Gr="day",Hr="dayofyear",Xr="hours",Kr="minutes",Yr="seconds",$r="milliseconds";[Pr,Ur,Wr,Vr,qr,Gr,Hr,Xr,Kr,Yr,$r].reduce((function(e,t,n){return e[t]=1+n,e}),{});Or={},(0,Xn.Z)(Or,Pr,"%Y "),(0,Xn.Z)(Or,Ur,"Q%q "),(0,Xn.Z)(Or,Wr,"%b "),(0,Xn.Z)(Or,qr,"%d "),(0,Xn.Z)(Or,Vr,"W%U "),(0,Xn.Z)(Or,Gr,"%a "),(0,Xn.Z)(Or,Hr,"%j "),(0,Xn.Z)(Or,Xr,"%H:00"),(0,Xn.Z)(Or,Kr,"00:%M"),(0,Xn.Z)(Or,Yr,":%S"),(0,Xn.Z)(Or,$r,".%L"),(0,Xn.Z)(Or,"".concat(Pr,"-").concat(Wr),"%Y-%m "),(0,Xn.Z)(Or,"".concat(Pr,"-").concat(Wr,"-").concat(qr),"%Y-%m-%d "),(0,Xn.Z)(Or,"".concat(Xr,"-").concat(Kr),"%H:%M");var Qr=new Date;function Jr(e){return Qr.setFullYear(e),Qr.setMonth(0),Qr.setDate(1),Qr.setHours(0,0,0,0),Qr}function ea(e){return ir.count(Jr(e.getFullYear())-1,e)}function ta(e){return cr.count(Jr(e.getFullYear())-1,e)}function na(e){return Jr(e).getDay()}function ra(e){var t=Date.UTC(e.getUTCFullYear(),0,1);return or.count(t-1,e)}function aa(e){var t=Date.UTC(e.getUTCFullYear(),0,1);return gr.count(t-1,e)}function ia(e){return Qr.setTime(Date.UTC(e,0,1)),Qr.getUTCDay()}function oa(e,t,n){return t+7*e-(n+6)%7}Rr={},(0,Xn.Z)(Rr,Pr,(function(e){return e.getFullYear()})),(0,Xn.Z)(Rr,Ur,(function(e){return Math.floor(e.getMonth()/3)})),(0,Xn.Z)(Rr,Wr,(function(e){return e.getMonth()})),(0,Xn.Z)(Rr,qr,(function(e){return e.getDate()})),(0,Xn.Z)(Rr,Xr,(function(e){return e.getHours()})),(0,Xn.Z)(Rr,Kr,(function(e){return e.getMinutes()})),(0,Xn.Z)(Rr,Yr,(function(e){return e.getSeconds()})),(0,Xn.Z)(Rr,$r,(function(e){return e.getMilliseconds()})),(0,Xn.Z)(Rr,Hr,(function(e){return ea(e)})),(0,Xn.Z)(Rr,Vr,(function(e){return ta(e)})),(0,Xn.Z)(Rr,Vr+Gr,(function(e,t){return oa(ta(e),e.getDay(),na(t))})),(0,Xn.Z)(Rr,Gr,(function(e,t){return oa(1,e.getDay(),na(t))})),jr={},(0,Xn.Z)(jr,Ur,(function(e){return 3*e})),(0,Xn.Z)(jr,Vr,(function(e,t){return oa(e,0,na(t))}));Br={},(0,Xn.Z)(Br,Pr,(function(e){return e.getUTCFullYear()})),(0,Xn.Z)(Br,Ur,(function(e){return Math.floor(e.getUTCMonth()/3)})),(0,Xn.Z)(Br,Wr,(function(e){return e.getUTCMonth()})),(0,Xn.Z)(Br,qr,(function(e){return e.getUTCDate()})),(0,Xn.Z)(Br,Xr,(function(e){return e.getUTCHours()})),(0,Xn.Z)(Br,Kr,(function(e){return e.getUTCMinutes()})),(0,Xn.Z)(Br,Yr,(function(e){return e.getUTCSeconds()})),(0,Xn.Z)(Br,$r,(function(e){return e.getUTCMilliseconds()})),(0,Xn.Z)(Br,Hr,(function(e){return ra(e)})),(0,Xn.Z)(Br,Vr,(function(e){return aa(e)})),(0,Xn.Z)(Br,Gr,(function(e,t){return oa(1,e.getUTCDay(),ia(t))})),(0,Xn.Z)(Br,Vr+Gr,(function(e,t){return oa(aa(e),e.getUTCDay(),ia(t))})),zr={},(0,Xn.Z)(zr,Ur,(function(e){return 3*e})),(0,Xn.Z)(zr,Vr,(function(e,t){return oa(e,0,ia(t))}));var ua=(Zr={},(0,Xn.Z)(Zr,Pr,Sr),(0,Xn.Z)(Zr,Ur,Ar.every(3)),(0,Xn.Z)(Zr,Wr,Ar),(0,Xn.Z)(Zr,Vr,cr),(0,Xn.Z)(Zr,qr,ir),(0,Xn.Z)(Zr,Gr,ir),(0,Xn.Z)(Zr,Hr,ir),(0,Xn.Z)(Zr,Xr,Nr),(0,Xn.Z)(Zr,Kr,Ir),(0,Xn.Z)(Zr,Yr,Fr),(0,Xn.Z)(Zr,$r,Mr),Zr),sa=(Lr={},(0,Xn.Z)(Lr,Pr,Cr),(0,Xn.Z)(Lr,Ur,Er.every(3)),(0,Xn.Z)(Lr,Wr,Er),(0,Xn.Z)(Lr,Vr,gr),(0,Xn.Z)(Lr,qr,or),(0,Xn.Z)(Lr,Gr,or),(0,Xn.Z)(Lr,Hr,or),(0,Xn.Z)(Lr,Xr,Tr),(0,Xn.Z)(Lr,Kr,Dr),(0,Xn.Z)(Lr,Yr,Fr),(0,Xn.Z)(Lr,$r,Mr),Lr);function ca(e){return ua[e]}function la(e){return sa[e]}var fa=[Pr,Wr,qr,Xr,Kr,Yr,$r],da=fa.slice(0,-1),ha=da.slice(0,-1),pa=ha.slice(0,-1);pa.slice(0,-1);function va(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function ma(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function ga(e,t,n){return{y:e,m:t,d:n,H:0,M:0,S:0,L:0}}function ya(e){var t=e.dateTime,n=e.date,r=e.time,a=e.periods,i=e.days,o=e.shortDays,u=e.months,s=e.shortMonths,c=Fa(a),l=Ma(a),f=Fa(i),d=Ma(i),h=Fa(o),p=Ma(o),v=Fa(u),m=Ma(u),g=Fa(s),y=Ma(s),b={a:function(e){return o[e.getDay()]},A:function(e){return i[e.getDay()]},b:function(e){return s[e.getMonth()]},B:function(e){return u[e.getMonth()]},c:null,d:ei,e:ei,f:ii,g:mi,G:yi,H:ti,I:ni,j:ri,L:ai,m:oi,M:ui,p:function(e){return a[+(e.getHours()>=12)]},q:function(e){return 1+~~(e.getMonth()/3)},Q:Pi,s:Ui,S:si,u:ci,U:li,V:di,w:hi,W:pi,x:null,X:null,y:vi,Y:gi,Z:bi,"%":Li},x={a:function(e){return o[e.getUTCDay()]},A:function(e){return i[e.getUTCDay()]},b:function(e){return s[e.getUTCMonth()]},B:function(e){return u[e.getUTCMonth()]},c:null,d:xi,e:xi,f:Ci,g:ji,G:zi,H:wi,I:ki,j:_i,L:Si,m:Ai,M:Ei,p:function(e){return a[+(e.getUTCHours()>=12)]},q:function(e){return 1+~~(e.getUTCMonth()/3)},Q:Pi,s:Ui,S:Ni,u:Ti,U:Ii,V:Fi,w:Mi,W:Oi,x:null,X:null,y:Ri,Y:Bi,Z:Zi,"%":Li},w={a:function(e,t,n){var r=h.exec(t.slice(n));return r?(e.w=p.get(r[0].toLowerCase()),n+r[0].length):-1},A:function(e,t,n){var r=f.exec(t.slice(n));return r?(e.w=d.get(r[0].toLowerCase()),n+r[0].length):-1},b:function(e,t,n){var r=g.exec(t.slice(n));return r?(e.m=y.get(r[0].toLowerCase()),n+r[0].length):-1},B:function(e,t,n){var r=v.exec(t.slice(n));return r?(e.m=m.get(r[0].toLowerCase()),n+r[0].length):-1},c:function(e,n,r){return S(e,t,n,r)},d:Va,e:Va,f:Ya,g:La,G:Za,H:Ga,I:Ga,j:qa,L:Ka,m:Wa,M:Ha,p:function(e,t,n){var r=c.exec(t.slice(n));return r?(e.p=l.get(r[0].toLowerCase()),n+r[0].length):-1},q:Ua,Q:Qa,s:Ja,S:Xa,u:Ra,U:ja,V:Ba,w:Oa,W:za,x:function(e,t,r){return S(e,n,t,r)},X:function(e,t,n){return S(e,r,t,n)},y:La,Y:Za,Z:Pa,"%":$a};function k(e,t){return function(n){var r,a,i,o=[],u=-1,s=0,c=e.length;for(n instanceof Date||(n=new Date(+n));++u<c;)37===e.charCodeAt(u)&&(o.push(e.slice(s,u)),null!=(a=Aa[r=e.charAt(++u)])?r=e.charAt(++u):a="e"===r?" ":"0",(i=t[r])&&(r=i(n,a)),o.push(r),s=u+1);return o.push(e.slice(s,u)),o.join("")}}function _(e,t){return function(n){var r,a,i=ga(1900,void 0,1);if(S(i,e,n+="",0)!=n.length)return null;if("Q"in i)return new Date(i.Q);if("s"in i)return new Date(1e3*i.s+("L"in i?i.L:0));if(t&&!("Z"in i)&&(i.Z=0),"p"in i&&(i.H=i.H%12+12*i.p),void 0===i.m&&(i.m="q"in i?i.q:0),"V"in i){if(i.V<1||i.V>53)return null;"w"in i||(i.w=1),"Z"in i?(a=(r=ma(ga(i.y,0,1))).getUTCDay(),r=a>4||0===a?yr.ceil(r):yr(r),r=or.offset(r,7*(i.V-1)),i.y=r.getUTCFullYear(),i.m=r.getUTCMonth(),i.d=r.getUTCDate()+(i.w+6)%7):(a=(r=va(ga(i.y,0,1))).getDay(),r=a>4||0===a?lr.ceil(r):lr(r),r=ir.offset(r,7*(i.V-1)),i.y=r.getFullYear(),i.m=r.getMonth(),i.d=r.getDate()+(i.w+6)%7)}else("W"in i||"U"in i)&&("w"in i||(i.w="u"in i?i.u%7:"W"in i?1:0),a="Z"in i?ma(ga(i.y,0,1)).getUTCDay():va(ga(i.y,0,1)).getDay(),i.m=0,i.d="W"in i?(i.w+6)%7+7*i.W-(a+5)%7:i.w+7*i.U-(a+6)%7);return"Z"in i?(i.H+=i.Z/100|0,i.M+=i.Z%100,ma(i)):va(i)}}function S(e,t,n,r){for(var a,i,o=0,u=t.length,s=n.length;o<u;){if(r>=s)return-1;if(37===(a=t.charCodeAt(o++))){if(a=t.charAt(o++),!(i=w[a in Aa?t.charAt(o++):a])||(r=i(e,n,r))<0)return-1}else if(a!=n.charCodeAt(r++))return-1}return r}return b.x=k(n,b),b.X=k(r,b),b.c=k(t,b),x.x=k(n,x),x.X=k(r,x),x.c=k(t,x),{format:function(e){var t=k(e+="",b);return t.toString=function(){return e},t},parse:function(e){var t=_(e+="",!1);return t.toString=function(){return e},t},utcFormat:function(e){var t=k(e+="",x);return t.toString=function(){return e},t},utcParse:function(e){var t=_(e+="",!0);return t.toString=function(){return e},t}}}var ba,xa,wa,ka,_a,Sa,Ca,Aa={"-":"",_:" ",0:"0"},Ea=/^\s*\d+/,Na=/^%/,Ta=/[\\^$*+?|[\]().{}]/g;function Ia(e,t,n){var r=e<0?"-":"",a=(r?-e:e)+"",i=a.length;return r+(i<n?new Array(n-i+1).join(t)+a:a)}function Da(e){return e.replace(Ta,"\\$&")}function Fa(e){return new RegExp("^(?:"+e.map(Da).join("|")+")","i")}function Ma(e){return new Map(e.map((function(e,t){return[e.toLowerCase(),t]})))}function Oa(e,t,n){var r=Ea.exec(t.slice(n,n+1));return r?(e.w=+r[0],n+r[0].length):-1}function Ra(e,t,n){var r=Ea.exec(t.slice(n,n+1));return r?(e.u=+r[0],n+r[0].length):-1}function ja(e,t,n){var r=Ea.exec(t.slice(n,n+2));return r?(e.U=+r[0],n+r[0].length):-1}function Ba(e,t,n){var r=Ea.exec(t.slice(n,n+2));return r?(e.V=+r[0],n+r[0].length):-1}function za(e,t,n){var r=Ea.exec(t.slice(n,n+2));return r?(e.W=+r[0],n+r[0].length):-1}function Za(e,t,n){var r=Ea.exec(t.slice(n,n+4));return r?(e.y=+r[0],n+r[0].length):-1}function La(e,t,n){var r=Ea.exec(t.slice(n,n+2));return r?(e.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function Pa(e,t,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(n,n+6));return r?(e.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function Ua(e,t,n){var r=Ea.exec(t.slice(n,n+1));return r?(e.q=3*r[0]-3,n+r[0].length):-1}function Wa(e,t,n){var r=Ea.exec(t.slice(n,n+2));return r?(e.m=r[0]-1,n+r[0].length):-1}function Va(e,t,n){var r=Ea.exec(t.slice(n,n+2));return r?(e.d=+r[0],n+r[0].length):-1}function qa(e,t,n){var r=Ea.exec(t.slice(n,n+3));return r?(e.m=0,e.d=+r[0],n+r[0].length):-1}function Ga(e,t,n){var r=Ea.exec(t.slice(n,n+2));return r?(e.H=+r[0],n+r[0].length):-1}function Ha(e,t,n){var r=Ea.exec(t.slice(n,n+2));return r?(e.M=+r[0],n+r[0].length):-1}function Xa(e,t,n){var r=Ea.exec(t.slice(n,n+2));return r?(e.S=+r[0],n+r[0].length):-1}function Ka(e,t,n){var r=Ea.exec(t.slice(n,n+3));return r?(e.L=+r[0],n+r[0].length):-1}function Ya(e,t,n){var r=Ea.exec(t.slice(n,n+6));return r?(e.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function $a(e,t,n){var r=Na.exec(t.slice(n,n+1));return r?n+r[0].length:-1}function Qa(e,t,n){var r=Ea.exec(t.slice(n));return r?(e.Q=+r[0],n+r[0].length):-1}function Ja(e,t,n){var r=Ea.exec(t.slice(n));return r?(e.s=+r[0],n+r[0].length):-1}function ei(e,t){return Ia(e.getDate(),t,2)}function ti(e,t){return Ia(e.getHours(),t,2)}function ni(e,t){return Ia(e.getHours()%12||12,t,2)}function ri(e,t){return Ia(1+ir.count(Sr(e),e),t,3)}function ai(e,t){return Ia(e.getMilliseconds(),t,3)}function ii(e,t){return ai(e,t)+"000"}function oi(e,t){return Ia(e.getMonth()+1,t,2)}function ui(e,t){return Ia(e.getMinutes(),t,2)}function si(e,t){return Ia(e.getSeconds(),t,2)}function ci(e){var t=e.getDay();return 0===t?7:t}function li(e,t){return Ia(cr.count(Sr(e)-1,e),t,2)}function fi(e){var t=e.getDay();return t>=4||0===t?hr(e):hr.ceil(e)}function di(e,t){return e=fi(e),Ia(hr.count(Sr(e),e)+(4===Sr(e).getDay()),t,2)}function hi(e){return e.getDay()}function pi(e,t){return Ia(lr.count(Sr(e)-1,e),t,2)}function vi(e,t){return Ia(e.getFullYear()%100,t,2)}function mi(e,t){return Ia((e=fi(e)).getFullYear()%100,t,2)}function gi(e,t){return Ia(e.getFullYear()%1e4,t,4)}function yi(e,t){var n=e.getDay();return Ia((e=n>=4||0===n?hr(e):hr.ceil(e)).getFullYear()%1e4,t,4)}function bi(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+Ia(t/60|0,"0",2)+Ia(t%60,"0",2)}function xi(e,t){return Ia(e.getUTCDate(),t,2)}function wi(e,t){return Ia(e.getUTCHours(),t,2)}function ki(e,t){return Ia(e.getUTCHours()%12||12,t,2)}function _i(e,t){return Ia(1+or.count(Cr(e),e),t,3)}function Si(e,t){return Ia(e.getUTCMilliseconds(),t,3)}function Ci(e,t){return Si(e,t)+"000"}function Ai(e,t){return Ia(e.getUTCMonth()+1,t,2)}function Ei(e,t){return Ia(e.getUTCMinutes(),t,2)}function Ni(e,t){return Ia(e.getUTCSeconds(),t,2)}function Ti(e){var t=e.getUTCDay();return 0===t?7:t}function Ii(e,t){return Ia(gr.count(Cr(e)-1,e),t,2)}function Di(e){var t=e.getUTCDay();return t>=4||0===t?wr(e):wr.ceil(e)}function Fi(e,t){return e=Di(e),Ia(wr.count(Cr(e),e)+(4===Cr(e).getUTCDay()),t,2)}function Mi(e){return e.getUTCDay()}function Oi(e,t){return Ia(yr.count(Cr(e)-1,e),t,2)}function Ri(e,t){return Ia(e.getUTCFullYear()%100,t,2)}function ji(e,t){return Ia((e=Di(e)).getUTCFullYear()%100,t,2)}function Bi(e,t){return Ia(e.getUTCFullYear()%1e4,t,4)}function zi(e,t){var n=e.getUTCDay();return Ia((e=n>=4||0===n?wr(e):wr.ceil(e)).getUTCFullYear()%1e4,t,4)}function Zi(){return"+0000"}function Li(){return"%"}function Pi(e){return+e}function Ui(e){return Math.floor(+e/1e3)}function Wi(e){var t={};return function(n){return t[n]||(t[n]=e(n))}}function Vi(e){var t=Wi(e.format),n=e.formatPrefix;return{format:t,formatPrefix:n,formatFloat:function(e){var n=Rn(e||",");if(null==n.precision){switch(n.precision=12,n.type){case"%":n.precision-=2;break;case"e":n.precision-=1}return function(e,t){return function(n){var r=e(n),a=r.indexOf(t);if(a<0)return r;for(var i=function(e,t){var n,r=e.lastIndexOf("e");if(r>0)return r;for(r=e.length;--r>t;)if((n=e.charCodeAt(r))>=48&&n<=57)return r+1}(r,a),o=i<r.length?r.slice(i):"";--i>a;)if("0"!==r[i]){++i;break}return r.slice(0,i)+o}}(t(n),t(".1f")(1)[1])}return t(n)},formatSpan:function(e,r,a,i){i=Rn(null==i?",f":i);var o,u=Fn(e,r,a),s=Math.max(Math.abs(e),Math.abs(r));if(null==i.precision)switch(i.type){case"s":return isNaN(o=function(e,t){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(zn(t)/3)))-zn(Math.abs(e)))}(u,s))||(i.precision=o),n(i,s);case"":case"e":case"g":case"p":case"r":isNaN(o=function(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,zn(t)-zn(e))+1}(u,s))||(i.precision=o-("e"===i.type));break;case"f":case"%":isNaN(o=function(e){return Math.max(0,-zn(Math.abs(e)))}(u))||(i.precision=o-2*("%"===i.type))}return t(i)}}}function qi(){return Sa=Vi({format:Wn,formatPrefix:Vn})}function Gi(e){return Vi(Hn(e))}function Hi(e){return arguments.length?Sa=Gi(e):Sa}function Xi(e,t,n){Kt(n=n||{})||Pt("Invalid time multi-format specifier: ".concat(n));var r=t(Yr),a=t(Kr),i=t(Xr),o=t(qr),u=t(Vr),s=t(Wr),c=t(Ur),l=t(Pr),f=e(n.milliseconds||".%L"),d=e(n.seconds||":%S"),h=e(n.minutes||"%I:%M"),p=e(n.hours||"%I %p"),v=e(n.date||n.day||"%a %d"),m=e(n.week||"%b %d"),g=e(n.month||"%B"),y=e(n.quarter||"%B"),b=e(n.year||"%Y");return function(e){return(r(e)<e?f:a(e)<e?d:i(e)<e?h:o(e)<e?p:s(e)<e?u(e)<e?v:m:l(e)<e?c(e)<e?g:y:b)(e)}}function Ki(e){var t=Wi(e.format),n=Wi(e.utcFormat);return{timeFormat:function(e){return an(e)?t(e):Xi(t,ca,e)},utcFormat:function(e){return an(e)?n(e):Xi(n,la,e)},timeParse:Wi(e.parse),utcParse:Wi(e.utcParse)}}function Yi(){return Ca=Ki({format:xa,parse:wa,utcFormat:ka,utcParse:_a})}function $i(e){return Ki(ya(e))}function Qi(e){return arguments.length?Ca=$i(e):Ca}!function(e){ba=ya(e),xa=ba.format,wa=ba.parse,ka=ba.utcFormat,_a=ba.utcParse}({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]}),qi(),Yi();var Ji=function(e,t){return en({},e,t)};function eo(e,t){var n=arguments.length;return n&&2!==n&&Pt("defaultLocale expects either zero or two arguments."),n?Ji(Hi(e),Qi(t)):Ji(Hi(),Qi())}var to=/^(data:|([A-Za-z]+:)?\/\/)/,no=/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp|file|data):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i,ro=/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205f\u3000]/g,ao="file://";function io(e,t){return oo.apply(this,arguments)}function oo(){return(oo=(0,jt.Z)(w().mark((function e(t,n){var r,a;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.sanitize(t,n);case 2:return r=e.sent,a=r.href,e.abrupt("return",r.localFile?this.file(a):this.http(a,n));case 5:case"end":return e.stop()}}),e,this)})))).apply(this,arguments)}function uo(e,t){return so.apply(this,arguments)}function so(){return so=(0,jt.Z)(w().mark((function e(t,n){var r,a,i,o,u,s,c;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=en({},this.options,n),r=this.fileAccess,a={href:null},s=no.test(t.replace(ro,"")),null!=t&&"string"===typeof t&&s||Pt("Sanitize failure, invalid URI: "+on(t)),c=to.test(t),(u=n.baseURL)&&!c&&(t.startsWith("/")||u.endsWith("/")||(t="/"+t),t=u+t),o=(i=t.startsWith(ao))||"file"===n.mode||"http"!==n.mode&&!c&&r,i?t=t.slice(ao.length):t.startsWith("//")&&("file"===n.defaultProtocol?(t=t.slice(2),o=!0):t=(n.defaultProtocol||"http")+":"+t),Object.defineProperty(a,"localFile",{value:!!o}),a.href=t,n.target&&(a.target=n.target+""),n.rel&&(a.rel=n.rel+""),"image"===n.context&&n.crossOrigin&&(a.crossOrigin=n.crossOrigin+""),e.abrupt("return",a);case 14:case"end":return e.stop()}}),e,this)}))),so.apply(this,arguments)}function co(e){return e?function(t){return new Promise((function(n,r){e.readFile(t,(function(e,t){e?r(e):n(t)}))}))}:lo}function lo(){return fo.apply(this,arguments)}function fo(){return(fo=(0,jt.Z)(w().mark((function e(){return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Pt("No file system access.");case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ho(e){return e?function(){var t=(0,jt.Z)(w().mark((function t(n,r){var a,i,o;return w().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=en({},this.options.http,r),i=r&&r.response,t.next=4,e(n,a);case 4:return o=t.sent,t.abrupt("return",o.ok?Qt(o[i])?o[i]():o.text():Pt(o.status+""+o.statusText));case 6:case"end":return t.stop()}}),t,this)})));return function(e,n){return t.apply(this,arguments)}}():po}function po(){return vo.apply(this,arguments)}function vo(){return(vo=(0,jt.Z)(w().mark((function e(){return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Pt("No HTTP fetch method available.");case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var mo=function(e){return!Number.isNaN(+e)&&!(e instanceof Date)},go={boolean:function(e){return null==e||""===e?null:!(!e||"false"===e||"0"===e)&&!!e},integer:Yt,number:Yt,date:function(e,t){return t=t||un,null==e||""===e?null:t(e)},string:function(e){return null==e||""===e?null:e+""},unknown:qt},yo=[function(e){return"true"===e||"false"===e||!0===e||!1===e},function(e){return mo(e)&&Number.isInteger(+e)},mo,function(e){return!Number.isNaN(Date.parse(e))}],bo=["boolean","integer","number","date"];function xo(e,t){return t.reduce((function(t,n){return t[n]=function(e,t){if(!e||!e.length)return"unknown";for(var n,r,a,i=e.length,o=yo.length,u=yo.map((function(e,t){return t+1})),s=0,c=0;s<i;++s)for(r=t?e[s][t]:e[s],n=0;n<o;++n)if(u[n]&&null!=(a=r)&&a===a&&!yo[n](r)&&(u[n]=0,++c===yo.length))return"string";return bo[u.reduce((function(e,t){return 0===e?t:e}),0)-1]}(e,n),t}),{})}function wo(e){var t=function(t,n){var r={delimiter:e};return ko(t,n?en(n,r):r)};return t.responseType="text",t}function ko(e,t){return t.header&&(e=t.header.map(on).join(t.delimiter)+"\n"+e),mn(t.delimiter).parse(e+"")}function _o(e,t){var n,r=t&&t.property?Wt(t.property):qt;return!Kt(e)||(n=e,"function"===typeof Buffer&&Qt(Buffer.isBuffer)&&Buffer.isBuffer(n))?r(JSON.parse(e)):function(e,t){!Xt(e)&&function(e){return e&&Qt(e[Symbol.iterator])}(e)&&(e=(0,cn.Z)(e));return t&&t.copy?JSON.parse(JSON.stringify(e)):e}(r(e),t)}ko.responseType="text",_o.responseType="json";var So={interior:function(e,t){return e!==t},exterior:function(e,t){return e===t}};function Co(e,t){var n,r,a,i;return e=_o(e,t),t&&t.feature?(n=yn,a=t.feature):t&&t.mesh?(n=kn,a=t.mesh,i=So[t.filter]):Pt("Missing TopoJSON feature or mesh parameter."),(r=(r=e.objects[a])?n(e,r,i):Pt("Invalid TopoJSON object: "+a))&&r.features||[r]}Co.responseType="json";var Ao={dsv:ko,csv:wo(","),tsv:wo("\t"),json:_o,topojson:Co};function Eo(e,t){return arguments.length>1?(Ao[e]=t,this):nn(Ao,e)?Ao[e]:null}function No(e){var t=Eo(e);return t&&t.responseType||"text"}function To(e,t,n,r){var a=Eo((t=t||{}).type||"json");return a||Pt("Unknown data format type: "+t.type),e=a(e,t),t.parse&&function(e,t,n,r){if(!e.length)return;var a=Qi();n=n||a.timeParse,r=r||a.utcParse;var i,o,u,s,c,l,f=e.columns||Object.keys(e[0]);"auto"===t&&(t=xo(e,f));var d=(f=Object.keys(t)).map((function(e){var a,i,o=t[e];if(o&&(o.startsWith("date:")||o.startsWith("utc:")))return("'"===(i=(a=o.split(/:(.+)?/,2))[1])[0]&&"'"===i[i.length-1]||'"'===i[0]&&'"'===i[i.length-1])&&(i=i.slice(1,-1)),("utc"===a[0]?r:n)(i);if(!go[o])throw Error("Illegal format pattern: "+e+":"+o);return go[o]}));for(u=0,c=e.length,l=f.length;u<c;++u)for(i=e[u],s=0;s<l;++s)i[o=f[s]]=d[s](i[o])}(e,t.parse,n,r),nn(e,"columns")&&delete e.columns,e}var Io=function(e,t){return function(n){return{options:n||{},sanitize:uo,load:io,fileAccess:!!t,file:co(t),http:ho(e)}}}("undefined"!==typeof fetch&&fetch,null);function Do(e){var t=e||qt,n=[],r={};return n.add=function(e){var a=t(e);return r[a]||(r[a]=1,n.push(e)),n},n.remove=function(e){var a=t(e);if(r[a]){r[a]=0;var i=n.indexOf(e);i>=0&&n.splice(i,1)}return n},n}function Fo(e,t){return Mo.apply(this,arguments)}function Mo(){return Mo=(0,jt.Z)(w().mark((function e(t,n){return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,n(t);case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),t.error(e.t0);case 8:case"end":return e.stop()}}),e,null,[[0,5]])}))),Mo.apply(this,arguments)}var Oo=Symbol("vega_id"),Ro=1;function jo(e){return!(!e||!Bo(e))}function Bo(e){return e[Oo]}function zo(e,t){return e[Oo]=t,e}function Zo(e){var t=e===Object(e)?e:{data:e};return Bo(t)?t:zo(t,Ro++)}function Lo(e){return Po(e,Zo({}))}function Po(e,t){for(var n in e)t[n]=e[n];return t}function Uo(e,t){return zo(t,Bo(e))}function Wo(e,t){return e?t?function(n,r){return e(n,r)||Bo(t(n))-Bo(t(r))}:function(t,n){return e(t,n)||Bo(t)-Bo(n)}:null}function Vo(e){return e&&e.constructor===qo}function qo(){var e=[],t=[],n=[],r=[],a=[],i=null,o=!1;return{constructor:qo,insert:function(t){for(var n=$t(t),r=n.length,a=0;a<r;++a)e.push(n[a]);return this},remove:function(e){for(var n=Qt(e)?r:t,a=$t(e),i=a.length,o=0;o<i;++o)n.push(a[o]);return this},modify:function(e,t,r){var i={field:t,value:Jt(r)};return Qt(e)?(i.filter=e,a.push(i)):(i.tuple=e,n.push(i)),this},encode:function(e,t){return Qt(e)?a.push({filter:e,field:t}):n.push({tuple:e,field:t}),this},clean:function(e){return i=e,this},reflow:function(){return o=!0,this},pulse:function(u,s){var c,l,f,d,h,p,v={},m={};for(c=0,l=s.length;c<l;++c)v[Bo(s[c])]=1;for(c=0,l=t.length;c<l;++c)v[Bo(h=t[c])]=-1;for(c=0,l=r.length;c<l;++c)d=r[c],s.forEach((function(e){d(e)&&(v[Bo(e)]=-1)}));for(c=0,l=e.length;c<l;++c)p=Bo(h=e[c]),v[p]?v[p]=1:u.add.push(Zo(e[c]));for(c=0,l=s.length;c<l;++c)h=s[c],v[Bo(h)]<0&&u.rem.push(h);function g(e,t,n){n?e[t]=n(e):u.encode=t,o||(m[Bo(e)]=e)}for(c=0,l=n.length;c<l;++c)h=(f=n[c]).tuple,d=f.field,(p=v[Bo(h)])>0&&(g(h,d,f.value),u.modifies(d));for(c=0,l=a.length;c<l;++c)f=a[c],d=f.filter,s.forEach((function(e){d(e)&&v[Bo(e)]>0&&g(e,f.field,f.value)})),u.modifies(f.field);if(o)u.mod=t.length||r.length?s.filter((function(e){return v[Bo(e)]>0})):s.slice();else for(p in m)u.mod.push(m[p]);return(i||null==i&&(t.length||r.length))&&u.clean(!0),u}}}var Go="_:mod:_";function Ho(){Object.defineProperty(this,Go,{writable:!0,value:{}})}Ho.prototype={set:function(e,t,n,r){var a=this,i=a[e],o=a[Go];return null!=t&&t>=0?(i[t]!==n||r)&&(i[t]=n,o[t+":"+e]=-1,o[e]=-1):(i!==n||r)&&(a[e]=n,o[e]=Xt(n)?1+n.length:-1),a},modified:function(e,t){var n=this[Go];if(!arguments.length){for(var r in n)if(n[r])return!0;return!1}if(Xt(e)){for(var a=0;a<e.length;++a)if(n[e[a]])return!0;return!1}return null!=t&&t>=0?t+1<n[e]||!!n[t+":"+e]:!!n[e]},clear:function(){return this[Go]={},this}};var Xo=0,Ko=new Ho;function Yo(e,t,n,r){this.id=++Xo,this.value=e,this.stamp=-1,this.rank=-1,this.qrank=-1,this.flags=0,t&&(this._update=t),n&&this.parameters(n,r)}function $o(e){return function(t){var n=this.flags;return 0===arguments.length?!!(n&e):(this.flags=t?n|e:n&~e,this)}}Yo.prototype={targets:function(){return this._targets||(this._targets=Do(Vt))},set:function(e){return this.value!==e?(this.value=e,1):0},skip:$o(1),modified:$o(2),parameters:function(e,t,n){var r=this;t=!1!==t;var a,i,o,u,s=this._argval=this._argval||new Ho,c=this._argops=this._argops||[],l=[],f=function(e,n,a){a instanceof Yo?(a!==r&&(t&&a.targets().add(r),l.push(a)),c.push({op:a,name:e,index:n})):s.set(e,n,a)};for(a in e)if(i=e[a],"pulse"===a)$t(i).forEach((function(e){e instanceof Yo?e!==r&&(e.targets().add(r),l.push(e)):Pt("Pulse parameters must be operator instances.")})),this.source=i;else if(Xt(i))for(s.set(a,-1,Array(o=i.length)),u=0;u<o;++u)f(a,u,i[u]);else f(a,-1,i);return this.marshall().clear(),n&&(c.initonly=!0),l},marshall:function(e){var t,n,r,a,i=this._argval||Ko,o=this._argops;if(o){var u=o.length;for(n=0;n<u;++n)a=(r=(t=o[n]).op).modified()&&r.stamp===e,i.set(t.name,t.index,r.value,a);if(o.initonly){for(n=0;n<u;++n)(t=o[n]).op.targets().remove(this);this._argops=null,this._update=null}}return i},detach:function(){var e,t,n,r=this._argops;if(r)for(e=0,t=r.length;e<t;++e)(n=r[e].op)._targets&&n._targets.remove(this);this.pulse=null,this.source=null},evaluate:function(e){var t=this._update;if(t){var n=this.marshall(e.stamp),r=t.call(this,n,e);if(n.clear(),r!==this.value)this.value=r;else if(!this.modified())return e.StopPropagation}},run:function(e){return e.stamp<this.stamp?e.StopPropagation:(this.skip()?(this.skip(!1),t=0):t=this.evaluate(e),this.pulse=t||e);var t}};var Qo=0;function Jo(e,t,n){this.id=++Qo,this.value=null,n&&(this.receive=n),e&&(this._filter=e),t&&(this._apply=t)}function eu(e,t,n){return new Jo(e,t,n)}function tu(){return tu=(0,jt.Z)(w().mark((function e(t,n){var r,a,i;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=this,a=0,e.prev=2,e.next=5,r.loader().load(t,{context:"dataflow",response:No(n&&n.type)});case 5:i=e.sent;try{i=r.parse(i,n)}catch(o){a=-2,r.warn("Data ingestion failed",t,o)}e.next=13;break;case 9:e.prev=9,e.t0=e.catch(2),a=-1,r.warn("Loading failed",t,e.t0);case 13:return e.abrupt("return",{data:i,status:a});case 14:case"end":return e.stop()}}),e,this,[[2,9]])}))),tu.apply(this,arguments)}function nu(){return nu=(0,jt.Z)(w().mark((function e(t,n,r){var a,i,o;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(i=(a=this)._pending||ru(a)).requests+=1,e.next=4,a.request(n,r);case 4:return o=e.sent,a.pulse(t,a.changeset().remove(Gt).insert(o.data||[])),i.done(),e.abrupt("return",o);case 8:case"end":return e.stop()}}),e,this)}))),nu.apply(this,arguments)}function ru(e){var t,n=new Promise((function(e){return t=e}));return n.requests=0,n.done=function(){0===--n.requests&&(e._pending=null,t(e))},e._pending=n}Jo.prototype={_filter:Gt,_apply:qt,targets:function(){return this._targets||(this._targets=Do(Vt))},consume:function(e){return arguments.length?(this._consume=!!e,this):!!this._consume},receive:function(e){if(this._filter(e)){for(var t=this.value=this._apply(e),n=this._targets,r=n?n.length:0,a=0;a<r;++a)n[a].receive(t);this._consume&&(e.preventDefault(),e.stopPropagation())}},filter:function(e){var t=eu(e);return this.targets().add(t),t},apply:function(e){var t=eu(null,e);return this.targets().add(t),t},merge:function(){var e=eu();this.targets().add(e);for(var t=0,n=arguments.length;t<n;++t)arguments[t].targets().add(e);return e},throttle:function(e){var t=-1;return this.filter((function(){var n=Date.now();return n-t>e?(t=n,1):0}))},debounce:function(e){var t=eu();return this.targets().add(eu(null,null,function(e,t){var n;return function(r){n&&clearTimeout(n),n=setTimeout((function(){return t(r),n=null}),e)}}(e,(function(e){var n=e.dataflow;t.receive(e),n&&n.run&&n.run()})))),t},between:function(e,t){var n=!1;return e.targets().add(eu(null,null,(function(){return n=!0}))),t.targets().add(eu(null,null,(function(){return n=!1}))),this.filter((function(){return n}))},detach:function(){this._filter=Gt,this._targets=null}};var au={skip:!0};function iu(e,t,n,r,a,i){var o,u,s=en({},i,au);Qt(n)||(n=Jt(n)),void 0===r?o=function(t){return e.touch(n(t))}:Qt(r)?(u=new Yo(null,r,a,!1),o=function(t){u.evaluate(t);var r=n(t),a=u.value;Vo(a)?e.pulse(r,a,i):e.update(r,a,s)}):o=function(t){return e.update(n(t),r,s)},t.apply(o)}function ou(e,t,n,r,a,i){if(void 0===r)t.targets().add(n);else{var o=i||{},u=new Yo(null,function(e,t){return t=Qt(t)?t:Jt(t),e?function(n,r){var a=t(n,r);return e.skip()||(e.skip(a!==this.value).value=a),a}:t}(n,r),a,!1);u.modified(o.force),u.rank=t.rank,t.targets().add(u),n&&(u.skip(!0),u.value=n.value,u.targets().add(n),e.connect(n,[u]))}}var uu={};function su(e,t,n){this.dataflow=e,this.stamp=null==t?-1:t,this.add=[],this.rem=[],this.mod=[],this.fields=null,this.encode=n||null}function cu(e,t){var n=[];return sn(e,t,(function(e){return n.push(e)})),n}function lu(e,t){var n={};return e.visit(t,(function(e){n[Bo(e)]=1})),function(e){return n[Bo(e)]?null:e}}function fu(e,t){return e?function(n,r){return e(n,r)&&t(n,r)}:t}function du(e,t,n,r){var a=this,i=0;this.dataflow=e,this.stamp=t,this.fields=null,this.encode=r||null,this.pulses=n;var o,u=(0,Rt.Z)(n);try{for(u.s();!(o=u.n()).done;){var s=o.value;if(s.stamp===t){if(s.fields){var c=a.fields||(a.fields={});for(var l in s.fields)c[l]=1}s.changed(a.ADD)&&(i|=a.ADD),s.changed(a.REM)&&(i|=a.REM),s.changed(a.MOD)&&(i|=a.MOD)}}}catch(f){u.e(f)}finally{u.f()}this.changes=i}function hu(){return hu=(0,jt.Z)(w().mark((function e(t,n,r){var a,i,o,u,s,c,l,f,d;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=[],!(a=this)._pulse){e.next=3;break}return e.abrupt("return",vu(a));case 3:if(!a._pending){e.next=6;break}return e.next=6,a._pending;case 6:if(!n){e.next=9;break}return e.next=9,Fo(a,n);case 9:if(a._touched.length){e.next=12;break}return a.debug("Dataflow invoked, but nothing to do."),e.abrupt("return",a);case 12:o=++a._clock,a._pulse=new su(a,o,t),a._touched.forEach((function(e){return a._enqueue(e,!0)})),a._touched=Do(Vt),u=0,e.prev=17;case 18:if(!(a._heap.size()>0)){e.next=35;break}if((s=a._heap.pop()).rank===s.qrank){e.next=23;break}return a._enqueue(s,!0),e.abrupt("continue",18);case 23:if(!(c=s.run(a._getPulse(s,t))).then){e.next=30;break}return e.next=27,c;case 27:c=e.sent,e.next=31;break;case 30:c.async&&(i.push(c.async),c=uu);case 31:c!==uu&&s._targets&&s._targets.forEach((function(e){return a._enqueue(e)})),++u,e.next=18;break;case 35:e.next=41;break;case 37:e.prev=37,e.t0=e.catch(17),a._heap.clear(),l=e.t0;case 41:if(a._input={},a._pulse=null,a.debug("Pulse ".concat(o,": ").concat(u," operators")),l&&(a._postrun=[],a.error(l)),!a._postrun.length){e.next=55;break}f=a._postrun.sort((function(e,t){return t.priority-e.priority})),a._postrun=[],d=0;case 49:if(!(d<f.length)){e.next=55;break}return e.next=52,Fo(a,f[d].callback);case 52:++d,e.next=49;break;case 55:if(!r){e.next=58;break}return e.next=58,Fo(a,r);case 58:return i.length&&Promise.all(i).then((function(e){return a.runAsync(null,(function(){e.forEach((function(e){try{e(a)}catch(t){a.error(t)}}))}))})),e.abrupt("return",a);case 60:case"end":return e.stop()}}),e,this,[[17,37]])}))),hu.apply(this,arguments)}function pu(){return pu=(0,jt.Z)(w().mark((function e(t,n,r){var a,i=this;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._running){e.next=5;break}return e.next=3,this._running;case 3:e.next=0;break;case 5:return a=function(){return i._running=null},(this._running=this.evaluate(t,n,r)).then(a,a),e.abrupt("return",this._running);case 8:case"end":return e.stop()}}),e,this)}))),pu.apply(this,arguments)}function vu(e){return e.error("Dataflow already running. Use runAsync() to chain invocations."),e}su.prototype={StopPropagation:uu,ADD:1,REM:2,MOD:4,ADD_REM:3,ADD_MOD:5,ALL:7,REFLOW:8,SOURCE:16,NO_SOURCE:32,NO_FIELDS:64,fork:function(e){return new su(this.dataflow).init(this,e)},clone:function(){var e=this.fork(7);return e.add=e.add.slice(),e.rem=e.rem.slice(),e.mod=e.mod.slice(),e.source&&(e.source=e.source.slice()),e.materialize(23)},addAll:function(){var e=this;return!e.source||e.add===e.rem||!e.rem.length&&e.source.length===e.add.length||((e=new su(this.dataflow).init(this)).add=e.source,e.rem=[]),e},init:function(e,t){var n=this;return n.stamp=e.stamp,n.encode=e.encode,!e.fields||64&t||(n.fields=e.fields),1&t?(n.addF=e.addF,n.add=e.add):(n.addF=null,n.add=[]),2&t?(n.remF=e.remF,n.rem=e.rem):(n.remF=null,n.rem=[]),4&t?(n.modF=e.modF,n.mod=e.mod):(n.modF=null,n.mod=[]),32&t?(n.srcF=null,n.source=null):(n.srcF=e.srcF,n.source=e.source,e.cleans&&(n.cleans=e.cleans)),n},runAfter:function(e){this.dataflow.runAfter(e)},changed:function(e){var t=e||7;return 1&t&&this.add.length||2&t&&this.rem.length||4&t&&this.mod.length},reflow:function(e){if(e)return this.fork(7).reflow();var t=this.add.length,n=this.source&&this.source.length;return n&&n!==t&&(this.mod=this.source,t&&this.filter(4,lu(this,1))),this},clean:function(e){return arguments.length?(this.cleans=!!e,this):this.cleans},modifies:function(e){var t=this.fields||(this.fields={});return Xt(e)?e.forEach((function(e){return t[e]=!0})):t[e]=!0,this},modified:function(e,t){var n=this.fields;return!(!t&&!this.mod.length||!n)&&(arguments.length?Xt(e)?e.some((function(e){return n[e]})):n[e]:!!n)},filter:function(e,t){var n=this;return 1&e&&(n.addF=fu(n.addF,t)),2&e&&(n.remF=fu(n.remF,t)),4&e&&(n.modF=fu(n.modF,t)),16&e&&(n.srcF=fu(n.srcF,t)),n},materialize:function(e){var t=this;return 1&(e=e||7)&&t.addF&&(t.add=cu(t.add,t.addF),t.addF=null),2&e&&t.remF&&(t.rem=cu(t.rem,t.remF),t.remF=null),4&e&&t.modF&&(t.mod=cu(t.mod,t.modF),t.modF=null),16&e&&t.srcF&&(t.source=t.source.filter(t.srcF),t.srcF=null),t},visit:function(e,t){var n=this,r=t;if(16&e)return sn(n.source,n.srcF,r),n;1&e&&sn(n.add,n.addF,r),2&e&&sn(n.rem,n.remF,r),4&e&&sn(n.mod,n.modF,r);var a=n.source;if(8&e&&a){var i=n.add.length+n.mod.length;i===a.length||sn(a,i?lu(n,5):n.srcF,r)}return n}},rn(du,su,{fork:function(e){var t=new su(this.dataflow).init(this,e&this.NO_FIELDS);return void 0!==e&&(e&t.ADD&&this.visit(t.ADD,(function(e){return t.add.push(e)})),e&t.REM&&this.visit(t.REM,(function(e){return t.rem.push(e)})),e&t.MOD&&this.visit(t.MOD,(function(e){return t.mod.push(e)}))),t},changed:function(e){return this.changes&e},modified:function(e){var t=this,n=t.fields;return n&&t.changes&t.MOD?Xt(e)?e.some((function(e){return n[e]})):n[e]:0},filter:function(){Pt("MultiPulse does not support filtering.")},materialize:function(){Pt("MultiPulse does not support materialization.")},visit:function(e,t){var n=this,r=n.pulses,a=r.length,i=0;if(e&n.SOURCE)for(;i<a;++i)r[i].visit(e,t);else for(;i<a;++i)r[i].stamp===n.stamp&&r[i].visit(e,t);return n}});var mu={skip:!1,force:!1};function gu(e){var t=[];return{clear:function(){return t=[]},size:function(){return t.length},peek:function(){return t[0]},push:function(n){return t.push(n),yu(t,0,t.length-1,e)},pop:function(){var n,r=t.pop();return t.length?(n=t[0],t[0]=r,function(e,t,n){var r,a=t,i=e.length,o=e[t],u=1+(t<<1);for(;u<i;)(r=u+1)<i&&n(e[u],e[r])>=0&&(u=r),e[t]=e[u],u=1+((t=u)<<1);e[t]=o,yu(e,a,t,n)}(t,0,e)):n=r,n}}}function yu(e,t,n,r){for(var a,i,o=e[n];n>t&&r(o,a=e[i=n-1>>1])<0;)e[n]=a,n=i;return e[n]=o}function bu(){this.logger(function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Ht,r=e||0;return{level:function(e){return arguments.length?(r=+e,this):r},error:function(){return r>=1&&n(t||"error","ERROR",arguments),this},warn:function(){return r>=2&&n(t||"warn","WARN",arguments),this},info:function(){return r>=3&&n(t||"log","INFO",arguments),this},debug:function(){return r>=4&&n(t||"log","DEBUG",arguments),this}}}()),this.logLevel(1),this._clock=0,this._rank=0,this._locale=eo();try{this._loader=Io()}catch(e){}this._touched=Do(Vt),this._input={},this._pulse=null,this._heap=gu((function(e,t){return e.qrank-t.qrank})),this._postrun=[]}function xu(e){return function(){return this._log[e].apply(this,arguments)}}function wu(e,t){Yo.call(this,e,null,t)}bu.prototype={stamp:function(){return this._clock},loader:function(e){return arguments.length?(this._loader=e,this):this._loader},locale:function(e){return arguments.length?(this._locale=e,this):this._locale},logger:function(e){return arguments.length?(this._log=e,this):this._log},error:xu("error"),warn:xu("warn"),info:xu("info"),debug:xu("debug"),logLevel:xu("level"),cleanThreshold:1e4,add:function(e,t,n,r){var a,i=1;return e instanceof Yo?a=e:e&&e.prototype instanceof Yo?a=new e:Qt(e)?a=new Yo(null,e):(i=0,a=new Yo(e,t)),this.rank(a),i&&(r=n,n=t),n&&this.connect(a,a.parameters(n,r)),this.touch(a),a},connect:function(e,t){for(var n=e.rank,r=t.length,a=0;a<r;++a)if(n<t[a].rank)return void this.rerank(e)},rank:function(e){e.rank=++this._rank},rerank:function(e){for(var t,n,r,a=[e];a.length;)if(this.rank(t=a.pop()),n=t._targets)for(r=n.length;--r>=0;)a.push(t=n[r]),t===e&&Pt("Cycle detected in dataflow graph.")},pulse:function(e,t,n){this.touch(e,n||mu);var r=new su(this,this._clock+(this._pulse?0:1)),a=e.pulse&&e.pulse.source||[];return r.target=e,this._input[e.id]=t.pulse(r,a),this},touch:function(e,t){var n=t||mu;return this._pulse?this._enqueue(e):this._touched.add(e),n.skip&&e.skip(!0),this},update:function(e,t,n){var r=n||mu;return(e.set(t)||r.force)&&this.touch(e,r),this},changeset:qo,ingest:function(e,t,n){return t=this.parse(t,n),this.pulse(e,this.changeset().insert(t))},parse:function(e,t){var n=this.locale();return To(e,t,n.timeParse,n.utcParse)},preload:function(e,t,n){return nu.apply(this,arguments)},request:function(e,t){return tu.apply(this,arguments)},events:function(e,t,n,r){for(var a,i=this,o=eu(n,r),u=function(e){e.dataflow=i;try{o.receive(e)}catch(t){i.error(t)}finally{i.run()}},s=(a="string"===typeof e&&"undefined"!==typeof document?document.querySelectorAll(e):$t(e)).length,c=0;c<s;++c)a[c].addEventListener(t,u);return o},on:function(e,t,n,r,a){return(e instanceof Yo?ou:iu)(this,e,t,n,r,a),this},evaluate:function(e,t,n){return hu.apply(this,arguments)},run:function(e,t,n){return this._pulse?vu(this):(this.evaluate(e,t,n),this)},runAsync:function(e,t,n){return pu.apply(this,arguments)},runAfter:function(e,t,n){if(this._pulse||t)this._postrun.push({priority:n||0,callback:e});else try{e(this)}catch(r){this.error(r)}},_enqueue:function(e,t){var n=e.stamp<this._clock;n&&(e.stamp=this._clock),(n||t)&&(e.qrank=e.rank,this._heap.push(e))},_getPulse:function(e,t){var n=e.source,r=this._clock;return n&&Xt(n)?new du(this,r,n.map((function(e){return e.pulse})),t):this._input[e.id]||function(e,t){if(t&&t.stamp===e.stamp)return t;e=e.fork(),t&&t!==uu&&(e.source=t.source);return e}(this._pulse,n&&n.pulse)}},rn(wu,Yo,{run:function(e){var t,n=this;return e.stamp<this.stamp?e.StopPropagation:(this.skip()?this.skip(!1):t=this.evaluate(e),(t=t||e).then?t=t.then((function(e){return n.pulse=e})):t!==e.StopPropagation&&(this.pulse=t),t)},evaluate:function(e){var t=this.marshall(e.stamp),n=this.transform(t,e);return t.clear(),n},transform:function(){}});var ku={};function _u(e){var t=Su(e);return t&&t.Definition||null}function Su(e){return e=e&&e.toLowerCase(),nn(ku,e)?ku[e]:null}function Cu(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function Au(e,t){var n;if(void 0===t){var r,a=(0,Rt.Z)(e);try{for(a.s();!(r=a.n()).done;){var i=r.value;null!=i&&(n<i||void 0===n&&i>=i)&&(n=i)}}catch(l){a.e(l)}finally{a.f()}}else{var o,u=-1,s=(0,Rt.Z)(e);try{for(s.s();!(o=s.n()).done;){var c=o.value;null!=(c=t(c,++u,e))&&(n<c||void 0===n&&c>=c)&&(n=c)}}catch(l){s.e(l)}finally{s.f()}}return n}function Eu(e,t){var n;if(void 0===t){var r,a=(0,Rt.Z)(e);try{for(a.s();!(r=a.n()).done;){var i=r.value;null!=i&&(n>i||void 0===n&&i>=i)&&(n=i)}}catch(l){a.e(l)}finally{a.f()}}else{var o,u=-1,s=(0,Rt.Z)(e);try{for(s.s();!(o=s.n()).done;){var c=o.value;null!=(c=t(c,++u,e))&&(n>c||void 0===n&&c>=c)&&(n=c)}}catch(l){s.e(l)}finally{s.f()}}return n}function Nu(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.length-1,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Cu;r>n;){if(r-n>600){var i=r-n+1,o=t-n+1,u=Math.log(i),s=.5*Math.exp(2*u/3),c=.5*Math.sqrt(u*s*(i-s)/i)*(o-i/2<0?-1:1),l=Math.max(n,Math.floor(t-o*s/i+c)),f=Math.min(r,Math.floor(t+(i-o)*s/i+c));Nu(e,t,l,f,a)}var d=e[t],h=n,p=r;for(Tu(e,n,t),a(e[r],d)>0&&Tu(e,n,r);h<p;){for(Tu(e,h,p),++h,--p;a(e[h],d)<0;)++h;for(;a(e[p],d)>0;)--p}0===a(e[n],d)?Tu(e,n,p):Tu(e,++p,r),p<=t&&(n=p+1),t<=p&&(r=p-1)}return e}function Tu(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}var Iu=w().mark(Fu);function Du(e){return null===e?NaN:+e}function Fu(e,t){var n,r,a,i,o,u,s;return w().wrap((function(c){for(;;)switch(c.prev=c.next){case 0:if(void 0!==t){c.next=21;break}n=(0,Rt.Z)(e),c.prev=2,n.s();case 4:if((r=n.n()).done){c.next=11;break}if(!(null!=(a=r.value)&&(a=+a)>=a)){c.next=9;break}return c.next=9,a;case 9:c.next=4;break;case 11:c.next=16;break;case 13:c.prev=13,c.t0=c.catch(2),n.e(c.t0);case 16:return c.prev=16,n.f(),c.finish(16);case 19:c.next=40;break;case 21:i=-1,o=(0,Rt.Z)(e),c.prev=23,o.s();case 25:if((u=o.n()).done){c.next=32;break}if(s=u.value,!(null!=(s=t(s,++i,e))&&(s=+s)>=s)){c.next=30;break}return c.next=30,s;case 30:c.next=25;break;case 32:c.next=37;break;case 34:c.prev=34,c.t1=c.catch(23),o.e(c.t1);case 37:return c.prev=37,o.f(),c.finish(37);case 40:case"end":return c.stop()}}),Iu,null,[[2,13,16,19],[23,34,37,40]])}function Mu(e,t,n){if(r=(e=Float64Array.from(Fu(e,n))).length){if((t=+t)<=0||r<2)return Eu(e);if(t>=1)return Au(e);var r,a=(r-1)*t,i=Math.floor(a),o=Au(Nu(e,i).subarray(0,i+1));return o+(Eu(e.subarray(i+1))-o)*(a-i)}}function Ou(e,t){var n=function(e,t){var n,r=0,a=0,i=0;if(void 0===t){var o,u=(0,Rt.Z)(e);try{for(u.s();!(o=u.n()).done;){var s=o.value;null!=s&&(s=+s)>=s&&(i+=(n=s-a)*(s-(a+=n/++r)))}}catch(h){u.e(h)}finally{u.f()}}else{var c,l=-1,f=(0,Rt.Z)(e);try{for(f.s();!(c=f.n()).done;){var d=c.value;null!=(d=t(d,++l,e))&&(d=+d)>=d&&(i+=(n=d-a)*(d-(a+=n/++r)))}}catch(h){f.e(h)}finally{f.f()}}if(r>1)return i/(r-1)}(e,t);return n?Math.sqrt(n):n}function Ru(e,t){return Mu(e,.5,t)}var ju=w().mark(Bu);function Bu(e,t){var n,r,a,i,o,u,s;return w().wrap((function(c){for(;;)switch(c.prev=c.next){case 0:if(null!=t){c.next=21;break}n=(0,Rt.Z)(e),c.prev=2,n.s();case 4:if((r=n.n()).done){c.next=11;break}if(!(null!=(a=r.value)&&""!==a&&(a=+a)>=a)){c.next=9;break}return c.next=9,a;case 9:c.next=4;break;case 11:c.next=16;break;case 13:c.prev=13,c.t0=c.catch(2),n.e(c.t0);case 16:return c.prev=16,n.f(),c.finish(16);case 19:c.next=41;break;case 21:i=-1,o=(0,Rt.Z)(e),c.prev=23,o.s();case 25:if((u=o.n()).done){c.next=33;break}if(s=u.value,!(null!=(s=t(s,++i,e))&&""!==s&&(s=+s)>=s)){c.next=31;break}return c.next=31,s;case 31:c.next=25;break;case 33:c.next=38;break;case 35:c.prev=35,c.t1=c.catch(23),o.e(c.t1);case 38:return c.prev=38,o.f(),c.finish(38);case 41:case"end":return c.stop()}}),ju,null,[[2,13,16,19],[23,35,38,41]])}function zu(e,t,n){var r=Float64Array.from(Bu(e,n));return r.sort(Cu),t.map((function(e){return function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Du;if(r=e.length){if((t=+t)<=0||r<2)return+n(e[0],0,e);if(t>=1)return+n(e[r-1],r-1,e);var r,a=(r-1)*t,i=Math.floor(a),o=+n(e[i],i,e);return o+(+n(e[i+1],i+1,e)-o)*(a-i)}}(r,e)}))}function Zu(e,t){return zu(e,[.25,.5,.75],t)}function Lu(e,t){var n=e.length,r=Ou(e,t),a=Zu(e,t),i=(a[2]-a[0])/1.34;return 1.06*(Math.min(r,i)||r||Math.abs(a[0])||1)*Math.pow(n,-.2)}function Pu(e){var t,n,r,a,i,o,u=e.maxbins||20,s=e.base||10,c=Math.log(s),l=e.divide||[5,2],f=e.extent[0],d=e.extent[1],h=e.span||d-f||Math.abs(f)||1;if(e.step)t=e.step;else if(e.steps){for(a=h/u,i=0,o=e.steps.length;i<o&&e.steps[i]<a;++i);t=e.steps[Math.max(0,i-1)]}else{for(n=Math.ceil(Math.log(u)/c),r=e.minstep||0,t=Math.max(r,Math.pow(s,Math.round(Math.log(h)/c)-n));Math.ceil(h/t)>u;)t*=s;for(i=0,o=l.length;i<o;++i)(a=t/l[i])>=r&&h/a<=u&&(t=a)}var p=(a=Math.log(t))>=0?0:1+~~(-a/c),v=Math.pow(s,-p-1);return(e.nice||void 0===e.nice)&&(f=f<(a=Math.floor(f/t+v)*t)?a-t:a,d=Math.ceil(d/t)*t),{start:f,stop:d===f?f+t:d,step:t}}var Uu=Math.random;function Wu(e){Uu=e}function Vu(e,t,n,r){if(!e.length)return[void 0,void 0];var a,i,o,u,s=Float64Array.from(Bu(e,r)),c=s.length,l=t;for(o=0,u=Array(l);o<l;++o){for(a=0,i=0;i<c;++i)a+=s[~~(Uu()*c)];u[o]=a/c}return u.sort(Cu),[Mu(u,n/2),Mu(u,1-n/2)]}function qu(e,t,n,r){r=r||function(e){return e};for(var a,i=e.length,o=new Float64Array(i),u=0,s=1,c=r(e[0]),l=c,f=c+t;s<i;++s){if((a=r(e[s]))>=f){for(l=(c+l)/2;u<s;++u)o[u]=l;f=a+t,c=a}l=a}for(l=(c+l)/2;u<s;++u)o[u]=l;return n?function(e,t){var n,r,a=e.length,i=0,o=1;for(;e[i]===e[o];)++o;for(;o<a;){for(n=o+1;e[o]===e[n];)++n;if(e[o]-e[o-1]<t){for(r=o+(i+n-o-o>>1);r<o;)e[r++]=e[o];for(;r>o;)e[r--]=e[i]}i=o,o=n}return e}(o,t+t/4):o}function Gu(e){return function(){return(e=(1103515245*e+12345)%2147483647)/2147483647}}function Hu(e,t){var n,r,a;null==t&&(t=e,e=0);var i={min:function(e){return arguments.length?(a=r-(n=e||0),i):n},max:function(e){return arguments.length?(a=(r=e||0)-n,i):r},sample:function(){return n+Math.floor(a*Uu())},pdf:function(e){return e===Math.floor(e)&&e>=n&&e<r?1/a:0},cdf:function(e){var t=Math.floor(e);return t<n?0:t>=r?1:(t-n+1)/a},icdf:function(e){return e>=0&&e<=1?n-1+Math.floor(e*a):NaN}};return i.min(e).max(t)}var Xu=Math.sqrt(2*Math.PI),Ku=Math.SQRT2,Yu=NaN;function $u(e,t){e=e||0,t=null==t?1:t;var n,r,a=0,i=0;if(Yu===Yu)a=Yu,Yu=NaN;else{do{n=(a=2*Uu()-1)*a+(i=2*Uu()-1)*i}while(0===n||n>1);a*=r=Math.sqrt(-2*Math.log(n)/n),Yu=i*r}return e+a*t}function Qu(e,t,n){var r=(e-(t||0))/(n=null==n?1:n);return Math.exp(-.5*r*r)/(n*Xu)}function Ju(e,t,n){var r,a=(e-(t=t||0))/(n=null==n?1:n),i=Math.abs(a);if(i>37)r=0;else{var o=Math.exp(-i*i/2);i<7.07106781186547?(r=o*((((((.0352624965998911*i+.700383064443688)*i+6.37396220353165)*i+33.912866078383)*i+112.079291497871)*i+221.213596169931)*i+220.206867912376),r/=((((((.0883883476483184*i+1.75566716318264)*i+16.064177579207)*i+86.7807322029461)*i+296.564248779674)*i+637.333633378831)*i+793.826512519948)*i+440.413735824752):r=o/(i+1/(i+2/(i+3/(i+4/(i+.65)))))/2.506628274631}return a>0?1-r:r}function es(e,t,n){return e<0||e>1?NaN:(t||0)+(null==n?1:n)*Ku*function(e){var t,n=-Math.log((1-e)*(1+e));t=n<6.25?1.6536545626831027+(t=.24015818242558962+(t=(t=(t=.00018673420803405714+(t=(t=(t=4.2347877827932404e-7+(t=(t=(t=1.0512122733215323e-9+(t=(t=(t=26335093153082323e-28+(t=(t=(t=6637638134358324e-30+(t=20972767875968562e-33+(t=(t=11157877678025181e-33+(t=128584807152564e-32+(t=(t=-364441206401782e-35)*(n-=3.125)-16850591381820166e-35)*n)*n)*n-1333171662854621e-31)*n)*n)*n-4054566272975207e-29)*n-8151934197605472e-29)*n)*n-12975133253453532e-27)*n-5415412054294628e-26)*n)*n-4.112633980346984e-9)*n-2.9070369957882005e-8)*n)*n-13654692000834679e-22)*n-13882523362786469e-21)*n)*n-.000740702534166267)*n-.006033670871430149)*n)*n:n<16?3.0838856104922208+(t=1.0052589676941592+(t=.005370914553590064+(t=(t=.002491442096107851+(t=(t=.0009532893797373805+(t=(t=24031110387097894e-21+(t=6828485145957318e-20+(t=(t=12475304481671779e-21+(t=29234449089955446e-22+(t=(t=15027403968909828e-22+(t=1.8239629214389228e-8+(t=(t=9.075656193888539e-8+(t=2.2137376921775787e-9)*(n=Math.sqrt(n)-3.25))*n-2.7517406297064545e-7)*n)*n)*n-4013867526981546e-21)*n)*n)*n-47318229009055734e-21)*n)*n)*n-.0003550375203628475)*n)*n-.0016882755560235047)*n)*n-.003751208507569241)*n)*n)*n:Number.isFinite(n)?4.849906401408584+(t=1.0103004648645344+(t=(t=(t=7599527703001776e-20+(t=(t=4526062597223154e-21+(t=(t=2.2900482228026655e-7+(t=(t=2.914795345090108e-8+(t=(t=7.61570120807834e-9+(t=(t=1.5076572693500548e-9+(t=(t=-27109920616438573e-27)*(n=Math.sqrt(n)-5)-2.555641816996525e-10)*n)*n-3.789465440126737e-9)*n)*n-1.496002662714924e-8)*n)*n-6.771199775845234e-8)*n)*n-9.9298272942317e-7)*n)*n-1968177810553167e-20)*n)*n-.00021503011930044477)*n-.00013871931833623122)*n)*n:1/0;return t*e}(2*e-1)}function ts(e,t){var n,r,a={mean:function(e){return arguments.length?(n=e||0,a):n},stdev:function(e){return arguments.length?(r=null==e?1:e,a):r},sample:function(){return $u(n,r)},pdf:function(e){return Qu(e,n,r)},cdf:function(e){return Ju(e,n,r)},icdf:function(e){return es(e,n,r)}};return a.mean(e).stdev(t)}function ns(e,t){var n=ts(),r=0,a={data:function(n){return arguments.length?(e=n,r=n?n.length:0,a.bandwidth(t)):e},bandwidth:function(n){return arguments.length?(!(t=n)&&e&&(t=Lu(e)),a):t},sample:function(){return e[~~(Uu()*r)]+t*n.sample()},pdf:function(a){for(var i=0,o=0;o<r;++o)i+=n.pdf((a-e[o])/t);return i/t/r},cdf:function(a){for(var i=0,o=0;o<r;++o)i+=n.cdf((a-e[o])/t);return i/r},icdf:function(){throw Error("KDE icdf not supported.")}};return a.data(e)}function rs(e,t){return e=e||0,t=null==t?1:t,Math.exp(e+$u()*t)}function as(e,t,n){if(e<=0)return 0;t=t||0,n=null==n?1:n;var r=(Math.log(e)-t)/n;return Math.exp(-.5*r*r)/(n*Xu*e)}function is(e,t,n){return Ju(Math.log(e),t,n)}function os(e,t,n){return Math.exp(es(e,t,n))}function us(e,t){var n,r,a={mean:function(e){return arguments.length?(n=e||0,a):n},stdev:function(e){return arguments.length?(r=null==e?1:e,a):r},sample:function(){return rs(n,r)},pdf:function(e){return as(e,n,r)},cdf:function(e){return is(e,n,r)},icdf:function(e){return os(e,n,r)}};return a.mean(e).stdev(t)}function ss(e,t){var n,r=0;function a(e){var t,n=[],a=0;for(t=0;t<r;++t)a+=n[t]=null==e[t]?1:+e[t];for(t=0;t<r;++t)n[t]/=a;return n}var i={weights:function(e){return arguments.length?(n=a(t=e||[]),i):t},distributions:function(n){return arguments.length?(n?(r=n.length,e=n):(r=0,e=[]),i.weights(t)):e},sample:function(){for(var t=Uu(),a=e[r-1],i=n[0],o=0;o<r-1;i+=n[++o])if(t<i){a=e[o];break}return a.sample()},pdf:function(t){for(var a=0,i=0;i<r;++i)a+=n[i]*e[i].pdf(t);return a},cdf:function(t){for(var a=0,i=0;i<r;++i)a+=n[i]*e[i].cdf(t);return a},icdf:function(){throw Error("Mixture icdf not supported.")}};return i.distributions(e).weights(t)}function cs(e,t){return null==t&&(t=null==e?1:e,e=0),e+(t-e)*Uu()}function ls(e,t,n){return null==n&&(n=null==t?1:t,t=0),e>=t&&e<=n?1/(n-t):0}function fs(e,t,n){return null==n&&(n=null==t?1:t,t=0),e<t?0:e>n?1:(e-t)/(n-t)}function ds(e,t,n){return null==n&&(n=null==t?1:t,t=0),e>=0&&e<=1?t+e*(n-t):NaN}function hs(e,t){var n,r,a={min:function(e){return arguments.length?(n=e||0,a):n},max:function(e){return arguments.length?(r=null==e?1:e,a):r},sample:function(){return cs(n,r)},pdf:function(e){return ls(e,n,r)},cdf:function(e){return fs(e,n,r)},icdf:function(e){return ds(e,n,r)}};return null==t&&(t=null==e?1:e,e=0),a.min(e).max(t)}function ps(e,t,n,r){var a=r-e*e,i=Math.abs(a)<1e-24?0:(n-e*t)/a;return[t-i*e,i]}function vs(e,t,n,r){e=e.filter((function(e){var r=t(e),a=n(e);return null!=r&&(r=+r)>=r&&null!=a&&(a=+a)>=a})),r&&e.sort((function(e,n){return t(e)-t(n)}));var a,i,o,u,s=e.length,c=new Float64Array(s),l=new Float64Array(s),f=0,d=0,h=0,p=(0,Rt.Z)(e);try{for(p.s();!(u=p.n()).done;)o=u.value,c[f]=a=+t(o),l[f]=i=+n(o),d+=(a-d)/++f,h+=(i-h)/f}catch(v){p.e(v)}finally{p.f()}for(f=0;f<s;++f)c[f]-=d,l[f]-=h;return[c,l,d,h]}function ms(e,t,n,r){var a,i,o,u=-1,s=(0,Rt.Z)(e);try{for(s.s();!(o=s.n()).done;){var c=o.value;a=t(c),i=n(c),null!=a&&(a=+a)>=a&&null!=i&&(i=+i)>=i&&r(a,i,++u)}}catch(l){s.e(l)}finally{s.f()}}function gs(e,t,n,r,a){var i=0,o=0;return ms(e,t,n,(function(e,t){var n=t-a(e),u=t-r;i+=n*n,o+=u*u})),1-i/o}function ys(e,t,n){var r=0,a=0,i=0,o=0,u=0;ms(e,t,n,(function(e,t){++u,r+=(e-r)/u,a+=(t-a)/u,i+=(e*t-i)/u,o+=(e*e-o)/u}));var s=ps(r,a,i,o),c=function(e){return s[0]+s[1]*e};return{coef:s,predict:c,rSquared:gs(e,t,n,a,c)}}function bs(e,t,n){var r=0,a=0,i=0,o=0,u=0;ms(e,t,n,(function(e,t){++u,e=Math.log(e),r+=(e-r)/u,a+=(t-a)/u,i+=(e*t-i)/u,o+=(e*e-o)/u}));var s=ps(r,a,i,o),c=function(e){return s[0]+s[1]*Math.log(e)};return{coef:s,predict:c,rSquared:gs(e,t,n,a,c)}}function xs(e,t,n){var r,a,i,o=vs(e,t,n),u=(0,Cn.Z)(o,4),s=u[0],c=(u[1],u[2]),l=u[3],f=0,d=0,h=0,p=0,v=0;ms(e,t,n,(function(e,t){r=s[v++],a=Math.log(t),f+=(t*a-f)/v,d+=((i=r*t)-d)/v,h+=(i*a-h)/v,p+=(r*i-p)/v}));var m=ps(d/l,f/l,h/l,p/l),g=(0,Cn.Z)(m,2),y=g[0],b=g[1],x=function(e){return Math.exp(y+b*(e-c))};return{coef:[Math.exp(y-b*c),b],predict:x,rSquared:gs(e,t,n,l,x)}}function ws(e,t,n){var r=0,a=0,i=0,o=0,u=0,s=0;ms(e,t,n,(function(e,t){var n=Math.log(e),c=Math.log(t);++s,r+=(n-r)/s,a+=(c-a)/s,i+=(n*c-i)/s,o+=(n*n-o)/s,u+=(t-u)/s}));var c=ps(r,a,i,o),l=function(e){return c[0]*Math.pow(e,c[1])};return c[0]=Math.exp(c[0]),{coef:c,predict:l,rSquared:gs(e,t,n,u,l)}}function ks(e,t,n){var r,a,i,o,u=vs(e,t,n),s=(0,Cn.Z)(u,4),c=s[0],l=s[1],f=s[2],d=s[3],h=c.length,p=0,v=0,m=0,g=0,y=0;for(r=0;r<h;)a=c[r],i=l[r++],p+=((o=a*a)-p)/r,v+=(o*a-v)/r,m+=(o*o-m)/r,g+=(a*i-g)/r,y+=(o*i-y)/r;var b=m-p*p,x=p*b-v*v,w=(y*p-g*v)/x,k=(g*b-y*v)/x,_=-w*p,S=function(e){return w*(e-=f)*e+k*e+_+d};return{coef:[_-k*f+w*f*f+d,k-2*w*f,w],predict:S,rSquared:gs(e,t,n,d,S)}}function _s(e,t,n,r){if(1===r)return ys(e,t,n);if(2===r)return ks(e,t,n);var a,i,o,u,s,c=vs(e,t,n),l=(0,Cn.Z)(c,4),f=l[0],d=l[1],h=l[2],p=l[3],v=f.length,m=[],g=[],y=r+1;for(a=0;a<y;++a){for(o=0,u=0;o<v;++o)u+=Math.pow(f[o],a)*d[o];for(m.push(u),s=new Float64Array(y),i=0;i<y;++i){for(o=0,u=0;o<v;++o)u+=Math.pow(f[o],a+i);s[i]=u}g.push(s)}g.push(m);var b=function(e){var t,n,r,a,i,o=e.length-1,u=[];for(t=0;t<o;++t){for(a=t,n=t+1;n<o;++n)Math.abs(e[t][n])>Math.abs(e[t][a])&&(a=n);for(r=t;r<o+1;++r)i=e[r][t],e[r][t]=e[r][a],e[r][a]=i;for(n=t+1;n<o;++n)for(r=o;r>=t;r--)e[r][n]-=e[r][t]*e[t][n]/e[t][t]}for(n=o-1;n>=0;--n){for(i=0,r=n+1;r<o;++r)i+=e[r][n]*u[r];u[n]=(e[o][n]-i)/e[n][n]}return u}(g),x=function(e){e-=h;var t=p+b[0]+b[1]*e+b[2]*e*e;for(a=3;a<y;++a)t+=b[a]*Math.pow(e,a);return t};return{coef:Ss(y,b,-h,p),predict:x,rSquared:gs(e,t,n,p,x)}}function Ss(e,t,n,r){var a,i,o,u,s=Array(e);for(a=0;a<e;++a)s[a]=0;for(a=e-1;a>=0;--a)for(o=t[a],u=1,s[a]+=o,i=1;i<=a;++i)u*=(a+1-i)/i,s[a-i]+=o*Math.pow(n,i)*u;return s[0]+=r,s}function Cs(e,t,n,r){for(var a=vs(e,t,n,!0),i=(0,Cn.Z)(a,4),o=i[0],u=i[1],s=i[2],c=i[3],l=o.length,f=Math.max(2,~~(r*l)),d=new Float64Array(l),h=new Float64Array(l),p=new Float64Array(l).fill(1),v=-1;++v<=2;){for(var m=[0,f-1],g=0;g<l;++g){for(var y=o[g],b=m[0],x=m[1],w=y-o[b]>o[x]-y?b:x,k=0,_=0,S=0,C=0,A=0,E=1/Math.abs(o[w]-y||1),N=b;N<=x;++N){var T=o[N],I=u[N],D=As(Math.abs(y-T)*E)*p[N],F=T*D;k+=D,_+=F,S+=I*D,C+=I*F,A+=T*F}var M=ps(_/k,S/k,C/k,A/k),O=(0,Cn.Z)(M,2),R=O[0],j=O[1];d[g]=R+j*y,h[g]=Math.abs(u[g]-d[g]),Es(o,g+1,m)}if(2===v)break;var B=Ru(h);if(Math.abs(B)<1e-12)break;for(var z,Z,L=0;L<l;++L)z=h[L]/(6*B),p[L]=z>=1?1e-12:(Z=1-z*z)*Z}return function(e,t,n,r){for(var a,i=e.length,o=[],u=0,s=0,c=[];u<i;++u)a=e[u]+n,c[0]===a?c[1]+=(t[u]-c[1])/++s:(s=0,c[1]+=r,c=[a,t[u]],o.push(c));return c[1]+=r,o}(o,d,s,c)}function As(e){return(e=1-e*e*e)*e*e}function Es(e,t,n){var r=e[t],a=n[0],i=n[1]+1;if(!(i>=e.length))for(;t>a&&e[i]-r<=r-e[a];)n[0]=++a,n[1]=i,++i}var Ns=.5*Math.PI/180;function Ts(e,t,n,r){n=n||25,r=Math.max(n,r||200);var a=function(t){return[t,e(t)]},i=t[0],o=t[1],u=o-i,s=u/r,c=[a(i)],l=[];if(n===r){for(var f=1;f<r;++f)c.push(a(i+f/n*u));return c.push(a(o)),c}l.push(a(o));for(var d=n;--d>0;)l.push(a(i+d/n*u));for(var h=c[0],p=l[l.length-1],v=1/u,m=function(e,t){for(var n=e,r=e,a=t.length,i=0;i<a;++i){var o=t[i][1];o<n&&(n=o),o>r&&(r=o)}return 1/(r-n)}(h[1],l);p;){var g=a((h[0]+p[0])/2);g[0]-h[0]>=s&&Is(h,g,p,v,m)>Ns?l.push(g):(h=p,c.push(p),l.pop()),p=l[l.length-1]}return c}function Is(e,t,n,r,a){var i=Math.atan2(a*(n[1]-e[1]),r*(n[0]-e[0])),o=Math.atan2(a*(t[1]-e[1]),r*(t[0]-e[0]));return Math.abs(i-o)}function Ds(e,t){var n;if(void 0===t){var r,a=(0,Rt.Z)(e);try{for(a.s();!(r=a.n()).done;){var i=r.value;null!=i&&(n<i||void 0===n&&i>=i)&&(n=i)}}catch(l){a.e(l)}finally{a.f()}}else{var o,u=-1,s=(0,Rt.Z)(e);try{for(s.s();!(o=s.n()).done;){var c=o.value;null!=(c=t(c,++u,e))&&(n<c||void 0===n&&c>=c)&&(n=c)}}catch(l){s.e(l)}finally{s.f()}}return n}function Fs(e,t){var n;if(void 0===t){var r,a=(0,Rt.Z)(e);try{for(a.s();!(r=a.n()).done;){var i=r.value;null!=i&&(n>i||void 0===n&&i>=i)&&(n=i)}}catch(l){a.e(l)}finally{a.f()}}else{var o,u=-1,s=(0,Rt.Z)(e);try{for(s.s();!(o=s.n()).done;){var c=o.value;null!=(c=t(c,++u,e))&&(n>c||void 0===n&&c>=c)&&(n=c)}}catch(l){s.e(l)}finally{s.f()}}return n}function Ms(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function Os(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.length-1,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Ms;r>n;){if(r-n>600){var i=r-n+1,o=t-n+1,u=Math.log(i),s=.5*Math.exp(2*u/3),c=.5*Math.sqrt(u*s*(i-s)/i)*(o-i/2<0?-1:1),l=Math.max(n,Math.floor(t-o*s/i+c)),f=Math.min(r,Math.floor(t+(i-o)*s/i+c));Os(e,t,l,f,a)}var d=e[t],h=n,p=r;for(Rs(e,n,t),a(e[r],d)>0&&Rs(e,n,r);h<p;){for(Rs(e,h,p),++h,--p;a(e[h],d)<0;)++h;for(;a(e[p],d)>0;)--p}0===a(e[n],d)?Rs(e,n,p):Rs(e,++p,r),p<=t&&(n=p+1),t<=p&&(r=p-1)}return e}function Rs(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}var js=w().mark(Bs);function Bs(e,t){var n,r,a,i,o,u,s;return w().wrap((function(c){for(;;)switch(c.prev=c.next){case 0:if(void 0!==t){c.next=21;break}n=(0,Rt.Z)(e),c.prev=2,n.s();case 4:if((r=n.n()).done){c.next=11;break}if(!(null!=(a=r.value)&&(a=+a)>=a)){c.next=9;break}return c.next=9,a;case 9:c.next=4;break;case 11:c.next=16;break;case 13:c.prev=13,c.t0=c.catch(2),n.e(c.t0);case 16:return c.prev=16,n.f(),c.finish(16);case 19:c.next=40;break;case 21:i=-1,o=(0,Rt.Z)(e),c.prev=23,o.s();case 25:if((u=o.n()).done){c.next=32;break}if(s=u.value,!(null!=(s=t(s,++i,e))&&(s=+s)>=s)){c.next=30;break}return c.next=30,s;case 30:c.next=25;break;case 32:c.next=37;break;case 34:c.prev=34,c.t1=c.catch(23),o.e(c.t1);case 37:return c.prev=37,o.f(),c.finish(37);case 40:case"end":return c.stop()}}),js,null,[[2,13,16,19],[23,34,37,40]])}function zs(e,t,n){if(r=(e=Float64Array.from(Bs(e,n))).length){if((t=+t)<=0||r<2)return Fs(e);if(t>=1)return Ds(e);var r,a=(r-1)*t,i=Math.floor(a),o=Ds(Os(e,i).subarray(0,i+1));return o+(Fs(e.subarray(i+1))-o)*(a-i)}}function Zs(e,t,n){e=+e,t=+t,n=(a=arguments.length)<2?(t=e,e=0,1):a<3?1:+n;for(var r=-1,a=0|Math.max(0,Math.ceil((t-e)/n)),i=new Array(a);++r<a;)i[r]=e+r*n;return i}function Ls(e){var t=e,n=e;function r(e,t,r,a){for(null==r&&(r=0),null==a&&(a=e.length);r<a;){var i=r+a>>>1;n(e[i],t)<0?r=i+1:a=i}return r}return 1===e.length&&(t=function(t,n){return e(t)-n},n=function(e){return function(t,n){return Ms(e(t),n)}}(e)),{left:r,center:function(e,n,a,i){null==a&&(a=0),null==i&&(i=e.length);var o=r(e,n,a,i-1);return o>a&&t(e[o-1],n)>-t(e[o],n)?o-1:o},right:function(e,t,r,a){for(null==r&&(r=0),null==a&&(a=e.length);r<a;){var i=r+a>>>1;n(e[i],t)>0?a=i:r=i+1}return r}}}var Ps=new Date,Us=new Date;function Ws(e,t,n,r){function a(t){return e(t=0===arguments.length?new Date:new Date(+t)),t}return a.floor=function(t){return e(t=new Date(+t)),t},a.ceil=function(n){return e(n=new Date(n-1)),t(n,1),e(n),n},a.round=function(e){var t=a(e),n=a.ceil(e);return e-t<n-e?t:n},a.offset=function(e,n){return t(e=new Date(+e),null==n?1:Math.floor(n)),e},a.range=function(n,r,i){var o,u=[];if(n=a.ceil(n),i=null==i?1:Math.floor(i),!(n<r)||!(i>0))return u;do{u.push(o=new Date(+n)),t(n,i),e(n)}while(o<n&&n<r);return u},a.filter=function(n){return Ws((function(t){if(t>=t)for(;e(t),!n(t);)t.setTime(t-1)}),(function(e,r){if(e>=e)if(r<0)for(;++r<=0;)for(;t(e,-1),!n(e););else for(;--r>=0;)for(;t(e,1),!n(e););}))},n&&(a.count=function(t,r){return Ps.setTime(+t),Us.setTime(+r),e(Ps),e(Us),Math.floor(n(Ps,Us))},a.every=function(e){return e=Math.floor(e),isFinite(e)&&e>0?e>1?a.filter(r?function(t){return r(t)%e===0}:function(t){return a.count(0,t)%e===0}):a:null}),a}var Vs=1e3,qs=6e4,Gs=36e5,Hs=864e5,Xs=6048e5,Ks=Ws((function(e){return e.setHours(0,0,0,0)}),(function(e,t){return e.setDate(e.getDate()+t)}),(function(e,t){return(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*qs)/Hs}),(function(e){return e.getDate()-1})),Ys=Ks;Ks.range;function $s(e){return Ws((function(t){t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)}),(function(e,t){e.setDate(e.getDate()+7*t)}),(function(e,t){return(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*qs)/Xs}))}var Qs=$s(0),Js=$s(1),ec=$s(2),tc=$s(3),nc=$s(4),rc=$s(5),ac=$s(6),ic=(Qs.range,Js.range,ec.range,tc.range,nc.range,rc.range,ac.range,Ws((function(e){e.setUTCHours(0,0,0,0)}),(function(e,t){e.setUTCDate(e.getUTCDate()+t)}),(function(e,t){return(t-e)/Hs}),(function(e){return e.getUTCDate()-1}))),oc=ic;ic.range;function uc(e){return Ws((function(t){t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)}),(function(e,t){e.setUTCDate(e.getUTCDate()+7*t)}),(function(e,t){return(t-e)/Xs}))}var sc=uc(0),cc=uc(1),lc=uc(2),fc=uc(3),dc=uc(4),hc=uc(5),pc=uc(6),vc=(sc.range,cc.range,lc.range,fc.range,dc.range,hc.range,pc.range,Ws((function(e){e.setMonth(0,1),e.setHours(0,0,0,0)}),(function(e,t){e.setFullYear(e.getFullYear()+t)}),(function(e,t){return t.getFullYear()-e.getFullYear()}),(function(e){return e.getFullYear()})));vc.every=function(e){return isFinite(e=Math.floor(e))&&e>0?Ws((function(t){t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)}),(function(t,n){t.setFullYear(t.getFullYear()+n*e)})):null};var mc=vc,gc=(vc.range,Ws((function(e){e.setDate(1),e.setHours(0,0,0,0)}),(function(e,t){e.setMonth(e.getMonth()+t)}),(function(e,t){return t.getMonth()-e.getMonth()+12*(t.getFullYear()-e.getFullYear())}),(function(e){return e.getMonth()}))),yc=gc,bc=(gc.range,Ws((function(e){e.setTime(e-e.getMilliseconds()-e.getSeconds()*Vs-e.getMinutes()*qs)}),(function(e,t){e.setTime(+e+t*Gs)}),(function(e,t){return(t-e)/Gs}),(function(e){return e.getHours()}))),xc=bc,wc=(bc.range,Ws((function(e){e.setTime(e-e.getMilliseconds()-e.getSeconds()*Vs)}),(function(e,t){e.setTime(+e+t*qs)}),(function(e,t){return(t-e)/qs}),(function(e){return e.getMinutes()}))),kc=wc,_c=(wc.range,Ws((function(e){e.setTime(e-e.getMilliseconds())}),(function(e,t){e.setTime(+e+t*Vs)}),(function(e,t){return(t-e)/Vs}),(function(e){return e.getUTCSeconds()}))),Sc=_c,Cc=(_c.range,Ws((function(){}),(function(e,t){e.setTime(+e+t)}),(function(e,t){return t-e})));Cc.every=function(e){return e=Math.floor(e),isFinite(e)&&e>0?e>1?Ws((function(t){t.setTime(Math.floor(t/e)*e)}),(function(t,n){t.setTime(+t+n*e)}),(function(t,n){return(n-t)/e})):Cc:null};var Ac=Cc,Ec=(Cc.range,Ws((function(e){e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)}),(function(e,t){e.setUTCFullYear(e.getUTCFullYear()+t)}),(function(e,t){return t.getUTCFullYear()-e.getUTCFullYear()}),(function(e){return e.getUTCFullYear()})));Ec.every=function(e){return isFinite(e=Math.floor(e))&&e>0?Ws((function(t){t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)}),(function(t,n){t.setUTCFullYear(t.getUTCFullYear()+n*e)})):null};var Nc=Ec,Tc=(Ec.range,Ws((function(e){e.setUTCDate(1),e.setUTCHours(0,0,0,0)}),(function(e,t){e.setUTCMonth(e.getUTCMonth()+t)}),(function(e,t){return t.getUTCMonth()-e.getUTCMonth()+12*(t.getUTCFullYear()-e.getUTCFullYear())}),(function(e){return e.getUTCMonth()}))),Ic=Tc,Dc=(Tc.range,Ws((function(e){e.setUTCMinutes(0,0,0)}),(function(e,t){e.setTime(+e+t*Gs)}),(function(e,t){return(t-e)/Gs}),(function(e){return e.getUTCHours()}))),Fc=Dc,Mc=(Dc.range,Ws((function(e){e.setUTCSeconds(0,0)}),(function(e,t){e.setTime(+e+t*qs)}),(function(e,t){return(t-e)/qs}),(function(e){return e.getUTCMinutes()}))),Oc=Mc;Mc.range;function Rc(e){var t=e,n=e;function r(e,t,r,a){for(null==r&&(r=0),null==a&&(a=e.length);r<a;){var i=r+a>>>1;n(e[i],t)<0?r=i+1:a=i}return r}return 1===e.length&&(t=function(t,n){return e(t)-n},n=function(e){return function(t,n){return function(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}(e(t),n)}}(e)),{left:r,center:function(e,n,a,i){null==a&&(a=0),null==i&&(i=e.length);var o=r(e,n,a,i-1);return o>a&&t(e[o-1],n)>-t(e[o],n)?o-1:o},right:function(e,t,r,a){for(null==r&&(r=0),null==a&&(a=e.length);r<a;){var i=r+a>>>1;n(e[i],t)>0?a=i:r=i+1}return r}}}var jc,Bc,zc,Zc,Lc,Pc,Uc,Wc=Math.sqrt(50),Vc=Math.sqrt(10),qc=Math.sqrt(2);function Gc(e,t,n){var r=Math.abs(t-e)/Math.max(0,n),a=Math.pow(10,Math.floor(Math.log(r)/Math.LN10)),i=r/a;return i>=Wc?a*=10:i>=Vc?a*=5:i>=qc&&(a*=2),t<e?-a:a}var Hc="year",Xc="quarter",Kc="month",Yc="week",$c="date",Qc="day",Jc="dayofyear",el="hours",tl="minutes",nl="seconds",rl="milliseconds",al=[Hc,Xc,Kc,Yc,$c,Qc,Jc,el,tl,nl,rl],il=al.reduce((function(e,t,n){return e[t]=1+n,e}),{});function ol(e){var t=Xe(e).slice(),n={};return t.length||ue("Missing time unit."),t.forEach((function(e){st(il,e)?n[e]=1:ue("Invalid time unit: ".concat(e,"."))})),(n[Yc]||n[Qc]?1:0)+(n[Xc]||n[Kc]||n[$c]?1:0)+(n[Jc]?1:0)>1&&ue("Incompatible time units: ".concat(e)),t.sort((function(e,t){return il[e]-il[t]})),t}var ul=(jc={},(0,Xn.Z)(jc,Hc,"%Y "),(0,Xn.Z)(jc,Xc,"Q%q "),(0,Xn.Z)(jc,Kc,"%b "),(0,Xn.Z)(jc,$c,"%d "),(0,Xn.Z)(jc,Yc,"W%U "),(0,Xn.Z)(jc,Qc,"%a "),(0,Xn.Z)(jc,Jc,"%j "),(0,Xn.Z)(jc,el,"%H:00"),(0,Xn.Z)(jc,tl,"00:%M"),(0,Xn.Z)(jc,nl,":%S"),(0,Xn.Z)(jc,rl,".%L"),(0,Xn.Z)(jc,"".concat(Hc,"-").concat(Kc),"%Y-%m "),(0,Xn.Z)(jc,"".concat(Hc,"-").concat(Kc,"-").concat($c),"%Y-%m-%d "),(0,Xn.Z)(jc,"".concat(el,"-").concat(tl),"%H:%M"),jc);function sl(e,t){var n,r,a=at({},ul,t),i=ol(e),o=i.length,u="",s=0;for(s=0;s<o;)for(n=i.length;n>s;--n)if(null!=a[r=i.slice(s,n).join("-")]){u+=a[r],s=n;break}return u.trim()}var cl=new Date;function ll(e){return cl.setFullYear(e),cl.setMonth(0),cl.setDate(1),cl.setHours(0,0,0,0),cl}function fl(e){return hl(new Date(e))}function dl(e){return pl(new Date(e))}function hl(e){return Ys.count(ll(e.getFullYear())-1,e)}function pl(e){return Qs.count(ll(e.getFullYear())-1,e)}function vl(e){return ll(e).getDay()}function ml(e,t,n,r,a,i,o){if(0<=e&&e<100){var u=new Date(-1,t,n,r,a,i,o);return u.setFullYear(e),u}return new Date(e,t,n,r,a,i,o)}function gl(e){return bl(new Date(e))}function yl(e){return xl(new Date(e))}function bl(e){var t=Date.UTC(e.getUTCFullYear(),0,1);return oc.count(t-1,e)}function xl(e){var t=Date.UTC(e.getUTCFullYear(),0,1);return sc.count(t-1,e)}function wl(e){return cl.setTime(Date.UTC(e,0,1)),cl.getUTCDay()}function kl(e,t,n,r,a,i,o){if(0<=e&&e<100){var u=new Date(Date.UTC(-1,t,n,r,a,i,o));return u.setUTCFullYear(n.y),u}return new Date(Date.UTC(e,t,n,r,a,i,o))}function _l(e,t,n,r,a){var i=t||1,o=Te(e),u=function(e,t,a){return function(e,t,n,r){var a=n<=1?e:r?function(t,a){return r+n*Math.floor((e(t,a)-r)/n)}:function(t,r){return n*Math.floor(e(t,r)/n)};return t?function(e,n){return t(a(e,n),n)}:a}(n[a=a||e],r[a],e===o&&i,t)},s=new Date,c=Ft(e),l=c[Hc]?u(Hc):nt(2012),f=c[Kc]?u(Kc):c[Xc]?u(Xc):de,d=c[Yc]&&c[Qc]?u(Qc,1,Yc+Qc):c[Yc]?u(Yc,1):c[Qc]?u(Qc,1):c[$c]?u($c,1):c[Jc]?u(Jc,1):he,h=c[el]?u(el):de,p=c[tl]?u(tl):de,v=c[nl]?u(nl):de,m=c[rl]?u(rl):de;return function(e){s.setTime(+e);var t=l(s);return a(t,f(s),d(s,t),h(s),p(s),v(s),m(s))}}function Sl(e,t,n){return t+7*e-(n+6)%7}var Cl=(Bc={},(0,Xn.Z)(Bc,Hc,(function(e){return e.getFullYear()})),(0,Xn.Z)(Bc,Xc,(function(e){return Math.floor(e.getMonth()/3)})),(0,Xn.Z)(Bc,Kc,(function(e){return e.getMonth()})),(0,Xn.Z)(Bc,$c,(function(e){return e.getDate()})),(0,Xn.Z)(Bc,el,(function(e){return e.getHours()})),(0,Xn.Z)(Bc,tl,(function(e){return e.getMinutes()})),(0,Xn.Z)(Bc,nl,(function(e){return e.getSeconds()})),(0,Xn.Z)(Bc,rl,(function(e){return e.getMilliseconds()})),(0,Xn.Z)(Bc,Jc,(function(e){return hl(e)})),(0,Xn.Z)(Bc,Yc,(function(e){return pl(e)})),(0,Xn.Z)(Bc,Yc+Qc,(function(e,t){return Sl(pl(e),e.getDay(),vl(t))})),(0,Xn.Z)(Bc,Qc,(function(e,t){return Sl(1,e.getDay(),vl(t))})),Bc),Al=(zc={},(0,Xn.Z)(zc,Xc,(function(e){return 3*e})),(0,Xn.Z)(zc,Yc,(function(e,t){return Sl(e,0,vl(t))})),zc);function El(e,t){return _l(e,t||1,Cl,Al,ml)}var Nl=(Zc={},(0,Xn.Z)(Zc,Hc,(function(e){return e.getUTCFullYear()})),(0,Xn.Z)(Zc,Xc,(function(e){return Math.floor(e.getUTCMonth()/3)})),(0,Xn.Z)(Zc,Kc,(function(e){return e.getUTCMonth()})),(0,Xn.Z)(Zc,$c,(function(e){return e.getUTCDate()})),(0,Xn.Z)(Zc,el,(function(e){return e.getUTCHours()})),(0,Xn.Z)(Zc,tl,(function(e){return e.getUTCMinutes()})),(0,Xn.Z)(Zc,nl,(function(e){return e.getUTCSeconds()})),(0,Xn.Z)(Zc,rl,(function(e){return e.getUTCMilliseconds()})),(0,Xn.Z)(Zc,Jc,(function(e){return bl(e)})),(0,Xn.Z)(Zc,Yc,(function(e){return xl(e)})),(0,Xn.Z)(Zc,Qc,(function(e,t){return Sl(1,e.getUTCDay(),wl(t))})),(0,Xn.Z)(Zc,Yc+Qc,(function(e,t){return Sl(xl(e),e.getUTCDay(),wl(t))})),Zc),Tl=(Lc={},(0,Xn.Z)(Lc,Xc,(function(e){return 3*e})),(0,Xn.Z)(Lc,Yc,(function(e,t){return Sl(e,0,wl(t))})),Lc);function Il(e,t){return _l(e,t||1,Nl,Tl,kl)}var Dl=(Pc={},(0,Xn.Z)(Pc,Hc,mc),(0,Xn.Z)(Pc,Xc,yc.every(3)),(0,Xn.Z)(Pc,Kc,yc),(0,Xn.Z)(Pc,Yc,Qs),(0,Xn.Z)(Pc,$c,Ys),(0,Xn.Z)(Pc,Qc,Ys),(0,Xn.Z)(Pc,Jc,Ys),(0,Xn.Z)(Pc,el,xc),(0,Xn.Z)(Pc,tl,kc),(0,Xn.Z)(Pc,nl,Sc),(0,Xn.Z)(Pc,rl,Ac),Pc),Fl=(Uc={},(0,Xn.Z)(Uc,Hc,Nc),(0,Xn.Z)(Uc,Xc,Ic.every(3)),(0,Xn.Z)(Uc,Kc,Ic),(0,Xn.Z)(Uc,Yc,sc),(0,Xn.Z)(Uc,$c,oc),(0,Xn.Z)(Uc,Qc,oc),(0,Xn.Z)(Uc,Jc,oc),(0,Xn.Z)(Uc,el,Fc),(0,Xn.Z)(Uc,tl,Oc),(0,Xn.Z)(Uc,nl,Sc),(0,Xn.Z)(Uc,rl,Ac),Uc);function Ml(e){return Dl[e]}function Ol(e){return Fl[e]}function Rl(e,t,n){return e?e.offset(t,n):void 0}function jl(e,t,n){return Rl(Ml(e),t,n)}function Bl(e,t,n){return Rl(Ol(e),t,n)}function zl(e,t,n,r){return e?e.range(t,n,r):void 0}function Zl(e,t,n,r){return zl(Ml(e),t,n,r)}function Ll(e,t,n,r){return zl(Ol(e),t,n,r)}var Pl=1e3,Ul=6e4,Wl=36e5,Vl=864e5,ql=2592e6,Gl=31536e6,Hl=[Hc,Kc,$c,el,tl,nl,rl],Xl=Hl.slice(0,-1),Kl=Xl.slice(0,-1),Yl=Kl.slice(0,-1),$l=Yl.slice(0,-1),Ql=[Hc,Kc],Jl=[Hc],ef=[[Xl,1,Pl],[Xl,5,5e3],[Xl,15,15e3],[Xl,30,3e4],[Kl,1,Ul],[Kl,5,3e5],[Kl,15,9e5],[Kl,30,18e5],[Yl,1,Wl],[Yl,3,108e5],[Yl,6,216e5],[Yl,12,432e5],[$l,1,Vl],[[Hc,Yc],1,6048e5],[Ql,1,ql],[Ql,3,7776e6],[Jl,1,Gl]];function tf(e){var t,n,r=e.extent,a=e.maxbins||40,i=Math.abs(At(r))/a,o=Rc((function(e){return e[2]})).right(ef,i);return o===ef.length?(t=Jl,n=Gc(r[0]/Gl,r[1]/Gl,a)):o?(t=(o=ef[i/ef[o-1][2]<ef[o][2]/i?o-1:o])[0],n=o[1]):(t=Hl,n=Math.max(Gc(r[0],r[1],a),1)),{units:t,step:n}}function nf(e){return e&&e.length?1===e.length?e[0]:(t=e,function(e){for(var n=t.length,r=1,a=String(t[0](e));r<n;++r)a+="|"+t[r](e);return a}):function(){return""};var t}function rf(e,t,n){return n||e+(t?"_"+t:"")}var af=function(){},of={init:af,add:af,rem:af,idx:0},uf={values:{init:function(e){return e.cell.store=!0},value:function(e){return e.cell.data.values()},idx:-1},count:{value:function(e){return e.cell.num}},__count__:{value:function(e){return e.missing+e.valid}},missing:{value:function(e){return e.missing}},valid:{value:function(e){return e.valid}},sum:{init:function(e){return e.sum=0},value:function(e){return e.sum},add:function(e,t){return e.sum+=+t},rem:function(e,t){return e.sum-=t}},product:{init:function(e){return e.product=1},value:function(e){return e.valid?e.product:void 0},add:function(e,t){return e.product*=t},rem:function(e,t){return e.product/=t}},mean:{init:function(e){return e.mean=0},value:function(e){return e.valid?e.mean:void 0},add:function(e,t){return e.mean_d=t-e.mean,e.mean+=e.mean_d/e.valid},rem:function(e,t){return e.mean_d=t-e.mean,e.mean-=e.valid?e.mean_d/e.valid:e.mean}},average:{value:function(e){return e.valid?e.mean:void 0},req:["mean"],idx:1},variance:{init:function(e){return e.dev=0},value:function(e){return e.valid>1?e.dev/(e.valid-1):void 0},add:function(e,t){return e.dev+=e.mean_d*(t-e.mean)},rem:function(e,t){return e.dev-=e.mean_d*(t-e.mean)},req:["mean"],idx:1},variancep:{value:function(e){return e.valid>1?e.dev/e.valid:void 0},req:["variance"],idx:2},stdev:{value:function(e){return e.valid>1?Math.sqrt(e.dev/(e.valid-1)):void 0},req:["variance"],idx:2},stdevp:{value:function(e){return e.valid>1?Math.sqrt(e.dev/e.valid):void 0},req:["variance"],idx:2},stderr:{value:function(e){return e.valid>1?Math.sqrt(e.dev/(e.valid*(e.valid-1))):void 0},req:["variance"],idx:2},distinct:{value:function(e){return e.cell.data.distinct(e.get)},req:["values"],idx:3},ci0:{value:function(e){return e.cell.data.ci0(e.get)},req:["values"],idx:3},ci1:{value:function(e){return e.cell.data.ci1(e.get)},req:["values"],idx:3},median:{value:function(e){return e.cell.data.q2(e.get)},req:["values"],idx:3},q1:{value:function(e){return e.cell.data.q1(e.get)},req:["values"],idx:3},q3:{value:function(e){return e.cell.data.q3(e.get)},req:["values"],idx:3},min:{init:function(e){return e.min=void 0},value:function(e){return e.min=Number.isNaN(e.min)?e.cell.data.min(e.get):e.min},add:function(e,t){(t<e.min||void 0===e.min)&&(e.min=t)},rem:function(e,t){t<=e.min&&(e.min=NaN)},req:["values"],idx:4},max:{init:function(e){return e.max=void 0},value:function(e){return e.max=Number.isNaN(e.max)?e.cell.data.max(e.get):e.max},add:function(e,t){(t>e.max||void 0===e.max)&&(e.max=t)},rem:function(e,t){t>=e.max&&(e.max=NaN)},req:["values"],idx:4},argmin:{init:function(e){return e.argmin=void 0},value:function(e){return e.argmin||e.cell.data.argmin(e.get)},add:function(e,t,n){t<e.min&&(e.argmin=n)},rem:function(e,t){t<=e.min&&(e.argmin=void 0)},req:["min","values"],idx:3},argmax:{init:function(e){return e.argmax=void 0},value:function(e){return e.argmax||e.cell.data.argmax(e.get)},add:function(e,t,n){t>e.max&&(e.argmax=n)},rem:function(e,t){t>=e.max&&(e.argmax=void 0)},req:["max","values"],idx:3}},sf=Object.keys(uf);function cf(e,t){return uf[e](t)}function lf(e,t){return e.idx-t.idx}function ff(){var e=this;this.valid=0,this.missing=0,this._ops.forEach((function(t){return t.init(e)}))}function df(e,t){var n=this;null!=e&&""!==e?e===e&&(++this.valid,this._ops.forEach((function(r){return r.add(n,e,t)}))):++this.missing}function hf(e,t){var n=this;null!=e&&""!==e?e===e&&(--this.valid,this._ops.forEach((function(r){return r.rem(n,e,t)}))):--this.missing}function pf(e){var t=this;return this._out.forEach((function(n){return e[n.out]=n.value(t)})),e}function vf(e,t){var n=t||fe,r=function(e){var t={};return e.forEach((function(e){return t[e.name]=e})),e.forEach((function e(n){n.req&&n.req.forEach((function(n){t[n]||e(t[n]=uf[n]())}))})),Object.values(t).sort(lf)}(e),a=e.slice().sort(lf);function i(e){this._ops=r,this._out=a,this.cell=e,this.init()}return i.prototype.init=ff,i.prototype.add=df,i.prototype.rem=hf,i.prototype.set=pf,i.prototype.get=n,i.fields=e.map((function(e){return e.out})),i}function mf(e){this._key=e?ce(e):Bo,this.reset()}sf.forEach((function(e){uf[e]=function(e,t){return function(n){return at({name:e,out:n||e},of,t)}}(e,uf[e])}));var gf=mf.prototype;function yf(e){wu.call(this,null,e),this._adds=[],this._mods=[],this._alen=0,this._mlen=0,this._drop=!0,this._cross=!1,this._dims=[],this._dnames=[],this._measures=[],this._countOnly=!1,this._counts=null,this._prev=null,this._inputs=null,this._outputs=null}gf.reset=function(){this._add=[],this._rem=[],this._ext=null,this._get=null,this._q=null},gf.add=function(e){this._add.push(e)},gf.rem=function(e){this._rem.push(e)},gf.values=function(){if(this._get=null,0===this._rem.length)return this._add;var e,t,n,r=this._add,a=this._rem,i=this._key,o=r.length,u=a.length,s=Array(o-u),c={};for(e=0;e<u;++e)c[i(a[e])]=1;for(e=0,t=0;e<o;++e)c[i(n=r[e])]?c[i(n)]=0:s[t++]=n;return this._rem=[],this._add=s},gf.distinct=function(e){for(var t,n=this.values(),r={},a=n.length,i=0;--a>=0;)st(r,t=e(n[a])+"")||(r[t]=1,++i);return i},gf.extent=function(e){if(this._get!==e||!this._ext){var t=this.values(),n=ot(t,e);this._ext=[t[n[0]],t[n[1]]],this._get=e}return this._ext},gf.argmin=function(e){return this.extent(e)[0]||{}},gf.argmax=function(e){return this.extent(e)[1]||{}},gf.min=function(e){var t=this.extent(e)[0];return null!=t?e(t):void 0},gf.max=function(e){var t=this.extent(e)[1];return null!=t?e(t):void 0},gf.quartile=function(e){return this._get===e&&this._q||(this._q=Zu(this.values(),e),this._get=e),this._q},gf.q1=function(e){return this.quartile(e)[0]},gf.q2=function(e){return this.quartile(e)[1]},gf.q3=function(e){return this.quartile(e)[2]},gf.ci=function(e){return this._get===e&&this._ci||(this._ci=Vu(this.values(),1e3,.05,e),this._get=e),this._ci},gf.ci0=function(e){return this.ci(e)[0]},gf.ci1=function(e){return this.ci(e)[1]},yf.Definition={type:"Aggregate",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"ops",type:"enum",array:!0,values:sf},{name:"fields",type:"field",null:!0,array:!0},{name:"as",type:"string",null:!0,array:!0},{name:"drop",type:"boolean",default:!0},{name:"cross",type:"boolean",default:!1},{name:"key",type:"field"}]},dt(yf,wu,{transform:function(e,t){var n=this,r=this,a=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=e.modified();return r.stamp=a.stamp,r.value&&(i||t.modified(r._inputs,!0))?(r._prev=r.value,r.value=i?r.init(e):{},t.visit(t.SOURCE,(function(e){return r.add(e)}))):(r.value=r.value||r.init(e),t.visit(t.REM,(function(e){return r.rem(e)})),t.visit(t.ADD,(function(e){return r.add(e)}))),a.modifies(r._outputs),r._drop=!1!==e.drop,e.cross&&r._dims.length>1&&(r._drop=!1,r.cross()),t.clean()&&r._drop&&a.clean(!0).runAfter((function(){return n.clean()})),r.changes(a)},cross:function(){var e=this,t=e.value,n=e._dnames,r=n.map((function(){return{}})),a=n.length;function i(e){var t,i,o,u;for(t in e)for(o=e[t].tuple,i=0;i<a;++i)r[i][u=o[n[i]]]=u}i(e._prev),i(t),function i(o,u,s){var c=n[s],l=r[s++];for(var f in l){var d=o?o+"|"+f:f;u[c]=l[f],s<a?i(d,u,s):t[d]||e.cell(d,u)}}("",{},0)},init:function(e){var t=this._inputs=[],n=this._outputs=[],r={};function a(e){for(var n,a=Xe(re(e)),i=a.length,o=0;o<i;++o)r[n=a[o]]||(r[n]=1,t.push(n))}this._dims=Xe(e.groupby),this._dnames=this._dims.map((function(e){var t=ne(e);return a(e),n.push(t),t})),this.cellkey=e.key?e.key:nf(this._dims),this._countOnly=!0,this._counts=[],this._measures=[];var i,o,u,s,c,l,f=e.fields||[null],d=e.ops||["count"],h=e.as||[],p=f.length,v={};for(p!==d.length&&ue("Unmatched number of fields and aggregate ops."),l=0;l<p;++l)i=f[l],o=d[l],null==i&&"count"!==o&&ue("Null aggregate field specified."),c=rf(o,s=ne(i),h[l]),n.push(c),"count"!==o?((u=v[s])||(a(i),(u=v[s]=[]).field=i,this._measures.push(u)),"count"!==o&&(this._countOnly=!1),u.push(cf(o,c))):this._counts.push(c);return this._measures=this._measures.map((function(e){return vf(e,e.field)})),{}},cellkey:nf(),cell:function(e,t){var n=this.value[e];return n?0===n.num&&this._drop&&n.stamp<this.stamp?(n.stamp=this.stamp,this._adds[this._alen++]=n):n.stamp<this.stamp&&(n.stamp=this.stamp,this._mods[this._mlen++]=n):(n=this.value[e]=this.newcell(e,t),this._adds[this._alen++]=n),n},newcell:function(e,t){var n={key:e,num:0,agg:null,tuple:this.newtuple(t,this._prev&&this._prev[e]),stamp:this.stamp,store:!1};if(!this._countOnly){var r=this._measures,a=r.length;n.agg=Array(a);for(var i=0;i<a;++i)n.agg[i]=new r[i](n)}return n.store&&(n.data=new mf),n},newtuple:function(e,t){for(var n=this._dnames,r=this._dims,a=r.length,i={},o=0;o<a;++o)i[n[o]]=r[o](e);return t?Uo(t.tuple,i):Zo(i)},clean:function(){var e=this.value;for(var t in e)0===e[t].num&&delete e[t]},add:function(e){var t=this.cellkey(e),n=this.cell(t,e);if(n.num+=1,!this._countOnly){n.store&&n.data.add(e);for(var r=n.agg,a=0,i=r.length;a<i;++a)r[a].add(r[a].get(e),e)}},rem:function(e){var t=this.cellkey(e),n=this.cell(t,e);if(n.num-=1,!this._countOnly){n.store&&n.data.rem(e);for(var r=n.agg,a=0,i=r.length;a<i;++a)r[a].rem(r[a].get(e),e)}},celltuple:function(e){var t=e.tuple,n=this._counts;e.store&&e.data.values();for(var r=0,a=n.length;r<a;++r)t[n[r]]=e.num;if(!this._countOnly)for(var i=e.agg,o=0,u=i.length;o<u;++o)i[o].set(t);return t},changes:function(e){var t,n,r,a,i=this._adds,o=this._mods,u=this._prev,s=this._drop,c=e.add,l=e.rem,f=e.mod;if(u)for(n in u)t=u[n],s&&!t.num||l.push(t.tuple);for(r=0,a=this._alen;r<a;++r)c.push(this.celltuple(i[r])),i[r]=null;for(r=0,a=this._mlen;r<a;++r)(0===(t=o[r]).num&&s?l:f).push(this.celltuple(t)),o[r]=null;return this._alen=this._mlen=0,this._prev=null,e}});function bf(e){wu.call(this,null,e)}function xf(e,t,n){var r=e,a=t||[],i=n||[],o={},u=0;return{add:function(e){return i.push(e)},remove:function(e){return o[r(e)]=++u},size:function(){return a.length},data:function(e,t){return u&&(a=a.filter((function(e){return!o[r(e)]})),o={},u=0),t&&e&&a.sort(e),i.length&&(a=e?_t(e,a,i.sort(e)):a.concat(i),i=[]),a}}}function wf(e){wu.call(this,[],e)}function kf(e){Yo.call(this,null,_f,e)}function _f(e){return this.value&&!e.modified()?this.value:$e(e.fields,e.orders)}function Sf(e){wu.call(this,null,e)}function Cf(e){wu.call(this,null,e)}bf.Definition={type:"Bin",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"interval",type:"boolean",default:!0},{name:"anchor",type:"number"},{name:"maxbins",type:"number",default:20},{name:"base",type:"number",default:10},{name:"divide",type:"number",array:!0,default:[5,2]},{name:"extent",type:"number",array:!0,length:2,required:!0},{name:"span",type:"number"},{name:"step",type:"number"},{name:"steps",type:"number",array:!0},{name:"minstep",type:"number",default:0},{name:"nice",type:"boolean",default:!0},{name:"name",type:"string"},{name:"as",type:"string",array:!0,length:2,default:["bin0","bin1"]}]},dt(bf,wu,{transform:function(e,t){var n,r=!1!==e.interval,a=this._bins(e),i=a.start,o=a.step,u=e.as||["bin0","bin1"],s=u[0],c=u[1];return n=e.modified()?(t=t.reflow(!0)).SOURCE:t.modified(re(e.field))?t.ADD_MOD:t.ADD,t.visit(n,r?function(e){var t=a(e);e[s]=t,e[c]=null==t?null:i+o*(1+(t-i)/o)}:function(e){return e[s]=a(e)}),t.modifies(r?u:s)},_bins:function(e){if(this.value&&!e.modified())return this.value;var t,n,r=e.field,a=Pu(e),i=a.step,o=a.start,u=o+Math.ceil((a.stop-o)/i)*i;null!=(t=e.anchor)&&(n=t-(o+i*Math.floor((t-o)/i)),o+=n,u+=n);var s=function(e){var t=Ie(r(e));return null==t?null:t<o?-1/0:t>u?1/0:(t=Math.max(o,Math.min(t,u-i)),o+i*Math.floor(1e-14+(t-o)/i))};return s.start=o,s.stop=a.stop,s.step=i,this.value=te(s,re(r),e.name||"bin_"+ne(r))}}),wf.Definition={type:"Collect",metadata:{source:!0},params:[{name:"sort",type:"compare"}]},dt(wf,wu,{transform:function(e,t){var n=t.fork(t.ALL),r=xf(Bo,this.value,n.materialize(n.ADD).add),a=e.sort,i=t.changed()||a&&(e.modified("sort")||t.modified(a.fields));return n.visit(n.REM,r.remove),this.modified(i),this.value=n.source=r.data(Wo(a),i),t.source&&t.source.root&&(this.value.root=t.source.root),n}}),dt(kf,Yo),Sf.Definition={type:"CountPattern",metadata:{generates:!0,changes:!0},params:[{name:"field",type:"field",required:!0},{name:"case",type:"enum",values:["upper","lower","mixed"],default:"mixed"},{name:"pattern",type:"string",default:'[\\w"]+'},{name:"stopwords",type:"string",default:""},{name:"as",type:"string",array:!0,length:2,default:["text","count"]}]},dt(Sf,wu,{transform:function(e,t){var n=function(t){return function(n){for(var r,a=function(e,t,n){switch(t){case"upper":e=e.toUpperCase();break;case"lower":e=e.toLowerCase()}return e.match(n)}(u(n),e.case,i)||[],s=0,c=a.length;s<c;++s)o.test(r=a[s])||t(r)}},r=this._parameterCheck(e,t),a=this._counts,i=this._match,o=this._stop,u=e.field,s=e.as||["text","count"],c=n((function(e){return a[e]=1+(a[e]||0)})),l=n((function(e){return a[e]-=1}));return r?t.visit(t.SOURCE,c):(t.visit(t.ADD,c),t.visit(t.REM,l)),this._finish(t,s)},_parameterCheck:function(e,t){var n=!1;return!e.modified("stopwords")&&this._stop||(this._stop=new RegExp("^"+(e.stopwords||"")+"$","i"),n=!0),!e.modified("pattern")&&this._match||(this._match=new RegExp(e.pattern||"[\\w']+","g"),n=!0),(e.modified("field")||t.modified(e.field.fields))&&(n=!0),n&&(this._counts={}),n},_finish:function(e,t){var n,r,a,i=this._counts,o=this._tuples||(this._tuples={}),u=t[0],s=t[1],c=e.fork(e.NO_SOURCE|e.NO_FIELDS);for(n in i)r=o[n],a=i[n]||0,!r&&a?(o[n]=r=Zo({}),r[u]=n,r[s]=a,c.add.push(r)):0===a?(r&&c.rem.push(r),i[n]=null,o[n]=null):r[s]!==a&&(r[s]=a,c.mod.push(r));return c.modifies(t)}}),Cf.Definition={type:"Cross",metadata:{generates:!0},params:[{name:"filter",type:"expr"},{name:"as",type:"string",array:!0,length:2,default:["a","b"]}]},dt(Cf,wu,{transform:function(e,t){var n=t.fork(t.NO_SOURCE),r=e.as||["a","b"],a=r[0],i=r[1],o=!this.value||t.changed(t.ADD_REM)||e.modified("as")||e.modified("filter"),u=this.value;return o?(u&&(n.rem=u),u=t.materialize(t.SOURCE).source,n.add=this.value=function(e,t,n,r){for(var a,i,o=[],u={},s=e.length,c=0;c<s;++c)for(u[t]=i=e[c],a=0;a<s;++a)u[n]=e[a],r(u)&&(o.push(Zo(u)),(u={})[t]=i);return o}(u,a,i,e.filter||pe)):n.mod=u,n.source=this.value,n.modifies(r)}});var Af={kde:ns,mixture:ss,normal:ts,lognormal:us,uniform:hs},Ef="function";function Nf(e,t){var n=e.function;st(Af,n)||ue("Unknown distribution function: "+n);var r=Af[n]();for(var a in e)"field"===a?r.data((e.from||t()).map(e[a])):"distributions"===a?r[a](e[a].map((function(e){return Nf(e,t)}))):typeof r[a]===Ef&&r[a](e[a]);return r}function Tf(e){wu.call(this,null,e)}var If=[{key:{function:"normal"},params:[{name:"mean",type:"number",default:0},{name:"stdev",type:"number",default:1}]},{key:{function:"lognormal"},params:[{name:"mean",type:"number",default:0},{name:"stdev",type:"number",default:1}]},{key:{function:"uniform"},params:[{name:"min",type:"number",default:0},{name:"max",type:"number",default:1}]},{key:{function:"kde"},params:[{name:"field",type:"field",required:!0},{name:"from",type:"data"},{name:"bandwidth",type:"number",default:0}]}],Df={key:{function:"mixture"},params:[{name:"distributions",type:"param",array:!0,params:If},{name:"weights",type:"number",array:!0}]};function Ff(e,t){return e?e.map((function(e,n){return t[n]||ne(e)})):null}function Mf(e,t,n){var r,a,i,o,u,s,c=[],l=function(e){return e(o)};if(null==t)c.push(e.map(n));else for(r={},a=0,i=e.length;a<i;++a)o=e[a],(s=r[u=t.map(l)])||(r[u]=s=[],s.dims=u,c.push(s)),s.push(n(o));return c}Tf.Definition={type:"Density",metadata:{generates:!0},params:[{name:"extent",type:"number",array:!0,length:2},{name:"steps",type:"number"},{name:"minsteps",type:"number",default:25},{name:"maxsteps",type:"number",default:200},{name:"method",type:"string",default:"pdf",values:["pdf","cdf"]},{name:"distribution",type:"param",params:If.concat(Df)},{name:"as",type:"string",array:!0,default:["value","density"]}]},dt(Tf,wu,{transform:function(e,t){var n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){var r=Nf(e.distribution,function(e){return function(){return e.materialize(e.SOURCE).source}}(t)),a=e.steps||e.minsteps||25,i=e.steps||e.maxsteps||200,o=e.method||"pdf";"pdf"!==o&&"cdf"!==o&&ue("Invalid density method: "+o),e.extent||r.data||ue("Missing density extent parameter."),o=r[o];var u=e.as||["value","density"],s=Ts(o,e.extent||it(r.data()),a,i).map((function(e){var t={};return t[u[0]]=e[0],t[u[1]]=e[1],Zo(t)}));this.value&&(n.rem=this.value),this.value=n.add=n.source=s}return n}});function Of(e){wu.call(this,null,e)}Of.Definition={type:"DotBin",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"step",type:"number"},{name:"smooth",type:"boolean",default:!1},{name:"as",type:"string",default:"bin"}]};function Rf(e){Yo.call(this,null,jf,e),this.modified(!0)}function jf(e){var t=e.expr;return this.value&&!e.modified("expr")?this.value:te((function(n){return t(n,e)}),re(t),ne(t))}function Bf(e){wu.call(this,[void 0,void 0],e)}function zf(e,t){Yo.call(this,e),this.parent=t,this.count=0}function Zf(e){wu.call(this,{},e),this._keys=lt();var t=this._targets=[];t.active=0,t.forEach=function(e){for(var n=0,r=t.active;n<r;++n)e(t[n],n,t)}}function Lf(e){Yo.call(this,null,Pf,e)}function Pf(e){return this.value&&!e.modified()?this.value:_e(e.name)?Xe(e.name).map((function(e){return ce(e)})):ce(e.name,e.as)}function Uf(e){wu.call(this,lt(),e)}function Wf(e){wu.call(this,[],e)}function Vf(e){wu.call(this,[],e)}function qf(e){wu.call(this,null,e)}function Gf(e){wu.call(this,[],e)}dt(Of,wu,{transform:function(e,t){if(this.value&&!e.modified()&&!t.changed())return t;for(var n,r=t.materialize(t.SOURCE).source,a=Mf(t.source,e.groupby,fe),i=e.smooth||!1,o=e.field,u=e.step||function(e,t){return At(it(e,t))/30}(r,o),s=Wo((function(e,t){return o(e)-o(t)})),c=e.as||"bin",l=a.length,f=1/0,d=-1/0,h=0;h<l;++h){var p=a[h].sort(s);n=-1;var v,m=(0,Rt.Z)(qu(p,u,i,o));try{for(m.s();!(v=m.n()).done;){var g=v.value;g<f&&(f=g),g>d&&(d=g),p[++n][c]=g}}catch(y){m.e(y)}finally{m.f()}}return this.value={start:f,stop:d,step:u},t.reflow(!0).modifies(c)}}),dt(Rf,Yo),Bf.Definition={type:"Extent",metadata:{},params:[{name:"field",type:"field",required:!0}]},dt(Bf,wu,{transform:function(e,t){var n=this.value,r=e.field,a=t.changed()||t.modified(r.fields)||e.modified("field"),i=n[0],o=n[1];if((a||null==i)&&(i=1/0,o=-1/0),t.visit(a?t.SOURCE:t.ADD,(function(e){var t=Ie(r(e));null!=t&&(t<i&&(i=t),t>o&&(o=t))})),!Number.isFinite(i)||!Number.isFinite(o)){var u=ne(r);u&&(u=' for field "'.concat(u,'"')),t.dataflow.warn("Infinite extent".concat(u,": [").concat(i,", ").concat(o,"]")),i=o=void 0}this.value=[i,o]}}),dt(zf,Yo,{connect:function(e){return this.detachSubflow=e.detachSubflow,this.targets().add(e),e.source=this},add:function(e){this.count+=1,this.value.add.push(e)},rem:function(e){this.count-=1,this.value.rem.push(e)},mod:function(e){this.value.mod.push(e)},init:function(e){this.value.init(e,e.NO_SOURCE)},evaluate:function(){return this.value}}),dt(Zf,wu,{activate:function(e){this._targets[this._targets.active++]=e},subflow:function(e,t,n,r){var a,i,o=this.value,u=st(o,e)&&o[e];return u?u.value.stamp<n.stamp&&(u.init(n),this.activate(u)):(i=r||(i=this._group[e])&&i.tuple,a=n.dataflow,u=new zf(n.fork(n.NO_SOURCE),this),a.add(u).connect(t(a,e,i)),o[e]=u,this.activate(u)),u},clean:function(){var e=this.value,t=0;for(var n in e)if(0===e[n].count){var r=e[n].detachSubflow;r&&r(),delete e[n],++t}if(t){var a=this._targets.filter((function(e){return e&&e.count>0}));this.initTargets(a)}},initTargets:function(e){for(var t=this._targets,n=t.length,r=e?e.length:0,a=0;a<r;++a)t[a]=e[a];for(;a<n&&null!=t[a];++a)t[a]=null;t.active=r},transform:function(e,t){var n=this,r=t.dataflow,a=e.key,i=e.subflow,o=this._keys,u=e.modified("key"),s=function(e){return n.subflow(e,i,t)};return this._group=e.group||{},this.initTargets(),t.visit(t.REM,(function(e){var t=Bo(e),n=o.get(t);void 0!==n&&(o.delete(t),s(n).rem(e))})),t.visit(t.ADD,(function(e){var t=a(e);o.set(Bo(e),t),s(t).add(e)})),u||t.modified(a.fields)?t.visit(t.MOD,(function(e){var t=Bo(e),n=o.get(t),r=a(e);n===r?s(r).mod(e):(o.set(t,r),s(n).rem(e),s(r).add(e))})):t.changed(t.MOD)&&t.visit(t.MOD,(function(e){s(o.get(Bo(e))).mod(e)})),u&&t.visit(t.REFLOW,(function(e){var t=Bo(e),n=o.get(t),r=a(e);n!==r&&(o.set(t,r),s(n).rem(e),s(r).add(e))})),t.clean()?r.runAfter((function(){n.clean(),o.clean()})):o.empty>r.cleanThreshold&&r.runAfter(o.clean),t}}),dt(Lf,Yo),Uf.Definition={type:"Filter",metadata:{changes:!0},params:[{name:"expr",type:"expr",required:!0}]},dt(Uf,wu,{transform:function(e,t){var n=t.dataflow,r=this.value,a=t.fork(),i=a.add,o=a.rem,u=a.mod,s=e.expr,c=!0;function l(t){var n=Bo(t),a=s(t,e),l=r.get(n);a&&l?(r.delete(n),i.push(t)):a||l?c&&a&&!l&&u.push(t):(r.set(n,1),o.push(t))}return t.visit(t.REM,(function(e){var t=Bo(e);r.has(t)?r.delete(t):o.push(e)})),t.visit(t.ADD,(function(t){s(t,e)?i.push(t):r.set(Bo(t),1)})),t.visit(t.MOD,l),e.modified()&&(c=!1,t.visit(t.REFLOW,l)),r.empty>n.cleanThreshold&&n.runAfter(r.clean),a}}),Wf.Definition={type:"Flatten",metadata:{generates:!0},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"index",type:"string"},{name:"as",type:"string",array:!0}]},dt(Wf,wu,{transform:function(e,t){var n=t.fork(t.NO_SOURCE),r=e.fields,a=Ff(r,e.as||[]),i=e.index||null,o=a.length;return n.rem=this.value,t.visit(t.SOURCE,(function(e){for(var t,u,s,c=r.map((function(t){return t(e)})),l=c.reduce((function(e,t){return Math.max(e,t.length)}),0),f=0;f<l;++f){for(u=Lo(e),t=0;t<o;++t)u[a[t]]=null==(s=c[t][f])?null:s;i&&(u[i]=f),n.add.push(u)}})),this.value=n.source=n.add,i&&n.modifies(i),n.modifies(a)}}),Vf.Definition={type:"Fold",metadata:{generates:!0},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"as",type:"string",array:!0,length:2,default:["key","value"]}]},dt(Vf,wu,{transform:function(e,t){var n=t.fork(t.NO_SOURCE),r=e.fields,a=r.map(ne),i=e.as||["key","value"],o=i[0],u=i[1],s=r.length;return n.rem=this.value,t.visit(t.SOURCE,(function(e){for(var t,i=0;i<s;++i)(t=Lo(e))[o]=a[i],t[u]=r[i](e),n.add.push(t)})),this.value=n.source=n.add,n.modifies(i)}}),qf.Definition={type:"Formula",metadata:{modifies:!0},params:[{name:"expr",type:"expr",required:!0},{name:"as",type:"string",required:!0},{name:"initonly",type:"boolean"}]},dt(qf,wu,{transform:function(e,t){var n=e.expr,r=e.as,a=e.modified(),i=e.initonly?t.ADD:a?t.SOURCE:t.modified(n.fields)||t.modified(r)?t.ADD_MOD:t.ADD;return a&&(t=t.materialize().reflow(!0)),e.initonly||t.modifies(r),t.visit(i,(function(t){return t[r]=n(t,e)}))}}),dt(Gf,wu,{transform:function(e,t){var n,r,a,i=t.fork(t.ALL),o=e.generator,u=this.value,s=e.size-u.length;if(s>0){for(n=[];--s>=0;)n.push(a=Zo(o(e))),u.push(a);i.add=i.add.length?i.materialize(i.ADD).add.concat(n):n}else r=u.slice(0,-s),i.rem=i.rem.length?i.materialize(i.REM).rem.concat(r):r,u=u.slice(-s);return i.source=this.value=u,i}});var Hf={value:"value",median:function(e,t){return zs(e,.5,t)},mean:function(e,t){var n=0,r=0;if(void 0===t){var a,i=(0,Rt.Z)(e);try{for(i.s();!(a=i.n()).done;){var o=a.value;null!=o&&(o=+o)>=o&&(++n,r+=o)}}catch(f){i.e(f)}finally{i.f()}}else{var u,s=-1,c=(0,Rt.Z)(e);try{for(c.s();!(u=c.n()).done;){var l=u.value;null!=(l=t(l,++s,e))&&(l=+l)>=l&&(++n,r+=l)}}catch(f){c.e(f)}finally{c.f()}}if(n)return r/n},min:Fs,max:Ds},Xf=[];function Kf(e){wu.call(this,[],e)}function Yf(e){yf.call(this,e)}function $f(e){wu.call(this,null,e)}function Qf(e){Yo.call(this,null,Jf,e)}function Jf(e){return this.value&&!e.modified()?this.value:xt(e.fields,e.flat)}function ed(e){wu.call(this,[],e),this._pending=null}function td(e,t,n){n.forEach(Zo);var r=t.fork(t.NO_FIELDS&t.NO_SOURCE);return r.rem=e.value,e.value=r.source=r.add=n,e._pending=null,r.rem.length&&r.clean(!0),r}function nd(e){wu.call(this,{},e)}function rd(e){Yo.call(this,null,ad,e)}function ad(e){if(this.value&&!e.modified())return this.value;var t,n,r=e.extents,a=r.length,i=1/0,o=-1/0;for(t=0;t<a;++t)(n=r[t])[0]<i&&(i=n[0]),n[1]>o&&(o=n[1]);return[i,o]}function id(e){Yo.call(this,null,od,e)}function od(e){return this.value&&!e.modified()?this.value:e.values.reduce((function(e,t){return e.concat(t)}),[])}function ud(e){wu.call(this,null,e)}function sd(e){yf.call(this,e)}function cd(e){Zf.call(this,e)}function ld(e){wu.call(this,null,e)}function fd(e){wu.call(this,null,e)}function dd(e){wu.call(this,null,e)}Kf.Definition={type:"Impute",metadata:{changes:!0},params:[{name:"field",type:"field",required:!0},{name:"key",type:"field",required:!0},{name:"keyvals",array:!0},{name:"groupby",type:"field",array:!0},{name:"method",type:"enum",default:"value",values:["value","mean","median","max","min"]},{name:"value",default:0}]},dt(Kf,wu,{transform:function(e,t){var n,r,a,i,o,u,s,c,l,f,d=t.fork(t.ALL),h=function(e){var t,n=e.method||Hf.value;if(null!=Hf[n])return n===Hf.value?(t=void 0!==e.value?e.value:0,function(){return t}):Hf[n];ue("Unrecognized imputation method: "+n)}(e),p=function(e){var t=e.field;return function(e){return e?t(e):NaN}}(e),v=ne(e.field),m=ne(e.key),g=(e.groupby||[]).map(ne),y=function(e,t,n,r){var a,i,o,u,s,c,l,f,d=function(e){return e(f)},h=[],p=r?r.slice():[],v={},m={};for(p.forEach((function(e,t){return v[e]=t+1})),u=0,l=e.length;u<l;++u)c=n(f=e[u]),s=v[c]||(v[c]=p.push(c)),(o=m[i=(a=t?t.map(d):Xf)+""])||(o=m[i]=[],h.push(o),o.values=a),o[s-1]=f;return h.domain=p,h}(t.source,e.groupby,e.key,e.keyvals),b=[],x=this.value,w=y.domain.length;for(o=0,c=y.length;o<c;++o)for(a=(n=y[o]).values,r=NaN,s=0;s<w;++s)if(null==n[s]){for(i=y.domain[s],f={_impute:!0},u=0,l=a.length;u<l;++u)f[g[u]]=a[u];f[m]=i,f[v]=Number.isNaN(r)?r=h(n,p):r,b.push(Zo(f))}return b.length&&(d.add=d.materialize(d.ADD).add.concat(b)),x.length&&(d.rem=d.materialize(d.REM).rem.concat(x)),this.value=b,d}}),Yf.Definition={type:"JoinAggregate",metadata:{modifies:!0},params:[{name:"groupby",type:"field",array:!0},{name:"fields",type:"field",null:!0,array:!0},{name:"ops",type:"enum",array:!0,values:sf},{name:"as",type:"string",null:!0,array:!0},{name:"key",type:"field"}]},dt(Yf,yf,{transform:function(e,t){var n,r=this,a=e.modified();return r.value&&(a||t.modified(r._inputs,!0))?(n=r.value=a?r.init(e):{},t.visit(t.SOURCE,(function(e){return r.add(e)}))):(n=r.value=r.value||this.init(e),t.visit(t.REM,(function(e){return r.rem(e)})),t.visit(t.ADD,(function(e){return r.add(e)}))),r.changes(),t.visit(t.SOURCE,(function(e){at(e,n[r.cellkey(e)].tuple)})),t.reflow(a).modifies(this._outputs)},changes:function(){var e,t,n=this._adds,r=this._mods;for(e=0,t=this._alen;e<t;++e)this.celltuple(n[e]),n[e]=null;for(e=0,t=this._mlen;e<t;++e)this.celltuple(r[e]),r[e]=null;this._alen=this._mlen=0}}),$f.Definition={type:"KDE",metadata:{generates:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"cumulative",type:"boolean",default:!1},{name:"counts",type:"boolean",default:!1},{name:"bandwidth",type:"number",default:0},{name:"extent",type:"number",array:!0,length:2},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"steps",type:"number"},{name:"minsteps",type:"number",default:25},{name:"maxsteps",type:"number",default:200},{name:"as",type:"string",array:!0,default:["value","density"]}]},dt($f,wu,{transform:function(e,t){var n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){var r=t.materialize(t.SOURCE).source,a=Mf(r,e.groupby,e.field),i=(e.groupby||[]).map(ne),o=e.bandwidth,u=e.cumulative?"cdf":"pdf",s=e.as||["value","density"],c=[],l=e.extent,f=e.steps||e.minsteps||25,d=e.steps||e.maxsteps||200;"pdf"!==u&&"cdf"!==u&&ue("Invalid density method: "+u),"shared"===e.resolve&&(l||(l=it(r,e.field)),f=d=e.steps||d),a.forEach((function(t){var n=ns(t,o)[u],r=e.counts?t.length:1;Ts(n,l||it(t),f,d).forEach((function(e){for(var n={},a=0;a<i.length;++a)n[i[a]]=t.dims[a];n[s[0]]=e[0],n[s[1]]=e[1]*r,c.push(Zo(n))}))})),this.value&&(n.rem=this.value),this.value=n.add=n.source=c}return n}}),dt(Qf,Yo),dt(ed,wu,{transform:function(e,t){var n=this,r=t.dataflow;if(this._pending)return td(this,t,this._pending);if(function(e){return e.modified("async")&&!(e.modified("values")||e.modified("url")||e.modified("format"))}(e))return t.StopPropagation;if(e.values)return td(this,t,r.parse(e.values,e.format));if(e.async){var a=r.request(e.url,e.format).then((function(e){return n._pending=Xe(e.data),function(e){return e.touch(n)}}));return{async:a}}return r.request(e.url,e.format).then((function(e){return td(n,t,Xe(e.data))}))}}),nd.Definition={type:"Lookup",metadata:{modifies:!0},params:[{name:"index",type:"index",params:[{name:"from",type:"data",required:!0},{name:"key",type:"field",required:!0}]},{name:"values",type:"field",array:!0},{name:"fields",type:"field",array:!0,required:!0},{name:"as",type:"string",array:!0},{name:"default",default:null}]},dt(nd,wu,{transform:function(e,t){var n,r,a,i=e.fields,o=e.index,u=e.values,s=null==e.default?null:e.default,c=e.modified(),l=i.length,f=c?t.SOURCE:t.ADD,d=t,h=e.as;return u?(r=u.length,l>1&&!h&&ue('Multi-field lookup requires explicit "as" parameter.'),h&&h.length!==l*r&&ue('The "as" parameter has too few output field names.'),h=h||u.map(ne),n=function(e){for(var t,n,a=0,c=0;a<l;++a)if(null==(n=o.get(i[a](e))))for(t=0;t<r;++t,++c)e[h[c]]=s;else for(t=0;t<r;++t,++c)e[h[c]]=u[t](n)}):(h||ue("Missing output field names."),n=function(e){for(var t,n=0;n<l;++n)t=o.get(i[n](e)),e[h[n]]=null==t?s:t}),c?d=t.reflow(!0):(a=i.some((function(e){return t.modified(e.fields)})),f|=a?t.MOD:0),t.visit(f,n),d.modifies(h)}}),dt(rd,Yo),dt(id,Yo),dt(ud,wu,{transform:function(e,t){return this.modified(e.modified()),this.value=e,t.fork(t.NO_SOURCE|t.NO_FIELDS)}}),sd.Definition={type:"Pivot",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"value",type:"field",required:!0},{name:"op",type:"enum",values:sf,default:"sum"},{name:"limit",type:"number",default:0},{name:"key",type:"field"}]},dt(sd,yf,{_transform:yf.prototype.transform,transform:function(e,t){return this._transform(function(e,t){var n=e.field,r=e.value,a=("count"===e.op?"__count__":e.op)||"sum",i=re(n).concat(re(r)),o=function(e,t,n){var r={},a=[];return n.visit(n.SOURCE,(function(t){var n=e(t);r[n]||(r[n]=1,a.push(n))})),a.sort(Qe),t?a.slice(0,t):a}(n,e.limit||0,t);t.changed()&&e.set("__pivot__",null,null,!0);return{key:e.key,groupby:e.groupby,ops:o.map((function(){return a})),fields:o.map((function(e){return function(e,t,n,r){return te((function(r){return t(r)===e?n(r):NaN}),r,e+"")}(e,n,r,i)})),as:o.map((function(e){return e+""})),modified:e.modified.bind(e)}}(e,t),t)}}),dt(cd,Zf,{transform:function(e,t){var n=this,r=e.subflow,a=e.field,i=function(e){return n.subflow(Bo(e),r,t,e)};return(e.modified("field")||a&&t.modified(re(a)))&&ue("PreFacet does not support field modification."),this.initTargets(),a?(t.visit(t.MOD,(function(e){var t=i(e);a(e).forEach((function(e){return t.mod(e)}))})),t.visit(t.ADD,(function(e){var t=i(e);a(e).forEach((function(e){return t.add(Zo(e))}))})),t.visit(t.REM,(function(e){var t=i(e);a(e).forEach((function(e){return t.rem(e)}))}))):(t.visit(t.MOD,(function(e){return i(e).mod(e)})),t.visit(t.ADD,(function(e){return i(e).add(e)})),t.visit(t.REM,(function(e){return i(e).rem(e)}))),t.clean()&&t.runAfter((function(){return n.clean()})),t}}),ld.Definition={type:"Project",metadata:{generates:!0,changes:!0},params:[{name:"fields",type:"field",array:!0},{name:"as",type:"string",null:!0,array:!0}]},dt(ld,wu,{transform:function(e,t){var n,r=t.fork(t.NO_SOURCE),a=e.fields,i=Ff(e.fields,e.as||[]),o=a?function(e,t){return function(e,t,n,r){for(var a=0,i=n.length;a<i;++a)t[r[a]]=n[a](e);return t}(e,t,a,i)}:Po;return this.value?n=this.value:(t=t.addAll(),n=this.value={}),t.visit(t.REM,(function(e){var t=Bo(e);r.rem.push(n[t]),n[t]=null})),t.visit(t.ADD,(function(e){var t=o(e,Zo({}));n[Bo(e)]=t,r.add.push(t)})),t.visit(t.MOD,(function(e){r.mod.push(o(e,n[Bo(e)]))})),r}}),dt(fd,wu,{transform:function(e,t){return this.value=e.value,e.modified("value")?t.fork(t.NO_SOURCE|t.NO_FIELDS):t.StopPropagation}}),dd.Definition={type:"Quantile",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"probs",type:"number",array:!0},{name:"step",type:"number",default:.01},{name:"as",type:"string",array:!0,default:["prob","value"]}]};function hd(e){wu.call(this,null,e)}function pd(e){wu.call(this,[],e),this.count=0}function vd(e){wu.call(this,null,e)}function md(e){wu.call(this,null,e),this.modified(!0)}function gd(e){wu.call(this,null,e)}dt(dd,wu,{transform:function(e,t){var n=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=e.as||["prob","value"];if(this.value&&!e.modified()&&!t.changed())return n.source=this.value,n;var a=Mf(t.materialize(t.SOURCE).source,e.groupby,e.field),i=(e.groupby||[]).map(ne),o=[],u=e.step||.01,s=e.probs||Zs(u/2,1-1e-14,u),c=s.length;return a.forEach((function(e){for(var t=zu(e,s),n=0;n<c;++n){for(var a={},u=0;u<i.length;++u)a[i[u]]=e.dims[u];a[r[0]]=s[n],a[r[1]]=t[n],o.push(Zo(a))}})),this.value&&(n.rem=this.value),this.value=n.add=n.source=o,n}}),dt(hd,wu,{transform:function(e,t){var n,r;return this.value?r=this.value:(n=t=t.addAll(),r=this.value={}),e.derive&&(n=t.fork(t.NO_SOURCE),t.visit(t.REM,(function(e){var t=Bo(e);n.rem.push(r[t]),r[t]=null})),t.visit(t.ADD,(function(e){var t=Lo(e);r[Bo(e)]=t,n.add.push(t)})),t.visit(t.MOD,(function(e){var t=r[Bo(e)];for(var a in e)t[a]=e[a],n.modifies(a);n.mod.push(t)}))),n}}),pd.Definition={type:"Sample",metadata:{},params:[{name:"size",type:"number",default:1e3}]},dt(pd,wu,{transform:function(e,t){var n=t.fork(t.NO_SOURCE),r=e.modified("size"),a=e.size,i=this.value.reduce((function(e,t){return e[Bo(t)]=1,e}),{}),o=this.value,u=this.count,s=0;function c(e){var t,r;o.length<a?o.push(e):(r=~~((u+1)*Uu()))<o.length&&r>=s&&(t=o[r],i[Bo(t)]&&n.rem.push(t),o[r]=e),++u}if(t.rem.length&&(t.visit(t.REM,(function(e){var t=Bo(e);i[t]&&(i[t]=-1,n.rem.push(e)),--u})),o=o.filter((function(e){return-1!==i[Bo(e)]}))),(t.rem.length||r)&&o.length<a&&t.source&&(s=u=o.length,t.visit(t.SOURCE,(function(e){i[Bo(e)]||c(e)})),s=-1),r&&o.length>a){for(var l=o.length-a,f=0;f<l;++f)i[Bo(o[f])]=-1,n.rem.push(o[f]);o=o.slice(l)}return t.mod.length&&t.visit(t.MOD,(function(e){i[Bo(e)]&&n.mod.push(e)})),t.add.length&&t.visit(t.ADD,c),(t.add.length||s<0)&&(n.add=o.filter((function(e){return!i[Bo(e)]}))),this.count=u,this.value=n.source=o,n}}),vd.Definition={type:"Sequence",metadata:{generates:!0,changes:!0},params:[{name:"start",type:"number",required:!0},{name:"stop",type:"number",required:!0},{name:"step",type:"number",default:1},{name:"as",type:"string",default:"data"}]},dt(vd,wu,{transform:function(e,t){if(!this.value||e.modified()){var n=t.materialize().fork(t.MOD),r=e.as||"data";return n.rem=this.value?t.rem.concat(this.value):t.rem,this.value=Zs(e.start,e.stop,e.step||1).map((function(e){var t={};return t[r]=e,Zo(t)})),n.add=t.add.concat(this.value),n}}}),dt(md,wu,{transform:function(e,t){return this.value=t.source,t.changed()?t.fork(t.NO_SOURCE|t.NO_FIELDS):t.StopPropagation}});var yd=["unit0","unit1"];function bd(e){wu.call(this,lt(),e)}function xd(e){wu.call(this,null,e)}gd.Definition={type:"TimeUnit",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"interval",type:"boolean",default:!0},{name:"units",type:"enum",values:al,array:!0},{name:"step",type:"number",default:1},{name:"maxbins",type:"number",default:40},{name:"extent",type:"date",array:!0},{name:"timezone",type:"enum",default:"local",values:["local","utc"]},{name:"as",type:"string",array:!0,length:2,default:yd}]},dt(gd,wu,{transform:function(e,t){var n=e.field,r=!1!==e.interval,a="utc"===e.timezone,i=this._floor(e,t),o=(a?Ol:Ml)(i.unit).offset,u=e.as||yd,s=u[0],c=u[1],l=i.step,f=i.start||1/0,d=i.stop||-1/0,h=t.ADD;return(e.modified()||t.modified(re(n)))&&(h=(t=t.reflow(!0)).SOURCE,f=1/0,d=-1/0),t.visit(h,(function(e){var t,a,u=n(e);null==u?(e[s]=null,r&&(e[c]=null)):(e[s]=t=a=i(u),r&&(e[c]=a=o(t,l)),t<f&&(f=t),a>d&&(d=a))})),i.start=f,i.stop=d,t.modifies(r?u:s)},_floor:function(e,t){var n="utc"===e.timezone,r=e.units?{units:e.units,step:e.step||1}:tf({extent:e.extent||it(t.materialize(t.SOURCE).source,e.field),maxbins:e.maxbins}),a=r.units,i=r.step,o=ol(a),u=this.value||{},s=(n?Il:El)(o,i);return s.unit=Te(o),s.units=o,s.step=i,s.start=u.start,s.stop=u.stop,this.value=s}}),dt(bd,wu,{transform:function(e,t){var n=t.dataflow,r=e.field,a=this.value,i=function(e){return a.set(r(e),e)},o=!0;return e.modified("field")||t.modified(r.fields)?(a.clear(),t.visit(t.SOURCE,i)):t.changed()?(t.visit(t.REM,(function(e){return a.delete(r(e))})),t.visit(t.ADD,i)):o=!1,this.modified(o),a.empty>n.cleanThreshold&&n.runAfter(a.clean),t.fork()}}),dt(xd,wu,{transform:function(e,t){(!this.value||e.modified("field")||e.modified("sort")||t.changed()||e.sort&&t.modified(e.sort.fields))&&(this.value=(e.sort?t.source.slice().sort(Wo(e.sort)):t.source).map(e.field))}});var wd={row_number:function(){return{next:function(e){return e.index+1}}},rank:function(){var e;return{init:function(){return e=1},next:function(t){var n=t.index,r=t.data;return n&&t.compare(r[n-1],r[n])?e=n+1:e}}},dense_rank:function(){var e;return{init:function(){return e=1},next:function(t){var n=t.index,r=t.data;return n&&t.compare(r[n-1],r[n])?++e:e}}},percent_rank:function(){var e=wd.rank(),t=e.next;return{init:e.init,next:function(e){return(t(e)-1)/(e.data.length-1)}}},cume_dist:function(){var e;return{init:function(){return e=0},next:function(t){var n=t.data,r=t.compare,a=t.index;if(e<a){for(;a+1<n.length&&!r(n[a],n[a+1]);)++a;e=a}return(1+e)/n.length}}},ntile:function(e,t){(t=+t)>0||ue("ntile num must be greater than zero.");var n=wd.cume_dist(),r=n.next;return{init:n.init,next:function(e){return Math.ceil(t*r(e))}}},lag:function(e,t){return t=+t||1,{next:function(n){var r=n.index-t;return r>=0?e(n.data[r]):null}}},lead:function(e,t){return t=+t||1,{next:function(n){var r=n.index+t,a=n.data;return r<a.length?e(a[r]):null}}},first_value:function(e){return{next:function(t){return e(t.data[t.i0])}}},last_value:function(e){return{next:function(t){return e(t.data[t.i1-1])}}},nth_value:function(e,t){return(t=+t)>0||ue("nth_value nth must be greater than zero."),{next:function(n){var r=n.i0+(t-1);return r<n.i1?e(n.data[r]):null}}},prev_value:function(e){var t;return{init:function(){return t=null},next:function(n){var r=e(n.data[n.index]);return null!=r?t=r:t}}},next_value:function(e){var t,n;return{init:function(){return t=null,n=-1},next:function(r){var a=r.data;return r.index<=n?t:(n=function(e,t,n){for(var r=t.length;n<r;++n){if(null!=e(t[n]))return n}return-1}(e,a,r.index))<0?(n=a.length,t=null):t=e(a[n])}}}};var kd=Object.keys(wd);function _d(e){var t=Xe(e.ops),n=Xe(e.fields),r=Xe(e.params),a=Xe(e.as),i=this.outputs=[],o=this.windows=[],u={},s={},c=[],l=[],f=!0;function d(e){Xe(re(e)).forEach((function(e){return u[e]=1}))}d(e.sort),t.forEach((function(e,t){var u=n[t],h=ne(u),p=rf(e,h,a[t]);if(d(u),i.push(p),st(wd,e))o.push(function(e,t,n,r){var a=wd[e](t,n);return{init:a.init||de,update:function(e,t){t[r]=a.next(e)}}}(e,n[t],r[t],p));else{if(null==u&&"count"!==e&&ue("Null aggregate field specified."),"count"===e)return void c.push(p);f=!1;var v=s[h];v||((v=s[h]=[]).field=u,l.push(v)),v.push(cf(e,p))}})),(c.length||l.length)&&(this.cell=function(e,t,n){e=e.map((function(e){return vf(e,e.field)}));var r={num:0,agg:null,store:!1,count:t};if(!n)for(var a=e.length,i=r.agg=Array(a),o=0;o<a;++o)i[o]=new e[o](r);if(r.store)var u=r.data=new mf;return r.add=function(e){if(r.num+=1,!n){u&&u.add(e);for(var t=0;t<a;++t)i[t].add(i[t].get(e),e)}},r.rem=function(e){if(r.num-=1,!n){u&&u.rem(e);for(var t=0;t<a;++t)i[t].rem(i[t].get(e),e)}},r.set=function(e){var a,o;for(u&&u.values(),a=0,o=t.length;a<o;++a)e[t[a]]=r.num;if(!n)for(a=0,o=i.length;a<o;++a)i[a].set(e)},r.init=function(){r.num=0,u&&u.reset();for(var e=0;e<a;++e)i[e].init()},r}(l,c,f)),this.inputs=Object.keys(u)}var Sd=_d.prototype;function Cd(e){wu.call(this,{},e),this._mlen=0,this._mods=[]}function Ad(e,t,n,r){var a=r.sort,i=a&&!r.ignorePeers,o=r.frame||[null,0],u=e.data(n),s=u.length,c=i?Ls(a):null,l={i0:0,i1:0,p0:0,p1:0,index:0,data:u,compare:a||nt(-1)};t.init();for(var f=0;f<s;++f)Ed(l,o,f,s),i&&Nd(l,c),t.update(l,u[f])}function Ed(e,t,n,r){e.p0=e.i0,e.p1=e.i1,e.i0=null==t[0]?0:Math.max(0,n-Math.abs(t[0])),e.i1=null==t[1]?r:Math.min(r,n+Math.abs(t[1])+1),e.index=n}function Nd(e,t){var n=e.i0,r=e.i1-1,a=e.compare,i=e.data,o=i.length-1;n>0&&!a(i[n],i[n-1])&&(e.i0=t.left(i,i[n])),r<o&&!a(i[r],i[r+1])&&(e.i1=t.right(i,i[r]))}function Td(e,t,n){return e.fields=t||[],e.fname=n,e}function Id(e){return 1===e.length?Dd(e[0]):Fd(e)}Sd.init=function(){this.windows.forEach((function(e){return e.init()})),this.cell&&this.cell.init()},Sd.update=function(e,t){var n,r=this.cell,a=this.windows,i=e.data,o=a&&a.length;if(r){for(n=e.p0;n<e.i0;++n)r.rem(i[n]);for(n=e.p1;n<e.i1;++n)r.add(i[n]);r.set(t)}for(n=0;n<o;++n)a[n].update(e,t)},Cd.Definition={type:"Window",metadata:{modifies:!0},params:[{name:"sort",type:"compare"},{name:"groupby",type:"field",array:!0},{name:"ops",type:"enum",array:!0,values:kd.concat(sf)},{name:"params",type:"number",null:!0,array:!0},{name:"fields",type:"field",null:!0,array:!0},{name:"as",type:"string",null:!0,array:!0},{name:"frame",type:"number",null:!0,array:!0,length:2,default:[null,0]},{name:"ignorePeers",type:"boolean",default:!1}]},dt(Cd,wu,{transform:function(e,t){var n=this;this.stamp=t.stamp;var r=e.modified(),a=Wo(e.sort),i=nf(e.groupby),o=function(e){return n.group(i(e))},u=this.state;u&&!r||(u=this.state=new _d(e)),r||t.modified(u.inputs)?(this.value={},t.visit(t.SOURCE,(function(e){return o(e).add(e)}))):(t.visit(t.REM,(function(e){return o(e).remove(e)})),t.visit(t.ADD,(function(e){return o(e).add(e)})));for(var s=0,c=this._mlen;s<c;++s)Ad(this._mods[s],u,a,e);return this._mlen=0,this._mods=[],t.reflow(r).modifies(u.outputs)},group:function(e){var t=this.value[e];return t||(t=this.value[e]=xf(Bo),t.stamp=-1),t.stamp<this.stamp&&(t.stamp=this.stamp,this._mods[this._mlen++]=t),t}});var Dd=function(e){return function(t){return t[e]}},Fd=function(e){var t=e.length;return function(n){for(var r=0;r<t;++r)n=n[e[r]];return n}};function Md(e){throw Error(e)}function Od(e){var t,n,r,a=[],i=e.length,o=null,u=0,s="";function c(){a.push(s+e.substring(t,n)),s="",t=n+1}for(e+="",t=n=0;n<i;++n)if("\\"===(r=e[n]))s+=e.substring(t,n++),t=n;else if(r===o)c(),o=null,u=-1;else{if(o)continue;t===u&&'"'===r||t===u&&"'"===r?(t=n+1,o=r):"."!==r||u?"["===r?(n>t&&c(),u=t=n+1):"]"===r&&(u||Md("Access path missing open bracket: "+e),u>0&&c(),u=0,t=n+1):n>t?c():t=n+1}return u&&Md("Access path missing closing bracket: "+e),o&&Md("Access path missing closing quote: "+e),n>t&&(n++,c()),a}function Rd(e,t,n){var r=Od(e);return e=1===r.length?r[0]:e,Td((n&&n.get||Id)(r),[e],t||e)}Rd("id");var jd=Td((function(e){return e}),[],"identity"),Bd=(Td((function(){return 0}),[],"zero"),Td((function(){return 1}),[],"one"),Td((function(){return!0}),[],"true"));Td((function(){return!1}),[],"false");var zd=Array.isArray;function Zd(e){return e===Object(e)}function Ld(e){return e[e.length-1]}function Pd(e){return null==e||""===e?null:+e}function Ud(e){return null!=e?zd(e)?e:[e]:[]}function Wd(e){return"function"===typeof e}function Vd(e){for(var t,n,r=1,a=arguments.length;r<a;++r)for(n in t=arguments[r])e[n]=t[n];return e}var qd=Object.prototype.hasOwnProperty;function Gd(e,t){return qd.call(e,t)}function Hd(e,t,n){var r=e.prototype=Object.create(t.prototype);return Object.defineProperty(r,"constructor",{value:e,writable:!0,enumerable:!0,configurable:!0}),Vd(r,n)}function Xd(e){return"string"===typeof e}function Kd(e){return zd(e)?"["+e.map(Kd)+"]":Zd(e)||Xd(e)?JSON.stringify(e).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):e}function Yd(e){for(var t={},n=e.length,r=0;r<n;++r)t[e[r]]=!0;return t}function $d(e,t,n){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+n)/6)}function Qd(e){this._context=e}function Jd(){}function eh(e){this._context=e}function th(e){this._context=e}function nh(e,t){this._basis=new Qd(e),this._beta=t}Qd.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:$d(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:$d(this,e,t)}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}},eh.prototype={areaStart:Jd,areaEnd:Jd,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x2,this._y2),this._context.closePath();break;case 2:this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break;case 3:this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4)}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:$d(this,e,t)}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}},th.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+e)/6,r=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(n,r):this._context.moveTo(n,r);break;case 3:this._point=4;default:$d(this,e,t)}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}},nh.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var e=this._x,t=this._y,n=e.length-1;if(n>0)for(var r,a=e[0],i=t[0],o=e[n]-a,u=t[n]-i,s=-1;++s<=n;)r=s/n,this._basis.point(this._beta*e[s]+(1-this._beta)*(a+r*o),this._beta*t[s]+(1-this._beta)*(i+r*u));this._x=this._y=null,this._basis.lineEnd()},point:function(e,t){this._x.push(+e),this._y.push(+t)}};var rh=function e(t){function n(e){return 1===t?new Qd(e):new nh(e,t)}return n.beta=function(t){return e(+t)},n}(.85);function ah(e,t,n){e._context.bezierCurveTo(e._x1+e._k*(e._x2-e._x0),e._y1+e._k*(e._y2-e._y0),e._x2+e._k*(e._x1-t),e._y2+e._k*(e._y1-n),e._x2,e._y2)}function ih(e,t){this._context=e,this._k=(1-t)/6}ih.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:ah(this,this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2,this._x1=e,this._y1=t;break;case 2:this._point=3;default:ah(this,e,t)}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var oh=function e(t){function n(e){return new ih(e,t)}return n.tension=function(t){return e(+t)},n}(0);function uh(e,t){this._context=e,this._k=(1-t)/6}uh.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:ah(this,e,t)}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var sh=function e(t){function n(e){return new uh(e,t)}return n.tension=function(t){return e(+t)},n}(0);function ch(e,t){this._context=e,this._k=(1-t)/6}ch.prototype={areaStart:Jd,areaEnd:Jd,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:ah(this,e,t)}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var lh=function e(t){function n(e){return new ch(e,t)}return n.tension=function(t){return e(+t)},n}(0),fh=Math.abs,dh=Math.atan2,hh=Math.cos,ph=Math.max,vh=Math.min,mh=Math.sin,gh=Math.sqrt,yh=1e-12,bh=Math.PI,xh=bh/2,wh=2*bh;function kh(e){return e>1?0:e<-1?bh:Math.acos(e)}function _h(e){return e>=1?xh:e<=-1?-xh:Math.asin(e)}function Sh(e,t,n){var r=e._x1,a=e._y1,i=e._x2,o=e._y2;if(e._l01_a>yh){var u=2*e._l01_2a+3*e._l01_a*e._l12_a+e._l12_2a,s=3*e._l01_a*(e._l01_a+e._l12_a);r=(r*u-e._x0*e._l12_2a+e._x2*e._l01_2a)/s,a=(a*u-e._y0*e._l12_2a+e._y2*e._l01_2a)/s}if(e._l23_a>yh){var c=2*e._l23_2a+3*e._l23_a*e._l12_a+e._l12_2a,l=3*e._l23_a*(e._l23_a+e._l12_a);i=(i*c+e._x1*e._l23_2a-t*e._l12_2a)/l,o=(o*c+e._y1*e._l23_2a-n*e._l12_2a)/l}e._context.bezierCurveTo(r,a,i,o,e._x2,e._y2)}function Ch(e,t){this._context=e,this._alpha=t}Ch.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3;default:Sh(this,e,t)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var Ah=function e(t){function n(e){return t?new Ch(e,t):new ih(e,0)}return n.alpha=function(t){return e(+t)},n}(.5);function Eh(e,t){this._context=e,this._alpha=t}Eh.prototype={areaStart:Jd,areaEnd:Jd,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:Sh(this,e,t)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var Nh=function e(t){function n(e){return t?new Eh(e,t):new ch(e,0)}return n.alpha=function(t){return e(+t)},n}(.5);function Th(e,t){this._context=e,this._alpha=t}Th.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:Sh(this,e,t)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var Ih=function e(t){function n(e){return t?new Th(e,t):new uh(e,0)}return n.alpha=function(t){return e(+t)},n}(.5);function Dh(e){this._context=e}function Fh(e){return new Dh(e)}function Mh(e){this._context=e}function Oh(e){return e<0?-1:1}function Rh(e,t,n){var r=e._x1-e._x0,a=t-e._x1,i=(e._y1-e._y0)/(r||a<0&&-0),o=(n-e._y1)/(a||r<0&&-0),u=(i*a+o*r)/(r+a);return(Oh(i)+Oh(o))*Math.min(Math.abs(i),Math.abs(o),.5*Math.abs(u))||0}function jh(e,t){var n=e._x1-e._x0;return n?(3*(e._y1-e._y0)/n-t)/2:t}function Bh(e,t,n){var r=e._x0,a=e._y0,i=e._x1,o=e._y1,u=(i-r)/3;e._context.bezierCurveTo(r+u,a+u*t,i-u,o-u*n,i,o)}function zh(e){this._context=e}function Zh(e){this._context=new Lh(e)}function Lh(e){this._context=e}function Ph(e){this._context=e}function Uh(e){var t,n,r=e.length-1,a=new Array(r),i=new Array(r),o=new Array(r);for(a[0]=0,i[0]=2,o[0]=e[0]+2*e[1],t=1;t<r-1;++t)a[t]=1,i[t]=4,o[t]=4*e[t]+2*e[t+1];for(a[r-1]=2,i[r-1]=7,o[r-1]=8*e[r-1]+e[r],t=1;t<r;++t)n=a[t]/i[t-1],i[t]-=n,o[t]-=n*o[t-1];for(a[r-1]=o[r-1]/i[r-1],t=r-2;t>=0;--t)a[t]=(o[t]-a[t+1])/i[t];for(i[r-1]=(e[r]+a[r-1])/2,t=0;t<r-1;++t)i[t]=2*e[t+1]-a[t+1];return[a,i]}function Wh(e,t){this._context=e,this._t=t}function Vh(e){return function(){return e}}function qh(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}Dh.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t)}}},Mh.prototype={areaStart:Jd,areaEnd:Jd,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}},zh.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:Bh(this,this._t0,jh(this,this._t0))}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var n=NaN;if(t=+t,(e=+e)!==this._x1||t!==this._y1){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,Bh(this,jh(this,n=Rh(this,e,t)),n);break;default:Bh(this,this._t0,n=Rh(this,e,t))}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=n}}},(Zh.prototype=Object.create(zh.prototype)).point=function(e,t){zh.prototype.point.call(this,t,e)},Lh.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,n,r,a,i){this._context.bezierCurveTo(t,e,r,n,i,a)}},Ph.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,n=e.length;if(n)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),2===n)this._context.lineTo(e[1],t[1]);else for(var r=Uh(e),a=Uh(t),i=0,o=1;o<n;++i,++o)this._context.bezierCurveTo(r[0][i],a[0][i],r[1][i],a[1][i],e[o],t[o]);(this._line||0!==this._line&&1===n)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}},Wh.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&2===this._point&&this._context.lineTo(this._x,this._y),(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var n=this._x*(1-this._t)+e*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,t)}}this._x=e,this._y=t}};var Gh,Hh,Xh,Kh,Yh,$h,Qh,Jh,ep,tp,np,rp,ap,ip,op=n(5671),up=n(3144),sp=Math.PI,cp=2*sp,lp=1e-6,fp=cp-lp;function dp(e){this._+=e[0];for(var t=1,n=e.length;t<n;++t)this._+=arguments[t]+e[t]}var hp=function(){function e(t){(0,op.Z)(this,e),this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=null==t?dp:function(e){var t=Math.floor(e);if(!(t>=0))throw new Error("invalid digits: ".concat(e));if(t>15)return dp;var n=Math.pow(10,t);return function(e){this._+=e[0];for(var t=1,r=e.length;t<r;++t)this._+=Math.round(arguments[t]*n)/n+e[t]}}(t)}return(0,up.Z)(e,[{key:"moveTo",value:function(e,t){this._append(Gh||(Gh=qh(["M",",",""])),this._x0=this._x1=+e,this._y0=this._y1=+t)}},{key:"closePath",value:function(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._append(Hh||(Hh=qh(["Z"]))))}},{key:"lineTo",value:function(e,t){this._append(Xh||(Xh=qh(["L",",",""])),this._x1=+e,this._y1=+t)}},{key:"quadraticCurveTo",value:function(e,t,n,r){this._append(Kh||(Kh=qh(["Q",",",",",",",""])),+e,+t,this._x1=+n,this._y1=+r)}},{key:"bezierCurveTo",value:function(e,t,n,r,a,i){this._append(Yh||(Yh=qh(["C",",",",",",",",",",",""])),+e,+t,+n,+r,this._x1=+a,this._y1=+i)}},{key:"arcTo",value:function(e,t,n,r,a){if(e=+e,t=+t,n=+n,r=+r,(a=+a)<0)throw new Error("negative radius: ".concat(a));var i=this._x1,o=this._y1,u=n-e,s=r-t,c=i-e,l=o-t,f=c*c+l*l;if(null===this._x1)this._append($h||($h=qh(["M",",",""])),this._x1=e,this._y1=t);else if(f>lp)if(Math.abs(l*u-s*c)>lp&&a){var d=n-i,h=r-o,p=u*u+s*s,v=d*d+h*h,m=Math.sqrt(p),g=Math.sqrt(f),y=a*Math.tan((sp-Math.acos((p+f-v)/(2*m*g)))/2),b=y/g,x=y/m;Math.abs(b-1)>lp&&this._append(Jh||(Jh=qh(["L",",",""])),e+b*c,t+b*l),this._append(ep||(ep=qh(["A",",",",0,0,",",",",",""])),a,a,+(l*d>c*h),this._x1=e+x*u,this._y1=t+x*s)}else this._append(Qh||(Qh=qh(["L",",",""])),this._x1=e,this._y1=t);else;}},{key:"arc",value:function(e,t,n,r,a,i){if(e=+e,t=+t,i=!!i,(n=+n)<0)throw new Error("negative radius: ".concat(n));var o=n*Math.cos(r),u=n*Math.sin(r),s=e+o,c=t+u,l=1^i,f=i?r-a:a-r;null===this._x1?this._append(tp||(tp=qh(["M",",",""])),s,c):(Math.abs(this._x1-s)>lp||Math.abs(this._y1-c)>lp)&&this._append(np||(np=qh(["L",",",""])),s,c),n&&(f<0&&(f=f%cp+cp),f>fp?this._append(rp||(rp=qh(["A",",",",0,1,",",",",","A",",",",0,1,",",",",",""])),n,n,l,e-o,t-u,n,n,l,this._x1=s,this._y1=c):f>lp&&this._append(ap||(ap=qh(["A",",",",0,",",",",",",",""])),n,n,+(f>=sp),l,this._x1=e+n*Math.cos(a),this._y1=t+n*Math.sin(a)))}},{key:"rect",value:function(e,t,n,r){this._append(ip||(ip=qh(["M",",","h","v","h","Z"])),this._x0=this._x1=+e,this._y0=this._y1=+t,n=+n,+r,-n)}},{key:"toString",value:function(){return this._}}]),e}();function pp(){return new hp}function vp(e){var t=3;return e.digits=function(n){if(!arguments.length)return t;if(null==n)t=null;else{var r=Math.floor(n);if(!(r>=0))throw new RangeError("invalid digits: ".concat(n));t=r}return e},function(){return new hp(t)}}function mp(e){return e.innerRadius}function gp(e){return e.outerRadius}function yp(e){return e.startAngle}function bp(e){return e.endAngle}function xp(e){return e&&e.padAngle}function wp(e,t,n,r,a,i,o,u){var s=n-e,c=r-t,l=o-a,f=u-i,d=f*s-l*c;if(!(d*d<yh))return[e+(d=(l*(t-i)-f*(e-a))/d)*s,t+d*c]}function kp(e,t,n,r,a,i,o){var u=e-n,s=t-r,c=(o?i:-i)/gh(u*u+s*s),l=c*s,f=-c*u,d=e+l,h=t+f,p=n+l,v=r+f,m=(d+p)/2,g=(h+v)/2,y=p-d,b=v-h,x=y*y+b*b,w=a-i,k=d*v-p*h,_=(b<0?-1:1)*gh(ph(0,w*w*x-k*k)),S=(k*b-y*_)/x,C=(-k*y-b*_)/x,A=(k*b+y*_)/x,E=(-k*y+b*_)/x,N=S-m,T=C-g,I=A-m,D=E-g;return N*N+T*T>I*I+D*D&&(S=A,C=E),{cx:S,cy:C,x01:-l,y01:-f,x11:S*(a/w-1),y11:C*(a/w-1)}}pp.prototype=hp.prototype;Array.prototype.slice;function _p(e){return"object"===typeof e&&"length"in e?e:Array.from(e)}function Sp(e){return e[0]}function Cp(e){return e[1]}function Ap(e,t){var n=Vh(!0),r=null,a=Fh,i=null,o=vp(u);function u(u){var s,c,l,f=(u=_p(u)).length,d=!1;for(null==r&&(i=a(l=o())),s=0;s<=f;++s)!(s<f&&n(c=u[s],s,u))===d&&((d=!d)?i.lineStart():i.lineEnd()),d&&i.point(+e(c,s,u),+t(c,s,u));if(l)return i=null,l+""||null}return e="function"===typeof e?e:void 0===e?Sp:Vh(e),t="function"===typeof t?t:void 0===t?Cp:Vh(t),u.x=function(t){return arguments.length?(e="function"===typeof t?t:Vh(+t),u):e},u.y=function(e){return arguments.length?(t="function"===typeof e?e:Vh(+e),u):t},u.defined=function(e){return arguments.length?(n="function"===typeof e?e:Vh(!!e),u):n},u.curve=function(e){return arguments.length?(a=e,null!=r&&(i=a(r)),u):a},u.context=function(e){return arguments.length?(null==e?r=i=null:i=a(r=e),u):r},u}function Ep(e,t,n){var r=null,a=Vh(!0),i=null,o=Fh,u=null,s=vp(c);function c(c){var l,f,d,h,p,v=(c=_p(c)).length,m=!1,g=new Array(v),y=new Array(v);for(null==i&&(u=o(p=s())),l=0;l<=v;++l){if(!(l<v&&a(h=c[l],l,c))===m)if(m=!m)f=l,u.areaStart(),u.lineStart();else{for(u.lineEnd(),u.lineStart(),d=l-1;d>=f;--d)u.point(g[d],y[d]);u.lineEnd(),u.areaEnd()}m&&(g[l]=+e(h,l,c),y[l]=+t(h,l,c),u.point(r?+r(h,l,c):g[l],n?+n(h,l,c):y[l]))}if(p)return u=null,p+""||null}function l(){return Ap().defined(a).curve(o).context(i)}return e="function"===typeof e?e:void 0===e?Sp:Vh(+e),t="function"===typeof t?t:Vh(void 0===t?0:+t),n="function"===typeof n?n:void 0===n?Cp:Vh(+n),c.x=function(t){return arguments.length?(e="function"===typeof t?t:Vh(+t),r=null,c):e},c.x0=function(t){return arguments.length?(e="function"===typeof t?t:Vh(+t),c):e},c.x1=function(e){return arguments.length?(r=null==e?null:"function"===typeof e?e:Vh(+e),c):r},c.y=function(e){return arguments.length?(t="function"===typeof e?e:Vh(+e),n=null,c):t},c.y0=function(e){return arguments.length?(t="function"===typeof e?e:Vh(+e),c):t},c.y1=function(e){return arguments.length?(n=null==e?null:"function"===typeof e?e:Vh(+e),c):n},c.lineX0=c.lineY0=function(){return l().x(e).y(t)},c.lineY1=function(){return l().x(e).y(n)},c.lineX1=function(){return l().x(r).y(t)},c.defined=function(e){return arguments.length?(a="function"===typeof e?e:Vh(!!e),c):a},c.curve=function(e){return arguments.length?(o=e,null!=i&&(u=o(i)),c):o},c.context=function(e){return arguments.length?(null==e?i=u=null:u=o(i=e),c):i},c}gh(3);var Np={draw:function(e,t){var n=gh(t/bh);e.moveTo(n,0),e.arc(0,0,n,0,wh)}},Tp=(gh(1/3),mh(bh/10)/mh(7*bh/10));mh(wh/10),hh(wh/10),gh(3),gh(3),gh(3),gh(12);function Ip(e,t){if("undefined"!==typeof document&&document.createElement){var n=document.createElement("canvas");if(n&&n.getContext)return n.width=e,n.height=t,n}return null}var Dp,Fp=function(){return"undefined"!==typeof Image?Image:null},Mp=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Op(e){if(!(t=Mp.exec(e)))throw new Error("invalid format: "+e);var t;return new Rp({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}function Rp(e){this.fill=void 0===e.fill?" ":e.fill+"",this.align=void 0===e.align?">":e.align+"",this.sign=void 0===e.sign?"-":e.sign+"",this.symbol=void 0===e.symbol?"":e.symbol+"",this.zero=!!e.zero,this.width=void 0===e.width?void 0:+e.width,this.comma=!!e.comma,this.precision=void 0===e.precision?void 0:+e.precision,this.trim=!!e.trim,this.type=void 0===e.type?"":e.type+""}function jp(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,r=e.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+e.slice(n+1)]}function Bp(e){return(e=jp(Math.abs(e)))?e[1]:NaN}function zp(e,t){var n=jp(e,t);if(!n)return e+"";var r=n[0],a=n[1];return a<0?"0."+new Array(-a).join("0")+r:r.length>a+1?r.slice(0,a+1)+"."+r.slice(a+1):r+new Array(a-r.length+2).join("0")}Op.prototype=Rp.prototype,Rp.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};var Zp={"%":function(e,t){return(100*e).toFixed(t)},b:function(e){return Math.round(e).toString(2)},c:function(e){return e+""},d:function(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)},e:function(e,t){return e.toExponential(t)},f:function(e,t){return e.toFixed(t)},g:function(e,t){return e.toPrecision(t)},o:function(e){return Math.round(e).toString(8)},p:function(e,t){return zp(100*e,t)},r:zp,s:function(e,t){var n=jp(e,t);if(!n)return e+"";var r=n[0],a=n[1],i=a-(Dp=3*Math.max(-8,Math.min(8,Math.floor(a/3))))+1,o=r.length;return i===o?r:i>o?r+new Array(i-o+1).join("0"):i>0?r.slice(0,i)+"."+r.slice(i):"0."+new Array(1-i).join("0")+jp(e,Math.max(0,t+i-1))[0]},X:function(e){return Math.round(e).toString(16).toUpperCase()},x:function(e){return Math.round(e).toString(16)}};function Lp(e){return e}var Pp,Up,Wp,Vp,qp,Gp,Hp,Xp,Kp,Yp,$p=Array.prototype.map,Qp=["y","z","a","f","p","n","\xb5","m","","k","M","G","T","P","E","Z","Y"];function Jp(e){var t,n,r=void 0===e.grouping||void 0===e.thousands?Lp:(t=$p.call(e.grouping,Number),n=e.thousands+"",function(e,r){for(var a=e.length,i=[],o=0,u=t[0],s=0;a>0&&u>0&&(s+u+1>r&&(u=Math.max(1,r-s)),i.push(e.substring(a-=u,a+u)),!((s+=u+1)>r));)u=t[o=(o+1)%t.length];return i.reverse().join(n)}),a=void 0===e.currency?"":e.currency[0]+"",i=void 0===e.currency?"":e.currency[1]+"",o=void 0===e.decimal?".":e.decimal+"",u=void 0===e.numerals?Lp:function(e){return function(t){return t.replace(/[0-9]/g,(function(t){return e[+t]}))}}($p.call(e.numerals,String)),s=void 0===e.percent?"%":e.percent+"",c=void 0===e.minus?"\u2212":e.minus+"",l=void 0===e.nan?"NaN":e.nan+"";function f(e){var t=(e=Op(e)).fill,n=e.align,f=e.sign,d=e.symbol,h=e.zero,p=e.width,v=e.comma,m=e.precision,g=e.trim,y=e.type;"n"===y?(v=!0,y="g"):Zp[y]||(void 0===m&&(m=12),g=!0,y="g"),(h||"0"===t&&"="===n)&&(h=!0,t="0",n="=");var b="$"===d?a:"#"===d&&/[boxX]/.test(y)?"0"+y.toLowerCase():"",x="$"===d?i:/[%p]/.test(y)?s:"",w=Zp[y],k=/[defgprs%]/.test(y);function _(e){var a,i,s,d=b,_=x;if("c"===y)_=w(e)+_,e="";else{var S=(e=+e)<0||1/e<0;if(e=isNaN(e)?l:w(Math.abs(e),m),g&&(e=function(e){e:for(var t,n=e.length,r=1,a=-1;r<n;++r)switch(e[r]){case".":a=t=r;break;case"0":0===a&&(a=r),t=r;break;default:if(!+e[r])break e;a>0&&(a=0)}return a>0?e.slice(0,a)+e.slice(t+1):e}(e)),S&&0===+e&&"+"!==f&&(S=!1),d=(S?"("===f?f:c:"-"===f||"("===f?"":f)+d,_=("s"===y?Qp[8+Dp/3]:"")+_+(S&&"("===f?")":""),k)for(a=-1,i=e.length;++a<i;)if(48>(s=e.charCodeAt(a))||s>57){_=(46===s?o+e.slice(a+1):e.slice(a))+_,e=e.slice(0,a);break}}v&&!h&&(e=r(e,1/0));var C=d.length+e.length+_.length,A=C<p?new Array(p-C+1).join(t):"";switch(v&&h&&(e=r(A+e,A.length?p-_.length:1/0),A=""),n){case"<":e=d+e+_+A;break;case"=":e=d+A+e+_;break;case"^":e=A.slice(0,C=A.length>>1)+d+e+_+A.slice(C);break;default:e=A+d+e+_}return u(e)}return m=void 0===m?6:/[gprs]/.test(y)?Math.max(1,Math.min(21,m)):Math.max(0,Math.min(20,m)),_.toString=function(){return e+""},_}return{format:f,formatPrefix:function(e,t){var n=f(((e=Op(e)).type="f",e)),r=3*Math.max(-8,Math.min(8,Math.floor(Bp(t)/3))),a=Math.pow(10,-r),i=Qp[8+r/3];return function(e){return n(a*e)+i}}}}!function(e){Pp=Jp(e),Up=Pp.format,Wp=Pp.formatPrefix}({thousands:",",grouping:[3],currency:["$",""]});var ev="year",tv="quarter",nv="month",rv="week",av="date",iv="day",ov="dayofyear",uv="hours",sv="minutes",cv="seconds",lv="milliseconds";[ev,tv,nv,rv,av,iv,ov,uv,sv,cv,lv].reduce((function(e,t,n){return e[t]=1+n,e}),{});Vp={},(0,Xn.Z)(Vp,ev,"%Y "),(0,Xn.Z)(Vp,tv,"Q%q "),(0,Xn.Z)(Vp,nv,"%b "),(0,Xn.Z)(Vp,av,"%d "),(0,Xn.Z)(Vp,rv,"W%U "),(0,Xn.Z)(Vp,iv,"%a "),(0,Xn.Z)(Vp,ov,"%j "),(0,Xn.Z)(Vp,uv,"%H:00"),(0,Xn.Z)(Vp,sv,"00:%M"),(0,Xn.Z)(Vp,cv,":%S"),(0,Xn.Z)(Vp,lv,".%L"),(0,Xn.Z)(Vp,"".concat(ev,"-").concat(nv),"%Y-%m "),(0,Xn.Z)(Vp,"".concat(ev,"-").concat(nv,"-").concat(av),"%Y-%m-%d "),(0,Xn.Z)(Vp,"".concat(uv,"-").concat(sv),"%H:%M");var fv=new Date;function dv(e){return fv.setFullYear(e),fv.setMonth(0),fv.setDate(1),fv.setHours(0,0,0,0),fv}function hv(e){return ir.count(dv(e.getFullYear())-1,e)}function pv(e){return cr.count(dv(e.getFullYear())-1,e)}function vv(e){return dv(e).getDay()}function mv(e){var t=Date.UTC(e.getUTCFullYear(),0,1);return or.count(t-1,e)}function gv(e){var t=Date.UTC(e.getUTCFullYear(),0,1);return gr.count(t-1,e)}function yv(e){return fv.setTime(Date.UTC(e,0,1)),fv.getUTCDay()}function bv(e,t,n){return t+7*e-(n+6)%7}qp={},(0,Xn.Z)(qp,ev,(function(e){return e.getFullYear()})),(0,Xn.Z)(qp,tv,(function(e){return Math.floor(e.getMonth()/3)})),(0,Xn.Z)(qp,nv,(function(e){return e.getMonth()})),(0,Xn.Z)(qp,av,(function(e){return e.getDate()})),(0,Xn.Z)(qp,uv,(function(e){return e.getHours()})),(0,Xn.Z)(qp,sv,(function(e){return e.getMinutes()})),(0,Xn.Z)(qp,cv,(function(e){return e.getSeconds()})),(0,Xn.Z)(qp,lv,(function(e){return e.getMilliseconds()})),(0,Xn.Z)(qp,ov,(function(e){return hv(e)})),(0,Xn.Z)(qp,rv,(function(e){return pv(e)})),(0,Xn.Z)(qp,"weekday",(function(e,t){return bv(pv(e),e.getDay(),vv(t))})),(0,Xn.Z)(qp,iv,(function(e,t){return bv(1,e.getDay(),vv(t))})),Gp={},(0,Xn.Z)(Gp,tv,(function(e){return 3*e})),(0,Xn.Z)(Gp,rv,(function(e,t){return bv(e,0,vv(t))}));Hp={},(0,Xn.Z)(Hp,ev,(function(e){return e.getUTCFullYear()})),(0,Xn.Z)(Hp,tv,(function(e){return Math.floor(e.getUTCMonth()/3)})),(0,Xn.Z)(Hp,nv,(function(e){return e.getUTCMonth()})),(0,Xn.Z)(Hp,av,(function(e){return e.getUTCDate()})),(0,Xn.Z)(Hp,uv,(function(e){return e.getUTCHours()})),(0,Xn.Z)(Hp,sv,(function(e){return e.getUTCMinutes()})),(0,Xn.Z)(Hp,cv,(function(e){return e.getUTCSeconds()})),(0,Xn.Z)(Hp,lv,(function(e){return e.getUTCMilliseconds()})),(0,Xn.Z)(Hp,ov,(function(e){return mv(e)})),(0,Xn.Z)(Hp,rv,(function(e){return gv(e)})),(0,Xn.Z)(Hp,iv,(function(e,t){return bv(1,e.getUTCDay(),yv(t))})),(0,Xn.Z)(Hp,"weekday",(function(e,t){return bv(gv(e),e.getUTCDay(),yv(t))})),Xp={},(0,Xn.Z)(Xp,tv,(function(e){return 3*e})),(0,Xn.Z)(Xp,rv,(function(e,t){return bv(e,0,yv(t))}));var xv=(Kp={},(0,Xn.Z)(Kp,ev,Sr),(0,Xn.Z)(Kp,tv,Ar.every(3)),(0,Xn.Z)(Kp,nv,Ar),(0,Xn.Z)(Kp,rv,cr),(0,Xn.Z)(Kp,av,ir),(0,Xn.Z)(Kp,iv,ir),(0,Xn.Z)(Kp,ov,ir),(0,Xn.Z)(Kp,uv,Nr),(0,Xn.Z)(Kp,sv,Ir),(0,Xn.Z)(Kp,cv,Fr),(0,Xn.Z)(Kp,lv,Mr),Kp),wv=(Yp={},(0,Xn.Z)(Yp,ev,Cr),(0,Xn.Z)(Yp,tv,Er.every(3)),(0,Xn.Z)(Yp,nv,Er),(0,Xn.Z)(Yp,rv,gr),(0,Xn.Z)(Yp,av,or),(0,Xn.Z)(Yp,iv,or),(0,Xn.Z)(Yp,ov,or),(0,Xn.Z)(Yp,uv,Tr),(0,Xn.Z)(Yp,sv,Dr),(0,Xn.Z)(Yp,cv,Fr),(0,Xn.Z)(Yp,lv,Mr),Yp);function kv(e){return xv[e]}function _v(e){return wv[e]}var Sv=[ev,nv,av,uv,sv,cv,lv],Cv=Sv.slice(0,-1),Av=Cv.slice(0,-1),Ev=Av.slice(0,-1);Ev.slice(0,-1);function Nv(e){var t={};return function(n){return t[n]||(t[n]=e(n))}}function Tv(e){var t=Nv(e.format),n=e.formatPrefix;return{format:t,formatPrefix:n,formatFloat:function(e){var n=Op(e||",");if(null==n.precision){switch(n.precision=12,n.type){case"%":n.precision-=2;break;case"e":n.precision-=1}return function(e,t){return function(n){var r=e(n),a=r.indexOf(t);if(a<0)return r;for(var i=function(e,t){var n,r=e.lastIndexOf("e");if(r>0)return r;for(r=e.length;--r>t;)if((n=e.charCodeAt(r))>=48&&n<=57)return r+1}(r,a),o=i<r.length?r.slice(i):"";--i>a;)if("0"!==r[i]){++i;break}return r.slice(0,i)+o}}(t(n),t(".1f")(1)[1])}return t(n)},formatSpan:function(e,r,a,i){i=Op(null==i?",f":i);var o,u=Fn(e,r,a),s=Math.max(Math.abs(e),Math.abs(r));if(null==i.precision)switch(i.type){case"s":return isNaN(o=function(e,t){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(Bp(t)/3)))-Bp(Math.abs(e)))}(u,s))||(i.precision=o),n(i,s);case"":case"e":case"g":case"p":case"r":isNaN(o=function(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,Bp(t)-Bp(e))+1}(u,s))||(i.precision=o-("e"===i.type));break;case"f":case"%":isNaN(o=function(e){return Math.max(0,-Bp(Math.abs(e)))}(u))||(i.precision=o-2*("%"===i.type))}return t(i)}}}function Iv(){return Tv({format:Up,formatPrefix:Wp})}function Dv(e,t,n){Zd(n=n||{})||Md("Invalid time multi-format specifier: ".concat(n));var r=t(cv),a=t(sv),i=t(uv),o=t(av),u=t(rv),s=t(nv),c=t(tv),l=t(ev),f=e(n.milliseconds||".%L"),d=e(n.seconds||":%S"),h=e(n.minutes||"%I:%M"),p=e(n.hours||"%I %p"),v=e(n.date||n.day||"%a %d"),m=e(n.week||"%b %d"),g=e(n.month||"%B"),y=e(n.quarter||"%B"),b=e(n.year||"%Y");return function(e){return(r(e)<e?f:a(e)<e?d:i(e)<e?h:o(e)<e?p:s(e)<e?u(e)<e?v:m:l(e)<e?c(e)<e?g:y:b)(e)}}function Fv(e){var t=Nv(e.format),n=Nv(e.utcFormat);return{timeFormat:function(e){return Xd(e)?t(e):Dv(t,kv,e)},utcFormat:function(e){return Xd(e)?n(e):Dv(n,_v,e)},timeParse:Nv(e.parse),utcParse:Nv(e.utcParse)}}function Mv(){return Fv({format:xa,parse:wa,utcFormat:ka,utcParse:_a})}Iv(),Mv();var Ov=/^(data:|([A-Za-z]+:)?\/\/)/,Rv=/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp|file|data):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i,jv=/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205f\u3000]/g,Bv="file://";function zv(e,t){return Zv.apply(this,arguments)}function Zv(){return(Zv=(0,jt.Z)(w().mark((function e(t,n){var r,a;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.sanitize(t,n);case 2:return r=e.sent,a=r.href,e.abrupt("return",r.localFile?this.file(a):this.http(a,n));case 5:case"end":return e.stop()}}),e,this)})))).apply(this,arguments)}function Lv(e,t){return Pv.apply(this,arguments)}function Pv(){return Pv=(0,jt.Z)(w().mark((function e(t,n){var r,a,i,o,u,s,c;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=Vd({},this.options,n),r=this.fileAccess,a={href:null},s=Rv.test(t.replace(jv,"")),null!=t&&"string"===typeof t&&s||Md("Sanitize failure, invalid URI: "+Kd(t)),c=Ov.test(t),(u=n.baseURL)&&!c&&(t.startsWith("/")||u.endsWith("/")||(t="/"+t),t=u+t),o=(i=t.startsWith(Bv))||"file"===n.mode||"http"!==n.mode&&!c&&r,i?t=t.slice(Bv.length):t.startsWith("//")&&("file"===n.defaultProtocol?(t=t.slice(2),o=!0):t=(n.defaultProtocol||"http")+":"+t),Object.defineProperty(a,"localFile",{value:!!o}),a.href=t,n.target&&(a.target=n.target+""),n.rel&&(a.rel=n.rel+""),"image"===n.context&&n.crossOrigin&&(a.crossOrigin=n.crossOrigin+""),e.abrupt("return",a);case 14:case"end":return e.stop()}}),e,this)}))),Pv.apply(this,arguments)}function Uv(e){return e?function(t){return new Promise((function(n,r){e.readFile(t,(function(e,t){e?r(e):n(t)}))}))}:Wv}function Wv(){return Vv.apply(this,arguments)}function Vv(){return(Vv=(0,jt.Z)(w().mark((function e(){return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Md("No file system access.");case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function qv(e){return e?function(){var t=(0,jt.Z)(w().mark((function t(n,r){var a,i,o;return w().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=Vd({},this.options.http,r),i=r&&r.response,t.next=4,e(n,a);case 4:return o=t.sent,t.abrupt("return",o.ok?Wd(o[i])?o[i]():o.text():Md(o.status+""+o.statusText));case 6:case"end":return t.stop()}}),t,this)})));return function(e,n){return t.apply(this,arguments)}}():Gv}function Gv(){return Hv.apply(this,arguments)}function Hv(){return(Hv=(0,jt.Z)(w().mark((function e(){return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Md("No HTTP fetch method available.");case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Xv(e){var t=function(t,n){var r={delimiter:e};return Kv(t,n?Vd(n,r):r)};return t.responseType="text",t}function Kv(e,t){return t.header&&(e=t.header.map(Kd).join(t.delimiter)+"\n"+e),mn(t.delimiter).parse(e+"")}function Yv(e,t){var n,r=t&&t.property?Rd(t.property):jd;return!Zd(e)||(n=e,"function"===typeof Buffer&&Wd(Buffer.isBuffer)&&Buffer.isBuffer(n))?r(JSON.parse(e)):function(e,t){!zd(e)&&function(e){return e&&Wd(e[Symbol.iterator])}(e)&&(e=(0,cn.Z)(e));return t&&t.copy?JSON.parse(JSON.stringify(e)):e}(r(e),t)}Kv.responseType="text",Yv.responseType="json";var $v={interior:function(e,t){return e!==t},exterior:function(e,t){return e===t}};function Qv(e,t){var n,r,a,i;return e=Yv(e,t),t&&t.feature?(n=yn,a=t.feature):t&&t.mesh?(n=kn,a=t.mesh,i=$v[t.filter]):Md("Missing TopoJSON feature or mesh parameter."),(r=(r=e.objects[a])?n(e,r,i):Md("Invalid TopoJSON object: "+a))&&r.features||[r]}Qv.responseType="json";Xv(","),Xv("\t");var Jv=function(e,t){return function(n){return{options:n||{},sanitize:Lv,load:zv,fileAccess:!!t,file:Uv(t),http:qv(e)}}}("undefined"!==typeof fetch&&fetch,null);function em(e,t,n){e=+e,t=+t,n=(a=arguments.length)<2?(t=e,e=0,1):a<3?1:+n;for(var r=-1,a=0|Math.max(0,Math.ceil((t-e)/n)),i=new Array(a);++r<a;)i[r]=e+r*n;return i}function tm(e,t){return null==e||null==t?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function nm(e,t){return null==e||null==t?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function rm(e){var t,n,r;function a(e,r){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.length;if(a<i){if(0!==t(r,r))return i;do{var o=a+i>>>1;n(e[o],r)<0?a=o+1:i=o}while(a<i)}return a}return 2!==e.length?(t=tm,n=function(t,n){return tm(e(t),n)},r=function(t,n){return e(t)-n}):(t=e===tm||e===nm?e:am,n=e,r=e),{left:a,center:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.length,o=a(e,t,n,i-1);return o>n&&r(e[o-1],t)>-r(e[o],t)?o-1:o},right:function(e,r){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.length;if(a<i){if(0!==t(r,r))return i;do{var o=a+i>>>1;n(e[o],r)<=0?a=o+1:i=o}while(a<i)}return a}}}function am(){return 0}function im(e){return null===e?NaN:+e}var om=rm(tm),um=om.right,sm=(om.left,rm(im).center,um),cm=n(7114),lm=n(4837),fm=n(3739);function dm(e){return+e}var hm=[0,1];function pm(e){return e}function vm(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:function(e){return function(){return e}}(isNaN(t)?NaN:.5)}function mm(e,t,n){var r=e[0],a=e[1],i=t[0],o=t[1];return a<r?(r=vm(a,r),i=n(o,i)):(r=vm(r,a),i=n(i,o)),function(e){return i(r(e))}}function gm(e,t,n){var r=Math.min(e.length,t.length)-1,a=new Array(r),i=new Array(r),o=-1;for(e[r]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++o<r;)a[o]=vm(e[o],e[o+1]),i[o]=n(t[o],t[o+1]);return function(t){var n=sm(e,t,1,r)-1;return i[n](a[n](t))}}function ym(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function bm(){var e,t,n,r,a,i,o=hm,u=hm,s=cm.Z,c=pm;function l(){var e=Math.min(o.length,u.length);return c!==pm&&(c=function(e,t){var n;return e>t&&(n=e,e=t,t=n),function(n){return Math.max(e,Math.min(t,n))}}(o[0],o[e-1])),r=e>2?gm:mm,a=i=null,f}function f(t){return null==t||isNaN(t=+t)?n:(a||(a=r(o.map(e),u,s)))(e(c(t)))}return f.invert=function(n){return c(t((i||(i=r(u,o.map(e),lm.Z)))(n)))},f.domain=function(e){return arguments.length?(o=Array.from(e,dm),l()):o.slice()},f.range=function(e){return arguments.length?(u=Array.from(e),l()):u.slice()},f.rangeRound=function(e){return u=Array.from(e),s=fm.Z,l()},f.clamp=function(e){return arguments.length?(c=!!e||pm,l()):c!==pm},f.interpolate=function(e){return arguments.length?(s=e,l()):s},f.unknown=function(e){return arguments.length?(n=e,f):n},function(n,r){return e=n,t=r,l()}}function xm(){return bm()(pm,pm)}function wm(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e)}return this}function km(e,t){switch(arguments.length){case 0:break;case 1:"function"===typeof e?this.interpolator(e):this.range(e);break;default:this.domain(e),"function"===typeof t?this.interpolator(t):this.range(t)}return this}var _m=n(1848);function Sm(e,t,n,r){var a,i=Fn(e,t,n);switch((r=(0,_m.formatSpecifier)(null==r?",f":r)).type){case"s":var o=Math.max(Math.abs(e),Math.abs(t));return null!=r.precision||isNaN(a=(0,_m.precisionPrefix)(i,o))||(r.precision=a),(0,_m.formatPrefix)(r,o);case"":case"e":case"g":case"p":case"r":null!=r.precision||isNaN(a=(0,_m.precisionRound)(i,Math.max(Math.abs(e),Math.abs(t))))||(r.precision=a-("e"===r.type));break;case"f":case"%":null!=r.precision||isNaN(a=(0,_m.precisionFixed)(i))||(r.precision=a-2*("%"===r.type))}return(0,_m.format)(r)}function Cm(e){var t=e.domain;return e.ticks=function(e){var n=t();return In(n[0],n[n.length-1],null==e?10:e)},e.tickFormat=function(e,n){var r=t();return Sm(r[0],r[r.length-1],null==e?10:e,n)},e.nice=function(n){null==n&&(n=10);var r,a,i=t(),o=0,u=i.length-1,s=i[o],c=i[u],l=10;for(c<s&&(a=s,s=c,c=a,a=o,o=u,u=a);l-- >0;){if((a=Dn(s,c,n))===r)return i[o]=s,i[u]=c,t(i);if(a>0)s=Math.floor(s/a)*a,c=Math.ceil(c/a)*a;else{if(!(a<0))break;s=Math.ceil(s*a)/a,c=Math.floor(c*a)/a}r=a}return e},e}function Am(){var e=xm();return e.copy=function(){return ym(e,Am())},wm.apply(e,arguments),Cm(e)}function Em(e){var t;function n(e){return null==e||isNaN(e=+e)?t:e}return n.invert=n,n.domain=n.range=function(t){return arguments.length?(e=Array.from(t,dm),n):e.slice()},n.unknown=function(e){return arguments.length?(t=e,n):t},n.copy=function(){return Em(e).unknown(t)},e=arguments.length?Array.from(e,dm):[0,1],Cm(n)}function Nm(e,t){var n,r=0,a=(e=e.slice()).length-1,i=e[r],o=e[a];return o<i&&(n=r,r=a,a=n,n=i,i=o,o=n),e[r]=t.floor(i),e[a]=t.ceil(o),e}function Tm(e){return Math.log(e)}function Im(e){return Math.exp(e)}function Dm(e){return-Math.log(-e)}function Fm(e){return-Math.exp(-e)}function Mm(e){return isFinite(e)?+("1e"+e):e<0?0:e}function Om(e){return function(t,n){return-e(-t,n)}}function Rm(e){var t,n,r=e(Tm,Im),a=r.domain,i=10;function o(){return t=function(e){return e===Math.E?Math.log:10===e&&Math.log10||2===e&&Math.log2||(e=Math.log(e),function(t){return Math.log(t)/e})}(i),n=function(e){return 10===e?Mm:e===Math.E?Math.exp:function(t){return Math.pow(e,t)}}(i),a()[0]<0?(t=Om(t),n=Om(n),e(Dm,Fm)):e(Tm,Im),r}return r.base=function(e){return arguments.length?(i=+e,o()):i},r.domain=function(e){return arguments.length?(a(e),o()):a()},r.ticks=function(e){var r=a(),o=r[0],u=r[r.length-1],s=u<o;if(s){var c=[u,o];o=c[0],u=c[1]}var l,f,d=t(o),h=t(u),p=null==e?10:+e,v=[];if(!(i%1)&&h-d<p){if(d=Math.floor(d),h=Math.ceil(h),o>0){for(;d<=h;++d)for(l=1;l<i;++l)if(!((f=d<0?l/n(-d):l*n(d))<o)){if(f>u)break;v.push(f)}}else for(;d<=h;++d)for(l=i-1;l>=1;--l)if(!((f=d>0?l/n(-d):l*n(d))<o)){if(f>u)break;v.push(f)}2*v.length<p&&(v=In(o,u,p))}else v=In(d,h,Math.min(h-d,p)).map(n);return s?v.reverse():v},r.tickFormat=function(e,a){if(null==e&&(e=10),null==a&&(a=10===i?"s":","),"function"!==typeof a&&(i%1||null!=(a=(0,_m.formatSpecifier)(a)).precision||(a.trim=!0),a=(0,_m.format)(a)),e===1/0)return a;var o=Math.max(1,i*e/r.ticks().length);return function(e){var r=e/n(Math.round(t(e)));return r*i<i-.5&&(r*=i),r<=o?a(e):""}},r.nice=function(){return a(Nm(a(),{floor:function(e){return n(Math.floor(t(e)))},ceil:function(e){return n(Math.ceil(t(e)))}}))},r}function jm(){var e=Rm(bm()).domain([1,10]);return e.copy=function(){return ym(e,jm()).base(e.base())},wm.apply(e,arguments),e}function Bm(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function zm(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function Zm(e){return e<0?-e*e:e*e}function Lm(e){var t=e(pm,pm),n=1;function r(){return 1===n?e(pm,pm):.5===n?e(zm,Zm):e(Bm(n),Bm(1/n))}return t.exponent=function(e){return arguments.length?(n=+e,r()):n},Cm(t)}function Pm(){var e=Lm(bm());return e.copy=function(){return ym(e,Pm()).exponent(e.exponent())},wm.apply(e,arguments),e}function Um(){return Pm.apply(null,arguments).exponent(.5)}function Wm(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function Vm(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function qm(e){var t=1,n=e(Wm(t),Vm(t));return n.constant=function(n){return arguments.length?e(Wm(t=+n),Vm(t)):t},Cm(n)}function Gm(){var e=qm(bm());return e.copy=function(){return ym(e,Gm()).constant(e.constant())},wm.apply(e,arguments)}function Hm(e,t,n,r,a,i){var o=[[Fr,1,Qn],[Fr,5,5e3],[Fr,15,15e3],[Fr,30,3e4],[i,1,Jn],[i,5,3e5],[i,15,9e5],[i,30,18e5],[a,1,er],[a,3,108e5],[a,6,216e5],[a,12,432e5],[r,1,tr],[r,2,1728e5],[n,1,nr],[t,1,rr],[t,3,7776e6],[e,1,ar]];function u(t,n,r){var a=Math.abs(n-t)/r,i=rm((function(e){return(0,Cn.Z)(e,3)[2]})).right(o,a);if(i===o.length)return e.every(Fn(t/ar,n/ar,r));if(0===i)return Mr.every(Math.max(Fn(t,n,r),1));var u=(0,Cn.Z)(o[a/o[i-1][2]<o[i][2]/a?i-1:i],2),s=u[0],c=u[1];return s.every(c)}return[function(e,t,n){var r=t<e;if(r){var a=[t,e];e=a[0],t=a[1]}var i=n&&"function"===typeof n.range?n:u(e,t,n),o=i?i.range(e,+t+1):[];return r?o.reverse():o},u]}var Xm=Hm(Cr,Er,gr,ur,Tr,Dr),Km=(0,Cn.Z)(Xm,2),Ym=Km[0],$m=Km[1],Qm=Hm(Sr,Ar,cr,ir,Nr,Ir),Jm=(0,Cn.Z)(Qm,2),eg=Jm[0],tg=Jm[1];function ng(e){return new Date(e)}function rg(e){return e instanceof Date?+e:+new Date(+e)}function ag(e,t,n,r,a,i,o,u,s,c){var l=xm(),f=l.invert,d=l.domain,h=c(".%L"),p=c(":%S"),v=c("%I:%M"),m=c("%I %p"),g=c("%a %d"),y=c("%b %d"),b=c("%B"),x=c("%Y");function w(e){return(s(e)<e?h:u(e)<e?p:o(e)<e?v:i(e)<e?m:r(e)<e?a(e)<e?g:y:n(e)<e?b:x)(e)}return l.invert=function(e){return new Date(f(e))},l.domain=function(e){return arguments.length?d(Array.from(e,rg)):d().map(ng)},l.ticks=function(t){var n=d();return e(n[0],n[n.length-1],null==t?10:t)},l.tickFormat=function(e,t){return null==t?w:c(t)},l.nice=function(e){var n=d();return e&&"function"===typeof e.range||(e=t(n[0],n[n.length-1],null==e?10:e)),e?d(Nm(n,e)):l},l.copy=function(){return ym(l,ag(e,t,n,r,a,i,o,u,s,c))},l}function ig(){return wm.apply(ag(eg,tg,Sr,Ar,cr,ir,Nr,Ir,Fr,xa).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function og(){return wm.apply(ag(Ym,$m,Cr,Er,gr,or,Tr,Dr,Fr,ka).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function ug(){var e,t,n,r,a,i=0,o=1,u=pm,s=!1;function c(t){return null==t||isNaN(t=+t)?a:u(0===n?.5:(t=(r(t)-e)*n,s?Math.max(0,Math.min(1,t)):t))}function l(e){return function(t){var n,r,a,i;return arguments.length?(n=t,a=(r=(0,Cn.Z)(n,2))[0],i=r[1],u=e(a,i),c):[u(0),u(1)]}}return c.domain=function(a){var u,s;return arguments.length?(u=a,s=(0,Cn.Z)(u,2),i=s[0],o=s[1],e=r(i=+i),t=r(o=+o),n=e===t?0:1/(t-e),c):[i,o]},c.clamp=function(e){return arguments.length?(s=!!e,c):s},c.interpolator=function(e){return arguments.length?(u=e,c):u},c.range=l(cm.Z),c.rangeRound=l(fm.Z),c.unknown=function(e){return arguments.length?(a=e,c):a},function(a){return r=a,e=a(i),t=a(o),n=e===t?0:1/(t-e),c}}function sg(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function cg(){var e=Cm(ug()(pm));return e.copy=function(){return sg(e,cg())},km.apply(e,arguments)}function lg(){var e=Rm(ug()).domain([1,10]);return e.copy=function(){return sg(e,lg()).base(e.base())},km.apply(e,arguments)}function fg(){var e=qm(ug());return e.copy=function(){return sg(e,fg()).constant(e.constant())},km.apply(e,arguments)}function dg(){var e=Lm(ug());return e.copy=function(){return sg(e,dg()).exponent(e.exponent())},km.apply(e,arguments)}function hg(){return dg.apply(null,arguments).exponent(.5)}var pg=n(5188);function vg(){var e,t,n,r,a,i,o,u=0,s=.5,c=1,l=1,f=pm,d=!1;function h(e){return isNaN(e=+e)?o:(e=.5+((e=+i(e))-t)*(l*e<l*t?r:a),f(d?Math.max(0,Math.min(1,e)):e))}function p(e){return function(t){var n,r,a,i,o;return arguments.length?(n=t,a=(r=(0,Cn.Z)(n,3))[0],i=r[1],o=r[2],f=(0,pg.Z)(e,[a,i,o]),h):[f(0),f(.5),f(1)]}}return h.domain=function(o){var f,d;return arguments.length?(f=o,d=(0,Cn.Z)(f,3),u=d[0],s=d[1],c=d[2],e=i(u=+u),t=i(s=+s),n=i(c=+c),r=e===t?0:.5/(t-e),a=t===n?0:.5/(n-t),l=t<e?-1:1,h):[u,s,c]},h.clamp=function(e){return arguments.length?(d=!!e,h):d},h.interpolator=function(e){return arguments.length?(f=e,h):f},h.range=p(cm.Z),h.rangeRound=p(fm.Z),h.unknown=function(e){return arguments.length?(o=e,h):o},function(o){return i=o,e=o(u),t=o(s),n=o(c),r=e===t?0:.5/(t-e),a=t===n?0:.5/(n-t),l=t<e?-1:1,h}}function mg(){var e=Cm(vg()(pm));return e.copy=function(){return sg(e,mg())},km.apply(e,arguments)}function gg(){var e=Rm(vg()).domain([.1,1,10]);return e.copy=function(){return sg(e,gg()).base(e.base())},km.apply(e,arguments)}function yg(){var e=qm(vg());return e.copy=function(){return sg(e,yg()).constant(e.constant())},km.apply(e,arguments)}function bg(){var e=Lm(vg());return e.copy=function(){return sg(e,bg()).exponent(e.exponent())},km.apply(e,arguments)}function xg(){return bg.apply(null,arguments).exponent(.5)}function wg(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:im;if((r=e.length)&&!isNaN(t=+t)){if(t<=0||r<2)return+n(e[0],0,e);if(t>=1)return+n(e[r-1],r-1,e);var r,a=(r-1)*t,i=Math.floor(a),o=+n(e[i],i,e),u=+n(e[i+1],i+1,e);return o+(u-o)*(a-i)}}function kg(){var e,t=[],n=[],r=[];function a(){var e=0,a=Math.max(1,n.length);for(r=new Array(a-1);++e<a;)r[e-1]=wg(t,e/a);return i}function i(t){return null==t||isNaN(t=+t)?e:n[sm(r,t)]}return i.invertExtent=function(e){var a=n.indexOf(e);return a<0?[NaN,NaN]:[a>0?r[a-1]:t[0],a<r.length?r[a]:t[t.length-1]]},i.domain=function(e){if(!arguments.length)return t.slice();t=[];var n,r=(0,Rt.Z)(e);try{for(r.s();!(n=r.n()).done;){var i=n.value;null==i||isNaN(i=+i)||t.push(i)}}catch(o){r.e(o)}finally{r.f()}return t.sort(tm),a()},i.range=function(e){return arguments.length?(n=Array.from(e),a()):n.slice()},i.unknown=function(t){return arguments.length?(e=t,i):e},i.quantiles=function(){return r.slice()},i.copy=function(){return kg().domain(t).range(n).unknown(e)},wm.apply(i,arguments)}function _g(){var e,t=0,n=1,r=1,a=[.5],i=[0,1];function o(t){return null!=t&&t<=t?i[sm(a,t,0,r)]:e}function u(){var e=-1;for(a=new Array(r);++e<r;)a[e]=((e+1)*n-(e-r)*t)/(r+1);return o}return o.domain=function(e){var r,a;return arguments.length?(r=e,a=(0,Cn.Z)(r,2),t=a[0],n=a[1],t=+t,n=+n,u()):[t,n]},o.range=function(e){return arguments.length?(r=(i=Array.from(e)).length-1,u()):i.slice()},o.invertExtent=function(e){var o=i.indexOf(e);return o<0?[NaN,NaN]:o<1?[t,a[0]]:o>=r?[a[r-1],n]:[a[o-1],a[o]]},o.unknown=function(t){return arguments.length?(e=t,o):o},o.thresholds=function(){return a.slice()},o.copy=function(){return _g().domain([t,n]).range(i).unknown(e)},wm.apply(Cm(o),arguments)}function Sg(){var e,t=[.5],n=[0,1],r=1;function a(a){return null!=a&&a<=a?n[sm(t,a,0,r)]:e}return a.domain=function(e){return arguments.length?(t=Array.from(e),r=Math.min(t.length,n.length-1),a):t.slice()},a.range=function(e){return arguments.length?(n=Array.from(e),r=Math.min(t.length,n.length-1),a):n.slice()},a.invertExtent=function(e){var r=n.indexOf(e);return[t[r-1],t[r]]},a.unknown=function(t){return arguments.length?(e=t,a):e},a.copy=function(){return Sg().domain(t).range(n).unknown(e)},wm.apply(a,arguments)}var Cg=n(7326),Ag=n(1752),Eg=n(1120),Ng=n(136),Tg=n(7277),Ig=n(8664),Dg=function(e){(0,Ng.Z)(n,e);var t=(0,Tg.Z)(n);function n(e){var r,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:jg;if((0,op.Z)(this,n),r=t.call(this),Object.defineProperties((0,Cg.Z)(r),{_intern:{value:new Map},_key:{value:a}}),null!=e){var i,o=(0,Rt.Z)(e);try{for(o.s();!(i=o.n()).done;){var u=(0,Cn.Z)(i.value,2),s=u[0],c=u[1];r.set(s,c)}}catch(l){o.e(l)}finally{o.f()}}return r}return(0,up.Z)(n,[{key:"get",value:function(e){return(0,Ag.Z)((0,Eg.Z)(n.prototype),"get",this).call(this,Mg(this,e))}},{key:"has",value:function(e){return(0,Ag.Z)((0,Eg.Z)(n.prototype),"has",this).call(this,Mg(this,e))}},{key:"set",value:function(e,t){return(0,Ag.Z)((0,Eg.Z)(n.prototype),"set",this).call(this,Og(this,e),t)}},{key:"delete",value:function(e){return(0,Ag.Z)((0,Eg.Z)(n.prototype),"delete",this).call(this,Rg(this,e))}}]),n}((0,Ig.Z)(Map)),Fg=function(e){(0,Ng.Z)(n,e);var t=(0,Tg.Z)(n);function n(e){var r,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:jg;if((0,op.Z)(this,n),r=t.call(this),Object.defineProperties((0,Cg.Z)(r),{_intern:{value:new Map},_key:{value:a}}),null!=e){var i,o=(0,Rt.Z)(e);try{for(o.s();!(i=o.n()).done;){var u=i.value;r.add(u)}}catch(s){o.e(s)}finally{o.f()}}return r}return(0,up.Z)(n,[{key:"has",value:function(e){return(0,Ag.Z)((0,Eg.Z)(n.prototype),"has",this).call(this,Mg(this,e))}},{key:"add",value:function(e){return(0,Ag.Z)((0,Eg.Z)(n.prototype),"add",this).call(this,Og(this,e))}},{key:"delete",value:function(e){return(0,Ag.Z)((0,Eg.Z)(n.prototype),"delete",this).call(this,Rg(this,e))}}]),n}((0,Ig.Z)(Set));function Mg(e,t){var n=e._intern,r=(0,e._key)(t);return n.has(r)?n.get(r):t}function Og(e,t){var n=e._intern,r=(0,e._key)(t);return n.has(r)?n.get(r):(n.set(r,t),t)}function Rg(e,t){var n=e._intern,r=(0,e._key)(t);return n.has(r)&&(t=n.get(r),n.delete(r)),t}function jg(e){return null!==e&&"object"===typeof e?e.valueOf():e}var Bg=Symbol("implicit");function zg(){var e=new Dg,t=[],n=[],r=Bg;function a(a){var i=e.get(a);if(void 0===i){if(r!==Bg)return r;e.set(a,i=t.push(a)-1)}return n[i%n.length]}return a.domain=function(n){if(!arguments.length)return t.slice();t=[],e=new Dg;var r,i=(0,Rt.Z)(n);try{for(i.s();!(r=i.n()).done;){var o=r.value;e.has(o)||e.set(o,t.push(o)-1)}}catch(u){i.e(u)}finally{i.f()}return a},a.range=function(e){return arguments.length?(n=Array.from(e),a):n.slice()},a.unknown=function(e){return arguments.length?(r=e,a):r},a.copy=function(){return zg(t,n).unknown(r)},wm.apply(a,arguments),a}var Zg,Lg,Pg=n(2989);var Ug="linear",Wg="log",Vg="pow",qg="sqrt",Gg="symlog",Hg="time",Xg="utc",Kg="sequential",Yg="diverging",$g="quantile",Qg="quantize",Jg="threshold",ey="continuous",ty="discrete",ny="discretizing",ry="interpolating",ay="temporal";function iy(){var e,t,n=zg().unknown(void 0),r=n.domain,a=n.range,i=[0,1],o=!1,u=0,s=0,c=.5;function l(){var n=r().length,l=i[1]<i[0],f=i[1-l],d=function(e,t,n){var r=e-t+2*n;return e?r>0?r:1:0}(n,u,s),h=i[l-0];e=(f-h)/(d||1),o&&(e=Math.floor(e)),h+=(f-h-e*(n-u))*c,t=e*(1-u),o&&(h=Math.round(h),t=Math.round(t));var p=em(n).map((function(t){return h+e*t}));return a(l?p.reverse():p)}return delete n.unknown,n.domain=function(e){return arguments.length?(r(e),l()):r()},n.range=function(e){return arguments.length?(i=[+e[0],+e[1]],l()):i.slice()},n.rangeRound=function(e){return i=[+e[0],+e[1]],o=!0,l()},n.bandwidth=function(){return t},n.step=function(){return e},n.round=function(e){return arguments.length?(o=!!e,l()):o},n.padding=function(e){return arguments.length?(s=Math.max(0,Math.min(1,e)),u=s,l()):u},n.paddingInner=function(e){return arguments.length?(u=Math.max(0,Math.min(1,e)),l()):u},n.paddingOuter=function(e){return arguments.length?(s=Math.max(0,Math.min(1,e)),l()):s},n.align=function(e){return arguments.length?(c=Math.max(0,Math.min(1,e)),l()):c},n.invertRange=function(e){if(null!=e[0]&&null!=e[1]){var n,o,u,s=i[1]<i[0],c=s?a().reverse():a(),l=c.length-1,f=+e[0],d=+e[1];if(f===f&&d===d&&(d<f&&(u=f,f=d,d=u),!(d<c[0]||f>i[1-s])))return n=Math.max(0,um(c,f)-1),o=f===d?n:um(c,d)-1,f-c[n]>t+1e-10&&++n,s&&(u=n,n=l-o,o=l-u),n>o?void 0:r().slice(n,o+1)}},n.invert=function(e){var t=n.invertRange([e,e]);return t?t[0]:t},n.copy=function(){return iy().domain(r()).range(i).round(o).paddingInner(u).paddingOuter(s).align(c)},l()}function oy(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,e.copy=function(){return oy(t())},e}var uy=Array.prototype.map;function sy(e){return uy.call(e,Pd)}var cy=Array.prototype.slice;var ly=new Map,fy=Symbol("vega_scale");function dy(e,t,n){var r=function(){var n=t();return n.invertRange||(n.invertRange=n.invert?function(e){return function(t){var n,r=t[0],a=t[1];return a<r&&(n=r,r=a,a=n),[e.invert(r),e.invert(a)]}}(n):n.invertExtent?function(e){return function(t){var n,r,a,i,o=e.range(),u=t[0],s=t[1],c=-1;for(s<u&&(r=u,u=s,s=r),a=0,i=o.length;a<i;++a)o[a]>=u&&o[a]<=s&&(c<0&&(c=a),n=a);if(!(c<0))return u=e.invertExtent(o[c]),s=e.invertExtent(o[n]),[void 0===u[0]?u[1]:u[0],void 0===s[1]?s[0]:s[1]]}}(n):void 0),n.type=e,function(e){return e[fy]=!0,e}(n)};return r.metadata=Yd(Ud(n)),r}function hy(e,t,n){return arguments.length>1?(ly.set(e,dy(e,t,n)),this):py(e)?ly.get(e):void 0}function py(e){return ly.has(e)}function vy(e,t){var n=ly.get(e);return n&&n.metadata[t]}function my(e){return vy(e,ty)}hy("identity",Em),hy(Ug,Am,ey),hy(Wg,jm,[ey,Wg]),hy(Vg,Pm,ey),hy(qg,Um,ey),hy(Gg,Gm,ey),hy(Hg,ig,[ey,ay]),hy(Xg,og,[ey,ay]),hy(Kg,cg,[ey,ry]),hy("".concat(Kg,"-").concat(Ug),cg,[ey,ry]),hy("".concat(Kg,"-").concat(Wg),lg,[ey,ry,Wg]),hy("".concat(Kg,"-").concat(Vg),dg,[ey,ry]),hy("".concat(Kg,"-").concat(qg),hg,[ey,ry]),hy("".concat(Kg,"-").concat(Gg),fg,[ey,ry]),hy("".concat(Yg,"-").concat(Ug),mg,[ey,ry]),hy("".concat(Yg,"-").concat(Wg),gg,[ey,ry,Wg]),hy("".concat(Yg,"-").concat(Vg),bg,[ey,ry]),hy("".concat(Yg,"-").concat(qg),xg,[ey,ry]),hy("".concat(Yg,"-").concat(Gg),yg,[ey,ry]),hy($g,kg,[ny,$g]),hy(Qg,_g,ny),hy(Jg,Sg,ny),hy("bin-ordinal",(function e(){var t=[],n=[];function r(e){return null==e||e!==e?void 0:n[(sm(t,e)-1)%n.length]}return r.domain=function(e){return arguments.length?(t=sy(e),r):t.slice()},r.range=function(e){return arguments.length?(n=cy.call(e),r):n.slice()},r.tickFormat=function(e,n){return Sm(t[0],Ld(t),null==e?10:e,n)},r.copy=function(){return e().domain(r.domain()).range(r.range())},r}),[ty,ny]),hy("ordinal",zg,ty),hy("band",iy,ty),hy("point",(function(){return oy(iy().paddingInner(1))}),ty);function gy(e,t,n){return pg.Z(function(e,t){var n=Pg[function(e){return"interpolate"+e.toLowerCase().split("-").map((function(e){return e[0].toUpperCase()+e.slice(1)})).join("")}(e)];return null!=t&&n&&n.gamma?n.gamma(t):n}(t||"rgb",n),e)}function yy(e){for(var t=e.length/6|0,n=new Array(t),r=0;r<t;)n[r]="#"+e.slice(6*r,6*++r);return n}function by(e,t){for(var n in e)wy(n,t(e[n]))}var xy={};function wy(e,t){return e=e&&e.toLowerCase(),arguments.length>1?(xy[e]=t,this):xy[e]}by({category10:"1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf",category20:"1f77b4aec7e8ff7f0effbb782ca02c98df8ad62728ff98969467bdc5b0d58c564bc49c94e377c2f7b6d27f7f7fc7c7c7bcbd22dbdb8d17becf9edae5",category20b:"393b795254a36b6ecf9c9ede6379398ca252b5cf6bcedb9c8c6d31bd9e39e7ba52e7cb94843c39ad494ad6616be7969c7b4173a55194ce6dbdde9ed6",category20c:"3182bd6baed69ecae1c6dbefe6550dfd8d3cfdae6bfdd0a231a35474c476a1d99bc7e9c0756bb19e9ac8bcbddcdadaeb636363969696bdbdbdd9d9d9",tableau10:"4c78a8f58518e4575672b7b254a24beeca3bb279a2ff9da69d755dbab0ac",tableau20:"4c78a89ecae9f58518ffbf7954a24b88d27ab79a20f2cf5b43989483bcb6e45756ff9d9879706ebab0acd67195fcbfd2b279a2d6a5c99e765fd8b5a5",accent:"7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666",dark2:"1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666",paired:"a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928",pastel1:"fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2",pastel2:"b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc",set1:"e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999",set2:"66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3",set3:"8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f"},yy),by({blues:"cfe1f2bed8eca8cee58fc1de74b2d75ba3cf4592c63181bd206fb2125ca40a4a90",greens:"d3eecdc0e6baabdda594d3917bc77d60ba6c46ab5e329a512089430e7735036429",greys:"e2e2e2d4d4d4c4c4c4b1b1b19d9d9d8888887575756262624d4d4d3535351e1e1e",oranges:"fdd8b3fdc998fdb87bfda55efc9244f87f2cf06b18e4580bd14904b93d029f3303",purples:"e2e1efd4d4e8c4c5e0b4b3d6a3a0cc928ec3827cb97566ae684ea25c3696501f8c",reds:"fdc9b4fcb49afc9e80fc8767fa7051f6573fec3f2fdc2a25c81b1db21218970b13",blueGreen:"d5efedc1e8e0a7ddd18bd2be70c6a958ba9144ad77319c5d2089460e7736036429",bluePurple:"ccddecbad0e4a8c2dd9ab0d4919cc98d85be8b6db28a55a6873c99822287730f71",greenBlue:"d3eecec5e8c3b1e1bb9bd8bb82cec269c2ca51b2cd3c9fc7288abd1675b10b60a1",orangeRed:"fddcaffdcf9bfdc18afdad77fb9562f67d53ee6545e24932d32d1ebf130da70403",purpleBlue:"dbdaebc8cee4b1c3de97b7d87bacd15b9fc93a90c01e7fb70b70ab056199045281",purpleBlueGreen:"dbd8eac8cee4b0c3de93b7d872acd1549fc83892bb1c88a3097f8702736b016353",purpleRed:"dcc9e2d3b3d7ce9eccd186c0da6bb2e14da0e23189d91e6fc61159ab07498f023a",redPurple:"fccfccfcbec0faa9b8f98faff571a5ec539ddb3695c41b8aa908808d0179700174",yellowGreen:"e4f4acd1eca0b9e2949ed68880c97c62bb6e47aa5e3297502083440e723b036034",yellowOrangeBrown:"feeaa1fedd84fecc63feb746fca031f68921eb7215db5e0bc54c05ab3d038f3204",yellowOrangeRed:"fee087fed16ffebd59fea849fd903efc7335f9522bee3423de1b20ca0b22af0225",blueOrange:"134b852f78b35da2cb9dcae1d2e5eff2f0ebfce0bafbbf74e8932fc5690d994a07",brownBlueGreen:"704108a0651ac79548e3c78af3e6c6eef1eac9e9e48ed1c74da79e187a72025147",purpleGreen:"5b1667834792a67fb6c9aed3e6d6e8eff0efd9efd5aedda971bb75368e490e5e29",purpleOrange:"4114696647968f83b7b9b4d6dadbebf3eeeafce0bafbbf74e8932fc5690d994a07",redBlue:"8c0d25bf363adf745ef4ae91fbdbc9f2efeed2e5ef9dcae15da2cb2f78b3134b85",redGrey:"8c0d25bf363adf745ef4ae91fcdccbfaf4f1e2e2e2c0c0c0969696646464343434",yellowGreenBlue:"eff9bddbf1b4bde5b594d5b969c5be45b4c22c9ec02182b82163aa23479c1c3185",redYellowBlue:"a50026d4322cf16e43fcac64fedd90faf8c1dcf1ecabd6e875abd04a74b4313695",redYellowGreen:"a50026d4322cf16e43fcac63fedd8df9f7aed7ee8ea4d86e64bc6122964f006837",pinkYellowGreen:"8e0152c0267edd72adf0b3d6faddedf5f3efe1f2cab6de8780bb474f9125276419",spectral:"9e0142d13c4bf0704afcac63fedd8dfbf8b0e0f3a1a9dda269bda94288b55e4fa2",viridis:"440154470e61481a6c482575472f7d443a834144873d4e8a39568c35608d31688e2d708e2a788e27818e23888e21918d1f988b1fa08822a8842ab07f35b77943bf7154c56866cc5d7ad1518fd744a5db36bcdf27d2e21be9e51afde725",magma:"0000040404130b0924150e3720114b2c11603b0f704a107957157e651a80721f817f24828c29819a2e80a8327db6377ac43c75d1426fde4968e95462f1605df76f5cfa7f5efc8f65fe9f6dfeaf78febf84fece91fddea0fcedaffcfdbf",inferno:"0000040403130c0826170c3b240c4f330a5f420a68500d6c5d126e6b176e781c6d86216b932667a12b62ae305cbb3755c73e4cd24644dd513ae65c30ed6925f3771af8850ffb9506fca50afcb519fac62df6d645f2e661f3f484fcffa4",plasma:"0d088723069033059742039d5002a25d01a66a00a87801a88405a7900da49c179ea72198b12a90ba3488c33d80cb4779d35171da5a69e16462e76e5bed7953f2834cf68f44fa9a3dfca636fdb32ffec029fcce25f9dc24f5ea27f0f921",cividis:"00205100235800265d002961012b65042e670831690d346b11366c16396d1c3c6e213f6e26426e2c456e31476e374a6e3c4d6e42506e47536d4c566d51586e555b6e5a5e6e5e616e62646f66676f6a6a706e6d717270717573727976737c79747f7c75827f758682768985778c8877908b78938e789691789a94789e9778a19b78a59e77a9a177aea575b2a874b6ab73bbaf71c0b26fc5b66dc9b96acebd68d3c065d8c462ddc85fe2cb5ce7cf58ebd355f0d652f3da4ff7de4cfae249fce647",rainbow:"6e40aa883eb1a43db3bf3cafd83fa4ee4395fe4b83ff576eff6659ff7847ff8c38f3a130e2b72fcfcc36bee044aff05b8ff4576ff65b52f6673af27828ea8d1ddfa319d0b81cbecb23abd82f96e03d82e14c6edb5a5dd0664dbf6e40aa",sinebow:"ff4040fc582af47218e78d0bd5a703bfbf00a7d5038de70b72f41858fc2a40ff402afc5818f4720be78d03d5a700bfbf03a7d50b8de71872f42a58fc4040ff582afc7218f48d0be7a703d5bf00bfd503a7e70b8df41872fc2a58ff4040",turbo:"23171b32204a3e2a71453493493eae4b49c54a53d7485ee44569ee4074f53c7ff8378af93295f72e9ff42ba9ef28b3e926bce125c5d925cdcf27d5c629dcbc2de3b232e9a738ee9d3ff39347f68950f9805afc7765fd6e70fe667cfd5e88fc5795fb51a1f84badf545b9f140c5ec3cd0e637dae034e4d931ecd12ef4c92bfac029ffb626ffad24ffa223ff9821ff8d1fff821dff771cfd6c1af76118f05616e84b14df4111d5380fcb2f0dc0260ab61f07ac1805a313029b0f00950c00910b00",browns:"eedbbdecca96e9b97ae4a865dc9856d18954c7784cc0673fb85536ad44339f3632",tealBlues:"bce4d89dd3d181c3cb65b3c245a2b9368fae347da0306a932c5985",teals:"bbdfdfa2d4d58ac9c975bcbb61b0af4da5a43799982b8b8c1e7f7f127273006667",warmGreys:"dcd4d0cec5c1c0b8b4b3aaa7a59c9998908c8b827f7e7673726866665c5a59504e",goldGreen:"f4d166d5ca60b6c35c98bb597cb25760a6564b9c533f8f4f33834a257740146c36",goldOrange:"f4d166f8be5cf8aa4cf5983bf3852aef701be2621fd65322c54923b142239e3a26",goldRed:"f4d166f6be59f9aa51fc964ef6834bee734ae56249db5247cf4244c43141b71d3e",lightGreyRed:"efe9e6e1dad7d5cbc8c8bdb9bbaea9cd967ddc7b43e15f19df4011dc000b",lightGreyTeal:"e4eaead6dcddc8ced2b7c2c7a6b4bc64b0bf22a6c32295c11f85be1876bc",lightMulti:"e0f1f2c4e9d0b0de9fd0e181f6e072f6c053f3993ef77440ef4a3c",lightOrange:"f2e7daf7d5baf9c499fab184fa9c73f68967ef7860e8645bde515bd43d5b",lightTealBlue:"e3e9e0c0dccf9aceca7abfc859afc0389fb9328dad2f7ca0276b95255988",darkBlue:"3232322d46681a5c930074af008cbf05a7ce25c0dd38daed50f3faffffff",darkGold:"3c3c3c584b37725e348c7631ae8b2bcfa424ecc31ef9de30fff184ffffff",darkGreen:"3a3a3a215748006f4d048942489e4276b340a6c63dd2d836ffeb2cffffaa",darkMulti:"3737371f5287197d8c29a86995ce3fffe800ffffff",darkRed:"3434347036339e3c38cc4037e75d1eec8620eeab29f0ce32ffeb2c"},(function(e){return gy(yy(e))}));var ky=function(e){return zd(e)?e.map((function(e){return String(e)})):String(e)},_y=function(e,t){return e[1]-t[1]},Sy=function(e,t){return t[1]-e[1]};function Cy(e,t){return e.bins?function(e,t,n){var r=e.range(),a=r[0],i=Ld(r),o=_y;if(a>i&&(r=i,i=a,a=r,o=Sy),a=Math.floor(a),i=Math.ceil(i),t=t.map((function(t){return[t,e(t)]})).filter((function(e){return a<=e[1]&&e[1]<=i})).sort(o).map((function(e){return e[0]})),n>0&&t.length>1){for(var u=[t[0],Ld(t)];t.length>n&&t.length>=3;)t=t.filter((function(e,t){return!(t%2)}));t.length<3&&(t=u)}return t}(e,e.bins):e.ticks?e.ticks(t):e.domain()}function Ay(e,t,n,r,a,i){var o=t.type,u=ky;if(o===Hg||a===Hg)u=e.timeFormat(r);else if(o===Xg||a===Xg)u=e.utcFormat(r);else if(function(e){return vy(e,Wg)}(o)){var s=e.formatFloat(r);if(i||t.bins)u=s;else{var c=Ey(t,n,!1);u=function(e){return c(e)?s(e):""}}}else if(t.tickFormat){var l=t.domain();u=e.formatSpan(l[0],l[l.length-1],n,r)}else r&&(u=e.format(r));return u}function Ey(e,t,n){var r=Cy(e,t),a=e.base(),i=Math.log(a),o=Math.max(1,a*t/r.length),u=function(e){var t=e/Math.pow(a,Math.round(Math.log(e)/i));return t*a<a-.5&&(t*=a),t<=o};return n?r.filter(u):u}var Ny=(Zg={},(0,Xn.Z)(Zg,$g,"quantiles"),(0,Xn.Z)(Zg,Qg,"thresholds"),(0,Xn.Z)(Zg,Jg,"domain"),Zg),Ty=(Lg={},(0,Xn.Z)(Lg,$g,"quantiles"),(0,Xn.Z)(Lg,Qg,"domain"),Lg);function Iy(e,t){return e.bins?function(e){var t=e.slice(0,-1);return t.max=Ld(e),t}(e.bins):e.type===Wg?Ey(e,t,!0):Ny[e.type]?function(e){var t=[-1/0].concat(e);return t.max=1/0,t}(e[Ny[e.type]]()):Cy(e,t)}function Dy(e,t,n,r,a,i,o){var u=Ty[t.type]&&i!==Hg&&i!==Xg?function(e,t,n){var r,a=t[Ty[t.type]](),i=a.length,o=i>1?a[1]-a[0]:a[0];for(r=1;r<i;++r)o=Math.min(o,a[r]-a[r-1]);return e.formatSpan(0,o,30,n)}(e,t,a):Ay(e,t,n,a,i,o);return"symbol"===r&&function(e){return Ny[e.type]||e.bins}(t)?Fy(u):"discrete"===r?Oy(u):Ry(u)}var Fy=function(e){return function(t,n,r){var a=My(r[n+1],My(r.max,1/0)),i=jy(t,e),o=jy(a,e);return i&&o?i+" \u2013 "+o:o?"< "+o:"\u2265 "+i}},My=function(e,t){return null!=e?e:t},Oy=function(e){return function(t,n){return n?e(t):null}},Ry=function(e){return function(t){return e(t)}},jy=function(e,t){return Number.isFinite(e)?t(e):null};function By(e,t,n,r){var a=r||t.type;return Xd(n)&&function(e){return vy(e,ay)}(a)&&(n=n.replace(/%a/g,"%A").replace(/%b/g,"%B")),n||a!==Hg?n||a!==Xg?Dy(e,t,5,null,n,r,!0):e.utcFormat("%A, %d %B %Y, %X UTC"):e.timeFormat("%A, %d %B %Y, %X")}function zy(e,t,n){n=n||{};var r=Math.max(3,n.maxlen||7),a=By(e,t,n.format,n.formatType);if(function(e){return vy(e,ny)}(t.type)){var i=Iy(t).slice(1).map(a),o=i.length;return"".concat(o," boundar").concat(1===o?"y":"ies",": ").concat(i.join(", "))}if(my(t.type)){var u=t.domain(),s=u.length,c=s>r?u.slice(0,r-2).map(a).join(", ")+", ending with "+u.slice(-1).map(a):u.map(a).join(", ");return"".concat(s," value").concat(1===s?"":"s",": ").concat(c)}var l=t.domain();return"values from ".concat(a(l[0])," to ").concat(a(Ld(l)))}var Zy=0;var Ly="p_";function Py(e){return e&&e.gradient}function Uy(e,t,n){var r=e.gradient,a=e.id,i="radial"===r?Ly:"";return a||(a=e.id="gradient_"+Zy++,"radial"===r?(e.x1=Wy(e.x1,.5),e.y1=Wy(e.y1,.5),e.r1=Wy(e.r1,0),e.x2=Wy(e.x2,.5),e.y2=Wy(e.y2,.5),e.r2=Wy(e.r2,.5),i=Ly):(e.x1=Wy(e.x1,0),e.y1=Wy(e.y1,0),e.x2=Wy(e.x2,1),e.y2=Wy(e.y2,0))),t[a]=e,"url("+(n||"")+"#"+i+a+")"}function Wy(e,t){return null!=e?e:t}var Vy={basis:{curve:function(e){return new Qd(e)}},"basis-closed":{curve:function(e){return new eh(e)}},"basis-open":{curve:function(e){return new th(e)}},bundle:{curve:rh,tension:"beta",value:.85},cardinal:{curve:oh,tension:"tension",value:0},"cardinal-open":{curve:sh,tension:"tension",value:0},"cardinal-closed":{curve:lh,tension:"tension",value:0},"catmull-rom":{curve:Ah,tension:"alpha",value:.5},"catmull-rom-closed":{curve:Nh,tension:"alpha",value:.5},"catmull-rom-open":{curve:Ih,tension:"alpha",value:.5},linear:{curve:Fh},"linear-closed":{curve:function(e){return new Mh(e)}},monotone:{horizontal:function(e){return new Zh(e)},vertical:function(e){return new zh(e)}},natural:{curve:function(e){return new Ph(e)}},step:{curve:function(e){return new Wh(e,.5)}},"step-after":{curve:function(e){return new Wh(e,1)}},"step-before":{curve:function(e){return new Wh(e,0)}}};function qy(e,t,n){var r=Gd(Vy,e)&&Vy[e],a=null;return r&&(a=r.curve||r[t||"vertical"],r.tension&&null!=n&&(a=a[r.tension](n))),a}var Gy={m:2,l:2,h:1,v:1,z:0,c:6,s:4,q:4,t:2,a:7},Hy=/[mlhvzcsqta]([^mlhvzcsqta]+|$)/gi,Xy=/^[+-]?(([0-9]*\.[0-9]+)|([0-9]+\.)|([0-9]+))([eE][+-]?[0-9]+)?/,Ky=/^((\s+,?\s*)|(,\s*))/,Yy=/^[01]/;function $y(e){var t=[];return(e.match(Hy)||[]).forEach((function(e){var n=e[0],r=n.toLowerCase(),a=Gy[r],i=function(e,t,n){for(var r=[],a=0;t&&a<n.length;)for(var i=0;i<t;++i){var o="a"!==e||3!==i&&4!==i?Xy:Yy,u=n.slice(a).match(o);if(null===u)throw Error("Invalid SVG path, incorrect parameter type");a+=u[0].length,r.push(+u[0]);var s=n.slice(a).match(Ky);null!==s&&(a+=s[0].length)}return r}(r,a,e.slice(1).trim()),o=i.length;if(o<a||o&&o%a!==0)throw Error("Invalid SVG path, incorrect parameter count");if(t.push([n].concat((0,cn.Z)(i.slice(0,a)))),o!==a){"m"===r&&(n="M"===n?"L":"l");for(var u=a;u<o;u+=a)t.push([n].concat((0,cn.Z)(i.slice(u,u+a))))}})),t}var Qy=Math.PI/180,Jy=Math.PI/2,eb=2*Math.PI,tb=Math.sqrt(3)/2,nb={},rb={},ab=[].join;function ib(e){var t=ab.call(e);if(rb[t])return rb[t];var n=e[0],r=e[1],a=e[2],i=e[3],o=e[4],u=e[5],s=e[6],c=e[7],l=c*o,f=-s*u,d=s*o,h=c*u,p=Math.cos(a),v=Math.sin(a),m=Math.cos(i),g=Math.sin(i),y=.5*(i-a),b=Math.sin(.5*y),x=8/3*b*b/Math.sin(y),w=n+p-x*v,k=r+v+x*p,_=n+m,S=r+g,C=_+x*g,A=S-x*m;return rb[t]=[l*w+f*k,d*w+h*k,l*C+f*A,d*C+h*A,l*_+f*S,d*_+h*S]}var ob=["l",0,0,0,0,0,0,0];function ub(e,t,n){var r=ob[0]=e[0];if("a"===r||"A"===r)ob[1]=t*e[1],ob[2]=n*e[2],ob[3]=e[3],ob[4]=e[4],ob[5]=e[5],ob[6]=t*e[6],ob[7]=n*e[7];else if("h"===r||"H"===r)ob[1]=t*e[1];else if("v"===r||"V"===r)ob[1]=n*e[1];else for(var a=1,i=e.length;a<i;++a)ob[a]=(a%2==1?t:n)*e[a];return ob}function sb(e,t,n,r,a,i){var o,u,s,c,l,f=null,d=0,h=0,p=0,v=0,m=0,g=0;null==n&&(n=0),null==r&&(r=0),null==a&&(a=1),null==i&&(i=a),e.beginPath&&e.beginPath();for(var y=0,b=t.length;y<b;++y){switch(o=t[y],1===a&&1===i||(o=ub(o,a,i)),o[0]){case"l":d+=o[1],h+=o[2],e.lineTo(d+n,h+r);break;case"L":d=o[1],h=o[2],e.lineTo(d+n,h+r);break;case"h":d+=o[1],e.lineTo(d+n,h+r);break;case"H":d=o[1],e.lineTo(d+n,h+r);break;case"v":h+=o[1],e.lineTo(d+n,h+r);break;case"V":h=o[1],e.lineTo(d+n,h+r);break;case"m":m=d+=o[1],g=h+=o[2],e.moveTo(d+n,h+r);break;case"M":m=d=o[1],g=h=o[2],e.moveTo(d+n,h+r);break;case"c":u=d+o[5],s=h+o[6],p=d+o[3],v=h+o[4],e.bezierCurveTo(d+o[1]+n,h+o[2]+r,p+n,v+r,u+n,s+r),d=u,h=s;break;case"C":d=o[5],h=o[6],p=o[3],v=o[4],e.bezierCurveTo(o[1]+n,o[2]+r,p+n,v+r,d+n,h+r);break;case"s":u=d+o[3],s=h+o[4],p=2*d-p,v=2*h-v,e.bezierCurveTo(p+n,v+r,d+o[1]+n,h+o[2]+r,u+n,s+r),p=d+o[1],v=h+o[2],d=u,h=s;break;case"S":u=o[3],s=o[4],p=2*d-p,v=2*h-v,e.bezierCurveTo(p+n,v+r,o[1]+n,o[2]+r,u+n,s+r),d=u,h=s,p=o[1],v=o[2];break;case"q":u=d+o[3],s=h+o[4],p=d+o[1],v=h+o[2],e.quadraticCurveTo(p+n,v+r,u+n,s+r),d=u,h=s;break;case"Q":u=o[3],s=o[4],e.quadraticCurveTo(o[1]+n,o[2]+r,u+n,s+r),d=u,h=s,p=o[1],v=o[2];break;case"t":u=d+o[1],s=h+o[2],null===f[0].match(/[QqTt]/)?(p=d,v=h):"t"===f[0]?(p=2*d-c,v=2*h-l):"q"===f[0]&&(p=2*d-p,v=2*h-v),c=p,l=v,e.quadraticCurveTo(p+n,v+r,u+n,s+r),h=s,p=(d=u)+o[1],v=h+o[2];break;case"T":u=o[1],s=o[2],p=2*d-p,v=2*h-v,e.quadraticCurveTo(p+n,v+r,u+n,s+r),d=u,h=s;break;case"a":cb(e,d+n,h+r,[o[1],o[2],o[3],o[4],o[5],o[6]+d+n,o[7]+h+r]),d+=o[6],h+=o[7];break;case"A":cb(e,d+n,h+r,[o[1],o[2],o[3],o[4],o[5],o[6]+n,o[7]+r]),d=o[6],h=o[7];break;case"z":case"Z":d=m,h=g,e.closePath()}f=o}}function cb(e,t,n,r){for(var a=function(e,t,n,r,a,i,o,u,s){var c=ab.call(arguments);if(nb[c])return nb[c];var l=o*Qy,f=Math.sin(l),d=Math.cos(l),h=d*(u-e)*.5+f*(s-t)*.5,p=d*(s-t)*.5-f*(u-e)*.5,v=h*h/((n=Math.abs(n))*n)+p*p/((r=Math.abs(r))*r);v>1&&(n*=v=Math.sqrt(v),r*=v);var m=d/n,g=f/n,y=-f/r,b=d/r,x=m*u+g*s,w=y*u+b*s,k=m*e+g*t,_=y*e+b*t,S=1/((k-x)*(k-x)+(_-w)*(_-w))-.25;S<0&&(S=0);var C=Math.sqrt(S);i==a&&(C=-C);var A=.5*(x+k)-C*(_-w),E=.5*(w+_)+C*(k-x),N=Math.atan2(w-E,x-A),T=Math.atan2(_-E,k-A)-N;T<0&&1===i?T+=eb:T>0&&0===i&&(T-=eb);for(var I=Math.ceil(Math.abs(T/(Jy+.001))),D=[],F=0;F<I;++F){var M=N+F*T/I,O=N+(F+1)*T/I;D[F]=[A,E,M,O,n,r,f,d]}return nb[c]=D}(r[5],r[6],r[0],r[1],r[3],r[4],r[2],t,n),i=0;i<a.length;++i){var o=ib(a[i]);e.bezierCurveTo(o[0],o[1],o[2],o[3],o[4],o[5])}}var lb=.5773502691896257,fb={circle:{draw:function(e,t){var n=Math.sqrt(t)/2;e.moveTo(n,0),e.arc(0,0,n,0,eb)}},cross:{draw:function(e,t){var n=Math.sqrt(t)/2,r=n/2.5;e.moveTo(-n,-r),e.lineTo(-n,r),e.lineTo(-r,r),e.lineTo(-r,n),e.lineTo(r,n),e.lineTo(r,r),e.lineTo(n,r),e.lineTo(n,-r),e.lineTo(r,-r),e.lineTo(r,-n),e.lineTo(-r,-n),e.lineTo(-r,-r),e.closePath()}},diamond:{draw:function(e,t){var n=Math.sqrt(t)/2;e.moveTo(-n,0),e.lineTo(0,-n),e.lineTo(n,0),e.lineTo(0,n),e.closePath()}},square:{draw:function(e,t){var n=Math.sqrt(t),r=-n/2;e.rect(r,r,n,n)}},arrow:{draw:function(e,t){var n=Math.sqrt(t)/2,r=n/7,a=n/2.5,i=n/8;e.moveTo(-r,n),e.lineTo(r,n),e.lineTo(r,-i),e.lineTo(a,-i),e.lineTo(0,-n),e.lineTo(-a,-i),e.lineTo(-r,-i),e.closePath()}},wedge:{draw:function(e,t){var n=Math.sqrt(t)/2,r=tb*n,a=r-n*lb,i=n/4;e.moveTo(0,-r-a),e.lineTo(-i,r-a),e.lineTo(i,r-a),e.closePath()}},triangle:{draw:function(e,t){var n=Math.sqrt(t)/2,r=tb*n,a=r-n*lb;e.moveTo(0,-r-a),e.lineTo(-n,r-a),e.lineTo(n,r-a),e.closePath()}},"triangle-up":{draw:function(e,t){var n=Math.sqrt(t)/2,r=tb*n;e.moveTo(0,-r),e.lineTo(-n,r),e.lineTo(n,r),e.closePath()}},"triangle-down":{draw:function(e,t){var n=Math.sqrt(t)/2,r=tb*n;e.moveTo(0,r),e.lineTo(-n,-r),e.lineTo(n,-r),e.closePath()}},"triangle-right":{draw:function(e,t){var n=Math.sqrt(t)/2,r=tb*n;e.moveTo(r,0),e.lineTo(-r,-n),e.lineTo(-r,n),e.closePath()}},"triangle-left":{draw:function(e,t){var n=Math.sqrt(t)/2,r=tb*n;e.moveTo(-r,0),e.lineTo(r,-n),e.lineTo(r,n),e.closePath()}},stroke:{draw:function(e,t){var n=Math.sqrt(t)/2;e.moveTo(-n,0),e.lineTo(n,0)}}};function db(e){return Gd(fb,e)?fb[e]:function(e){if(!Gd(hb,e)){var t=$y(e);hb[e]={draw:function(e,n){sb(e,t,0,0,Math.sqrt(n)/2)}}}return hb[e]}(e)}var hb={};var pb=.448084975506;function vb(e){return e.x}function mb(e){return e.y}function gb(e){return e.width}function yb(e){return e.height}function bb(e){return"function"===typeof e?e:function(){return+e}}function xb(e,t,n){return Math.max(t,Math.min(e,n))}function wb(e,t){return null!=e?e:t}var kb=function(e){return e.x||0},_b=function(e){return e.y||0},Sb=function(e){return!(!1===e.defined)},Cb=function(){var e=mp,t=gp,n=Vh(0),r=null,a=yp,i=bp,o=xp,u=null,s=vp(c);function c(){var c,l,f=+e.apply(this,arguments),d=+t.apply(this,arguments),h=a.apply(this,arguments)-xh,p=i.apply(this,arguments)-xh,v=fh(p-h),m=p>h;if(u||(u=c=s()),d<f&&(l=d,d=f,f=l),d>yh)if(v>wh-yh)u.moveTo(d*hh(h),d*mh(h)),u.arc(0,0,d,h,p,!m),f>yh&&(u.moveTo(f*hh(p),f*mh(p)),u.arc(0,0,f,p,h,m));else{var g,y,b=h,x=p,w=h,k=p,_=v,S=v,C=o.apply(this,arguments)/2,A=C>yh&&(r?+r.apply(this,arguments):gh(f*f+d*d)),E=vh(fh(d-f)/2,+n.apply(this,arguments)),N=E,T=E;if(A>yh){var I=_h(A/f*mh(C)),D=_h(A/d*mh(C));(_-=2*I)>yh?(w+=I*=m?1:-1,k-=I):(_=0,w=k=(h+p)/2),(S-=2*D)>yh?(b+=D*=m?1:-1,x-=D):(S=0,b=x=(h+p)/2)}var F=d*hh(b),M=d*mh(b),O=f*hh(k),R=f*mh(k);if(E>yh){var j,B=d*hh(x),z=d*mh(x),Z=f*hh(w),L=f*mh(w);if(v<bh)if(j=wp(F,M,Z,L,B,z,O,R)){var P=F-j[0],U=M-j[1],W=B-j[0],V=z-j[1],q=1/mh(kh((P*W+U*V)/(gh(P*P+U*U)*gh(W*W+V*V)))/2),G=gh(j[0]*j[0]+j[1]*j[1]);N=vh(E,(f-G)/(q-1)),T=vh(E,(d-G)/(q+1))}else N=T=0}S>yh?T>yh?(g=kp(Z,L,F,M,d,T,m),y=kp(B,z,O,R,d,T,m),u.moveTo(g.cx+g.x01,g.cy+g.y01),T<E?u.arc(g.cx,g.cy,T,dh(g.y01,g.x01),dh(y.y01,y.x01),!m):(u.arc(g.cx,g.cy,T,dh(g.y01,g.x01),dh(g.y11,g.x11),!m),u.arc(0,0,d,dh(g.cy+g.y11,g.cx+g.x11),dh(y.cy+y.y11,y.cx+y.x11),!m),u.arc(y.cx,y.cy,T,dh(y.y11,y.x11),dh(y.y01,y.x01),!m))):(u.moveTo(F,M),u.arc(0,0,d,b,x,!m)):u.moveTo(F,M),f>yh&&_>yh?N>yh?(g=kp(O,R,B,z,f,-N,m),y=kp(F,M,Z,L,f,-N,m),u.lineTo(g.cx+g.x01,g.cy+g.y01),N<E?u.arc(g.cx,g.cy,N,dh(g.y01,g.x01),dh(y.y01,y.x01),!m):(u.arc(g.cx,g.cy,N,dh(g.y01,g.x01),dh(g.y11,g.x11),!m),u.arc(0,0,f,dh(g.cy+g.y11,g.cx+g.x11),dh(y.cy+y.y11,y.cx+y.x11),m),u.arc(y.cx,y.cy,N,dh(y.y11,y.x11),dh(y.y01,y.x01),!m))):u.arc(0,0,f,k,w,m):u.lineTo(O,R)}else u.moveTo(0,0);if(u.closePath(),c)return u=null,c+""||null}return c.centroid=function(){var n=(+e.apply(this,arguments)+ +t.apply(this,arguments))/2,r=(+a.apply(this,arguments)+ +i.apply(this,arguments))/2-bh/2;return[hh(r)*n,mh(r)*n]},c.innerRadius=function(t){return arguments.length?(e="function"===typeof t?t:Vh(+t),c):e},c.outerRadius=function(e){return arguments.length?(t="function"===typeof e?e:Vh(+e),c):t},c.cornerRadius=function(e){return arguments.length?(n="function"===typeof e?e:Vh(+e),c):n},c.padRadius=function(e){return arguments.length?(r=null==e?null:"function"===typeof e?e:Vh(+e),c):r},c.startAngle=function(e){return arguments.length?(a="function"===typeof e?e:Vh(+e),c):a},c.endAngle=function(e){return arguments.length?(i="function"===typeof e?e:Vh(+e),c):i},c.padAngle=function(e){return arguments.length?(o="function"===typeof e?e:Vh(+e),c):o},c.context=function(e){return arguments.length?(u=null==e?null:e,c):u},c}().startAngle((function(e){return e.startAngle||0})).endAngle((function(e){return e.endAngle||0})).padAngle((function(e){return e.padAngle||0})).innerRadius((function(e){return e.innerRadius||0})).outerRadius((function(e){return e.outerRadius||0})).cornerRadius((function(e){return e.cornerRadius||0})),Ab=Ep().x(kb).y1(_b).y0((function(e){return(e.y||0)+(e.height||0)})).defined(Sb),Eb=Ep().y(_b).x1(kb).x0((function(e){return(e.x||0)+(e.width||0)})).defined(Sb),Nb=Ap().x(kb).y(_b).defined(Sb),Tb=function(){var e=vb,t=mb,n=gb,r=yb,a=bb(0),i=a,o=a,u=a,s=null;function c(c,l,f){var d,h=null!=l?l:+e.call(this,c),p=null!=f?f:+t.call(this,c),v=+n.call(this,c),m=+r.call(this,c),g=Math.min(v,m)/2,y=xb(+a.call(this,c),0,g),b=xb(+i.call(this,c),0,g),x=xb(+o.call(this,c),0,g),w=xb(+u.call(this,c),0,g);if(s||(s=d=pp()),y<=0&&b<=0&&x<=0&&w<=0)s.rect(h,p,v,m);else{var k=h+v,_=p+m;s.moveTo(h+y,p),s.lineTo(k-b,p),s.bezierCurveTo(k-pb*b,p,k,p+pb*b,k,p+b),s.lineTo(k,_-w),s.bezierCurveTo(k,_-pb*w,k-pb*w,_,k-w,_),s.lineTo(h+x,_),s.bezierCurveTo(h+pb*x,_,h,_-pb*x,h,_-x),s.lineTo(h,p+y),s.bezierCurveTo(h,p+pb*y,h+pb*y,p,h+y,p),s.closePath()}if(d)return s=null,d+""||null}return c.x=function(t){return arguments.length?(e=bb(t),c):e},c.y=function(e){return arguments.length?(t=bb(e),c):t},c.width=function(e){return arguments.length?(n=bb(e),c):n},c.height=function(e){return arguments.length?(r=bb(e),c):r},c.cornerRadius=function(e,t,n,r){return arguments.length?(a=bb(e),i=null!=t?bb(t):a,u=null!=n?bb(n):a,o=null!=r?bb(r):i,c):a},c.context=function(e){return arguments.length?(s=null==e?null:e,c):s},c}().x(kb).y(_b).width((function(e){return e.width||0})).height((function(e){return e.height||0})).cornerRadius((function(e){return wb(e.cornerRadiusTopLeft,e.cornerRadius)||0}),(function(e){return wb(e.cornerRadiusTopRight,e.cornerRadius)||0}),(function(e){return wb(e.cornerRadiusBottomRight,e.cornerRadius)||0}),(function(e){return wb(e.cornerRadiusBottomLeft,e.cornerRadius)||0})),Ib=function(e,t){var n=null,r=vp(a);function a(){var a;if(n||(n=a=r()),e.apply(this,arguments).draw(n,+t.apply(this,arguments)),a)return n=null,a+""||null}return e="function"===typeof e?e:Vh(e||Np),t="function"===typeof t?t:Vh(void 0===t?64:+t),a.type=function(t){return arguments.length?(e="function"===typeof t?t:Vh(t),a):e},a.size=function(e){return arguments.length?(t="function"===typeof e?e:Vh(+e),a):t},a.context=function(e){return arguments.length?(n=null==e?null:e,a):n},a}().type((function(e){return db(e.shape||"circle")})).size((function(e){return wb(e.size,64)})),Db=function(){var e,t,n,r,a,i,o,u,s=null;function c(e,t,n){var r=n/2;if(a){var c=o-t,l=e-i;if(c||l){var f=Math.hypot(c,l),d=(c/=f)*u,h=(l/=f)*u,p=Math.atan2(l,c);s.moveTo(i-d,o-h),s.lineTo(e-c*r,t-l*r),s.arc(e,t,r,p-Math.PI,p),s.lineTo(i+d,o+h),s.arc(i,o,u,p,p+Math.PI)}else s.arc(e,t,r,0,eb);s.closePath()}else a=1;i=e,o=t,u=r}function l(i){var o,u,l,f=i.length,d=!1;for(null==s&&(s=l=pp()),o=0;o<=f;++o)!(o<f&&r(u=i[o],o,i))===d&&(d=!d)&&(a=0),d&&c(+e(u,o,i),+t(u,o,i),+n(u,o,i));if(l)return s=null,l+""||null}return l.x=function(t){return arguments.length?(e=t,l):e},l.y=function(e){return arguments.length?(t=e,l):t},l.size=function(e){return arguments.length?(n=e,l):n},l.defined=function(e){return arguments.length?(r=e,l):r},l.context=function(e){return arguments.length?(s=null==e?null:e,l):s},l}().x(kb).y(_b).defined(Sb).size((function(e){return e.size||1}));function Fb(e){return e.cornerRadius||e.cornerRadiusTopLeft||e.cornerRadiusTopRight||e.cornerRadiusBottomRight||e.cornerRadiusBottomLeft}function Mb(e,t,n,r){return Tb.context(e)(t,n,r)}var Ob=1;function Rb(e,t,n){var r=t.clip,a=e._defs,i=t.clip_id||(t.clip_id="clip"+Ob++),o=a.clipping[i]||(a.clipping[i]={id:i});return Wd(r)?o.path=r(null):Fb(n)?o.path=Mb(null,n,0,0):(o.width=n.width||0,o.height=n.height||0),"url(#"+i+")"}function jb(e){this.clear(),e&&this.union(e)}function Bb(e){this.mark=e,this.bounds=this.bounds||new jb}function zb(e){Bb.call(this,e),this.items=this.items||[]}function Zb(e){this._pending=0,this._loader=e||Jv()}function Lb(e){e._pending+=1}function Pb(e){e._pending-=1}function Ub(e,t,n){if(t.stroke&&0!==t.opacity&&0!==t.strokeOpacity){var r=null!=t.strokeWidth?+t.strokeWidth:1;e.expand(r+(n?function(e,t){return e.strokeJoin&&"miter"!==e.strokeJoin?0:t}(t,r):0))}return e}jb.prototype={clone:function(){return new jb(this)},clear:function(){return this.x1=+Number.MAX_VALUE,this.y1=+Number.MAX_VALUE,this.x2=-Number.MAX_VALUE,this.y2=-Number.MAX_VALUE,this},empty:function(){return this.x1===+Number.MAX_VALUE&&this.y1===+Number.MAX_VALUE&&this.x2===-Number.MAX_VALUE&&this.y2===-Number.MAX_VALUE},equals:function(e){return this.x1===e.x1&&this.y1===e.y1&&this.x2===e.x2&&this.y2===e.y2},set:function(e,t,n,r){return n<e?(this.x2=e,this.x1=n):(this.x1=e,this.x2=n),r<t?(this.y2=t,this.y1=r):(this.y1=t,this.y2=r),this},add:function(e,t){return e<this.x1&&(this.x1=e),t<this.y1&&(this.y1=t),e>this.x2&&(this.x2=e),t>this.y2&&(this.y2=t),this},expand:function(e){return this.x1-=e,this.y1-=e,this.x2+=e,this.y2+=e,this},round:function(){return this.x1=Math.floor(this.x1),this.y1=Math.floor(this.y1),this.x2=Math.ceil(this.x2),this.y2=Math.ceil(this.y2),this},scale:function(e){return this.x1*=e,this.y1*=e,this.x2*=e,this.y2*=e,this},translate:function(e,t){return this.x1+=e,this.x2+=e,this.y1+=t,this.y2+=t,this},rotate:function(e,t,n){var r=this.rotatedPoints(e,t,n);return this.clear().add(r[0],r[1]).add(r[2],r[3]).add(r[4],r[5]).add(r[6],r[7])},rotatedPoints:function(e,t,n){var r=this.x1,a=this.y1,i=this.x2,o=this.y2,u=Math.cos(e),s=Math.sin(e),c=t-t*u+n*s,l=n-t*s-n*u;return[u*r-s*a+c,s*r+u*a+l,u*r-s*o+c,s*r+u*o+l,u*i-s*a+c,s*i+u*a+l,u*i-s*o+c,s*i+u*o+l]},union:function(e){return e.x1<this.x1&&(this.x1=e.x1),e.y1<this.y1&&(this.y1=e.y1),e.x2>this.x2&&(this.x2=e.x2),e.y2>this.y2&&(this.y2=e.y2),this},intersect:function(e){return e.x1>this.x1&&(this.x1=e.x1),e.y1>this.y1&&(this.y1=e.y1),e.x2<this.x2&&(this.x2=e.x2),e.y2<this.y2&&(this.y2=e.y2),this},encloses:function(e){return e&&this.x1<=e.x1&&this.x2>=e.x2&&this.y1<=e.y1&&this.y2>=e.y2},alignsWith:function(e){return e&&(this.x1==e.x1||this.x2==e.x2||this.y1==e.y1||this.y2==e.y2)},intersects:function(e){return e&&!(this.x2<e.x1||this.x1>e.x2||this.y2<e.y1||this.y1>e.y2)},contains:function(e,t){return!(e<this.x1||e>this.x2||t<this.y1||t>this.y2)},width:function(){return this.x2-this.x1},height:function(){return this.y2-this.y1}},Hd(zb,Bb),Zb.prototype={pending:function(){return this._pending},sanitizeURL:function(e){var t=this;return Lb(t),t._loader.sanitize(e,{context:"href"}).then((function(e){return Pb(t),e})).catch((function(){return Pb(t),null}))},loadImage:function(e){var t=this,n=Fp();return Lb(t),t._loader.sanitize(e,{context:"image"}).then((function(e){var r=e.href;if(!r||!n)throw{url:r};var a=new n,i=Gd(e,"crossOrigin")?e.crossOrigin:"anonymous";return null!=i&&(a.crossOrigin=i),a.onload=function(){return Pb(t)},a.onerror=function(){return Pb(t)},a.src=r,a})).catch((function(e){return Pb(t),{complete:!1,width:0,height:0,src:e&&e.url||""}}))},ready:function(){var e=this;return new Promise((function(t){!function n(r){e.pending()?setTimeout((function(){n(!0)}),10):t(r)}(!1)}))}};var Wb,Vb,qb,Gb,Hb,Xb,Kb,Yb,$b=eb-1e-8,Qb=function(e,t){return Wb.add(e,t)},Jb=function(e,t){return Qb(Vb=e,qb=t)},ex=function(e){return Qb(e,Wb.y1)},tx=function(e){return Qb(Wb.x1,e)},nx=function(e,t){return Hb*e+Kb*t},rx=function(e,t){return Xb*e+Yb*t},ax=function(e,t){return Qb(nx(e,t),rx(e,t))},ix=function(e,t){return Jb(nx(e,t),rx(e,t))};function ox(e,t){return Wb=e,t?(Gb=t*Qy,Hb=Yb=Math.cos(Gb),Xb=Math.sin(Gb),Kb=-Xb):(Hb=Yb=1,Gb=Xb=Kb=0),ux}var ux={beginPath:function(){},closePath:function(){},moveTo:ix,lineTo:ix,rect:function(e,t,n,r){Gb?(ax(e+n,t),ax(e+n,t+r),ax(e,t+r),ix(e,t)):(Qb(e+n,t+r),Jb(e,t))},quadraticCurveTo:function(e,t,n,r){var a=nx(e,t),i=rx(e,t),o=nx(n,r),u=rx(n,r);sx(Vb,a,o,ex),sx(qb,i,u,tx),Jb(o,u)},bezierCurveTo:function(e,t,n,r,a,i){var o=nx(e,t),u=rx(e,t),s=nx(n,r),c=rx(n,r),l=nx(a,i),f=rx(a,i);cx(Vb,o,s,l,ex),cx(qb,u,c,f,tx),Jb(l,f)},arc:function(e,t,n,r,a,i){if(r+=Gb,a+=Gb,Vb=n*Math.cos(a)+e,qb=n*Math.sin(a)+t,Math.abs(a-r)>$b)Qb(e-n,t-n),Qb(e+n,t+n);else{var o,u,s=function(r){return Qb(n*Math.cos(r)+e,n*Math.sin(r)+t)};if(s(r),s(a),a!==r)if((r%=eb)<0&&(r+=eb),(a%=eb)<0&&(a+=eb),a<r&&(i=!i,o=r,r=a,a=o),i)for(a-=eb,o=r-r%Jy,u=0;u<4&&o>a;++u,o-=Jy)s(o);else for(o=r-r%Jy+Jy,u=0;u<4&&o<a;++u,o+=Jy)s(o)}}};function sx(e,t,n,r){var a=(e-t)/(e+n-2*t);0<a&&a<1&&r(e+(t-e)*a)}function cx(e,t,n,r,a){var i,o=r-e+3*t-3*n,u=e+n-2*t,s=e-t,c=0,l=0;Math.abs(o)>1e-14?(i=u*u+s*o)>=0&&(c=(-u+(i=Math.sqrt(i)))/o,l=(-u-i)/o):c=.5*s/u,0<c&&c<1&&a(lx(c,e,t,n,r)),0<l&&l<1&&a(lx(l,e,t,n,r))}function lx(e,t,n,r,a){var i=1-e,o=i*i,u=e*e;return o*i*t+3*o*e*n+3*i*u*r+u*e*a}var fx=(fx=Ip(1,1))?fx.getContext("2d"):null,dx=new jb;function hx(e){return function(t,n){if(!fx)return!0;e(fx,t),dx.clear().union(t.bounds).intersect(n).round();for(var r=dx.x1,a=dx.y1,i=dx.x2,o=dx.y2,u=a;u<=o;++u)for(var s=r;s<=i;++s)if(fx.isPointInPath(s,u))return!0;return!1}}function px(e,t){return t.contains(e.x||0,e.y||0)}function vx(e,t){var n=e.x||0,r=e.y||0,a=e.width||0,i=e.height||0;return t.intersects(dx.set(n,r,n+a,r+i))}function mx(e,t,n,r,a){var i,o,u,s,c=e.x1,l=e.y1,f=e.x2,d=e.y2,h=r-t,p=a-n,v=0,m=1;for(s=0;s<4;++s){if(0===s&&(i=-h,o=-(c-t)),1===s&&(i=h,o=f-t),2===s&&(i=-p,o=-(l-n)),3===s&&(i=p,o=d-n),Math.abs(i)<1e-10&&o<0)return!1;if(u=o/i,i<0){if(u>m)return!1;u>v&&(v=u)}else if(i>0){if(u<v)return!1;u<m&&(m=u)}}return!0}function gx(e,t){e.globalCompositeOperation=t.blend||"source-over"}function yx(e,t){return null==e?t:e}function bx(e,t){for(var n=t.length,r=0;r<n;++r)e.addColorStop(t[r].offset,t[r].color);return e}function xx(e,t,n){return Py(n)?function(e,t,n){var r,a=n.width(),i=n.height();if("radial"===t.gradient)r=e.createRadialGradient(n.x1+yx(t.x1,.5)*a,n.y1+yx(t.y1,.5)*i,Math.max(a,i)*yx(t.r1,0),n.x1+yx(t.x2,.5)*a,n.y1+yx(t.y2,.5)*i,Math.max(a,i)*yx(t.r2,.5));else{var o=yx(t.x1,0),u=yx(t.y1,0),s=yx(t.x2,1),c=yx(t.y2,0);if(o!==s&&u!==c&&a!==i){var l=Ip(Math.ceil(a),Math.ceil(i)),f=l.getContext("2d");return f.scale(a,i),f.fillStyle=bx(f.createLinearGradient(o,u,s,c),t.stops),f.fillRect(0,0,a,i),e.createPattern(l,"no-repeat")}r=e.createLinearGradient(n.x1+o*a,n.y1+u*i,n.x1+s*a,n.y1+c*i)}return bx(r,t.stops)}(e,n,t.bounds):n}function wx(e,t,n){return(n*=null==t.fillOpacity?1:t.fillOpacity)>0&&(e.globalAlpha=n,e.fillStyle=xx(e,t,t.fill),!0)}var kx=[];function _x(e,t,n){var r=null!=(r=t.strokeWidth)?r:1;return!(r<=0)&&((n*=null==t.strokeOpacity?1:t.strokeOpacity)>0&&(e.globalAlpha=n,e.strokeStyle=xx(e,t,t.stroke),e.lineWidth=r,e.lineCap=t.strokeCap||"butt",e.lineJoin=t.strokeJoin||"miter",e.miterLimit=t.strokeMiterLimit||10,e.setLineDash&&(e.setLineDash(t.strokeDash||kx),e.lineDashOffset=t.strokeDashOffset||0),!0))}function Sx(e,t){return e.zindex-t.zindex||e.index-t.index}function Cx(e){if(!e.zdirty)return e.zitems;var t,n,r,a=e.items,i=[];for(n=0,r=a.length;n<r;++n)(t=a[n]).index=n,t.zindex&&i.push(t);return e.zdirty=!1,e.zitems=i.sort(Sx)}function Ax(e,t){var n,r,a=e.items;if(a&&a.length){var i=Cx(e);if(i&&i.length){for(n=0,r=a.length;n<r;++n)a[n].zindex||t(a[n]);a=i}for(n=0,r=a.length;n<r;++n)t(a[n])}}function Ex(e,t){var n,r,a=e.items;if(!a||!a.length)return null;var i=Cx(e);for(i&&i.length&&(a=i),r=a.length;--r>=0;)if(n=t(a[r]))return n;if(a===i)for(r=(a=e.items).length;--r>=0;)if(!a[r].zindex&&(n=t(a[r])))return n;return null}function Nx(e){return function(t,n,r){Ax(n,(function(n){r&&!r.intersects(n.bounds)||Ix(e,t,n,n)}))}}function Tx(e){return function(t,n,r){!n.items.length||r&&!r.intersects(n.bounds)||Ix(e,t,n.items[0],n.items)}}function Ix(e,t,n,r){var a=null==n.opacity?1:n.opacity;0!==a&&(e(t,r)||(gx(t,n),n.fill&&wx(t,n,a)&&t.fill(),n.stroke&&_x(t,n,a)&&t.stroke()))}function Dx(e){return e=e||Bd,function(t,n,r,a,i,o){return r*=t.pixelRatio,a*=t.pixelRatio,Ex(n,(function(n){var u=n.bounds;if((!u||u.contains(i,o))&&u)return e(t,n,r,a,i,o)?n:void 0}))}}function Fx(e,t){return function(n,r,a,i){var o,u,s=Array.isArray(r)?r[0]:r,c=null==t?s.fill:t,l=s.stroke&&n.isPointInStroke;return l&&(o=s.strokeWidth,u=s.strokeCap,n.lineWidth=null!=o?o:1,n.lineCap=null!=u?u:"butt"),!e(n,r)&&(c&&n.isPointInPath(a,i)||l&&n.isPointInStroke(a,i))}}function Mx(e){return Dx(Fx(e))}function Ox(e,t){return"translate("+e+","+t+")"}function Rx(e){return"rotate("+e+")"}function jx(e){return Ox(e.x||0,e.y||0)}function Bx(e,t,n){function r(e,n){var r=n.x||0,a=n.y||0,i=n.angle||0;e.translate(r,a),i&&e.rotate(i*=Qy),e.beginPath(),t(e,n),i&&e.rotate(-i),e.translate(-r,-a)}return{type:e,tag:"path",nested:!1,attr:function(e,n){e("transform",function(e){return Ox(e.x||0,e.y||0)+(e.angle?" "+Rx(e.angle):"")}(n)),e("d",t(null,n))},bound:function(e,n){return t(ox(e,n.angle),n),Ub(e,n).translate(n.x||0,n.y||0)},draw:Nx(r),pick:Mx(r),isect:n||hx(r)}}var zx=Bx("arc",(function(e,t){return Cb.context(e)(t)}));function Zx(e,t,n){function r(e,n){e.beginPath(),t(e,n)}var a=Fx(r);return{type:e,tag:"path",nested:!0,attr:function(e,n){var r=n.mark.items;r.length&&e("d",t(null,r))},bound:function(e,n){var r=n.items;return 0===r.length?e:(t(ox(e),r),Ub(e,r[0]))},draw:Tx(r),pick:function(e,t,n,r,i,o){var u=t.items,s=t.bounds;return!u||!u.length||s&&!s.contains(i,o)?null:(n*=e.pixelRatio,r*=e.pixelRatio,a(e,u,n,r)?u[0]:null)},isect:px,tip:n}}var Lx=Zx("area",(function(e,t){var n=t[0],r=n.interpolate||"linear";return("horizontal"===n.orient?Eb:Ab).curve(qy(r,n.orient,n.tension)).context(e)(t)}),(function(e,t){for(var n,r,a="horizontal"===e[0].orient?t[1]:t[0],i="horizontal"===e[0].orient?"y":"x",o=e.length,u=1/0;--o>=0;)!1!==e[o].defined&&(r=Math.abs(e[o][i]-a))<u&&(u=r,n=e[o]);return n}));function Px(e,t){e.beginPath(),Fb(t)?Mb(e,t,0,0):e.rect(0,0,t.width||0,t.height||0),e.clip()}function Ux(e){var t=yx(e.strokeWidth,1);return null!=e.strokeOffset?e.strokeOffset:e.stroke&&t>.5&&t<1.5?.5-Math.abs(t-1):0}function Wx(e,t){var n=Ux(t);e("d",Mb(null,t,n,n))}function Vx(e,t,n,r){var a=Ux(t);e.beginPath(),Mb(e,t,(n||0)+a,(r||0)+a)}var qx=Fx(Vx),Gx=Fx(Vx,!1),Hx=Fx(Vx,!0);var Xx={type:"group",tag:"g",nested:!1,attr:function(e,t){e("transform",jx(t))},bound:function(e,t){if(!t.clip&&t.items)for(var n=t.items,r=n.length,a=0;a<r;++a)e.union(n[a].bounds);return(t.clip||t.width||t.height)&&!t.noBound&&e.add(0,0).add(t.width||0,t.height||0),Ub(e,t),e.translate(t.x||0,t.y||0)},draw:function(e,t,n,r){var a=this;Ax(t,(function(t){var i=t.x||0,o=t.y||0,u=t.strokeForeground,s=null==t.opacity?1:t.opacity;(t.stroke||t.fill)&&s&&(Vx(e,t,i,o),gx(e,t),t.fill&&wx(e,t,s)&&e.fill(),t.stroke&&!u&&_x(e,t,s)&&e.stroke()),e.save(),e.translate(i,o),t.clip&&Px(e,t),n&&n.translate(-i,-o),Ax(t,(function(t){("group"===t.marktype||null==r||r.includes(t.marktype))&&a.draw(e,t,n,r)})),n&&n.translate(i,o),e.restore(),u&&t.stroke&&s&&(Vx(e,t,i,o),gx(e,t),_x(e,t,s)&&e.stroke())}))},pick:function(e,t,n,r,a,i){var o=this;if(t.bounds&&!t.bounds.contains(a,i)||!t.items)return null;var u=n*e.pixelRatio,s=r*e.pixelRatio;return Ex(t,(function(c){var l,f,d,h=c.bounds;if(!h||h.contains(a,i)){f=c.x||0,d=c.y||0;var p=f+(c.width||0),v=d+(c.height||0),m=c.clip;if(!m||!(a<f||a>p||i<d||i>v)){if(e.save(),e.translate(f,d),f=a-f,d=i-d,m&&Fb(c)&&!Hx(e,c,u,s))return e.restore(),null;var g=c.strokeForeground,y=!1!==t.interactive;return y&&g&&c.stroke&&Gx(e,c,u,s)?(e.restore(),c):(!(l=Ex(c,(function(e){return function(e,t,n){return(!1!==e.interactive||"group"===e.marktype)&&e.bounds&&e.bounds.contains(t,n)}(e,f,d)?o.pick(e,n,r,f,d):null})))&&y&&(c.fill||!g&&c.stroke)&&qx(e,c,u,s)&&(l=c),e.restore(),l||null)}}}))},isect:vx,content:function(e,t,n){e("clip-path",t.clip?Rb(n,t,t):null)},background:function(e,t){e("class","background"),e("aria-hidden",!0),Wx(e,t)},foreground:function(e,t){e("class","foreground"),e("aria-hidden",!0),t.strokeForeground?Wx(e,t):e("d","")}},Kx={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",version:"1.1"};function Yx(e,t){var n=e.image;return(!n||e.url&&e.url!==n.url)&&(n={complete:!1,width:0,height:0},t.loadImage(e.url).then((function(t){e.image=t,e.image.url=e.url}))),n}function $x(e,t){return null!=e.width?e.width:t&&t.width?!1!==e.aspect&&e.height?e.height*t.width/t.height:t.width:0}function Qx(e,t){return null!=e.height?e.height:t&&t.height?!1!==e.aspect&&e.width?e.width*t.height/t.width:t.height:0}function Jx(e,t){return"center"===e?t/2:"right"===e?t:0}function ew(e,t){return"middle"===e?t/2:"bottom"===e?t:0}var tw={type:"image",tag:"image",nested:!1,attr:function(e,t,n){var r=Yx(t,n),a=$x(t,r),i=Qx(t,r),o=(t.x||0)-Jx(t.align,a),u=(t.y||0)-ew(t.baseline,i);e("href",!r.src&&r.toDataURL?r.toDataURL():r.src||"",Kx["xmlns:xlink"],"xlink:href"),e("transform",Ox(o,u)),e("width",a),e("height",i),e("preserveAspectRatio",!1===t.aspect?"none":"xMidYMid")},bound:function(e,t){var n=t.image,r=$x(t,n),a=Qx(t,n),i=(t.x||0)-Jx(t.align,r),o=(t.y||0)-ew(t.baseline,a);return e.set(i,o,i+r,o+a)},draw:function(e,t,n){var r=this;Ax(t,(function(t){if(!n||n.intersects(t.bounds)){var a=Yx(t,r),i=$x(t,a),o=Qx(t,a);if(0!==i&&0!==o){var u,s,c,l,f=(t.x||0)-Jx(t.align,i),d=(t.y||0)-ew(t.baseline,o);!1!==t.aspect&&(s=a.width/a.height,c=t.width/t.height,s===s&&c===c&&s!==c&&(c<s?(d+=(o-(l=i/s))/2,o=l):(f+=(i-(l=o*s))/2,i=l))),(a.complete||a.toDataURL)&&(gx(e,t),e.globalAlpha=null!=(u=t.opacity)?u:1,e.imageSmoothingEnabled=!1!==t.smooth,e.drawImage(a,f,d,i,o))}}}))},pick:Dx(),isect:Bd,get:Yx,xOffset:Jx,yOffset:ew},nw=Zx("line",(function(e,t){var n=t[0],r=n.interpolate||"linear";return Nb.curve(qy(r,n.orient,n.tension)).context(e)(t)}),(function(e,t){for(var n,r,a=Math.pow(e[0].strokeWidth||1,2),i=e.length;--i>=0;)if(!1!==e[i].defined&&(n=e[i].x-t[0])*n+(r=e[i].y-t[1])*r<a)return e[i];return null}));function rw(e,t){var n=t.path;if(null==n)return!0;var r=t.x||0,a=t.y||0,i=t.scaleX||1,o=t.scaleY||1,u=(t.angle||0)*Qy,s=t.pathCache;s&&s.path===n||((t.pathCache=s=$y(n)).path=n),u&&e.rotate&&e.translate?(e.translate(r,a),e.rotate(u),sb(e,s,0,0,i,o),e.rotate(-u),e.translate(-r,-a)):sb(e,s,r,a,i,o)}var aw={type:"path",tag:"path",nested:!1,attr:function(e,t){var n=t.scaleX||1,r=t.scaleY||1;1===n&&1===r||e("vector-effect","non-scaling-stroke"),e("transform",function(e){return Ox(e.x||0,e.y||0)+(e.angle?" "+Rx(e.angle):"")+(e.scaleX||e.scaleY?" "+function(e,t){return"scale("+e+","+t+")"}(e.scaleX||1,e.scaleY||1):"")}(t)),e("d",t.path)},bound:function(e,t){return rw(ox(e,t.angle),t)?e.set(0,0,0,0):Ub(e,t,!0)},draw:Nx(rw),pick:Mx(rw),isect:hx(rw)};function iw(e,t){e.beginPath(),Mb(e,t)}var ow={type:"rect",tag:"path",nested:!1,attr:function(e,t){e("d",Mb(null,t))},bound:function(e,t){var n,r;return Ub(e.set(n=t.x||0,r=t.y||0,n+t.width||0,r+t.height||0),t)},draw:Nx(iw),pick:Mx(iw),isect:vx};function uw(e,t,n){var r,a,i,o;return!(!t.stroke||!_x(e,t,n))&&(r=t.x||0,a=t.y||0,i=null!=t.x2?t.x2:r,o=null!=t.y2?t.y2:a,e.beginPath(),e.moveTo(r,a),e.lineTo(i,o),!0)}var sw={type:"rule",tag:"line",nested:!1,attr:function(e,t){e("transform",jx(t)),e("x2",null!=t.x2?t.x2-(t.x||0):0),e("y2",null!=t.y2?t.y2-(t.y||0):0)},bound:function(e,t){var n,r;return Ub(e.set(n=t.x||0,r=t.y||0,null!=t.x2?t.x2:n,null!=t.y2?t.y2:r),t)},draw:function(e,t,n){Ax(t,(function(t){if(!n||n.intersects(t.bounds)){var r=null==t.opacity?1:t.opacity;r&&uw(e,t,r)&&(gx(e,t),e.stroke())}}))},pick:Dx((function(e,t,n,r){return!!e.isPointInStroke&&(uw(e,t,1)&&e.isPointInStroke(n,r))})),isect:function(e,t){var n=e.x||0,r=e.y||0;return mx(t,n,r,null!=e.x2?e.x2:n,null!=e.y2?e.y2:r)}},cw=Bx("shape",(function(e,t){return(t.mark.shape||t.shape).context(e)(t)})),lw=Bx("symbol",(function(e,t){return Ib.context(e)(t)}),px),fw=function(e){var t,n,r;e=+e||1e4;var a=function(){t={},n={},r=0},i=function(a,i){return++r>e&&(n=t,t={},r=1),t[a]=i};return a(),{clear:a,has:function(e){return Gd(t,e)||Gd(n,e)},get:function(e){return Gd(t,e)?t[e]:Gd(n,e)?i(e,n[e]):void 0},set:function(e,n){return Gd(t,e)?t[e]=n:i(e,n)}}}(),dw={height:yw,measureWidth:mw,estimateWidth:pw,width:pw,canvas:hw};function hw(e){dw.width=e&&fx?mw:pw}function pw(e,t){return vw(kw(e,t),yw(e))}function vw(e,t){return~~(.8*e.length*t)}function mw(e,t){return yw(e)<=0||!(t=kw(e,t))?0:gw(t,Sw(e))}function gw(e,t){var n="(".concat(t,") ").concat(e),r=fw.get(n);return void 0===r&&(fx.font=t,r=fx.measureText(e).width,fw.set(n,r)),r}function yw(e){return null!=e.fontSize?+e.fontSize||0:11}function bw(e){return null!=e.lineHeight?e.lineHeight:yw(e)+2}function xw(e){return t=e.lineBreak&&e.text&&!zd(e.text)?e.text.split(e.lineBreak):e.text,zd(t)?t.length>1?t:t[0]:t;var t}function ww(e){var t=xw(e);return(zd(t)?t.length-1:0)*bw(e)}function kw(e,t){var n=null==t?"":(t+"").trim();return e.limit>0&&n.length?function(e,t){var n=+e.limit,r=function(e){if(dw.width===mw){var t=Sw(e);return function(e){return gw(e,t)}}if(dw.width===pw){var n=yw(e);return function(e){return vw(e,n)}}return function(t){return dw.width(e,t)}}(e);if(r(t)<n)return t;var a,i=e.ellipsis||"\u2026",o="rtl"===e.dir,u=0,s=t.length;if(n-=r(i),o){for(;u<s;)a=u+s>>>1,r(t.slice(a))>n?u=a+1:s=a;return i+t.slice(u)}for(;u<s;)a=1+(u+s>>>1),r(t.slice(0,a))<n?u=a:s=a-1;return t.slice(0,u)+i}(e,n):n}function _w(e,t){var n=e.font;return(t&&n?String(n).replace(/"/g,"'"):n)||"sans-serif"}function Sw(e,t){return(e.fontStyle?e.fontStyle+" ":"")+(e.fontVariant?e.fontVariant+" ":"")+(e.fontWeight?e.fontWeight+" ":"")+yw(e)+"px "+_w(e,t)}function Cw(e){var t=e.baseline,n=yw(e);return Math.round("top"===t?.79*n:"middle"===t?.3*n:"bottom"===t?-.21*n:"line-top"===t?.29*n+.5*bw(e):"line-bottom"===t?.29*n-.5*bw(e):0)}hw(!0);var Aw={left:"start",center:"middle",right:"end"},Ew=new jb;function Nw(e){var t,n=e.x||0,r=e.y||0,a=e.radius||0;return a&&(t=(e.theta||0)-Jy,n+=a*Math.cos(t),r+=a*Math.sin(t)),Ew.x1=n,Ew.y1=r,Ew}function Tw(e,t,n){var r,a=dw.height(t),i=t.align,o=Nw(t),u=o.x1,s=o.y1,c=t.dx||0,l=(t.dy||0)+Cw(t)-Math.round(.8*a),f=xw(t);if(zd(f)?(a+=bw(t)*(f.length-1),r=f.reduce((function(e,n){return Math.max(e,dw.width(t,n))}),0)):r=dw.width(t,f),"center"===i?c-=r/2:"right"===i&&(c-=r),e.set(c+=u,l+=s,c+r,l+a),t.angle&&!n)e.rotate(t.angle*Qy,u,s);else if(2===n)return e.rotatedPoints(t.angle*Qy,u,s);return e}var Iw={type:"text",tag:"text",nested:!1,attr:function(e,t){var n,r=t.dx||0,a=(t.dy||0)+Cw(t),i=Nw(t),o=i.x1,u=i.y1,s=t.angle||0;e("text-anchor",Aw[t.align]||"start"),s?(n=Ox(o,u)+" "+Rx(s),(r||a)&&(n+=" "+Ox(r,a))):n=Ox(o+r,u+a),e("transform",n)},bound:Tw,draw:function(e,t,n){Ax(t,(function(t){var r,a,i,o,u,s,c,l=null==t.opacity?1:t.opacity;if(!(n&&!n.intersects(t.bounds)||0===l||t.fontSize<=0||null==t.text||0===t.text.length)){if(e.font=Sw(t),e.textAlign=t.align||"left",a=(r=Nw(t)).x1,i=r.y1,t.angle&&(e.save(),e.translate(a,i),e.rotate(t.angle*Qy),a=i=0),a+=t.dx||0,i+=(t.dy||0)+Cw(t),s=xw(t),gx(e,t),zd(s))for(u=bw(t),o=0;o<s.length;++o)c=kw(t,s[o]),t.fill&&wx(e,t,l)&&e.fillText(c,a,i),t.stroke&&_x(e,t,l)&&e.strokeText(c,a,i),i+=u;else c=kw(t,s),t.fill&&wx(e,t,l)&&e.fillText(c,a,i),t.stroke&&_x(e,t,l)&&e.strokeText(c,a,i);t.angle&&e.restore()}}))},pick:Dx((function(e,t,n,r,a,i){if(t.fontSize<=0)return!1;if(!t.angle)return!0;var o=Nw(t),u=o.x1,s=o.y1,c=Tw(Ew,t,1),l=-t.angle*Qy,f=Math.cos(l),d=Math.sin(l),h=f*a-d*i+(u-f*u+d*s),p=d*a+f*i+(s-d*u-f*s);return c.contains(h,p)})),isect:function(e,t){var n=Tw(Ew,e,2);return mx(t,n[0],n[1],n[2],n[3])||mx(t,n[0],n[1],n[4],n[5])||mx(t,n[4],n[5],n[6],n[7])||mx(t,n[2],n[3],n[6],n[7])}},Dw=Zx("trail",(function(e,t){return Db.context(e)(t)}),(function(e,t){for(var n,r,a=e.length;--a>=0;)if(!1!==e[a].defined&&(n=e[a].x-t[0])*n+(r=e[a].y-t[1])*r<(n=e[a].size||1)*n)return e[a];return null})),Fw={arc:zx,area:Lx,group:Xx,image:tw,line:nw,path:aw,rect:ow,rule:sw,shape:cw,symbol:lw,text:Iw,trail:Dw};function Mw(e,t,n){return!e&&"undefined"!==typeof document&&document.createElement&&(e=document),e?n?e.createElementNS(n,t):e.createElement(t):null}function Ow(e,t){t=t.toLowerCase();for(var n=e.childNodes,r=0,a=n.length;r<a;++r)if(n[r].tagName.toLowerCase()===t)return n[r]}function Rw(e,t,n,r){var a,i=e.childNodes[t];return i&&i.tagName.toLowerCase()===n.toLowerCase()||(a=i||null,i=Mw(e.ownerDocument,n,r),e.insertBefore(i,a)),i}function jw(e,t){for(var n=e.childNodes,r=n.length;r>t;)e.removeChild(n[--r]);return e}function Bw(e){return"mark-"+e.marktype+(e.role?" role-"+e.role:"")+(e.name?" "+e.name:"")}function zw(e,t){var n=t.getBoundingClientRect();return[e.clientX-n.left-(t.clientLeft||0),e.clientY-n.top-(t.clientTop||0)]}function Zw(e,t){this._active=null,this._handlers={},this._loader=e||Jv(),this._tooltip=t||Lw}function Lw(e,t,n,r){e.element().setAttribute("title",r||"")}function Pw(e){this._el=null,this._bgcolor=null,this._loader=new Zb(e)}Zw.prototype={initialize:function(e,t,n){return this._el=e,this._obj=n||null,this.origin(t)},element:function(){return this._el},canvas:function(){return this._el&&this._el.firstChild},origin:function(e){return arguments.length?(this._origin=e||[0,0],this):this._origin.slice()},scene:function(e){return arguments.length?(this._scene=e,this):this._scene},on:function(){},off:function(){},_handlerIndex:function(e,t,n){for(var r=e?e.length:0;--r>=0;)if(e[r].type===t&&(!n||e[r].handler===n))return r;return-1},handlers:function(e){var t=this._handlers,n=[];if(e)n.push.apply(n,(0,cn.Z)(t[this.eventName(e)]));else for(var r in t)n.push.apply(n,(0,cn.Z)(t[r]));return n},eventName:function(e){var t=e.indexOf(".");return t<0?e:e.slice(0,t)},handleHref:function(e,t,n){this._loader.sanitize(n,{context:"href"}).then((function(t){var n=new MouseEvent(e.type,e),r=Mw(null,"a");for(var a in t)r.setAttribute(a,t[a]);r.dispatchEvent(n)})).catch((function(){}))},handleTooltip:function(e,t,n){if(t&&null!=t.tooltip){t=function(e,t,n,r){var a,i,o=e&&e.mark;if(o&&(a=Fw[o.marktype]).tip){for((i=zw(t,n))[0]-=r[0],i[1]-=r[1];e=e.mark.group;)i[0]-=e.x||0,i[1]-=e.y||0;e=a.tip(o.items,i)}return e}(t,e,this.canvas(),this._origin);var r=n&&t&&t.tooltip||null;this._tooltip.call(this._obj,this,e,t,r)}},getItemBoundingClientRect:function(e){var t=this.canvas();if(t){for(var n=t.getBoundingClientRect(),r=this._origin,a=e.bounds,i=a.width(),o=a.height(),u=a.x1+r[0]+n.left,s=a.y1+r[1]+n.top;e.mark&&(e=e.mark.group);)u+=e.x||0,s+=e.y||0;return{x:u,y:s,width:i,height:o,left:u,top:s,right:u+i,bottom:s+o}}}},Pw.prototype={initialize:function(e,t,n,r,a){return this._el=e,this.resize(t,n,r,a)},element:function(){return this._el},canvas:function(){return this._el&&this._el.firstChild},background:function(e){return 0===arguments.length?this._bgcolor:(this._bgcolor=e,this)},resize:function(e,t,n,r){return this._width=e,this._height=t,this._origin=n||[0,0],this._scale=r||1,this},dirty:function(){},render:function(e,t){var n=this;return n._call=function(){n._render(e,t)},n._call(),n._call=null,n},_render:function(){},renderAsync:function(e,t){var n=this.render(e,t);return this._ready?this._ready.then((function(){return n})):Promise.resolve(n)},_load:function(e,t){var n=this,r=n._loader[e](t);if(!n._ready){var a=n._call;n._ready=n._loader.ready().then((function(e){e&&a(),n._ready=null}))}return r},sanitizeURL:function(e){return this._load("sanitizeURL",e)},loadImage:function(e){return this._load("loadImage",e)}};var Uw="dragenter",Ww="dragleave",Vw="dragover",qw="pointerdown",Gw="pointermove",Hw="pointerout",Xw="pointerover",Kw="mousedown",Yw="mousemove",$w="mouseout",Qw="mouseover",Jw="click",ek="mousewheel",tk="touchstart",nk="touchmove",rk="touchend",ak=Gw,ik=Hw,ok=Jw;function uk(e,t){Zw.call(this,e,t),this._down=null,this._touch=null,this._first=!0,this._events={}}function sk(e,t){(function(e){return e===tk||e===nk||e===rk?[tk,nk,rk]:[e]})(t).forEach((function(t){return function(e,t){var n=e.canvas();n&&!e._events[t]&&(e._events[t]=1,n.addEventListener(t,e[t]?function(n){return e[t](n)}:function(n){return e.fire(t,n)}))}(e,t)}))}function ck(e,t,n){t.forEach((function(t){return e.fire(t,n)}))}function lk(e,t,n){return function(r){var a=this._active,i=this.pickEvent(r);i===a||(a&&a.exit||ck(this,n,r),this._active=i,ck(this,t,r)),ck(this,e,r)}}function fk(e){return function(t){ck(this,e,t),this._active=null}}function dk(e,t,n,r,a,i){var o="undefined"!==typeof HTMLElement&&e instanceof HTMLElement&&null!=e.parentNode,u=e.getContext("2d"),s=o?"undefined"!==typeof window&&window.devicePixelRatio||1:a;for(var c in e.width=t*s,e.height=n*s,i)u[c]=i[c];return o&&1!==s&&(e.style.width=t+"px",e.style.height=n+"px"),u.pixelRatio=s,u.setTransform(s,0,0,s,s*r[0],s*r[1]),e}function hk(e){Pw.call(this,e),this._options={},this._redraw=!1,this._dirty=new jb,this._tempb=new jb}Hd(uk,Zw,{initialize:function(e,t,n){var r=this;return this._canvas=e&&Ow(e,"canvas"),[Jw,Kw,qw,Gw,Hw,Ww].forEach((function(e){return sk(r,e)})),Zw.prototype.initialize.call(this,e,t,n)},canvas:function(){return this._canvas},context:function(){return this._canvas.getContext("2d")},events:["keydown","keypress","keyup",Uw,Ww,Vw,qw,"pointerup",Gw,Hw,Xw,Kw,"mouseup",Yw,$w,Qw,Jw,"dblclick","wheel",ek,tk,nk,rk],DOMMouseScroll:function(e){this.fire(ek,e)},pointermove:lk([Gw,Yw],[Xw,Qw],[Hw,$w]),dragover:lk([Vw],[Uw],[Ww]),pointerout:fk([Hw,$w]),dragleave:fk([Ww]),pointerdown:function(e){this._down=this._active,this.fire(qw,e)},mousedown:function(e){this._down=this._active,this.fire(Kw,e)},click:function(e){this._down===this._active&&(this.fire(Jw,e),this._down=null)},touchstart:function(e){this._touch=this.pickEvent(e.changedTouches[0]),this._first&&(this._active=this._touch,this._first=!1),this.fire(tk,e,!0)},touchmove:function(e){this.fire(nk,e,!0)},touchend:function(e){this.fire(rk,e,!0),this._touch=null},fire:function(e,t,n){var r=n?this._touch:this._active,a=this._handlers[e];if(t.vegaType=e,e===ok&&r&&r.href?this.handleHref(t,r,r.href):e!==ak&&e!==ik||this.handleTooltip(t,r,e!==ik),a)for(var i=0,o=a.length;i<o;++i)a[i].handler.call(this._obj,t,r)},on:function(e,t){var n=this.eventName(e),r=this._handlers;return this._handlerIndex(r[n],e,t)<0&&(sk(this,e),(r[n]||(r[n]=[])).push({type:e,handler:t})),this},off:function(e,t){var n=this.eventName(e),r=this._handlers[n],a=this._handlerIndex(r,e,t);return a>=0&&r.splice(a,1),this},pickEvent:function(e){var t=zw(e,this._canvas),n=this._origin;return this.pick(this._scene,t[0],t[1],t[0]-n[0],t[1]-n[1])},pick:function(e,t,n,r,a){var i=this.context();return Fw[e.marktype].pick.call(this,i,e,t,n,r,a)}});var pk=Pw.prototype;function vk(e,t){Zw.call(this,e,t);var n=this;n._hrefHandler=mk(n,(function(e,t){t&&t.href&&n.handleHref(e,t,t.href)})),n._tooltipHandler=mk(n,(function(e,t){n.handleTooltip(e,t,e.type!==ik)}))}Hd(hk,Pw,{initialize:function(e,t,n,r,a,i){return this._options=i||{},this._canvas=this._options.externalContext?null:Ip(1,1,this._options.type),e&&this._canvas&&(jw(e,0).appendChild(this._canvas),this._canvas.setAttribute("class","marks")),pk.initialize.call(this,e,t,n,r,a)},resize:function(e,t,n,r){if(pk.resize.call(this,e,t,n,r),this._canvas)dk(this._canvas,this._width,this._height,this._origin,this._scale,this._options.context);else{var a=this._options.externalContext;a||Md("CanvasRenderer is missing a valid canvas or context"),a.scale(this._scale,this._scale),a.translate(this._origin[0],this._origin[1])}return this._redraw=!0,this},canvas:function(){return this._canvas},context:function(){return this._options.externalContext||(this._canvas?this._canvas.getContext("2d"):null)},dirty:function(e){for(var t=this._tempb.clear().union(e.bounds),n=e.mark.group;n;)t.translate(n.x||0,n.y||0),n=n.mark.group;this._dirty.union(t)},_render:function(e,t){var n=this.context(),r=this._origin,a=this._width,i=this._height,o=this._dirty,u=function(e,t,n){return(new jb).set(0,0,t,n).translate(-e[0],-e[1])}(r,a,i);n.save();var s=this._redraw||o.empty()?(this._redraw=!1,u.expand(1)):function(e,t,n){return t.expand(1).round(),e.pixelRatio%1&&t.scale(e.pixelRatio).round().scale(1/e.pixelRatio),t.translate(-n[0]%1,-n[1]%1),e.beginPath(),e.rect(t.x1,t.y1,t.width(),t.height()),e.clip(),t}(n,u.intersect(o),r);return this.clear(-r[0],-r[1],a,i),this.draw(n,e,s,t),n.restore(),o.clear(),this},draw:function(e,t,n,r){if("group"===t.marktype||null==r||r.includes(t.marktype)){var a=Fw[t.marktype];t.clip&&function(e,t){var n=t.clip;e.save(),Wd(n)?(e.beginPath(),n(e),e.clip()):Px(e,t.group)}(e,t),a.draw.call(this,e,t,n,r),t.clip&&e.restore()}},clear:function(e,t,n,r){var a=this._options,i=this.context();"pdf"===a.type||a.externalContext||i.clearRect(e,t,n,r),null!=this._bgcolor&&(i.fillStyle=this._bgcolor,i.fillRect(e,t,n,r))}});var mk=function(e,t){return function(n){var r=n.target.__data__;r=Array.isArray(r)?r[0]:r,n.vegaType=n.type,t.call(e._obj,n,r)}};Hd(vk,Zw,{initialize:function(e,t,n){var r=this._svg;return r&&(r.removeEventListener(ok,this._hrefHandler),r.removeEventListener(ak,this._tooltipHandler),r.removeEventListener(ik,this._tooltipHandler)),this._svg=r=e&&Ow(e,"svg"),r&&(r.addEventListener(ok,this._hrefHandler),r.addEventListener(ak,this._tooltipHandler),r.addEventListener(ik,this._tooltipHandler)),Zw.prototype.initialize.call(this,e,t,n)},canvas:function(){return this._svg},on:function(e,t){var n=this.eventName(e),r=this._handlers;if(this._handlerIndex(r[n],e,t)<0){var a={type:e,handler:t,listener:mk(this,t)};(r[n]||(r[n]=[])).push(a),this._svg&&this._svg.addEventListener(n,a.listener)}return this},off:function(e,t){var n=this.eventName(e),r=this._handlers[n],a=this._handlerIndex(r,e,t);return a>=0&&(this._svg&&this._svg.removeEventListener(n,r[a].listener),r.splice(a,1)),this}});var gk="aria-hidden",yk="aria-label",bk="role",xk="aria-roledescription",wk="graphics-object",kk="graphics-symbol",_k=function(e,t,n){var r;return r={},(0,Xn.Z)(r,bk,e),(0,Xn.Z)(r,xk,t),(0,Xn.Z)(r,yk,n||void 0),r},Sk=Yd(["axis-domain","axis-grid","axis-label","axis-tick","axis-title","legend-band","legend-entry","legend-gradient","legend-label","legend-title","legend-symbol","title"]),Ck={axis:{desc:"axis",caption:function(e){var t=e.datum,n=e.orient,r=t.title?Ik(e):null,a=e.context,i=a.scales[t.scale].value,o=a.dataflow.locale(),u=i.type;return"".concat("left"===n||"right"===n?"Y":"X","-axis")+(r?" titled '".concat(r,"'"):"")+" for a ".concat(my(u)?"discrete":u," scale")+" with ".concat(zy(o,i,e))}},legend:{desc:"legend",caption:function(e){var t=e.datum,n=t.title?Ik(e):null,r="".concat(t.type||""," legend").trim(),a=t.scales,i=Object.keys(a),o=e.context,u=o.scales[a[i[0]]].value,s=o.dataflow.locale();return function(e){return e.length?e[0].toUpperCase()+e.slice(1):e}(r)+(n?" titled '".concat(n,"'"):"")+" for ".concat(function(e){return(e=e.map((function(e){return e+("fill"===e||"stroke"===e?" color":"")}))).length<2?e[0]:e.slice(0,-1).join(", ")+" and "+Ld(e)}(i))+" with ".concat(zy(s,u,e))}},"title-text":{desc:"title",caption:function(e){return"Title text '".concat(Tk(e),"'")}},"title-subtitle":{desc:"subtitle",caption:function(e){return"Subtitle text '".concat(Tk(e),"'")}}},Ak={ariaRole:bk,ariaRoleDescription:xk,description:yk};function Ek(e,t){var n=!1===t.aria;if(e(gk,n||void 0),n||null==t.description)for(var r in Ak)e(Ak[r],void 0);else{var a=t.mark.marktype;e(yk,t.description),e(bk,t.ariaRole||("group"===a?wk:kk)),e(xk,t.ariaRoleDescription||"".concat(a," mark"))}}function Nk(e){return!1===e.aria?(0,Xn.Z)({},gk,!0):Sk[e.role]?null:Ck[e.role]?function(e,t){try{var n=e.items[0],r=t.caption||function(){return""};return _k(t.role||kk,t.desc,n.description||r(n))}catch(a){return null}}(e,Ck[e.role]):function(e){var t=e.marktype,n="group"===t||"text"===t||e.items.some((function(e){return null!=e.description&&!1!==e.aria}));return _k(n?wk:kk,"".concat(t," mark container"),e.description)}(e)}function Tk(e){return Ud(e.text).join(" ")}function Ik(e){try{return Ud(Ld(e.items).items[0].text).join(" ")}catch(t){return null}}var Dk=function(e){return(e+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")};function Fk(){var e="",t="",n="",r=[],a=function(){return t=n=""},i=function(i){t&&(e+="".concat(t,">").concat(n),a()),r.push(i)},o=function(e,n){return null!=n&&(t+=" ".concat(e,'="').concat(Dk(n).replace(/"/g,"&quot;").replace(/\t/g,"&#x9;").replace(/\n/g,"&#xA;").replace(/\r/g,"&#xD;"),'"')),u},u={open:function(e){i(e),t="<"+e;for(var n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];for(var s=0,c=r;s<c.length;s++){var l=c[s];for(var f in l)o(f,l[f])}return u},close:function(){var i=r.pop();return e+=t?t+(n?">".concat(n,"</").concat(i,">"):"/>"):"</".concat(i,">"),a(),u},attr:o,text:function(e){return n+=Dk(e),u},toString:function(){return e}};return u}var Mk=function(e){return Ok(Fk(),e)+""};function Ok(e,t){if(e.open(t.tagName),t.hasAttributes())for(var n=t.attributes,r=n.length,a=0;a<r;++a)e.attr(n[a].name,n[a].value);if(t.hasChildNodes()){var i,o=t.childNodes,u=(0,Rt.Z)(o);try{for(u.s();!(i=u.n()).done;){var s=i.value;3===s.nodeType?e.text(s.nodeValue):Ok(e,s)}}catch(c){u.e(c)}finally{u.f()}}return e.close()}var Rk={fill:"fill",fillOpacity:"fill-opacity",stroke:"stroke",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",strokeCap:"stroke-linecap",strokeJoin:"stroke-linejoin",strokeDash:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeMiterLimit:"stroke-miterlimit",opacity:"opacity"},jk={blend:"mix-blend-mode"},Bk={fill:"none","stroke-miterlimit":10},zk="http://www.w3.org/2000/xmlns/",Zk=Kx.xmlns;function Lk(e){Pw.call(this,e),this._dirtyID=0,this._dirty=[],this._svg=null,this._root=null,this._defs=null}var Pk=Pw.prototype;function Uk(e,t){for(;e&&e.dirty!==t;e=e.mark.group){if(e.dirty=t,!e.mark||e.mark.dirty===t)return;e.mark.dirty=t}}function Wk(e,t,n){var r,a,i;if("radial"===t.gradient){var o=Rw(e,n++,"pattern",Zk);$k(o,{id:Ly+t.id,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),$k(o=Rw(o,0,"rect",Zk),{width:1,height:1,fill:"url(".concat(Jk(),"#").concat(t.id,")")}),$k(e=Rw(e,n++,"radialGradient",Zk),{id:t.id,fx:t.x1,fy:t.y1,fr:t.r1,cx:t.x2,cy:t.y2,r:t.r2})}else $k(e=Rw(e,n++,"linearGradient",Zk),{id:t.id,x1:t.x1,x2:t.x2,y1:t.y1,y2:t.y2});for(r=0,a=t.stops.length;r<a;++r)(i=Rw(e,r,"stop",Zk)).setAttribute("offset",t.stops[r].offset),i.setAttribute("stop-color",t.stops[r].color);return jw(e,r),n}function Vk(e,t,n){return(e=Rw(e,n,"clipPath",Zk)).setAttribute("id",t.id),t.path?Rw(e,0,"path",Zk).setAttribute("d",t.path):$k(Rw(e,0,"rect",Zk),{x:0,y:0,width:t.width,height:t.height}),jw(e,1),n+1}function qk(e,t,n,r,a){var i,o=e._svg;if(!o&&(o=Mw(i=t.ownerDocument,r,Zk),e._svg=o,e.mark&&(o.__data__=e,o.__values__={fill:"default"},"g"===r))){var u=Mw(i,"path",Zk);o.appendChild(u),u.__data__=e;var s=Mw(i,"g",Zk);o.appendChild(s),s.__data__=e;var c=Mw(i,"path",Zk);o.appendChild(c),c.__data__=e,c.__values__={fill:"default"}}return(o.ownerSVGElement!==a||function(e,t){return e.parentNode&&e.parentNode.childNodes.length>1&&e.previousSibling!=t}(o,n))&&t.insertBefore(o,n?n.nextSibling:t.firstChild),o}Hd(Lk,Pw,{initialize:function(e,t,n,r,a){return this._defs={},this._clearDefs(),e&&(this._svg=Rw(e,0,"svg",Zk),this._svg.setAttributeNS(zk,"xmlns",Zk),this._svg.setAttributeNS(zk,"xmlns:xlink",Kx["xmlns:xlink"]),this._svg.setAttribute("version",Kx.version),this._svg.setAttribute("class","marks"),jw(e,1),this._root=Rw(this._svg,0,"g",Zk),$k(this._root,Bk),jw(this._svg,1)),this.background(this._bgcolor),Pk.initialize.call(this,e,t,n,r,a)},background:function(e){return arguments.length&&this._svg&&this._svg.style.setProperty("background-color",e),Pk.background.apply(this,arguments)},resize:function(e,t,n,r){return Pk.resize.call(this,e,t,n,r),this._svg&&($k(this._svg,{width:this._width*this._scale,height:this._height*this._scale,viewBox:"0 0 ".concat(this._width," ").concat(this._height)}),this._root.setAttribute("transform","translate(".concat(this._origin,")"))),this._dirty=[],this},canvas:function(){return this._svg},svg:function(){var e,t=this._svg,n=this._bgcolor;if(!t)return null;n&&(t.removeAttribute("style"),$k(e=Rw(t,0,"rect",Zk),{width:this._width,height:this._height,fill:n}));var r=Mk(t);return n&&(t.removeChild(e),this._svg.style.setProperty("background-color",n)),r},_render:function(e,t){return this._dirtyCheck()&&(this._dirtyAll&&this._clearDefs(),this.mark(this._root,e,void 0,t),jw(this._root,1)),this.defs(),this._dirty=[],++this._dirtyID,this},dirty:function(e){e.dirty!==this._dirtyID&&(e.dirty=this._dirtyID,this._dirty.push(e))},isDirty:function(e){return this._dirtyAll||!e._svg||!e._svg.ownerSVGElement||e.dirty===this._dirtyID},_dirtyCheck:function(){this._dirtyAll=!0;var e=this._dirty;if(!e.length||!this._dirtyID)return!0;var t,n,r,a,i,o,u,s=++this._dirtyID;for(i=0,o=e.length;i<o;++i)(n=(t=e[i]).mark).marktype!==r&&(r=n.marktype,a=Fw[r]),n.zdirty&&n.dirty!==s&&(this._dirtyAll=!1,Uk(t,s),n.items.forEach((function(e){e.dirty=s}))),n.zdirty||(t.exit?(a.nested&&n.items.length?(u=n.items[0])._svg&&this._update(a,u._svg,u):t._svg&&(u=t._svg.parentNode)&&u.removeChild(t._svg),t._svg=null):(t=a.nested?n.items[0]:t)._update!==s&&(t._svg&&t._svg.ownerSVGElement?this._update(a,t._svg,t):(this._dirtyAll=!1,Uk(t,s)),t._update=s));return!this._dirtyAll},mark:function(e,t,n,r){var a=this;if(!this.isDirty(t))return t._svg;var i=this._svg,o=t.marktype,u=Fw[o],s=!1===t.interactive?"none":null,c="g"===u.tag,l=qk(t,e,n,"g",i);if("group"!==o&&null!=r&&!r.includes(o))return jw(l,0),t._svg;l.setAttribute("class",Bw(t));var f=Nk(t);for(var d in f)Qk(l,d,f[d]);c||Qk(l,"pointer-events",s),Qk(l,"clip-path",t.clip?Rb(this,t,t.group):null);var h=null,p=0,v=function(e){var t=a.isDirty(e),n=qk(e,l,h,u.tag,i);t&&(a._update(u,n,e),c&&function(e,t,n,r){t=t.lastChild.previousSibling;var a,i=0;Ax(n,(function(n){a=e.mark(t,n,a,r),++i})),jw(t,1+i)}(a,n,e,r)),h=n,++p};return u.nested?t.items.length&&v(t.items[0]):Ax(t,v),jw(l,p),l},_update:function(e,t,n){Gk=t,Hk=t.__values__,Ek(Kk,n),e.attr(Kk,n,this);var r=Xk[e.type];r&&r.call(this,e,t,n),Gk&&this.style(Gk,n)},style:function(e,t){if(null!=t){for(var n in Rk){var r="font"===n?_w(t):t[n];if(r!==Hk[n]){var a=Rk[n];null==r?e.removeAttribute(a):(Py(r)&&(r=Uy(r,this._defs.gradient,Jk())),e.setAttribute(a,r+"")),Hk[n]=r}}for(var i in jk)Yk(e,jk[i],t[i])}},defs:function(){var e=this._svg,t=this._defs,n=t.el,r=0;for(var a in t.gradient)n||(t.el=n=Rw(e,1,"defs",Zk)),r=Wk(n,t.gradient[a],r);for(var i in t.clipping)n||(t.el=n=Rw(e,1,"defs",Zk)),r=Vk(n,t.clipping[i],r);n&&(0===r?(e.removeChild(n),t.el=null):jw(n,r))},_clearDefs:function(){var e=this._defs;e.gradient={},e.clipping={}}});var Gk=null,Hk=null,Xk={group:function(e,t,n){var r=Gk=t.childNodes[2];Hk=r.__values__,e.foreground(Kk,n,this),Hk=t.__values__,Gk=t.childNodes[1],e.content(Kk,n,this);var a=Gk=t.childNodes[0];e.background(Kk,n,this);var i=!1===n.mark.interactive?"none":null;if(i!==Hk.events&&(Qk(r,"pointer-events",i),Qk(a,"pointer-events",i),Hk.events=i),n.strokeForeground&&n.stroke){var o=n.fill;Qk(r,"display",null),this.style(a,n),Qk(a,"stroke",null),o&&(n.fill=null),Hk=r.__values__,this.style(r,n),o&&(n.fill=o),Gk=null}else Qk(r,"display","none")},image:function(e,t,n){!1===n.smooth?(Yk(t,"image-rendering","optimizeSpeed"),Yk(t,"image-rendering","pixelated")):Yk(t,"image-rendering",null)},text:function(e,t,n){var r,a,i,o,u=xw(n);zd(u)?(r=(a=u.map((function(e){return kw(n,e)}))).join("\n"))!==Hk.text&&(jw(t,0),i=t.ownerDocument,o=bw(n),a.forEach((function(e,r){var a=Mw(i,"tspan",Zk);a.__data__=n,a.textContent=e,r&&(a.setAttribute("x",0),a.setAttribute("dy",o)),t.appendChild(a)})),Hk.text=r):(a=kw(n,u))!==Hk.text&&(t.textContent=a,Hk.text=a),Qk(t,"font-family",_w(n)),Qk(t,"font-size",yw(n)+"px"),Qk(t,"font-style",n.fontStyle),Qk(t,"font-variant",n.fontVariant),Qk(t,"font-weight",n.fontWeight)}};function Kk(e,t,n){t!==Hk[e]&&(n?function(e,t,n,r){null!=n?e.setAttributeNS(r,t,n):e.removeAttributeNS(r,t)}(Gk,e,t,n):Qk(Gk,e,t),Hk[e]=t)}function Yk(e,t,n){n!==Hk[t]&&(null==n?e.style.removeProperty(t):e.style.setProperty(t,n+""),Hk[t]=n)}function $k(e,t){for(var n in t)Qk(e,n,t[n])}function Qk(e,t,n){null!=n?e.setAttribute(t,n):e.removeAttribute(t)}function Jk(){var e;return"undefined"===typeof window?"":(e=window.location).hash?e.href.slice(0,-e.hash.length):e.href}function e_(e){Pw.call(this,e),this._text=null,this._defs={gradient:{},clipping:{}}}Hd(e_,Pw,{svg:function(){return this._text},_render:function(e){var t=Fk();t.open("svg",Vd({},Kx,{class:"marks",width:this._width*this._scale,height:this._height*this._scale,viewBox:"0 0 ".concat(this._width," ").concat(this._height)}));var n=this._bgcolor;return n&&"transparent"!==n&&"none"!==n&&t.open("rect",{width:this._width,height:this._height,fill:n}).close(),t.open("g",Bk,{transform:"translate("+this._origin+")"}),this.mark(t,e),t.close(),this.defs(t),this._text=t.close()+"",this},mark:function(e,t){var n=this,r=Fw[t.marktype],a=r.tag,i=[Ek,r.attr];e.open("g",{class:Bw(t),"clip-path":t.clip?Rb(this,t,t.group):null},Nk(t),{"pointer-events":"g"!==a&&!1===t.interactive?"none":null});var o=function(o){var u=n.href(o);if(u&&e.open("a",u),e.open(a,n.attr(t,o,i,"g"!==a?a:null)),"text"===a){var s=xw(o);if(zd(s))for(var c={x:0,dy:bw(o)},l=0;l<s.length;++l)e.open("tspan",l?c:null).text(kw(o,s[l])).close();else e.text(kw(o,s))}else if("g"===a){var f=o.strokeForeground,d=o.fill,h=o.stroke;f&&h&&(o.stroke=null),e.open("path",n.attr(t,o,r.background,"bgrect")).close(),e.open("g",n.attr(t,o,r.content)),Ax(o,(function(t){return n.mark(e,t)})),e.close(),f&&h?(d&&(o.fill=null),o.stroke=h,e.open("path",n.attr(t,o,r.foreground,"bgrect")).close(),d&&(o.fill=d)):e.open("path",n.attr(t,o,r.foreground,"bgfore")).close()}e.close(),u&&e.close()};return r.nested?t.items&&t.items.length&&o(t.items[0]):Ax(t,o),e.close()},href:function(e){var t,n=this,r=e.href;if(r){if(t=this._hrefs&&this._hrefs[r])return t;this.sanitizeURL(r).then((function(e){e["xlink:href"]=e.href,e.href=null,(n._hrefs||(n._hrefs={}))[r]=e}))}return null},attr:function(e,t,n,r){var a=this,i={},o=function(e,t,n,r){i[r||e]=t};return Array.isArray(n)?n.forEach((function(e){return e(o,t,a)})):n(o,t,this),r&&function(e,t,n,r,a){var i;if(null==t)return e;"bgrect"===r&&!1===n.interactive&&(e["pointer-events"]="none");if("bgfore"===r&&(!1===n.interactive&&(e["pointer-events"]="none"),e.display="none",null!==t.fill))return e;"image"===r&&!1===t.smooth&&(i=["image-rendering: optimizeSpeed;","image-rendering: pixelated;"]);"text"===r&&(e["font-family"]=_w(t),e["font-size"]=yw(t)+"px",e["font-style"]=t.fontStyle,e["font-variant"]=t.fontVariant,e["font-weight"]=t.fontWeight);for(var o in Rk){var u=t[o],s=Rk[o];("transparent"!==u||"fill"!==s&&"stroke"!==s)&&null!=u&&(Py(u)&&(u=Uy(u,a.gradient,"")),e[s]=u)}for(var c in jk){var l=t[c];null!=l&&(i=i||[]).push("".concat(jk[c],": ").concat(l,";"))}i&&(e.style=i.join(" "))}(i,t,e,r,this._defs),i},defs:function(e){var t=this._defs.gradient,n=this._defs.clipping;if(0!==Object.keys(t).length+Object.keys(n).length){for(var r in e.open("defs"),t){var a=t[r],i=a.stops;"radial"===a.gradient?(e.open("pattern",{id:Ly+r,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),e.open("rect",{width:"1",height:"1",fill:"url(#"+r+")"}).close(),e.close(),e.open("radialGradient",{id:r,fx:a.x1,fy:a.y1,fr:a.r1,cx:a.x2,cy:a.y2,r:a.r2})):e.open("linearGradient",{id:r,x1:a.x1,x2:a.x2,y1:a.y1,y2:a.y2});for(var o=0;o<i.length;++o)e.open("stop",{offset:i[o].offset,"stop-color":i[o].color}).close();e.close()}for(var u in n){var s=n[u];e.open("clipPath",{id:u}),s.path?e.open("path",{d:s.path}).close():e.open("rect",{x:0,y:0,width:s.width,height:s.height}).close(),e.close()}e.close()}}});var t_={svgMarkTypes:["text"],svgOnTop:!0,debug:!1};function n_(e){Pw.call(this,e),this._svgRenderer=new Lk(e),this._canvasRenderer=new hk(e)}var r_=Pw.prototype;function a_(e,t){uk.call(this,e,t)}Hd(n_,Pw,{initialize:function(e,t,n,r,a){this._root_el=Rw(e,0,"div");var i=Rw(this._root_el,0,"div"),o=Rw(this._root_el,1,"div");return this._root_el.style.position="relative",t_.debug||(i.style.height="100%",o.style.position="absolute",o.style.top="0",o.style.left="0",o.style.height="100%",o.style.width="100%"),this._svgEl=t_.svgOnTop?o:i,this._canvasEl=t_.svgOnTop?i:o,this._svgEl.style.pointerEvents="none",this._canvasRenderer.initialize(this._canvasEl,t,n,r,a),this._svgRenderer.initialize(this._svgEl,t,n,r,a),r_.initialize.call(this,e,t,n,r,a)},dirty:function(e){return t_.svgMarkTypes.includes(e.mark.marktype)?this._svgRenderer.dirty(e):this._canvasRenderer.dirty(e),this},_render:function(e,t){var n=(null!==t&&void 0!==t?t:["arc","area","image","line","path","rect","rule","shape","symbol","text","trail"]).filter((function(e){return!t_.svgMarkTypes.includes(e)}));this._svgRenderer.render(e,t_.svgMarkTypes),this._canvasRenderer.render(e,n)},resize:function(e,t,n,r){return r_.resize.call(this,e,t,n,r),this._svgRenderer.resize(e,t,n,r),this._canvasRenderer.resize(e,t,n,r),this},background:function(e){return t_.svgOnTop?this._canvasRenderer.background(e):this._svgRenderer.background(e),this}}),Hd(a_,uk,{initialize:function(e,t,n){var r=Rw(Rw(e,0,"div"),t_.svgOnTop?0:1,"div");return uk.prototype.initialize.call(this,r,t,n)}});var i_={};i_.canvas=i_.png={renderer:hk,headless:hk,handler:uk},i_.svg={renderer:Lk,headless:e_,handler:vk},i_.hybrid={renderer:n_,headless:n_,handler:a_},i_.none={};var o_=new jb;var u_="top",s_="left",c_="right",l_="bottom",f_="start",d_="middle",h_="end",p_="group",v_="axis",m_="title",g_="frame",y_="scope",b_="legend",x_="row-header",w_="row-footer",k_="row-title",__="column-header",S_="column-footer",C_="column-title",A_="padding",E_="fit",N_="fit-x",T_="fit-y",I_="none",D_="all",F_="each",M_="flush",O_="column",R_="row";function j_(e){wu.call(this,null,e)}function B_(e,t,n){return t(e.bounds.clear(),e,n)}Hd(j_,wu,{transform:function(e,t){var n,r=t.dataflow,a=e.mark,i=a.marktype,o=Fw[i],u=o.bound,s=a.bounds;if(o.nested)a.items.length&&r.dirty(a.items[0]),s=B_(a,u),a.items.forEach((function(e){e.bounds.clear().union(s)}));else if(i===p_||e.modified())switch(t.visit(t.MOD,(function(e){return r.dirty(e)})),s.clear(),a.items.forEach((function(e){return s.union(B_(e,u))})),a.role){case v_:case b_:case m_:t.reflow()}else n=t.changed(t.REM),t.visit(t.ADD,(function(e){s.union(B_(e,u))})),t.visit(t.MOD,(function(e){n=n||s.alignsWith(e.bounds),r.dirty(e),s.union(B_(e,u))})),n&&(s.clear(),a.items.forEach((function(e){return s.union(e.bounds)})));return function(e){var t=e.clip;if(Wd(t))t(ox(o_.clear()));else{if(!t)return;o_.set(0,0,e.group.width,e.group.height)}e.bounds.intersect(o_)}(a),t.modifies("bounds")}});var z_=":vega_identifier:";function Z_(e){wu.call(this,0,e)}function L_(e){wu.call(this,null,e)}function P_(e){wu.call(this,null,e)}Z_.Definition={type:"Identifier",metadata:{modifies:!0},params:[{name:"as",type:"string",required:!0}]},Hd(Z_,wu,{transform:function(e,t){var n,r=(n=t.dataflow)._signals[z_]||(n._signals[z_]=n.add(0)),a=e.as,i=r.value;return t.visit(t.ADD,(function(e){return e[a]=e[a]||++i})),r.set(this.value=i),t}}),Hd(L_,wu,{transform:function(e,t){var n=this.value;n||((n=t.dataflow.scenegraph().mark(e.markdef,function(e){var t=e.groups,n=e.parent;return t&&1===t.size?t.get(Object.keys(t.object)[0]):t&&n?t.lookup(n):null}(e),e.index)).group.context=e.context,e.context.group||(e.context.group=n.group),n.source=this.source,n.clip=e.clip,n.interactive=e.interactive,this.value=n);var r=n.marktype===p_?zb:Bb;return t.visit(t.ADD,(function(e){return r.call(e,n)})),(e.modified("clip")||e.modified("interactive"))&&(n.clip=e.clip,n.interactive=!!e.interactive,n.zdirty=!0,t.reflow()),n.items=t.source,t}});var U_={parity:function(e){return e.filter((function(e,t){return t%2?e.opacity=0:1}))},greedy:function(e,t){var n;return e.filter((function(e,r){return r&&W_(n.bounds,e.bounds,t)?e.opacity=0:(n=e,1)}))}},W_=function(e,t,n){return n>Math.max(t.x1-e.x2,e.x1-t.x2,t.y1-e.y2,e.y1-t.y2)},V_=function(e,t){for(var n,r=1,a=e.length,i=e[0].bounds;r<a;i=n,++r)if(W_(i,n=e[r].bounds,t))return!0},q_=function(e){var t=e.bounds;return t.width()>1&&t.height()>1},G_=function(e){return e.forEach((function(e){return e.opacity=1})),e},H_=function(e,t){return e.reflow(t.modified()).modifies("opacity")};function X_(e){wu.call(this,null,e)}Hd(P_,wu,{transform:function(e,t){var n,r,a=U_[e.method]||U_.parity,i=e.separation||0,o=t.materialize(t.SOURCE).source;if(o&&o.length){if(!e.method)return e.modified("method")&&(G_(o),t=H_(t,e)),t;if((o=o.filter(q_)).length){if(e.sort&&(o=o.slice().sort(e.sort)),n=G_(o),t=H_(t,e),n.length>=3&&V_(n,i)){do{n=a(n,i)}while(n.length>=3&&V_(n,i));n.length<3&&!Ld(o).opacity&&(n.length>1&&(Ld(n).opacity=0),Ld(o).opacity=1)}e.boundScale&&e.boundTolerance>=0&&(r=function(e,t,n){var r=e.range(),a=new jb;return t===u_||t===l_?a.set(r[0],-1/0,r[1],1/0):a.set(-1/0,r[0],1/0,r[1]),a.expand(n||1),function(e){return a.encloses(e.bounds)}}(e.boundScale,e.boundOrient,+e.boundTolerance),o.forEach((function(e){r(e)||(e.opacity=0)})));var u=n[0].mark.bounds.clear();return o.forEach((function(e){e.opacity&&u.union(e.bounds)})),t}}}}),Hd(X_,wu,{transform:function(e,t){var n=t.dataflow;if(t.visit(t.ALL,(function(e){return n.dirty(e)})),t.fields&&t.fields.zindex){var r=t.source&&t.source[0];r&&(r.mark.zdirty=!0)}}});var K_=new jb;function Y_(e,t,n){return e[t]===n?0:(e[t]=n,1)}function $_(e){var t=e.items[0].orient;return t===s_||t===c_}function Q_(e,t,n,r){var a,i,o=t.items[0],u=o.datum,s=null!=o.translate?o.translate:.5,c=o.orient,l=function(e){var t=+e.grid;return[e.ticks?t++:-1,e.labels?t++:-1,t+ +e.domain]}(u),f=o.range,d=o.offset,h=o.position,p=o.minExtent,v=o.maxExtent,m=u.title&&o.items[l[2]].items[0],g=o.titlePadding,y=o.bounds,b=m&&ww(m),x=0,w=0;switch(K_.clear().union(y),y.clear(),(a=l[0])>-1&&y.union(o.items[a].bounds),(a=l[1])>-1&&y.union(o.items[a].bounds),c){case u_:x=h||0,w=-d,i=Math.max(p,Math.min(v,-y.y1)),y.add(0,-i).add(f,0),m&&J_(e,m,i,g,b,0,-1,y);break;case s_:x=-d,w=h||0,i=Math.max(p,Math.min(v,-y.x1)),y.add(-i,0).add(0,f),m&&J_(e,m,i,g,b,1,-1,y);break;case c_:x=n+d,w=h||0,i=Math.max(p,Math.min(v,y.x2)),y.add(0,0).add(i,f),m&&J_(e,m,i,g,b,1,1,y);break;case l_:x=h||0,w=r+d,i=Math.max(p,Math.min(v,y.y2)),y.add(0,0).add(f,i),m&&J_(e,m,i,g,0,0,1,y);break;default:x=o.x,w=o.y}return Ub(y.translate(x,w),o),Y_(o,"x",x+s)|Y_(o,"y",w+s)&&(o.bounds=K_,e.dirty(o),o.bounds=y,e.dirty(o)),o.mark.bounds.clear().union(y)}function J_(e,t,n,r,a,i,o,u){var s=t.bounds;if(t.auto){var c=o*(n+a+r),l=0,f=0;e.dirty(t),i?l=(t.x||0)-(t.x=c):f=(t.y||0)-(t.y=c),t.mark.bounds.clear().union(s.translate(-l,-f)),e.dirty(t)}u.union(s)}var eS=function(e,t){return Math.floor(Math.min(e,t))},tS=function(e,t){return Math.ceil(Math.max(e,t))};function nS(e){return(new jb).set(0,0,e.width||0,e.height||0)}function rS(e){var t=e.bounds.clone();return t.empty()?t.set(0,0,0,0):t.translate(-(e.x||0),-(e.y||0))}function aS(e,t,n){var r=Zd(e)?e[t]:e;return null!=r?r:void 0!==n?n:0}function iS(e){return e<0?Math.ceil(-e):0}function oS(e,t,n){var r,a,i,o,u,s,c,l,f,d,h,p=!n.nodirty,v=n.bounds===M_?nS:rS,m=K_.set(0,0,0,0),g=aS(n.align,O_),y=aS(n.align,R_),b=aS(n.padding,O_),x=aS(n.padding,R_),w=n.columns||t.length,k=w<=0?1:Math.ceil(t.length/w),_=t.length,S=Array(_),C=Array(w),A=0,E=Array(_),N=Array(k),T=0,I=Array(_),D=Array(_),F=Array(_);for(a=0;a<w;++a)C[a]=0;for(a=0;a<k;++a)N[a]=0;for(a=0;a<_;++a)s=t[a],u=F[a]=v(s),s.x=s.x||0,I[a]=0,s.y=s.y||0,D[a]=0,i=a%w,o=~~(a/w),A=Math.max(A,c=Math.ceil(u.x2)),T=Math.max(T,l=Math.ceil(u.y2)),C[i]=Math.max(C[i],c),N[o]=Math.max(N[o],l),S[a]=b+iS(u.x1),E[a]=x+iS(u.y1),p&&e.dirty(t[a]);for(a=0;a<_;++a)a%w===0&&(S[a]=0),a<w&&(E[a]=0);if(g===F_)for(i=1;i<w;++i){for(h=0,a=i;a<_;a+=w)h<S[a]&&(h=S[a]);for(a=i;a<_;a+=w)S[a]=h+C[i-1]}else if(g===D_){for(h=0,a=0;a<_;++a)a%w&&h<S[a]&&(h=S[a]);for(a=0;a<_;++a)a%w&&(S[a]=h+A)}else for(g=!1,i=1;i<w;++i)for(a=i;a<_;a+=w)S[a]+=C[i-1];if(y===F_)for(o=1;o<k;++o){for(h=0,r=(a=o*w)+w;a<r;++a)h<E[a]&&(h=E[a]);for(a=o*w;a<r;++a)E[a]=h+N[o-1]}else if(y===D_){for(h=0,a=w;a<_;++a)h<E[a]&&(h=E[a]);for(a=w;a<_;++a)E[a]=h+T}else for(y=!1,o=1;o<k;++o)for(r=(a=o*w)+w;a<r;++a)E[a]+=N[o-1];for(f=0,a=0;a<_;++a)f=S[a]+(a%w?f:0),I[a]+=f-t[a].x;for(i=0;i<w;++i)for(d=0,a=i;a<_;a+=w)d+=E[a],D[a]+=d-t[a].y;if(g&&aS(n.center,O_)&&k>1)for(a=0;a<_;++a)(f=(u=g===D_?A:C[a%w])-F[a].x2-t[a].x-I[a])>0&&(I[a]+=f/2);if(y&&aS(n.center,R_)&&1!==w)for(a=0;a<_;++a)(d=(u=y===D_?T:N[~~(a/w)])-F[a].y2-t[a].y-D[a])>0&&(D[a]+=d/2);for(a=0;a<_;++a)m.union(F[a].translate(I[a],D[a]));switch(f=aS(n.anchor,"x"),d=aS(n.anchor,"y"),aS(n.anchor,O_)){case h_:f-=m.width();break;case d_:f-=m.width()/2}switch(aS(n.anchor,R_)){case h_:d-=m.height();break;case d_:d-=m.height()/2}for(f=Math.round(f),d=Math.round(d),m.clear(),a=0;a<_;++a)t[a].mark.bounds.clear();for(a=0;a<_;++a)(s=t[a]).x+=I[a]+=f,s.y+=D[a]+=d,m.union(s.mark.bounds.union(s.bounds.translate(I[a],D[a]))),p&&e.dirty(s);return m}function uS(e,t,n){var r,a,i,o,u,s,c,l=function(e){for(var t,n,r,a,i,o,u,s=e.items,c=s.length,l=0,f={marks:[],rowheaders:[],rowfooters:[],colheaders:[],colfooters:[],rowtitle:null,coltitle:null};l<c;++l)if(u=(o=s[l]).items,o.marktype===p_)switch(o.role){case v_:case b_:case m_:break;case x_:(t=f.rowheaders).push.apply(t,(0,cn.Z)(u));break;case w_:(n=f.rowfooters).push.apply(n,(0,cn.Z)(u));break;case __:(r=f.colheaders).push.apply(r,(0,cn.Z)(u));break;case S_:(a=f.colfooters).push.apply(a,(0,cn.Z)(u));break;case k_:f.rowtitle=u[0];break;case C_:f.coltitle=u[0];break;default:(i=f.marks).push.apply(i,(0,cn.Z)(u))}return f}(t),f=l.marks,d=n.bounds===M_?sS:cS,h=n.offset,p=n.columns||f.length,v=p<=0?1:Math.ceil(f.length/p),m=v*p,g=oS(e,f,n);g.empty()&&g.set(0,0,0,0),l.rowheaders&&(s=aS(n.headerBand,R_,null),r=lS(e,l.rowheaders,f,p,v,-aS(h,"rowHeader"),eS,0,d,"x1",0,p,1,s)),l.colheaders&&(s=aS(n.headerBand,O_,null),a=lS(e,l.colheaders,f,p,p,-aS(h,"columnHeader"),eS,1,d,"y1",0,1,p,s)),l.rowfooters&&(s=aS(n.footerBand,R_,null),i=lS(e,l.rowfooters,f,p,v,aS(h,"rowFooter"),tS,0,d,"x2",p-1,p,1,s)),l.colfooters&&(s=aS(n.footerBand,O_,null),o=lS(e,l.colfooters,f,p,p,aS(h,"columnFooter"),tS,1,d,"y2",m-p,1,p,s)),l.rowtitle&&(u=aS(n.titleAnchor,R_),c=aS(h,"rowTitle"),c=u===h_?i+c:r-c,s=aS(n.titleBand,R_,.5),fS(e,l.rowtitle,c,0,g,s)),l.coltitle&&(u=aS(n.titleAnchor,O_),c=aS(h,"columnTitle"),c=u===h_?o+c:a-c,s=aS(n.titleBand,O_,.5),fS(e,l.coltitle,c,1,g,s))}function sS(e,t){return"x1"===t?e.x||0:"y1"===t?e.y||0:"x2"===t?(e.x||0)+(e.width||0):"y2"===t?(e.y||0)+(e.height||0):void 0}function cS(e,t){return e.bounds[t]}function lS(e,t,n,r,a,i,o,u,s,c,l,f,d,h){var p,v,m,g,y,b,x,w,k,_=n.length,S=0,C=0;if(!_)return S;for(p=l;p<_;p+=f)n[p]&&(S=o(S,s(n[p],c)));if(!t.length)return S;for(t.length>a&&(e.warn("Grid headers exceed limit: "+a),t=t.slice(0,a)),S+=i,v=0,g=t.length;v<g;++v)e.dirty(t[v]),t[v].mark.bounds.clear();for(p=l,v=0,g=t.length;v<g;++v,p+=f){for(y=(b=t[v]).mark.bounds,m=p;m>=0&&null==(x=n[m]);m-=d);u?(w=null==h?x.x:Math.round(x.bounds.x1+h*x.bounds.width()),k=S):(w=S,k=null==h?x.y:Math.round(x.bounds.y1+h*x.bounds.height())),y.union(b.bounds.translate(w-(b.x||0),k-(b.y||0))),b.x=w,b.y=k,e.dirty(b),C=o(C,y[c])}return C}function fS(e,t,n,r,a,i){if(t){e.dirty(t);var o=n,u=n;r?o=Math.round(a.x1+i*a.width()):u=Math.round(a.y1+i*a.height()),t.bounds.translate(o-(t.x||0),u-(t.y||0)),t.mark.bounds.clear().union(t.bounds),t.x=o,t.y=u,e.dirty(t)}}function dS(e,t,n,r,a,i,o){var u=function(e,t){var n=e[t]||{};return function(t,r){return null!=n[t]?n[t]:null!=e[t]?e[t]:r}}(n,t),s=function(e,t){var n=-1/0;return e.forEach((function(e){null!=e.offset&&(n=Math.max(n,e.offset))})),n>-1/0?n:t}(e,u("offset",0)),c=u("anchor",f_),l=c===h_?1:c===d_?.5:0,f={align:F_,bounds:u("bounds",M_),columns:"vertical"===u("direction")?1:e.length,padding:u("margin",8),center:u("center"),nodirty:!0};switch(t){case s_:f.anchor={x:Math.floor(r.x1)-s,column:h_,y:l*(o||r.height()+2*r.y1),row:c};break;case c_:f.anchor={x:Math.ceil(r.x2)+s,y:l*(o||r.height()+2*r.y1),row:c};break;case u_:f.anchor={y:Math.floor(a.y1)-s,row:h_,x:l*(i||a.width()+2*a.x1),column:c};break;case l_:f.anchor={y:Math.ceil(a.y2)+s,x:l*(i||a.width()+2*a.x1),column:c};break;case"top-left":f.anchor={x:s,y:s};break;case"top-right":f.anchor={x:i-s,y:s,column:h_};break;case"bottom-left":f.anchor={x:s,y:o-s,row:h_};break;case"bottom-right":f.anchor={x:i-s,y:o-s,column:h_,row:h_}}return f}function hS(e,t){var n,r,a=t.items[0],i=a.datum,o=a.orient,u=a.bounds,s=a.x,c=a.y;return a._bounds?a._bounds.clear().union(u):a._bounds=u.clone(),u.clear(),function(e,t,n){var r=t.padding,a=r-n.x,i=r-n.y;if(t.datum.title){var o=t.items[1].items[0],u=o.anchor,s=t.titlePadding||0,c=r-o.x,l=r-o.y;switch(o.orient){case s_:a+=Math.ceil(o.bounds.width())+s;break;case c_:case l_:break;default:i+=o.bounds.height()+s}switch((a||i)&&vS(e,n,a,i),o.orient){case s_:l+=pS(t,n,o,u,1,1);break;case c_:c+=pS(t,n,o,h_,0,0)+s,l+=pS(t,n,o,u,1,1);break;case l_:c+=pS(t,n,o,u,0,0),l+=pS(t,n,o,h_,-1,0,1)+s;break;default:c+=pS(t,n,o,u,0,0)}(c||l)&&vS(e,o,c,l),(c=Math.round(o.bounds.x1-r))<0&&(vS(e,n,-c,0),vS(e,o,-c,0))}else(a||i)&&vS(e,n,a,i)}(e,a,a.items[0].items[0]),u=function(e,t){return e.items.forEach((function(e){return t.union(e.bounds)})),t.x1=e.padding,t.y1=e.padding,t}(a,u),n=2*a.padding,r=2*a.padding,u.empty()||(n=Math.ceil(u.width()+n),r=Math.ceil(u.height()+r)),"symbol"===i.type&&function(e){var t=e.reduce((function(e,t){return e[t.column]=Math.max(t.bounds.x2-t.x,e[t.column]||0),e}),{});e.forEach((function(e){e.width=t[e.column],e.height=e.bounds.y2-e.y}))}(a.items[0].items[0].items[0].items),o!==I_&&(a.x=s=0,a.y=c=0),a.width=n,a.height=r,Ub(u.set(s,c,s+n,c+r),a),a.mark.bounds.clear().union(u),a}function pS(e,t,n,r,a,i,o){var u="symbol"!==e.datum.type,s=n.datum.vgrad,c=(!u||!i&&s||o?t:t.items[0]).bounds[a?"y2":"x2"]-e.padding,l=s&&i?c:0,f=s&&i?0:c,d=a<=0?0:ww(n);return Math.round(r===f_?l:r===h_?f-d:.5*(c-d))}function vS(e,t,n,r){t.x+=n,t.y+=r,t.bounds.translate(n,r),t.mark.bounds.translate(n,r),e.dirty(t)}function mS(e){wu.call(this,null,e)}function gS(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function yS(e){var t=e,n=e;function r(e,t,r,a){for(null==r&&(r=0),null==a&&(a=e.length);r<a;){var i=r+a>>>1;n(e[i],t)<0?r=i+1:a=i}return r}return 1===e.length&&(t=function(t,n){return e(t)-n},n=function(e){return function(t,n){return gS(e(t),n)}}(e)),{left:r,center:function(e,n,a,i){null==a&&(a=0),null==i&&(i=e.length);var o=r(e,n,a,i-1);return o>a&&t(e[o-1],n)>-t(e[o],n)?o-1:o},right:function(e,t,r,a){for(null==r&&(r=0),null==a&&(a=e.length);r<a;){var i=r+a>>>1;n(e[i],t)>0?a=i:r=i+1}return r}}}Hd(mS,wu,{transform:function(e,t){var n=t.dataflow;return e.mark.items.forEach((function(t){e.layout&&uS(n,t,e.layout),function(e,t,n){var r,a,i,o,u,s=t.items,c=Math.max(0,t.width||0),l=Math.max(0,t.height||0),f=(new jb).set(0,0,c,l),d=f.clone(),h=f.clone(),p=[];for(o=0,u=s.length;o<u;++o)switch((a=s[o]).role){case v_:($_(a)?d:h).union(Q_(e,a,c,l));break;case m_:r=a;break;case b_:p.push(hS(e,a));break;case g_:case y_:case x_:case w_:case k_:case __:case S_:case C_:d.union(a.bounds),h.union(a.bounds);break;default:f.union(a.bounds)}if(p.length){var v={};for(var m in p.forEach((function(e){(i=e.orient||c_)!==I_&&(v[i]||(v[i]=[])).push(e)})),v){var g=v[m];oS(e,g,dS(g,m,n.legends,d,h,c,l))}p.forEach((function(t){var r=t.bounds;if(r.equals(t._bounds)||(t.bounds=t._bounds,e.dirty(t),t.bounds=r,e.dirty(t)),!n.autosize||n.autosize.type!==E_&&n.autosize.type!==N_&&n.autosize.type!==T_)f.union(r);else switch(t.orient){case s_:case c_:f.add(r.x1,0).add(r.x2,0);break;case u_:case l_:f.add(0,r.y1).add(0,r.y2)}}))}f.union(d).union(h),r&&f.union(function(e,t,n,r,a){var i,o=t.items[0],u=o.frame,s=o.orient,c=o.anchor,l=o.offset,f=o.padding,d=o.items[0].items[0],h=o.items[1]&&o.items[1].items[0],p=s===s_||s===c_?r:n,v=0,m=0,g=0,y=0,b=0;if(u!==p_?s===s_?(v=a.y2,p=a.y1):s===c_?(v=a.y1,p=a.y2):(v=a.x1,p=a.x2):s===s_&&(v=r,p=0),i=c===f_?v:c===h_?p:(v+p)/2,h&&h.text){switch(s){case u_:case l_:b=d.bounds.height()+f;break;case s_:y=d.bounds.width()+f;break;case c_:y=-d.bounds.width()-f}K_.clear().union(h.bounds),K_.translate(y-(h.x||0),b-(h.y||0)),Y_(h,"x",y)|Y_(h,"y",b)&&(e.dirty(h),h.bounds.clear().union(K_),h.mark.bounds.clear().union(K_),e.dirty(h)),K_.clear().union(h.bounds)}else K_.clear();switch(K_.union(d.bounds),s){case u_:m=i,g=a.y1-K_.height()-l;break;case s_:m=a.x1-K_.width()-l,g=i;break;case c_:m=a.x2+K_.width()+l,g=i;break;case l_:m=i,g=a.y2+l;break;default:m=o.x,g=o.y}return Y_(o,"x",m)|Y_(o,"y",g)&&(K_.translate(m,g),e.dirty(o),o.bounds.clear().union(K_),t.bounds.clear().union(K_),e.dirty(o)),o.bounds}(e,r,c,l,f));t.clip&&f.set(0,0,t.width||0,t.height||0);!function(e,t,n,r){var a=r.autosize||{},i=a.type;if(e._autosize<1||!i)return;var o=e._width,u=e._height,s=Math.max(0,t.width||0),c=Math.max(0,Math.ceil(-n.x1)),l=Math.max(0,t.height||0),f=Math.max(0,Math.ceil(-n.y1)),d=Math.max(0,Math.ceil(n.x2-s)),h=Math.max(0,Math.ceil(n.y2-l));if(a.contains===A_){var p=e.padding();o-=p.left+p.right,u-=p.top+p.bottom}i===I_?(c=0,f=0,s=o,l=u):i===E_?(s=Math.max(0,o-c-d),l=Math.max(0,u-f-h)):i===N_?(s=Math.max(0,o-c-d),u=l+f+h):i===T_?(o=s+c+d,l=Math.max(0,u-f-h)):"pad"===i&&(o=s+c+d,u=l+f+h);e._resizeView(o,u,s,l,[c,f],a.resize)}(e,t,f,n)}(n,t,e)})),function(e){return e&&"legend-entry"!==e.mark.role}(e.mark.group)?t.reflow():t}});function bS(e){return null===e?NaN:+e}var xS=yS(gS),wS=xS.right,kS=(xS.left,yS(bS).center,wS);function _S(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e)}return this}function SS(e,t){switch(arguments.length){case 0:break;case 1:"function"===typeof e?this.interpolator(e):this.range(e);break;default:this.domain(e),"function"===typeof t?this.interpolator(t):this.range(t)}return this}var CS=Symbol("implicit");function AS(){var e=new Map,t=[],n=[],r=CS;function a(a){var i=a+"",o=e.get(i);if(!o){if(r!==CS)return r;e.set(i,o=t.push(a))}return n[(o-1)%n.length]}return a.domain=function(n){if(!arguments.length)return t.slice();t=[],e=new Map;var r,i=(0,Rt.Z)(n);try{for(i.s();!(r=i.n()).done;){var o=r.value,u=o+"";e.has(u)||e.set(u,t.push(o))}}catch(s){i.e(s)}finally{i.f()}return a},a.range=function(e){return arguments.length?(n=Array.from(e),a):n.slice()},a.unknown=function(e){return arguments.length?(r=e,a):r},a.copy=function(){return AS(t,n).unknown(r)},_S.apply(a,arguments),a}var ES=Math.sqrt(50),NS=Math.sqrt(10),TS=Math.sqrt(2);function IS(e,t,n){var r,a,i,o,u=-1;if(n=+n,(e=+e)===(t=+t)&&n>0)return[e];if((r=t<e)&&(a=e,e=t,t=a),0===(o=DS(e,t,n))||!isFinite(o))return[];if(o>0){var s=Math.round(e/o),c=Math.round(t/o);for(s*o<e&&++s,c*o>t&&--c,i=new Array(a=c-s+1);++u<a;)i[u]=(s+u)*o}else{o=-o;var l=Math.round(e*o),f=Math.round(t*o);for(l/o<e&&++l,f/o>t&&--f,i=new Array(a=f-l+1);++u<a;)i[u]=(l+u)/o}return r&&i.reverse(),i}function DS(e,t,n){var r=(t-e)/Math.max(0,n),a=Math.floor(Math.log(r)/Math.LN10),i=r/Math.pow(10,a);return a>=0?(i>=ES?10:i>=NS?5:i>=TS?2:1)*Math.pow(10,a):-Math.pow(10,-a)/(i>=ES?10:i>=NS?5:i>=TS?2:1)}function FS(e,t,n){var r=Math.abs(t-e)/Math.max(0,n),a=Math.pow(10,Math.floor(Math.log(r)/Math.LN10)),i=r/a;return i>=ES?a*=10:i>=NS?a*=5:i>=TS&&(a*=2),t<e?-a:a}function MS(e,t,n,r){var a,i=FS(e,t,n);switch((r=(0,_m.formatSpecifier)(null==r?",f":r)).type){case"s":var o=Math.max(Math.abs(e),Math.abs(t));return null!=r.precision||isNaN(a=(0,_m.precisionPrefix)(i,o))||(r.precision=a),(0,_m.formatPrefix)(r,o);case"":case"e":case"g":case"p":case"r":null!=r.precision||isNaN(a=(0,_m.precisionRound)(i,Math.max(Math.abs(e),Math.abs(t))))||(r.precision=a-("e"===r.type));break;case"f":case"%":null!=r.precision||isNaN(a=(0,_m.precisionFixed)(i))||(r.precision=a-2*("%"===r.type))}return(0,_m.format)(r)}function OS(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function RS(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function jS(){}var BS=.7,zS=1/BS,ZS="\\s*([+-]?\\d+)\\s*",LS="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",PS="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",US=/^#([0-9a-f]{3,8})$/,WS=new RegExp("^rgb\\("+[ZS,ZS,ZS]+"\\)$"),VS=new RegExp("^rgb\\("+[PS,PS,PS]+"\\)$"),qS=new RegExp("^rgba\\("+[ZS,ZS,ZS,LS]+"\\)$"),GS=new RegExp("^rgba\\("+[PS,PS,PS,LS]+"\\)$"),HS=new RegExp("^hsl\\("+[LS,PS,PS]+"\\)$"),XS=new RegExp("^hsla\\("+[LS,PS,PS,LS]+"\\)$"),KS={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function YS(){return this.rgb().formatHex()}function $S(){return this.rgb().formatRgb()}function QS(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=US.exec(e))?(n=t[1].length,t=parseInt(t[1],16),6===n?JS(t):3===n?new rC(t>>8&15|t>>4&240,t>>4&15|240&t,(15&t)<<4|15&t,1):8===n?eC(t>>24&255,t>>16&255,t>>8&255,(255&t)/255):4===n?eC(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|240&t,((15&t)<<4|15&t)/255):null):(t=WS.exec(e))?new rC(t[1],t[2],t[3],1):(t=VS.exec(e))?new rC(255*t[1]/100,255*t[2]/100,255*t[3]/100,1):(t=qS.exec(e))?eC(t[1],t[2],t[3],t[4]):(t=GS.exec(e))?eC(255*t[1]/100,255*t[2]/100,255*t[3]/100,t[4]):(t=HS.exec(e))?uC(t[1],t[2]/100,t[3]/100,1):(t=XS.exec(e))?uC(t[1],t[2]/100,t[3]/100,t[4]):KS.hasOwnProperty(e)?JS(KS[e]):"transparent"===e?new rC(NaN,NaN,NaN,0):null}function JS(e){return new rC(e>>16&255,e>>8&255,255&e,1)}function eC(e,t,n,r){return r<=0&&(e=t=n=NaN),new rC(e,t,n,r)}function tC(e){return e instanceof jS||(e=QS(e)),e?new rC((e=e.rgb()).r,e.g,e.b,e.opacity):new rC}function nC(e,t,n,r){return 1===arguments.length?tC(e):new rC(e,t,n,null==r?1:r)}function rC(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}function aC(){return"#"+oC(this.r)+oC(this.g)+oC(this.b)}function iC(){var e=this.opacity;return(1===(e=isNaN(e)?1:Math.max(0,Math.min(1,e)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===e?")":", "+e+")")}function oC(e){return((e=Math.max(0,Math.min(255,Math.round(e)||0)))<16?"0":"")+e.toString(16)}function uC(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new lC(e,t,n,r)}function sC(e){if(e instanceof lC)return new lC(e.h,e.s,e.l,e.opacity);if(e instanceof jS||(e=QS(e)),!e)return new lC;if(e instanceof lC)return e;var t=(e=e.rgb()).r/255,n=e.g/255,r=e.b/255,a=Math.min(t,n,r),i=Math.max(t,n,r),o=NaN,u=i-a,s=(i+a)/2;return u?(o=t===i?(n-r)/u+6*(n<r):n===i?(r-t)/u+2:(t-n)/u+4,u/=s<.5?i+a:2-i-a,o*=60):u=s>0&&s<1?0:o,new lC(o,u,s,e.opacity)}function cC(e,t,n,r){return 1===arguments.length?sC(e):new lC(e,t,n,null==r?1:r)}function lC(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}function fC(e,t,n){return 255*(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)}function dC(e,t,n,r,a){var i=e*e,o=i*e;return((1-3*e+3*i-o)*t+(4-6*i+3*o)*n+(1+3*e+3*i-3*o)*r+o*a)/6}function hC(e){var t=e.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,t-1):Math.floor(n*t),a=e[r],i=e[r+1],o=r>0?e[r-1]:2*a-i,u=r<t-1?e[r+2]:2*i-a;return dC((n-r/t)*t,o,a,i,u)}}function pC(e){var t=e.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*t),a=e[(r+t-1)%t],i=e[r%t],o=e[(r+1)%t],u=e[(r+2)%t];return dC((n-r/t)*t,a,i,o,u)}}OS(jS,QS,{copy:function(e){return Object.assign(new this.constructor,this,e)},displayable:function(){return this.rgb().displayable()},hex:YS,formatHex:YS,formatHsl:function(){return sC(this).formatHsl()},formatRgb:$S,toString:$S}),OS(rC,nC,RS(jS,{brighter:function(e){return e=null==e?zS:Math.pow(zS,e),new rC(this.r*e,this.g*e,this.b*e,this.opacity)},darker:function(e){return e=null==e?BS:Math.pow(BS,e),new rC(this.r*e,this.g*e,this.b*e,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:aC,formatHex:aC,formatRgb:iC,toString:iC})),OS(lC,cC,RS(jS,{brighter:function(e){return e=null==e?zS:Math.pow(zS,e),new lC(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=null==e?BS:Math.pow(BS,e),new lC(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=this.h%360+360*(this.h<0),t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,a=2*n-r;return new rC(fC(e>=240?e-240:e+120,a,r),fC(e,a,r),fC(e<120?e+240:e-120,a,r),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var e=this.opacity;return(1===(e=isNaN(e)?1:Math.max(0,Math.min(1,e)))?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(1===e?")":", "+e+")")}}));var vC=function(e){return function(){return e}};function mC(e,t){return function(n){return e+n*t}}function gC(e,t){var n=t-e;return n?mC(e,n>180||n<-180?n-360*Math.round(n/360):n):vC(isNaN(e)?t:e)}function yC(e){return 1===(e=+e)?bC:function(t,n){return n-t?function(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}(t,n,e):vC(isNaN(t)?n:t)}}function bC(e,t){var n=t-e;return n?mC(e,n):vC(isNaN(e)?t:e)}var xC=function e(t){var n=yC(t);function r(e,t){var r=n((e=nC(e)).r,(t=nC(t)).r),a=n(e.g,t.g),i=n(e.b,t.b),o=bC(e.opacity,t.opacity);return function(t){return e.r=r(t),e.g=a(t),e.b=i(t),e.opacity=o(t),e+""}}return r.gamma=e,r}(1);function wC(e){return function(t){var n,r,a=t.length,i=new Array(a),o=new Array(a),u=new Array(a);for(n=0;n<a;++n)r=nC(t[n]),i[n]=r.r||0,o[n]=r.g||0,u[n]=r.b||0;return i=e(i),o=e(o),u=e(u),r.opacity=1,function(e){return r.r=i(e),r.g=o(e),r.b=u(e),r+""}}}var kC=wC(hC),_C=wC(pC);function SC(e,t){t||(t=[]);var n,r=e?Math.min(t.length,e.length):0,a=t.slice();return function(i){for(n=0;n<r;++n)a[n]=e[n]*(1-i)+t[n]*i;return a}}function CC(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function AC(e,t){return(CC(t)?SC:EC)(e,t)}function EC(e,t){var n,r=t?t.length:0,a=e?Math.min(r,e.length):0,i=new Array(a),o=new Array(r);for(n=0;n<a;++n)i[n]=OC(e[n],t[n]);for(;n<r;++n)o[n]=t[n];return function(e){for(n=0;n<a;++n)o[n]=i[n](e);return o}}function NC(e,t){var n=new Date;return e=+e,t=+t,function(r){return n.setTime(e*(1-r)+t*r),n}}function TC(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function IC(e,t){var n,r={},a={};for(n in null!==e&&"object"===typeof e||(e={}),null!==t&&"object"===typeof t||(t={}),t)n in e?r[n]=OC(e[n],t[n]):a[n]=t[n];return function(e){for(n in r)a[n]=r[n](e);return a}}var DC=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,FC=new RegExp(DC.source,"g");function MC(e,t){var n,r,a,i=DC.lastIndex=FC.lastIndex=0,o=-1,u=[],s=[];for(e+="",t+="";(n=DC.exec(e))&&(r=FC.exec(t));)(a=r.index)>i&&(a=t.slice(i,a),u[o]?u[o]+=a:u[++o]=a),(n=n[0])===(r=r[0])?u[o]?u[o]+=r:u[++o]=r:(u[++o]=null,s.push({i:o,x:TC(n,r)})),i=FC.lastIndex;return i<t.length&&(a=t.slice(i),u[o]?u[o]+=a:u[++o]=a),u.length<2?s[0]?function(e){return function(t){return e(t)+""}}(s[0].x):function(e){return function(){return e}}(t):(t=s.length,function(e){for(var n,r=0;r<t;++r)u[(n=s[r]).i]=n.x(e);return u.join("")})}function OC(e,t){var n,r=typeof t;return null==t||"boolean"===r?vC(t):("number"===r?TC:"string"===r?(n=QS(t))?(t=n,xC):MC:t instanceof QS?xC:t instanceof Date?NC:CC(t)?SC:Array.isArray(t)?EC:"function"!==typeof t.valueOf&&"function"!==typeof t.toString||isNaN(t)?IC:TC)(e,t)}function RC(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}}function jC(e){return+e}var BC=[0,1];function zC(e){return e}function ZC(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:function(e){return function(){return e}}(isNaN(t)?NaN:.5)}function LC(e,t,n){var r=e[0],a=e[1],i=t[0],o=t[1];return a<r?(r=ZC(a,r),i=n(o,i)):(r=ZC(r,a),i=n(i,o)),function(e){return i(r(e))}}function PC(e,t,n){var r=Math.min(e.length,t.length)-1,a=new Array(r),i=new Array(r),o=-1;for(e[r]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++o<r;)a[o]=ZC(e[o],e[o+1]),i[o]=n(t[o],t[o+1]);return function(t){var n=kS(e,t,1,r)-1;return i[n](a[n](t))}}function UC(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function WC(){var e,t,n,r,a,i,o=BC,u=BC,s=OC,c=zC;function l(){var e=Math.min(o.length,u.length);return c!==zC&&(c=function(e,t){var n;return e>t&&(n=e,e=t,t=n),function(n){return Math.max(e,Math.min(t,n))}}(o[0],o[e-1])),r=e>2?PC:LC,a=i=null,f}function f(t){return null==t||isNaN(t=+t)?n:(a||(a=r(o.map(e),u,s)))(e(c(t)))}return f.invert=function(n){return c(t((i||(i=r(u,o.map(e),TC)))(n)))},f.domain=function(e){return arguments.length?(o=Array.from(e,jC),l()):o.slice()},f.range=function(e){return arguments.length?(u=Array.from(e),l()):u.slice()},f.rangeRound=function(e){return u=Array.from(e),s=RC,l()},f.clamp=function(e){return arguments.length?(c=!!e||zC,l()):c!==zC},f.interpolate=function(e){return arguments.length?(s=e,l()):s},f.unknown=function(e){return arguments.length?(n=e,f):n},function(n,r){return e=n,t=r,l()}}function VC(){return WC()(zC,zC)}function qC(e){var t=e.domain;return e.ticks=function(e){var n=t();return IS(n[0],n[n.length-1],null==e?10:e)},e.tickFormat=function(e,n){var r=t();return MS(r[0],r[r.length-1],null==e?10:e,n)},e.nice=function(n){null==n&&(n=10);var r,a,i=t(),o=0,u=i.length-1,s=i[o],c=i[u],l=10;for(c<s&&(a=s,s=c,c=a,a=o,o=u,u=a);l-- >0;){if((a=DS(s,c,n))===r)return i[o]=s,i[u]=c,t(i);if(a>0)s=Math.floor(s/a)*a,c=Math.ceil(c/a)*a;else{if(!(a<0))break;s=Math.ceil(s*a)/a,c=Math.floor(c*a)/a}r=a}return e},e}function GC(e,t){var n,r=0,a=(e=e.slice()).length-1,i=e[r],o=e[a];return o<i&&(n=r,r=a,a=n,n=i,i=o,o=n),e[r]=t.floor(i),e[a]=t.ceil(o),e}function HC(e){return Math.log(e)}function XC(e){return Math.exp(e)}function KC(e){return-Math.log(-e)}function YC(e){return-Math.exp(-e)}function $C(e){return isFinite(e)?+("1e"+e):e<0?0:e}function QC(e){return function(t){return-e(-t)}}function JC(e){var t,n,r=e(HC,XC),a=r.domain,i=10;function o(){return t=function(e){return e===Math.E?Math.log:10===e&&Math.log10||2===e&&Math.log2||(e=Math.log(e),function(t){return Math.log(t)/e})}(i),n=function(e){return 10===e?$C:e===Math.E?Math.exp:function(t){return Math.pow(e,t)}}(i),a()[0]<0?(t=QC(t),n=QC(n),e(KC,YC)):e(HC,XC),r}return r.base=function(e){return arguments.length?(i=+e,o()):i},r.domain=function(e){return arguments.length?(a(e),o()):a()},r.ticks=function(e){var r,o=a(),u=o[0],s=o[o.length-1];(r=s<u)&&(d=u,u=s,s=d);var c,l,f,d=t(u),h=t(s),p=null==e?10:+e,v=[];if(!(i%1)&&h-d<p){if(d=Math.floor(d),h=Math.ceil(h),u>0){for(;d<=h;++d)for(l=1,c=n(d);l<i;++l)if(!((f=c*l)<u)){if(f>s)break;v.push(f)}}else for(;d<=h;++d)for(l=i-1,c=n(d);l>=1;--l)if(!((f=c*l)<u)){if(f>s)break;v.push(f)}2*v.length<p&&(v=IS(u,s,p))}else v=IS(d,h,Math.min(h-d,p)).map(n);return r?v.reverse():v},r.tickFormat=function(e,a){if(null==a&&(a=10===i?".0e":","),"function"!==typeof a&&(a=(0,_m.format)(a)),e===1/0)return a;null==e&&(e=10);var o=Math.max(1,i*e/r.ticks().length);return function(e){var r=e/n(Math.round(t(e)));return r*i<i-.5&&(r*=i),r<=o?a(e):""}},r.nice=function(){return a(GC(a(),{floor:function(e){return n(Math.floor(t(e)))},ceil:function(e){return n(Math.ceil(t(e)))}}))},r}function eA(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function tA(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function nA(e){return e<0?-e*e:e*e}function rA(e){var t=e(zC,zC),n=1;function r(){return 1===n?e(zC,zC):.5===n?e(tA,nA):e(eA(n),eA(1/n))}return t.exponent=function(e){return arguments.length?(n=+e,r()):n},qC(t)}function aA(){var e=rA(WC());return e.copy=function(){return UC(e,aA()).exponent(e.exponent())},_S.apply(e,arguments),e}function iA(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function oA(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function uA(e){var t=1,n=e(iA(t),oA(t));return n.constant=function(n){return arguments.length?e(iA(t=+n),oA(t)):t},qC(n)}var sA=1e3,cA=6e4,lA=36e5,fA=864e5,dA=6048e5,hA=2592e6,pA=31536e6,vA=new Date,mA=new Date;function gA(e,t,n,r){function a(t){return e(t=0===arguments.length?new Date:new Date(+t)),t}return a.floor=function(t){return e(t=new Date(+t)),t},a.ceil=function(n){return e(n=new Date(n-1)),t(n,1),e(n),n},a.round=function(e){var t=a(e),n=a.ceil(e);return e-t<n-e?t:n},a.offset=function(e,n){return t(e=new Date(+e),null==n?1:Math.floor(n)),e},a.range=function(n,r,i){var o,u=[];if(n=a.ceil(n),i=null==i?1:Math.floor(i),!(n<r)||!(i>0))return u;do{u.push(o=new Date(+n)),t(n,i),e(n)}while(o<n&&n<r);return u},a.filter=function(n){return gA((function(t){if(t>=t)for(;e(t),!n(t);)t.setTime(t-1)}),(function(e,r){if(e>=e)if(r<0)for(;++r<=0;)for(;t(e,-1),!n(e););else for(;--r>=0;)for(;t(e,1),!n(e););}))},n&&(a.count=function(t,r){return vA.setTime(+t),mA.setTime(+r),e(vA),e(mA),Math.floor(n(vA,mA))},a.every=function(e){return e=Math.floor(e),isFinite(e)&&e>0?e>1?a.filter(r?function(t){return r(t)%e===0}:function(t){return a.count(0,t)%e===0}):a:null}),a}var yA=gA((function(){}),(function(e,t){e.setTime(+e+t)}),(function(e,t){return t-e}));yA.every=function(e){return e=Math.floor(e),isFinite(e)&&e>0?e>1?gA((function(t){t.setTime(Math.floor(t/e)*e)}),(function(t,n){t.setTime(+t+n*e)}),(function(t,n){return(n-t)/e})):yA:null};var bA=yA,xA=(yA.range,gA((function(e){e.setTime(e-e.getMilliseconds())}),(function(e,t){e.setTime(+e+t*sA)}),(function(e,t){return(t-e)/sA}),(function(e){return e.getUTCSeconds()}))),wA=xA,kA=(xA.range,gA((function(e){e.setTime(e-e.getMilliseconds()-e.getSeconds()*sA)}),(function(e,t){e.setTime(+e+t*cA)}),(function(e,t){return(t-e)/cA}),(function(e){return e.getMinutes()}))),_A=kA,SA=(kA.range,gA((function(e){e.setTime(e-e.getMilliseconds()-e.getSeconds()*sA-e.getMinutes()*cA)}),(function(e,t){e.setTime(+e+t*lA)}),(function(e,t){return(t-e)/lA}),(function(e){return e.getHours()}))),CA=SA,AA=(SA.range,gA((function(e){return e.setHours(0,0,0,0)}),(function(e,t){return e.setDate(e.getDate()+t)}),(function(e,t){return(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*cA)/fA}),(function(e){return e.getDate()-1}))),EA=AA;AA.range;function NA(e){return gA((function(t){t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)}),(function(e,t){e.setDate(e.getDate()+7*t)}),(function(e,t){return(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*cA)/dA}))}var TA=NA(0),IA=NA(1),DA=NA(2),FA=NA(3),MA=NA(4),OA=NA(5),RA=NA(6),jA=(TA.range,IA.range,DA.range,FA.range,MA.range,OA.range,RA.range,gA((function(e){e.setDate(1),e.setHours(0,0,0,0)}),(function(e,t){e.setMonth(e.getMonth()+t)}),(function(e,t){return t.getMonth()-e.getMonth()+12*(t.getFullYear()-e.getFullYear())}),(function(e){return e.getMonth()}))),BA=jA,zA=(jA.range,gA((function(e){e.setMonth(0,1),e.setHours(0,0,0,0)}),(function(e,t){e.setFullYear(e.getFullYear()+t)}),(function(e,t){return t.getFullYear()-e.getFullYear()}),(function(e){return e.getFullYear()})));zA.every=function(e){return isFinite(e=Math.floor(e))&&e>0?gA((function(t){t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)}),(function(t,n){t.setFullYear(t.getFullYear()+n*e)})):null};var ZA=zA,LA=(zA.range,gA((function(e){e.setUTCSeconds(0,0)}),(function(e,t){e.setTime(+e+t*cA)}),(function(e,t){return(t-e)/cA}),(function(e){return e.getUTCMinutes()}))),PA=LA,UA=(LA.range,gA((function(e){e.setUTCMinutes(0,0,0)}),(function(e,t){e.setTime(+e+t*lA)}),(function(e,t){return(t-e)/lA}),(function(e){return e.getUTCHours()}))),WA=UA,VA=(UA.range,gA((function(e){e.setUTCHours(0,0,0,0)}),(function(e,t){e.setUTCDate(e.getUTCDate()+t)}),(function(e,t){return(t-e)/fA}),(function(e){return e.getUTCDate()-1}))),qA=VA;VA.range;function GA(e){return gA((function(t){t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)}),(function(e,t){e.setUTCDate(e.getUTCDate()+7*t)}),(function(e,t){return(t-e)/dA}))}var HA=GA(0),XA=GA(1),KA=GA(2),YA=GA(3),$A=GA(4),QA=GA(5),JA=GA(6),eE=(HA.range,XA.range,KA.range,YA.range,$A.range,QA.range,JA.range,gA((function(e){e.setUTCDate(1),e.setUTCHours(0,0,0,0)}),(function(e,t){e.setUTCMonth(e.getUTCMonth()+t)}),(function(e,t){return t.getUTCMonth()-e.getUTCMonth()+12*(t.getUTCFullYear()-e.getUTCFullYear())}),(function(e){return e.getUTCMonth()}))),tE=eE,nE=(eE.range,gA((function(e){e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)}),(function(e,t){e.setUTCFullYear(e.getUTCFullYear()+t)}),(function(e,t){return t.getUTCFullYear()-e.getUTCFullYear()}),(function(e){return e.getUTCFullYear()})));nE.every=function(e){return isFinite(e=Math.floor(e))&&e>0?gA((function(t){t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)}),(function(t,n){t.setUTCFullYear(t.getUTCFullYear()+n*e)})):null};var rE=nE;nE.range;function aE(e,t,n,r,a,i){var o=[[wA,1,sA],[wA,5,5e3],[wA,15,15e3],[wA,30,3e4],[i,1,cA],[i,5,3e5],[i,15,9e5],[i,30,18e5],[a,1,lA],[a,3,108e5],[a,6,216e5],[a,12,432e5],[r,1,fA],[r,2,1728e5],[n,1,dA],[t,1,hA],[t,3,7776e6],[e,1,pA]];function u(t,n,r){var a=Math.abs(n-t)/r,i=yS((function(e){return(0,Cn.Z)(e,3)[2]})).right(o,a);if(i===o.length)return e.every(FS(t/pA,n/pA,r));if(0===i)return bA.every(Math.max(FS(t,n,r),1));var u=(0,Cn.Z)(o[a/o[i-1][2]<o[i][2]/a?i-1:i],2),s=u[0],c=u[1];return s.every(c)}return[function(e,t,n){var r=t<e;if(r){var a=[t,e];e=a[0],t=a[1]}var i=n&&"function"===typeof n.range?n:u(e,t,n),o=i?i.range(e,+t+1):[];return r?o.reverse():o},u]}var iE=aE(rE,tE,HA,qA,WA,PA),oE=(0,Cn.Z)(iE,2),uE=oE[0],sE=oE[1],cE=aE(ZA,BA,TA,EA,CA,_A),lE=(0,Cn.Z)(cE,2),fE=lE[0],dE=lE[1];function hE(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function pE(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function vE(e,t,n){return{y:e,m:t,d:n,H:0,M:0,S:0,L:0}}var mE,gE,yE,bE={"-":"",_:" ",0:"0"},xE=/^\s*\d+/,wE=/^%/,kE=/[\\^$*+?|[\]().{}]/g;function _E(e,t,n){var r=e<0?"-":"",a=(r?-e:e)+"",i=a.length;return r+(i<n?new Array(n-i+1).join(t)+a:a)}function SE(e){return e.replace(kE,"\\$&")}function CE(e){return new RegExp("^(?:"+e.map(SE).join("|")+")","i")}function AE(e){return new Map(e.map((function(e,t){return[e.toLowerCase(),t]})))}function EE(e,t,n){var r=xE.exec(t.slice(n,n+1));return r?(e.w=+r[0],n+r[0].length):-1}function NE(e,t,n){var r=xE.exec(t.slice(n,n+1));return r?(e.u=+r[0],n+r[0].length):-1}function TE(e,t,n){var r=xE.exec(t.slice(n,n+2));return r?(e.U=+r[0],n+r[0].length):-1}function IE(e,t,n){var r=xE.exec(t.slice(n,n+2));return r?(e.V=+r[0],n+r[0].length):-1}function DE(e,t,n){var r=xE.exec(t.slice(n,n+2));return r?(e.W=+r[0],n+r[0].length):-1}function FE(e,t,n){var r=xE.exec(t.slice(n,n+4));return r?(e.y=+r[0],n+r[0].length):-1}function ME(e,t,n){var r=xE.exec(t.slice(n,n+2));return r?(e.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function OE(e,t,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(n,n+6));return r?(e.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function RE(e,t,n){var r=xE.exec(t.slice(n,n+1));return r?(e.q=3*r[0]-3,n+r[0].length):-1}function jE(e,t,n){var r=xE.exec(t.slice(n,n+2));return r?(e.m=r[0]-1,n+r[0].length):-1}function BE(e,t,n){var r=xE.exec(t.slice(n,n+2));return r?(e.d=+r[0],n+r[0].length):-1}function zE(e,t,n){var r=xE.exec(t.slice(n,n+3));return r?(e.m=0,e.d=+r[0],n+r[0].length):-1}function ZE(e,t,n){var r=xE.exec(t.slice(n,n+2));return r?(e.H=+r[0],n+r[0].length):-1}function LE(e,t,n){var r=xE.exec(t.slice(n,n+2));return r?(e.M=+r[0],n+r[0].length):-1}function PE(e,t,n){var r=xE.exec(t.slice(n,n+2));return r?(e.S=+r[0],n+r[0].length):-1}function UE(e,t,n){var r=xE.exec(t.slice(n,n+3));return r?(e.L=+r[0],n+r[0].length):-1}function WE(e,t,n){var r=xE.exec(t.slice(n,n+6));return r?(e.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function VE(e,t,n){var r=wE.exec(t.slice(n,n+1));return r?n+r[0].length:-1}function qE(e,t,n){var r=xE.exec(t.slice(n));return r?(e.Q=+r[0],n+r[0].length):-1}function GE(e,t,n){var r=xE.exec(t.slice(n));return r?(e.s=+r[0],n+r[0].length):-1}function HE(e,t){return _E(e.getDate(),t,2)}function XE(e,t){return _E(e.getHours(),t,2)}function KE(e,t){return _E(e.getHours()%12||12,t,2)}function YE(e,t){return _E(1+EA.count(ZA(e),e),t,3)}function $E(e,t){return _E(e.getMilliseconds(),t,3)}function QE(e,t){return $E(e,t)+"000"}function JE(e,t){return _E(e.getMonth()+1,t,2)}function eN(e,t){return _E(e.getMinutes(),t,2)}function tN(e,t){return _E(e.getSeconds(),t,2)}function nN(e){var t=e.getDay();return 0===t?7:t}function rN(e,t){return _E(TA.count(ZA(e)-1,e),t,2)}function aN(e){var t=e.getDay();return t>=4||0===t?MA(e):MA.ceil(e)}function iN(e,t){return e=aN(e),_E(MA.count(ZA(e),e)+(4===ZA(e).getDay()),t,2)}function oN(e){return e.getDay()}function uN(e,t){return _E(IA.count(ZA(e)-1,e),t,2)}function sN(e,t){return _E(e.getFullYear()%100,t,2)}function cN(e,t){return _E((e=aN(e)).getFullYear()%100,t,2)}function lN(e,t){return _E(e.getFullYear()%1e4,t,4)}function fN(e,t){var n=e.getDay();return _E((e=n>=4||0===n?MA(e):MA.ceil(e)).getFullYear()%1e4,t,4)}function dN(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+_E(t/60|0,"0",2)+_E(t%60,"0",2)}function hN(e,t){return _E(e.getUTCDate(),t,2)}function pN(e,t){return _E(e.getUTCHours(),t,2)}function vN(e,t){return _E(e.getUTCHours()%12||12,t,2)}function mN(e,t){return _E(1+qA.count(rE(e),e),t,3)}function gN(e,t){return _E(e.getUTCMilliseconds(),t,3)}function yN(e,t){return gN(e,t)+"000"}function bN(e,t){return _E(e.getUTCMonth()+1,t,2)}function xN(e,t){return _E(e.getUTCMinutes(),t,2)}function wN(e,t){return _E(e.getUTCSeconds(),t,2)}function kN(e){var t=e.getUTCDay();return 0===t?7:t}function _N(e,t){return _E(HA.count(rE(e)-1,e),t,2)}function SN(e){var t=e.getUTCDay();return t>=4||0===t?$A(e):$A.ceil(e)}function CN(e,t){return e=SN(e),_E($A.count(rE(e),e)+(4===rE(e).getUTCDay()),t,2)}function AN(e){return e.getUTCDay()}function EN(e,t){return _E(XA.count(rE(e)-1,e),t,2)}function NN(e,t){return _E(e.getUTCFullYear()%100,t,2)}function TN(e,t){return _E((e=SN(e)).getUTCFullYear()%100,t,2)}function IN(e,t){return _E(e.getUTCFullYear()%1e4,t,4)}function DN(e,t){var n=e.getUTCDay();return _E((e=n>=4||0===n?$A(e):$A.ceil(e)).getUTCFullYear()%1e4,t,4)}function FN(){return"+0000"}function MN(){return"%"}function ON(e){return+e}function RN(e){return Math.floor(+e/1e3)}function jN(e){return new Date(e)}function BN(e){return e instanceof Date?+e:+new Date(+e)}function zN(e,t,n,r,a,i,o,u,s,c){var l=VC(),f=l.invert,d=l.domain,h=c(".%L"),p=c(":%S"),v=c("%I:%M"),m=c("%I %p"),g=c("%a %d"),y=c("%b %d"),b=c("%B"),x=c("%Y");function w(e){return(s(e)<e?h:u(e)<e?p:o(e)<e?v:i(e)<e?m:r(e)<e?a(e)<e?g:y:n(e)<e?b:x)(e)}return l.invert=function(e){return new Date(f(e))},l.domain=function(e){return arguments.length?d(Array.from(e,BN)):d().map(jN)},l.ticks=function(t){var n=d();return e(n[0],n[n.length-1],null==t?10:t)},l.tickFormat=function(e,t){return null==t?w:c(t)},l.nice=function(e){var n=d();return e&&"function"===typeof e.range||(e=t(n[0],n[n.length-1],null==e?10:e)),e?d(GC(n,e)):l},l.copy=function(){return UC(l,zN(e,t,n,r,a,i,o,u,s,c))},l}function ZN(){var e,t,n,r,a,i=0,o=1,u=zC,s=!1;function c(t){return null==t||isNaN(t=+t)?a:u(0===n?.5:(t=(r(t)-e)*n,s?Math.max(0,Math.min(1,t)):t))}function l(e){return function(t){var n,r,a,i;return arguments.length?(n=t,a=(r=(0,Cn.Z)(n,2))[0],i=r[1],u=e(a,i),c):[u(0),u(1)]}}return c.domain=function(a){var u,s;return arguments.length?(u=a,s=(0,Cn.Z)(u,2),i=s[0],o=s[1],e=r(i=+i),t=r(o=+o),n=e===t?0:1/(t-e),c):[i,o]},c.clamp=function(e){return arguments.length?(s=!!e,c):s},c.interpolator=function(e){return arguments.length?(u=e,c):u},c.range=l(OC),c.rangeRound=l(RC),c.unknown=function(e){return arguments.length?(a=e,c):a},function(a){return r=a,e=a(i),t=a(o),n=e===t?0:1/(t-e),c}}function LN(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function PN(){var e=qC(ZN()(zC));return e.copy=function(){return LN(e,PN())},SS.apply(e,arguments)}function UN(){var e=rA(ZN());return e.copy=function(){return LN(e,UN()).exponent(e.exponent())},SS.apply(e,arguments)}function WN(e,t){void 0===t&&(t=e,e=OC);for(var n=0,r=t.length-1,a=t[0],i=new Array(r<0?0:r);n<r;)i[n]=e(a,a=t[++n]);return function(e){var t=Math.max(0,Math.min(r-1,Math.floor(e*=r)));return i[t](e-t)}}function VN(){var e,t,n,r,a,i,o,u=0,s=.5,c=1,l=1,f=zC,d=!1;function h(e){return isNaN(e=+e)?o:(e=.5+((e=+i(e))-t)*(l*e<l*t?r:a),f(d?Math.max(0,Math.min(1,e)):e))}function p(e){return function(t){var n,r,a,i,o;return arguments.length?(n=t,a=(r=(0,Cn.Z)(n,3))[0],i=r[1],o=r[2],f=WN(e,[a,i,o]),h):[f(0),f(.5),f(1)]}}return h.domain=function(o){var f,d;return arguments.length?(f=o,d=(0,Cn.Z)(f,3),u=d[0],s=d[1],c=d[2],e=i(u=+u),t=i(s=+s),n=i(c=+c),r=e===t?0:.5/(t-e),a=t===n?0:.5/(n-t),l=t<e?-1:1,h):[u,s,c]},h.clamp=function(e){return arguments.length?(d=!!e,h):d},h.interpolator=function(e){return arguments.length?(f=e,h):f},h.range=p(OC),h.rangeRound=p(RC),h.unknown=function(e){return arguments.length?(o=e,h):o},function(o){return i=o,e=o(u),t=o(s),n=o(c),r=e===t?0:.5/(t-e),a=t===n?0:.5/(n-t),l=t<e?-1:1,h}}function qN(){var e=rA(VN());return e.copy=function(){return LN(e,qN()).exponent(e.exponent())},SS.apply(e,arguments)}function GN(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:bS;if(r=e.length){if((t=+t)<=0||r<2)return+n(e[0],0,e);if(t>=1)return+n(e[r-1],r-1,e);var r,a=(r-1)*t,i=Math.floor(a),o=+n(e[i],i,e),u=+n(e[i+1],i+1,e);return o+(u-o)*(a-i)}}function HN(e){var t=e.length;return function(n){return e[Math.max(0,Math.min(t-1,Math.floor(n*t)))]}}function XN(e,t){var n=gC(+e,+t);return function(e){var t=n(e);return t-360*Math.floor(t/360)}}!function(e){mE=function(e){var t=e.dateTime,n=e.date,r=e.time,a=e.periods,i=e.days,o=e.shortDays,u=e.months,s=e.shortMonths,c=CE(a),l=AE(a),f=CE(i),d=AE(i),h=CE(o),p=AE(o),v=CE(u),m=AE(u),g=CE(s),y=AE(s),b={a:function(e){return o[e.getDay()]},A:function(e){return i[e.getDay()]},b:function(e){return s[e.getMonth()]},B:function(e){return u[e.getMonth()]},c:null,d:HE,e:HE,f:QE,g:cN,G:fN,H:XE,I:KE,j:YE,L:$E,m:JE,M:eN,p:function(e){return a[+(e.getHours()>=12)]},q:function(e){return 1+~~(e.getMonth()/3)},Q:ON,s:RN,S:tN,u:nN,U:rN,V:iN,w:oN,W:uN,x:null,X:null,y:sN,Y:lN,Z:dN,"%":MN},x={a:function(e){return o[e.getUTCDay()]},A:function(e){return i[e.getUTCDay()]},b:function(e){return s[e.getUTCMonth()]},B:function(e){return u[e.getUTCMonth()]},c:null,d:hN,e:hN,f:yN,g:TN,G:DN,H:pN,I:vN,j:mN,L:gN,m:bN,M:xN,p:function(e){return a[+(e.getUTCHours()>=12)]},q:function(e){return 1+~~(e.getUTCMonth()/3)},Q:ON,s:RN,S:wN,u:kN,U:_N,V:CN,w:AN,W:EN,x:null,X:null,y:NN,Y:IN,Z:FN,"%":MN},w={a:function(e,t,n){var r=h.exec(t.slice(n));return r?(e.w=p.get(r[0].toLowerCase()),n+r[0].length):-1},A:function(e,t,n){var r=f.exec(t.slice(n));return r?(e.w=d.get(r[0].toLowerCase()),n+r[0].length):-1},b:function(e,t,n){var r=g.exec(t.slice(n));return r?(e.m=y.get(r[0].toLowerCase()),n+r[0].length):-1},B:function(e,t,n){var r=v.exec(t.slice(n));return r?(e.m=m.get(r[0].toLowerCase()),n+r[0].length):-1},c:function(e,n,r){return S(e,t,n,r)},d:BE,e:BE,f:WE,g:ME,G:FE,H:ZE,I:ZE,j:zE,L:UE,m:jE,M:LE,p:function(e,t,n){var r=c.exec(t.slice(n));return r?(e.p=l.get(r[0].toLowerCase()),n+r[0].length):-1},q:RE,Q:qE,s:GE,S:PE,u:NE,U:TE,V:IE,w:EE,W:DE,x:function(e,t,r){return S(e,n,t,r)},X:function(e,t,n){return S(e,r,t,n)},y:ME,Y:FE,Z:OE,"%":VE};function k(e,t){return function(n){var r,a,i,o=[],u=-1,s=0,c=e.length;for(n instanceof Date||(n=new Date(+n));++u<c;)37===e.charCodeAt(u)&&(o.push(e.slice(s,u)),null!=(a=bE[r=e.charAt(++u)])?r=e.charAt(++u):a="e"===r?" ":"0",(i=t[r])&&(r=i(n,a)),o.push(r),s=u+1);return o.push(e.slice(s,u)),o.join("")}}function _(e,t){return function(n){var r,a,i=vE(1900,void 0,1);if(S(i,e,n+="",0)!=n.length)return null;if("Q"in i)return new Date(i.Q);if("s"in i)return new Date(1e3*i.s+("L"in i?i.L:0));if(t&&!("Z"in i)&&(i.Z=0),"p"in i&&(i.H=i.H%12+12*i.p),void 0===i.m&&(i.m="q"in i?i.q:0),"V"in i){if(i.V<1||i.V>53)return null;"w"in i||(i.w=1),"Z"in i?(a=(r=pE(vE(i.y,0,1))).getUTCDay(),r=a>4||0===a?XA.ceil(r):XA(r),r=qA.offset(r,7*(i.V-1)),i.y=r.getUTCFullYear(),i.m=r.getUTCMonth(),i.d=r.getUTCDate()+(i.w+6)%7):(a=(r=hE(vE(i.y,0,1))).getDay(),r=a>4||0===a?IA.ceil(r):IA(r),r=EA.offset(r,7*(i.V-1)),i.y=r.getFullYear(),i.m=r.getMonth(),i.d=r.getDate()+(i.w+6)%7)}else("W"in i||"U"in i)&&("w"in i||(i.w="u"in i?i.u%7:"W"in i?1:0),a="Z"in i?pE(vE(i.y,0,1)).getUTCDay():hE(vE(i.y,0,1)).getDay(),i.m=0,i.d="W"in i?(i.w+6)%7+7*i.W-(a+5)%7:i.w+7*i.U-(a+6)%7);return"Z"in i?(i.H+=i.Z/100|0,i.M+=i.Z%100,pE(i)):hE(i)}}function S(e,t,n,r){for(var a,i,o=0,u=t.length,s=n.length;o<u;){if(r>=s)return-1;if(37===(a=t.charCodeAt(o++))){if(a=t.charAt(o++),!(i=w[a in bE?t.charAt(o++):a])||(r=i(e,n,r))<0)return-1}else if(a!=n.charCodeAt(r++))return-1}return r}return b.x=k(n,b),b.X=k(r,b),b.c=k(t,b),x.x=k(n,x),x.X=k(r,x),x.c=k(t,x),{format:function(e){var t=k(e+="",b);return t.toString=function(){return e},t},parse:function(e){var t=_(e+="",!1);return t.toString=function(){return e},t},utcFormat:function(e){var t=k(e+="",x);return t.toString=function(){return e},t},utcParse:function(e){var t=_(e+="",!0);return t.toString=function(){return e},t}}}(e),gE=mE.format,mE.parse,yE=mE.utcFormat,mE.utcParse}({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});var KN,YN=180/Math.PI,$N={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function QN(e,t,n,r,a,i){var o,u,s;return(o=Math.sqrt(e*e+t*t))&&(e/=o,t/=o),(s=e*n+t*r)&&(n-=e*s,r-=t*s),(u=Math.sqrt(n*n+r*r))&&(n/=u,r/=u,s/=u),e*r<t*n&&(e=-e,t=-t,s=-s,o=-o),{translateX:a,translateY:i,rotate:Math.atan2(t,e)*YN,skewX:Math.atan(s)*YN,scaleX:o,scaleY:u}}function JN(e,t,n,r){function a(e){return e.length?e.pop()+" ":""}return function(i,o){var u=[],s=[];return i=e(i),o=e(o),function(e,r,a,i,o,u){if(e!==a||r!==i){var s=o.push("translate(",null,t,null,n);u.push({i:s-4,x:TC(e,a)},{i:s-2,x:TC(r,i)})}else(a||i)&&o.push("translate("+a+t+i+n)}(i.translateX,i.translateY,o.translateX,o.translateY,u,s),function(e,t,n,i){e!==t?(e-t>180?t+=360:t-e>180&&(e+=360),i.push({i:n.push(a(n)+"rotate(",null,r)-2,x:TC(e,t)})):t&&n.push(a(n)+"rotate("+t+r)}(i.rotate,o.rotate,u,s),function(e,t,n,i){e!==t?i.push({i:n.push(a(n)+"skewX(",null,r)-2,x:TC(e,t)}):t&&n.push(a(n)+"skewX("+t+r)}(i.skewX,o.skewX,u,s),function(e,t,n,r,i,o){if(e!==n||t!==r){var u=i.push(a(i)+"scale(",null,",",null,")");o.push({i:u-4,x:TC(e,n)},{i:u-2,x:TC(t,r)})}else 1===n&&1===r||i.push(a(i)+"scale("+n+","+r+")")}(i.scaleX,i.scaleY,o.scaleX,o.scaleY,u,s),i=o=null,function(e){for(var t,n=-1,r=s.length;++n<r;)u[(t=s[n]).i]=t.x(e);return u.join("")}}}var eT=JN((function(e){var t=new("function"===typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?$N:QN(t.a,t.b,t.c,t.d,t.e,t.f)}),"px, ","px)","deg)"),tT=JN((function(e){return null==e?$N:(KN||(KN=document.createElementNS("http://www.w3.org/2000/svg","g")),KN.setAttribute("transform",e),(e=KN.transform.baseVal.consolidate())?QN((e=e.matrix).a,e.b,e.c,e.d,e.e,e.f):$N)}),", ",")",")");function nT(e){return((e=Math.exp(e))+1/e)/2}var rT=function e(t,n,r){function a(e,a){var i,o,u=e[0],s=e[1],c=e[2],l=a[0],f=a[1],d=a[2],h=l-u,p=f-s,v=h*h+p*p;if(v<1e-12)o=Math.log(d/c)/t,i=function(e){return[u+e*h,s+e*p,c*Math.exp(t*e*o)]};else{var m=Math.sqrt(v),g=(d*d-c*c+r*v)/(2*c*n*m),y=(d*d-c*c-r*v)/(2*d*n*m),b=Math.log(Math.sqrt(g*g+1)-g),x=Math.log(Math.sqrt(y*y+1)-y);o=(x-b)/t,i=function(e){var r=e*o,a=nT(b),i=c/(n*m)*(a*function(e){return((e=Math.exp(2*e))-1)/(e+1)}(t*r+b)-function(e){return((e=Math.exp(e))-1/e)/2}(b));return[u+i*h,s+i*p,c*a/nT(t*r+b)]}}return i.duration=1e3*o*t/Math.SQRT2,i}return a.rho=function(t){var n=Math.max(.001,+t),r=n*n;return e(n,r,r*r)},a}(Math.SQRT2,2,4);function aT(e){return function(t,n){var r=e((t=cC(t)).h,(n=cC(n)).h),a=bC(t.s,n.s),i=bC(t.l,n.l),o=bC(t.opacity,n.opacity);return function(e){return t.h=r(e),t.s=a(e),t.l=i(e),t.opacity=o(e),t+""}}}var iT=aT(gC),oT=aT(bC),uT=Math.PI/180,sT=180/Math.PI,cT=.96422,lT=.82521,fT=4/29,dT=6/29,hT=3*dT*dT;function pT(e){if(e instanceof mT)return new mT(e.l,e.a,e.b,e.opacity);if(e instanceof _T)return ST(e);e instanceof rC||(e=tC(e));var t,n,r=xT(e.r),a=xT(e.g),i=xT(e.b),o=gT((.2225045*r+.7168786*a+.0606169*i)/1);return r===a&&a===i?t=n=o:(t=gT((.4360747*r+.3850649*a+.1430804*i)/cT),n=gT((.0139322*r+.0971045*a+.7141733*i)/lT)),new mT(116*o-16,500*(t-o),200*(o-n),e.opacity)}function vT(e,t,n,r){return 1===arguments.length?pT(e):new mT(e,t,n,null==r?1:r)}function mT(e,t,n,r){this.l=+e,this.a=+t,this.b=+n,this.opacity=+r}function gT(e){return e>.008856451679035631?Math.pow(e,1/3):e/hT+fT}function yT(e){return e>dT?e*e*e:hT*(e-fT)}function bT(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function xT(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function wT(e){if(e instanceof _T)return new _T(e.h,e.c,e.l,e.opacity);if(e instanceof mT||(e=pT(e)),0===e.a&&0===e.b)return new _T(NaN,0<e.l&&e.l<100?0:NaN,e.l,e.opacity);var t=Math.atan2(e.b,e.a)*sT;return new _T(t<0?t+360:t,Math.sqrt(e.a*e.a+e.b*e.b),e.l,e.opacity)}function kT(e,t,n,r){return 1===arguments.length?wT(e):new _T(e,t,n,null==r?1:r)}function _T(e,t,n,r){this.h=+e,this.c=+t,this.l=+n,this.opacity=+r}function ST(e){if(isNaN(e.h))return new mT(e.l,0,0,e.opacity);var t=e.h*uT;return new mT(e.l,Math.cos(t)*e.c,Math.sin(t)*e.c,e.opacity)}function CT(e,t){var n=bC((e=vT(e)).l,(t=vT(t)).l),r=bC(e.a,t.a),a=bC(e.b,t.b),i=bC(e.opacity,t.opacity);return function(t){return e.l=n(t),e.a=r(t),e.b=a(t),e.opacity=i(t),e+""}}function AT(e){return function(t,n){var r=e((t=kT(t)).h,(n=kT(n)).h),a=bC(t.c,n.c),i=bC(t.l,n.l),o=bC(t.opacity,n.opacity);return function(e){return t.h=r(e),t.c=a(e),t.l=i(e),t.opacity=o(e),t+""}}}OS(mT,vT,RS(jS,{brighter:function(e){return new mT(this.l+18*(null==e?1:e),this.a,this.b,this.opacity)},darker:function(e){return new mT(this.l-18*(null==e?1:e),this.a,this.b,this.opacity)},rgb:function(){var e=(this.l+16)/116,t=isNaN(this.a)?e:e+this.a/500,n=isNaN(this.b)?e:e-this.b/200;return new rC(bT(3.1338561*(t=cT*yT(t))-1.6168667*(e=1*yT(e))-.4906146*(n=lT*yT(n))),bT(-.9787684*t+1.9161415*e+.033454*n),bT(.0719453*t-.2289914*e+1.4052427*n),this.opacity)}})),OS(_T,kT,RS(jS,{brighter:function(e){return new _T(this.h,this.c,this.l+18*(null==e?1:e),this.opacity)},darker:function(e){return new _T(this.h,this.c,this.l-18*(null==e?1:e),this.opacity)},rgb:function(){return ST(this).rgb()}}));var ET=AT(gC),NT=AT(bC),TT=-.14861,IT=1.78277,DT=-.29227,FT=-.90649,MT=1.97294,OT=MT*FT,RT=MT*IT,jT=IT*DT-FT*TT;function BT(e){if(e instanceof ZT)return new ZT(e.h,e.s,e.l,e.opacity);e instanceof rC||(e=tC(e));var t=e.r/255,n=e.g/255,r=e.b/255,a=(jT*r+OT*t-RT*n)/(jT+OT-RT),i=r-a,o=(MT*(n-a)-DT*i)/FT,u=Math.sqrt(o*o+i*i)/(MT*a*(1-a)),s=u?Math.atan2(o,i)*sT-120:NaN;return new ZT(s<0?s+360:s,u,a,e.opacity)}function zT(e,t,n,r){return 1===arguments.length?BT(e):new ZT(e,t,n,null==r?1:r)}function ZT(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}function LT(e){return function t(n){function r(t,r){var a=e((t=zT(t)).h,(r=zT(r)).h),i=bC(t.s,r.s),o=bC(t.l,r.l),u=bC(t.opacity,r.opacity);return function(e){return t.h=a(e),t.s=i(e),t.l=o(Math.pow(e,n)),t.opacity=u(e),t+""}}return n=+n,r.gamma=t,r}(1)}OS(ZT,zT,RS(jS,{brighter:function(e){return e=null==e?zS:Math.pow(zS,e),new ZT(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=null==e?BS:Math.pow(BS,e),new ZT(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=isNaN(this.h)?0:(this.h+120)*uT,t=+this.l,n=isNaN(this.s)?0:this.s*t*(1-t),r=Math.cos(e),a=Math.sin(e);return new rC(255*(t+n*(TT*r+IT*a)),255*(t+n*(DT*r+FT*a)),255*(t+n*(MT*r)),this.opacity)}}));var PT,UT,WT=LT(gC),VT=LT(bC);function qT(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e(r/(t-1));return n}function GT(e,t,n){var r=e-t+2*n;return e?r>0?r:1:0}var HT="linear",XT="log",KT="pow",YT="sqrt",$T="symlog",QT="time",JT="utc",eI="sequential",tI="diverging",nI="quantile",rI="quantize",aI="threshold",iI="ordinal",oI="point",uI="band",sI="bin-ordinal",cI="continuous",lI="discrete",fI="discretizing",dI="interpolating",hI="temporal";function pI(){var e,t,n=AS().unknown(void 0),r=n.domain,a=n.range,i=[0,1],o=!1,u=0,s=0,c=.5;function l(){var n=r().length,l=i[1]<i[0],f=i[1-l],d=GT(n,u,s),h=i[l-0];e=(f-h)/(d||1),o&&(e=Math.floor(e)),h+=(f-h-e*(n-u))*c,t=e*(1-u),o&&(h=Math.round(h),t=Math.round(t));var p=function(e,t,n){e=+e,t=+t,n=(a=arguments.length)<2?(t=e,e=0,1):a<3?1:+n;for(var r=-1,a=0|Math.max(0,Math.ceil((t-e)/n)),i=new Array(a);++r<a;)i[r]=e+r*n;return i}(n).map((function(t){return h+e*t}));return a(l?p.reverse():p)}return delete n.unknown,n.domain=function(e){return arguments.length?(r(e),l()):r()},n.range=function(e){return arguments.length?(i=[+e[0],+e[1]],l()):i.slice()},n.rangeRound=function(e){return i=[+e[0],+e[1]],o=!0,l()},n.bandwidth=function(){return t},n.step=function(){return e},n.round=function(e){return arguments.length?(o=!!e,l()):o},n.padding=function(e){return arguments.length?(s=Math.max(0,Math.min(1,e)),u=s,l()):u},n.paddingInner=function(e){return arguments.length?(u=Math.max(0,Math.min(1,e)),l()):u},n.paddingOuter=function(e){return arguments.length?(s=Math.max(0,Math.min(1,e)),l()):s},n.align=function(e){return arguments.length?(c=Math.max(0,Math.min(1,e)),l()):c},n.invertRange=function(e){if(null!=e[0]&&null!=e[1]){var n,o,u,s=i[1]<i[0],c=s?a().reverse():a(),l=c.length-1,f=+e[0],d=+e[1];if(f===f&&d===d&&(d<f&&(u=f,f=d,d=u),!(d<c[0]||f>i[1-s])))return n=Math.max(0,wS(c,f)-1),o=f===d?n:wS(c,d)-1,f-c[n]>t+1e-10&&++n,s&&(u=n,n=l-o,o=l-u),n>o?void 0:r().slice(n,o+1)}},n.invert=function(e){var t=n.invertRange([e,e]);return t?t[0]:t},n.copy=function(){return pI().domain(r()).range(i).round(o).paddingInner(u).paddingOuter(s).align(c)},l()}function vI(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,e.copy=function(){return vI(t())},e}var mI=Array.prototype.map;function gI(e){return mI.call(e,Ie)}var yI=Array.prototype.slice;var bI={};function xI(e,t,n){var r=function(){var n=t();return n.invertRange||(n.invertRange=n.invert?function(e){return function(t){var n,r=t[0],a=t[1];return a<r&&(n=r,r=a,a=n),[e.invert(r),e.invert(a)]}}(n):n.invertExtent?function(e){return function(t){var n,r,a,i,o=e.range(),u=t[0],s=t[1],c=-1;for(s<u&&(r=u,u=s,s=r),a=0,i=o.length;a<i;++a)o[a]>=u&&o[a]<=s&&(c<0&&(c=a),n=a);if(!(c<0))return u=e.invertExtent(o[c]),s=e.invertExtent(o[n]),[void 0===u[0]?u[1]:u[0],void 0===s[1]?s[0]:s[1]]}}(n):void 0),n.type=e,n};return r.metadata=Ft(Xe(n)),r}function wI(e,t,n){return arguments.length>1?(bI[e]=xI(e,t,n),this):kI(e)?bI[e]:void 0}function kI(e){return st(bI,e)}function _I(e,t){var n=bI[e];return n&&n.metadata[t]}function SI(e){return _I(e,cI)}function CI(e){return _I(e,lI)}function AI(e){return _I(e,fI)}function EI(e){return _I(e,XT)}function NI(e){return _I(e,dI)}function TI(e){return _I(e,nI)}wI("identity",(function e(t){var n;function r(e){return null==e||isNaN(e=+e)?n:e}return r.invert=r,r.domain=r.range=function(e){return arguments.length?(t=Array.from(e,jC),r):t.slice()},r.unknown=function(e){return arguments.length?(n=e,r):n},r.copy=function(){return e(t).unknown(n)},t=arguments.length?Array.from(t,jC):[0,1],qC(r)})),wI(HT,(function e(){var t=VC();return t.copy=function(){return UC(t,e())},_S.apply(t,arguments),qC(t)}),cI),wI(XT,(function e(){var t=JC(WC()).domain([1,10]);return t.copy=function(){return UC(t,e()).base(t.base())},_S.apply(t,arguments),t}),[cI,XT]),wI(KT,aA,cI),wI(YT,(function(){return aA.apply(null,arguments).exponent(.5)}),cI),wI($T,(function e(){var t=uA(WC());return t.copy=function(){return UC(t,e()).constant(t.constant())},_S.apply(t,arguments)}),cI),wI(QT,(function(){return _S.apply(zN(fE,dE,ZA,BA,TA,EA,CA,_A,wA,gE).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}),[cI,hI]),wI(JT,(function(){return _S.apply(zN(uE,sE,rE,tE,HA,qA,WA,PA,wA,yE).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}),[cI,hI]),wI(eI,PN,[cI,dI]),wI("".concat(eI,"-").concat(HT),PN,[cI,dI]),wI("".concat(eI,"-").concat(XT),(function e(){var t=JC(ZN()).domain([1,10]);return t.copy=function(){return LN(t,e()).base(t.base())},SS.apply(t,arguments)}),[cI,dI,XT]),wI("".concat(eI,"-").concat(KT),UN,[cI,dI]),wI("".concat(eI,"-").concat(YT),(function(){return UN.apply(null,arguments).exponent(.5)}),[cI,dI]),wI("".concat(eI,"-").concat($T),(function e(){var t=uA(ZN());return t.copy=function(){return LN(t,e()).constant(t.constant())},SS.apply(t,arguments)}),[cI,dI]),wI("".concat(tI,"-").concat(HT),(function e(){var t=qC(VN()(zC));return t.copy=function(){return LN(t,e())},SS.apply(t,arguments)}),[cI,dI]),wI("".concat(tI,"-").concat(XT),(function e(){var t=JC(VN()).domain([.1,1,10]);return t.copy=function(){return LN(t,e()).base(t.base())},SS.apply(t,arguments)}),[cI,dI,XT]),wI("".concat(tI,"-").concat(KT),qN,[cI,dI]),wI("".concat(tI,"-").concat(YT),(function(){return qN.apply(null,arguments).exponent(.5)}),[cI,dI]),wI("".concat(tI,"-").concat($T),(function e(){var t=uA(VN());return t.copy=function(){return LN(t,e()).constant(t.constant())},SS.apply(t,arguments)}),[cI,dI]),wI(nI,(function e(){var t,n=[],r=[],a=[];function i(){var e=0,t=Math.max(1,r.length);for(a=new Array(t-1);++e<t;)a[e-1]=GN(n,e/t);return o}function o(e){return null==e||isNaN(e=+e)?t:r[kS(a,e)]}return o.invertExtent=function(e){var t=r.indexOf(e);return t<0?[NaN,NaN]:[t>0?a[t-1]:n[0],t<a.length?a[t]:n[n.length-1]]},o.domain=function(e){if(!arguments.length)return n.slice();n=[];var t,r=(0,Rt.Z)(e);try{for(r.s();!(t=r.n()).done;){var a=t.value;null==a||isNaN(a=+a)||n.push(a)}}catch(o){r.e(o)}finally{r.f()}return n.sort(gS),i()},o.range=function(e){return arguments.length?(r=Array.from(e),i()):r.slice()},o.unknown=function(e){return arguments.length?(t=e,o):t},o.quantiles=function(){return a.slice()},o.copy=function(){return e().domain(n).range(r).unknown(t)},_S.apply(o,arguments)}),[fI,nI]),wI(rI,(function e(){var t,n=0,r=1,a=1,i=[.5],o=[0,1];function u(e){return null!=e&&e<=e?o[kS(i,e,0,a)]:t}function s(){var e=-1;for(i=new Array(a);++e<a;)i[e]=((e+1)*r-(e-a)*n)/(a+1);return u}return u.domain=function(e){var t,a;return arguments.length?(t=e,a=(0,Cn.Z)(t,2),n=a[0],r=a[1],n=+n,r=+r,s()):[n,r]},u.range=function(e){return arguments.length?(a=(o=Array.from(e)).length-1,s()):o.slice()},u.invertExtent=function(e){var t=o.indexOf(e);return t<0?[NaN,NaN]:t<1?[n,i[0]]:t>=a?[i[a-1],r]:[i[t-1],i[t]]},u.unknown=function(e){return arguments.length?(t=e,u):u},u.thresholds=function(){return i.slice()},u.copy=function(){return e().domain([n,r]).range(o).unknown(t)},_S.apply(qC(u),arguments)}),fI),wI(aI,(function e(){var t,n=[.5],r=[0,1],a=1;function i(e){return null!=e&&e<=e?r[kS(n,e,0,a)]:t}return i.domain=function(e){return arguments.length?(n=Array.from(e),a=Math.min(n.length,r.length-1),i):n.slice()},i.range=function(e){return arguments.length?(r=Array.from(e),a=Math.min(n.length,r.length-1),i):r.slice()},i.invertExtent=function(e){var t=r.indexOf(e);return[n[t-1],n[t]]},i.unknown=function(e){return arguments.length?(t=e,i):t},i.copy=function(){return e().domain(n).range(r).unknown(t)},_S.apply(i,arguments)}),fI),wI(sI,(function e(){var t=[],n=[];function r(e){return null==e||e!==e?void 0:n[(kS(t,e)-1)%n.length]}return r.domain=function(e){return arguments.length?(t=gI(e),r):t.slice()},r.range=function(e){return arguments.length?(n=yI.call(e),r):n.slice()},r.tickFormat=function(e,n){return MS(t[0],Te(t),null==e?10:e,n)},r.copy=function(){return e().domain(r.domain()).range(r.range())},r}),[lI,fI]),wI(iI,AS,lI),wI(uI,pI,lI),wI(oI,(function(){return vI(pI().paddingInner(1))}),lI);var II=["clamp","base","constant","exponent"];function DI(e,t){var n=t[0],r=Te(t)-n;return function(t){return e(n+t*r)}}function FI(e,t,n){return WN(RI(t||"rgb",n),e)}function MI(e,t){for(var n=new Array(t),r=t+1,a=0;a<t;)n[a]=e(++a/r);return n}function OI(e,t,n){var r,a,i,o=n-t;return o&&Number.isFinite(o)?(r=(a=e.type).indexOf("-"),a=r<0?a:a.slice(r+1),i=wI(a)().domain([t,n]).range([0,1]),II.forEach((function(t){return e[t]?i[t](e[t]()):0})),i):nt(.5)}function RI(e,t){var n=u[function(e){return"interpolate"+e.toLowerCase().split("-").map((function(e){return e[0].toUpperCase()+e.slice(1)})).join("")}(e)];return null!=t&&n&&n.gamma?n.gamma(t):n}function jI(e){for(var t=e.length/6|0,n=new Array(t),r=0;r<t;)n[r]="#"+e.slice(6*r,6*++r);return n}function BI(e,t){for(var n in e)ZI(n,t(e[n]))}var zI={};function ZI(e,t){return e=e&&e.toLowerCase(),arguments.length>1?(zI[e]=t,this):zI[e]}BI({category10:"1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf",category20:"1f77b4aec7e8ff7f0effbb782ca02c98df8ad62728ff98969467bdc5b0d58c564bc49c94e377c2f7b6d27f7f7fc7c7c7bcbd22dbdb8d17becf9edae5",category20b:"393b795254a36b6ecf9c9ede6379398ca252b5cf6bcedb9c8c6d31bd9e39e7ba52e7cb94843c39ad494ad6616be7969c7b4173a55194ce6dbdde9ed6",category20c:"3182bd6baed69ecae1c6dbefe6550dfd8d3cfdae6bfdd0a231a35474c476a1d99bc7e9c0756bb19e9ac8bcbddcdadaeb636363969696bdbdbdd9d9d9",tableau10:"4c78a8f58518e4575672b7b254a24beeca3bb279a2ff9da69d755dbab0ac",tableau20:"4c78a89ecae9f58518ffbf7954a24b88d27ab79a20f2cf5b43989483bcb6e45756ff9d9879706ebab0acd67195fcbfd2b279a2d6a5c99e765fd8b5a5",accent:"7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666",dark2:"1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666",paired:"a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928",pastel1:"fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2",pastel2:"b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc",set1:"e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999",set2:"66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3",set3:"8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f"},jI),BI({blues:"cfe1f2bed8eca8cee58fc1de74b2d75ba3cf4592c63181bd206fb2125ca40a4a90",greens:"d3eecdc0e6baabdda594d3917bc77d60ba6c46ab5e329a512089430e7735036429",greys:"e2e2e2d4d4d4c4c4c4b1b1b19d9d9d8888887575756262624d4d4d3535351e1e1e",oranges:"fdd8b3fdc998fdb87bfda55efc9244f87f2cf06b18e4580bd14904b93d029f3303",purples:"e2e1efd4d4e8c4c5e0b4b3d6a3a0cc928ec3827cb97566ae684ea25c3696501f8c",reds:"fdc9b4fcb49afc9e80fc8767fa7051f6573fec3f2fdc2a25c81b1db21218970b13",blueGreen:"d5efedc1e8e0a7ddd18bd2be70c6a958ba9144ad77319c5d2089460e7736036429",bluePurple:"ccddecbad0e4a8c2dd9ab0d4919cc98d85be8b6db28a55a6873c99822287730f71",greenBlue:"d3eecec5e8c3b1e1bb9bd8bb82cec269c2ca51b2cd3c9fc7288abd1675b10b60a1",orangeRed:"fddcaffdcf9bfdc18afdad77fb9562f67d53ee6545e24932d32d1ebf130da70403",purpleBlue:"dbdaebc8cee4b1c3de97b7d87bacd15b9fc93a90c01e7fb70b70ab056199045281",purpleBlueGreen:"dbd8eac8cee4b0c3de93b7d872acd1549fc83892bb1c88a3097f8702736b016353",purpleRed:"dcc9e2d3b3d7ce9eccd186c0da6bb2e14da0e23189d91e6fc61159ab07498f023a",redPurple:"fccfccfcbec0faa9b8f98faff571a5ec539ddb3695c41b8aa908808d0179700174",yellowGreen:"e4f4acd1eca0b9e2949ed68880c97c62bb6e47aa5e3297502083440e723b036034",yellowOrangeBrown:"feeaa1fedd84fecc63feb746fca031f68921eb7215db5e0bc54c05ab3d038f3204",yellowOrangeRed:"fee087fed16ffebd59fea849fd903efc7335f9522bee3423de1b20ca0b22af0225",blueOrange:"134b852f78b35da2cb9dcae1d2e5eff2f0ebfce0bafbbf74e8932fc5690d994a07",brownBlueGreen:"704108a0651ac79548e3c78af3e6c6eef1eac9e9e48ed1c74da79e187a72025147",purpleGreen:"5b1667834792a67fb6c9aed3e6d6e8eff0efd9efd5aedda971bb75368e490e5e29",purpleOrange:"4114696647968f83b7b9b4d6dadbebf3eeeafce0bafbbf74e8932fc5690d994a07",redBlue:"8c0d25bf363adf745ef4ae91fbdbc9f2efeed2e5ef9dcae15da2cb2f78b3134b85",redGrey:"8c0d25bf363adf745ef4ae91fcdccbfaf4f1e2e2e2c0c0c0969696646464343434",yellowGreenBlue:"eff9bddbf1b4bde5b594d5b969c5be45b4c22c9ec02182b82163aa23479c1c3185",redYellowBlue:"a50026d4322cf16e43fcac64fedd90faf8c1dcf1ecabd6e875abd04a74b4313695",redYellowGreen:"a50026d4322cf16e43fcac63fedd8df9f7aed7ee8ea4d86e64bc6122964f006837",pinkYellowGreen:"8e0152c0267edd72adf0b3d6faddedf5f3efe1f2cab6de8780bb474f9125276419",spectral:"9e0142d13c4bf0704afcac63fedd8dfbf8b0e0f3a1a9dda269bda94288b55e4fa2",viridis:"440154470e61481a6c482575472f7d443a834144873d4e8a39568c35608d31688e2d708e2a788e27818e23888e21918d1f988b1fa08822a8842ab07f35b77943bf7154c56866cc5d7ad1518fd744a5db36bcdf27d2e21be9e51afde725",magma:"0000040404130b0924150e3720114b2c11603b0f704a107957157e651a80721f817f24828c29819a2e80a8327db6377ac43c75d1426fde4968e95462f1605df76f5cfa7f5efc8f65fe9f6dfeaf78febf84fece91fddea0fcedaffcfdbf",inferno:"0000040403130c0826170c3b240c4f330a5f420a68500d6c5d126e6b176e781c6d86216b932667a12b62ae305cbb3755c73e4cd24644dd513ae65c30ed6925f3771af8850ffb9506fca50afcb519fac62df6d645f2e661f3f484fcffa4",plasma:"0d088723069033059742039d5002a25d01a66a00a87801a88405a7900da49c179ea72198b12a90ba3488c33d80cb4779d35171da5a69e16462e76e5bed7953f2834cf68f44fa9a3dfca636fdb32ffec029fcce25f9dc24f5ea27f0f921",cividis:"00205100235800265d002961012b65042e670831690d346b11366c16396d1c3c6e213f6e26426e2c456e31476e374a6e3c4d6e42506e47536d4c566d51586e555b6e5a5e6e5e616e62646f66676f6a6a706e6d717270717573727976737c79747f7c75827f758682768985778c8877908b78938e789691789a94789e9778a19b78a59e77a9a177aea575b2a874b6ab73bbaf71c0b26fc5b66dc9b96acebd68d3c065d8c462ddc85fe2cb5ce7cf58ebd355f0d652f3da4ff7de4cfae249fce647",rainbow:"6e40aa883eb1a43db3bf3cafd83fa4ee4395fe4b83ff576eff6659ff7847ff8c38f3a130e2b72fcfcc36bee044aff05b8ff4576ff65b52f6673af27828ea8d1ddfa319d0b81cbecb23abd82f96e03d82e14c6edb5a5dd0664dbf6e40aa",sinebow:"ff4040fc582af47218e78d0bd5a703bfbf00a7d5038de70b72f41858fc2a40ff402afc5818f4720be78d03d5a700bfbf03a7d50b8de71872f42a58fc4040ff582afc7218f48d0be7a703d5bf00bfd503a7e70b8df41872fc2a58ff4040",turbo:"23171b32204a3e2a71453493493eae4b49c54a53d7485ee44569ee4074f53c7ff8378af93295f72e9ff42ba9ef28b3e926bce125c5d925cdcf27d5c629dcbc2de3b232e9a738ee9d3ff39347f68950f9805afc7765fd6e70fe667cfd5e88fc5795fb51a1f84badf545b9f140c5ec3cd0e637dae034e4d931ecd12ef4c92bfac029ffb626ffad24ffa223ff9821ff8d1fff821dff771cfd6c1af76118f05616e84b14df4111d5380fcb2f0dc0260ab61f07ac1805a313029b0f00950c00910b00",browns:"eedbbdecca96e9b97ae4a865dc9856d18954c7784cc0673fb85536ad44339f3632",tealBlues:"bce4d89dd3d181c3cb65b3c245a2b9368fae347da0306a932c5985",teals:"bbdfdfa2d4d58ac9c975bcbb61b0af4da5a43799982b8b8c1e7f7f127273006667",warmGreys:"dcd4d0cec5c1c0b8b4b3aaa7a59c9998908c8b827f7e7673726866665c5a59504e",goldGreen:"f4d166d5ca60b6c35c98bb597cb25760a6564b9c533f8f4f33834a257740146c36",goldOrange:"f4d166f8be5cf8aa4cf5983bf3852aef701be2621fd65322c54923b142239e3a26",goldRed:"f4d166f6be59f9aa51fc964ef6834bee734ae56249db5247cf4244c43141b71d3e",lightGreyRed:"efe9e6e1dad7d5cbc8c8bdb9bbaea9cd967ddc7b43e15f19df4011dc000b",lightGreyTeal:"e4eaead6dcddc8ced2b7c2c7a6b4bc64b0bf22a6c32295c11f85be1876bc",lightMulti:"e0f1f2c4e9d0b0de9fd0e181f6e072f6c053f3993ef77440ef4a3c",lightOrange:"f2e7daf7d5baf9c499fab184fa9c73f68967ef7860e8645bde515bd43d5b",lightTealBlue:"e3e9e0c0dccf9aceca7abfc859afc0389fb9328dad2f7ca0276b95255988",darkBlue:"3232322d46681a5c930074af008cbf05a7ce25c0dd38daed50f3faffffff",darkGold:"3c3c3c584b37725e348c7631ae8b2bcfa424ecc31ef9de30fff184ffffff",darkGreen:"3a3a3a215748006f4d048942489e4276b340a6c63dd2d836ffeb2cffffaa",darkMulti:"3737371f5287197d8c29a86995ce3fffe800ffffff",darkRed:"3434347036339e3c38cc4037e75d1eec8620eeab29f0ce32ffeb2c"},(function(e){return FI(jI(e))}));var LI="symbol",PI=function(e){return _e(e)?e.map((function(e){return String(e)})):String(e)},UI=function(e,t){return e[1]-t[1]},WI=function(e,t){return t[1]-e[1]};function VI(e,t,n){var r;return gt(t)&&(e.bins&&(t=Math.max(t,e.bins.length)),null!=n&&(t=Math.min(t,Math.floor(At(e.domain())/n||1)))),Se(t)&&(r=t.step,t=t.interval),bt(t)&&(t=e.type===QT?Ml(t):e.type==JT?Ol(t):ue("Only time and utc scales accept interval strings."),r&&(t=t.every(r))),t}function qI(e,t,n){var r=e.range(),a=r[0],i=Te(r),o=UI;if(a>i&&(r=i,i=a,a=r,o=WI),a=Math.floor(a),i=Math.ceil(i),t=t.map((function(t){return[t,e(t)]})).filter((function(e){return a<=e[1]&&e[1]<=i})).sort(o).map((function(e){return e[0]})),n>0&&t.length>1){for(var u=[t[0],Te(t)];t.length>n&&t.length>=3;)t=t.filter((function(e,t){return!(t%2)}));t.length<3&&(t=u)}return t}function GI(e,t){return e.bins?qI(e,e.bins):e.ticks?e.ticks(t):e.domain()}function HI(e,t,n,r,a,i){var o=t.type,u=PI;if(o===QT||a===QT)u=e.timeFormat(r);else if(o===JT||a===JT)u=e.utcFormat(r);else if(EI(o)){var s=e.formatFloat(r);if(i||t.bins)u=s;else{var c=XI(t,n,!1);u=function(e){return c(e)?s(e):""}}}else if(t.tickFormat){var l=t.domain();u=e.formatSpan(l[0],l[l.length-1],n,r)}else r&&(u=e.format(r));return u}function XI(e,t,n){var r=GI(e,t),a=e.base(),i=Math.log(a),o=Math.max(1,a*t/r.length),u=function(e){var t=e/Math.pow(a,Math.round(Math.log(e)/i));return t*a<a-.5&&(t*=a),t<=o};return n?r.filter(u):u}var KI=(PT={},(0,Xn.Z)(PT,nI,"quantiles"),(0,Xn.Z)(PT,rI,"thresholds"),(0,Xn.Z)(PT,aI,"domain"),PT),YI=(UT={},(0,Xn.Z)(UT,nI,"quantiles"),(0,Xn.Z)(UT,rI,"domain"),UT);function $I(e,t){return e.bins?function(e){var t=e.slice(0,-1);return t.max=Te(e),t}(e.bins):e.type===XT?XI(e,t,!0):KI[e.type]?function(e){var t=[-1/0].concat(e);return t.max=1/0,t}(e[KI[e.type]]()):GI(e,t)}function QI(e,t,n,r,a,i,o){var u=YI[t.type]&&i!==QT&&i!==JT?function(e,t,n){var r,a=t[YI[t.type]](),i=a.length,o=i>1?a[1]-a[0]:a[0];for(r=1;r<i;++r)o=Math.min(o,a[r]-a[r-1]);return e.formatSpan(0,o,30,n)}(e,t,a):HI(e,t,n,a,i,o);return r===LI&&function(e){return KI[e.type]||e.bins}(t)?JI(u):"discrete"===r?tD(u):nD(u)}var JI=function(e){return function(t,n,r){var a=eD(r[n+1],eD(r.max,1/0)),i=rD(t,e),o=rD(a,e);return i&&o?i+" \u2013 "+o:o?"< "+o:"\u2265 "+i}},eD=function(e,t){return null!=e?e:t},tD=function(e){return function(t,n){return n?e(t):null}},nD=function(e){return function(t){return e(t)}},rD=function(e,t){return Number.isFinite(e)?t(e):null};function aD(e,t,n,r){var a=r||t.type;return bt(n)&&function(e){return _I(e,hI)}(a)&&(n=n.replace(/%a/g,"%A").replace(/%b/g,"%B")),n||a!==QT?n||a!==JT?QI(e,t,5,null,n,r,!0):e.utcFormat("%A, %d %B %Y, %X UTC"):e.timeFormat("%A, %d %B %Y, %X")}function iD(e,t,n){n=n||{};var r=Math.max(3,n.maxlen||7),a=aD(e,t,n.format,n.formatType);if(AI(t.type)){var i=$I(t).slice(1).map(a),o=i.length;return"".concat(o," boundar").concat(1===o?"y":"ies",": ").concat(i.join(", "))}if(CI(t.type)){var u=t.domain(),s=u.length,c=s>r?u.slice(0,r-2).map(a).join(", ")+", ending with "+u.slice(-1).map(a):u.map(a).join(", ");return"".concat(s," value").concat(1===s?"":"s",": ").concat(c)}var l=t.domain();return"values from ".concat(a(l[0])," to ").concat(a(Te(l)))}function oD(e,t,n){e=+e,t=+t,n=(a=arguments.length)<2?(t=e,e=0,1):a<3?1:+n;for(var r=-1,a=0|Math.max(0,Math.ceil((t-e)/n)),i=new Array(a);++r<a;)i[r]=e+r*n;return i}function uD(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}}function sD(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function cD(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function lD(){}var fD=.7,dD=1/fD,hD="\\s*([+-]?\\d+)\\s*",pD="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",vD="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",mD=/^#([0-9a-f]{3,8})$/,gD=new RegExp("^rgb\\("+[hD,hD,hD]+"\\)$"),yD=new RegExp("^rgb\\("+[vD,vD,vD]+"\\)$"),bD=new RegExp("^rgba\\("+[hD,hD,hD,pD]+"\\)$"),xD=new RegExp("^rgba\\("+[vD,vD,vD,pD]+"\\)$"),wD=new RegExp("^hsl\\("+[pD,vD,vD]+"\\)$"),kD=new RegExp("^hsla\\("+[pD,vD,vD,pD]+"\\)$"),_D={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function SD(){return this.rgb().formatHex()}function CD(){return this.rgb().formatRgb()}function AD(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=mD.exec(e))?(n=t[1].length,t=parseInt(t[1],16),6===n?ED(t):3===n?new DD(t>>8&15|t>>4&240,t>>4&15|240&t,(15&t)<<4|15&t,1):8===n?ND(t>>24&255,t>>16&255,t>>8&255,(255&t)/255):4===n?ND(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|240&t,((15&t)<<4|15&t)/255):null):(t=gD.exec(e))?new DD(t[1],t[2],t[3],1):(t=yD.exec(e))?new DD(255*t[1]/100,255*t[2]/100,255*t[3]/100,1):(t=bD.exec(e))?ND(t[1],t[2],t[3],t[4]):(t=xD.exec(e))?ND(255*t[1]/100,255*t[2]/100,255*t[3]/100,t[4]):(t=wD.exec(e))?RD(t[1],t[2]/100,t[3]/100,1):(t=kD.exec(e))?RD(t[1],t[2]/100,t[3]/100,t[4]):_D.hasOwnProperty(e)?ED(_D[e]):"transparent"===e?new DD(NaN,NaN,NaN,0):null}function ED(e){return new DD(e>>16&255,e>>8&255,255&e,1)}function ND(e,t,n,r){return r<=0&&(e=t=n=NaN),new DD(e,t,n,r)}function TD(e){return e instanceof lD||(e=AD(e)),e?new DD((e=e.rgb()).r,e.g,e.b,e.opacity):new DD}function ID(e,t,n,r){return 1===arguments.length?TD(e):new DD(e,t,n,null==r?1:r)}function DD(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}function FD(){return"#"+OD(this.r)+OD(this.g)+OD(this.b)}function MD(){var e=this.opacity;return(1===(e=isNaN(e)?1:Math.max(0,Math.min(1,e)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===e?")":", "+e+")")}function OD(e){return((e=Math.max(0,Math.min(255,Math.round(e)||0)))<16?"0":"")+e.toString(16)}function RD(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new BD(e,t,n,r)}function jD(e){if(e instanceof BD)return new BD(e.h,e.s,e.l,e.opacity);if(e instanceof lD||(e=AD(e)),!e)return new BD;if(e instanceof BD)return e;var t=(e=e.rgb()).r/255,n=e.g/255,r=e.b/255,a=Math.min(t,n,r),i=Math.max(t,n,r),o=NaN,u=i-a,s=(i+a)/2;return u?(o=t===i?(n-r)/u+6*(n<r):n===i?(r-t)/u+2:(t-n)/u+4,u/=s<.5?i+a:2-i-a,o*=60):u=s>0&&s<1?0:o,new BD(o,u,s,e.opacity)}function BD(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}function zD(e,t,n){return 255*(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)}function ZD(e,t,n,r,a){var i=e*e,o=i*e;return((1-3*e+3*i-o)*t+(4-6*i+3*o)*n+(1+3*e+3*i-3*o)*r+o*a)/6}sD(lD,AD,{copy:function(e){return Object.assign(new this.constructor,this,e)},displayable:function(){return this.rgb().displayable()},hex:SD,formatHex:SD,formatHsl:function(){return jD(this).formatHsl()},formatRgb:CD,toString:CD}),sD(DD,ID,cD(lD,{brighter:function(e){return e=null==e?dD:Math.pow(dD,e),new DD(this.r*e,this.g*e,this.b*e,this.opacity)},darker:function(e){return e=null==e?fD:Math.pow(fD,e),new DD(this.r*e,this.g*e,this.b*e,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:FD,formatHex:FD,formatRgb:MD,toString:MD})),sD(BD,(function(e,t,n,r){return 1===arguments.length?jD(e):new BD(e,t,n,null==r?1:r)}),cD(lD,{brighter:function(e){return e=null==e?dD:Math.pow(dD,e),new BD(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=null==e?fD:Math.pow(fD,e),new BD(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=this.h%360+360*(this.h<0),t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,a=2*n-r;return new DD(zD(e>=240?e-240:e+120,a,r),zD(e,a,r),zD(e<120?e+240:e-120,a,r),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var e=this.opacity;return(1===(e=isNaN(e)?1:Math.max(0,Math.min(1,e)))?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(1===e?")":", "+e+")")}}));var LD=function(e){return function(){return e}};function PD(e,t){return function(n){return e+n*t}}function UD(e){return 1===(e=+e)?WD:function(t,n){return n-t?function(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}(t,n,e):LD(isNaN(t)?n:t)}}function WD(e,t){var n=t-e;return n?PD(e,n):LD(isNaN(e)?t:e)}var VD=function e(t){var n=UD(t);function r(e,t){var r=n((e=ID(e)).r,(t=ID(t)).r),a=n(e.g,t.g),i=n(e.b,t.b),o=WD(e.opacity,t.opacity);return function(t){return e.r=r(t),e.g=a(t),e.b=i(t),e.opacity=o(t),e+""}}return r.gamma=e,r}(1);function qD(e){return function(t){var n,r,a=t.length,i=new Array(a),o=new Array(a),u=new Array(a);for(n=0;n<a;++n)r=ID(t[n]),i[n]=r.r||0,o[n]=r.g||0,u[n]=r.b||0;return i=e(i),o=e(o),u=e(u),r.opacity=1,function(e){return r.r=i(e),r.g=o(e),r.b=u(e),r+""}}}qD((function(e){var t=e.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,t-1):Math.floor(n*t),a=e[r],i=e[r+1],o=r>0?e[r-1]:2*a-i,u=r<t-1?e[r+2]:2*i-a;return ZD((n-r/t)*t,o,a,i,u)}})),qD((function(e){var t=e.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*t),a=e[(r+t-1)%t],i=e[r%t],o=e[(r+1)%t],u=e[(r+2)%t];return ZD((n-r/t)*t,a,i,o,u)}}));function GD(e,t){var n,r=t?t.length:0,a=e?Math.min(r,e.length):0,i=new Array(a),o=new Array(r);for(n=0;n<a;++n)i[n]=eF(e[n],t[n]);for(;n<r;++n)o[n]=t[n];return function(e){for(n=0;n<a;++n)o[n]=i[n](e);return o}}function HD(e,t){var n=new Date;return e=+e,t=+t,function(r){return n.setTime(e*(1-r)+t*r),n}}function XD(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function KD(e,t){var n,r={},a={};for(n in null!==e&&"object"===typeof e||(e={}),null!==t&&"object"===typeof t||(t={}),t)n in e?r[n]=eF(e[n],t[n]):a[n]=t[n];return function(e){for(n in r)a[n]=r[n](e);return a}}var YD=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,$D=new RegExp(YD.source,"g");function QD(e,t){var n,r,a,i=YD.lastIndex=$D.lastIndex=0,o=-1,u=[],s=[];for(e+="",t+="";(n=YD.exec(e))&&(r=$D.exec(t));)(a=r.index)>i&&(a=t.slice(i,a),u[o]?u[o]+=a:u[++o]=a),(n=n[0])===(r=r[0])?u[o]?u[o]+=r:u[++o]=r:(u[++o]=null,s.push({i:o,x:XD(n,r)})),i=$D.lastIndex;return i<t.length&&(a=t.slice(i),u[o]?u[o]+=a:u[++o]=a),u.length<2?s[0]?function(e){return function(t){return e(t)+""}}(s[0].x):function(e){return function(){return e}}(t):(t=s.length,function(e){for(var n,r=0;r<t;++r)u[(n=s[r]).i]=n.x(e);return u.join("")})}function JD(e,t){t||(t=[]);var n,r=e?Math.min(t.length,e.length):0,a=t.slice();return function(i){for(n=0;n<r;++n)a[n]=e[n]*(1-i)+t[n]*i;return a}}function eF(e,t){var n,r=typeof t;return null==t||"boolean"===r?LD(t):("number"===r?XD:"string"===r?(n=AD(t))?(t=n,VD):QD:t instanceof AD?VD:t instanceof Date?HD:function(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}(t)?JD:Array.isArray(t)?GD:"function"!==typeof t.valueOf&&"function"!==typeof t.toString||isNaN(t)?KD:XD)(e,t)}function tF(e){wu.call(this,null,e)}function nF(e){wu.call(this,null,e)}function rF(){return Zo({})}function aF(e){wu.call(this,null,e)}function iF(e){wu.call(this,[],e)}dt(tF,wu,{transform:function(e,t){if(this.value&&!e.modified())return t.StopPropagation;var n=t.dataflow.locale(),r=t.fork(t.NO_SOURCE|t.NO_FIELDS),a=this.value,i=e.scale,o=VI(i,null==e.count?e.values?e.values.length:10:e.count,e.minstep),u=e.format||HI(n,i,o,e.formatSpecifier,e.formatType,!!e.values),s=e.values?qI(i,e.values,o):GI(i,o);return a&&(r.rem=a),a=s.map((function(e,t){return Zo({index:t/(s.length-1||1),value:e,label:u(e)})})),e.extra&&a.length&&a.push(Zo({index:-1,extra:{value:a[0].value},label:""})),r.source=a,r.add=a,this.value=a,r}}),dt(nF,wu,{transform:function(e,t){var n=t.dataflow,r=t.fork(t.NO_SOURCE|t.NO_FIELDS),a=e.item||rF,i=e.key||Bo,o=this.value;return _e(r.encode)&&(r.encode=null),o&&(e.modified("key")||t.modified(i))&&ue("DataJoin does not support modified key function or fields."),o||(t=t.addAll(),this.value=o=function(e){var t=lt().test((function(e){return e.exit}));return t.lookup=function(n){return t.get(e(n))},t}(i)),t.visit(t.ADD,(function(e){var t=i(e),n=o.get(t);n?n.exit?(o.empty--,r.add.push(n)):r.mod.push(n):(n=a(e),o.set(t,n),r.add.push(n)),n.datum=e,n.exit=!1})),t.visit(t.MOD,(function(e){var t=i(e),n=o.get(t);n&&(n.datum=e,r.mod.push(n))})),t.visit(t.REM,(function(e){var t=i(e),n=o.get(t);e!==n.datum||n.exit||(r.rem.push(n),n.exit=!0,++o.empty)})),t.changed(t.ADD_MOD)&&r.modifies("datum"),(t.clean()||e.clean&&o.empty>n.cleanThreshold)&&n.runAfter(o.clean),r}}),dt(aF,wu,{transform:function(e,t){var n=t.fork(t.ADD_REM),r=e.mod||!1,a=e.encoders,i=t.encode;if(_e(i)){if(!n.changed()&&!i.every((function(e){return a[e]})))return t.StopPropagation;i=i[0],n.encode=null}var o="enter"===i,u=a.update||ve,s=a.enter||ve,c=a.exit||ve,l=(i&&!o?a[i]:u)||ve;if(t.changed(t.ADD)&&(t.visit(t.ADD,(function(t){s(t,e),u(t,e)})),n.modifies(s.output),n.modifies(u.output),l!==ve&&l!==u&&(t.visit(t.ADD,(function(t){l(t,e)})),n.modifies(l.output))),t.changed(t.REM)&&c!==ve&&(t.visit(t.REM,(function(t){c(t,e)})),n.modifies(c.output)),o||l!==ve){var f=t.MOD|(e.modified()?t.REFLOW:0);o?(t.visit(f,(function(t){var a=s(t,e)||r;(l(t,e)||a)&&n.mod.push(t)})),n.mod.length&&n.modifies(s.output)):t.visit(f,(function(t){(l(t,e)||r)&&n.mod.push(t)})),n.mod.length&&n.modifies(l.output)}return n.changed()?n:t.StopPropagation}}),dt(iF,wu,{transform:function(e,t){if(null!=this.value&&!e.modified())return t.StopPropagation;var n,r,a,i,o,u=t.dataflow.locale(),s=t.fork(t.NO_SOURCE|t.NO_FIELDS),c=this.value,l=e.type||LI,f=e.scale,d=+e.limit,h=VI(f,null==e.count?5:e.count,e.minstep),p=!!e.values||l===LI,v=e.format||QI(u,f,h,l,e.formatSpecifier,e.formatType,p),m=e.values||$I(f,h);return c&&(s.rem=c),l===LI?(d&&m.length>d?(t.dataflow.warn("Symbol legend count exceeds limit, filtering items."),c=m.slice(0,d-1),o=!0):c=m,Ye(a=e.size)?(e.values||0!==f(c[0])||(c=c.slice(1)),i=c.reduce((function(t,n){return Math.max(t,a(n,e))}),0)):a=nt(i=a||8),c=c.map((function(t,n){return Zo({index:n,label:v(t,n,c),value:t,offset:i,size:a(t,e)})})),o&&(o=m[c.length],c.push(Zo({index:c.length,label:"\u2026".concat(m.length-c.length," entries"),value:o,offset:i,size:a(o,e)})))):"gradient"===l?(n=f.domain(),r=OI(f,n[0],Te(n)),m.length<3&&!e.values&&n[0]!==Te(n)&&(m=[n[0],Te(n)]),c=m.map((function(e,t){return Zo({index:t,label:v(e,t,m),value:e,perc:r(e)})}))):(a=m.length-1,r=function(e){var t=e.domain(),n=t.length-1,r=+t[0],a=+Te(t),i=a-r;if(e.type===aI){var o=n?i/n:.1;i=(a+=o)-(r-=o)}return function(e){return(e-r)/i}}(f),c=m.map((function(e,t){return Zo({index:t,label:v(e,t,m),value:e,perc:t?r(e):0,perc2:t===a?1:r(m[t+1])})}))),s.source=c,s.add=c,this.value=c,s}});var oF=function(e){return e.source.x},uF=function(e){return e.source.y},sF=function(e){return e.target.x},cF=function(e){return e.target.y};function lF(e){wu.call(this,{},e)}lF.Definition={type:"LinkPath",metadata:{modifies:!0},params:[{name:"sourceX",type:"field",default:"source.x"},{name:"sourceY",type:"field",default:"source.y"},{name:"targetX",type:"field",default:"target.x"},{name:"targetY",type:"field",default:"target.y"},{name:"orient",type:"enum",default:"vertical",values:["horizontal","vertical","radial"]},{name:"shape",type:"enum",default:"line",values:["line","arc","curve","diagonal","orthogonal"]},{name:"require",type:"signal"},{name:"as",type:"string",default:"path"}]},dt(lF,wu,{transform:function(e,t){var n=e.sourceX||oF,r=e.sourceY||uF,a=e.targetX||sF,i=e.targetY||cF,o=e.as||"path",u=e.orient||"vertical",s=e.shape||"line",c=pF.get(s+"-"+u)||pF.get(s);return c||ue("LinkPath unsupported type: "+e.shape+(e.orient?"-"+e.orient:"")),t.visit(t.SOURCE,(function(e){e[o]=c(n(e),r(e),a(e),i(e))})),t.reflow(e.modified()).modifies(o)}});var fF=function(e,t,n,r){return"M"+e+","+t+"L"+n+","+r},dF=function(e,t,n,r){var a=n-e,i=r-t,o=Math.sqrt(a*a+i*i)/2;return"M"+e+","+t+"A"+o+","+o+" "+180*Math.atan2(i,a)/Math.PI+" 0 1 "+n+","+r},hF=function(e,t,n,r){var a=n-e,i=r-t,o=.2*(a+i),u=.2*(i-a);return"M"+e+","+t+"C"+(e+o)+","+(t+u)+" "+(n+u)+","+(r-o)+" "+n+","+r},pF=lt({line:fF,"line-radial":function(e,t,n,r){return fF(t*Math.cos(e),t*Math.sin(e),r*Math.cos(n),r*Math.sin(n))},arc:dF,"arc-radial":function(e,t,n,r){return dF(t*Math.cos(e),t*Math.sin(e),r*Math.cos(n),r*Math.sin(n))},curve:hF,"curve-radial":function(e,t,n,r){return hF(t*Math.cos(e),t*Math.sin(e),r*Math.cos(n),r*Math.sin(n))},"orthogonal-horizontal":function(e,t,n,r){return"M"+e+","+t+"V"+r+"H"+n},"orthogonal-vertical":function(e,t,n,r){return"M"+e+","+t+"H"+n+"V"+r},"orthogonal-radial":function(e,t,n,r){var a=Math.cos(e),i=Math.sin(e),o=Math.cos(n),u=Math.sin(n);return"M"+t*a+","+t*i+"A"+t+","+t+" 0 0,"+((Math.abs(n-e)>Math.PI?n<=e:n>e)?1:0)+" "+t*o+","+t*u+"L"+r*o+","+r*u},"diagonal-horizontal":function(e,t,n,r){var a=(e+n)/2;return"M"+e+","+t+"C"+a+","+t+" "+a+","+r+" "+n+","+r},"diagonal-vertical":function(e,t,n,r){var a=(t+r)/2;return"M"+e+","+t+"C"+e+","+a+" "+n+","+a+" "+n+","+r},"diagonal-radial":function(e,t,n,r){var a=Math.cos(e),i=Math.sin(e),o=Math.cos(n),u=Math.sin(n),s=(t+r)/2;return"M"+t*a+","+t*i+"C"+s*a+","+s*i+" "+s*o+","+s*u+" "+r*o+","+r*u}});function vF(e){wu.call(this,null,e)}vF.Definition={type:"Pie",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"startAngle",type:"number",default:0},{name:"endAngle",type:"number",default:6.283185307179586},{name:"sort",type:"boolean",default:!1},{name:"as",type:"string",array:!0,length:2,default:["startAngle","endAngle"]}]},dt(vF,wu,{transform:function(e,t){var n,r,a,i=e.as||["startAngle","endAngle"],o=i[0],u=i[1],s=e.field||he,c=e.startAngle||0,l=null!=e.endAngle?e.endAngle:2*Math.PI,f=t.source,d=f.map(s),h=d.length,p=c,v=(l-c)/function(e,t){var n=0;if(void 0===t){var r,a=(0,Rt.Z)(e);try{for(a.s();!(r=a.n()).done;){var i=r.value;(i=+i)&&(n+=i)}}catch(l){a.e(l)}finally{a.f()}}else{var o,u=-1,s=(0,Rt.Z)(e);try{for(s.s();!(o=s.n()).done;){var c=o.value;(c=+t(c,++u,e))&&(n+=c)}}catch(l){s.e(l)}finally{s.f()}}return n}(d),m=oD(h);for(e.sort&&m.sort((function(e,t){return d[e]-d[t]})),n=0;n<h;++n)a=d[m[n]],(r=f[m[n]])[o]=p,r[u]=p+=a*v;return this.value=d,t.reflow(e.modified()).modifies(i)}});function mF(e){return SI(e)&&e!==eI}var gF=Ft(["set","modified","clear","type","scheme","schemeExtent","schemeCount","domain","domainMin","domainMid","domainMax","domainRaw","domainImplicit","nice","zero","bins","range","rangeStep","round","reverse","interpolate","interpolateGamma"]);function yF(e){wu.call(this,null,e),this.modified(!0)}function bF(e,t,n){EI(e)&&(Math.abs(t.reduce((function(e,t){return e+(t<0?-1:t>0?1:0)}),0))!==t.length&&n.warn("Log scale domain includes zero: "+Et(t)));return t}function xF(e,t,n){return Ye(e)&&(t||n)?DI(e,wF(t||[0,1],n)):e}function wF(e,t){return t?e.slice().reverse():e}function kF(e){wu.call(this,null,e)}dt(yF,wu,{transform:function(e,t){var n=t.dataflow,r=this.value,a=function(e){var t,n=e.type,r="";if(n===eI)return"sequential-linear";(function(e){var t=e.type;return SI(t)&&t!==QT&&t!==JT&&(e.scheme||e.range&&e.range.length&&e.range.every(bt))})(e)&&(r=2===(t=e.rawDomain?e.rawDomain.length:e.domain?e.domain.length+ +(null!=e.domainMid):0)?"sequential-":3===t?"diverging-":"");return(r+n||HT).toLowerCase()}(e);for(a in r&&a===r.type||(this.value=r=wI(a)()),e)if(!gF[a]){if("padding"===a&&mF(r.type))continue;Ye(r[a])?r[a](e[a]):n.warn("Unsupported scale property: "+a)}return function(e,t,n){var r=e.type,a=t.round||!1,i=t.range;if(null!=t.rangeStep)i=function(e,t,n){e!==uI&&e!==oI&&ue("Only band and point scales support rangeStep.");var r=(null!=t.paddingOuter?t.paddingOuter:t.padding)||0,a=e===oI?1:(null!=t.paddingInner?t.paddingInner:t.padding)||0;return[0,t.rangeStep*GT(n,a,r)]}(r,t,n);else if(t.scheme&&(i=function(e,t,n){var r,a=t.schemeExtent;_e(t.scheme)?r=FI(t.scheme,t.interpolate,t.interpolateGamma):(r=ZI(t.scheme.toLowerCase()))||ue("Unrecognized scheme name: ".concat(t.scheme));return n=e===aI?n+1:e===sI?n-1:e===nI||e===rI?+t.schemeCount||5:n,NI(e)?xF(r,a,t.reverse):Ye(r)?MI(xF(r,a),n):e===iI?r:r.slice(0,n)}(r,t,n),Ye(i))){if(e.interpolator)return e.interpolator(i);ue("Scale type ".concat(r," does not support interpolating color schemes."))}if(i&&NI(r))return e.interpolator(FI(wF(i,t.reverse),t.interpolate,t.interpolateGamma));i&&t.interpolate&&e.interpolate?e.interpolate(RI(t.interpolate,t.interpolateGamma)):Ye(e.round)?e.round(a):Ye(e.rangeRound)&&e.interpolate(a?uD:eF);i&&e.range(wF(i,t.reverse))}(r,e,function(e,t,n){var r=t.bins;if(r&&!_e(r)){var a=e.domain(),i=a[0],o=Te(a),u=r.step,s=null==r.start?i:r.start,c=null==r.stop?o:r.stop;u||ue("Scale bins parameter missing step property."),s<i&&(s=u*Math.ceil(i/u)),c>o&&(c=u*Math.floor(o/u)),r=oD(s,c+u/2,u)}r?e.bins=r:e.bins&&delete e.bins;e.type===sI&&(r?t.domain||t.domainRaw||(e.domain(r),n=r.length):e.bins=e.domain());return n}(r,e,function(e,t,n){var r=function(e,t,n){return t?(e.domain(bF(e.type,t,n)),t.length):-1}(e,t.domainRaw,n);if(r>-1)return r;var a,i,o=t.domain,u=e.type,s=t.zero||void 0===t.zero&&function(e){var t=e.type;return!e.bins&&(t===HT||t===KT||t===YT)}(e);if(!o)return 0;mF(u)&&t.padding&&o[0]!==Te(o)&&(o=function(e,t,n,r,a,i){var o=Math.abs(Te(n)-n[0]),u=o/(o-2*r),s=e===XT?We(t,null,u):e===YT?Ve(t,null,u,.5):e===KT?Ve(t,null,u,a||1):e===$T?qe(t,null,u,i||1):Ue(t,null,u);return(t=t.slice())[0]=s[0],t[t.length-1]=s[1],t}(u,o,t.range,t.padding,t.exponent,t.constant));if((s||null!=t.domainMin||null!=t.domainMax||null!=t.domainMid)&&(a=(o=o.slice()).length-1||1,s&&(o[0]>0&&(o[0]=0),o[a]<0&&(o[a]=0)),null!=t.domainMin&&(o[0]=t.domainMin),null!=t.domainMax&&(o[a]=t.domainMax),null!=t.domainMid)){var c=(i=t.domainMid)>o[a]?a+1:i<o[0]?0:a;c!==a&&n.warn("Scale domainMid exceeds domain min or max.",i),o.splice(c,0,i)}e.domain(bF(u,o,n)),u===iI&&e.unknown(t.domainImplicit?CS:void 0);t.nice&&e.nice&&e.nice(!0!==t.nice&&VI(e,t.nice)||null);return o.length}(r,e,n))),t.fork(t.NO_SOURCE|t.NO_FIELDS)}}),dt(kF,wu,{transform:function(e,t){var n=e.modified("sort")||t.changed(t.ADD)||t.modified(e.sort.fields)||t.modified("datum");return n&&t.source.sort(Wo(e.sort)),this.modified(n),t}});var _F="zero",SF="center",CF="normalize",AF=["y0","y1"];function EF(e){wu.call(this,null,e)}function NF(e,t,n,r,a){for(var i,o=(t-e.sum)/2,u=e.length,s=0;s<u;++s)(i=e[s])[r]=o,i[a]=o+=Math.abs(n(i))}function TF(e,t,n,r,a){for(var i,o=1/e.sum,u=0,s=e.length,c=0,l=0;c<s;++c)(i=e[c])[r]=u,i[a]=u=o*(l+=Math.abs(n(i)))}function IF(e,t,n,r,a){for(var i,o,u=0,s=0,c=e.length,l=0;l<c;++l)(i=+n(o=e[l]))<0?(o[r]=s,o[a]=s+=i):(o[r]=u,o[a]=u+=i)}EF.Definition={type:"Stack",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"groupby",type:"field",array:!0},{name:"sort",type:"compare"},{name:"offset",type:"enum",default:_F,values:[_F,SF,CF]},{name:"as",type:"string",array:!0,length:2,default:AF}]},dt(EF,wu,{transform:function(e,t){var n,r,a,i,o=e.as||AF,u=o[0],s=o[1],c=Wo(e.sort),l=e.field||he,f=e.offset===SF?NF:e.offset===CF?TF:IF;for(n=function(e,t,n,r){var a,i,o,u,s,c,l,f,d,h=[],p=function(e){return e(s)};if(null==t)h.push(e.slice());else for(a={},i=0,o=e.length;i<o;++i)s=e[i],(l=a[c=t.map(p)])||(a[c]=l=[],h.push(l)),l.push(s);for(c=0,d=0,u=h.length;c<u;++c){for(i=0,f=0,o=(l=h[c]).length;i<o;++i)f+=Math.abs(r(l[i]));l.sum=f,f>d&&(d=f),n&&l.sort(n)}return h.max=d,h}(t.source,e.groupby,c,l),r=0,a=n.length,i=n.max;r<a;++r)f(n[r],i,l,u,s);return t.reflow(e.modified()).modifies(o)}});var DF=Math.sqrt(50),FF=Math.sqrt(10),MF=Math.sqrt(2);function OF(e,t,n){e=+e,t=+t,n=(a=arguments.length)<2?(t=e,e=0,1):a<3?1:+n;for(var r=-1,a=0|Math.max(0,Math.ceil((t-e)/n)),i=new Array(a);++r<a;)i[r]=e+r*n;return i}function RF(e,t){var n;if(void 0===t){var r,a=(0,Rt.Z)(e);try{for(a.s();!(r=a.n()).done;){var i=r.value;null!=i&&(n<i||void 0===n&&i>=i)&&(n=i)}}catch(l){a.e(l)}finally{a.f()}}else{var o,u=-1,s=(0,Rt.Z)(e);try{for(s.s();!(o=s.n()).done;){var c=o.value;null!=(c=t(c,++u,e))&&(n<c||void 0===n&&c>=c)&&(n=c)}}catch(l){s.e(l)}finally{s.f()}}return n}var jF=function(e){return e};function BF(e,t){e&&ZF.hasOwnProperty(e.type)&&ZF[e.type](e,t)}var zF={Feature:function(e,t){BF(e.geometry,t)},FeatureCollection:function(e,t){for(var n=e.features,r=-1,a=n.length;++r<a;)BF(n[r].geometry,t)}},ZF={Sphere:function(e,t){t.sphere()},Point:function(e,t){e=e.coordinates,t.point(e[0],e[1],e[2])},MultiPoint:function(e,t){for(var n=e.coordinates,r=-1,a=n.length;++r<a;)e=n[r],t.point(e[0],e[1],e[2])},LineString:function(e,t){LF(e.coordinates,t,0)},MultiLineString:function(e,t){for(var n=e.coordinates,r=-1,a=n.length;++r<a;)LF(n[r],t,0)},Polygon:function(e,t){PF(e.coordinates,t)},MultiPolygon:function(e,t){for(var n=e.coordinates,r=-1,a=n.length;++r<a;)PF(n[r],t)},GeometryCollection:function(e,t){for(var n=e.geometries,r=-1,a=n.length;++r<a;)BF(n[r],t)}};function LF(e,t,n){var r,a=-1,i=e.length-n;for(t.lineStart();++a<i;)r=e[a],t.point(r[0],r[1],r[2]);t.lineEnd()}function PF(e,t){var n=-1,r=e.length;for(t.polygonStart();++n<r;)LF(e[n],t,1);t.polygonEnd()}function UF(e,t){e&&zF.hasOwnProperty(e.type)?zF[e.type](e,t):BF(e,t)}var WF=function(){function e(){(0,op.Z)(this,e),this._partials=new Float64Array(32),this._n=0}return(0,up.Z)(e,[{key:"add",value:function(e){for(var t=this._partials,n=0,r=0;r<this._n&&r<32;r++){var a=t[r],i=e+a,o=Math.abs(e)<Math.abs(a)?e-(i-a):a-(i-e);o&&(t[n++]=o),e=i}return t[n]=e,this._n=n+1,this}},{key:"valueOf",value:function(){var e,t,n,r=this._partials,a=this._n,i=0;if(a>0){for(i=r[--a];a>0&&(e=i,!(n=(t=r[--a])-((i=e+t)-e))););a>0&&(n<0&&r[a-1]<0||n>0&&r[a-1]>0)&&(t=2*n)==(e=i+t)-i&&(i=e)}return i}}]),e}();var VF=1e-6,qF=Math.PI,GF=qF/2,HF=qF/4,XF=2*qF,KF=180/qF,YF=qF/180,$F=Math.abs,QF=Math.atan,JF=Math.atan2,eM=Math.cos,tM=(Math.ceil,Math.exp),nM=(Math.floor,Math.hypot,Math.log),rM=Math.pow,aM=Math.sin,iM=Math.sign||function(e){return e>0?1:e<0?-1:0},oM=Math.sqrt,uM=Math.tan;function sM(e){return e>1?0:e<-1?qF:Math.acos(e)}function cM(e){return e>1?GF:e<-1?-GF:Math.asin(e)}function lM(){}var fM,dM,hM,pM,vM=new WF,mM=new WF,gM={point:lM,lineStart:lM,lineEnd:lM,polygonStart:function(){gM.lineStart=yM,gM.lineEnd=wM},polygonEnd:function(){gM.lineStart=gM.lineEnd=gM.point=lM,vM.add($F(mM)),mM=new WF},result:function(){var e=vM/2;return vM=new WF,e}};function yM(){gM.point=bM}function bM(e,t){gM.point=xM,fM=hM=e,dM=pM=t}function xM(e,t){mM.add(pM*e-hM*t),hM=e,pM=t}function wM(){xM(fM,dM)}var kM=gM,_M=1/0,SM=_M,CM=-_M,AM=CM,EM={point:function(e,t){e<_M&&(_M=e);e>CM&&(CM=e);t<SM&&(SM=t);t>AM&&(AM=t)},lineStart:lM,lineEnd:lM,polygonStart:lM,polygonEnd:lM,result:function(){var e=[[_M,SM],[CM,AM]];return CM=AM=-(SM=_M=1/0),e}};var NM,TM,IM,DM,FM=EM,MM=0,OM=0,RM=0,jM=0,BM=0,zM=0,ZM=0,LM=0,PM=0,UM={point:WM,lineStart:VM,lineEnd:HM,polygonStart:function(){UM.lineStart=XM,UM.lineEnd=KM},polygonEnd:function(){UM.point=WM,UM.lineStart=VM,UM.lineEnd=HM},result:function(){var e=PM?[ZM/PM,LM/PM]:zM?[jM/zM,BM/zM]:RM?[MM/RM,OM/RM]:[NaN,NaN];return MM=OM=RM=jM=BM=zM=ZM=LM=PM=0,e}};function WM(e,t){MM+=e,OM+=t,++RM}function VM(){UM.point=qM}function qM(e,t){UM.point=GM,WM(IM=e,DM=t)}function GM(e,t){var n=e-IM,r=t-DM,a=oM(n*n+r*r);jM+=a*(IM+e)/2,BM+=a*(DM+t)/2,zM+=a,WM(IM=e,DM=t)}function HM(){UM.point=WM}function XM(){UM.point=YM}function KM(){$M(NM,TM)}function YM(e,t){UM.point=$M,WM(NM=IM=e,TM=DM=t)}function $M(e,t){var n=e-IM,r=t-DM,a=oM(n*n+r*r);jM+=a*(IM+e)/2,BM+=a*(DM+t)/2,zM+=a,ZM+=(a=DM*e-IM*t)*(IM+e),LM+=a*(DM+t),PM+=3*a,WM(IM=e,DM=t)}var QM=UM;function JM(e){this._context=e}JM.prototype={_radius:4.5,pointRadius:function(e){return this._radius=e,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._context.closePath(),this._point=NaN},point:function(e,t){switch(this._point){case 0:this._context.moveTo(e,t),this._point=1;break;case 1:this._context.lineTo(e,t);break;default:this._context.moveTo(e+this._radius,t),this._context.arc(e,t,this._radius,0,XF)}},result:lM};var eO,tO,nO,rO,aO,iO=new WF,oO={point:lM,lineStart:function(){oO.point=uO},lineEnd:function(){eO&&sO(tO,nO),oO.point=lM},polygonStart:function(){eO=!0},polygonEnd:function(){eO=null},result:function(){var e=+iO;return iO=new WF,e}};function uO(e,t){oO.point=sO,tO=rO=e,nO=aO=t}function sO(e,t){rO-=e,aO-=t,iO.add(oM(rO*rO+aO*aO)),rO=e,aO=t}var cO=oO;function lO(){this._string=[]}function fO(e){return"m0,"+e+"a"+e+","+e+" 0 1,1 0,"+-2*e+"a"+e+","+e+" 0 1,1 0,"+2*e+"z"}function dO(e,t){var n,r,a=4.5;function i(e){return e&&("function"===typeof a&&r.pointRadius(+a.apply(this,arguments)),UF(e,n(r))),r.result()}return i.area=function(e){return UF(e,n(kM)),kM.result()},i.measure=function(e){return UF(e,n(cO)),cO.result()},i.bounds=function(e){return UF(e,n(FM)),FM.result()},i.centroid=function(e){return UF(e,n(QM)),QM.result()},i.projection=function(t){return arguments.length?(n=null==t?(e=null,jF):(e=t).stream,i):e},i.context=function(e){return arguments.length?(r=null==e?(t=null,new lO):new JM(t=e),"function"!==typeof a&&r.pointRadius(a),i):t},i.pointRadius=function(e){return arguments.length?(a="function"===typeof e?e:(r.pointRadius(+e),+e),i):a},i.projection(e).context(t)}function hO(){var e,t=[];return{point:function(t,n,r){e.push([t,n,r])},lineStart:function(){t.push(e=[])},lineEnd:lM,rejoin:function(){t.length>1&&t.push(t.pop().concat(t.shift()))},result:function(){var n=t;return t=[],e=null,n}}}function pO(e,t){return $F(e[0]-t[0])<VF&&$F(e[1]-t[1])<VF}function vO(e,t,n,r){this.x=e,this.z=t,this.o=n,this.e=r,this.v=!1,this.n=this.p=null}function mO(e,t,n,r,a){var i,o,u=[],s=[];if(e.forEach((function(e){if(!((t=e.length-1)<=0)){var t,n,r=e[0],o=e[t];if(pO(r,o)){if(!r[2]&&!o[2]){for(a.lineStart(),i=0;i<t;++i)a.point((r=e[i])[0],r[1]);return void a.lineEnd()}o[0]+=2e-6}u.push(n=new vO(r,e,null,!0)),s.push(n.o=new vO(r,null,n,!1)),u.push(n=new vO(o,e,null,!1)),s.push(n.o=new vO(o,null,n,!0))}})),u.length){for(s.sort(t),gO(u),gO(s),i=0,o=s.length;i<o;++i)s[i].e=n=!n;for(var c,l,f=u[0];;){for(var d=f,h=!0;d.v;)if((d=d.n)===f)return;c=d.z,a.lineStart();do{if(d.v=d.o.v=!0,d.e){if(h)for(i=0,o=c.length;i<o;++i)a.point((l=c[i])[0],l[1]);else r(d.x,d.n.x,1,a);d=d.n}else{if(h)for(c=d.p.z,i=c.length-1;i>=0;--i)a.point((l=c[i])[0],l[1]);else r(d.x,d.p.x,-1,a);d=d.p}c=(d=d.o).z,h=!h}while(!d.v);a.lineEnd()}}}function gO(e){if(t=e.length){for(var t,n,r=0,a=e[0];++r<t;)a.n=n=e[r],n.p=a,a=n;a.n=n=e[0],n.p=a}}function yO(e){return[JF(e[1],e[0]),cM(e[2])]}function bO(e){var t=e[0],n=e[1],r=eM(n);return[r*eM(t),r*aM(t),aM(n)]}function xO(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function wO(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}function kO(e,t){e[0]+=t[0],e[1]+=t[1],e[2]+=t[2]}function _O(e,t){return[e[0]*t,e[1]*t,e[2]*t]}function SO(e){var t=oM(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]/=t,e[1]/=t,e[2]/=t}function CO(e){return $F(e[0])<=qF?e[0]:iM(e[0])*(($F(e[0])+qF)%XF-qF)}lO.prototype={_radius:4.5,_circle:fO(4.5),pointRadius:function(e){return(e=+e)!==this._radius&&(this._radius=e,this._circle=null),this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._string.push("Z"),this._point=NaN},point:function(e,t){switch(this._point){case 0:this._string.push("M",e,",",t),this._point=1;break;case 1:this._string.push("L",e,",",t);break;default:null==this._circle&&(this._circle=fO(this._radius)),this._string.push("M",e,",",t,this._circle)}},result:function(){if(this._string.length){var e=this._string.join("");return this._string=[],e}return null}};var AO=w().mark(EO);function EO(e){var t,n,r;return w().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:t=(0,Rt.Z)(e),a.prev=1,t.s();case 3:if((n=t.n()).done){a.next=8;break}return r=n.value,a.delegateYield(r,"t0",6);case 6:a.next=3;break;case 8:a.next=13;break;case 10:a.prev=10,a.t1=a.catch(1),t.e(a.t1);case 13:return a.prev=13,t.f(),a.finish(13);case 16:case"end":return a.stop()}}),AO,null,[[1,10,13,16]])}function NO(e){return Array.from(EO(e))}function TO(e,t,n,r){return function(a){var i,o,u,s=t(a),c=hO(),l=t(c),f=!1,d={point:h,lineStart:v,lineEnd:m,polygonStart:function(){d.point=g,d.lineStart=y,d.lineEnd=b,o=[],i=[]},polygonEnd:function(){d.point=h,d.lineStart=v,d.lineEnd=m,o=NO(o);var e=function(e,t){var n=CO(t),r=t[1],a=aM(r),i=[aM(n),-eM(n),0],o=0,u=0,s=new WF;1===a?r=GF+VF:-1===a&&(r=-GF-VF);for(var c=0,l=e.length;c<l;++c)if(d=(f=e[c]).length)for(var f,d,h=f[d-1],p=CO(h),v=h[1]/2+HF,m=aM(v),g=eM(v),y=0;y<d;++y,p=x,m=k,g=_,h=b){var b=f[y],x=CO(b),w=b[1]/2+HF,k=aM(w),_=eM(w),S=x-p,C=S>=0?1:-1,A=C*S,E=A>qF,N=m*k;if(s.add(JF(N*C*aM(A),g*_+N*eM(A))),o+=E?S+C*XF:S,E^p>=n^x>=n){var T=wO(bO(h),bO(b));SO(T);var I=wO(i,T);SO(I);var D=(E^S>=0?-1:1)*cM(I[2]);(r>D||r===D&&(T[0]||T[1]))&&(u+=E^S>=0?1:-1)}}return(o<-1e-6||o<VF&&s<-1e-12)^1&u}(i,r);o.length?(f||(a.polygonStart(),f=!0),mO(o,DO,e,n,a)):e&&(f||(a.polygonStart(),f=!0),a.lineStart(),n(null,null,1,a),a.lineEnd()),f&&(a.polygonEnd(),f=!1),o=i=null},sphere:function(){a.polygonStart(),a.lineStart(),n(null,null,1,a),a.lineEnd(),a.polygonEnd()}};function h(t,n){e(t,n)&&a.point(t,n)}function p(e,t){s.point(e,t)}function v(){d.point=p,s.lineStart()}function m(){d.point=h,s.lineEnd()}function g(e,t){u.push([e,t]),l.point(e,t)}function y(){l.lineStart(),u=[]}function b(){g(u[0][0],u[0][1]),l.lineEnd();var e,t,n,r,s=l.clean(),d=c.result(),h=d.length;if(u.pop(),i.push(u),u=null,h)if(1&s){if((t=(n=d[0]).length-1)>0){for(f||(a.polygonStart(),f=!0),a.lineStart(),e=0;e<t;++e)a.point((r=n[e])[0],r[1]);a.lineEnd()}}else h>1&&2&s&&d.push(d.pop().concat(d.shift())),o.push(d.filter(IO))}return d}}function IO(e){return e.length>1}function DO(e,t){return((e=e.x)[0]<0?e[1]-GF-VF:GF-e[1])-((t=t.x)[0]<0?t[1]-GF-VF:GF-t[1])}var FO=TO((function(){return!0}),(function(e){var t,n=NaN,r=NaN,a=NaN;return{lineStart:function(){e.lineStart(),t=1},point:function(i,o){var u=i>0?qF:-qF,s=$F(i-n);$F(s-qF)<VF?(e.point(n,r=(r+o)/2>0?GF:-GF),e.point(a,r),e.lineEnd(),e.lineStart(),e.point(u,r),e.point(i,r),t=0):a!==u&&s>=qF&&($F(n-a)<VF&&(n-=a*VF),$F(i-u)<VF&&(i-=u*VF),r=function(e,t,n,r){var a,i,o=aM(e-n);return $F(o)>VF?QF((aM(t)*(i=eM(r))*aM(n)-aM(r)*(a=eM(t))*aM(e))/(a*i*o)):(t+r)/2}(n,r,i,o),e.point(a,r),e.lineEnd(),e.lineStart(),e.point(u,r),t=0),e.point(n=i,r=o),a=u},lineEnd:function(){e.lineEnd(),n=r=NaN},clean:function(){return 2-t}}}),(function(e,t,n,r){var a;if(null==e)a=n*GF,r.point(-qF,a),r.point(0,a),r.point(qF,a),r.point(qF,0),r.point(qF,-a),r.point(0,-a),r.point(-qF,-a),r.point(-qF,0),r.point(-qF,a);else if($F(e[0]-t[0])>VF){var i=e[0]<t[0]?qF:-qF;a=n*i/2,r.point(-i,a),r.point(0,a),r.point(i,a)}else r.point(t[0],t[1])}),[-qF,-GF]);function MO(e,t,n,r,a,i){if(n){var o=eM(t),u=aM(t),s=r*n;null==a?(a=t+r*XF,i=t-s/2):(a=OO(o,a),i=OO(o,i),(r>0?a<i:a>i)&&(a+=r*XF));for(var c,l=a;r>0?l>i:l<i;l-=s)c=yO([o,-u*eM(l),-u*aM(l)]),e.point(c[0],c[1])}}function OO(e,t){(t=bO(t))[0]-=e,SO(t);var n=sM(-t[1]);return((-t[2]<0?-n:n)+XF-VF)%XF}function RO(e){var t=eM(e),n=6*YF,r=t>0,a=$F(t)>VF;function i(e,n){return eM(e)*eM(n)>t}function o(e,n,r){var a=[1,0,0],i=wO(bO(e),bO(n)),o=xO(i,i),u=i[0],s=o-u*u;if(!s)return!r&&e;var c=t*o/s,l=-t*u/s,f=wO(a,i),d=_O(a,c);kO(d,_O(i,l));var h=f,p=xO(d,h),v=xO(h,h),m=p*p-v*(xO(d,d)-1);if(!(m<0)){var g=oM(m),y=_O(h,(-p-g)/v);if(kO(y,d),y=yO(y),!r)return y;var b,x=e[0],w=n[0],k=e[1],_=n[1];w<x&&(b=x,x=w,w=b);var S=w-x,C=$F(S-qF)<VF;if(!C&&_<k&&(b=k,k=_,_=b),C||S<VF?C?k+_>0^y[1]<($F(y[0]-x)<VF?k:_):k<=y[1]&&y[1]<=_:S>qF^(x<=y[0]&&y[0]<=w)){var A=_O(h,(-p+g)/v);return kO(A,d),[y,yO(A)]}}}function u(t,n){var a=r?e:qF-e,i=0;return t<-a?i|=1:t>a&&(i|=2),n<-a?i|=4:n>a&&(i|=8),i}return TO(i,(function(e){var t,n,s,c,l;return{lineStart:function(){c=s=!1,l=1},point:function(f,d){var h,p=[f,d],v=i(f,d),m=r?v?0:u(f,d):v?u(f+(f<0?qF:-qF),d):0;if(!t&&(c=s=v)&&e.lineStart(),v!==s&&(!(h=o(t,p))||pO(t,h)||pO(p,h))&&(p[2]=1),v!==s)l=0,v?(e.lineStart(),h=o(p,t),e.point(h[0],h[1])):(h=o(t,p),e.point(h[0],h[1],2),e.lineEnd()),t=h;else if(a&&t&&r^v){var g;m&n||!(g=o(p,t,!0))||(l=0,r?(e.lineStart(),e.point(g[0][0],g[0][1]),e.point(g[1][0],g[1][1]),e.lineEnd()):(e.point(g[1][0],g[1][1]),e.lineEnd(),e.lineStart(),e.point(g[0][0],g[0][1],3)))}!v||t&&pO(t,p)||e.point(p[0],p[1]),t=p,s=v,n=m},lineEnd:function(){s&&e.lineEnd(),t=null},clean:function(){return l|(c&&s)<<1}}}),(function(t,r,a,i){MO(i,e,n,a,t,r)}),r?[0,-e]:[-qF,e-qF])}var jO=1e9,BO=-jO;function zO(e,t,n,r){function a(a,i){return e<=a&&a<=n&&t<=i&&i<=r}function i(a,i,u,c){var l=0,f=0;if(null==a||(l=o(a,u))!==(f=o(i,u))||s(a,i)<0^u>0)do{c.point(0===l||3===l?e:n,l>1?r:t)}while((l=(l+u+4)%4)!==f);else c.point(i[0],i[1])}function o(r,a){return $F(r[0]-e)<VF?a>0?0:3:$F(r[0]-n)<VF?a>0?2:1:$F(r[1]-t)<VF?a>0?1:0:a>0?3:2}function u(e,t){return s(e.x,t.x)}function s(e,t){var n=o(e,1),r=o(t,1);return n!==r?n-r:0===n?t[1]-e[1]:1===n?e[0]-t[0]:2===n?e[1]-t[1]:t[0]-e[0]}return function(o){var s,c,l,f,d,h,p,v,m,g,y,b=o,x=hO(),w={point:k,lineStart:function(){w.point=_,c&&c.push(l=[]);g=!0,m=!1,p=v=NaN},lineEnd:function(){s&&(_(f,d),h&&m&&x.rejoin(),s.push(x.result()));w.point=k,m&&b.lineEnd()},polygonStart:function(){b=x,s=[],c=[],y=!0},polygonEnd:function(){var t=function(){for(var t=0,n=0,a=c.length;n<a;++n)for(var i,o,u=c[n],s=1,l=u.length,f=u[0],d=f[0],h=f[1];s<l;++s)i=d,o=h,d=(f=u[s])[0],h=f[1],o<=r?h>r&&(d-i)*(r-o)>(h-o)*(e-i)&&++t:h<=r&&(d-i)*(r-o)<(h-o)*(e-i)&&--t;return t}(),n=y&&t,a=(s=NO(s)).length;(n||a)&&(o.polygonStart(),n&&(o.lineStart(),i(null,null,1,o),o.lineEnd()),a&&mO(s,u,t,i,o),o.polygonEnd());b=o,s=c=l=null}};function k(e,t){a(e,t)&&b.point(e,t)}function _(i,o){var u=a(i,o);if(c&&l.push([i,o]),g)f=i,d=o,h=u,g=!1,u&&(b.lineStart(),b.point(i,o));else if(u&&m)b.point(i,o);else{var s=[p=Math.max(BO,Math.min(jO,p)),v=Math.max(BO,Math.min(jO,v))],x=[i=Math.max(BO,Math.min(jO,i)),o=Math.max(BO,Math.min(jO,o))];!function(e,t,n,r,a,i){var o,u=e[0],s=e[1],c=0,l=1,f=t[0]-u,d=t[1]-s;if(o=n-u,f||!(o>0)){if(o/=f,f<0){if(o<c)return;o<l&&(l=o)}else if(f>0){if(o>l)return;o>c&&(c=o)}if(o=a-u,f||!(o<0)){if(o/=f,f<0){if(o>l)return;o>c&&(c=o)}else if(f>0){if(o<c)return;o<l&&(l=o)}if(o=r-s,d||!(o>0)){if(o/=d,d<0){if(o<c)return;o<l&&(l=o)}else if(d>0){if(o>l)return;o>c&&(c=o)}if(o=i-s,d||!(o<0)){if(o/=d,d<0){if(o>l)return;o>c&&(c=o)}else if(d>0){if(o<c)return;o<l&&(l=o)}return c>0&&(e[0]=u+c*f,e[1]=s+c*d),l<1&&(t[0]=u+l*f,t[1]=s+l*d),!0}}}}}(s,x,e,t,n,r)?u&&(b.lineStart(),b.point(i,o),y=!1):(m||(b.lineStart(),b.point(s[0],s[1])),b.point(x[0],x[1]),u||b.lineEnd(),y=!1)}p=i,v=o,m=u}return w}}function ZO(e,t){function n(n,r){return n=e(n,r),t(n[0],n[1])}return e.invert&&t.invert&&(n.invert=function(n,r){return(n=t.invert(n,r))&&e.invert(n[0],n[1])}),n}function LO(e,t){return[$F(e)>qF?e+Math.round(-e/XF)*XF:e,t]}function PO(e,t,n){return(e%=XF)?t||n?ZO(WO(e),VO(t,n)):WO(e):t||n?VO(t,n):LO}function UO(e){return function(t,n){return[(t+=e)>qF?t-XF:t<-qF?t+XF:t,n]}}function WO(e){var t=UO(e);return t.invert=UO(-e),t}function VO(e,t){var n=eM(e),r=aM(e),a=eM(t),i=aM(t);function o(e,t){var o=eM(t),u=eM(e)*o,s=aM(e)*o,c=aM(t),l=c*n+u*r;return[JF(s*a-l*i,u*n-c*r),cM(l*a+s*i)]}return o.invert=function(e,t){var o=eM(t),u=eM(e)*o,s=aM(e)*o,c=aM(t),l=c*a-s*i;return[JF(s*a+c*i,u*n+l*r),cM(l*n-u*r)]},o}function qO(e){return function(t){var n=new GO;for(var r in e)n[r]=e[r];return n.stream=t,n}}function GO(){}function HO(e,t,n){var r=e.clipExtent&&e.clipExtent();return e.scale(150).translate([0,0]),null!=r&&e.clipExtent(null),UF(n,e.stream(FM)),t(FM.result()),null!=r&&e.clipExtent(r),e}function XO(e,t,n){return HO(e,(function(n){var r=t[1][0]-t[0][0],a=t[1][1]-t[0][1],i=Math.min(r/(n[1][0]-n[0][0]),a/(n[1][1]-n[0][1])),o=+t[0][0]+(r-i*(n[1][0]+n[0][0]))/2,u=+t[0][1]+(a-i*(n[1][1]+n[0][1]))/2;e.scale(150*i).translate([o,u])}),n)}function KO(e,t,n){return XO(e,[[0,0],t],n)}function YO(e,t,n){return HO(e,(function(n){var r=+t,a=r/(n[1][0]-n[0][0]),i=(r-a*(n[1][0]+n[0][0]))/2,o=-a*n[0][1];e.scale(150*a).translate([i,o])}),n)}function $O(e,t,n){return HO(e,(function(n){var r=+t,a=r/(n[1][1]-n[0][1]),i=-a*n[0][0],o=(r-a*(n[1][1]+n[0][1]))/2;e.scale(150*a).translate([i,o])}),n)}LO.invert=LO,GO.prototype={constructor:GO,point:function(e,t){this.stream.point(e,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};var QO=eM(30*YF);function JO(e,t){return+t?function(e,t){function n(r,a,i,o,u,s,c,l,f,d,h,p,v,m){var g=c-r,y=l-a,b=g*g+y*y;if(b>4*t&&v--){var x=o+d,w=u+h,k=s+p,_=oM(x*x+w*w+k*k),S=cM(k/=_),C=$F($F(k)-1)<VF||$F(i-f)<VF?(i+f)/2:JF(w,x),A=e(C,S),E=A[0],N=A[1],T=E-r,I=N-a,D=y*T-g*I;(D*D/b>t||$F((g*T+y*I)/b-.5)>.3||o*d+u*h+s*p<QO)&&(n(r,a,i,o,u,s,E,N,C,x/=_,w/=_,k,v,m),m.point(E,N),n(E,N,C,x,w,k,c,l,f,d,h,p,v,m))}}return function(t){var r,a,i,o,u,s,c,l,f,d,h,p,v={point:m,lineStart:g,lineEnd:b,polygonStart:function(){t.polygonStart(),v.lineStart=x},polygonEnd:function(){t.polygonEnd(),v.lineStart=g}};function m(n,r){n=e(n,r),t.point(n[0],n[1])}function g(){l=NaN,v.point=y,t.lineStart()}function y(r,a){var i=bO([r,a]),o=e(r,a);n(l,f,c,d,h,p,l=o[0],f=o[1],c=r,d=i[0],h=i[1],p=i[2],16,t),t.point(l,f)}function b(){v.point=m,t.lineEnd()}function x(){g(),v.point=w,v.lineEnd=k}function w(e,t){y(r=e,t),a=l,i=f,o=d,u=h,s=p,v.point=y}function k(){n(l,f,c,d,h,p,a,i,r,o,u,s,16,t),v.lineEnd=b,b()}return v}}(e,t):function(e){return qO({point:function(t,n){t=e(t,n),this.stream.point(t[0],t[1])}})}(e)}var eR=qO({point:function(e,t){this.stream.point(e*YF,t*YF)}});function tR(e,t,n,r,a,i){if(!i)return function(e,t,n,r,a){function i(i,o){return[t+e*(i*=r),n-e*(o*=a)]}return i.invert=function(i,o){return[(i-t)/e*r,(n-o)/e*a]},i}(e,t,n,r,a);var o=eM(i),u=aM(i),s=o*e,c=u*e,l=o/e,f=u/e,d=(u*n-o*t)/e,h=(u*t+o*n)/e;function p(e,i){return[s*(e*=r)-c*(i*=a)+t,n-c*e-s*i]}return p.invert=function(e,t){return[r*(l*e-f*t+d),a*(h-f*e-l*t)]},p}function nR(e){return rR((function(){return e}))()}function rR(e){var t,n,r,a,i,o,u,s,c,l,f=150,d=480,h=250,p=0,v=0,m=0,g=0,y=0,b=0,x=1,w=1,k=null,_=FO,S=null,C=jF,A=.5;function E(e){return s(e[0]*YF,e[1]*YF)}function N(e){return(e=s.invert(e[0],e[1]))&&[e[0]*KF,e[1]*KF]}function T(){var e=tR(f,0,0,x,w,b).apply(null,t(p,v)),r=tR(f,d-e[0],h-e[1],x,w,b);return n=PO(m,g,y),u=ZO(t,r),s=ZO(n,u),o=JO(u,A),I()}function I(){return c=l=null,E}return E.stream=function(e){return c&&l===e?c:c=eR(function(e){return qO({point:function(t,n){var r=e(t,n);return this.stream.point(r[0],r[1])}})}(n)(_(o(C(l=e)))))},E.preclip=function(e){return arguments.length?(_=e,k=void 0,I()):_},E.postclip=function(e){return arguments.length?(C=e,S=r=a=i=null,I()):C},E.clipAngle=function(e){return arguments.length?(_=+e?RO(k=e*YF):(k=null,FO),I()):k*KF},E.clipExtent=function(e){return arguments.length?(C=null==e?(S=r=a=i=null,jF):zO(S=+e[0][0],r=+e[0][1],a=+e[1][0],i=+e[1][1]),I()):null==S?null:[[S,r],[a,i]]},E.scale=function(e){return arguments.length?(f=+e,T()):f},E.translate=function(e){return arguments.length?(d=+e[0],h=+e[1],T()):[d,h]},E.center=function(e){return arguments.length?(p=e[0]%360*YF,v=e[1]%360*YF,T()):[p*KF,v*KF]},E.rotate=function(e){return arguments.length?(m=e[0]%360*YF,g=e[1]%360*YF,y=e.length>2?e[2]%360*YF:0,T()):[m*KF,g*KF,y*KF]},E.angle=function(e){return arguments.length?(b=e%360*YF,T()):b*KF},E.reflectX=function(e){return arguments.length?(x=e?-1:1,T()):x<0},E.reflectY=function(e){return arguments.length?(w=e?-1:1,T()):w<0},E.precision=function(e){return arguments.length?(o=JO(u,A=e*e),I()):oM(A)},E.fitExtent=function(e,t){return XO(E,e,t)},E.fitSize=function(e,t){return KO(E,e,t)},E.fitWidth=function(e,t){return YO(E,e,t)},E.fitHeight=function(e,t){return $O(E,e,t)},function(){return t=e.apply(this,arguments),E.invert=t.invert&&N,T()}}function aR(e){var t=0,n=qF/3,r=rR(e),a=r(t,n);return a.parallels=function(e){return arguments.length?r(t=e[0]*YF,n=e[1]*YF):[t*KF,n*KF]},a}function iR(e,t){var n=aM(e),r=(n+aM(t))/2;if($F(r)<VF)return function(e){var t=eM(e);function n(e,n){return[e*t,aM(n)/t]}return n.invert=function(e,n){return[e/t,cM(n*t)]},n}(e);var a=1+n*(2*r-n),i=oM(a)/r;function o(e,t){var n=oM(a-2*r*aM(t))/r;return[n*aM(e*=r),i-n*eM(e)]}return o.invert=function(e,t){var n=i-t,o=JF(e,$F(n))*iM(n);return n*r<0&&(o-=qF*iM(e)*iM(n)),[o/r,cM((a-(e*e+n*n)*r*r)/(2*r))]},o}function oR(){return aR(iR).scale(155.424).center([0,33.6442])}function uR(){return oR().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])}function sR(e){return function(t,n){var r=eM(t),a=eM(n),i=e(r*a);return i===1/0?[2,0]:[i*a*aM(t),i*aM(n)]}}function cR(e){return function(t,n){var r=oM(t*t+n*n),a=e(r),i=aM(a),o=eM(a);return[JF(t*i,r*o),cM(r&&n*i/r)]}}var lR=sR((function(e){return oM(2/(1+e))}));lR.invert=cR((function(e){return 2*cM(e/2)}));var fR=sR((function(e){return(e=sM(e))&&e/aM(e)}));function dR(e,t){return[e,nM(uM((GF+t)/2))]}function hR(e){var t,n,r,a=nR(e),i=a.center,o=a.scale,u=a.translate,s=a.clipExtent,c=null;function l(){var i=qF*o(),u=a(function(e){function t(t){return(t=e(t[0]*YF,t[1]*YF))[0]*=KF,t[1]*=KF,t}return e=PO(e[0]*YF,e[1]*YF,e.length>2?e[2]*YF:0),t.invert=function(t){return(t=e.invert(t[0]*YF,t[1]*YF))[0]*=KF,t[1]*=KF,t},t}(a.rotate()).invert([0,0]));return s(null==c?[[u[0]-i,u[1]-i],[u[0]+i,u[1]+i]]:e===dR?[[Math.max(u[0]-i,c),t],[Math.min(u[0]+i,n),r]]:[[c,Math.max(u[1]-i,t)],[n,Math.min(u[1]+i,r)]])}return a.scale=function(e){return arguments.length?(o(e),l()):o()},a.translate=function(e){return arguments.length?(u(e),l()):u()},a.center=function(e){return arguments.length?(i(e),l()):i()},a.clipExtent=function(e){return arguments.length?(null==e?c=t=n=r=null:(c=+e[0][0],t=+e[0][1],n=+e[1][0],r=+e[1][1]),l()):null==c?null:[[c,t],[n,r]]},l()}function pR(e){return uM((GF+e)/2)}function vR(e,t){var n=eM(e),r=e===t?aM(e):nM(n/eM(t))/nM(pR(t)/pR(e)),a=n*rM(pR(e),r)/r;if(!r)return dR;function i(e,t){a>0?t<-GF+VF&&(t=-GF+VF):t>GF-VF&&(t=GF-VF);var n=a/rM(pR(t),r);return[n*aM(r*e),a-n*eM(r*e)]}return i.invert=function(e,t){var n=a-t,i=iM(r)*oM(e*e+n*n),o=JF(e,$F(n))*iM(n);return n*r<0&&(o-=qF*iM(e)*iM(n)),[o/r,2*QF(rM(a/i,1/r))-GF]},i}function mR(e,t){return[e,t]}function gR(e,t){var n=eM(e),r=e===t?aM(e):(n-eM(t))/(t-e),a=n/r+e;if($F(r)<VF)return mR;function i(e,t){var n=a-t,i=r*e;return[n*aM(i),a-n*eM(i)]}return i.invert=function(e,t){var n=a-t,i=JF(e,$F(n))*iM(n);return n*r<0&&(i-=qF*iM(e)*iM(n)),[i/r,a-iM(r)*oM(e*e+n*n)]},i}fR.invert=cR((function(e){return e})),dR.invert=function(e,t){return[e,2*QF(tM(t))-GF]},mR.invert=mR;var yR=1.340264,bR=-.081106,xR=893e-6,wR=.003796,kR=oM(3)/2;function _R(e,t){var n=cM(kR*aM(t)),r=n*n,a=r*r*r;return[e*eM(n)/(kR*(yR+3*bR*r+a*(7*xR+9*wR*r))),n*(yR+bR*r+a*(xR+wR*r))]}function SR(e,t){var n=eM(t),r=eM(e)*n;return[n*aM(e)/r,aM(t)/r]}function CR(e,t){var n=t*t,r=n*n;return[e*(.8707-.131979*n+r*(r*(.003971*n-.001529*r)-.013791)),t*(1.007226+n*(.015085+r*(.028874*n-.044475-.005916*r)))]}function AR(e,t){return[eM(t)*aM(e),aM(t)]}function ER(e,t){var n=eM(t),r=1+eM(e)*n;return[n*aM(e)/r,aM(t)/r]}function NR(e,t){return[nM(uM((GF+t)/2)),-e]}function TR(){}function IR(){var e,t=[];return{point:function(t,n,r){e.push([t,n,r])},lineStart:function(){t.push(e=[])},lineEnd:TR,rejoin:function(){t.length>1&&t.push(t.pop().concat(t.shift()))},result:function(){var n=t;return t=[],e=null,n}}}_R.invert=function(e,t){for(var n,r=t,a=r*r,i=a*a*a,o=0;o<12&&(i=(a=(r-=n=(r*(yR+bR*a+i*(xR+wR*a))-t)/(yR+3*bR*a+i*(7*xR+9*wR*a)))*r)*a*a,!($F(n)<1e-12));++o);return[kR*e*(yR+3*bR*a+i*(7*xR+9*wR*a))/eM(r),cM(aM(r)/kR)]},SR.invert=cR(QF),CR.invert=function(e,t){var n,r=t,a=25;do{var i=r*r,o=i*i;r-=n=(r*(1.007226+i*(.015085+o*(.028874*i-.044475-.005916*o)))-t)/(1.007226+i*(.045255+o*(.259866*i-.311325-.005916*11*o)))}while($F(n)>VF&&--a>0);return[e/(.8707+(i=r*r)*(i*(i*i*i*(.003971-.001529*i)-.013791)-.131979)),r]},AR.invert=cR(cM),ER.invert=cR((function(e){return 2*QF(e)})),NR.invert=function(e,t){return[-t,2*QF(tM(e))-GF]};var DR=1e-6,FR=Math.PI,MR=FR/2,OR=FR/4,RR=2*FR,jR=180/FR,BR=FR/180,zR=Math.abs,ZR=Math.atan,LR=Math.atan2,PR=Math.cos,UR=(Math.ceil,Math.exp,Math.floor,Math.hypot,Math.log,Math.pow,Math.sin),WR=Math.sign||function(e){return e>0?1:e<0?-1:0},VR=Math.sqrt;Math.tan;function qR(e){return e>1?MR:e<-1?-MR:Math.asin(e)}function GR(e,t){return zR(e[0]-t[0])<DR&&zR(e[1]-t[1])<DR}function HR(e,t,n,r){this.x=e,this.z=t,this.o=n,this.e=r,this.v=!1,this.n=this.p=null}function XR(e,t,n,r,a){var i,o,u=[],s=[];if(e.forEach((function(e){if(!((t=e.length-1)<=0)){var t,n,r=e[0],o=e[t];if(GR(r,o)){if(!r[2]&&!o[2]){for(a.lineStart(),i=0;i<t;++i)a.point((r=e[i])[0],r[1]);return void a.lineEnd()}o[0]+=2e-6}u.push(n=new HR(r,e,null,!0)),s.push(n.o=new HR(r,null,n,!1)),u.push(n=new HR(o,e,null,!1)),s.push(n.o=new HR(o,null,n,!0))}})),u.length){for(s.sort(t),KR(u),KR(s),i=0,o=s.length;i<o;++i)s[i].e=n=!n;for(var c,l,f=u[0];;){for(var d=f,h=!0;d.v;)if((d=d.n)===f)return;c=d.z,a.lineStart();do{if(d.v=d.o.v=!0,d.e){if(h)for(i=0,o=c.length;i<o;++i)a.point((l=c[i])[0],l[1]);else r(d.x,d.n.x,1,a);d=d.n}else{if(h)for(c=d.p.z,i=c.length-1;i>=0;--i)a.point((l=c[i])[0],l[1]);else r(d.x,d.p.x,-1,a);d=d.p}c=(d=d.o).z,h=!h}while(!d.v);a.lineEnd()}}}function KR(e){if(t=e.length){for(var t,n,r=0,a=e[0];++r<t;)a.n=n=e[r],n.p=a,a=n;a.n=n=e[0],n.p=a}}var YR=function(){function e(){(0,op.Z)(this,e),this._partials=new Float64Array(32),this._n=0}return(0,up.Z)(e,[{key:"add",value:function(e){for(var t=this._partials,n=0,r=0;r<this._n&&r<32;r++){var a=t[r],i=e+a,o=Math.abs(e)<Math.abs(a)?e-(i-a):a-(i-e);o&&(t[n++]=o),e=i}return t[n]=e,this._n=n+1,this}},{key:"valueOf",value:function(){var e,t,n,r=this._partials,a=this._n,i=0;if(a>0){for(i=r[--a];a>0&&(e=i,!(n=(t=r[--a])-((i=e+t)-e))););a>0&&(n<0&&r[a-1]<0||n>0&&r[a-1]>0)&&(t=2*n)==(e=i+t)-i&&(i=e)}return i}}]),e}();function $R(e){return[LR(e[1],e[0]),qR(e[2])]}function QR(e){var t=e[0],n=e[1],r=PR(n);return[r*PR(t),r*UR(t),UR(n)]}function JR(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function ej(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}function tj(e,t){e[0]+=t[0],e[1]+=t[1],e[2]+=t[2]}function nj(e,t){return[e[0]*t,e[1]*t,e[2]*t]}function rj(e){var t=VR(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]/=t,e[1]/=t,e[2]/=t}function aj(e){return zR(e[0])<=FR?e[0]:WR(e[0])*((zR(e[0])+FR)%RR-FR)}var ij=w().mark(oj);function oj(e){var t,n,r;return w().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:t=(0,Rt.Z)(e),a.prev=1,t.s();case 3:if((n=t.n()).done){a.next=8;break}return r=n.value,a.delegateYield(r,"t0",6);case 6:a.next=3;break;case 8:a.next=13;break;case 10:a.prev=10,a.t1=a.catch(1),t.e(a.t1);case 13:return a.prev=13,t.f(),a.finish(13);case 16:case"end":return a.stop()}}),ij,null,[[1,10,13,16]])}function uj(e){return Array.from(oj(e))}function sj(e,t,n,r){return function(a){var i,o,u,s=t(a),c=IR(),l=t(c),f=!1,d={point:h,lineStart:v,lineEnd:m,polygonStart:function(){d.point=g,d.lineStart=y,d.lineEnd=b,o=[],i=[]},polygonEnd:function(){d.point=h,d.lineStart=v,d.lineEnd=m,o=uj(o);var e=function(e,t){var n=aj(t),r=t[1],a=UR(r),i=[UR(n),-PR(n),0],o=0,u=0,s=new YR;1===a?r=MR+DR:-1===a&&(r=-MR-DR);for(var c=0,l=e.length;c<l;++c)if(d=(f=e[c]).length)for(var f,d,h=f[d-1],p=aj(h),v=h[1]/2+OR,m=UR(v),g=PR(v),y=0;y<d;++y,p=x,m=k,g=_,h=b){var b=f[y],x=aj(b),w=b[1]/2+OR,k=UR(w),_=PR(w),S=x-p,C=S>=0?1:-1,A=C*S,E=A>FR,N=m*k;if(s.add(LR(N*C*UR(A),g*_+N*PR(A))),o+=E?S+C*RR:S,E^p>=n^x>=n){var T=ej(QR(h),QR(b));rj(T);var I=ej(i,T);rj(I);var D=(E^S>=0?-1:1)*qR(I[2]);(r>D||r===D&&(T[0]||T[1]))&&(u+=E^S>=0?1:-1)}}return(o<-1e-6||o<DR&&s<-1e-12)^1&u}(i,r);o.length?(f||(a.polygonStart(),f=!0),XR(o,lj,e,n,a)):e&&(f||(a.polygonStart(),f=!0),a.lineStart(),n(null,null,1,a),a.lineEnd()),f&&(a.polygonEnd(),f=!1),o=i=null},sphere:function(){a.polygonStart(),a.lineStart(),n(null,null,1,a),a.lineEnd(),a.polygonEnd()}};function h(t,n){e(t,n)&&a.point(t,n)}function p(e,t){s.point(e,t)}function v(){d.point=p,s.lineStart()}function m(){d.point=h,s.lineEnd()}function g(e,t){u.push([e,t]),l.point(e,t)}function y(){l.lineStart(),u=[]}function b(){g(u[0][0],u[0][1]),l.lineEnd();var e,t,n,r,s=l.clean(),d=c.result(),h=d.length;if(u.pop(),i.push(u),u=null,h)if(1&s){if((t=(n=d[0]).length-1)>0){for(f||(a.polygonStart(),f=!0),a.lineStart(),e=0;e<t;++e)a.point((r=n[e])[0],r[1]);a.lineEnd()}}else h>1&&2&s&&d.push(d.pop().concat(d.shift())),o.push(d.filter(cj))}return d}}function cj(e){return e.length>1}function lj(e,t){return((e=e.x)[0]<0?e[1]-MR-DR:MR-e[1])-((t=t.x)[0]<0?t[1]-MR-DR:MR-t[1])}var fj=sj((function(){return!0}),(function(e){var t,n=NaN,r=NaN,a=NaN;return{lineStart:function(){e.lineStart(),t=1},point:function(i,o){var u=i>0?FR:-FR,s=zR(i-n);zR(s-FR)<DR?(e.point(n,r=(r+o)/2>0?MR:-MR),e.point(a,r),e.lineEnd(),e.lineStart(),e.point(u,r),e.point(i,r),t=0):a!==u&&s>=FR&&(zR(n-a)<DR&&(n-=a*DR),zR(i-u)<DR&&(i-=u*DR),r=function(e,t,n,r){var a,i,o=UR(e-n);return zR(o)>DR?ZR((UR(t)*(i=PR(r))*UR(n)-UR(r)*(a=PR(t))*UR(e))/(a*i*o)):(t+r)/2}(n,r,i,o),e.point(a,r),e.lineEnd(),e.lineStart(),e.point(u,r),t=0),e.point(n=i,r=o),a=u},lineEnd:function(){e.lineEnd(),n=r=NaN},clean:function(){return 2-t}}}),(function(e,t,n,r){var a;if(null==e)a=n*MR,r.point(-FR,a),r.point(0,a),r.point(FR,a),r.point(FR,0),r.point(FR,-a),r.point(0,-a),r.point(-FR,-a),r.point(-FR,0),r.point(-FR,a);else if(zR(e[0]-t[0])>DR){var i=e[0]<t[0]?FR:-FR;a=n*i/2,r.point(-i,a),r.point(0,a),r.point(i,a)}else r.point(t[0],t[1])}),[-FR,-MR]);function dj(e,t,n,r,a,i){if(n){var o=PR(t),u=UR(t),s=r*n;null==a?(a=t+r*RR,i=t-s/2):(a=hj(o,a),i=hj(o,i),(r>0?a<i:a>i)&&(a+=r*RR));for(var c,l=a;r>0?l>i:l<i;l-=s)c=$R([o,-u*PR(l),-u*UR(l)]),e.point(c[0],c[1])}}function hj(e,t){(t=QR(t))[0]-=e,rj(t);var n=function(e){return e>1?0:e<-1?FR:Math.acos(e)}(-t[1]);return((-t[2]<0?-n:n)+RR-DR)%RR}function pj(e){var t=PR(e),n=6*BR,r=t>0,a=zR(t)>DR;function i(e,n){return PR(e)*PR(n)>t}function o(e,n,r){var a=[1,0,0],i=ej(QR(e),QR(n)),o=JR(i,i),u=i[0],s=o-u*u;if(!s)return!r&&e;var c=t*o/s,l=-t*u/s,f=ej(a,i),d=nj(a,c);tj(d,nj(i,l));var h=f,p=JR(d,h),v=JR(h,h),m=p*p-v*(JR(d,d)-1);if(!(m<0)){var g=VR(m),y=nj(h,(-p-g)/v);if(tj(y,d),y=$R(y),!r)return y;var b,x=e[0],w=n[0],k=e[1],_=n[1];w<x&&(b=x,x=w,w=b);var S=w-x,C=zR(S-FR)<DR;if(!C&&_<k&&(b=k,k=_,_=b),C||S<DR?C?k+_>0^y[1]<(zR(y[0]-x)<DR?k:_):k<=y[1]&&y[1]<=_:S>FR^(x<=y[0]&&y[0]<=w)){var A=nj(h,(-p+g)/v);return tj(A,d),[y,$R(A)]}}}function u(t,n){var a=r?e:FR-e,i=0;return t<-a?i|=1:t>a&&(i|=2),n<-a?i|=4:n>a&&(i|=8),i}return sj(i,(function(e){var t,n,s,c,l;return{lineStart:function(){c=s=!1,l=1},point:function(f,d){var h,p=[f,d],v=i(f,d),m=r?v?0:u(f,d):v?u(f+(f<0?FR:-FR),d):0;if(!t&&(c=s=v)&&e.lineStart(),v!==s&&(!(h=o(t,p))||GR(t,h)||GR(p,h))&&(p[2]=1),v!==s)l=0,v?(e.lineStart(),h=o(p,t),e.point(h[0],h[1])):(h=o(t,p),e.point(h[0],h[1],2),e.lineEnd()),t=h;else if(a&&t&&r^v){var g;m&n||!(g=o(p,t,!0))||(l=0,r?(e.lineStart(),e.point(g[0][0],g[0][1]),e.point(g[1][0],g[1][1]),e.lineEnd()):(e.point(g[1][0],g[1][1]),e.lineEnd(),e.lineStart(),e.point(g[0][0],g[0][1],3)))}!v||t&&GR(t,p)||e.point(p[0],p[1]),t=p,s=v,n=m},lineEnd:function(){s&&e.lineEnd(),t=null},clean:function(){return l|(c&&s)<<1}}}),(function(t,r,a,i){dj(i,e,n,a,t,r)}),r?[0,-e]:[-FR,e-FR])}var vj=1e9,mj=-1e9;function gj(e,t,n,r){function a(a,i){return e<=a&&a<=n&&t<=i&&i<=r}function i(a,i,u,c){var l=0,f=0;if(null==a||(l=o(a,u))!==(f=o(i,u))||s(a,i)<0^u>0)do{c.point(0===l||3===l?e:n,l>1?r:t)}while((l=(l+u+4)%4)!==f);else c.point(i[0],i[1])}function o(r,a){return zR(r[0]-e)<DR?a>0?0:3:zR(r[0]-n)<DR?a>0?2:1:zR(r[1]-t)<DR?a>0?1:0:a>0?3:2}function u(e,t){return s(e.x,t.x)}function s(e,t){var n=o(e,1),r=o(t,1);return n!==r?n-r:0===n?t[1]-e[1]:1===n?e[0]-t[0]:2===n?e[1]-t[1]:t[0]-e[0]}return function(o){var s,c,l,f,d,h,p,v,m,g,y,b=o,x=IR(),w={point:k,lineStart:function(){w.point=_,c&&c.push(l=[]);g=!0,m=!1,p=v=NaN},lineEnd:function(){s&&(_(f,d),h&&m&&x.rejoin(),s.push(x.result()));w.point=k,m&&b.lineEnd()},polygonStart:function(){b=x,s=[],c=[],y=!0},polygonEnd:function(){var t=function(){for(var t=0,n=0,a=c.length;n<a;++n)for(var i,o,u=c[n],s=1,l=u.length,f=u[0],d=f[0],h=f[1];s<l;++s)i=d,o=h,d=(f=u[s])[0],h=f[1],o<=r?h>r&&(d-i)*(r-o)>(h-o)*(e-i)&&++t:h<=r&&(d-i)*(r-o)<(h-o)*(e-i)&&--t;return t}(),n=y&&t,a=(s=uj(s)).length;(n||a)&&(o.polygonStart(),n&&(o.lineStart(),i(null,null,1,o),o.lineEnd()),a&&XR(s,u,t,i,o),o.polygonEnd());b=o,s=c=l=null}};function k(e,t){a(e,t)&&b.point(e,t)}function _(i,o){var u=a(i,o);if(c&&l.push([i,o]),g)f=i,d=o,h=u,g=!1,u&&(b.lineStart(),b.point(i,o));else if(u&&m)b.point(i,o);else{var s=[p=Math.max(mj,Math.min(vj,p)),v=Math.max(mj,Math.min(vj,v))],x=[i=Math.max(mj,Math.min(vj,i)),o=Math.max(mj,Math.min(vj,o))];!function(e,t,n,r,a,i){var o,u=e[0],s=e[1],c=0,l=1,f=t[0]-u,d=t[1]-s;if(o=n-u,f||!(o>0)){if(o/=f,f<0){if(o<c)return;o<l&&(l=o)}else if(f>0){if(o>l)return;o>c&&(c=o)}if(o=a-u,f||!(o<0)){if(o/=f,f<0){if(o>l)return;o>c&&(c=o)}else if(f>0){if(o<c)return;o<l&&(l=o)}if(o=r-s,d||!(o>0)){if(o/=d,d<0){if(o<c)return;o<l&&(l=o)}else if(d>0){if(o>l)return;o>c&&(c=o)}if(o=i-s,d||!(o<0)){if(o/=d,d<0){if(o>l)return;o>c&&(c=o)}else if(d>0){if(o<c)return;o<l&&(l=o)}return c>0&&(e[0]=u+c*f,e[1]=s+c*d),l<1&&(t[0]=u+l*f,t[1]=s+l*d),!0}}}}}(s,x,e,t,n,r)?u&&(b.lineStart(),b.point(i,o),y=!1):(m||(b.lineStart(),b.point(s[0],s[1])),b.point(x[0],x[1]),u||b.lineEnd(),y=!1)}p=i,v=o,m=u}return w}}function yj(e,t){function n(n,r){return n=e(n,r),t(n[0],n[1])}return e.invert&&t.invert&&(n.invert=function(n,r){return(n=t.invert(n,r))&&e.invert(n[0],n[1])}),n}var bj=function(e){return e};function xj(e,t){return[zR(e)>FR?e+Math.round(-e/RR)*RR:e,t]}function wj(e,t,n){return(e%=RR)?t||n?yj(_j(e),Sj(t,n)):_j(e):t||n?Sj(t,n):xj}function kj(e){return function(t,n){return[(t+=e)>FR?t-RR:t<-FR?t+RR:t,n]}}function _j(e){var t=kj(e);return t.invert=kj(-e),t}function Sj(e,t){var n=PR(e),r=UR(e),a=PR(t),i=UR(t);function o(e,t){var o=PR(t),u=PR(e)*o,s=UR(e)*o,c=UR(t),l=c*n+u*r;return[LR(s*a-l*i,u*n-c*r),qR(l*a+s*i)]}return o.invert=function(e,t){var o=PR(t),u=PR(e)*o,s=UR(e)*o,c=UR(t),l=c*a-s*i;return[LR(s*a+c*i,u*n+l*r),qR(l*n-u*r)]},o}function Cj(e){return function(t){var n=new Aj;for(var r in e)n[r]=e[r];return n.stream=t,n}}function Aj(){}function Ej(e,t){e&&Tj.hasOwnProperty(e.type)&&Tj[e.type](e,t)}xj.invert=xj,Aj.prototype={constructor:Aj,point:function(e,t){this.stream.point(e,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};var Nj={Feature:function(e,t){Ej(e.geometry,t)},FeatureCollection:function(e,t){for(var n=e.features,r=-1,a=n.length;++r<a;)Ej(n[r].geometry,t)}},Tj={Sphere:function(e,t){t.sphere()},Point:function(e,t){e=e.coordinates,t.point(e[0],e[1],e[2])},MultiPoint:function(e,t){for(var n=e.coordinates,r=-1,a=n.length;++r<a;)e=n[r],t.point(e[0],e[1],e[2])},LineString:function(e,t){Ij(e.coordinates,t,0)},MultiLineString:function(e,t){for(var n=e.coordinates,r=-1,a=n.length;++r<a;)Ij(n[r],t,0)},Polygon:function(e,t){Dj(e.coordinates,t)},MultiPolygon:function(e,t){for(var n=e.coordinates,r=-1,a=n.length;++r<a;)Dj(n[r],t)},GeometryCollection:function(e,t){for(var n=e.geometries,r=-1,a=n.length;++r<a;)Ej(n[r],t)}};function Ij(e,t,n){var r,a=-1,i=e.length-n;for(t.lineStart();++a<i;)r=e[a],t.point(r[0],r[1],r[2]);t.lineEnd()}function Dj(e,t){var n=-1,r=e.length;for(t.polygonStart();++n<r;)Ij(e[n],t,1);t.polygonEnd()}var Fj=1/0,Mj=Fj,Oj=-Fj,Rj=Oj,jj={point:function(e,t){e<Fj&&(Fj=e);e>Oj&&(Oj=e);t<Mj&&(Mj=t);t>Rj&&(Rj=t)},lineStart:TR,lineEnd:TR,polygonStart:TR,polygonEnd:TR,result:function(){var e=[[Fj,Mj],[Oj,Rj]];return Oj=Rj=-(Mj=Fj=1/0),e}};var Bj=jj;function zj(e,t,n){var r=e.clipExtent&&e.clipExtent();return e.scale(150).translate([0,0]),null!=r&&e.clipExtent(null),function(e,t){e&&Nj.hasOwnProperty(e.type)?Nj[e.type](e,t):Ej(e,t)}(n,e.stream(Bj)),t(Bj.result()),null!=r&&e.clipExtent(r),e}function Zj(e,t,n){return zj(e,(function(n){var r=t[1][0]-t[0][0],a=t[1][1]-t[0][1],i=Math.min(r/(n[1][0]-n[0][0]),a/(n[1][1]-n[0][1])),o=+t[0][0]+(r-i*(n[1][0]+n[0][0]))/2,u=+t[0][1]+(a-i*(n[1][1]+n[0][1]))/2;e.scale(150*i).translate([o,u])}),n)}var Lj=PR(30*BR);function Pj(e,t){return+t?function(e,t){function n(r,a,i,o,u,s,c,l,f,d,h,p,v,m){var g=c-r,y=l-a,b=g*g+y*y;if(b>4*t&&v--){var x=o+d,w=u+h,k=s+p,_=VR(x*x+w*w+k*k),S=qR(k/=_),C=zR(zR(k)-1)<DR||zR(i-f)<DR?(i+f)/2:LR(w,x),A=e(C,S),E=A[0],N=A[1],T=E-r,I=N-a,D=y*T-g*I;(D*D/b>t||zR((g*T+y*I)/b-.5)>.3||o*d+u*h+s*p<Lj)&&(n(r,a,i,o,u,s,E,N,C,x/=_,w/=_,k,v,m),m.point(E,N),n(E,N,C,x,w,k,c,l,f,d,h,p,v,m))}}return function(t){var r,a,i,o,u,s,c,l,f,d,h,p,v={point:m,lineStart:g,lineEnd:b,polygonStart:function(){t.polygonStart(),v.lineStart=x},polygonEnd:function(){t.polygonEnd(),v.lineStart=g}};function m(n,r){n=e(n,r),t.point(n[0],n[1])}function g(){l=NaN,v.point=y,t.lineStart()}function y(r,a){var i=QR([r,a]),o=e(r,a);n(l,f,c,d,h,p,l=o[0],f=o[1],c=r,d=i[0],h=i[1],p=i[2],16,t),t.point(l,f)}function b(){v.point=m,t.lineEnd()}function x(){g(),v.point=w,v.lineEnd=k}function w(e,t){y(r=e,t),a=l,i=f,o=d,u=h,s=p,v.point=y}function k(){n(l,f,c,d,h,p,a,i,r,o,u,s,16,t),v.lineEnd=b,b()}return v}}(e,t):function(e){return Cj({point:function(t,n){t=e(t,n),this.stream.point(t[0],t[1])}})}(e)}var Uj=Cj({point:function(e,t){this.stream.point(e*BR,t*BR)}});function Wj(e,t,n,r,a,i){if(!i)return function(e,t,n,r,a){function i(i,o){return[t+e*(i*=r),n-e*(o*=a)]}return i.invert=function(i,o){return[(i-t)/e*r,(n-o)/e*a]},i}(e,t,n,r,a);var o=PR(i),u=UR(i),s=o*e,c=u*e,l=o/e,f=u/e,d=(u*n-o*t)/e,h=(u*t+o*n)/e;function p(e,i){return[s*(e*=r)-c*(i*=a)+t,n-c*e-s*i]}return p.invert=function(e,t){return[r*(l*e-f*t+d),a*(h-f*e-l*t)]},p}function Vj(e){return function(e){var t,n,r,a,i,o,u,s,c,l,f=150,d=480,h=250,p=0,v=0,m=0,g=0,y=0,b=0,x=1,w=1,k=null,_=fj,S=null,C=bj,A=.5;function E(e){return s(e[0]*BR,e[1]*BR)}function N(e){return(e=s.invert(e[0],e[1]))&&[e[0]*jR,e[1]*jR]}function T(){var e=Wj(f,0,0,x,w,b).apply(null,t(p,v)),r=Wj(f,d-e[0],h-e[1],x,w,b);return n=wj(m,g,y),u=yj(t,r),s=yj(n,u),o=Pj(u,A),I()}function I(){return c=l=null,E}return E.stream=function(e){return c&&l===e?c:c=Uj(function(e){return Cj({point:function(t,n){var r=e(t,n);return this.stream.point(r[0],r[1])}})}(n)(_(o(C(l=e)))))},E.preclip=function(e){return arguments.length?(_=e,k=void 0,I()):_},E.postclip=function(e){return arguments.length?(C=e,S=r=a=i=null,I()):C},E.clipAngle=function(e){return arguments.length?(_=+e?pj(k=e*BR):(k=null,fj),I()):k*jR},E.clipExtent=function(e){return arguments.length?(C=null==e?(S=r=a=i=null,bj):gj(S=+e[0][0],r=+e[0][1],a=+e[1][0],i=+e[1][1]),I()):null==S?null:[[S,r],[a,i]]},E.scale=function(e){return arguments.length?(f=+e,T()):f},E.translate=function(e){return arguments.length?(d=+e[0],h=+e[1],T()):[d,h]},E.center=function(e){return arguments.length?(p=e[0]%360*BR,v=e[1]%360*BR,T()):[p*jR,v*jR]},E.rotate=function(e){return arguments.length?(m=e[0]%360*BR,g=e[1]%360*BR,y=e.length>2?e[2]%360*BR:0,T()):[m*jR,g*jR,y*jR]},E.angle=function(e){return arguments.length?(b=e%360*BR,T()):b*jR},E.reflectX=function(e){return arguments.length?(x=e?-1:1,T()):x<0},E.reflectY=function(e){return arguments.length?(w=e?-1:1,T()):w<0},E.precision=function(e){return arguments.length?(o=Pj(u,A=e*e),I()):VR(A)},E.fitExtent=function(e,t){return Zj(E,e,t)},E.fitSize=function(e,t){return function(e,t,n){return Zj(e,[[0,0],t],n)}(E,e,t)},E.fitWidth=function(e,t){return function(e,t,n){return zj(e,(function(n){var r=+t,a=r/(n[1][0]-n[0][0]),i=(r-a*(n[1][0]+n[0][0]))/2,o=-a*n[0][1];e.scale(150*a).translate([i,o])}),n)}(E,e,t)},E.fitHeight=function(e,t){return function(e,t,n){return zj(e,(function(n){var r=+t,a=r/(n[1][1]-n[0][1]),i=-a*n[0][0],o=(r-a*(n[1][1]+n[0][1]))/2;e.scale(150*a).translate([i,o])}),n)}(E,e,t)},function(){return t=e.apply(this,arguments),E.invert=t.invert&&N,T()}}((function(){return e}))()}var qj=Math.abs,Gj=(Math.atan,Math.atan2,Math.ceil,Math.cos),Hj=(Math.exp,Math.floor,Math.log,Math.max,Math.min,Math.pow,Math.round,Math.sign,Math.sin),Xj=(Math.tan,Math.PI),Kj=Xj/2,Yj=(Math.SQRT1_2,Qj(2));Qj(Xj);function $j(e){return e>1?Kj:e<-1?-Kj:Math.asin(e)}function Qj(e){return e>0?Math.sqrt(e):0}function Jj(e,t){var n,r=e*Hj(t),a=30;do{t-=n=(t+Hj(t)-r)/(1+Gj(t))}while(qj(n)>1e-6&&--a>0);return t/2}var eB=function(e,t,n){function r(r,a){return[e*r*Gj(a=Jj(n,a)),t*Hj(a)]}return r.invert=function(r,a){return a=$j(a/t),[r/(e*Gj(a)),$j((2*a+Hj(2*a))/n)]},r}(Yj/Kj,Yj,Xj);var tB=dO(),nB=["clipAngle","clipExtent","scale","translate","center","rotate","parallels","precision","reflectX","reflectY","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"];function rB(e,t){return function n(){var r=t();return r.type=e,r.path=dO().projection(r),r.copy=r.copy||function(){var e=n();return nB.forEach((function(t){r[t]&&e[t](r[t]())})),e.path.pointRadius(r.path.pointRadius()),e},r}}function aB(e,t){if(!e||"string"!==typeof e)throw new Error("Projection type must be a name string.");return e=e.toLowerCase(),arguments.length>1?(oB[e]=rB(e,t),this):oB[e]||null}function iB(e){return e&&e.path||tB}var oB={albers:uR,albersusa:function(){var e,t,n,r,a,i,o=uR(),u=oR().rotate([154,0]).center([-2,58.5]).parallels([55,65]),s=oR().rotate([157,0]).center([-3,19.9]).parallels([8,18]),c={point:function(e,t){i=[e,t]}};function l(e){var t=e[0],o=e[1];return i=null,n.point(t,o),i||(r.point(t,o),i)||(a.point(t,o),i)}function f(){return e=t=null,l}return l.invert=function(e){var t=o.scale(),n=o.translate(),r=(e[0]-n[0])/t,a=(e[1]-n[1])/t;return(a>=.12&&a<.234&&r>=-.425&&r<-.214?u:a>=.166&&a<.234&&r>=-.214&&r<-.115?s:o).invert(e)},l.stream=function(n){return e&&t===n?e:e=function(e){var t=e.length;return{point:function(n,r){for(var a=-1;++a<t;)e[a].point(n,r)},sphere:function(){for(var n=-1;++n<t;)e[n].sphere()},lineStart:function(){for(var n=-1;++n<t;)e[n].lineStart()},lineEnd:function(){for(var n=-1;++n<t;)e[n].lineEnd()},polygonStart:function(){for(var n=-1;++n<t;)e[n].polygonStart()},polygonEnd:function(){for(var n=-1;++n<t;)e[n].polygonEnd()}}}([o.stream(t=n),u.stream(n),s.stream(n)])},l.precision=function(e){return arguments.length?(o.precision(e),u.precision(e),s.precision(e),f()):o.precision()},l.scale=function(e){return arguments.length?(o.scale(e),u.scale(.35*e),s.scale(e),l.translate(o.translate())):o.scale()},l.translate=function(e){if(!arguments.length)return o.translate();var t=o.scale(),i=+e[0],l=+e[1];return n=o.translate(e).clipExtent([[i-.455*t,l-.238*t],[i+.455*t,l+.238*t]]).stream(c),r=u.translate([i-.307*t,l+.201*t]).clipExtent([[i-.425*t+VF,l+.12*t+VF],[i-.214*t-VF,l+.234*t-VF]]).stream(c),a=s.translate([i-.205*t,l+.212*t]).clipExtent([[i-.214*t+VF,l+.166*t+VF],[i-.115*t-VF,l+.234*t-VF]]).stream(c),f()},l.fitExtent=function(e,t){return XO(l,e,t)},l.fitSize=function(e,t){return KO(l,e,t)},l.fitWidth=function(e,t){return YO(l,e,t)},l.fitHeight=function(e,t){return $O(l,e,t)},l.scale(1070)},azimuthalequalarea:function(){return nR(lR).scale(124.75).clipAngle(179.999)},azimuthalequidistant:function(){return nR(fR).scale(79.4188).clipAngle(179.999)},conicconformal:function(){return aR(vR).scale(109.5).parallels([30,30])},conicequalarea:oR,conicequidistant:function(){return aR(gR).scale(131.154).center([0,13.9389])},equalEarth:function(){return nR(_R).scale(177.158)},equirectangular:function(){return nR(mR).scale(152.63)},gnomonic:function(){return nR(SR).scale(144.049).clipAngle(60)},identity:function(){var e,t,n,r,a,i,o,u=1,s=0,c=0,l=1,f=1,d=0,h=null,p=1,v=1,m=qO({point:function(e,t){var n=b([e,t]);this.stream.point(n[0],n[1])}}),g=jF;function y(){return p=u*l,v=u*f,i=o=null,b}function b(n){var r=n[0]*p,a=n[1]*v;if(d){var i=a*e-r*t;r=r*e+a*t,a=i}return[r+s,a+c]}return b.invert=function(n){var r=n[0]-s,a=n[1]-c;if(d){var i=a*e+r*t;r=r*e-a*t,a=i}return[r/p,a/v]},b.stream=function(e){return i&&o===e?i:i=m(g(o=e))},b.postclip=function(e){return arguments.length?(g=e,h=n=r=a=null,y()):g},b.clipExtent=function(e){return arguments.length?(g=null==e?(h=n=r=a=null,jF):zO(h=+e[0][0],n=+e[0][1],r=+e[1][0],a=+e[1][1]),y()):null==h?null:[[h,n],[r,a]]},b.scale=function(e){return arguments.length?(u=+e,y()):u},b.translate=function(e){return arguments.length?(s=+e[0],c=+e[1],y()):[s,c]},b.angle=function(n){return arguments.length?(t=aM(d=n%360*YF),e=eM(d),y()):d*KF},b.reflectX=function(e){return arguments.length?(l=e?-1:1,y()):l<0},b.reflectY=function(e){return arguments.length?(f=e?-1:1,y()):f<0},b.fitExtent=function(e,t){return XO(b,e,t)},b.fitSize=function(e,t){return KO(b,e,t)},b.fitWidth=function(e,t){return YO(b,e,t)},b.fitHeight=function(e,t){return $O(b,e,t)},b},mercator:function(){return hR(dR).scale(961/XF)},mollweide:function(){return Vj(eB).scale(169.529)},naturalEarth1:function(){return nR(CR).scale(175.295)},orthographic:function(){return nR(AR).scale(249.5).clipAngle(90.000001)},stereographic:function(){return nR(ER).scale(250).clipAngle(142)},transversemercator:function(){var e=hR(NR),t=e.center,n=e.rotate;return e.center=function(e){return arguments.length?t([-e[1],e[0]]):[(e=t())[1],-e[0]]},e.rotate=function(e){return arguments.length?n([e[0],e[1],e.length>2?e[2]+90:90]):[(e=n())[0],e[1],e[2]-90]},n([0,0,90]).scale(159.155)}};for(var uB in oB)aB(uB,oB[uB]);var sB=1e-6,cB=(Math.PI,Math.abs),lB=(Math.atan,Math.atan2,Math.cos,Math.ceil);Math.exp,Math.floor,Math.hypot,Math.log,Math.pow,Math.sin,Math.sign,Math.sqrt,Math.tan;function fB(e,t,n){var r=OF(e,t-sB,n).concat(t);return function(e){return r.map((function(t){return[e,t]}))}}function dB(e,t,n){var r=OF(e,t-sB,n).concat(t);return function(e){return r.map((function(t){return[t,e]}))}}function hB(){var e,t,n,r,a,i,o,u,s,c,l,f,d=10,h=d,p=90,v=360,m=2.5;function g(){return{type:"MultiLineString",coordinates:y()}}function y(){return OF(lB(r/p)*p,n,p).map(l).concat(OF(lB(u/v)*v,o,v).map(f)).concat(OF(lB(t/d)*d,e,d).filter((function(e){return cB(e%p)>sB})).map(s)).concat(OF(lB(i/h)*h,a,h).filter((function(e){return cB(e%v)>sB})).map(c))}return g.lines=function(){return y().map((function(e){return{type:"LineString",coordinates:e}}))},g.outline=function(){return{type:"Polygon",coordinates:[l(r).concat(f(o).slice(1),l(n).reverse().slice(1),f(u).reverse().slice(1))]}},g.extent=function(e){return arguments.length?g.extentMajor(e).extentMinor(e):g.extentMinor()},g.extentMajor=function(e){return arguments.length?(r=+e[0][0],n=+e[1][0],u=+e[0][1],o=+e[1][1],r>n&&(e=r,r=n,n=e),u>o&&(e=u,u=o,o=e),g.precision(m)):[[r,u],[n,o]]},g.extentMinor=function(n){return arguments.length?(t=+n[0][0],e=+n[1][0],i=+n[0][1],a=+n[1][1],t>e&&(n=t,t=e,e=n),i>a&&(n=i,i=a,a=n),g.precision(m)):[[t,i],[e,a]]},g.step=function(e){return arguments.length?g.stepMajor(e).stepMinor(e):g.stepMinor()},g.stepMajor=function(e){return arguments.length?(p=+e[0],v=+e[1],g):[p,v]},g.stepMinor=function(e){return arguments.length?(d=+e[0],h=+e[1],g):[d,h]},g.precision=function(d){return arguments.length?(m=+d,s=fB(i,a,90),c=dB(t,e,m),l=fB(u,o,90),f=dB(r,n,m),g):m},g.extentMajor([[-180,-89.999999],[180,89.999999]]).extentMinor([[-180,-80.000001],[180,80.000001]])}function pB(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function vB(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function mB(){}var gB=.7,yB=1.4285714285714286,bB="\\s*([+-]?\\d+)\\s*",xB="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",wB="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",kB=/^#([0-9a-f]{3,8})$/,_B=new RegExp("^rgb\\("+[bB,bB,bB]+"\\)$"),SB=new RegExp("^rgb\\("+[wB,wB,wB]+"\\)$"),CB=new RegExp("^rgba\\("+[bB,bB,bB,xB]+"\\)$"),AB=new RegExp("^rgba\\("+[wB,wB,wB,xB]+"\\)$"),EB=new RegExp("^hsl\\("+[xB,wB,wB]+"\\)$"),NB=new RegExp("^hsla\\("+[xB,wB,wB,xB]+"\\)$"),TB={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function IB(){return this.rgb().formatHex()}function DB(){return this.rgb().formatRgb()}function FB(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=kB.exec(e))?(n=t[1].length,t=parseInt(t[1],16),6===n?MB(t):3===n?new BB(t>>8&15|t>>4&240,t>>4&15|240&t,(15&t)<<4|15&t,1):8===n?OB(t>>24&255,t>>16&255,t>>8&255,(255&t)/255):4===n?OB(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|240&t,((15&t)<<4|15&t)/255):null):(t=_B.exec(e))?new BB(t[1],t[2],t[3],1):(t=SB.exec(e))?new BB(255*t[1]/100,255*t[2]/100,255*t[3]/100,1):(t=CB.exec(e))?OB(t[1],t[2],t[3],t[4]):(t=AB.exec(e))?OB(255*t[1]/100,255*t[2]/100,255*t[3]/100,t[4]):(t=EB.exec(e))?PB(t[1],t[2]/100,t[3]/100,1):(t=NB.exec(e))?PB(t[1],t[2]/100,t[3]/100,t[4]):TB.hasOwnProperty(e)?MB(TB[e]):"transparent"===e?new BB(NaN,NaN,NaN,0):null}function MB(e){return new BB(e>>16&255,e>>8&255,255&e,1)}function OB(e,t,n,r){return r<=0&&(e=t=n=NaN),new BB(e,t,n,r)}function RB(e){return e instanceof mB||(e=FB(e)),e?new BB((e=e.rgb()).r,e.g,e.b,e.opacity):new BB}function jB(e,t,n,r){return 1===arguments.length?RB(e):new BB(e,t,n,null==r?1:r)}function BB(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}function zB(){return"#"+LB(this.r)+LB(this.g)+LB(this.b)}function ZB(){var e=this.opacity;return(1===(e=isNaN(e)?1:Math.max(0,Math.min(1,e)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===e?")":", "+e+")")}function LB(e){return((e=Math.max(0,Math.min(255,Math.round(e)||0)))<16?"0":"")+e.toString(16)}function PB(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new WB(e,t,n,r)}function UB(e){if(e instanceof WB)return new WB(e.h,e.s,e.l,e.opacity);if(e instanceof mB||(e=FB(e)),!e)return new WB;if(e instanceof WB)return e;var t=(e=e.rgb()).r/255,n=e.g/255,r=e.b/255,a=Math.min(t,n,r),i=Math.max(t,n,r),o=NaN,u=i-a,s=(i+a)/2;return u?(o=t===i?(n-r)/u+6*(n<r):n===i?(r-t)/u+2:(t-n)/u+4,u/=s<.5?i+a:2-i-a,o*=60):u=s>0&&s<1?0:o,new WB(o,u,s,e.opacity)}function WB(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}function VB(e,t,n){return 255*(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)}function qB(){}pB(mB,FB,{copy:function(e){return Object.assign(new this.constructor,this,e)},displayable:function(){return this.rgb().displayable()},hex:IB,formatHex:IB,formatHsl:function(){return UB(this).formatHsl()},formatRgb:DB,toString:DB}),pB(BB,jB,vB(mB,{brighter:function(e){return e=null==e?yB:Math.pow(yB,e),new BB(this.r*e,this.g*e,this.b*e,this.opacity)},darker:function(e){return e=null==e?gB:Math.pow(gB,e),new BB(this.r*e,this.g*e,this.b*e,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:zB,formatHex:zB,formatRgb:ZB,toString:ZB})),pB(WB,(function(e,t,n,r){return 1===arguments.length?UB(e):new WB(e,t,n,null==r?1:r)}),vB(mB,{brighter:function(e){return e=null==e?yB:Math.pow(yB,e),new WB(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=null==e?gB:Math.pow(gB,e),new WB(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=this.h%360+360*(this.h<0),t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,a=2*n-r;return new BB(VB(e>=240?e-240:e+120,a,r),VB(e,a,r),VB(e<120?e+240:e-120,a,r),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var e=this.opacity;return(1===(e=isNaN(e)?1:Math.max(0,Math.min(1,e)))?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(1===e?")":", "+e+")")}}));var GB=[[],[[[1,1.5],[.5,1]]],[[[1.5,1],[1,1.5]]],[[[1.5,1],[.5,1]]],[[[1,.5],[1.5,1]]],[[[1,1.5],[.5,1]],[[1,.5],[1.5,1]]],[[[1,.5],[1,1.5]]],[[[1,.5],[.5,1]]],[[[.5,1],[1,.5]]],[[[1,1.5],[1,.5]]],[[[.5,1],[1,.5]],[[1.5,1],[1,1.5]]],[[[1.5,1],[1,.5]]],[[[.5,1],[1.5,1]]],[[[1,1.5],[1.5,1]]],[[[.5,1],[1,1.5]]],[]];function HB(){var e=1,t=1,n=o;function r(e,t){return t.map((function(t){return a(e,t)}))}function a(r,a){var o=[],u=[];return function(n,r,a){var o,u,s,c,l,f,d=new Array,h=new Array;o=u=-1,c=n[0]>=r,GB[c<<1].forEach(p);for(;++o<e-1;)s=c,c=n[o+1]>=r,GB[s|c<<1].forEach(p);GB[c<<0].forEach(p);for(;++u<t-1;){for(o=-1,c=n[u*e+e]>=r,l=n[u*e]>=r,GB[c<<1|l<<2].forEach(p);++o<e-1;)s=c,c=n[u*e+e+o+1]>=r,f=l,l=n[u*e+o+1]>=r,GB[s|c<<1|l<<2|f<<3].forEach(p);GB[c|l<<3].forEach(p)}o=-1,l=n[u*e]>=r,GB[l<<2].forEach(p);for(;++o<e-1;)f=l,l=n[u*e+o+1]>=r,GB[l<<2|f<<3].forEach(p);function p(e){var t,n,r=[e[0][0]+o,e[0][1]+u],s=[e[1][0]+o,e[1][1]+u],c=i(r),l=i(s);(t=h[c])?(n=d[l])?(delete h[t.end],delete d[n.start],t===n?(t.ring.push(s),a(t.ring)):d[t.start]=h[n.end]={start:t.start,end:n.end,ring:t.ring.concat(n.ring)}):(delete h[t.end],t.ring.push(s),h[t.end=l]=t):(t=d[l])?(n=h[c])?(delete d[t.start],delete h[n.end],t===n?(t.ring.push(s),a(t.ring)):d[n.start]=h[t.end]={start:n.start,end:t.end,ring:n.ring.concat(t.ring)}):(delete d[t.start],t.ring.unshift(r),d[t.start=c]=t):d[c]=h[l]={start:c,end:l,ring:[r,s]}}GB[l<<3].forEach(p)}(r,a,(function(e){n(e,r,a),function(e){var t=0,n=e.length,r=e[n-1][1]*e[0][0]-e[n-1][0]*e[0][1];for(;++t<n;)r+=e[t-1][1]*e[t][0]-e[t-1][0]*e[t][1];return r}(e)>0?o.push([e]):u.push(e)})),u.forEach((function(e){for(var t,n=0,r=o.length;n<r;++n)if(-1!==XB((t=o[n])[0],e))return void t.push(e)})),{type:"MultiPolygon",value:a,coordinates:o}}function i(t){return 2*t[0]+t[1]*(e+1)*4}function o(n,r,a){n.forEach((function(n){var i,o=n[0],u=n[1],s=0|o,c=0|u,l=r[c*e+s];o>0&&o<e&&s===o&&(i=r[c*e+s-1],n[0]=o+(a-i)/(l-i)-.5),u>0&&u<t&&c===u&&(i=r[(c-1)*e+s],n[1]=u+(a-i)/(l-i)-.5)}))}return r.contour=a,r.size=function(n){if(!arguments.length)return[e,t];var a=Math.floor(n[0]),i=Math.floor(n[1]);return a>=0&&i>=0||ue("invalid size"),e=a,t=i,r},r.smooth=function(e){return arguments.length?(n=e?o:qB,r):n===o},r}function XB(e,t){for(var n,r=-1,a=t.length;++r<a;)if(n=KB(e,t[r]))return n;return 0}function KB(e,t){for(var n=t[0],r=t[1],a=-1,i=0,o=e.length,u=o-1;i<o;u=i++){var s=e[i],c=s[0],l=s[1],f=e[u],d=f[0],h=f[1];if(YB(s,f,t))return 0;l>r!==h>r&&n<(d-c)*(r-l)/(h-l)+c&&(a=-a)}return a}function YB(e,t,n){var r,a,i,o;return function(e,t,n){return(t[0]-e[0])*(n[1]-e[1])===(n[0]-e[0])*(t[1]-e[1])}(e,t,n)&&(a=e[r=+(e[0]===t[0])],i=n[r],o=t[r],a<=i&&i<=o||o<=i&&i<=a)}function $B(e,t,n){return function(r){var a=it(r),i=n?Math.min(a[0],0):a[0],o=a[1],u=o-i,s=t?function(e,t,n){var r=Math.abs(t-e)/Math.max(0,n),a=Math.pow(10,Math.floor(Math.log(r)/Math.LN10)),i=r/a;return i>=DF?a*=10:i>=FF?a*=5:i>=MF&&(a*=2),t<e?-a:a}(i,o,e):u/(e+1);return OF(i+s,o,s)}}function QB(e){wu.call(this,null,e)}function JB(e,t,n,r,a){var i=e.x1||0,o=e.y1||0,u=t*n<0;function s(e){e.forEach(c)}function c(e){u&&e.reverse(),e.forEach(l)}function l(e){e[0]=(e[0]-i)*t+r,e[1]=(e[1]-o)*n+a}return function(e){return e.coordinates.forEach(s),e}}function ez(e,t,n){var r=e>=0?e:Lu(t,n);return Math.round((Math.sqrt(4*r*r+1)-1)/2)}function tz(e){return Ye(e)?e:nt(+e)}function nz(){var e=function(e){return e[0]},t=function(e){return e[1]},n=he,r=[-1,-1],a=960,i=500,o=2;function u(u,s){var c=ez(r[0],u,e)>>o,l=ez(r[1],u,t)>>o,f=c?c+2:0,d=l?l+2:0,h=2*f+(a>>o),p=2*d+(i>>o),v=new Float32Array(h*p),m=new Float32Array(h*p),g=v;u.forEach((function(r){var a=f+(+e(r)>>o),i=d+(+t(r)>>o);a>=0&&a<h&&i>=0&&i<p&&(v[a+i*h]+=+n(r))})),c>0&&l>0?(rz(h,p,v,m,c),az(h,p,m,v,l),rz(h,p,v,m,c),az(h,p,m,v,l),rz(h,p,v,m,c),az(h,p,m,v,l)):c>0?(rz(h,p,v,m,c),rz(h,p,m,v,c),rz(h,p,v,m,c),g=m):l>0&&(az(h,p,v,m,l),az(h,p,m,v,l),az(h,p,v,m,l),g=m);for(var y=s?Math.pow(2,-2*o):1/function(e,t){var n=0;if(void 0===t){var r,a=(0,Rt.Z)(e);try{for(a.s();!(r=a.n()).done;){var i=r.value;(i=+i)&&(n+=i)}}catch(l){a.e(l)}finally{a.f()}}else{var o,u=-1,s=(0,Rt.Z)(e);try{for(s.s();!(o=s.n()).done;){var c=o.value;(c=+t(c,++u,e))&&(n+=c)}}catch(l){s.e(l)}finally{s.f()}}return n}(g),b=0,x=h*p;b<x;++b)g[b]*=y;return{values:g,scale:1<<o,width:h,height:p,x1:f,y1:d,x2:f+(a>>o),y2:d+(i>>o)}}return u.x=function(t){return arguments.length?(e=tz(t),u):e},u.y=function(e){return arguments.length?(t=tz(e),u):t},u.weight=function(e){return arguments.length?(n=tz(e),u):n},u.size=function(e){if(!arguments.length)return[a,i];var t=+e[0],n=+e[1];return t>=0&&n>=0||ue("invalid size"),a=t,i=n,u},u.cellSize=function(e){return arguments.length?((e=+e)>=1||ue("invalid cell size"),o=Math.floor(Math.log(e)/Math.LN2),u):1<<o},u.bandwidth=function(e){return arguments.length?(1===(e=Xe(e)).length&&(e=[+e[0],+e[0]]),2!==e.length&&ue("invalid bandwidth"),r=e,u):r},u}function rz(e,t,n,r,a){for(var i=1+(a<<1),o=0;o<t;++o)for(var u=0,s=0;u<e+a;++u)u<e&&(s+=n[u+o*e]),u>=a&&(u>=i&&(s-=n[u-i+o*e]),r[u-a+o*e]=s/Math.min(u+1,e-1+i-u,i))}function az(e,t,n,r,a){for(var i=1+(a<<1),o=0;o<e;++o)for(var u=0,s=0;u<t+a;++u)u<t&&(s+=n[o+u*e]),u>=a&&(u>=i&&(s-=n[o+(u-i)*e]),r[o+(u-a)*e]=s/Math.min(u+1,t-1+i-u,i))}function iz(e){wu.call(this,null,e)}QB.Definition={type:"Isocontour",metadata:{generates:!0},params:[{name:"field",type:"field"},{name:"thresholds",type:"number",array:!0},{name:"levels",type:"number"},{name:"nice",type:"boolean",default:!1},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"zero",type:"boolean",default:!0},{name:"smooth",type:"boolean",default:!0},{name:"scale",type:"number",expr:!0},{name:"translate",type:"number",array:!0,expr:!0},{name:"as",type:"string",null:!0,default:"contour"}]},dt(QB,wu,{transform:function(e,t){if(this.value&&!t.changed()&&!e.modified())return t.StopPropagation;var n=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=t.materialize(t.SOURCE).source,a=e.field||fe,i=HB().smooth(!1!==e.smooth),o=e.thresholds||function(e,t,n){var r=$B(n.levels||10,n.nice,!1!==n.zero);return"shared"!==n.resolve?r:r(e.map((function(e){return RF(t(e).values)})))}(r,a,e),u=null===e.as?null:e.as||"contour",s=[];return r.forEach((function(t){var n=a(t),r=i.size([n.width,n.height])(n.values,_e(o)?o:o(n.values));!function(e,t,n,r){var a=r.scale||t.scale,i=r.translate||t.translate;Ye(a)&&(a=a(n,r));Ye(i)&&(i=i(n,r));if((1===a||null==a)&&!i)return;var o=(gt(a)?a:a[0])||1,u=(gt(a)?a:a[1])||1,s=i&&i[0]||0,c=i&&i[1]||0;e.forEach(JB(t,o,u,s,c))}(r,n,t,e),r.forEach((function(e){s.push(Po(t,Zo(null!=u?(0,Xn.Z)({},u,e):e)))}))})),this.value&&(n.rem=this.value),this.value=n.source=n.add=s,n}}),iz.Definition={type:"KDE2D",metadata:{generates:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"weight",type:"field"},{name:"groupby",type:"field",array:!0},{name:"cellSize",type:"number"},{name:"bandwidth",type:"number",array:!0,length:2},{name:"counts",type:"boolean",default:!1},{name:"as",type:"string",default:"grid"}]};var oz=["x","y","weight","size","cellSize","bandwidth"];function uz(e,t){return oz.forEach((function(n){return null!=t[n]?e[n](t[n]):0})),e}function sz(e){wu.call(this,null,e)}dt(iz,wu,{transform:function(e,t){if(this.value&&!t.changed()&&!e.modified())return t.StopPropagation;var n,r=t.fork(t.NO_SOURCE|t.NO_FIELDS),a=function(e,t){var n,r,a,i,o,u,s=[],c=function(e){return e(i)};if(null==t)s.push(e);else for(n={},r=0,a=e.length;r<a;++r)i=e[r],(u=n[o=t.map(c)])||(n[o]=u=[],u.dims=o,s.push(u)),u.push(i);return s}(t.materialize(t.SOURCE).source,e.groupby),i=(e.groupby||[]).map(ne),o=uz(nz(),e),u=e.as||"grid";return n=a.map((function(t){return Zo(function(e,t){for(var n=0;n<i.length;++n)e[i[n]]=t[n];return e}((0,Xn.Z)({},u,o(t,e.counts)),t.dims))})),this.value&&(r.rem=this.value),this.value=r.source=r.add=n,r}}),sz.Definition={type:"Contour",metadata:{generates:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"values",type:"number",array:!0},{name:"x",type:"field"},{name:"y",type:"field"},{name:"weight",type:"field"},{name:"cellSize",type:"number"},{name:"bandwidth",type:"number"},{name:"count",type:"number"},{name:"nice",type:"boolean",default:!1},{name:"thresholds",type:"number",array:!0},{name:"smooth",type:"boolean",default:!0}]},dt(sz,wu,{transform:function(e,t){if(this.value&&!t.changed()&&!e.modified())return t.StopPropagation;var n,r,a=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=HB().smooth(!1!==e.smooth),o=e.values,u=e.thresholds||$B(e.count||10,e.nice,!!o),s=e.size;return o||(o=t.materialize(t.SOURCE).source,r=JB(n=uz(nz(),e)(o,!0),n.scale||1,n.scale||1,0,0),s=[n.width,n.height],o=n.values),u=_e(u)?u:u(o),o=i.size(s)(o,u),r&&o.forEach(r),this.value&&(a.rem=this.value),this.value=a.source=a.add=(o||[]).map(Zo),a}});var cz="Feature",lz="FeatureCollection";function fz(e){wu.call(this,null,e)}function dz(e){wu.call(this,null,e)}function hz(e){wu.call(this,null,e)}function pz(e){wu.call(this,null,e)}function vz(e){wu.call(this,[],e),this.generator=hB()}function mz(e){wu.call(this,null,e)}function gz(e){if(!Ye(e))return!1;var t=Ft(re(e));return t.$x||t.$y||t.$value||t.$max}function yz(e){wu.call(this,null,e),this.modified(!0)}function bz(e,t,n){Ye(e[t])&&e[t](n)}function xz(e,t,n,r){if(isNaN(t)||isNaN(n))return e;var a,i,o,u,s,c,l,f,d,h=e._root,p={data:r},v=e._x0,m=e._y0,g=e._x1,y=e._y1;if(!h)return e._root=p,e;for(;h.length;)if((c=t>=(i=(v+g)/2))?v=i:g=i,(l=n>=(o=(m+y)/2))?m=o:y=o,a=h,!(h=h[f=l<<1|c]))return a[f]=p,e;if(u=+e._x.call(null,h.data),s=+e._y.call(null,h.data),t===u&&n===s)return p.next=h,a?a[f]=p:e._root=p,e;do{a=a?a[f]=new Array(4):e._root=new Array(4),(c=t>=(i=(v+g)/2))?v=i:g=i,(l=n>=(o=(m+y)/2))?m=o:y=o}while((f=l<<1|c)===(d=(s>=o)<<1|u>=i));return a[d]=h,a[f]=p,e}function wz(e,t,n,r,a){this.node=e,this.x0=t,this.y0=n,this.x1=r,this.y1=a}function kz(e){return e[0]}function _z(e){return e[1]}function Sz(e,t,n){var r=new Cz(null==t?kz:t,null==n?_z:n,NaN,NaN,NaN,NaN);return null==e?r:r.addAll(e)}function Cz(e,t,n,r,a,i){this._x=e,this._y=t,this._x0=n,this._y0=r,this._x1=a,this._y1=i,this._root=void 0}function Az(e){for(var t={data:e.data},n=t;e=e.next;)n=n.next={data:e.data};return t}fz.Definition={type:"GeoJSON",metadata:{},params:[{name:"fields",type:"field",array:!0,length:2},{name:"geojson",type:"field"}]},dt(fz,wu,{transform:function(e,t){var n,r=this._features,a=this._points,i=e.fields,o=i&&i[0],u=i&&i[1],s=e.geojson||!i&&fe,c=t.ADD;n=e.modified()||t.changed(t.REM)||t.modified(re(s))||o&&t.modified(re(o))||u&&t.modified(re(u)),this.value&&!n||(c=t.SOURCE,this._features=r=[],this._points=a=[]),s&&t.visit(c,(function(e){return r.push(s(e))})),o&&u&&(t.visit(c,(function(e){var t=o(e),n=u(e);null!=t&&null!=n&&(t=+t)===t&&(n=+n)===n&&a.push([t,n])})),r=r.concat({type:cz,geometry:{type:"MultiPoint",coordinates:a}})),this.value={type:lz,features:r}}}),dz.Definition={type:"GeoPath",metadata:{modifies:!0},params:[{name:"projection",type:"projection"},{name:"field",type:"field"},{name:"pointRadius",type:"number",expr:!0},{name:"as",type:"string",default:"path"}]},dt(dz,wu,{transform:function(e,t){var n=t.fork(t.ALL),r=this.value,a=e.field||fe,i=e.as||"path",o=n.SOURCE;!r||e.modified()?(this.value=r=iB(e.projection),n.materialize().reflow()):o=a===fe||t.modified(a.fields)?n.ADD_MOD:n.ADD;var u=function(e,t){var n=e.pointRadius();e.context(null),null!=t&&e.pointRadius(t);return n}(r,e.pointRadius);return n.visit(o,(function(e){return e[i]=r(a(e))})),r.pointRadius(u),n.modifies(i)}}),hz.Definition={type:"GeoPoint",metadata:{modifies:!0},params:[{name:"projection",type:"projection",required:!0},{name:"fields",type:"field",array:!0,required:!0,length:2},{name:"as",type:"string",array:!0,length:2,default:["x","y"]}]},dt(hz,wu,{transform:function(e,t){var n,r=e.projection,a=e.fields[0],i=e.fields[1],o=e.as||["x","y"],u=o[0],s=o[1];function c(e){var t=r([a(e),i(e)]);t?(e[u]=t[0],e[s]=t[1]):(e[u]=void 0,e[s]=void 0)}return e.modified()?t=t.materialize().reflow(!0).visit(t.SOURCE,c):(n=t.modified(a.fields)||t.modified(i.fields),t.visit(n?t.ADD_MOD:t.ADD,c)),t.modifies(o)}}),pz.Definition={type:"GeoShape",metadata:{modifies:!0,nomod:!0},params:[{name:"projection",type:"projection"},{name:"field",type:"field",default:"datum"},{name:"pointRadius",type:"number",expr:!0},{name:"as",type:"string",default:"shape"}]},dt(pz,wu,{transform:function(e,t){var n=t.fork(t.ALL),r=this.value,a=e.as||"shape",i=n.ADD;return r&&!e.modified()||(this.value=r=function(e,t,n){var r=null==n?function(n){return e(t(n))}:function(r){var a=e.pointRadius(),i=e.pointRadius(n)(t(r));return e.pointRadius(a),i};return r.context=function(t){return e.context(t),r},r}(iB(e.projection),e.field||ce("datum"),e.pointRadius),n.materialize().reflow(),i=n.SOURCE),n.visit(i,(function(e){return e[a]=r})),n.modifies(a)}}),vz.Definition={type:"Graticule",metadata:{changes:!0,generates:!0},params:[{name:"extent",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"extentMajor",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"extentMinor",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"step",type:"number",array:!0,length:2},{name:"stepMajor",type:"number",array:!0,length:2,default:[90,360]},{name:"stepMinor",type:"number",array:!0,length:2,default:[10,10]},{name:"precision",type:"number",default:2.5}]},dt(vz,wu,{transform:function(e,t){var n,r=this.value,a=this.generator;if(!r.length||e.modified())for(var i in e)Ye(a[i])&&a[i](e[i]);return n=a(),r.length?t.mod.push(Uo(r[0],n)):t.add.push(Zo(n)),r[0]=n,t}}),mz.Definition={type:"heatmap",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"color",type:"string",expr:!0},{name:"opacity",type:"number",expr:!0},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"as",type:"string",default:"image"}]},dt(mz,wu,{transform:function(e,t){if(!t.changed()&&!e.modified())return t.StopPropagation;var n=t.materialize(t.SOURCE).source,r="shared"===e.resolve,a=e.field||fe,i=function(e,t){var n;Ye(e)?(n=function(n){return e(n,t)},n.dep=gz(e)):e?n=nt(e):(n=function(e){return e.$value/e.$max||0},n.dep=!0);return n}(e.opacity,e),o=function(e,t){var n;Ye(e)?(n=function(n){return jB(e(n,t))},n.dep=gz(e)):n=nt(jB(e||"#888"));return n}(e.color,e),u=e.as||"image",s={$x:0,$y:0,$value:0,$max:r?RF(n.map((function(e){return RF(a(e).values)}))):0};return n.forEach((function(e){var t=a(e),n=at({},e,s);r||(n.$max=RF(t.values||[])),e[u]=function(e,t,n,r){for(var a=e.width,i=e.height,o=e.x1||0,u=e.y1||0,s=e.x2||a,c=e.y2||i,l=e.values,f=l?function(e){return l[e]}:de,d=Ip(s-o,c-u),h=d.getContext("2d"),p=h.getImageData(0,0,s-o,c-u),v=p.data,m=u,g=0;m<c;++m){t.$y=m-u;for(var y=o,b=m*a;y<s;++y,g+=4){t.$x=y-o,t.$value=f(y+b);var x=n(t);v[g+0]=x.r,v[g+1]=x.g,v[g+2]=x.b,v[g+3]=~~(255*r(t))}}return h.putImageData(p,0,0),d}(t,n,o.dep?o:nt(o(n)),i.dep?i:nt(i(n)))})),t.reflow(!0).modifies(u)}}),dt(yz,wu,{transform:function(e,t){var n=this.value;return!n||e.modified("type")?(this.value=n=function(e){var t=aB((e||"mercator").toLowerCase());t||ue("Unrecognized projection type: "+e);return t()}(e.type),nB.forEach((function(t){null!=e[t]&&bz(n,t,e[t])}))):nB.forEach((function(t){e.modified(t)&&bz(n,t,e[t])})),null!=e.pointRadius&&n.path.pointRadius(e.pointRadius),e.fit&&function(e,t){var n=function(e){return 1===(e=Xe(e)).length?e[0]:{type:lz,features:e.reduce((function(e,t){return e.concat(function(e){return e.type===lz?e.features:Xe(e).filter((function(e){return null!=e})).map((function(e){return e.type===cz?e:{type:cz,geometry:e}}))}(t))}),[])}}(t.fit);t.extent?e.fitExtent(t.extent,n):t.size&&e.fitSize(t.size,n)}(n,e),t.fork(t.NO_SOURCE|t.NO_FIELDS)}});var Ez=Sz.prototype=Cz.prototype;function Nz(e){return function(){return e}}function Tz(e){return 1e-6*(e()-.5)}function Iz(e){return e.x+e.vx}function Dz(e){return e.y+e.vy}Ez.copy=function(){var e,t,n=new Cz(this._x,this._y,this._x0,this._y0,this._x1,this._y1),r=this._root;if(!r)return n;if(!r.length)return n._root=Az(r),n;for(e=[{source:r,target:n._root=new Array(4)}];r=e.pop();)for(var a=0;a<4;++a)(t=r.source[a])&&(t.length?e.push({source:t,target:r.target[a]=new Array(4)}):r.target[a]=Az(t));return n},Ez.add=function(e){var t=+this._x.call(null,e),n=+this._y.call(null,e);return xz(this.cover(t,n),t,n,e)},Ez.addAll=function(e){var t,n,r,a,i=e.length,o=new Array(i),u=new Array(i),s=1/0,c=1/0,l=-1/0,f=-1/0;for(n=0;n<i;++n)isNaN(r=+this._x.call(null,t=e[n]))||isNaN(a=+this._y.call(null,t))||(o[n]=r,u[n]=a,r<s&&(s=r),r>l&&(l=r),a<c&&(c=a),a>f&&(f=a));if(s>l||c>f)return this;for(this.cover(s,c).cover(l,f),n=0;n<i;++n)xz(this,o[n],u[n],e[n]);return this},Ez.cover=function(e,t){if(isNaN(e=+e)||isNaN(t=+t))return this;var n=this._x0,r=this._y0,a=this._x1,i=this._y1;if(isNaN(n))a=(n=Math.floor(e))+1,i=(r=Math.floor(t))+1;else{for(var o,u,s=a-n||1,c=this._root;n>e||e>=a||r>t||t>=i;)switch(u=(t<r)<<1|e<n,(o=new Array(4))[u]=c,c=o,s*=2,u){case 0:a=n+s,i=r+s;break;case 1:n=a-s,i=r+s;break;case 2:a=n+s,r=i-s;break;case 3:n=a-s,r=i-s}this._root&&this._root.length&&(this._root=c)}return this._x0=n,this._y0=r,this._x1=a,this._y1=i,this},Ez.data=function(){var e=[];return this.visit((function(t){if(!t.length)do{e.push(t.data)}while(t=t.next)})),e},Ez.extent=function(e){return arguments.length?this.cover(+e[0][0],+e[0][1]).cover(+e[1][0],+e[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]},Ez.find=function(e,t,n){var r,a,i,o,u,s,c,l=this._x0,f=this._y0,d=this._x1,h=this._y1,p=[],v=this._root;for(v&&p.push(new wz(v,l,f,d,h)),null==n?n=1/0:(l=e-n,f=t-n,d=e+n,h=t+n,n*=n);s=p.pop();)if(!(!(v=s.node)||(a=s.x0)>d||(i=s.y0)>h||(o=s.x1)<l||(u=s.y1)<f))if(v.length){var m=(a+o)/2,g=(i+u)/2;p.push(new wz(v[3],m,g,o,u),new wz(v[2],a,g,m,u),new wz(v[1],m,i,o,g),new wz(v[0],a,i,m,g)),(c=(t>=g)<<1|e>=m)&&(s=p[p.length-1],p[p.length-1]=p[p.length-1-c],p[p.length-1-c]=s)}else{var y=e-+this._x.call(null,v.data),b=t-+this._y.call(null,v.data),x=y*y+b*b;if(x<n){var w=Math.sqrt(n=x);l=e-w,f=t-w,d=e+w,h=t+w,r=v.data}}return r},Ez.remove=function(e){if(isNaN(i=+this._x.call(null,e))||isNaN(o=+this._y.call(null,e)))return this;var t,n,r,a,i,o,u,s,c,l,f,d,h=this._root,p=this._x0,v=this._y0,m=this._x1,g=this._y1;if(!h)return this;if(h.length)for(;;){if((c=i>=(u=(p+m)/2))?p=u:m=u,(l=o>=(s=(v+g)/2))?v=s:g=s,t=h,!(h=h[f=l<<1|c]))return this;if(!h.length)break;(t[f+1&3]||t[f+2&3]||t[f+3&3])&&(n=t,d=f)}for(;h.data!==e;)if(r=h,!(h=h.next))return this;return(a=h.next)&&delete h.next,r?(a?r.next=a:delete r.next,this):t?(a?t[f]=a:delete t[f],(h=t[0]||t[1]||t[2]||t[3])&&h===(t[3]||t[2]||t[1]||t[0])&&!h.length&&(n?n[d]=h:this._root=h),this):(this._root=a,this)},Ez.removeAll=function(e){for(var t=0,n=e.length;t<n;++t)this.remove(e[t]);return this},Ez.root=function(){return this._root},Ez.size=function(){var e=0;return this.visit((function(t){if(!t.length)do{++e}while(t=t.next)})),e},Ez.visit=function(e){var t,n,r,a,i,o,u=[],s=this._root;for(s&&u.push(new wz(s,this._x0,this._y0,this._x1,this._y1));t=u.pop();)if(!e(s=t.node,r=t.x0,a=t.y0,i=t.x1,o=t.y1)&&s.length){var c=(r+i)/2,l=(a+o)/2;(n=s[3])&&u.push(new wz(n,c,l,i,o)),(n=s[2])&&u.push(new wz(n,r,l,c,o)),(n=s[1])&&u.push(new wz(n,c,a,i,l)),(n=s[0])&&u.push(new wz(n,r,a,c,l))}return this},Ez.visitAfter=function(e){var t,n=[],r=[];for(this._root&&n.push(new wz(this._root,this._x0,this._y0,this._x1,this._y1));t=n.pop();){var a=t.node;if(a.length){var i,o=t.x0,u=t.y0,s=t.x1,c=t.y1,l=(o+s)/2,f=(u+c)/2;(i=a[0])&&n.push(new wz(i,o,u,l,f)),(i=a[1])&&n.push(new wz(i,l,u,s,f)),(i=a[2])&&n.push(new wz(i,o,f,l,c)),(i=a[3])&&n.push(new wz(i,l,f,s,c))}r.push(t)}for(;t=r.pop();)e(t.node,t.x0,t.y0,t.x1,t.y1);return this},Ez.x=function(e){return arguments.length?(this._x=e,this):this._x},Ez.y=function(e){return arguments.length?(this._y=e,this):this._y};var Fz={value:function(){}};function Mz(){for(var e,t=0,n=arguments.length,r={};t<n;++t){if(!(e=arguments[t]+"")||e in r||/[\s.]/.test(e))throw new Error("illegal type: "+e);r[e]=[]}return new Oz(r)}function Oz(e){this._=e}function Rz(e,t){return e.trim().split(/^|\s+/).map((function(e){var n="",r=e.indexOf(".");if(r>=0&&(n=e.slice(r+1),e=e.slice(0,r)),e&&!t.hasOwnProperty(e))throw new Error("unknown type: "+e);return{type:e,name:n}}))}function jz(e,t){for(var n,r=0,a=e.length;r<a;++r)if((n=e[r]).name===t)return n.value}function Bz(e,t,n){for(var r=0,a=e.length;r<a;++r)if(e[r].name===t){e[r]=Fz,e=e.slice(0,r).concat(e.slice(r+1));break}return null!=n&&e.push({name:t,value:n}),e}Oz.prototype=Mz.prototype={constructor:Oz,on:function(e,t){var n,r=this._,a=Rz(e+"",r),i=-1,o=a.length;if(!(arguments.length<2)){if(null!=t&&"function"!==typeof t)throw new Error("invalid callback: "+t);for(;++i<o;)if(n=(e=a[i]).type)r[n]=Bz(r[n],e.name,t);else if(null==t)for(n in r)r[n]=Bz(r[n],e.name,null);return this}for(;++i<o;)if((n=(e=a[i]).type)&&(n=jz(r[n],e.name)))return n},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new Oz(e)},call:function(e,t){if((n=arguments.length-2)>0)for(var n,r,a=new Array(n),i=0;i<n;++i)a[i]=arguments[i+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(i=0,n=(r=this._[e]).length;i<n;++i)r[i].value.apply(t,a)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var r=this._[e],a=0,i=r.length;a<i;++a)r[a].value.apply(t,n)}};var zz,Zz,Lz=Mz,Pz=0,Uz=0,Wz=0,Vz=0,qz=0,Gz=0,Hz="object"===typeof performance&&performance.now?performance:Date,Xz="object"===typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function Kz(){return qz||(Xz(Yz),qz=Hz.now()+Gz)}function Yz(){qz=0}function $z(){this._call=this._time=this._next=null}function Qz(e,t,n){var r=new $z;return r.restart(e,t,n),r}function Jz(){qz=(Vz=Hz.now())+Gz,Pz=Uz=0;try{!function(){Kz(),++Pz;for(var e,t=zz;t;)(e=qz-t._time)>=0&&t._call.call(null,e),t=t._next;--Pz}()}finally{Pz=0,function(){var e,t,n=zz,r=1/0;for(;n;)n._call?(r>n._time&&(r=n._time),e=n,n=n._next):(t=n._next,n._next=null,n=e?e._next=t:zz=t);Zz=e,tZ(r)}(),qz=0}}function eZ(){var e=Hz.now(),t=e-Vz;t>1e3&&(Gz-=t,Vz=e)}function tZ(e){Pz||(Uz&&(Uz=clearTimeout(Uz)),e-qz>24?(e<1/0&&(Uz=setTimeout(Jz,e-Hz.now()-Gz)),Wz&&(Wz=clearInterval(Wz))):(Wz||(Vz=Hz.now(),Wz=setInterval(eZ,1e3)),Pz=1,Xz(Jz)))}$z.prototype=Qz.prototype={constructor:$z,restart:function(e,t,n){if("function"!==typeof e)throw new TypeError("callback is not a function");n=(null==n?Kz():+n)+(null==t?0:+t),this._next||Zz===this||(Zz?Zz._next=this:zz=this,Zz=this),this._call=e,this._time=n,tZ()},stop:function(){this._call&&(this._call=null,this._time=1/0,tZ())}};var nZ=4294967296;function rZ(e){return e.x}function aZ(e){return e.y}var iZ=Math.PI*(3-Math.sqrt(5));function oZ(e){var t,n=1,r=.001,a=1-Math.pow(r,1/300),i=0,o=.6,u=new Map,s=Qz(f),c=Lz("tick","end"),l=function(){var e=1;return function(){return(e=(1664525*e+1013904223)%nZ)/nZ}}();function f(){d(),c.call("tick",t),n<r&&(s.stop(),c.call("end",t))}function d(r){var s,c,l=e.length;void 0===r&&(r=1);for(var f=0;f<r;++f)for(n+=(i-n)*a,u.forEach((function(e){e(n)})),s=0;s<l;++s)null==(c=e[s]).fx?c.x+=c.vx*=o:(c.x=c.fx,c.vx=0),null==c.fy?c.y+=c.vy*=o:(c.y=c.fy,c.vy=0);return t}function h(){for(var t,n=0,r=e.length;n<r;++n){if((t=e[n]).index=n,null!=t.fx&&(t.x=t.fx),null!=t.fy&&(t.y=t.fy),isNaN(t.x)||isNaN(t.y)){var a=10*Math.sqrt(.5+n),i=n*iZ;t.x=a*Math.cos(i),t.y=a*Math.sin(i)}(isNaN(t.vx)||isNaN(t.vy))&&(t.vx=t.vy=0)}}function p(t){return t.initialize&&t.initialize(e,l),t}return null==e&&(e=[]),h(),t={tick:d,restart:function(){return s.restart(f),t},stop:function(){return s.stop(),t},nodes:function(n){return arguments.length?(e=n,h(),u.forEach(p),t):e},alpha:function(e){return arguments.length?(n=+e,t):n},alphaMin:function(e){return arguments.length?(r=+e,t):r},alphaDecay:function(e){return arguments.length?(a=+e,t):+a},alphaTarget:function(e){return arguments.length?(i=+e,t):i},velocityDecay:function(e){return arguments.length?(o=1-e,t):1-o},randomSource:function(e){return arguments.length?(l=e,u.forEach(p),t):l},force:function(e,n){return arguments.length>1?(null==n?u.delete(e):u.set(e,p(n)),t):u.get(e)},find:function(t,n,r){var a,i,o,u,s,c=0,l=e.length;for(null==r?r=1/0:r*=r,c=0;c<l;++c)(o=(a=t-(u=e[c]).x)*a+(i=n-u.y)*i)<r&&(s=u,r=o);return s},on:function(e,n){return arguments.length>1?(c.on(e,n),t):c.on(e)}}}function uZ(e){return e.index}function sZ(e,t){var n=e.get(t);if(!n)throw new Error("node not found: "+t);return n}var cZ={center:function(e,t){var n,r=1;function a(){var a,i,o=n.length,u=0,s=0;for(a=0;a<o;++a)u+=(i=n[a]).x,s+=i.y;for(u=(u/o-e)*r,s=(s/o-t)*r,a=0;a<o;++a)(i=n[a]).x-=u,i.y-=s}return null==e&&(e=0),null==t&&(t=0),a.initialize=function(e){n=e},a.x=function(t){return arguments.length?(e=+t,a):e},a.y=function(e){return arguments.length?(t=+e,a):t},a.strength=function(e){return arguments.length?(r=+e,a):r},a},collide:function(e){var t,n,r,a=1,i=1;function o(){for(var e,o,s,c,l,f,d,h=t.length,p=0;p<i;++p)for(o=Sz(t,Iz,Dz).visitAfter(u),e=0;e<h;++e)s=t[e],f=n[s.index],d=f*f,c=s.x+s.vx,l=s.y+s.vy,o.visit(v);function v(e,t,n,i,o){var u=e.data,h=e.r,p=f+h;if(!u)return t>c+p||i<c-p||n>l+p||o<l-p;if(u.index>s.index){var v=c-u.x-u.vx,m=l-u.y-u.vy,g=v*v+m*m;g<p*p&&(0===v&&(g+=(v=Tz(r))*v),0===m&&(g+=(m=Tz(r))*m),g=(p-(g=Math.sqrt(g)))/g*a,s.vx+=(v*=g)*(p=(h*=h)/(d+h)),s.vy+=(m*=g)*p,u.vx-=v*(p=1-p),u.vy-=m*p)}}}function u(e){if(e.data)return e.r=n[e.data.index];for(var t=e.r=0;t<4;++t)e[t]&&e[t].r>e.r&&(e.r=e[t].r)}function s(){if(t){var r,a,i=t.length;for(n=new Array(i),r=0;r<i;++r)a=t[r],n[a.index]=+e(a,r,t)}}return"function"!==typeof e&&(e=Nz(null==e?1:+e)),o.initialize=function(e,n){t=e,r=n,s()},o.iterations=function(e){return arguments.length?(i=+e,o):i},o.strength=function(e){return arguments.length?(a=+e,o):a},o.radius=function(t){return arguments.length?(e="function"===typeof t?t:Nz(+t),s(),o):e},o},nbody:function(){var e,t,n,r,a,i=Nz(-30),o=1,u=1/0,s=.81;function c(n){var a,i=e.length,o=Sz(e,rZ,aZ).visitAfter(f);for(r=n,a=0;a<i;++a)t=e[a],o.visit(d)}function l(){if(e){var t,n,r=e.length;for(a=new Array(r),t=0;t<r;++t)n=e[t],a[n.index]=+i(n,t,e)}}function f(e){var t,n,r,i,o,u=0,s=0;if(e.length){for(r=i=o=0;o<4;++o)(t=e[o])&&(n=Math.abs(t.value))&&(u+=t.value,s+=n,r+=n*t.x,i+=n*t.y);e.x=r/s,e.y=i/s}else{(t=e).x=t.data.x,t.y=t.data.y;do{u+=a[t.data.index]}while(t=t.next)}e.value=u}function d(e,i,c,l){if(!e.value)return!0;var f=e.x-t.x,d=e.y-t.y,h=l-i,p=f*f+d*d;if(h*h/s<p)return p<u&&(0===f&&(p+=(f=Tz(n))*f),0===d&&(p+=(d=Tz(n))*d),p<o&&(p=Math.sqrt(o*p)),t.vx+=f*e.value*r/p,t.vy+=d*e.value*r/p),!0;if(!(e.length||p>=u)){(e.data!==t||e.next)&&(0===f&&(p+=(f=Tz(n))*f),0===d&&(p+=(d=Tz(n))*d),p<o&&(p=Math.sqrt(o*p)));do{e.data!==t&&(h=a[e.data.index]*r/p,t.vx+=f*h,t.vy+=d*h)}while(e=e.next)}}return c.initialize=function(t,r){e=t,n=r,l()},c.strength=function(e){return arguments.length?(i="function"===typeof e?e:Nz(+e),l(),c):i},c.distanceMin=function(e){return arguments.length?(o=e*e,c):Math.sqrt(o)},c.distanceMax=function(e){return arguments.length?(u=e*e,c):Math.sqrt(u)},c.theta=function(e){return arguments.length?(s=e*e,c):Math.sqrt(s)},c},link:function(e){var t,n,r,a,i,o,u=uZ,s=function(e){return 1/Math.min(a[e.source.index],a[e.target.index])},c=Nz(30),l=1;function f(r){for(var a=0,u=e.length;a<l;++a)for(var s,c,f,d,h,p,v,m=0;m<u;++m)c=(s=e[m]).source,d=(f=s.target).x+f.vx-c.x-c.vx||Tz(o),h=f.y+f.vy-c.y-c.vy||Tz(o),d*=p=((p=Math.sqrt(d*d+h*h))-n[m])/p*r*t[m],h*=p,f.vx-=d*(v=i[m]),f.vy-=h*v,c.vx+=d*(v=1-v),c.vy+=h*v}function d(){if(r){var o,s,c=r.length,l=e.length,f=new Map(r.map((function(e,t){return[u(e,t,r),e]})));for(o=0,a=new Array(c);o<l;++o)(s=e[o]).index=o,"object"!==typeof s.source&&(s.source=sZ(f,s.source)),"object"!==typeof s.target&&(s.target=sZ(f,s.target)),a[s.source.index]=(a[s.source.index]||0)+1,a[s.target.index]=(a[s.target.index]||0)+1;for(o=0,i=new Array(l);o<l;++o)s=e[o],i[o]=a[s.source.index]/(a[s.source.index]+a[s.target.index]);t=new Array(l),h(),n=new Array(l),p()}}function h(){if(r)for(var n=0,a=e.length;n<a;++n)t[n]=+s(e[n],n,e)}function p(){if(r)for(var t=0,a=e.length;t<a;++t)n[t]=+c(e[t],t,e)}return null==e&&(e=[]),f.initialize=function(e,t){r=e,o=t,d()},f.links=function(t){return arguments.length?(e=t,d(),f):e},f.id=function(e){return arguments.length?(u=e,f):u},f.iterations=function(e){return arguments.length?(l=+e,f):l},f.strength=function(e){return arguments.length?(s="function"===typeof e?e:Nz(+e),h(),f):s},f.distance=function(e){return arguments.length?(c="function"===typeof e?e:Nz(+e),p(),f):c},f},x:function(e){var t,n,r,a=Nz(.1);function i(e){for(var a,i=0,o=t.length;i<o;++i)(a=t[i]).vx+=(r[i]-a.x)*n[i]*e}function o(){if(t){var i,o=t.length;for(n=new Array(o),r=new Array(o),i=0;i<o;++i)n[i]=isNaN(r[i]=+e(t[i],i,t))?0:+a(t[i],i,t)}}return"function"!==typeof e&&(e=Nz(null==e?0:+e)),i.initialize=function(e){t=e,o()},i.strength=function(e){return arguments.length?(a="function"===typeof e?e:Nz(+e),o(),i):a},i.x=function(t){return arguments.length?(e="function"===typeof t?t:Nz(+t),o(),i):e},i},y:function(e){var t,n,r,a=Nz(.1);function i(e){for(var a,i=0,o=t.length;i<o;++i)(a=t[i]).vy+=(r[i]-a.y)*n[i]*e}function o(){if(t){var i,o=t.length;for(n=new Array(o),r=new Array(o),i=0;i<o;++i)n[i]=isNaN(r[i]=+e(t[i],i,t))?0:+a(t[i],i,t)}}return"function"!==typeof e&&(e=Nz(null==e?0:+e)),i.initialize=function(e){t=e,o()},i.strength=function(e){return arguments.length?(a="function"===typeof e?e:Nz(+e),o(),i):a},i.y=function(t){return arguments.length?(e="function"===typeof t?t:Nz(+t),o(),i):e},i}},lZ="forces",fZ=["alpha","alphaMin","alphaTarget","velocityDecay","forces"],dZ=["static","iterations"],hZ=["x","y","vx","vy"];function pZ(e){wu.call(this,null,e)}function vZ(e,t,n,r){var a,i,o,u,s=Xe(t.forces);for(a=0,i=fZ.length;a<i;++a)(o=fZ[a])!==lZ&&t.modified(o)&&e[o](t[o]);for(a=0,i=s.length;a<i;++a)u=lZ+a,(o=n||t.modified(lZ,a)?gZ(s[a]):r&&mZ(s[a],r)?e.force(u):null)&&e.force(u,o);for(i=e.numForces||0;a<i;++a)e.force(lZ+a,null);return e.numForces=s.length,e}function mZ(e,t){var n,r;for(n in e)if(Ye(r=e[n])&&t.modified(re(r)))return 1;return 0}function gZ(e){var t,n;for(n in st(cZ,e.force)||ue("Unrecognized force: "+e.force),t=cZ[e.force](),e)Ye(t[n])&&yZ(t[n],e[n],e);return t}function yZ(e,t,n){e(Ye(t)?function(e){return t(e,n)}:t)}function bZ(e){var t=0,n=e.children,r=n&&n.length;if(r)for(;--r>=0;)t+=n[r].value;else t=1;e.value=t}pZ.Definition={type:"Force",metadata:{modifies:!0},params:[{name:"static",type:"boolean",default:!1},{name:"restart",type:"boolean",default:!1},{name:"iterations",type:"number",default:300},{name:"alpha",type:"number",default:1},{name:"alphaMin",type:"number",default:.001},{name:"alphaTarget",type:"number",default:0},{name:"velocityDecay",type:"number",default:.4},{name:"forces",type:"param",array:!0,params:[{key:{force:"center"},params:[{name:"x",type:"number",default:0},{name:"y",type:"number",default:0}]},{key:{force:"collide"},params:[{name:"radius",type:"number",expr:!0},{name:"strength",type:"number",default:.7},{name:"iterations",type:"number",default:1}]},{key:{force:"nbody"},params:[{name:"strength",type:"number",default:-30},{name:"theta",type:"number",default:.9},{name:"distanceMin",type:"number",default:1},{name:"distanceMax",type:"number"}]},{key:{force:"link"},params:[{name:"links",type:"data"},{name:"id",type:"field"},{name:"distance",type:"number",default:30,expr:!0},{name:"strength",type:"number",expr:!0},{name:"iterations",type:"number",default:1}]},{key:{force:"x"},params:[{name:"strength",type:"number",default:.1},{name:"x",type:"field"}]},{key:{force:"y"},params:[{name:"strength",type:"number",default:.1},{name:"y",type:"field"}]}]},{name:"as",type:"string",array:!0,modify:!1,default:hZ}]},dt(pZ,wu,{transform:function(e,t){var n,r,a=this.value,i=t.changed(t.ADD_REM),o=e.modified(fZ),u=e.iterations||300;if(a?(i&&(t.modifies("index"),a.nodes(t.source)),(o||t.changed(t.MOD))&&vZ(a,e,0,t)):(this.value=a=function(e,t){var n=oZ(e),r=n.stop,a=n.restart,i=!1;return n.stopped=function(){return i},n.restart=function(){return i=!1,a()},n.stop=function(){return i=!0,r()},vZ(n,t,!0).on("end",(function(){return i=!0}))}(t.source,e),a.on("tick",(n=t.dataflow,r=this,function(){return n.touch(r).run()})),e.static||(i=!0,a.tick()),t.modifies("index")),o||i||e.modified(dZ)||t.changed()&&e.restart)if(a.alpha(Math.max(a.alpha(),e.alpha||1)).alphaDecay(1-Math.pow(a.alphaMin(),1/u)),e.static)for(a.stop();--u>=0;)a.tick();else if(a.stopped()&&a.restart(),!i)return t.StopPropagation;return this.finish(e,t)},finish:function(e,t){for(var n,r=t.dataflow,a=this._argops,i=0,o=a.length;i<o;++i)if((n=a[i]).name===lZ&&"link"===n.op._argval.force)for(var u,s=n.op._argops,c=0,l=s.length;c<l;++c)if("links"===s[c].name&&(u=s[c].op.source)){r.pulse(u,r.changeset().reflow());break}return t.reflow(e.modified()).modifies(hZ)}});var xZ=w().mark(wZ);function wZ(){var e,t,n,r,a,i;return w().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:n=[e=this];case 1:t=n.reverse(),n=[];case 2:if(!(e=t.pop())){o.next=8;break}return o.next=5,e;case 5:if(r=e.children)for(a=0,i=r.length;a<i;++a)n.push(r[a]);o.next=2;break;case 8:if(n.length){o.next=1;break}case 9:case"end":return o.stop()}}),xZ,this)}function kZ(e,t){e instanceof Map?(e=[void 0,e],void 0===t&&(t=SZ)):void 0===t&&(t=_Z);for(var n,r,a,i,o,u=new EZ(e),s=[u];n=s.pop();)if((a=t(n.data))&&(o=(a=Array.from(a)).length))for(n.children=a,i=o-1;i>=0;--i)s.push(r=a[i]=new EZ(a[i])),r.parent=n,r.depth=n.depth+1;return u.eachBefore(AZ)}function _Z(e){return e.children}function SZ(e){return Array.isArray(e)?e[1]:null}function CZ(e){void 0!==e.data.value&&(e.value=e.data.value),e.data=e.data.data}function AZ(e){var t=0;do{e.height=t}while((e=e.parent)&&e.height<++t)}function EZ(e){this.data=e,this.depth=this.height=0,this.parent=null}function NZ(e){for(var t,n,r=0,a=(e=function(e){for(var t,n,r=e.length;r;)n=Math.random()*r--|0,t=e[r],e[r]=e[n],e[n]=t;return e}(Array.from(e))).length,i=[];r<a;)t=e[r],n&&DZ(n,t)?++r:(n=MZ(i=TZ(i,t)),r=0);return n}function TZ(e,t){var n,r;if(FZ(t,e))return[t];for(n=0;n<e.length;++n)if(IZ(t,e[n])&&FZ(OZ(e[n],t),e))return[e[n],t];for(n=0;n<e.length-1;++n)for(r=n+1;r<e.length;++r)if(IZ(OZ(e[n],e[r]),t)&&IZ(OZ(e[n],t),e[r])&&IZ(OZ(e[r],t),e[n])&&FZ(RZ(e[n],e[r],t),e))return[e[n],e[r],t];throw new Error}function IZ(e,t){var n=e.r-t.r,r=t.x-e.x,a=t.y-e.y;return n<0||n*n<r*r+a*a}function DZ(e,t){var n=e.r-t.r+1e-9*Math.max(e.r,t.r,1),r=t.x-e.x,a=t.y-e.y;return n>0&&n*n>r*r+a*a}function FZ(e,t){for(var n=0;n<t.length;++n)if(!DZ(e,t[n]))return!1;return!0}function MZ(e){switch(e.length){case 1:return function(e){return{x:e.x,y:e.y,r:e.r}}(e[0]);case 2:return OZ(e[0],e[1]);case 3:return RZ(e[0],e[1],e[2])}}function OZ(e,t){var n=e.x,r=e.y,a=e.r,i=t.x,o=t.y,u=t.r,s=i-n,c=o-r,l=u-a,f=Math.sqrt(s*s+c*c);return{x:(n+i+s/f*l)/2,y:(r+o+c/f*l)/2,r:(f+a+u)/2}}function RZ(e,t,n){var r=e.x,a=e.y,i=e.r,o=t.x,u=t.y,s=t.r,c=n.x,l=n.y,f=n.r,d=r-o,h=r-c,p=a-u,v=a-l,m=s-i,g=f-i,y=r*r+a*a-i*i,b=y-o*o-u*u+s*s,x=y-c*c-l*l+f*f,w=h*p-d*v,k=(p*x-v*b)/(2*w)-r,_=(v*m-p*g)/w,S=(h*b-d*x)/(2*w)-a,C=(d*g-h*m)/w,A=_*_+C*C-1,E=2*(i+k*_+S*C),N=k*k+S*S-i*i,T=-(A?(E+Math.sqrt(E*E-4*A*N))/(2*A):N/E);return{x:r+k+_*T,y:a+S+C*T,r:T}}function jZ(e,t,n){var r,a,i,o,u=e.x-t.x,s=e.y-t.y,c=u*u+s*s;c?(a=t.r+n.r,a*=a,o=e.r+n.r,a>(o*=o)?(r=(c+o-a)/(2*c),i=Math.sqrt(Math.max(0,o/c-r*r)),n.x=e.x-r*u-i*s,n.y=e.y-r*s+i*u):(r=(c+a-o)/(2*c),i=Math.sqrt(Math.max(0,a/c-r*r)),n.x=t.x+r*u-i*s,n.y=t.y+r*s+i*u)):(n.x=t.x+n.r,n.y=t.y)}function BZ(e,t){var n=e.r+t.r-1e-6,r=t.x-e.x,a=t.y-e.y;return n>0&&n*n>r*r+a*a}function zZ(e){var t=e._,n=e.next._,r=t.r+n.r,a=(t.x*n.r+n.x*t.r)/r,i=(t.y*n.r+n.y*t.r)/r;return a*a+i*i}function ZZ(e){this._=e,this.next=null,this.previous=null}function LZ(e){if(!(a=(e=function(e){return"object"===typeof e&&"length"in e?e:Array.from(e)}(e)).length))return 0;var t,n,r,a,i,o,u,s,c,l,f;if((t=e[0]).x=0,t.y=0,!(a>1))return t.r;if(n=e[1],t.x=-n.r,n.x=t.r,n.y=0,!(a>2))return t.r+n.r;jZ(n,t,r=e[2]),t=new ZZ(t),n=new ZZ(n),r=new ZZ(r),t.next=r.previous=n,n.next=t.previous=r,r.next=n.previous=t;e:for(u=3;u<a;++u){jZ(t._,n._,r=e[u]),r=new ZZ(r),s=n.next,c=t.previous,l=n._.r,f=t._.r;do{if(l<=f){if(BZ(s._,r._)){n=s,t.next=n,n.previous=t,--u;continue e}l+=s._.r,s=s.next}else{if(BZ(c._,r._)){(t=c).next=n,n.previous=t,--u;continue e}f+=c._.r,c=c.previous}}while(s!==c.next);for(r.previous=t,r.next=n,t.next=n.previous=n=r,i=zZ(t);(r=r.next)!==n;)(o=zZ(r))<i&&(t=r,i=o);n=t.next}for(t=[n._],r=n;(r=r.next)!==n;)t.push(r._);for(r=NZ(t),u=0;u<a;++u)(t=e[u]).x-=r.x,t.y-=r.y;return r.r}function PZ(e){return null==e?null:UZ(e)}function UZ(e){if("function"!==typeof e)throw new Error;return e}function WZ(){return 0}function VZ(e){return function(){return e}}function qZ(e){return Math.sqrt(e.value)}function GZ(e){return function(t){t.children||(t.r=Math.max(0,+e(t)||0))}}function HZ(e,t){return function(n){if(r=n.children){var r,a,i,o=r.length,u=e(n)*t||0;if(u)for(a=0;a<o;++a)r[a].r+=u;if(i=LZ(r),u)for(a=0;a<o;++a)r[a].r-=u;n.r=i+u}}}function XZ(e){return function(t){var n=t.parent;t.r*=e,n&&(t.x=n.x+e*t.x,t.y=n.y+e*t.y)}}function KZ(e){e.x0=Math.round(e.x0),e.y0=Math.round(e.y0),e.x1=Math.round(e.x1),e.y1=Math.round(e.y1)}function YZ(e,t,n,r,a){for(var i,o=e.children,u=-1,s=o.length,c=e.value&&(r-t)/e.value;++u<s;)(i=o[u]).y0=n,i.y1=a,i.x0=t,i.x1=t+=i.value*c}EZ.prototype=kZ.prototype=(0,Xn.Z)({constructor:EZ,count:function(){return this.eachAfter(bZ)},each:function(e,t){var n,r=-1,a=(0,Rt.Z)(this);try{for(a.s();!(n=a.n()).done;){var i=n.value;e.call(t,i,++r,this)}}catch(o){a.e(o)}finally{a.f()}return this},eachAfter:function(e,t){for(var n,r,a,i=this,o=[i],u=[],s=-1;i=o.pop();)if(u.push(i),n=i.children)for(r=0,a=n.length;r<a;++r)o.push(n[r]);for(;i=u.pop();)e.call(t,i,++s,this);return this},eachBefore:function(e,t){for(var n,r,a=this,i=[a],o=-1;a=i.pop();)if(e.call(t,a,++o,this),n=a.children)for(r=n.length-1;r>=0;--r)i.push(n[r]);return this},find:function(e,t){var n,r=-1,a=(0,Rt.Z)(this);try{for(a.s();!(n=a.n()).done;){var i=n.value;if(e.call(t,i,++r,this))return i}}catch(o){a.e(o)}finally{a.f()}},sum:function(e){return this.eachAfter((function(t){for(var n=+e(t.data)||0,r=t.children,a=r&&r.length;--a>=0;)n+=r[a].value;t.value=n}))},sort:function(e){return this.eachBefore((function(t){t.children&&t.children.sort(e)}))},path:function(e){for(var t=this,n=function(e,t){if(e===t)return e;var n=e.ancestors(),r=t.ancestors(),a=null;e=n.pop(),t=r.pop();for(;e===t;)a=e,e=n.pop(),t=r.pop();return a}(t,e),r=[t];t!==n;)t=t.parent,r.push(t);for(var a=r.length;e!==n;)r.splice(a,0,e),e=e.parent;return r},ancestors:function(){for(var e=this,t=[e];e=e.parent;)t.push(e);return t},descendants:function(){return Array.from(this)},leaves:function(){var e=[];return this.eachBefore((function(t){t.children||e.push(t)})),e},links:function(){var e=this,t=[];return e.each((function(n){n!==e&&t.push({source:n.parent,target:n})})),t},copy:function(){return kZ(this).eachBefore(CZ)}},Symbol.iterator,wZ);var $Z={depth:-1},QZ={};function JZ(e){return e.id}function eL(e){return e.parentId}function tL(){var e=JZ,t=eL;function n(n){var r,a,i,o,u,s,c,l=Array.from(n),f=l.length,d=new Map;for(a=0;a<f;++a)r=l[a],u=l[a]=new EZ(r),null!=(s=e(r,a,n))&&(s+="")&&(c=u.id=s,d.set(c,d.has(c)?QZ:u)),null!=(s=t(r,a,n))&&(s+="")&&(u.parent=s);for(a=0;a<f;++a)if(s=(u=l[a]).parent){if(!(o=d.get(s)))throw new Error("missing: "+s);if(o===QZ)throw new Error("ambiguous: "+s);o.children?o.children.push(u):o.children=[u],u.parent=o}else{if(i)throw new Error("multiple roots");i=u}if(!i)throw new Error("no root");if(i.parent=$Z,i.eachBefore((function(e){e.depth=e.parent.depth+1,--f})).eachBefore(AZ),i.parent=null,f>0)throw new Error("cycle");return i}return n.id=function(t){return arguments.length?(e=UZ(t),n):e},n.parentId=function(e){return arguments.length?(t=UZ(e),n):t},n}function nL(e,t){return e.parent===t.parent?1:2}function rL(e){var t=e.children;return t?t[0]:e.t}function aL(e){var t=e.children;return t?t[t.length-1]:e.t}function iL(e,t,n){var r=n/(t.i-e.i);t.c-=r,t.s+=n,e.c+=r,t.z+=n,t.m+=n}function oL(e,t,n){return e.a.parent===t.parent?e.a:n}function uL(e,t){this._=e,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=t}function sL(e,t){return e.parent===t.parent?1:2}function cL(e,t){return e+t.x}function lL(e,t){return Math.max(e,t.y)}function fL(e,t,n,r,a){for(var i,o=e.children,u=-1,s=o.length,c=e.value&&(a-n)/e.value;++u<s;)(i=o[u]).x0=t,i.x1=r,i.y0=n,i.y1=n+=i.value*c}uL.prototype=Object.create(EZ.prototype);var dL=(1+Math.sqrt(5))/2;function hL(e,t,n,r,a,i){for(var o,u,s,c,l,f,d,h,p,v,m,g=[],y=t.children,b=0,x=0,w=y.length,k=t.value;b<w;){s=a-n,c=i-r;do{l=y[x++].value}while(!l&&x<w);for(f=d=l,m=l*l*(v=Math.max(c/s,s/c)/(k*e)),p=Math.max(d/m,m/f);x<w;++x){if(l+=u=y[x].value,u<f&&(f=u),u>d&&(d=u),m=l*l*v,(h=Math.max(d/m,m/f))>p){l-=u;break}p=h}g.push(o={value:l,dice:s<c,children:y.slice(b,x)}),o.dice?YZ(o,n,r,a,k?r+=c*l/k:i):fL(o,n,r,k?n+=s*l/k:a,i),k-=l,b=x}return g}var pL=function e(t){function n(e,n,r,a,i){hL(t,e,n,r,a,i)}return n.ratio=function(t){return e((t=+t)>1?t:1)},n}(dL),vL=function e(t){function n(e,n,r,a,i){if((o=e._squarify)&&o.ratio===t)for(var o,u,s,c,l,f=-1,d=o.length,h=e.value;++f<d;){for(s=(u=o[f]).children,c=u.value=0,l=s.length;c<l;++c)u.value+=s[c].value;u.dice?YZ(u,n,r,a,h?r+=(i-r)*u.value/h:i):fL(u,n,r,h?n+=(a-n)*u.value/h:a,i),h-=u.value}else e._squarify=o=hL(t,e,n,r,a,i),o.ratio=t}return n.ratio=function(t){return e((t=+t)>1?t:1)},n}(dL);function mL(e,t,n){var r={};return e.each((function(e){var a=e.data;n(a)&&(r[t(a)]=e)})),e.lookup=r,e}function gL(e){wu.call(this,null,e)}gL.Definition={type:"Nest",metadata:{treesource:!0,changes:!0},params:[{name:"keys",type:"field",array:!0},{name:"generate",type:"boolean"}]};var yL=function(e){return e.values};function bL(){var e=[],t={entries:function(e){return r(n(e,0),0)},key:function(n){return e.push(n),t}};function n(t,r){if(r>=e.length)return t;for(var a,i,o,u=t.length,s=e[r++],c={},l={},f=-1;++f<u;)(o=c[a=s(i=t[f])+""])?o.push(i):c[a]=[i];for(a in c)l[a]=n(c[a],r);return l}function r(t,n){if(++n>e.length)return t;var a=[];for(var i in t)a.push({key:i,values:r(t[i],n)});return a}return t}function xL(e){wu.call(this,null,e)}dt(gL,wu,{transform:function(e,t){t.source||ue("Nest transform requires an upstream data source.");var n=e.generate,r=e.modified(),a=t.clone(),i=this.value;return(!i||r||t.changed())&&(i&&i.each((function(e){e.children&&jo(e.data)&&a.rem.push(e.data)})),this.value=i=kZ({values:Xe(e.keys).reduce((function(e,t){return e.key(t),e}),bL()).entries(a.source)},yL),n&&i.each((function(e){e.children&&(e=Zo(e.data),a.add.push(e),a.source.push(e))})),mL(i,Bo,Bo)),a.source.root=i,a}});var wL=function(e,t){return e.parent===t.parent?1:2};dt(xL,wu,{transform:function(e,t){t.source&&t.source.root||ue(this.constructor.name+" transform requires a backing tree data source.");var n=this.layout(e.method),r=this.fields,a=t.source.root,i=e.as||r;e.field?a.sum(e.field):a.count(),e.sort&&a.sort(Wo(e.sort,(function(e){return e.data}))),function(e,t,n){for(var r,a=0,i=t.length;a<i;++a)(r=t[a])in n&&e[r](n[r])}(n,this.params,e),n.separation&&n.separation(!1!==e.separation?wL:he);try{this.value=n(a)}catch(o){ue(o)}return a.each((function(e){return function(e,t,n){for(var r=e.data,a=t.length-1,i=0;i<a;++i)r[n[i]]=e[t[i]];r[n[a]]=e.children?e.children.length:0}(e,r,i)})),t.reflow(e.modified()).modifies(i).modifies("leaf")}});var kL=["x","y","r","depth","children"];function _L(e){xL.call(this,e)}_L.Definition={type:"Pack",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"padding",type:"number",default:0},{name:"radius",type:"field",default:null},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:kL.length,default:kL}]},dt(_L,xL,{layout:function(){var e=null,t=1,n=1,r=WZ;function a(a){return a.x=t/2,a.y=n/2,e?a.eachBefore(GZ(e)).eachAfter(HZ(r,.5)).eachBefore(XZ(1)):a.eachBefore(GZ(qZ)).eachAfter(HZ(WZ,1)).eachAfter(HZ(r,a.r/Math.min(t,n))).eachBefore(XZ(Math.min(t,n)/(2*a.r))),a}return a.radius=function(t){return arguments.length?(e=PZ(t),a):e},a.size=function(e){return arguments.length?(t=+e[0],n=+e[1],a):[t,n]},a.padding=function(e){return arguments.length?(r="function"===typeof e?e:VZ(+e),a):r},a},params:["radius","size","padding"],fields:kL});var SL=["x0","y0","x1","y1","depth","children"];function CL(e){xL.call(this,e)}function AL(e){wu.call(this,null,e)}CL.Definition={type:"Partition",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"padding",type:"number",default:0},{name:"round",type:"boolean",default:!1},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:SL.length,default:SL}]},dt(CL,xL,{layout:function(){var e=1,t=1,n=0,r=!1;function a(a){var i=a.height+1;return a.x0=a.y0=n,a.x1=e,a.y1=t/i,a.eachBefore(function(e,t){return function(r){r.children&&YZ(r,r.x0,e*(r.depth+1)/t,r.x1,e*(r.depth+2)/t);var a=r.x0,i=r.y0,o=r.x1-n,u=r.y1-n;o<a&&(a=o=(a+o)/2),u<i&&(i=u=(i+u)/2),r.x0=a,r.y0=i,r.x1=o,r.y1=u}}(t,i)),r&&a.eachBefore(KZ),a}return a.round=function(e){return arguments.length?(r=!!e,a):r},a.size=function(n){return arguments.length?(e=+n[0],t=+n[1],a):[e,t]},a.padding=function(e){return arguments.length?(n=+e,a):n},a},params:["size","round","padding"],fields:SL}),AL.Definition={type:"Stratify",metadata:{treesource:!0},params:[{name:"key",type:"field",required:!0},{name:"parentKey",type:"field",required:!0}]},dt(AL,wu,{transform:function(e,t){t.source||ue("Stratify transform requires an upstream data source.");var n=this.value,r=e.modified(),a=t.fork(t.ALL).materialize(t.SOURCE),i=!n||r||t.changed(t.ADD_REM)||t.modified(e.key.fields)||t.modified(e.parentKey.fields);return a.source=a.source.slice(),i&&(n=a.source.length?mL(tL().id(e.key).parentId(e.parentKey)(a.source),e.key,pe):mL(tL()([{}]),e.key,e.key)),a.source.root=this.value=n,a}});var EL={tidy:function(){var e=nL,t=1,n=1,r=null;function a(a){var s=function(e){for(var t,n,r,a,i,o=new uL(e,0),u=[o];t=u.pop();)if(r=t._.children)for(t.children=new Array(i=r.length),a=i-1;a>=0;--a)u.push(n=t.children[a]=new uL(r[a],a)),n.parent=t;return(o.parent=new uL(null,0)).children=[o],o}(a);if(s.eachAfter(i),s.parent.m=-s.z,s.eachBefore(o),r)a.eachBefore(u);else{var c=a,l=a,f=a;a.eachBefore((function(e){e.x<c.x&&(c=e),e.x>l.x&&(l=e),e.depth>f.depth&&(f=e)}));var d=c===l?1:e(c,l)/2,h=d-c.x,p=t/(l.x+d+h),v=n/(f.depth||1);a.eachBefore((function(e){e.x=(e.x+h)*p,e.y=e.depth*v}))}return a}function i(t){var n=t.children,r=t.parent.children,a=t.i?r[t.i-1]:null;if(n){!function(e){for(var t,n=0,r=0,a=e.children,i=a.length;--i>=0;)(t=a[i]).z+=n,t.m+=n,n+=t.s+(r+=t.c)}(t);var i=(n[0].z+n[n.length-1].z)/2;a?(t.z=a.z+e(t._,a._),t.m=t.z-i):t.z=i}else a&&(t.z=a.z+e(t._,a._));t.parent.A=function(t,n,r){if(n){for(var a,i=t,o=t,u=n,s=i.parent.children[0],c=i.m,l=o.m,f=u.m,d=s.m;u=aL(u),i=rL(i),u&&i;)s=rL(s),(o=aL(o)).a=t,(a=u.z+f-i.z-c+e(u._,i._))>0&&(iL(oL(u,t,r),t,a),c+=a,l+=a),f+=u.m,c+=i.m,d+=s.m,l+=o.m;u&&!aL(o)&&(o.t=u,o.m+=f-l),i&&!rL(s)&&(s.t=i,s.m+=c-d,r=t)}return r}(t,a,t.parent.A||r[0])}function o(e){e._.x=e.z+e.parent.m,e.m+=e.parent.m}function u(e){e.x*=t,e.y=e.depth*n}return a.separation=function(t){return arguments.length?(e=t,a):e},a.size=function(e){return arguments.length?(r=!1,t=+e[0],n=+e[1],a):r?null:[t,n]},a.nodeSize=function(e){return arguments.length?(r=!0,t=+e[0],n=+e[1],a):r?[t,n]:null},a},cluster:function(){var e=sL,t=1,n=1,r=!1;function a(a){var i,o=0;a.eachAfter((function(t){var n=t.children;n?(t.x=function(e){return e.reduce(cL,0)/e.length}(n),t.y=function(e){return 1+e.reduce(lL,0)}(n)):(t.x=i?o+=e(t,i):0,t.y=0,i=t)}));var u=function(e){for(var t;t=e.children;)e=t[0];return e}(a),s=function(e){for(var t;t=e.children;)e=t[t.length-1];return e}(a),c=u.x-e(u,s)/2,l=s.x+e(s,u)/2;return a.eachAfter(r?function(e){e.x=(e.x-a.x)*t,e.y=(a.y-e.y)*n}:function(e){e.x=(e.x-c)/(l-c)*t,e.y=(1-(a.y?e.y/a.y:1))*n})}return a.separation=function(t){return arguments.length?(e=t,a):e},a.size=function(e){return arguments.length?(r=!1,t=+e[0],n=+e[1],a):r?null:[t,n]},a.nodeSize=function(e){return arguments.length?(r=!0,t=+e[0],n=+e[1],a):r?[t,n]:null},a}},NL=["x","y","depth","children"];function TL(e){xL.call(this,e)}function IL(e){wu.call(this,[],e)}TL.Definition={type:"Tree",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"method",type:"enum",default:"tidy",values:["tidy","cluster"]},{name:"size",type:"number",array:!0,length:2},{name:"nodeSize",type:"number",array:!0,length:2},{name:"separation",type:"boolean",default:!0},{name:"as",type:"string",array:!0,length:NL.length,default:NL}]},dt(TL,xL,{layout:function(e){var t=e||"tidy";if(st(EL,t))return EL[t]();ue("Unrecognized Tree layout method: "+t)},params:["size","nodeSize"],fields:NL}),IL.Definition={type:"TreeLinks",metadata:{tree:!0,generates:!0,changes:!0},params:[]},dt(IL,wu,{transform:function(e,t){var n=this.value,r=t.source&&t.source.root,a=t.fork(t.NO_SOURCE),i={};return r||ue("TreeLinks transform requires a tree data source."),t.changed(t.ADD_REM)?(a.rem=n,t.visit(t.SOURCE,(function(e){return i[Bo(e)]=1})),r.each((function(e){var t=e.data,n=e.parent&&e.parent.data;n&&i[Bo(t)]&&i[Bo(n)]&&a.add.push(Zo({source:n,target:t}))})),this.value=a.add):t.changed(t.MOD)&&(t.visit(t.MOD,(function(e){return i[Bo(e)]=1})),n.forEach((function(e){(i[Bo(e.source)]||i[Bo(e.target)])&&a.mod.push(e)}))),a}});var DL={binary:function(e,t,n,r,a){var i,o,u=e.children,s=u.length,c=new Array(s+1);for(c[0]=o=i=0;i<s;++i)c[i+1]=o+=u[i].value;!function e(t,n,r,a,i,o,s){if(t>=n-1){var l=u[t];return l.x0=a,l.y0=i,l.x1=o,void(l.y1=s)}var f=c[t],d=r/2+f,h=t+1,p=n-1;for(;h<p;){var v=h+p>>>1;c[v]<d?h=v+1:p=v}d-c[h-1]<c[h]-d&&t+1<h&&--h;var m=c[h]-f,g=r-m;if(o-a>s-i){var y=r?(a*g+o*m)/r:o;e(t,h,m,a,i,y,s),e(h,n,g,y,i,o,s)}else{var b=r?(i*g+s*m)/r:s;e(t,h,m,a,i,o,b),e(h,n,g,a,b,o,s)}}(0,s,e.value,t,n,r,a)},dice:YZ,slice:fL,slicedice:function(e,t,n,r,a){(1&e.depth?fL:YZ)(e,t,n,r,a)},squarify:pL,resquarify:vL},FL=["x0","y0","x1","y1","depth","children"];function ML(e){xL.call(this,e)}function OL(e,t,n){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+n)/6)}function RL(e){this._context=e}function jL(){}function BL(e){this._context=e}function zL(e){this._context=e}function ZL(e,t){this._basis=new RL(e),this._beta=t}ML.Definition={type:"Treemap",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"method",type:"enum",default:"squarify",values:["squarify","resquarify","binary","dice","slice","slicedice"]},{name:"padding",type:"number",default:0},{name:"paddingInner",type:"number",default:0},{name:"paddingOuter",type:"number",default:0},{name:"paddingTop",type:"number",default:0},{name:"paddingRight",type:"number",default:0},{name:"paddingBottom",type:"number",default:0},{name:"paddingLeft",type:"number",default:0},{name:"ratio",type:"number",default:1.618033988749895},{name:"round",type:"boolean",default:!1},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:FL.length,default:FL}]},dt(ML,xL,{layout:function(){var e=function(){var e=pL,t=!1,n=1,r=1,a=[0],i=WZ,o=WZ,u=WZ,s=WZ,c=WZ;function l(e){return e.x0=e.y0=0,e.x1=n,e.y1=r,e.eachBefore(f),a=[0],t&&e.eachBefore(KZ),e}function f(t){var n=a[t.depth],r=t.x0+n,l=t.y0+n,f=t.x1-n,d=t.y1-n;f<r&&(r=f=(r+f)/2),d<l&&(l=d=(l+d)/2),t.x0=r,t.y0=l,t.x1=f,t.y1=d,t.children&&(n=a[t.depth+1]=i(t)/2,r+=c(t)-n,l+=o(t)-n,(f-=u(t)-n)<r&&(r=f=(r+f)/2),(d-=s(t)-n)<l&&(l=d=(l+d)/2),e(t,r,l,f,d))}return l.round=function(e){return arguments.length?(t=!!e,l):t},l.size=function(e){return arguments.length?(n=+e[0],r=+e[1],l):[n,r]},l.tile=function(t){return arguments.length?(e=UZ(t),l):e},l.padding=function(e){return arguments.length?l.paddingInner(e).paddingOuter(e):l.paddingInner()},l.paddingInner=function(e){return arguments.length?(i="function"===typeof e?e:VZ(+e),l):i},l.paddingOuter=function(e){return arguments.length?l.paddingTop(e).paddingRight(e).paddingBottom(e).paddingLeft(e):l.paddingTop()},l.paddingTop=function(e){return arguments.length?(o="function"===typeof e?e:VZ(+e),l):o},l.paddingRight=function(e){return arguments.length?(u="function"===typeof e?e:VZ(+e),l):u},l.paddingBottom=function(e){return arguments.length?(s="function"===typeof e?e:VZ(+e),l):s},l.paddingLeft=function(e){return arguments.length?(c="function"===typeof e?e:VZ(+e),l):c},l}();return e.ratio=function(t){var n=e.tile();n.ratio&&e.tile(n.ratio(t))},e.method=function(t){st(DL,t)?e.tile(DL[t]):ue("Unrecognized Treemap layout method: "+t)},e},params:["method","ratio","size","round","padding","paddingInner","paddingOuter","paddingTop","paddingRight","paddingBottom","paddingLeft"],fields:FL}),RL.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:OL(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:OL(this,e,t)}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}},BL.prototype={areaStart:jL,areaEnd:jL,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x2,this._y2),this._context.closePath();break;case 2:this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break;case 3:this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4)}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:OL(this,e,t)}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}},zL.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+e)/6,r=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(n,r):this._context.moveTo(n,r);break;case 3:this._point=4;default:OL(this,e,t)}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}},ZL.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var e=this._x,t=this._y,n=e.length-1;if(n>0)for(var r,a=e[0],i=t[0],o=e[n]-a,u=t[n]-i,s=-1;++s<=n;)r=s/n,this._basis.point(this._beta*e[s]+(1-this._beta)*(a+r*o),this._beta*t[s]+(1-this._beta)*(i+r*u));this._x=this._y=null,this._basis.lineEnd()},point:function(e,t){this._x.push(+e),this._y.push(+t)}};var LL=function e(t){function n(e){return 1===t?new RL(e):new ZL(e,t)}return n.beta=function(t){return e(+t)},n}(.85);function PL(e,t,n){e._context.bezierCurveTo(e._x1+e._k*(e._x2-e._x0),e._y1+e._k*(e._y2-e._y0),e._x2+e._k*(e._x1-t),e._y2+e._k*(e._y1-n),e._x2,e._y2)}function UL(e,t){this._context=e,this._k=(1-t)/6}UL.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:PL(this,this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2,this._x1=e,this._y1=t;break;case 2:this._point=3;default:PL(this,e,t)}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var WL=function e(t){function n(e){return new UL(e,t)}return n.tension=function(t){return e(+t)},n}(0);function VL(e,t){this._context=e,this._k=(1-t)/6}VL.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:PL(this,e,t)}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var qL=function e(t){function n(e){return new VL(e,t)}return n.tension=function(t){return e(+t)},n}(0);function GL(e,t){this._context=e,this._k=(1-t)/6}GL.prototype={areaStart:jL,areaEnd:jL,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:PL(this,e,t)}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var HL=function e(t){function n(e){return new GL(e,t)}return n.tension=function(t){return e(+t)},n}(0),XL=Math.abs,KL=Math.atan2,YL=Math.cos,$L=Math.max,QL=Math.min,JL=Math.sin,eP=Math.sqrt,tP=1e-12,nP=Math.PI,rP=nP/2,aP=2*nP;function iP(e){return e>1?0:e<-1?nP:Math.acos(e)}function oP(e){return e>=1?rP:e<=-1?-rP:Math.asin(e)}function uP(e,t,n){var r=e._x1,a=e._y1,i=e._x2,o=e._y2;if(e._l01_a>tP){var u=2*e._l01_2a+3*e._l01_a*e._l12_a+e._l12_2a,s=3*e._l01_a*(e._l01_a+e._l12_a);r=(r*u-e._x0*e._l12_2a+e._x2*e._l01_2a)/s,a=(a*u-e._y0*e._l12_2a+e._y2*e._l01_2a)/s}if(e._l23_a>tP){var c=2*e._l23_2a+3*e._l23_a*e._l12_a+e._l12_2a,l=3*e._l23_a*(e._l23_a+e._l12_a);i=(i*c+e._x1*e._l23_2a-t*e._l12_2a)/l,o=(o*c+e._y1*e._l23_2a-n*e._l12_2a)/l}e._context.bezierCurveTo(r,a,i,o,e._x2,e._y2)}function sP(e,t){this._context=e,this._alpha=t}sP.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3;default:uP(this,e,t)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var cP=function e(t){function n(e){return t?new sP(e,t):new UL(e,0)}return n.alpha=function(t){return e(+t)},n}(.5);function lP(e,t){this._context=e,this._alpha=t}lP.prototype={areaStart:jL,areaEnd:jL,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:uP(this,e,t)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var fP=function e(t){function n(e){return t?new lP(e,t):new GL(e,0)}return n.alpha=function(t){return e(+t)},n}(.5);function dP(e,t){this._context=e,this._alpha=t}dP.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:uP(this,e,t)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var hP=function e(t){function n(e){return t?new dP(e,t):new VL(e,0)}return n.alpha=function(t){return e(+t)},n}(.5);function pP(e){this._context=e}function vP(e){return new pP(e)}function mP(e){this._context=e}function gP(e){return e<0?-1:1}function yP(e,t,n){var r=e._x1-e._x0,a=t-e._x1,i=(e._y1-e._y0)/(r||a<0&&-0),o=(n-e._y1)/(a||r<0&&-0),u=(i*a+o*r)/(r+a);return(gP(i)+gP(o))*Math.min(Math.abs(i),Math.abs(o),.5*Math.abs(u))||0}function bP(e,t){var n=e._x1-e._x0;return n?(3*(e._y1-e._y0)/n-t)/2:t}function xP(e,t,n){var r=e._x0,a=e._y0,i=e._x1,o=e._y1,u=(i-r)/3;e._context.bezierCurveTo(r+u,a+u*t,i-u,o-u*n,i,o)}function wP(e){this._context=e}function kP(e){this._context=new _P(e)}function _P(e){this._context=e}function SP(e){this._context=e}function CP(e){var t,n,r=e.length-1,a=new Array(r),i=new Array(r),o=new Array(r);for(a[0]=0,i[0]=2,o[0]=e[0]+2*e[1],t=1;t<r-1;++t)a[t]=1,i[t]=4,o[t]=4*e[t]+2*e[t+1];for(a[r-1]=2,i[r-1]=7,o[r-1]=8*e[r-1]+e[r],t=1;t<r;++t)n=a[t]/i[t-1],i[t]-=n,o[t]-=n*o[t-1];for(a[r-1]=o[r-1]/i[r-1],t=r-2;t>=0;--t)a[t]=(o[t]-a[t+1])/i[t];for(i[r-1]=(e[r]+a[r-1])/2,t=0;t<r-1;++t)i[t]=2*e[t+1]-a[t+1];return[a,i]}function AP(e,t){this._context=e,this._t=t}pP.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t)}}},mP.prototype={areaStart:jL,areaEnd:jL,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}},wP.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:xP(this,this._t0,bP(this,this._t0))}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var n=NaN;if(t=+t,(e=+e)!==this._x1||t!==this._y1){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,xP(this,bP(this,n=yP(this,e,t)),n);break;default:xP(this,this._t0,n=yP(this,e,t))}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=n}}},(kP.prototype=Object.create(wP.prototype)).point=function(e,t){wP.prototype.point.call(this,t,e)},_P.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,n,r,a,i){this._context.bezierCurveTo(t,e,r,n,i,a)}},SP.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,n=e.length;if(n)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),2===n)this._context.lineTo(e[1],t[1]);else for(var r=CP(e),a=CP(t),i=0,o=1;o<n;++i,++o)this._context.bezierCurveTo(r[0][i],a[0][i],r[1][i],a[1][i],e[o],t[o]);(this._line||0!==this._line&&1===n)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}},AP.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&2===this._point&&this._context.lineTo(this._x,this._y),(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var n=this._x*(1-this._t)+e*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,t)}}this._x=e,this._y=t}};var EP=Math.PI,NP=2*EP,TP=1e-6,IP=NP-TP;function DP(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function FP(){return new DP}DP.prototype=FP.prototype={constructor:DP,moveTo:function(e,t){this._+="M"+(this._x0=this._x1=+e)+","+(this._y0=this._y1=+t)},closePath:function(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(e,t){this._+="L"+(this._x1=+e)+","+(this._y1=+t)},quadraticCurveTo:function(e,t,n,r){this._+="Q"+ +e+","+ +t+","+(this._x1=+n)+","+(this._y1=+r)},bezierCurveTo:function(e,t,n,r,a,i){this._+="C"+ +e+","+ +t+","+ +n+","+ +r+","+(this._x1=+a)+","+(this._y1=+i)},arcTo:function(e,t,n,r,a){e=+e,t=+t,n=+n,r=+r,a=+a;var i=this._x1,o=this._y1,u=n-e,s=r-t,c=i-e,l=o-t,f=c*c+l*l;if(a<0)throw new Error("negative radius: "+a);if(null===this._x1)this._+="M"+(this._x1=e)+","+(this._y1=t);else if(f>TP)if(Math.abs(l*u-s*c)>TP&&a){var d=n-i,h=r-o,p=u*u+s*s,v=d*d+h*h,m=Math.sqrt(p),g=Math.sqrt(f),y=a*Math.tan((EP-Math.acos((p+f-v)/(2*m*g)))/2),b=y/g,x=y/m;Math.abs(b-1)>TP&&(this._+="L"+(e+b*c)+","+(t+b*l)),this._+="A"+a+","+a+",0,0,"+ +(l*d>c*h)+","+(this._x1=e+x*u)+","+(this._y1=t+x*s)}else this._+="L"+(this._x1=e)+","+(this._y1=t);else;},arc:function(e,t,n,r,a,i){e=+e,t=+t,i=!!i;var o=(n=+n)*Math.cos(r),u=n*Math.sin(r),s=e+o,c=t+u,l=1^i,f=i?r-a:a-r;if(n<0)throw new Error("negative radius: "+n);null===this._x1?this._+="M"+s+","+c:(Math.abs(this._x1-s)>TP||Math.abs(this._y1-c)>TP)&&(this._+="L"+s+","+c),n&&(f<0&&(f=f%NP+NP),f>IP?this._+="A"+n+","+n+",0,1,"+l+","+(e-o)+","+(t-u)+"A"+n+","+n+",0,1,"+l+","+(this._x1=s)+","+(this._y1=c):f>TP&&(this._+="A"+n+","+n+",0,"+ +(f>=EP)+","+l+","+(this._x1=e+n*Math.cos(a))+","+(this._y1=t+n*Math.sin(a))))},rect:function(e,t,n,r){this._+="M"+(this._x0=this._x1=+e)+","+(this._y0=this._y1=+t)+"h"+ +n+"v"+ +r+"h"+-n+"Z"},toString:function(){return this._}};var MP=FP;function OP(e){return function(){return e}}function RP(e){return e.innerRadius}function jP(e){return e.outerRadius}function BP(e){return e.startAngle}function zP(e){return e.endAngle}function ZP(e){return e&&e.padAngle}function LP(e,t,n,r,a,i,o,u){var s=n-e,c=r-t,l=o-a,f=u-i,d=f*s-l*c;if(!(d*d<tP))return[e+(d=(l*(t-i)-f*(e-a))/d)*s,t+d*c]}function PP(e,t,n,r,a,i,o){var u=e-n,s=t-r,c=(o?i:-i)/eP(u*u+s*s),l=c*s,f=-c*u,d=e+l,h=t+f,p=n+l,v=r+f,m=(d+p)/2,g=(h+v)/2,y=p-d,b=v-h,x=y*y+b*b,w=a-i,k=d*v-p*h,_=(b<0?-1:1)*eP($L(0,w*w*x-k*k)),S=(k*b-y*_)/x,C=(-k*y-b*_)/x,A=(k*b+y*_)/x,E=(-k*y+b*_)/x,N=S-m,T=C-g,I=A-m,D=E-g;return N*N+T*T>I*I+D*D&&(S=A,C=E),{cx:S,cy:C,x01:-l,y01:-f,x11:S*(a/w-1),y11:C*(a/w-1)}}Array.prototype.slice;function UP(e){return"object"===typeof e&&"length"in e?e:Array.from(e)}function WP(e){return e[0]}function VP(e){return e[1]}function qP(e,t){var n=OP(!0),r=null,a=vP,i=null;function o(o){var u,s,c,l=(o=UP(o)).length,f=!1;for(null==r&&(i=a(c=MP())),u=0;u<=l;++u)!(u<l&&n(s=o[u],u,o))===f&&((f=!f)?i.lineStart():i.lineEnd()),f&&i.point(+e(s,u,o),+t(s,u,o));if(c)return i=null,c+""||null}return e="function"===typeof e?e:void 0===e?WP:OP(e),t="function"===typeof t?t:void 0===t?VP:OP(t),o.x=function(t){return arguments.length?(e="function"===typeof t?t:OP(+t),o):e},o.y=function(e){return arguments.length?(t="function"===typeof e?e:OP(+e),o):t},o.defined=function(e){return arguments.length?(n="function"===typeof e?e:OP(!!e),o):n},o.curve=function(e){return arguments.length?(a=e,null!=r&&(i=a(r)),o):a},o.context=function(e){return arguments.length?(null==e?r=i=null:i=a(r=e),o):r},o}function GP(e,t,n){var r=null,a=OP(!0),i=null,o=vP,u=null;function s(s){var c,l,f,d,h,p=(s=UP(s)).length,v=!1,m=new Array(p),g=new Array(p);for(null==i&&(u=o(h=MP())),c=0;c<=p;++c){if(!(c<p&&a(d=s[c],c,s))===v)if(v=!v)l=c,u.areaStart(),u.lineStart();else{for(u.lineEnd(),u.lineStart(),f=c-1;f>=l;--f)u.point(m[f],g[f]);u.lineEnd(),u.areaEnd()}v&&(m[c]=+e(d,c,s),g[c]=+t(d,c,s),u.point(r?+r(d,c,s):m[c],n?+n(d,c,s):g[c]))}if(h)return u=null,h+""||null}function c(){return qP().defined(a).curve(o).context(i)}return e="function"===typeof e?e:void 0===e?WP:OP(+e),t="function"===typeof t?t:OP(void 0===t?0:+t),n="function"===typeof n?n:void 0===n?VP:OP(+n),s.x=function(t){return arguments.length?(e="function"===typeof t?t:OP(+t),r=null,s):e},s.x0=function(t){return arguments.length?(e="function"===typeof t?t:OP(+t),s):e},s.x1=function(e){return arguments.length?(r=null==e?null:"function"===typeof e?e:OP(+e),s):r},s.y=function(e){return arguments.length?(t="function"===typeof e?e:OP(+e),n=null,s):t},s.y0=function(e){return arguments.length?(t="function"===typeof e?e:OP(+e),s):t},s.y1=function(e){return arguments.length?(n=null==e?null:"function"===typeof e?e:OP(+e),s):n},s.lineX0=s.lineY0=function(){return c().x(e).y(t)},s.lineY1=function(){return c().x(e).y(n)},s.lineX1=function(){return c().x(r).y(t)},s.defined=function(e){return arguments.length?(a="function"===typeof e?e:OP(!!e),s):a},s.curve=function(e){return arguments.length?(o=e,null!=i&&(u=o(i)),s):o},s.context=function(e){return arguments.length?(null==e?i=u=null:u=o(i=e),s):i},s}var HP={draw:function(e,t){var n=Math.sqrt(t/nP);e.moveTo(n,0),e.arc(0,0,n,0,aP)}},XP=(Math.sqrt(1/3),Math.sin(nP/10)/Math.sin(7*nP/10));Math.sin(aP/10),Math.cos(aP/10),Math.sqrt(3),Math.sqrt(3),Math.sqrt(12);var KP={},YP={};function $P(e){return new Function("d","return {"+e.map((function(e,t){return JSON.stringify(e)+": d["+t+'] || ""'})).join(",")+"}")}function QP(e){var t=Object.create(null),n=[];return e.forEach((function(e){for(var r in e)r in t||n.push(t[r]=r)})),n}function JP(e,t){var n=e+"",r=n.length;return r<t?new Array(t-r+1).join(0)+n:n}function eU(e){var t=e.getUTCHours(),n=e.getUTCMinutes(),r=e.getUTCSeconds(),a=e.getUTCMilliseconds();return isNaN(e)?"Invalid Date":function(e){return e<0?"-"+JP(-e,6):e>9999?"+"+JP(e,6):JP(e,4)}(e.getUTCFullYear())+"-"+JP(e.getUTCMonth()+1,2)+"-"+JP(e.getUTCDate(),2)+(a?"T"+JP(t,2)+":"+JP(n,2)+":"+JP(r,2)+"."+JP(a,3)+"Z":r?"T"+JP(t,2)+":"+JP(n,2)+":"+JP(r,2)+"Z":n||t?"T"+JP(t,2)+":"+JP(n,2)+"Z":"")}function tU(e){var t=new RegExp('["'+e+"\n\r]"),n=e.charCodeAt(0);function r(e,t){var r,a=[],i=e.length,o=0,u=0,s=i<=0,c=!1;function l(){if(s)return YP;if(c)return c=!1,KP;var t,r,a=o;if(34===e.charCodeAt(a)){for(;o++<i&&34!==e.charCodeAt(o)||34===e.charCodeAt(++o););return(t=o)>=i?s=!0:10===(r=e.charCodeAt(o++))?c=!0:13===r&&(c=!0,10===e.charCodeAt(o)&&++o),e.slice(a+1,t-1).replace(/""/g,'"')}for(;o<i;){if(10===(r=e.charCodeAt(t=o++)))c=!0;else if(13===r)c=!0,10===e.charCodeAt(o)&&++o;else if(r!==n)continue;return e.slice(a,t)}return s=!0,e.slice(a,i)}for(10===e.charCodeAt(i-1)&&--i,13===e.charCodeAt(i-1)&&--i;(r=l())!==YP;){for(var f=[];r!==KP&&r!==YP;)f.push(r),r=l();t&&null==(f=t(f,u++))||a.push(f)}return a}function a(t,n){return t.map((function(t){return n.map((function(e){return o(t[e])})).join(e)}))}function i(t){return t.map(o).join(e)}function o(e){return null==e?"":e instanceof Date?eU(e):t.test(e+="")?'"'+e.replace(/"/g,'""')+'"':e}return{parse:function(e,t){var n,a,i=r(e,(function(e,r){if(n)return n(e,r-1);a=e,n=t?function(e,t){var n=$P(e);return function(r,a){return t(n(r),a,e)}}(e,t):$P(e)}));return i.columns=a||[],i},parseRows:r,format:function(t,n){return null==n&&(n=QP(t)),[n.map(o).join(e)].concat(a(t,n)).join("\n")},formatBody:function(e,t){return null==t&&(t=QP(e)),a(e,t).join("\n")},formatRows:function(e){return e.map(i).join("\n")},formatRow:i,formatValue:o}}var nU=Math.sqrt(50),rU=Math.sqrt(10),aU=Math.sqrt(2);var iU,oU=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function uU(e){if(!(t=oU.exec(e)))throw new Error("invalid format: "+e);var t;return new sU({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}function sU(e){this.fill=void 0===e.fill?" ":e.fill+"",this.align=void 0===e.align?">":e.align+"",this.sign=void 0===e.sign?"-":e.sign+"",this.symbol=void 0===e.symbol?"":e.symbol+"",this.zero=!!e.zero,this.width=void 0===e.width?void 0:+e.width,this.comma=!!e.comma,this.precision=void 0===e.precision?void 0:+e.precision,this.trim=!!e.trim,this.type=void 0===e.type?"":e.type+""}function cU(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,r=e.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+e.slice(n+1)]}function lU(e){return(e=cU(Math.abs(e)))?e[1]:NaN}function fU(e,t){var n=cU(e,t);if(!n)return e+"";var r=n[0],a=n[1];return a<0?"0."+new Array(-a).join("0")+r:r.length>a+1?r.slice(0,a+1)+"."+r.slice(a+1):r+new Array(a-r.length+2).join("0")}uU.prototype=sU.prototype,sU.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};var dU={"%":function(e,t){return(100*e).toFixed(t)},b:function(e){return Math.round(e).toString(2)},c:function(e){return e+""},d:function(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)},e:function(e,t){return e.toExponential(t)},f:function(e,t){return e.toFixed(t)},g:function(e,t){return e.toPrecision(t)},o:function(e){return Math.round(e).toString(8)},p:function(e,t){return fU(100*e,t)},r:fU,s:function(e,t){var n=cU(e,t);if(!n)return e+"";var r=n[0],a=n[1],i=a-(iU=3*Math.max(-8,Math.min(8,Math.floor(a/3))))+1,o=r.length;return i===o?r:i>o?r+new Array(i-o+1).join("0"):i>0?r.slice(0,i)+"."+r.slice(i):"0."+new Array(1-i).join("0")+cU(e,Math.max(0,t+i-1))[0]},X:function(e){return Math.round(e).toString(16).toUpperCase()},x:function(e){return Math.round(e).toString(16)}};function hU(e){return e}var pU,vU,mU,gU=Array.prototype.map,yU=["y","z","a","f","p","n","\xb5","m","","k","M","G","T","P","E","Z","Y"];function bU(e){var t,n,r=void 0===e.grouping||void 0===e.thousands?hU:(t=gU.call(e.grouping,Number),n=e.thousands+"",function(e,r){for(var a=e.length,i=[],o=0,u=t[0],s=0;a>0&&u>0&&(s+u+1>r&&(u=Math.max(1,r-s)),i.push(e.substring(a-=u,a+u)),!((s+=u+1)>r));)u=t[o=(o+1)%t.length];return i.reverse().join(n)}),a=void 0===e.currency?"":e.currency[0]+"",i=void 0===e.currency?"":e.currency[1]+"",o=void 0===e.decimal?".":e.decimal+"",u=void 0===e.numerals?hU:function(e){return function(t){return t.replace(/[0-9]/g,(function(t){return e[+t]}))}}(gU.call(e.numerals,String)),s=void 0===e.percent?"%":e.percent+"",c=void 0===e.minus?"\u2212":e.minus+"",l=void 0===e.nan?"NaN":e.nan+"";function f(e){var t=(e=uU(e)).fill,n=e.align,f=e.sign,d=e.symbol,h=e.zero,p=e.width,v=e.comma,m=e.precision,g=e.trim,y=e.type;"n"===y?(v=!0,y="g"):dU[y]||(void 0===m&&(m=12),g=!0,y="g"),(h||"0"===t&&"="===n)&&(h=!0,t="0",n="=");var b="$"===d?a:"#"===d&&/[boxX]/.test(y)?"0"+y.toLowerCase():"",x="$"===d?i:/[%p]/.test(y)?s:"",w=dU[y],k=/[defgprs%]/.test(y);function _(e){var a,i,s,d=b,_=x;if("c"===y)_=w(e)+_,e="";else{var S=(e=+e)<0||1/e<0;if(e=isNaN(e)?l:w(Math.abs(e),m),g&&(e=function(e){e:for(var t,n=e.length,r=1,a=-1;r<n;++r)switch(e[r]){case".":a=t=r;break;case"0":0===a&&(a=r),t=r;break;default:if(!+e[r])break e;a>0&&(a=0)}return a>0?e.slice(0,a)+e.slice(t+1):e}(e)),S&&0===+e&&"+"!==f&&(S=!1),d=(S?"("===f?f:c:"-"===f||"("===f?"":f)+d,_=("s"===y?yU[8+iU/3]:"")+_+(S&&"("===f?")":""),k)for(a=-1,i=e.length;++a<i;)if(48>(s=e.charCodeAt(a))||s>57){_=(46===s?o+e.slice(a+1):e.slice(a))+_,e=e.slice(0,a);break}}v&&!h&&(e=r(e,1/0));var C=d.length+e.length+_.length,A=C<p?new Array(p-C+1).join(t):"";switch(v&&h&&(e=r(A+e,A.length?p-_.length:1/0),A=""),n){case"<":e=d+e+_+A;break;case"=":e=d+A+e+_;break;case"^":e=A.slice(0,C=A.length>>1)+d+e+_+A.slice(C);break;default:e=A+d+e+_}return u(e)}return m=void 0===m?6:/[gprs]/.test(y)?Math.max(1,Math.min(21,m)):Math.max(0,Math.min(20,m)),_.toString=function(){return e+""},_}return{format:f,formatPrefix:function(e,t){var n=f(((e=uU(e)).type="f",e)),r=3*Math.max(-8,Math.min(8,Math.floor(lU(t)/3))),a=Math.pow(10,-r),i=yU[8+r/3];return function(e){return n(a*e)+i}}}}!function(e){pU=bU(e),vU=pU.format,mU=pU.formatPrefix}({thousands:",",grouping:[3],currency:["$",""]});var xU=new Date,wU=new Date;function kU(e,t,n,r){function a(t){return e(t=0===arguments.length?new Date:new Date(+t)),t}return a.floor=function(t){return e(t=new Date(+t)),t},a.ceil=function(n){return e(n=new Date(n-1)),t(n,1),e(n),n},a.round=function(e){var t=a(e),n=a.ceil(e);return e-t<n-e?t:n},a.offset=function(e,n){return t(e=new Date(+e),null==n?1:Math.floor(n)),e},a.range=function(n,r,i){var o,u=[];if(n=a.ceil(n),i=null==i?1:Math.floor(i),!(n<r)||!(i>0))return u;do{u.push(o=new Date(+n)),t(n,i),e(n)}while(o<n&&n<r);return u},a.filter=function(n){return kU((function(t){if(t>=t)for(;e(t),!n(t);)t.setTime(t-1)}),(function(e,r){if(e>=e)if(r<0)for(;++r<=0;)for(;t(e,-1),!n(e););else for(;--r>=0;)for(;t(e,1),!n(e););}))},n&&(a.count=function(t,r){return xU.setTime(+t),wU.setTime(+r),e(xU),e(wU),Math.floor(n(xU,wU))},a.every=function(e){return e=Math.floor(e),isFinite(e)&&e>0?e>1?a.filter(r?function(t){return r(t)%e===0}:function(t){return a.count(0,t)%e===0}):a:null}),a}var _U=6e4,SU=864e5,CU=6048e5;function AU(e){return kU((function(t){t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)}),(function(e,t){e.setUTCDate(e.getUTCDate()+7*t)}),(function(e,t){return(t-e)/CU}))}var EU=AU(0),NU=AU(1),TU=AU(2),IU=AU(3),DU=AU(4),FU=AU(5),MU=AU(6),OU=(EU.range,NU.range,TU.range,IU.range,DU.range,FU.range,MU.range,kU((function(e){e.setUTCHours(0,0,0,0)}),(function(e,t){e.setUTCDate(e.getUTCDate()+t)}),(function(e,t){return(t-e)/SU}),(function(e){return e.getUTCDate()-1}))),RU=OU;OU.range;function jU(e){return kU((function(t){t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)}),(function(e,t){e.setDate(e.getDate()+7*t)}),(function(e,t){return(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*_U)/CU}))}var BU=jU(0),zU=jU(1),ZU=jU(2),LU=jU(3),PU=jU(4),UU=jU(5),WU=jU(6),VU=(BU.range,zU.range,ZU.range,LU.range,PU.range,UU.range,WU.range,kU((function(e){return e.setHours(0,0,0,0)}),(function(e,t){return e.setDate(e.getDate()+t)}),(function(e,t){return(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*_U)/SU}),(function(e){return e.getDate()-1}))),qU=VU,GU=(VU.range,kU((function(e){e.setMonth(0,1),e.setHours(0,0,0,0)}),(function(e,t){e.setFullYear(e.getFullYear()+t)}),(function(e,t){return t.getFullYear()-e.getFullYear()}),(function(e){return e.getFullYear()})));GU.every=function(e){return isFinite(e=Math.floor(e))&&e>0?kU((function(t){t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)}),(function(t,n){t.setFullYear(t.getFullYear()+n*e)})):null};var HU=GU,XU=(GU.range,kU((function(e){e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)}),(function(e,t){e.setUTCFullYear(e.getUTCFullYear()+t)}),(function(e,t){return t.getUTCFullYear()-e.getUTCFullYear()}),(function(e){return e.getUTCFullYear()})));XU.every=function(e){return isFinite(e=Math.floor(e))&&e>0?kU((function(t){t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)}),(function(t,n){t.setUTCFullYear(t.getUTCFullYear()+n*e)})):null};var KU=XU;XU.range;function YU(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function $U(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function QU(e,t,n){return{y:e,m:t,d:n,H:0,M:0,S:0,L:0}}function JU(e){var t=e.dateTime,n=e.date,r=e.time,a=e.periods,i=e.days,o=e.shortDays,u=e.months,s=e.shortMonths,c=hW(a),l=pW(a),f=hW(i),d=pW(i),h=hW(o),p=pW(o),v=hW(u),m=pW(u),g=hW(s),y=pW(s),b={a:function(e){return o[e.getDay()]},A:function(e){return i[e.getDay()]},b:function(e){return s[e.getMonth()]},B:function(e){return u[e.getMonth()]},c:null,d:RW,e:RW,f:LW,g:$W,G:JW,H:jW,I:BW,j:zW,L:ZW,m:PW,M:UW,p:function(e){return a[+(e.getHours()>=12)]},q:function(e){return 1+~~(e.getMonth()/3)},Q:kV,s:_V,S:WW,u:VW,U:qW,V:HW,w:XW,W:KW,x:null,X:null,y:YW,Y:QW,Z:eV,"%":wV},x={a:function(e){return o[e.getUTCDay()]},A:function(e){return i[e.getUTCDay()]},b:function(e){return s[e.getUTCMonth()]},B:function(e){return u[e.getUTCMonth()]},c:null,d:tV,e:tV,f:oV,g:gV,G:bV,H:nV,I:rV,j:aV,L:iV,m:uV,M:sV,p:function(e){return a[+(e.getUTCHours()>=12)]},q:function(e){return 1+~~(e.getUTCMonth()/3)},Q:kV,s:_V,S:cV,u:lV,U:fV,V:hV,w:pV,W:vV,x:null,X:null,y:mV,Y:yV,Z:xV,"%":wV},w={a:function(e,t,n){var r=h.exec(t.slice(n));return r?(e.w=p.get(r[0].toLowerCase()),n+r[0].length):-1},A:function(e,t,n){var r=f.exec(t.slice(n));return r?(e.w=d.get(r[0].toLowerCase()),n+r[0].length):-1},b:function(e,t,n){var r=g.exec(t.slice(n));return r?(e.m=y.get(r[0].toLowerCase()),n+r[0].length):-1},B:function(e,t,n){var r=v.exec(t.slice(n));return r?(e.m=m.get(r[0].toLowerCase()),n+r[0].length):-1},c:function(e,n,r){return S(e,t,n,r)},d:CW,e:CW,f:DW,g:wW,G:xW,H:EW,I:EW,j:AW,L:IW,m:SW,M:NW,p:function(e,t,n){var r=c.exec(t.slice(n));return r?(e.p=l.get(r[0].toLowerCase()),n+r[0].length):-1},q:_W,Q:MW,s:OW,S:TW,u:mW,U:gW,V:yW,w:vW,W:bW,x:function(e,t,r){return S(e,n,t,r)},X:function(e,t,n){return S(e,r,t,n)},y:wW,Y:xW,Z:kW,"%":FW};function k(e,t){return function(n){var r,a,i,o=[],u=-1,s=0,c=e.length;for(n instanceof Date||(n=new Date(+n));++u<c;)37===e.charCodeAt(u)&&(o.push(e.slice(s,u)),null!=(a=uW[r=e.charAt(++u)])?r=e.charAt(++u):a="e"===r?" ":"0",(i=t[r])&&(r=i(n,a)),o.push(r),s=u+1);return o.push(e.slice(s,u)),o.join("")}}function _(e,t){return function(n){var r,a,i=QU(1900,void 0,1);if(S(i,e,n+="",0)!=n.length)return null;if("Q"in i)return new Date(i.Q);if("s"in i)return new Date(1e3*i.s+("L"in i?i.L:0));if(t&&!("Z"in i)&&(i.Z=0),"p"in i&&(i.H=i.H%12+12*i.p),void 0===i.m&&(i.m="q"in i?i.q:0),"V"in i){if(i.V<1||i.V>53)return null;"w"in i||(i.w=1),"Z"in i?(a=(r=$U(QU(i.y,0,1))).getUTCDay(),r=a>4||0===a?NU.ceil(r):NU(r),r=RU.offset(r,7*(i.V-1)),i.y=r.getUTCFullYear(),i.m=r.getUTCMonth(),i.d=r.getUTCDate()+(i.w+6)%7):(a=(r=YU(QU(i.y,0,1))).getDay(),r=a>4||0===a?zU.ceil(r):zU(r),r=qU.offset(r,7*(i.V-1)),i.y=r.getFullYear(),i.m=r.getMonth(),i.d=r.getDate()+(i.w+6)%7)}else("W"in i||"U"in i)&&("w"in i||(i.w="u"in i?i.u%7:"W"in i?1:0),a="Z"in i?$U(QU(i.y,0,1)).getUTCDay():YU(QU(i.y,0,1)).getDay(),i.m=0,i.d="W"in i?(i.w+6)%7+7*i.W-(a+5)%7:i.w+7*i.U-(a+6)%7);return"Z"in i?(i.H+=i.Z/100|0,i.M+=i.Z%100,$U(i)):YU(i)}}function S(e,t,n,r){for(var a,i,o=0,u=t.length,s=n.length;o<u;){if(r>=s)return-1;if(37===(a=t.charCodeAt(o++))){if(a=t.charAt(o++),!(i=w[a in uW?t.charAt(o++):a])||(r=i(e,n,r))<0)return-1}else if(a!=n.charCodeAt(r++))return-1}return r}return b.x=k(n,b),b.X=k(r,b),b.c=k(t,b),x.x=k(n,x),x.X=k(r,x),x.c=k(t,x),{format:function(e){var t=k(e+="",b);return t.toString=function(){return e},t},parse:function(e){var t=_(e+="",!1);return t.toString=function(){return e},t},utcFormat:function(e){var t=k(e+="",x);return t.toString=function(){return e},t},utcParse:function(e){var t=_(e+="",!0);return t.toString=function(){return e},t}}}var eW,tW,nW,rW,aW,iW,oW,uW={"-":"",_:" ",0:"0"},sW=/^\s*\d+/,cW=/^%/,lW=/[\\^$*+?|[\]().{}]/g;function fW(e,t,n){var r=e<0?"-":"",a=(r?-e:e)+"",i=a.length;return r+(i<n?new Array(n-i+1).join(t)+a:a)}function dW(e){return e.replace(lW,"\\$&")}function hW(e){return new RegExp("^(?:"+e.map(dW).join("|")+")","i")}function pW(e){return new Map(e.map((function(e,t){return[e.toLowerCase(),t]})))}function vW(e,t,n){var r=sW.exec(t.slice(n,n+1));return r?(e.w=+r[0],n+r[0].length):-1}function mW(e,t,n){var r=sW.exec(t.slice(n,n+1));return r?(e.u=+r[0],n+r[0].length):-1}function gW(e,t,n){var r=sW.exec(t.slice(n,n+2));return r?(e.U=+r[0],n+r[0].length):-1}function yW(e,t,n){var r=sW.exec(t.slice(n,n+2));return r?(e.V=+r[0],n+r[0].length):-1}function bW(e,t,n){var r=sW.exec(t.slice(n,n+2));return r?(e.W=+r[0],n+r[0].length):-1}function xW(e,t,n){var r=sW.exec(t.slice(n,n+4));return r?(e.y=+r[0],n+r[0].length):-1}function wW(e,t,n){var r=sW.exec(t.slice(n,n+2));return r?(e.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function kW(e,t,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(n,n+6));return r?(e.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function _W(e,t,n){var r=sW.exec(t.slice(n,n+1));return r?(e.q=3*r[0]-3,n+r[0].length):-1}function SW(e,t,n){var r=sW.exec(t.slice(n,n+2));return r?(e.m=r[0]-1,n+r[0].length):-1}function CW(e,t,n){var r=sW.exec(t.slice(n,n+2));return r?(e.d=+r[0],n+r[0].length):-1}function AW(e,t,n){var r=sW.exec(t.slice(n,n+3));return r?(e.m=0,e.d=+r[0],n+r[0].length):-1}function EW(e,t,n){var r=sW.exec(t.slice(n,n+2));return r?(e.H=+r[0],n+r[0].length):-1}function NW(e,t,n){var r=sW.exec(t.slice(n,n+2));return r?(e.M=+r[0],n+r[0].length):-1}function TW(e,t,n){var r=sW.exec(t.slice(n,n+2));return r?(e.S=+r[0],n+r[0].length):-1}function IW(e,t,n){var r=sW.exec(t.slice(n,n+3));return r?(e.L=+r[0],n+r[0].length):-1}function DW(e,t,n){var r=sW.exec(t.slice(n,n+6));return r?(e.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function FW(e,t,n){var r=cW.exec(t.slice(n,n+1));return r?n+r[0].length:-1}function MW(e,t,n){var r=sW.exec(t.slice(n));return r?(e.Q=+r[0],n+r[0].length):-1}function OW(e,t,n){var r=sW.exec(t.slice(n));return r?(e.s=+r[0],n+r[0].length):-1}function RW(e,t){return fW(e.getDate(),t,2)}function jW(e,t){return fW(e.getHours(),t,2)}function BW(e,t){return fW(e.getHours()%12||12,t,2)}function zW(e,t){return fW(1+qU.count(HU(e),e),t,3)}function ZW(e,t){return fW(e.getMilliseconds(),t,3)}function LW(e,t){return ZW(e,t)+"000"}function PW(e,t){return fW(e.getMonth()+1,t,2)}function UW(e,t){return fW(e.getMinutes(),t,2)}function WW(e,t){return fW(e.getSeconds(),t,2)}function VW(e){var t=e.getDay();return 0===t?7:t}function qW(e,t){return fW(BU.count(HU(e)-1,e),t,2)}function GW(e){var t=e.getDay();return t>=4||0===t?PU(e):PU.ceil(e)}function HW(e,t){return e=GW(e),fW(PU.count(HU(e),e)+(4===HU(e).getDay()),t,2)}function XW(e){return e.getDay()}function KW(e,t){return fW(zU.count(HU(e)-1,e),t,2)}function YW(e,t){return fW(e.getFullYear()%100,t,2)}function $W(e,t){return fW((e=GW(e)).getFullYear()%100,t,2)}function QW(e,t){return fW(e.getFullYear()%1e4,t,4)}function JW(e,t){var n=e.getDay();return fW((e=n>=4||0===n?PU(e):PU.ceil(e)).getFullYear()%1e4,t,4)}function eV(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+fW(t/60|0,"0",2)+fW(t%60,"0",2)}function tV(e,t){return fW(e.getUTCDate(),t,2)}function nV(e,t){return fW(e.getUTCHours(),t,2)}function rV(e,t){return fW(e.getUTCHours()%12||12,t,2)}function aV(e,t){return fW(1+RU.count(KU(e),e),t,3)}function iV(e,t){return fW(e.getUTCMilliseconds(),t,3)}function oV(e,t){return iV(e,t)+"000"}function uV(e,t){return fW(e.getUTCMonth()+1,t,2)}function sV(e,t){return fW(e.getUTCMinutes(),t,2)}function cV(e,t){return fW(e.getUTCSeconds(),t,2)}function lV(e){var t=e.getUTCDay();return 0===t?7:t}function fV(e,t){return fW(EU.count(KU(e)-1,e),t,2)}function dV(e){var t=e.getUTCDay();return t>=4||0===t?DU(e):DU.ceil(e)}function hV(e,t){return e=dV(e),fW(DU.count(KU(e),e)+(4===KU(e).getUTCDay()),t,2)}function pV(e){return e.getUTCDay()}function vV(e,t){return fW(NU.count(KU(e)-1,e),t,2)}function mV(e,t){return fW(e.getUTCFullYear()%100,t,2)}function gV(e,t){return fW((e=dV(e)).getUTCFullYear()%100,t,2)}function yV(e,t){return fW(e.getUTCFullYear()%1e4,t,4)}function bV(e,t){var n=e.getUTCDay();return fW((e=n>=4||0===n?DU(e):DU.ceil(e)).getUTCFullYear()%1e4,t,4)}function xV(){return"+0000"}function wV(){return"%"}function kV(e){return+e}function _V(e){return Math.floor(+e/1e3)}function SV(e){var t={};return function(n){return t[n]||(t[n]=e(n))}}function CV(e){var t=SV(e.format),n=e.formatPrefix;return{format:t,formatPrefix:n,formatFloat:function(e){var n=uU(e||",");if(null==n.precision){switch(n.precision=12,n.type){case"%":n.precision-=2;break;case"e":n.precision-=1}return function(e,t){return function(n){var r=e(n),a=r.indexOf(t);if(a<0)return r;for(var i=function(e,t){var n,r=e.lastIndexOf("e");if(r>0)return r;for(r=e.length;--r>t;)if((n=e.charCodeAt(r))>=48&&n<=57)return r+1}(r,a),o=i<r.length?r.slice(i):"";--i>a;)if("0"!==r[i]){++i;break}return r.slice(0,i)+o}}(t(n),t(".1f")(1)[1])}return t(n)},formatSpan:function(e,r,a,i){i=uU(null==i?",f":i);var o,u=function(e,t,n){var r=Math.abs(t-e)/Math.max(0,n),a=Math.pow(10,Math.floor(Math.log(r)/Math.LN10)),i=r/a;return i>=nU?a*=10:i>=rU?a*=5:i>=aU&&(a*=2),t<e?-a:a}(e,r,a),s=Math.max(Math.abs(e),Math.abs(r));if(null==i.precision)switch(i.type){case"s":return isNaN(o=function(e,t){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(lU(t)/3)))-lU(Math.abs(e)))}(u,s))||(i.precision=o),n(i,s);case"":case"e":case"g":case"p":case"r":isNaN(o=function(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,lU(t)-lU(e))+1}(u,s))||(i.precision=o-("e"===i.type));break;case"f":case"%":isNaN(o=function(e){return Math.max(0,-lU(Math.abs(e)))}(u))||(i.precision=o-2*("%"===i.type))}return t(i)}}}function AV(){return iW=CV({format:vU,formatPrefix:mU})}function EV(e){return CV(bU(e))}function NV(e){return arguments.length?iW=EV(e):iW}function TV(e,t,n){Se(n=n||{})||ue("Invalid time multi-format specifier: ".concat(n));var r=t(nl),a=t(tl),i=t(el),o=t($c),u=t(Yc),s=t(Kc),c=t(Xc),l=t(Hc),f=e(n[rl]||".%L"),d=e(n[nl]||":%S"),h=e(n[tl]||"%I:%M"),p=e(n[el]||"%I %p"),v=e(n[$c]||n[Qc]||"%a %d"),m=e(n[Yc]||"%b %d"),g=e(n[Kc]||"%B"),y=e(n[Xc]||"%B"),b=e(n[Hc]||"%Y");return function(e){return(r(e)<e?f:a(e)<e?d:i(e)<e?h:o(e)<e?p:s(e)<e?u(e)<e?v:m:l(e)<e?c(e)<e?g:y:b)(e)}}function IV(e){var t=SV(e.format),n=SV(e.utcFormat);return{timeFormat:function(e){return bt(e)?t(e):TV(t,Ml,e)},utcFormat:function(e){return bt(e)?n(e):TV(n,Ol,e)},timeParse:SV(e.parse),utcParse:SV(e.utcParse)}}function DV(){return oW=IV({format:tW,parse:nW,utcFormat:rW,utcParse:aW})}function FV(e){return IV(JU(e))}function MV(e){return arguments.length?oW=FV(e):oW}!function(e){eW=JU(e),tW=eW.format,nW=eW.parse,rW=eW.utcFormat,aW=eW.utcParse}({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]}),AV(),DV();var OV=function(e,t){return at({},e,t)};function RV(e,t){var n=e?EV(e):NV(),r=t?FV(t):MV();return OV(n,r)}function jV(e,t){var n=arguments.length;return n&&2!==n&&ue("defaultLocale expects either zero or two arguments."),n?OV(NV(e),MV(t)):OV(NV(),MV())}function BV(){return AV(),DV(),jV()}var zV=/^(data:|([A-Za-z]+:)?\/\/)/,ZV=/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp|file|data):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i,LV=/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205f\u3000]/g,PV="file://";function UV(e,t){return WV.apply(this,arguments)}function WV(){return(WV=(0,jt.Z)(w().mark((function e(t,n){var r,a;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.sanitize(t,n);case 2:return r=e.sent,a=r.href,e.abrupt("return",r.localFile?this.file(a):this.http(a,n));case 5:case"end":return e.stop()}}),e,this)})))).apply(this,arguments)}function VV(e,t){return qV.apply(this,arguments)}function qV(){return qV=(0,jt.Z)(w().mark((function e(t,n){var r,a,i,o,u,s,c;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=at({},this.options,n),r=this.fileAccess,a={href:null},s=ZV.test(t.replace(LV,"")),null!=t&&"string"===typeof t&&s||ue("Sanitize failure, invalid URI: "+Et(t)),c=zV.test(t),(u=n.baseURL)&&!c&&(t.startsWith("/")||u.endsWith("/")||(t="/"+t),t=u+t),o=(i=t.startsWith(PV))||"file"===n.mode||"http"!==n.mode&&!c&&r,i?t=t.slice(PV.length):t.startsWith("//")&&("file"===n.defaultProtocol?(t=t.slice(2),o=!0):t=(n.defaultProtocol||"http")+":"+t),Object.defineProperty(a,"localFile",{value:!!o}),a.href=t,n.target&&(a.target=n.target+""),n.rel&&(a.rel=n.rel+""),"image"===n.context&&n.crossOrigin&&(a.crossOrigin=n.crossOrigin+""),e.abrupt("return",a);case 14:case"end":return e.stop()}}),e,this)}))),qV.apply(this,arguments)}function GV(e){return e?function(t){return new Promise((function(n,r){e.readFile(t,(function(e,t){e?r(e):n(t)}))}))}:HV}function HV(){return XV.apply(this,arguments)}function XV(){return(XV=(0,jt.Z)(w().mark((function e(){return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:ue("No file system access.");case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function KV(e){return e?function(){var t=(0,jt.Z)(w().mark((function t(n,r){var a,i,o;return w().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=at({},this.options.http,r),i=r&&r.response,t.next=4,e(n,a);case 4:return o=t.sent,t.abrupt("return",o.ok?Ye(o[i])?o[i]():o.text():ue(o.status+""+o.statusText));case 6:case"end":return t.stop()}}),t,this)})));return function(e,n){return t.apply(this,arguments)}}():YV}function YV(){return $V.apply(this,arguments)}function $V(){return($V=(0,jt.Z)(w().mark((function e(){return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:ue("No HTTP fetch method available.");case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var QV=function(e){return!Number.isNaN(+e)&&!(e instanceof Date)},JV={boolean:Nt,integer:Ie,number:Ie,date:It,string:Dt,unknown:fe},eq=[function(e){return"true"===e||"false"===e||!0===e||!1===e},function(e){return QV(e)&&Number.isInteger(+e)},QV,function(e){return!Number.isNaN(Date.parse(e))}],tq=["boolean","integer","number","date"];function nq(e,t){if(!e||!e.length)return"unknown";for(var n,r,a,i=e.length,o=eq.length,u=eq.map((function(e,t){return t+1})),s=0,c=0;s<i;++s)for(r=t?e[s][t]:e[s],n=0;n<o;++n)if(u[n]&&(null!=(a=r)&&a===a)&&!eq[n](r)&&(u[n]=0,++c===eq.length))return"string";return tq[u.reduce((function(e,t){return 0===e?t:e}),0)-1]}function rq(e,t){return t.reduce((function(t,n){return t[n]=nq(e,n),t}),{})}function aq(e){var t=function(t,n){var r={delimiter:e};return iq(t,n?at(n,r):r)};return t.responseType="text",t}function iq(e,t){return t.header&&(e=t.header.map(Et).join(t.delimiter)+"\n"+e),tU(t.delimiter).parse(e+"")}function oq(e,t){var n,r=t&&t.property?ce(t.property):fe;return!Se(e)||(n=e,"function"===typeof Buffer&&Ye(Buffer.isBuffer)&&Buffer.isBuffer(n))?r(JSON.parse(e)):function(e,t){!_e(e)&&mt(e)&&(e=(0,cn.Z)(e));return t&&t.copy?JSON.parse(JSON.stringify(e)):e}(r(e),t)}iq.responseType="text",oq.responseType="json";var uq={interior:function(e,t){return e!==t},exterior:function(e,t){return e===t}};function sq(e,t){var n,r,a,i;return e=oq(e,t),t&&t.feature?(n=yn,a=t.feature):t&&t.mesh?(n=kn,a=t.mesh,i=uq[t.filter]):ue("Missing TopoJSON feature or mesh parameter."),(r=(r=e.objects[a])?n(e,r,i):ue("Invalid TopoJSON object: "+a))&&r.features||[r]}sq.responseType="json";var cq={dsv:iq,csv:aq(","),tsv:aq("\t"),json:oq,topojson:sq};function lq(e,t){return arguments.length>1?(cq[e]=t,this):st(cq,e)?cq[e]:null}function fq(e){var t=lq(e);return t&&t.responseType||"text"}function dq(e,t,n,r){var a=lq((t=t||{}).type||"json");return a||ue("Unknown data format type: "+t.type),e=a(e,t),t.parse&&function(e,t,n,r){if(!e.length)return;var a=MV();n=n||a.timeParse,r=r||a.utcParse;var i,o,u,s,c,l,f=e.columns||Object.keys(e[0]);"auto"===t&&(t=rq(e,f));var d=(f=Object.keys(t)).map((function(e){var a,i,o=t[e];if(o&&(o.startsWith("date:")||o.startsWith("utc:")))return("'"===(i=(a=o.split(/:(.+)?/,2))[1])[0]&&"'"===i[i.length-1]||'"'===i[0]&&'"'===i[i.length-1])&&(i=i.slice(1,-1)),("utc"===a[0]?r:n)(i);if(!JV[o])throw Error("Illegal format pattern: "+e+":"+o);return JV[o]}));for(u=0,c=e.length,l=f.length;u<c;++u)for(i=e[u],s=0;s<l;++s)i[o=f[s]]=d[s](i[o])}(e,t.parse,n,r),st(e,"columns")&&delete e.columns,e}var hq=function(e,t){return function(n){return{options:n||{},sanitize:VV,load:UV,fileAccess:!!t,file:GV(t),http:KV(e)}}}("undefined"!==typeof fetch&&fetch,null),pq=0;var vq="p_";function mq(e){return e&&e.gradient}function gq(e,t,n){var r=e.gradient,a=e.id,i="radial"===r?vq:"";return a||(a=e.id="gradient_"+pq++,"radial"===r?(e.x1=yq(e.x1,.5),e.y1=yq(e.y1,.5),e.r1=yq(e.r1,0),e.x2=yq(e.x2,.5),e.y2=yq(e.y2,.5),e.r2=yq(e.r2,.5),i=vq):(e.x1=yq(e.x1,0),e.y1=yq(e.y1,0),e.x2=yq(e.x2,1),e.y2=yq(e.y2,0))),t[a]=e,"url("+(n||"")+"#"+i+a+")"}function yq(e,t){return null!=e?e:t}function bq(e,t){var n,r=[];return n={gradient:"linear",x1:e?e[0]:0,y1:e?e[1]:0,x2:t?t[0]:1,y2:t?t[1]:0,stops:r,stop:function(e,t){return r.push({offset:e,color:t}),n}}}var xq={basis:{curve:function(e){return new RL(e)}},"basis-closed":{curve:function(e){return new BL(e)}},"basis-open":{curve:function(e){return new zL(e)}},bundle:{curve:LL,tension:"beta",value:.85},cardinal:{curve:WL,tension:"tension",value:0},"cardinal-open":{curve:qL,tension:"tension",value:0},"cardinal-closed":{curve:HL,tension:"tension",value:0},"catmull-rom":{curve:cP,tension:"alpha",value:.5},"catmull-rom-closed":{curve:fP,tension:"alpha",value:.5},"catmull-rom-open":{curve:hP,tension:"alpha",value:.5},linear:{curve:vP},"linear-closed":{curve:function(e){return new mP(e)}},monotone:{horizontal:function(e){return new kP(e)},vertical:function(e){return new wP(e)}},natural:{curve:function(e){return new SP(e)}},step:{curve:function(e){return new AP(e,.5)}},"step-after":{curve:function(e){return new AP(e,1)}},"step-before":{curve:function(e){return new AP(e,0)}}};function wq(e,t,n){var r=st(xq,e)&&xq[e],a=null;return r&&(a=r.curve||r[t||"vertical"],r.tension&&null!=n&&(a=a[r.tension](n))),a}var kq={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7},_q=[/([MLHVCSQTAZmlhvcsqtaz])/g,/###/,/(\.\d+)(\.\d)/g,/(\d)([-+])/g,/\s|,|###/];function Sq(e){var t,n,r,a,i,o,u,s,c,l,f=[],d=e.slice().replace(_q[0],"###$1").split(_q[1]).slice(1);for(u=0,c=d.length;u<c;++u){for(n=(t=d[u]).slice(1).trim().replace(_q[2],"$1###$2").replace(_q[3],"$1###$2").split(_q[4]),r=[i=t.charAt(0)],s=0,l=n.length;s<l;++s)(a=+n[s])===a&&r.push(a);if(o=kq[i.toLowerCase()],r.length-1>o){var h=r.length;for(s=1,f.push([i].concat(r.slice(s,s+=o))),i="M"===i?"L":"m"===i?"l":i;s<h;s+=o)f.push([i].concat(r.slice(s,s+o)))}else f.push(r)}return f}var Cq=Math.PI/180,Aq=Math.PI/2,Eq=2*Math.PI,Nq=Math.sqrt(3)/2,Tq={},Iq={},Dq=[].join;function Fq(e){var t=Dq.call(e);if(Iq[t])return Iq[t];var n=e[0],r=e[1],a=e[2],i=e[3],o=e[4],u=e[5],s=e[6],c=e[7],l=c*o,f=-s*u,d=s*o,h=c*u,p=Math.cos(a),v=Math.sin(a),m=Math.cos(i),g=Math.sin(i),y=.5*(i-a),b=Math.sin(.5*y),x=8/3*b*b/Math.sin(y),w=n+p-x*v,k=r+v+x*p,_=n+m,S=r+g,C=_+x*g,A=S-x*m;return Iq[t]=[l*w+f*k,d*w+h*k,l*C+f*A,d*C+h*A,l*_+f*S,d*_+h*S]}var Mq=["l",0,0,0,0,0,0,0];function Oq(e,t,n){var r=Mq[0]=e[0];if("a"===r||"A"===r)Mq[1]=t*e[1],Mq[2]=n*e[2],Mq[3]=e[3],Mq[4]=e[4],Mq[5]=e[5],Mq[6]=t*e[6],Mq[7]=n*e[7];else if("h"===r||"H"===r)Mq[1]=t*e[1];else if("v"===r||"V"===r)Mq[1]=n*e[1];else for(var a=1,i=e.length;a<i;++a)Mq[a]=(a%2==1?t:n)*e[a];return Mq}function Rq(e,t,n,r,a,i){var o,u,s,c,l,f=null,d=0,h=0,p=0,v=0;null==n&&(n=0),null==r&&(r=0),null==a&&(a=1),null==i&&(i=a),e.beginPath&&e.beginPath();for(var m=0,g=t.length;m<g;++m){switch(o=t[m],1===a&&1===i||(o=Oq(o,a,i)),o[0]){case"l":d+=o[1],h+=o[2],e.lineTo(d+n,h+r);break;case"L":d=o[1],h=o[2],e.lineTo(d+n,h+r);break;case"h":d+=o[1],e.lineTo(d+n,h+r);break;case"H":d=o[1],e.lineTo(d+n,h+r);break;case"v":h+=o[1],e.lineTo(d+n,h+r);break;case"V":h=o[1],e.lineTo(d+n,h+r);break;case"m":d+=o[1],h+=o[2],e.moveTo(d+n,h+r);break;case"M":d=o[1],h=o[2],e.moveTo(d+n,h+r);break;case"c":u=d+o[5],s=h+o[6],p=d+o[3],v=h+o[4],e.bezierCurveTo(d+o[1]+n,h+o[2]+r,p+n,v+r,u+n,s+r),d=u,h=s;break;case"C":d=o[5],h=o[6],p=o[3],v=o[4],e.bezierCurveTo(o[1]+n,o[2]+r,p+n,v+r,d+n,h+r);break;case"s":u=d+o[3],s=h+o[4],p=2*d-p,v=2*h-v,e.bezierCurveTo(p+n,v+r,d+o[1]+n,h+o[2]+r,u+n,s+r),p=d+o[1],v=h+o[2],d=u,h=s;break;case"S":u=o[3],s=o[4],p=2*d-p,v=2*h-v,e.bezierCurveTo(p+n,v+r,o[1]+n,o[2]+r,u+n,s+r),d=u,h=s,p=o[1],v=o[2];break;case"q":u=d+o[3],s=h+o[4],p=d+o[1],v=h+o[2],e.quadraticCurveTo(p+n,v+r,u+n,s+r),d=u,h=s;break;case"Q":u=o[3],s=o[4],e.quadraticCurveTo(o[1]+n,o[2]+r,u+n,s+r),d=u,h=s,p=o[1],v=o[2];break;case"t":u=d+o[1],s=h+o[2],null===f[0].match(/[QqTt]/)?(p=d,v=h):"t"===f[0]?(p=2*d-c,v=2*h-l):"q"===f[0]&&(p=2*d-p,v=2*h-v),c=p,l=v,e.quadraticCurveTo(p+n,v+r,u+n,s+r),h=s,p=(d=u)+o[1],v=h+o[2];break;case"T":u=o[1],s=o[2],p=2*d-p,v=2*h-v,e.quadraticCurveTo(p+n,v+r,u+n,s+r),d=u,h=s;break;case"a":jq(e,d+n,h+r,[o[1],o[2],o[3],o[4],o[5],o[6]+d+n,o[7]+h+r]),d+=o[6],h+=o[7];break;case"A":jq(e,d+n,h+r,[o[1],o[2],o[3],o[4],o[5],o[6]+n,o[7]+r]),d=o[6],h=o[7];break;case"z":case"Z":e.closePath()}f=o}}function jq(e,t,n,r){for(var a=function(e,t,n,r,a,i,o,u,s){var c=Dq.call(arguments);if(Tq[c])return Tq[c];var l=o*Cq,f=Math.sin(l),d=Math.cos(l),h=d*(u-e)*.5+f*(s-t)*.5,p=d*(s-t)*.5-f*(u-e)*.5,v=h*h/((n=Math.abs(n))*n)+p*p/((r=Math.abs(r))*r);v>1&&(n*=v=Math.sqrt(v),r*=v);var m=d/n,g=f/n,y=-f/r,b=d/r,x=m*u+g*s,w=y*u+b*s,k=m*e+g*t,_=y*e+b*t,S=1/((k-x)*(k-x)+(_-w)*(_-w))-.25;S<0&&(S=0);var C=Math.sqrt(S);i==a&&(C=-C);var A=.5*(x+k)-C*(_-w),E=.5*(w+_)+C*(k-x),N=Math.atan2(w-E,x-A),T=Math.atan2(_-E,k-A)-N;T<0&&1===i?T+=Eq:T>0&&0===i&&(T-=Eq);for(var I=Math.ceil(Math.abs(T/(Aq+.001))),D=[],F=0;F<I;++F){var M=N+F*T/I,O=N+(F+1)*T/I;D[F]=[A,E,M,O,n,r,f,d]}return Tq[c]=D}(r[5],r[6],r[0],r[1],r[3],r[4],r[2],t,n),i=0;i<a.length;++i){var o=Fq(a[i]);e.bezierCurveTo(o[0],o[1],o[2],o[3],o[4],o[5])}}var Bq=.5773502691896257,zq={circle:{draw:function(e,t){var n=Math.sqrt(t)/2;e.moveTo(n,0),e.arc(0,0,n,0,Eq)}},cross:{draw:function(e,t){var n=Math.sqrt(t)/2,r=n/2.5;e.moveTo(-n,-r),e.lineTo(-n,r),e.lineTo(-r,r),e.lineTo(-r,n),e.lineTo(r,n),e.lineTo(r,r),e.lineTo(n,r),e.lineTo(n,-r),e.lineTo(r,-r),e.lineTo(r,-n),e.lineTo(-r,-n),e.lineTo(-r,-r),e.closePath()}},diamond:{draw:function(e,t){var n=Math.sqrt(t)/2;e.moveTo(-n,0),e.lineTo(0,-n),e.lineTo(n,0),e.lineTo(0,n),e.closePath()}},square:{draw:function(e,t){var n=Math.sqrt(t),r=-n/2;e.rect(r,r,n,n)}},arrow:{draw:function(e,t){var n=Math.sqrt(t)/2,r=n/7,a=n/2.5,i=n/8;e.moveTo(-r,n),e.lineTo(r,n),e.lineTo(r,-i),e.lineTo(a,-i),e.lineTo(0,-n),e.lineTo(-a,-i),e.lineTo(-r,-i),e.closePath()}},wedge:{draw:function(e,t){var n=Math.sqrt(t)/2,r=Nq*n,a=r-n*Bq,i=n/4;e.moveTo(0,-r-a),e.lineTo(-i,r-a),e.lineTo(i,r-a),e.closePath()}},triangle:{draw:function(e,t){var n=Math.sqrt(t)/2,r=Nq*n,a=r-n*Bq;e.moveTo(0,-r-a),e.lineTo(-n,r-a),e.lineTo(n,r-a),e.closePath()}},"triangle-up":{draw:function(e,t){var n=Math.sqrt(t)/2,r=Nq*n;e.moveTo(0,-r),e.lineTo(-n,r),e.lineTo(n,r),e.closePath()}},"triangle-down":{draw:function(e,t){var n=Math.sqrt(t)/2,r=Nq*n;e.moveTo(0,r),e.lineTo(-n,-r),e.lineTo(n,-r),e.closePath()}},"triangle-right":{draw:function(e,t){var n=Math.sqrt(t)/2,r=Nq*n;e.moveTo(r,0),e.lineTo(-r,-n),e.lineTo(-r,n),e.closePath()}},"triangle-left":{draw:function(e,t){var n=Math.sqrt(t)/2,r=Nq*n;e.moveTo(-r,0),e.lineTo(r,-n),e.lineTo(r,n),e.closePath()}},stroke:{draw:function(e,t){var n=Math.sqrt(t)/2;e.moveTo(-n,0),e.lineTo(n,0)}}};function Zq(e){return st(zq,e)?zq[e]:function(e){if(!st(Lq,e)){var t=Sq(e);Lq[e]={draw:function(e,n){Rq(e,t,0,0,Math.sqrt(n)/2)}}}return Lq[e]}(e)}var Lq={};var Pq=.448084975506;function Uq(e){return e.x}function Wq(e){return e.y}function Vq(e){return e.width}function qq(e){return e.height}function Gq(e){return"function"===typeof e?e:function(){return+e}}function Hq(e,t,n){return Math.max(t,Math.min(e,n))}function Xq(){var e=Uq,t=Wq,n=Vq,r=qq,a=Gq(0),i=a,o=a,u=a,s=null;function c(c,l,f){var d,h=null!=l?l:+e.call(this,c),p=null!=f?f:+t.call(this,c),v=+n.call(this,c),m=+r.call(this,c),g=Math.min(v,m)/2,y=Hq(+a.call(this,c),0,g),b=Hq(+i.call(this,c),0,g),x=Hq(+o.call(this,c),0,g),w=Hq(+u.call(this,c),0,g);if(s||(s=d=MP()),y<=0&&b<=0&&x<=0&&w<=0)s.rect(h,p,v,m);else{var k=h+v,_=p+m;s.moveTo(h+y,p),s.lineTo(k-b,p),s.bezierCurveTo(k-Pq*b,p,k,p+Pq*b,k,p+b),s.lineTo(k,_-w),s.bezierCurveTo(k,_-Pq*w,k-Pq*w,_,k-w,_),s.lineTo(h+x,_),s.bezierCurveTo(h+Pq*x,_,h,_-Pq*x,h,_-x),s.lineTo(h,p+y),s.bezierCurveTo(h,p+Pq*y,h+Pq*y,p,h+y,p),s.closePath()}if(d)return s=null,d+""||null}return c.x=function(t){return arguments.length?(e=Gq(t),c):e},c.y=function(e){return arguments.length?(t=Gq(e),c):t},c.width=function(e){return arguments.length?(n=Gq(e),c):n},c.height=function(e){return arguments.length?(r=Gq(e),c):r},c.cornerRadius=function(e,t,n,r){return arguments.length?(a=Gq(e),i=null!=t?Gq(t):a,u=null!=n?Gq(n):a,o=null!=r?Gq(r):i,c):a},c.context=function(e){return arguments.length?(s=null==e?null:e,c):s},c}function Kq(){var e,t,n,r,a,i,o,u,s=null;function c(e,t,n){var r=n/2;if(a){var c=o-t,l=e-i;if(c||l){var f=Math.sqrt(c*c+l*l),d=(c/=f)*u,h=(l/=f)*u,p=Math.atan2(l,c);s.moveTo(i-d,o-h),s.lineTo(e-c*r,t-l*r),s.arc(e,t,r,p-Math.PI,p),s.lineTo(i+d,o+h),s.arc(i,o,u,p,p+Math.PI)}else s.arc(e,t,r,0,Eq);s.closePath()}else a=1;i=e,o=t,u=r}function l(i){var o,u,l,f=i.length,d=!1;for(null==s&&(s=l=MP()),o=0;o<=f;++o)!(o<f&&r(u=i[o],o,i))===d&&(d=!d)&&(a=0),d&&c(+e(u,o,i),+t(u,o,i),+n(u,o,i));if(l)return s=null,l+""||null}return l.x=function(t){return arguments.length?(e=t,l):e},l.y=function(e){return arguments.length?(t=e,l):t},l.size=function(e){return arguments.length?(n=e,l):n},l.defined=function(e){return arguments.length?(r=e,l):r},l.context=function(e){return arguments.length?(s=null==e?null:e,l):s},l}function Yq(e,t){return null!=e?e:t}var $q=function(e){return e.x||0},Qq=function(e){return e.y||0},Jq=function(e){return!(!1===e.defined)},eG=function(){var e=RP,t=jP,n=OP(0),r=null,a=BP,i=zP,o=ZP,u=null;function s(){var s,c,l=+e.apply(this,arguments),f=+t.apply(this,arguments),d=a.apply(this,arguments)-rP,h=i.apply(this,arguments)-rP,p=XL(h-d),v=h>d;if(u||(u=s=MP()),f<l&&(c=f,f=l,l=c),f>tP)if(p>aP-tP)u.moveTo(f*YL(d),f*JL(d)),u.arc(0,0,f,d,h,!v),l>tP&&(u.moveTo(l*YL(h),l*JL(h)),u.arc(0,0,l,h,d,v));else{var m,g,y=d,b=h,x=d,w=h,k=p,_=p,S=o.apply(this,arguments)/2,C=S>tP&&(r?+r.apply(this,arguments):eP(l*l+f*f)),A=QL(XL(f-l)/2,+n.apply(this,arguments)),E=A,N=A;if(C>tP){var T=oP(C/l*JL(S)),I=oP(C/f*JL(S));(k-=2*T)>tP?(x+=T*=v?1:-1,w-=T):(k=0,x=w=(d+h)/2),(_-=2*I)>tP?(y+=I*=v?1:-1,b-=I):(_=0,y=b=(d+h)/2)}var D=f*YL(y),F=f*JL(y),M=l*YL(w),O=l*JL(w);if(A>tP){var R,j=f*YL(b),B=f*JL(b),z=l*YL(x),Z=l*JL(x);if(p<nP&&(R=LP(D,F,z,Z,j,B,M,O))){var L=D-R[0],P=F-R[1],U=j-R[0],W=B-R[1],V=1/JL(iP((L*U+P*W)/(eP(L*L+P*P)*eP(U*U+W*W)))/2),q=eP(R[0]*R[0]+R[1]*R[1]);E=QL(A,(l-q)/(V-1)),N=QL(A,(f-q)/(V+1))}}_>tP?N>tP?(m=PP(z,Z,D,F,f,N,v),g=PP(j,B,M,O,f,N,v),u.moveTo(m.cx+m.x01,m.cy+m.y01),N<A?u.arc(m.cx,m.cy,N,KL(m.y01,m.x01),KL(g.y01,g.x01),!v):(u.arc(m.cx,m.cy,N,KL(m.y01,m.x01),KL(m.y11,m.x11),!v),u.arc(0,0,f,KL(m.cy+m.y11,m.cx+m.x11),KL(g.cy+g.y11,g.cx+g.x11),!v),u.arc(g.cx,g.cy,N,KL(g.y11,g.x11),KL(g.y01,g.x01),!v))):(u.moveTo(D,F),u.arc(0,0,f,y,b,!v)):u.moveTo(D,F),l>tP&&k>tP?E>tP?(m=PP(M,O,j,B,l,-E,v),g=PP(D,F,z,Z,l,-E,v),u.lineTo(m.cx+m.x01,m.cy+m.y01),E<A?u.arc(m.cx,m.cy,E,KL(m.y01,m.x01),KL(g.y01,g.x01),!v):(u.arc(m.cx,m.cy,E,KL(m.y01,m.x01),KL(m.y11,m.x11),!v),u.arc(0,0,l,KL(m.cy+m.y11,m.cx+m.x11),KL(g.cy+g.y11,g.cx+g.x11),v),u.arc(g.cx,g.cy,E,KL(g.y11,g.x11),KL(g.y01,g.x01),!v))):u.arc(0,0,l,w,x,v):u.lineTo(M,O)}else u.moveTo(0,0);if(u.closePath(),s)return u=null,s+""||null}return s.centroid=function(){var n=(+e.apply(this,arguments)+ +t.apply(this,arguments))/2,r=(+a.apply(this,arguments)+ +i.apply(this,arguments))/2-nP/2;return[YL(r)*n,JL(r)*n]},s.innerRadius=function(t){return arguments.length?(e="function"===typeof t?t:OP(+t),s):e},s.outerRadius=function(e){return arguments.length?(t="function"===typeof e?e:OP(+e),s):t},s.cornerRadius=function(e){return arguments.length?(n="function"===typeof e?e:OP(+e),s):n},s.padRadius=function(e){return arguments.length?(r=null==e?null:"function"===typeof e?e:OP(+e),s):r},s.startAngle=function(e){return arguments.length?(a="function"===typeof e?e:OP(+e),s):a},s.endAngle=function(e){return arguments.length?(i="function"===typeof e?e:OP(+e),s):i},s.padAngle=function(e){return arguments.length?(o="function"===typeof e?e:OP(+e),s):o},s.context=function(e){return arguments.length?(u=null==e?null:e,s):u},s}().startAngle((function(e){return e.startAngle||0})).endAngle((function(e){return e.endAngle||0})).padAngle((function(e){return e.padAngle||0})).innerRadius((function(e){return e.innerRadius||0})).outerRadius((function(e){return e.outerRadius||0})).cornerRadius((function(e){return e.cornerRadius||0})),tG=GP().x($q).y1(Qq).y0((function(e){return(e.y||0)+(e.height||0)})).defined(Jq),nG=GP().y(Qq).x1($q).x0((function(e){return(e.x||0)+(e.width||0)})).defined(Jq),rG=qP().x($q).y(Qq).defined(Jq),aG=Xq().x($q).y(Qq).width((function(e){return e.width||0})).height((function(e){return e.height||0})).cornerRadius((function(e){return Yq(e.cornerRadiusTopLeft,e.cornerRadius)||0}),(function(e){return Yq(e.cornerRadiusTopRight,e.cornerRadius)||0}),(function(e){return Yq(e.cornerRadiusBottomRight,e.cornerRadius)||0}),(function(e){return Yq(e.cornerRadiusBottomLeft,e.cornerRadius)||0})),iG=function(e,t){var n=null;function r(){var r;if(n||(n=r=MP()),e.apply(this,arguments).draw(n,+t.apply(this,arguments)),r)return n=null,r+""||null}return e="function"===typeof e?e:OP(e||HP),t="function"===typeof t?t:OP(void 0===t?64:+t),r.type=function(t){return arguments.length?(e="function"===typeof t?t:OP(t),r):e},r.size=function(e){return arguments.length?(t="function"===typeof e?e:OP(+e),r):t},r.context=function(e){return arguments.length?(n=null==e?null:e,r):n},r}().type((function(e){return Zq(e.shape||"circle")})).size((function(e){return Yq(e.size,64)})),oG=Kq().x($q).y(Qq).defined(Jq).size((function(e){return e.size||1}));function uG(e){return e.cornerRadius||e.cornerRadiusTopLeft||e.cornerRadiusTopRight||e.cornerRadiusBottomRight||e.cornerRadiusBottomLeft}function sG(e,t,n,r){return aG.context(e)(t,n,r)}var cG=1;function lG(){cG=1}function fG(e,t,n){var r=t.clip,a=e._defs,i=t.clip_id||(t.clip_id="clip"+cG++),o=a.clipping[i]||(a.clipping[i]={id:i});return Ye(r)?o.path=r(null):uG(n)?o.path=sG(null,n,0,0):(o.width=n.width||0,o.height=n.height||0),"url(#"+i+")"}function dG(e){this.clear(),e&&this.union(e)}function hG(e){this.mark=e,this.bounds=this.bounds||new dG}function pG(e){hG.call(this,e),this.items=this.items||[]}function vG(e){this._pending=0,this._loader=e||hq()}function mG(e){e._pending+=1}function gG(e){e._pending-=1}function yG(e,t,n){if(t.stroke&&0!==t.opacity&&0!==t.strokeOpacity){var r=null!=t.strokeWidth?+t.strokeWidth:1;e.expand(r+(n?function(e,t){return e.strokeJoin&&"miter"!==e.strokeJoin?0:t}(t,r):0))}return e}dG.prototype={clone:function(){return new dG(this)},clear:function(){return this.x1=+Number.MAX_VALUE,this.y1=+Number.MAX_VALUE,this.x2=-Number.MAX_VALUE,this.y2=-Number.MAX_VALUE,this},empty:function(){return this.x1===+Number.MAX_VALUE&&this.y1===+Number.MAX_VALUE&&this.x2===-Number.MAX_VALUE&&this.y2===-Number.MAX_VALUE},equals:function(e){return this.x1===e.x1&&this.y1===e.y1&&this.x2===e.x2&&this.y2===e.y2},set:function(e,t,n,r){return n<e?(this.x2=e,this.x1=n):(this.x1=e,this.x2=n),r<t?(this.y2=t,this.y1=r):(this.y1=t,this.y2=r),this},add:function(e,t){return e<this.x1&&(this.x1=e),t<this.y1&&(this.y1=t),e>this.x2&&(this.x2=e),t>this.y2&&(this.y2=t),this},expand:function(e){return this.x1-=e,this.y1-=e,this.x2+=e,this.y2+=e,this},round:function(){return this.x1=Math.floor(this.x1),this.y1=Math.floor(this.y1),this.x2=Math.ceil(this.x2),this.y2=Math.ceil(this.y2),this},scale:function(e){return this.x1*=e,this.y1*=e,this.x2*=e,this.y2*=e,this},translate:function(e,t){return this.x1+=e,this.x2+=e,this.y1+=t,this.y2+=t,this},rotate:function(e,t,n){var r=this.rotatedPoints(e,t,n);return this.clear().add(r[0],r[1]).add(r[2],r[3]).add(r[4],r[5]).add(r[6],r[7])},rotatedPoints:function(e,t,n){var r=this.x1,a=this.y1,i=this.x2,o=this.y2,u=Math.cos(e),s=Math.sin(e),c=t-t*u+n*s,l=n-t*s-n*u;return[u*r-s*a+c,s*r+u*a+l,u*r-s*o+c,s*r+u*o+l,u*i-s*a+c,s*i+u*a+l,u*i-s*o+c,s*i+u*o+l]},union:function(e){return e.x1<this.x1&&(this.x1=e.x1),e.y1<this.y1&&(this.y1=e.y1),e.x2>this.x2&&(this.x2=e.x2),e.y2>this.y2&&(this.y2=e.y2),this},intersect:function(e){return e.x1>this.x1&&(this.x1=e.x1),e.y1>this.y1&&(this.y1=e.y1),e.x2<this.x2&&(this.x2=e.x2),e.y2<this.y2&&(this.y2=e.y2),this},encloses:function(e){return e&&this.x1<=e.x1&&this.x2>=e.x2&&this.y1<=e.y1&&this.y2>=e.y2},alignsWith:function(e){return e&&(this.x1==e.x1||this.x2==e.x2||this.y1==e.y1||this.y2==e.y2)},intersects:function(e){return e&&!(this.x2<e.x1||this.x1>e.x2||this.y2<e.y1||this.y1>e.y2)},contains:function(e,t){return!(e<this.x1||e>this.x2||t<this.y1||t>this.y2)},width:function(){return this.x2-this.x1},height:function(){return this.y2-this.y1}},dt(pG,hG),vG.prototype={pending:function(){return this._pending},sanitizeURL:function(e){var t=this;return mG(t),t._loader.sanitize(e,{context:"href"}).then((function(e){return gG(t),e})).catch((function(){return gG(t),null}))},loadImage:function(e){var t=this,n=Fp();return mG(t),t._loader.sanitize(e,{context:"image"}).then((function(e){var r=e.href;if(!r||!n)throw{url:r};var a=new n,i=st(e,"crossOrigin")?e.crossOrigin:"anonymous";return null!=i&&(a.crossOrigin=i),a.onload=function(){return gG(t)},a.onerror=function(){return gG(t)},a.src=r,a})).catch((function(e){return gG(t),{complete:!1,width:0,height:0,src:e&&e.url||""}}))},ready:function(){var e=this;return new Promise((function(t){!function n(r){e.pending()?setTimeout((function(){n(!0)}),10):t(r)}(!1)}))}};var bG,xG,wG,kG,_G,SG,CG,AG,EG=Eq-1e-8,NG=function(e,t){return bG.add(e,t)},TG=function(e,t){return NG(xG=e,wG=t)},IG=function(e){return NG(e,bG.y1)},DG=function(e){return NG(bG.x1,e)},FG=function(e,t){return _G*e+CG*t},MG=function(e,t){return SG*e+AG*t},OG=function(e,t){return NG(FG(e,t),MG(e,t))},RG=function(e,t){return TG(FG(e,t),MG(e,t))};function jG(e,t){return bG=e,t?(kG=t*Cq,_G=AG=Math.cos(kG),SG=Math.sin(kG),CG=-SG):(_G=AG=1,kG=SG=CG=0),BG}var BG={beginPath:function(){},closePath:function(){},moveTo:RG,lineTo:RG,rect:function(e,t,n,r){kG?(OG(e+n,t),OG(e+n,t+r),OG(e,t+r),RG(e,t)):(NG(e+n,t+r),TG(e,t))},quadraticCurveTo:function(e,t,n,r){var a=FG(e,t),i=MG(e,t),o=FG(n,r),u=MG(n,r);zG(xG,a,o,IG),zG(wG,i,u,DG),TG(o,u)},bezierCurveTo:function(e,t,n,r,a,i){var o=FG(e,t),u=MG(e,t),s=FG(n,r),c=MG(n,r),l=FG(a,i),f=MG(a,i);ZG(xG,o,s,l,IG),ZG(wG,u,c,f,DG),TG(l,f)},arc:function(e,t,n,r,a,i){if(r+=kG,a+=kG,xG=n*Math.cos(a)+e,wG=n*Math.sin(a)+t,Math.abs(a-r)>EG)NG(e-n,t-n),NG(e+n,t+n);else{var o,u,s=function(r){return NG(n*Math.cos(r)+e,n*Math.sin(r)+t)};if(s(r),s(a),a!==r)if((r%=Eq)<0&&(r+=Eq),(a%=Eq)<0&&(a+=Eq),a<r&&(i=!i,o=r,r=a,a=o),i)for(a-=Eq,o=r-r%Aq,u=0;u<4&&o>a;++u,o-=Aq)s(o);else for(o=r-r%Aq+Aq,u=0;u<4&&o<a;++u,o+=Aq)s(o)}}};function zG(e,t,n,r){var a=(e-t)/(e+n-2*t);0<a&&a<1&&r(e+(t-e)*a)}function ZG(e,t,n,r,a){var i,o=r-e+3*t-3*n,u=e+n-2*t,s=e-t,c=0,l=0;Math.abs(o)>1e-14?(i=u*u+s*o)>=0&&(c=(-u+(i=Math.sqrt(i)))/o,l=(-u-i)/o):c=.5*s/u,0<c&&c<1&&a(LG(c,e,t,n,r)),0<l&&l<1&&a(LG(l,e,t,n,r))}function LG(e,t,n,r,a){var i=1-e,o=i*i,u=e*e;return o*i*t+3*o*e*n+3*i*u*r+u*e*a}var PG=(PG=Ip(1,1))?PG.getContext("2d"):null,UG=new dG;function WG(e){return function(t,n){if(!PG)return!0;e(PG,t),UG.clear().union(t.bounds).intersect(n).round();for(var r=UG.x1,a=UG.y1,i=UG.x2,o=UG.y2,u=a;u<=o;++u)for(var s=r;s<=i;++s)if(PG.isPointInPath(s,u))return!0;return!1}}function VG(e,t){return t.contains(e.x||0,e.y||0)}function qG(e,t){var n=e.x||0,r=e.y||0,a=e.width||0,i=e.height||0;return t.intersects(UG.set(n,r,n+a,r+i))}function GG(e,t){var n=e.x||0,r=e.y||0;return HG(t,n,r,null!=e.x2?e.x2:n,null!=e.y2?e.y2:r)}function HG(e,t,n,r,a){var i,o,u,s,c=e.x1,l=e.y1,f=e.x2,d=e.y2,h=r-t,p=a-n,v=0,m=1;for(s=0;s<4;++s){if(0===s&&(i=-h,o=-(c-t)),1===s&&(i=h,o=f-t),2===s&&(i=-p,o=-(l-n)),3===s&&(i=p,o=d-n),Math.abs(i)<1e-10&&o<0)return!1;if(u=o/i,i<0){if(u>m)return!1;u>v&&(v=u)}else if(i>0){if(u<v)return!1;u<m&&(m=u)}}return!0}function XG(e,t){e.globalCompositeOperation=t.blend||"source-over"}function KG(e,t){return null==e?t:e}function YG(e,t){for(var n=t.length,r=0;r<n;++r)e.addColorStop(t[r].offset,t[r].color);return e}function $G(e,t,n){return mq(n)?function(e,t,n){var r,a=n.width(),i=n.height();if("radial"===t.gradient)r=e.createRadialGradient(n.x1+KG(t.x1,.5)*a,n.y1+KG(t.y1,.5)*i,Math.max(a,i)*KG(t.r1,0),n.x1+KG(t.x2,.5)*a,n.y1+KG(t.y2,.5)*i,Math.max(a,i)*KG(t.r2,.5));else{var o=KG(t.x1,0),u=KG(t.y1,0),s=KG(t.x2,1),c=KG(t.y2,0);if(o!==s&&u!==c&&a!==i){var l=Ip(Math.ceil(a),Math.ceil(i)),f=l.getContext("2d");return f.scale(a,i),f.fillStyle=YG(f.createLinearGradient(o,u,s,c),t.stops),f.fillRect(0,0,a,i),e.createPattern(l,"no-repeat")}r=e.createLinearGradient(n.x1+o*a,n.y1+u*i,n.x1+s*a,n.y1+c*i)}return YG(r,t.stops)}(e,n,t.bounds):n}function QG(e,t,n){return(n*=null==t.fillOpacity?1:t.fillOpacity)>0&&(e.globalAlpha=n,e.fillStyle=$G(e,t,t.fill),!0)}var JG=[];function eH(e,t,n){var r=null!=(r=t.strokeWidth)?r:1;return!(r<=0)&&((n*=null==t.strokeOpacity?1:t.strokeOpacity)>0&&(e.globalAlpha=n,e.strokeStyle=$G(e,t,t.stroke),e.lineWidth=r,e.lineCap=t.strokeCap||"butt",e.lineJoin=t.strokeJoin||"miter",e.miterLimit=t.strokeMiterLimit||10,e.setLineDash&&(e.setLineDash(t.strokeDash||JG),e.lineDashOffset=t.strokeDashOffset||0),!0))}function tH(e,t){return e.zindex-t.zindex||e.index-t.index}function nH(e){if(!e.zdirty)return e.zitems;var t,n,r,a=e.items,i=[];for(n=0,r=a.length;n<r;++n)(t=a[n]).index=n,t.zindex&&i.push(t);return e.zdirty=!1,e.zitems=i.sort(tH)}function rH(e,t){var n,r,a=e.items;if(a&&a.length){var i=nH(e);if(i&&i.length){for(n=0,r=a.length;n<r;++n)a[n].zindex||t(a[n]);a=i}for(n=0,r=a.length;n<r;++n)t(a[n])}}function aH(e,t){var n,r,a=e.items;if(!a||!a.length)return null;var i=nH(e);for(i&&i.length&&(a=i),r=a.length;--r>=0;)if(n=t(a[r]))return n;if(a===i)for(r=(a=e.items).length;--r>=0;)if(!a[r].zindex&&(n=t(a[r])))return n;return null}function iH(e){return function(t,n,r){rH(n,(function(n){r&&!r.intersects(n.bounds)||uH(e,t,n,n)}))}}function oH(e){return function(t,n,r){!n.items.length||r&&!r.intersects(n.bounds)||uH(e,t,n.items[0],n.items)}}function uH(e,t,n,r){var a=null==n.opacity?1:n.opacity;0!==a&&(e(t,r)||(XG(t,n),n.fill&&QG(t,n,a)&&t.fill(),n.stroke&&eH(t,n,a)&&t.stroke()))}function sH(e){return e=e||pe,function(t,n,r,a,i,o){return r*=t.pixelRatio,a*=t.pixelRatio,aH(n,(function(n){var u=n.bounds;if((!u||u.contains(i,o))&&u)return e(t,n,r,a,i,o)?n:void 0}))}}function cH(e,t){return function(n,r,a,i){var o,u,s=Array.isArray(r)?r[0]:r,c=null==t?s.fill:t,l=s.stroke&&n.isPointInStroke;return l&&(o=s.strokeWidth,u=s.strokeCap,n.lineWidth=null!=o?o:1,n.lineCap=null!=u?u:"butt"),!e(n,r)&&(c&&n.isPointInPath(a,i)||l&&n.isPointInStroke(a,i))}}function lH(e){return sH(cH(e))}function fH(e,t){return"translate("+e+","+t+")"}function dH(e){return"rotate("+e+")"}function hH(e){return fH(e.x||0,e.y||0)}function pH(e,t,n){function r(e,n){var r=n.x||0,a=n.y||0,i=n.angle||0;e.translate(r,a),i&&e.rotate(i*=Cq),e.beginPath(),t(e,n),i&&e.rotate(-i),e.translate(-r,-a)}return{type:e,tag:"path",nested:!1,attr:function(e,n){e("transform",function(e){return fH(e.x||0,e.y||0)+(e.angle?" "+dH(e.angle):"")}(n)),e("d",t(null,n))},bound:function(e,n){return t(jG(e,n.angle),n),yG(e,n).translate(n.x||0,n.y||0)},draw:iH(r),pick:lH(r),isect:n||WG(r)}}var vH=pH("arc",(function(e,t){return eG.context(e)(t)}));function mH(e,t,n){function r(e,n){e.beginPath(),t(e,n)}var a=cH(r);return{type:e,tag:"path",nested:!0,attr:function(e,n){var r=n.mark.items;r.length&&e("d",t(null,r))},bound:function(e,n){var r=n.items;return 0===r.length?e:(t(jG(e),r),yG(e,r[0]))},draw:oH(r),pick:function(e,t,n,r,i,o){var u=t.items,s=t.bounds;return!u||!u.length||s&&!s.contains(i,o)?null:(n*=e.pixelRatio,r*=e.pixelRatio,a(e,u,n,r)?u[0]:null)},isect:VG,tip:n}}var gH=mH("area",(function(e,t){var n=t[0],r=n.interpolate||"linear";return("horizontal"===n.orient?nG:tG).curve(wq(r,n.orient,n.tension)).context(e)(t)}),(function(e,t){for(var n,r,a="horizontal"===e[0].orient?t[1]:t[0],i="horizontal"===e[0].orient?"y":"x",o=e.length,u=1/0;--o>=0;)!1!==e[o].defined&&(r=Math.abs(e[o][i]-a))<u&&(u=r,n=e[o]);return n}));function yH(e,t){e.beginPath(),uG(t)?sG(e,t,0,0):e.rect(0,0,t.width||0,t.height||0),e.clip()}function bH(e){var t=KG(e.strokeWidth,1);return null!=e.strokeOffset?e.strokeOffset:e.stroke&&t>.5&&t<1.5?.5-Math.abs(t-1):0}function xH(e,t){var n=bH(t);e("d",sG(null,t,n,n))}function wH(e,t,n,r){var a=bH(t);e.beginPath(),sG(e,t,(n||0)+a,(r||0)+a)}var kH=cH(wH),_H=cH(wH,!1),SH=cH(wH,!0);var CH={type:"group",tag:"g",nested:!1,attr:function(e,t){e("transform",hH(t))},bound:function(e,t){if(!t.clip&&t.items)for(var n=t.items,r=n.length,a=0;a<r;++a)e.union(n[a].bounds);return(t.clip||t.width||t.height)&&!t.noBound&&e.add(0,0).add(t.width||0,t.height||0),yG(e,t),e.translate(t.x||0,t.y||0)},draw:function(e,t,n){var r=this;rH(t,(function(t){var a=t.x||0,i=t.y||0,o=t.strokeForeground,u=null==t.opacity?1:t.opacity;(t.stroke||t.fill)&&u&&(wH(e,t,a,i),XG(e,t),t.fill&&QG(e,t,u)&&e.fill(),t.stroke&&!o&&eH(e,t,u)&&e.stroke()),e.save(),e.translate(a,i),t.clip&&yH(e,t),n&&n.translate(-a,-i),rH(t,(function(t){r.draw(e,t,n)})),n&&n.translate(a,i),e.restore(),o&&t.stroke&&u&&(wH(e,t,a,i),XG(e,t),eH(e,t,u)&&e.stroke())}))},pick:function(e,t,n,r,a,i){var o=this;if(t.bounds&&!t.bounds.contains(a,i)||!t.items)return null;var u=n*e.pixelRatio,s=r*e.pixelRatio;return aH(t,(function(c){var l,f,d,h=c.bounds;if(!h||h.contains(a,i)){f=c.x||0,d=c.y||0;var p=f+(c.width||0),v=d+(c.height||0),m=c.clip;if(!m||!(a<f||a>p||i<d||i>v)){if(e.save(),e.translate(f,d),f=a-f,d=i-d,m&&uG(c)&&!SH(e,c,u,s))return e.restore(),null;var g=c.strokeForeground,y=!1!==t.interactive;return y&&g&&c.stroke&&_H(e,c,u,s)?(e.restore(),c):(!(l=aH(c,(function(e){return function(e,t,n){return(!1!==e.interactive||"group"===e.marktype)&&e.bounds&&e.bounds.contains(t,n)}(e,f,d)?o.pick(e,n,r,f,d):null})))&&y&&(c.fill||!g&&c.stroke)&&kH(e,c,u,s)&&(l=c),e.restore(),l||null)}}}))},isect:qG,content:function(e,t,n){e("clip-path",t.clip?fG(n,t,t):null)},background:function(e,t){e("class","background"),e("aria-hidden",!0),xH(e,t)},foreground:function(e,t){e("class","foreground"),e("aria-hidden",!0),t.strokeForeground?xH(e,t):e("d","")}},AH={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",version:"1.1"};function EH(e,t){var n=e.image;return(!n||e.url&&e.url!==n.url)&&(n={complete:!1,width:0,height:0},t.loadImage(e.url).then((function(t){e.image=t,e.image.url=e.url}))),n}function NH(e,t){return null!=e.width?e.width:t&&t.width?!1!==e.aspect&&e.height?e.height*t.width/t.height:t.width:0}function TH(e,t){return null!=e.height?e.height:t&&t.height?!1!==e.aspect&&e.width?e.width*t.height/t.width:t.height:0}function IH(e,t){return"center"===e?t/2:"right"===e?t:0}function DH(e,t){return"middle"===e?t/2:"bottom"===e?t:0}var FH={type:"image",tag:"image",nested:!1,attr:function(e,t,n){var r=EH(t,n),a=NH(t,r),i=TH(t,r),o=(t.x||0)-IH(t.align,a),u=(t.y||0)-DH(t.baseline,i);e("href",!r.src&&r.toDataURL?r.toDataURL():r.src||"",AH["xmlns:xlink"],"xlink:href"),e("transform",fH(o,u)),e("width",a),e("height",i),e("preserveAspectRatio",!1===t.aspect?"none":"xMidYMid")},bound:function(e,t){var n=t.image,r=NH(t,n),a=TH(t,n),i=(t.x||0)-IH(t.align,r),o=(t.y||0)-DH(t.baseline,a);return e.set(i,o,i+r,o+a)},draw:function(e,t,n){var r=this;rH(t,(function(t){if(!n||n.intersects(t.bounds)){var a=EH(t,r),i=NH(t,a),o=TH(t,a);if(0!==i&&0!==o){var u,s,c,l,f=(t.x||0)-IH(t.align,i),d=(t.y||0)-DH(t.baseline,o);!1!==t.aspect&&(s=a.width/a.height,c=t.width/t.height,s===s&&c===c&&s!==c&&(c<s?(d+=(o-(l=i/s))/2,o=l):(f+=(i-(l=o*s))/2,i=l))),(a.complete||a.toDataURL)&&(XG(e,t),e.globalAlpha=null!=(u=t.opacity)?u:1,e.imageSmoothingEnabled=!1!==t.smooth,e.drawImage(a,f,d,i,o))}}}))},pick:sH(),isect:pe,get:EH,xOffset:IH,yOffset:DH},MH=mH("line",(function(e,t){var n=t[0],r=n.interpolate||"linear";return rG.curve(wq(r,n.orient,n.tension)).context(e)(t)}),(function(e,t){for(var n,r,a=Math.pow(e[0].strokeWidth||1,2),i=e.length;--i>=0;)if(!1!==e[i].defined&&(n=e[i].x-t[0])*n+(r=e[i].y-t[1])*r<a)return e[i];return null}));function OH(e,t){var n=t.path;if(null==n)return!0;var r=t.x||0,a=t.y||0,i=t.scaleX||1,o=t.scaleY||1,u=(t.angle||0)*Cq,s=t.pathCache;s&&s.path===n||((t.pathCache=s=Sq(n)).path=n),u&&e.rotate&&e.translate?(e.translate(r,a),e.rotate(u),Rq(e,s,0,0,i,o),e.rotate(-u),e.translate(-r,-a)):Rq(e,s,r,a,i,o)}var RH={type:"path",tag:"path",nested:!1,attr:function(e,t){var n=t.scaleX||1,r=t.scaleY||1;1===n&&1===r||e("vector-effect","non-scaling-stroke"),e("transform",function(e){return fH(e.x||0,e.y||0)+(e.angle?" "+dH(e.angle):"")+(e.scaleX||e.scaleY?" "+function(e,t){return"scale("+e+","+t+")"}(e.scaleX||1,e.scaleY||1):"")}(t)),e("d",t.path)},bound:function(e,t){return OH(jG(e,t.angle),t)?e.set(0,0,0,0):yG(e,t,!0)},draw:iH(OH),pick:lH(OH),isect:WG(OH)};function jH(e,t){e.beginPath(),sG(e,t)}var BH={type:"rect",tag:"path",nested:!1,attr:function(e,t){e("d",sG(null,t))},bound:function(e,t){var n,r;return yG(e.set(n=t.x||0,r=t.y||0,n+t.width||0,r+t.height||0),t)},draw:iH(jH),pick:lH(jH),isect:qG};function zH(e,t,n){var r,a,i,o;return!(!t.stroke||!eH(e,t,n))&&(r=t.x||0,a=t.y||0,i=null!=t.x2?t.x2:r,o=null!=t.y2?t.y2:a,e.beginPath(),e.moveTo(r,a),e.lineTo(i,o),!0)}var ZH={type:"rule",tag:"line",nested:!1,attr:function(e,t){e("transform",hH(t)),e("x2",null!=t.x2?t.x2-(t.x||0):0),e("y2",null!=t.y2?t.y2-(t.y||0):0)},bound:function(e,t){var n,r;return yG(e.set(n=t.x||0,r=t.y||0,null!=t.x2?t.x2:n,null!=t.y2?t.y2:r),t)},draw:function(e,t,n){rH(t,(function(t){if(!n||n.intersects(t.bounds)){var r=null==t.opacity?1:t.opacity;r&&zH(e,t,r)&&(XG(e,t),e.stroke())}}))},pick:sH((function(e,t,n,r){return!!e.isPointInStroke&&(zH(e,t,1)&&e.isPointInStroke(n,r))})),isect:GG},LH=pH("shape",(function(e,t){return(t.mark.shape||t.shape).context(e)(t)})),PH=pH("symbol",(function(e,t){return iG.context(e)(t)}),VG),UH=kt(),WH={height:KH,measureWidth:HH,estimateWidth:qH,width:qH,canvas:VH};function VH(e){WH.width=e&&PG?HH:qH}function qH(e,t){return GH(JH(e,t),KH(e))}function GH(e,t){return~~(.8*e.length*t)}function HH(e,t){return KH(e)<=0||!(t=JH(e,t))?0:XH(t,tX(e))}function XH(e,t){var n="(".concat(t,") ").concat(e),r=UH.get(n);return void 0===r&&(PG.font=t,r=PG.measureText(e).width,UH.set(n,r)),r}function KH(e){return null!=e.fontSize?+e.fontSize||0:11}function YH(e){return null!=e.lineHeight?e.lineHeight:KH(e)+2}function $H(e){return t=e.lineBreak&&e.text&&!_e(e.text)?e.text.split(e.lineBreak):e.text,_e(t)?t.length>1?t:t[0]:t;var t}function QH(e){var t=$H(e);return(_e(t)?t.length-1:0)*YH(e)}function JH(e,t){var n=null==t?"":(t+"").trim();return e.limit>0&&n.length?function(e,t){var n=+e.limit,r=function(e){if(WH.width===HH){var t=tX(e);return function(e){return XH(e,t)}}var n=KH(e);return function(e){return GH(e,n)}}(e);if(r(t)<n)return t;var a,i=e.ellipsis||"\u2026",o="rtl"===e.dir,u=0,s=t.length;if(n-=r(i),o){for(;u<s;)a=u+s>>>1,r(t.slice(a))>n?u=a+1:s=a;return i+t.slice(u)}for(;u<s;)a=1+(u+s>>>1),r(t.slice(0,a))<n?u=a:s=a-1;return t.slice(0,u)+i}(e,n):n}function eX(e,t){var n=e.font;return(t&&n?String(n).replace(/"/g,"'"):n)||"sans-serif"}function tX(e,t){return(e.fontStyle?e.fontStyle+" ":"")+(e.fontVariant?e.fontVariant+" ":"")+(e.fontWeight?e.fontWeight+" ":"")+KH(e)+"px "+eX(e,t)}function nX(e){var t=e.baseline,n=KH(e);return Math.round("top"===t?.79*n:"middle"===t?.3*n:"bottom"===t?-.21*n:"line-top"===t?.29*n+.5*YH(e):"line-bottom"===t?.29*n-.5*YH(e):0)}VH(!0);var rX={left:"start",center:"middle",right:"end"},aX=new dG;function iX(e){var t,n=e.x||0,r=e.y||0,a=e.radius||0;return a&&(t=(e.theta||0)-Aq,n+=a*Math.cos(t),r+=a*Math.sin(t)),aX.x1=n,aX.y1=r,aX}function oX(e,t,n){var r,a=WH.height(t),i=t.align,o=iX(t),u=o.x1,s=o.y1,c=t.dx||0,l=(t.dy||0)+nX(t)-Math.round(.8*a),f=$H(t);if(_e(f)?(a+=YH(t)*(f.length-1),r=f.reduce((function(e,n){return Math.max(e,WH.width(t,n))}),0)):r=WH.width(t,f),"center"===i?c-=r/2:"right"===i&&(c-=r),e.set(c+=u,l+=s,c+r,l+a),t.angle&&!n)e.rotate(t.angle*Cq,u,s);else if(2===n)return e.rotatedPoints(t.angle*Cq,u,s);return e}var uX={type:"text",tag:"text",nested:!1,attr:function(e,t){var n,r=t.dx||0,a=(t.dy||0)+nX(t),i=iX(t),o=i.x1,u=i.y1,s=t.angle||0;e("text-anchor",rX[t.align]||"start"),s?(n=fH(o,u)+" "+dH(s),(r||a)&&(n+=" "+fH(r,a))):n=fH(o+r,u+a),e("transform",n)},bound:oX,draw:function(e,t,n){rH(t,(function(t){var r,a,i,o,u,s,c,l=null==t.opacity?1:t.opacity;if(!(n&&!n.intersects(t.bounds)||0===l||t.fontSize<=0||null==t.text||0===t.text.length)){if(e.font=tX(t),e.textAlign=t.align||"left",a=(r=iX(t)).x1,i=r.y1,t.angle&&(e.save(),e.translate(a,i),e.rotate(t.angle*Cq),a=i=0),a+=t.dx||0,i+=(t.dy||0)+nX(t),s=$H(t),XG(e,t),_e(s))for(u=YH(t),o=0;o<s.length;++o)c=JH(t,s[o]),t.fill&&QG(e,t,l)&&e.fillText(c,a,i),t.stroke&&eH(e,t,l)&&e.strokeText(c,a,i),i+=u;else c=JH(t,s),t.fill&&QG(e,t,l)&&e.fillText(c,a,i),t.stroke&&eH(e,t,l)&&e.strokeText(c,a,i);t.angle&&e.restore()}}))},pick:sH((function(e,t,n,r,a,i){if(t.fontSize<=0)return!1;if(!t.angle)return!0;var o=iX(t),u=o.x1,s=o.y1,c=oX(aX,t,1),l=-t.angle*Cq,f=Math.cos(l),d=Math.sin(l),h=f*a-d*i+(u-f*u+d*s),p=d*a+f*i+(s-d*u-f*s);return c.contains(h,p)})),isect:function(e,t){var n=oX(aX,e,2);return HG(t,n[0],n[1],n[2],n[3])||HG(t,n[0],n[1],n[4],n[5])||HG(t,n[4],n[5],n[6],n[7])||HG(t,n[2],n[3],n[6],n[7])}},sX=mH("trail",(function(e,t){return oG.context(e)(t)}),(function(e,t){for(var n,r,a=e.length;--a>=0;)if(!1!==e[a].defined&&(n=e[a].x-t[0])*n+(r=e[a].y-t[1])*r<(n=e[a].size||1)*n)return e[a];return null})),cX={arc:vH,area:gH,group:CH,image:FH,line:MH,path:RH,rect:BH,rule:ZH,shape:LH,symbol:PH,text:uX,trail:sX};function lX(e,t,n){var r=cX[e.mark.marktype],a=t||r.bound;return r.nested&&(e=e.mark),a(e.bounds||(e.bounds=new dG),e,n)}var fX={mark:null};function dX(e,t,n){var r,a,i,o,u=cX[e.marktype],s=u.bound,c=e.items,l=c&&c.length;if(u.nested)return l?i=c[0]:(fX.mark=e,i=fX),o=lX(i,s,n),t=t&&t.union(o)||o;if(t=t||e.bounds&&e.bounds.clear()||new dG,l)for(r=0,a=c.length;r<a;++r)t.union(lX(c[r],s,n));return e.bounds=t}var hX=["marktype","name","role","interactive","clip","items","zindex","x","y","width","height","align","baseline","fill","fillOpacity","opacity","blend","stroke","strokeOpacity","strokeWidth","strokeCap","strokeDash","strokeDashOffset","strokeForeground","strokeOffset","startAngle","endAngle","innerRadius","outerRadius","cornerRadius","padAngle","cornerRadiusTopLeft","cornerRadiusTopRight","cornerRadiusBottomLeft","cornerRadiusBottomRight","interpolate","tension","orient","defined","url","aspect","smooth","path","scaleX","scaleY","x2","y2","size","shape","text","angle","theta","radius","dir","dx","dy","ellipsis","limit","lineBreak","lineHeight","font","fontSize","fontWeight","fontStyle","fontVariant","description","aria","ariaRole","ariaRoleDescription"];function pX(e,t){return JSON.stringify(e,hX,t)}function vX(e){return mX("string"===typeof e?JSON.parse(e):e)}function mX(e){var t,n,r,a=e.marktype,i=e.items;if(i)for(n=0,r=i.length;n<r;++n)t=a?"mark":"group",i[n][t]=e,i[n].zindex&&(i[n][t].zdirty=!0),"group"===(a||t)&&mX(i[n]);return a&&dX(e),e}function gX(e){arguments.length?this.root=vX(e):(this.root=yX({marktype:"group",name:"root",role:"frame"}),this.root.items=[new pG(this.root)])}function yX(e,t){var n={bounds:new dG,clip:!!e.clip,group:t,interactive:!1!==e.interactive,items:[],marktype:e.marktype,name:e.name||void 0,role:e.role||void 0,zindex:e.zindex||0};return null!=e.aria&&(n.aria=e.aria),e.description&&(n.description=e.description),n}function bX(e,t,n){return!e&&"undefined"!==typeof document&&document.createElement&&(e=document),e?n?e.createElementNS(n,t):e.createElement(t):null}function xX(e,t){t=t.toLowerCase();for(var n=e.childNodes,r=0,a=n.length;r<a;++r)if(n[r].tagName.toLowerCase()===t)return n[r]}function wX(e,t,n,r){var a,i=e.childNodes[t];return i&&i.tagName.toLowerCase()===n.toLowerCase()||(a=i||null,i=bX(e.ownerDocument,n,r),e.insertBefore(i,a)),i}function kX(e,t){for(var n=e.childNodes,r=n.length;r>t;)e.removeChild(n[--r]);return e}function _X(e){return"mark-"+e.marktype+(e.role?" role-"+e.role:"")+(e.name?" "+e.name:"")}function SX(e,t){var n=t.getBoundingClientRect();return[e.clientX-n.left-(t.clientLeft||0),e.clientY-n.top-(t.clientTop||0)]}function CX(e,t){this._active=null,this._handlers={},this._loader=e||hq(),this._tooltip=t||AX}function AX(e,t,n,r){e.element().setAttribute("title",r||"")}function EX(e){this._el=null,this._bgcolor=null,this._loader=new vG(e)}gX.prototype={toJSON:function(e){return pX(this.root,e||0)},mark:function(e,t,n){var r=yX(e,t=t||this.root.items[0]);return t.items[n]=r,r.zindex&&(r.group.zdirty=!0),r}},CX.prototype={initialize:function(e,t,n){return this._el=e,this._obj=n||null,this.origin(t)},element:function(){return this._el},canvas:function(){return this._el&&this._el.firstChild},origin:function(e){return arguments.length?(this._origin=e||[0,0],this):this._origin.slice()},scene:function(e){return arguments.length?(this._scene=e,this):this._scene},on:function(){},off:function(){},_handlerIndex:function(e,t,n){for(var r=e?e.length:0;--r>=0;)if(e[r].type===t&&(!n||e[r].handler===n))return r;return-1},handlers:function(e){var t=this._handlers,n=[];if(e)n.push.apply(n,(0,cn.Z)(t[this.eventName(e)]));else for(var r in t)n.push.apply(n,(0,cn.Z)(t[r]));return n},eventName:function(e){var t=e.indexOf(".");return t<0?e:e.slice(0,t)},handleHref:function(e,t,n){this._loader.sanitize(n,{context:"href"}).then((function(t){var n=new MouseEvent(e.type,e),r=bX(null,"a");for(var a in t)r.setAttribute(a,t[a]);r.dispatchEvent(n)})).catch((function(){}))},handleTooltip:function(e,t,n){if(t&&null!=t.tooltip){t=function(e,t,n,r){var a,i,o=e&&e.mark;if(o&&(a=cX[o.marktype]).tip){for((i=SX(t,n))[0]-=r[0],i[1]-=r[1];e=e.mark.group;)i[0]-=e.x||0,i[1]-=e.y||0;e=a.tip(o.items,i)}return e}(t,e,this.canvas(),this._origin);var r=n&&t&&t.tooltip||null;this._tooltip.call(this._obj,this,e,t,r)}},getItemBoundingClientRect:function(e){var t=this.canvas();if(t){for(var n=t.getBoundingClientRect(),r=this._origin,a=e.bounds,i=a.width(),o=a.height(),u=a.x1+r[0]+n.left,s=a.y1+r[1]+n.top;e.mark&&(e=e.mark.group);)u+=e.x||0,s+=e.y||0;return{x:u,y:s,width:i,height:o,left:u,top:s,right:u+i,bottom:s+o}}}},EX.prototype={initialize:function(e,t,n,r,a){return this._el=e,this.resize(t,n,r,a)},element:function(){return this._el},canvas:function(){return this._el&&this._el.firstChild},background:function(e){return 0===arguments.length?this._bgcolor:(this._bgcolor=e,this)},resize:function(e,t,n,r){return this._width=e,this._height=t,this._origin=n||[0,0],this._scale=r||1,this},dirty:function(){},render:function(e){var t=this;return t._call=function(){t._render(e)},t._call(),t._call=null,t},_render:function(){},renderAsync:function(e){var t=this.render(e);return this._ready?this._ready.then((function(){return t})):Promise.resolve(t)},_load:function(e,t){var n=this,r=n._loader[e](t);if(!n._ready){var a=n._call;n._ready=n._loader.ready().then((function(e){e&&a(),n._ready=null}))}return r},sanitizeURL:function(e){return this._load("sanitizeURL",e)},loadImage:function(e){return this._load("loadImage",e)}};var NX="dragenter",TX="dragleave",IX="dragover",DX="mousedown",FX="mousemove",MX="mouseout",OX="mouseover",RX="click",jX="mousewheel",BX="touchstart",zX="touchmove",ZX="touchend",LX=FX,PX=MX,UX=RX;function WX(e,t){CX.call(this,e,t),this._down=null,this._touch=null,this._first=!0,this._events={}}function VX(e,t){(function(e){return e===BX||e===zX||e===ZX?[BX,zX,ZX]:[e]})(t).forEach((function(t){return function(e,t){var n=e.canvas();n&&!e._events[t]&&(e._events[t]=1,n.addEventListener(t,e[t]?function(n){return e[t](n)}:function(n){return e.fire(t,n)}))}(e,t)}))}function qX(e,t,n){return function(r){var a=this._active,i=this.pickEvent(r);i===a||(a&&a.exit||this.fire(n,r),this._active=i,this.fire(t,r)),this.fire(e,r)}}function GX(e){return function(t){this.fire(e,t),this._active=null}}dt(WX,CX,{initialize:function(e,t,n){var r=this;return this._canvas=e&&xX(e,"canvas"),[RX,DX,FX,MX,TX].forEach((function(e){return VX(r,e)})),CX.prototype.initialize.call(this,e,t,n)},canvas:function(){return this._canvas},context:function(){return this._canvas.getContext("2d")},events:["keydown","keypress","keyup",NX,TX,IX,DX,"mouseup",FX,MX,OX,RX,"dblclick","wheel",jX,BX,zX,ZX],DOMMouseScroll:function(e){this.fire(jX,e)},mousemove:qX(FX,OX,MX),dragover:qX(IX,NX,TX),mouseout:GX(MX),dragleave:GX(TX),mousedown:function(e){this._down=this._active,this.fire(DX,e)},click:function(e){this._down===this._active&&(this.fire(RX,e),this._down=null)},touchstart:function(e){this._touch=this.pickEvent(e.changedTouches[0]),this._first&&(this._active=this._touch,this._first=!1),this.fire(BX,e,!0)},touchmove:function(e){this.fire(zX,e,!0)},touchend:function(e){this.fire(ZX,e,!0),this._touch=null},fire:function(e,t,n){var r=n?this._touch:this._active,a=this._handlers[e];if(t.vegaType=e,e===UX&&r&&r.href?this.handleHref(t,r,r.href):e!==LX&&e!==PX||this.handleTooltip(t,r,e!==PX),a)for(var i=0,o=a.length;i<o;++i)a[i].handler.call(this._obj,t,r)},on:function(e,t){var n=this.eventName(e),r=this._handlers;return this._handlerIndex(r[n],e,t)<0&&(VX(this,e),(r[n]||(r[n]=[])).push({type:e,handler:t})),this},off:function(e,t){var n=this.eventName(e),r=this._handlers[n],a=this._handlerIndex(r,e,t);return a>=0&&r.splice(a,1),this},pickEvent:function(e){var t=SX(e,this._canvas),n=this._origin;return this.pick(this._scene,t[0],t[1],t[0]-n[0],t[1]-n[1])},pick:function(e,t,n,r,a){var i=this.context();return cX[e.marktype].pick.call(this,i,e,t,n,r,a)}});var HX="undefined"!==typeof window&&window.devicePixelRatio||1;function XX(e){EX.call(this,e),this._options={},this._redraw=!1,this._dirty=new dG,this._tempb=new dG}var KX=EX.prototype;function YX(e,t){CX.call(this,e,t);var n=this;n._hrefHandler=$X(n,(function(e,t){t&&t.href&&n.handleHref(e,t,t.href)})),n._tooltipHandler=$X(n,(function(e,t){n.handleTooltip(e,t,e.type!==PX)}))}dt(XX,EX,{initialize:function(e,t,n,r,a,i){return this._options=i||{},this._canvas=this._options.externalContext?null:Ip(1,1,this._options.type),e&&this._canvas&&(kX(e,0).appendChild(this._canvas),this._canvas.setAttribute("class","marks")),KX.initialize.call(this,e,t,n,r,a)},resize:function(e,t,n,r){if(KX.resize.call(this,e,t,n,r),this._canvas)!function(e,t,n,r,a,i){var o="undefined"!==typeof HTMLElement&&e instanceof HTMLElement&&null!=e.parentNode,u=e.getContext("2d"),s=o?HX:a;for(var c in e.width=t*s,e.height=n*s,i)u[c]=i[c];o&&1!==s&&(e.style.width=t+"px",e.style.height=n+"px"),u.pixelRatio=s,u.setTransform(s,0,0,s,s*r[0],s*r[1])}(this._canvas,this._width,this._height,this._origin,this._scale,this._options.context);else{var a=this._options.externalContext;a||ue("CanvasRenderer is missing a valid canvas or context"),a.scale(this._scale,this._scale),a.translate(this._origin[0],this._origin[1])}return this._redraw=!0,this},canvas:function(){return this._canvas},context:function(){return this._options.externalContext||(this._canvas?this._canvas.getContext("2d"):null)},dirty:function(e){for(var t=this._tempb.clear().union(e.bounds),n=e.mark.group;n;)t.translate(n.x||0,n.y||0),n=n.mark.group;this._dirty.union(t)},_render:function(e){var t=this.context(),n=this._origin,r=this._width,a=this._height,i=this._dirty,o=function(e,t,n){return(new dG).set(0,0,t,n).translate(-e[0],-e[1])}(n,r,a);t.save();var u=this._redraw||i.empty()?(this._redraw=!1,o.expand(1)):function(e,t,n){return t.expand(1).round(),e.pixelRatio%1&&t.scale(e.pixelRatio).round().scale(1/e.pixelRatio),t.translate(-n[0]%1,-n[1]%1),e.beginPath(),e.rect(t.x1,t.y1,t.width(),t.height()),e.clip(),t}(t,o.intersect(i),n);return this.clear(-n[0],-n[1],r,a),this.draw(t,e,u),t.restore(),i.clear(),this},draw:function(e,t,n){var r=cX[t.marktype];t.clip&&function(e,t){var n=t.clip;e.save(),Ye(n)?(e.beginPath(),n(e),e.clip()):yH(e,t.group)}(e,t),r.draw.call(this,e,t,n),t.clip&&e.restore()},clear:function(e,t,n,r){var a=this._options,i=this.context();"pdf"===a.type||a.externalContext||i.clearRect(e,t,n,r),null!=this._bgcolor&&(i.fillStyle=this._bgcolor,i.fillRect(e,t,n,r))}});var $X=function(e,t){return function(n){var r=n.target.__data__;r=Array.isArray(r)?r[0]:r,n.vegaType=n.type,t.call(e._obj,n,r)}};dt(YX,CX,{initialize:function(e,t,n){var r=this._svg;return r&&(r.removeEventListener(UX,this._hrefHandler),r.removeEventListener(LX,this._tooltipHandler),r.removeEventListener(PX,this._tooltipHandler)),this._svg=r=e&&xX(e,"svg"),r&&(r.addEventListener(UX,this._hrefHandler),r.addEventListener(LX,this._tooltipHandler),r.addEventListener(PX,this._tooltipHandler)),CX.prototype.initialize.call(this,e,t,n)},canvas:function(){return this._svg},on:function(e,t){var n=this.eventName(e),r=this._handlers;if(this._handlerIndex(r[n],e,t)<0){var a={type:e,handler:t,listener:$X(this,t)};(r[n]||(r[n]=[])).push(a),this._svg&&this._svg.addEventListener(n,a.listener)}return this},off:function(e,t){var n=this.eventName(e),r=this._handlers[n],a=this._handlerIndex(r,e,t);return a>=0&&(this._svg&&this._svg.removeEventListener(n,r[a].listener),r.splice(a,1)),this}});var QX="aria-hidden",JX="aria-label",eK="role",tK="aria-roledescription",nK="graphics-object",rK="graphics-symbol",aK=function(e,t,n){var r;return r={},(0,Xn.Z)(r,eK,e),(0,Xn.Z)(r,tK,t),(0,Xn.Z)(r,JX,n||void 0),r},iK=Ft(["axis-domain","axis-grid","axis-label","axis-tick","axis-title","legend-band","legend-entry","legend-gradient","legend-label","legend-title","legend-symbol","title"]),oK={axis:{desc:"axis",caption:function(e){var t=e.datum,n=e.orient,r=t.title?fK(e):null,a=e.context,i=a.scales[t.scale].value,o=a.dataflow.locale(),u=i.type;return"".concat("left"===n||"right"===n?"Y":"X","-axis")+(r?" titled '".concat(r,"'"):"")+" for a ".concat(CI(u)?"discrete":u," scale")+" with ".concat(iD(o,i,e))}},legend:{desc:"legend",caption:function(e){var t=e.datum,n=t.title?fK(e):null,r="".concat(t.type||""," legend").trim(),a=t.scales,i=Object.keys(a),o=e.context,u=o.scales[a[i[0]]].value,s=o.dataflow.locale();return function(e){return e.length?e[0].toUpperCase()+e.slice(1):e}(r)+(n?" titled '".concat(n,"'"):"")+" for ".concat(function(e){return(e=e.map((function(e){return e+("fill"===e||"stroke"===e?" color":"")}))).length<2?e[0]:e.slice(0,-1).join(", ")+" and "+Te(e)}(i))+" with ".concat(iD(s,u,e))}},"title-text":{desc:"title",caption:function(e){return"Title text '".concat(lK(e),"'")}},"title-subtitle":{desc:"subtitle",caption:function(e){return"Subtitle text '".concat(lK(e),"'")}}},uK={ariaRole:eK,ariaRoleDescription:tK,description:JX};function sK(e,t){var n=!1===t.aria;if(e(QX,n||void 0),n||null==t.description)for(var r in uK)e(uK[r],void 0);else{var a=t.mark.marktype;e(JX,t.description),e(eK,t.ariaRole||("group"===a?nK:rK)),e(tK,t.ariaRoleDescription||"".concat(a," mark"))}}function cK(e){return!1===e.aria?(0,Xn.Z)({},QX,!0):iK[e.role]?null:oK[e.role]?function(e,t){try{var n=e.items[0],r=t.caption||function(){return""};return aK(t.role||rK,t.desc,n.description||r(n))}catch(a){return null}}(e,oK[e.role]):function(e){var t=e.marktype,n="group"===t||"text"===t||e.items.some((function(e){return null!=e.description&&!1!==e.aria}));return aK(n?nK:rK,"".concat(t," mark container"),e.description)}(e)}function lK(e){return Xe(e.text).join(" ")}function fK(e){try{return Xe(Te(e.items).items[0].text).join(" ")}catch(t){return null}}var dK=function(e){return(e+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")};function hK(){var e="",t="",n="",r=[],a=function(){return t=n=""},i=function(i){t&&(e+="".concat(t,">").concat(n),a()),r.push(i)},o=function(e,n){return null!=n&&(t+=" ".concat(e,'="').concat(dK(n).replace(/"/g,"&quot;").replace(/\t/g,"&#x9;").replace(/\n/g,"&#xA;").replace(/\r/g,"&#xD;"),'"')),u},u={open:function(e){i(e),t="<"+e;for(var n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];for(var s=0,c=r;s<c.length;s++){var l=c[s];for(var f in l)o(f,l[f])}return u},close:function(){var i=r.pop();return e+=t?t+(n?">".concat(n,"</").concat(i,">"):"/>"):"</".concat(i,">"),a(),u},attr:o,text:function(e){return n+=dK(e),u},toString:function(){return e}};return u}var pK=function(e){return vK(hK(),e)+""};function vK(e,t){if(e.open(t.tagName),t.hasAttributes())for(var n=t.attributes,r=n.length,a=0;a<r;++a)e.attr(n[a].name,n[a].value);if(t.hasChildNodes())for(var i=t.childNodes,o=i.length,u=0;u<o;u++){var s=i[u];3===s.nodeType?e.text(s.nodeValue):vK(e,s)}return e.close()}var mK={fill:"fill",fillOpacity:"fill-opacity",stroke:"stroke",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",strokeCap:"stroke-linecap",strokeJoin:"stroke-linejoin",strokeDash:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeMiterLimit:"stroke-miterlimit",opacity:"opacity",blend:"mix-blend-mode"},gK={fill:"none","stroke-miterlimit":10},yK="http://www.w3.org/2000/xmlns/",bK=AH.xmlns;function xK(e){EX.call(this,e),this._dirtyID=0,this._dirty=[],this._svg=null,this._root=null,this._defs=null}var wK=EX.prototype;function kK(e,t){for(;e&&e.dirty!==t;e=e.mark.group){if(e.dirty=t,!e.mark||e.mark.dirty===t)return;e.mark.dirty=t}}function _K(e,t,n){var r,a,i;if("radial"===t.gradient){var o=wX(e,n++,"pattern",bK);DK(o,{id:vq+t.id,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),DK(o=wX(o,0,"rect",bK),{width:1,height:1,fill:"url(".concat(MK(),"#").concat(t.id,")")}),DK(e=wX(e,n++,"radialGradient",bK),{id:t.id,fx:t.x1,fy:t.y1,fr:t.r1,cx:t.x2,cy:t.y2,r:t.r2})}else DK(e=wX(e,n++,"linearGradient",bK),{id:t.id,x1:t.x1,x2:t.x2,y1:t.y1,y2:t.y2});for(r=0,a=t.stops.length;r<a;++r)(i=wX(e,r,"stop",bK)).setAttribute("offset",t.stops[r].offset),i.setAttribute("stop-color",t.stops[r].color);return kX(e,r),n}function SK(e,t,n){return(e=wX(e,n,"clipPath",bK)).setAttribute("id",t.id),t.path?wX(e,0,"path",bK).setAttribute("d",t.path):DK(wX(e,0,"rect",bK),{x:0,y:0,width:t.width,height:t.height}),kX(e,1),n+1}function CK(e,t,n,r,a){var i,o=e._svg;if(!o&&(o=bX(i=t.ownerDocument,r,bK),e._svg=o,e.mark&&(o.__data__=e,o.__values__={fill:"default"},"g"===r))){var u=bX(i,"path",bK);o.appendChild(u),u.__data__=e;var s=bX(i,"g",bK);o.appendChild(s),s.__data__=e;var c=bX(i,"path",bK);o.appendChild(c),c.__data__=e,c.__values__={fill:"default"}}return(o.ownerSVGElement!==a||function(e,t){return e.parentNode&&e.parentNode.childNodes.length>1&&e.previousSibling!=t}(o,n))&&t.insertBefore(o,n?n.nextSibling:t.firstChild),o}dt(xK,EX,{initialize:function(e,t,n,r,a){return this._defs={},this._clearDefs(),e&&(this._svg=wX(e,0,"svg",bK),this._svg.setAttributeNS(yK,"xmlns",bK),this._svg.setAttributeNS(yK,"xmlns:xlink",AH["xmlns:xlink"]),this._svg.setAttribute("version",AH.version),this._svg.setAttribute("class","marks"),kX(e,1),this._root=wX(this._svg,0,"g",bK),DK(this._root,gK),kX(this._svg,1)),this.background(this._bgcolor),wK.initialize.call(this,e,t,n,r,a)},background:function(e){return arguments.length&&this._svg&&this._svg.style.setProperty("background-color",e),wK.background.apply(this,arguments)},resize:function(e,t,n,r){return wK.resize.call(this,e,t,n,r),this._svg&&(DK(this._svg,{width:this._width*this._scale,height:this._height*this._scale,viewBox:"0 0 ".concat(this._width," ").concat(this._height)}),this._root.setAttribute("transform","translate(".concat(this._origin,")"))),this._dirty=[],this},canvas:function(){return this._svg},svg:function(){var e,t=this._svg,n=this._bgcolor;if(!t)return null;n&&(t.removeAttribute("style"),DK(e=wX(t,0,"rect",bK),{width:this._width,height:this._height,fill:n}));var r=pK(t);return n&&(t.removeChild(e),this._svg.style.setProperty("background-color",n)),r},_render:function(e){return this._dirtyCheck()&&(this._dirtyAll&&this._clearDefs(),this.mark(this._root,e),kX(this._root,1)),this.defs(),this._dirty=[],++this._dirtyID,this},dirty:function(e){e.dirty!==this._dirtyID&&(e.dirty=this._dirtyID,this._dirty.push(e))},isDirty:function(e){return this._dirtyAll||!e._svg||e.dirty===this._dirtyID},_dirtyCheck:function(){this._dirtyAll=!0;var e=this._dirty;if(!e.length||!this._dirtyID)return!0;var t,n,r,a,i,o,u,s=++this._dirtyID;for(i=0,o=e.length;i<o;++i)(n=(t=e[i]).mark).marktype!==r&&(r=n.marktype,a=cX[r]),n.zdirty&&n.dirty!==s&&(this._dirtyAll=!1,kK(t,s),n.items.forEach((function(e){e.dirty=s}))),n.zdirty||(t.exit?(a.nested&&n.items.length?(u=n.items[0])._svg&&this._update(a,u._svg,u):t._svg&&(u=t._svg.parentNode)&&u.removeChild(t._svg),t._svg=null):(t=a.nested?n.items[0]:t)._update!==s&&(t._svg&&t._svg.ownerSVGElement?this._update(a,t._svg,t):(this._dirtyAll=!1,kK(t,s)),t._update=s));return!this._dirtyAll},mark:function(e,t,n){var r=this;if(!this.isDirty(t))return t._svg;var a=this._svg,i=cX[t.marktype],o=!1===t.interactive?"none":null,u="g"===i.tag,s=null,c=0,l=CK(t,e,n,"g",a);l.setAttribute("class",_X(t));var f=cK(t);for(var d in f)FK(l,d,f[d]);u||FK(l,"pointer-events",o),FK(l,"clip-path",t.clip?fG(this,t,t.group):null);var h=function(e){var t=r.isDirty(e),n=CK(e,l,s,i.tag,a);t&&(r._update(i,n,e),u&&function(e,t,n){t=t.lastChild.previousSibling;var r,a=0;rH(n,(function(n){r=e.mark(t,n,r),++a})),kX(t,1+a)}(r,n,e)),s=n,++c};return i.nested?t.items.length&&h(t.items[0]):rH(t,h),kX(l,c),l},_update:function(e,t,n){AK=t,EK=t.__values__,sK(TK,n),e.attr(TK,n,this);var r=NK[e.type];r&&r.call(this,e,t,n),AK&&this.style(AK,n)},style:function(e,t){if(null!=t)for(var n in mK){var r="font"===n?eX(t):t[n];if(r!==EK[n]){var a=mK[n];null==r?e.removeAttribute(a):(mq(r)&&(r=gq(r,this._defs.gradient,MK())),e.setAttribute(a,r+"")),EK[n]=r}}},defs:function(){var e=this._svg,t=this._defs,n=t.el,r=0;for(var a in t.gradient)n||(t.el=n=wX(e,1,"defs",bK)),r=_K(n,t.gradient[a],r);for(var i in t.clipping)n||(t.el=n=wX(e,1,"defs",bK)),r=SK(n,t.clipping[i],r);n&&(0===r?(e.removeChild(n),t.el=null):kX(n,r))},_clearDefs:function(){var e=this._defs;e.gradient={},e.clipping={}}});var AK=null,EK=null,NK={group:function(e,t,n){var r=AK=t.childNodes[2];EK=r.__values__,e.foreground(TK,n,this),EK=t.__values__,AK=t.childNodes[1],e.content(TK,n,this);var a=AK=t.childNodes[0];e.background(TK,n,this);var i=!1===n.mark.interactive?"none":null;if(i!==EK.events&&(FK(r,"pointer-events",i),FK(a,"pointer-events",i),EK.events=i),n.strokeForeground&&n.stroke){var o=n.fill;FK(r,"display",null),this.style(a,n),FK(a,"stroke",null),o&&(n.fill=null),EK=r.__values__,this.style(r,n),o&&(n.fill=o),AK=null}else FK(r,"display","none")},image:function(e,t,n){!1===n.smooth?(IK(t,"image-rendering","optimizeSpeed"),IK(t,"image-rendering","pixelated")):IK(t,"image-rendering",null)},text:function(e,t,n){var r,a,i,o,u=$H(n);_e(u)?(r=(a=u.map((function(e){return JH(n,e)}))).join("\n"))!==EK.text&&(kX(t,0),i=t.ownerDocument,o=YH(n),a.forEach((function(e,r){var a=bX(i,"tspan",bK);a.__data__=n,a.textContent=e,r&&(a.setAttribute("x",0),a.setAttribute("dy",o)),t.appendChild(a)})),EK.text=r):(a=JH(n,u))!==EK.text&&(t.textContent=a,EK.text=a),FK(t,"font-family",eX(n)),FK(t,"font-size",KH(n)+"px"),FK(t,"font-style",n.fontStyle),FK(t,"font-variant",n.fontVariant),FK(t,"font-weight",n.fontWeight)}};function TK(e,t,n){t!==EK[e]&&(n?function(e,t,n,r){null!=n?e.setAttributeNS(r,t,n):e.removeAttributeNS(r,t)}(AK,e,t,n):FK(AK,e,t),EK[e]=t)}function IK(e,t,n){n!==EK[t]&&(null==n?e.style.removeProperty(t):e.style.setProperty(t,n+""),EK[t]=n)}function DK(e,t){for(var n in t)FK(e,n,t[n])}function FK(e,t,n){null!=n?e.setAttribute(t,n):e.removeAttribute(t)}function MK(){var e;return"undefined"===typeof window?"":(e=window.location).hash?e.href.slice(0,-e.hash.length):e.href}function OK(e){EX.call(this,e),this._text=null,this._defs={gradient:{},clipping:{}}}dt(OK,EX,{svg:function(){return this._text},_render:function(e){var t=hK();t.open("svg",at({},AH,{class:"marks",width:this._width*this._scale,height:this._height*this._scale,viewBox:"0 0 ".concat(this._width," ").concat(this._height)}));var n=this._bgcolor;return n&&"transparent"!==n&&"none"!==n&&t.open("rect",{width:this._width,height:this._height,fill:n}).close(),t.open("g",gK,{transform:"translate("+this._origin+")"}),this.mark(t,e),t.close(),this.defs(t),this._text=t.close()+"",this},mark:function(e,t){var n=this,r=cX[t.marktype],a=r.tag,i=[sK,r.attr];e.open("g",{class:_X(t),"clip-path":t.clip?fG(this,t,t.group):null},cK(t),{"pointer-events":"g"!==a&&!1===t.interactive?"none":null});var o=function(o){var u=n.href(o);if(u&&e.open("a",u),e.open(a,n.attr(t,o,i,"g"!==a?a:null)),"text"===a){var s=$H(o);if(_e(s))for(var c={x:0,dy:YH(o)},l=0;l<s.length;++l)e.open("tspan",l?c:null).text(JH(o,s[l])).close();else e.text(JH(o,s))}else if("g"===a){var f=o.strokeForeground,d=o.fill,h=o.stroke;f&&h&&(o.stroke=null),e.open("path",n.attr(t,o,r.background,"bgrect")).close(),e.open("g",n.attr(t,o,r.content)),rH(o,(function(t){return n.mark(e,t)})),e.close(),f&&h?(d&&(o.fill=null),o.stroke=h,e.open("path",n.attr(t,o,r.foreground,"bgrect")).close(),d&&(o.fill=d)):e.open("path",n.attr(t,o,r.foreground,"bgfore")).close()}e.close(),u&&e.close()};return r.nested?t.items&&t.items.length&&o(t.items[0]):rH(t,o),e.close()},href:function(e){var t,n=this,r=e.href;if(r){if(t=this._hrefs&&this._hrefs[r])return t;this.sanitizeURL(r).then((function(e){e["xlink:href"]=e.href,e.href=null,(n._hrefs||(n._hrefs={}))[r]=e}))}return null},attr:function(e,t,n,r){var a=this,i={},o=function(e,t,n,r){i[r||e]=t};return Array.isArray(n)?n.forEach((function(e){return e(o,t,a)})):n(o,t,this),r&&function(e,t,n,r,a){if(null==t)return e;"bgrect"===r&&!1===n.interactive&&(e["pointer-events"]="none");if("bgfore"===r&&(!1===n.interactive&&(e["pointer-events"]="none"),e.display="none",null!==t.fill))return e;"image"===r&&!1===t.smooth&&(e.style="image-rendering: optimizeSpeed; image-rendering: pixelated;");"text"===r&&(e["font-family"]=eX(t),e["font-size"]=KH(t)+"px",e["font-style"]=t.fontStyle,e["font-variant"]=t.fontVariant,e["font-weight"]=t.fontWeight);for(var i in mK){var o=t[i],u=mK[i];("transparent"!==o||"fill"!==u&&"stroke"!==u)&&null!=o&&(mq(o)&&(o=gq(o,a.gradient,"")),e[u]=o)}}(i,t,e,r,this._defs),i},defs:function(e){var t=this._defs.gradient,n=this._defs.clipping;if(0!==Object.keys(t).length+Object.keys(n).length){for(var r in e.open("defs"),t){var a=t[r],i=a.stops;"radial"===a.gradient?(e.open("pattern",{id:vq+r,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),e.open("rect",{width:"1",height:"1",fill:"url(#"+r+")"}).close(),e.close(),e.open("radialGradient",{id:r,fx:a.x1,fy:a.y1,fr:a.r1,cx:a.x2,cy:a.y2,r:a.r2})):e.open("linearGradient",{id:r,x1:a.x1,x2:a.x2,y1:a.y1,y2:a.y2});for(var o=0;o<i.length;++o)e.open("stop",{offset:i[o].offset,"stop-color":i[o].color}).close();e.close()}for(var u in n){var s=n[u];e.open("clipPath",{id:u}),s.path?e.open("path",{d:s.path}).close():e.open("rect",{x:0,y:0,width:s.width,height:s.height}).close(),e.close()}e.close()}}});var RK="canvas",jK="none",BK={Canvas:RK,PNG:"png",SVG:"svg",None:jK},zK={};function ZK(e,t){return e=String(e||"").toLowerCase(),arguments.length>1?(zK[e]=t,this):zK[e]}function LK(e,t,n){var r=[],a=(new dG).union(t),i=e.marktype;return i?PK(e,a,n,r):"group"===i?UK(e,a,n,r):ue("Intersect scene must be mark node or group item.")}function PK(e,t,n,r){if(function(e,t,n){return e.bounds&&t.intersects(e.bounds)&&("group"===e.marktype||!1!==e.interactive&&(!n||n(e)))}(e,t,n)){var a=e.items,i=e.marktype,o=a.length,u=0;if("group"===i)for(;u<o;++u)UK(a[u],t,n,r);else for(var s=cX[i].isect;u<o;++u){var c=a[u];WK(c,t,s)&&r.push(c)}}return r}function UK(e,t,n,r){n&&n(e.mark)&&WK(e,t,cX.group.isect)&&r.push(e);var a=e.items,i=a&&a.length;if(i){var o=e.x||0,u=e.y||0;t.translate(-o,-u);for(var s=0;s<i;++s)PK(a[s],t,n,r);t.translate(o,u)}return r}function WK(e,t,n){var r=e.bounds;return t.encloses(r)||t.intersects(r)&&n(e,t)}zK.canvas=zK.png={renderer:XX,headless:XX,handler:WX},zK.svg={renderer:xK,headless:OK,handler:YX},zK.none={};var VK=new dG;function qK(e){var t=e.clip;if(Ye(t))t(jG(VK.clear()));else{if(!t)return;VK.set(0,0,e.group.width,e.group.height)}e.bounds.intersect(VK)}function GK(e,t,n){return e===t||("path"===n?HK(e,t):e instanceof Date&&t instanceof Date?+e===+t:gt(e)&&gt(t)?Math.abs(e-t)<=1e-9:e&&t&&(Se(e)||Se(t))?function(e,t){var n,r,a=Object.keys(e),i=Object.keys(t);if(a.length!==i.length)return!1;for(a.sort(),i.sort(),r=a.length-1;r>=0;r--)if(a[r]!=i[r])return!1;for(r=a.length-1;r>=0;r--)if(!GK(e[n=a[r]],t[n],n))return!1;return typeof e===typeof t}(e,t):e==t)}function HK(e,t){return GK(Sq(e),Sq(t))}function XK(){lG(),pq=0}function KK(e,t,n,r){var a=e.width,i=e.height,o=n||r,u=Ip(a,i).getContext("2d");t.forEach((function(e){return YK(u,e,o)}));var s,c,l,f,d,h=new Uint32Array(u.getImageData(0,0,a,i).data.buffer),p=e.bitmap(),v=o&&e.bitmap();for(c=0;c<i;++c)for(s=0;s<a;++s)(d=4278190080&h[c*a+s])&&(l=e(s),f=e(c),r||p.set(l,f),o&&268435456^d&&v.set(l,f));return[p,v]}function YK(e,t,n){if(t.length){var r=t[0].mark.marktype;"group"===r?t.forEach((function(t){t.items.forEach((function(t){return YK(e,t.items,n)}))})):cX[r].draw(e,{items:n?t.map($K):t})}}function $K(e){var t=Po(e,{});return t.stroke&&(t.strokeOpacity=1),t.fill&&(t.fillOpacity=.0625,t.stroke="#000",t.strokeOpacity=1,t.strokeWidth=2),t}var QK=31,JK=new Uint32Array(33),eY=new Uint32Array(33);eY[0]=0,JK[0]=~eY[0];for(var tY=1;tY<=32;++tY)eY[tY]=eY[tY-1]<<1|1,JK[tY]=~eY[tY];function nY(e,t,n){var r=Math.max(1,Math.sqrt(e*t/1e6)),a=~~((e+2*n+r)/r),i=~~((t+2*n+r)/r),o=function(e){return~~((e+n)/r)};return o.invert=function(e){return e*r-n},o.bitmap=function(){return function(e,t){var n=new Uint32Array(~~((e*t+32)/32));function r(e,t){n[e]|=t}function a(e,t){n[e]&=t}return{array:n,get:function(t,r){var a=r*e+t;return n[a>>>5]&1<<(a&QK)},set:function(t,n){var a=n*e+t;r(a>>>5,1<<(a&QK))},clear:function(t,n){var r=n*e+t;a(r>>>5,~(1<<(r&QK)))},getRange:function(t,r,a,i){for(var o,u,s,c,l=i;l>=r;--l)if((s=(o=l*e+t)>>>5)===(c=(u=l*e+a)>>>5)){if(n[s]&JK[o&QK]&eY[1+(u&QK)])return!0}else{if(n[s]&JK[o&QK])return!0;if(n[c]&eY[1+(u&QK)])return!0;for(var f=s+1;f<c;++f)if(n[f])return!0}return!1},setRange:function(t,n,a,i){for(var o,u,s,c,l;n<=i;++n)if((s=(o=n*e+t)>>>5)===(c=(u=n*e+a)>>>5))r(s,JK[o&QK]&eY[1+(u&QK)]);else for(r(s,JK[o&QK]),r(c,eY[1+(u&QK)]),l=s+1;l<c;++l)r(l,4294967295)},clearRange:function(t,n,r,i){for(var o,u,s,c,l;n<=i;++n)if((s=(o=n*e+t)>>>5)===(c=(u=n*e+r)>>>5))a(s,eY[o&QK]|JK[1+(u&QK)]);else for(a(s,eY[o&QK]),a(c,JK[1+(u&QK)]),l=s+1;l<c;++l)a(l,0)},outOfBounds:function(n,r,a,i){return n<0||r<0||i>=t||a>=e}}}(a,i)},o.ratio=r,o.padding=n,o.width=e,o.height=t,o}function rY(e,t,n,r,a,i){var o=n/2;return e-o<0||e+o>a||t-(o=r/2)<0||t+o>i}function aY(e,t,n,r,a,i,o,u){var s=a*i/(2*r),c=e(t-s),l=e(t+s),f=e(n-(i/=2)),d=e(n+i);return o.outOfBounds(c,f,l,d)||o.getRange(c,f,l,d)||u&&u.getRange(c,f,l,d)}var iY=[-1,-1,1,1],oY=[-1,1,-1,1];var uY=["right","center","left"],sY=["bottom","middle","top"];function cY(e,t,n,r,a,i,o,u,s,c,l,f){return!(a.outOfBounds(e,n,t,r)||(f&&i?i.getRange(e,n,t,r)||!function(e,t,n,r,a){return a[0]<=e&&n<=a[2]&&a[3]<=t&&r<=a[5]}(o,s,u,c,l):a.getRange(e,n,t,r)))}var lY={"top-left":0,top:1,"top-right":2,left:4,middle:5,right:6,"bottom-left":8,bottom:9,"bottom-right":10},fY={naive:function(e,t,n,r){var a=e.width,i=e.height;return function(e){for(var t,n,o,u,s,c,l,f=e.datum.datum.items[r].items,d=f.length,h=e.datum.fontSize,p=WH.width(e.datum,e.datum.text),v=0,m=0;m<d;++m)t=f[m].x,o=f[m].y,s=(t+(n=void 0===f[m].x2?t:f[m].x2))/2,c=(o+(u=void 0===f[m].y2?o:f[m].y2))/2,(l=Math.abs(n-t+u-o))>=v&&(v=l,e.x=s,e.y=c);return s=p/2,c=h/2,t=e.x-s,n=e.x+s,o=e.y-c,u=e.y+c,e.align="center",t<0&&n<=a?e.align="left":0<=t&&a<n&&(e.align="right"),e.baseline="middle",o<0&&u<=i?e.baseline="top":0<=o&&i<u&&(e.baseline="bottom"),!0}},"reduced-search":function(e,t,n,r){var a=e.width,i=e.height,o=t[0],u=t[1];function s(t,n,r,s,c){var l,f=e.invert(t),d=e.invert(n),h=r,p=i;if(!rY(f,d,s,c,a,i)&&!aY(e,f,d,c,s,h,o,u)&&!aY(e,f,d,c,s,c,o,null)){for(;p-h>=1;)aY(e,f,d,c,s,l=(h+p)/2,o,u)?p=l:h=l;if(h>r)return[f,d,h,!0]}}return function(t){for(var u,c,l,f,d,h,p,v,m,g,y,b,x,w,k,_,S,C=t.datum.datum.items[r].items,A=C.length,E=t.datum.fontSize,N=WH.width(t.datum,t.datum.text),T=n?E:0,I=!1,D=!1,F=0,M=0;M<A;++M){for(u=C[M].x,l=C[M].y,u>(c=void 0===C[M].x2?u:C[M].x2)&&(S=u,u=c,c=S),l>(f=void 0===C[M].y2?l:C[M].y2)&&(S=l,l=f,f=S),g=~~(((m=e(u))+(y=e(c)))/2),x=~~(((b=e(l))+(w=e(f)))/2),p=g;p>=m;--p)for(v=x;v>=b;--v)if(_=s(p,v,T,N,E)){var O=_,R=(0,Cn.Z)(O,4);t.x=R[0],t.y=R[1],T=R[2],I=R[3]}for(p=g;p<=y;++p)for(v=x;v<=w;++v)if(_=s(p,v,T,N,E)){var j=_,B=(0,Cn.Z)(j,4);t.x=B[0],t.y=B[1],T=B[2],I=B[3]}I||n||(d=(u+c)/2,h=(l+f)/2,(k=Math.abs(c-u+f-l))>=F&&!rY(d,h,N,E,a,i)&&!aY(e,d,h,E,N,E,o,null)&&(F=k,t.x=d,t.y=h,D=!0))}return!(!I&&!D)&&(d=N/2,h=E/2,o.setRange(e(t.x-d),e(t.y-h),e(t.x+d),e(t.y+h)),t.align="center",t.baseline="middle",!0)}},floodfill:function(e,t,n,r){var a=e.width,i=e.height,o=t[0],u=t[1],s=e.bitmap();return function(t){for(var c,l,f,d,h,p,v,m,g,y,b,x,w=t.datum.datum.items[r].items,k=w.length,_=t.datum.fontSize,S=WH.width(t.datum,t.datum.text),C=[],A=n?_:0,E=!1,N=!1,T=0,I=0;I<k;++I){for(c=w[I].x,f=w[I].y,l=void 0===w[I].x2?c:w[I].x2,d=void 0===w[I].y2?f:w[I].y2,C.push([e((c+l)/2),e((f+d)/2)]);C.length;){var D=C.pop(),F=(0,Cn.Z)(D,2);if(v=F[0],m=F[1],!(o.get(v,m)||u.get(v,m)||s.get(v,m))){s.set(v,m);for(var M=0;M<4;++M)h=v+iY[M],p=m+oY[M],s.outOfBounds(h,p,h,p)||C.push([h,p]);if(h=e.invert(v),p=e.invert(m),g=A,y=i,!rY(h,p,S,_,a,i)&&!aY(e,h,p,_,S,g,o,u)&&!aY(e,h,p,_,S,_,o,null)){for(;y-g>=1;)aY(e,h,p,_,S,b=(g+y)/2,o,u)?y=b:g=b;g>A&&(t.x=h,t.y=p,A=g,E=!0)}}}E||n||(h=(c+l)/2,p=(f+d)/2,(x=Math.abs(l-c+d-f))>=T&&!rY(h,p,S,_,a,i)&&!aY(e,h,p,_,S,_,o,null)&&(T=x,t.x=h,t.y=p,N=!0))}return!(!E&&!N)&&(h=S/2,p=_/2,o.setRange(e(t.x-h),e(t.y-p),e(t.x+h),e(t.y+p)),t.align="center",t.baseline="middle",!0)}}};function dY(e,t,n,r,a,i,o,u,s,c,l){if(!e.length)return e;var f,d,h=Math.max(r.length,a.length),p=function(e,t){for(var n=new Float64Array(t),r=e.length,a=0;a<r;++a)n[a]=e[a]||0;for(var i=r;i<t;++i)n[i]=n[r-1];return n}(r,h),v=function(e,t){for(var n=new Int8Array(t),r=e.length,a=0;a<r;++a)n[a]|=lY[e[a]];for(var i=r;i<t;++i)n[i]=n[r-1];return n}(a,h),m=(f=e[0].datum)&&f.mark&&f.mark.marktype,g="group"===m&&e[0].datum.items[s].marktype,y="area"===g,b=function(e,t,n,r){var a=function(e){return[e.x,e.x,e.x,e.y,e.y,e.y]};return e?"line"===e||"area"===e?function(e){return a(e.datum)}:"line"===t?function(e){var t=e.datum.items[r].items;return a(t.length?t["start"===n?0:t.length-1]:{x:NaN,y:NaN})}:function(e){var t=e.datum.bounds;return[t.x1,(t.x1+t.x2)/2,t.x2,t.y1,(t.y1+t.y2)/2,t.y2]}:a}(m,g,u,s),x=nY(t[0],t[1],c),w=y&&"naive"===l,k=e.map((function(e){return{datum:e,opacity:0,x:void 0,y:void 0,align:void 0,baseline:void 0,boundary:b(e)}}));if(!w){n&&k.sort((function(e,t){return n(e.datum,t.datum)}));for(var _=!1,S=0;S<v.length&&!_;++S)_=5===v[S]||p[S]<0;m&&(o||y)&&(i=[e.map((function(e){return e.datum}))].concat(i)),d=i.length?KK(x,i,_,y):function(e,t){var n=e.bitmap();return(t||[]).forEach((function(t){return n.set(e(t.boundary[0]),e(t.boundary[3]))})),[n,void 0]}(x,o&&k)}var C=y?fY[l](x,d,o,s):function(e,t,n,r){var a=e.width,i=e.height,o=t[0],u=t[1],s=r.length;return function(t){var c=t.boundary,l=t.datum.fontSize;if(c[2]<0||c[5]<0||c[0]>a||c[3]>i)return!1;for(var f,d,h,p,v,m,g,y,b,x,w,k,_,S,C,A=0,E=0;E<s;++E){if(f=(3&n[E])-1,d=(n[E]>>>2&3)-1,h=0===f&&0===d||r[E]<0,p=f&&d?Math.SQRT1_2:1,v=r[E]<0?-1:1,m=c[1+f]+r[E]*f*p,y=(w=c[4+d]+v*l*d/2+r[E]*d*p)-l/2,b=w+l/2,k=e(m),S=e(y),C=e(b),!A){if(!cY(k,k,S,C,o,u,m,m,y,b,c,h))continue;A=WH.width(t.datum,t.datum.text)}if(g=(x=m+v*A*f/2)+A/2,cY(k=e(m=x-A/2),_=e(g),S,C,o,u,m,g,y,b,c,h))return t.x=f?f*v<0?g:m:x,t.y=d?d*v<0?b:y:w,t.align=uY[f*v+1],t.baseline=sY[d*v+1],o.setRange(k,S,_,C),!0}return!1}}(x,d,v,p);return k.forEach((function(e){return e.opacity=+C(e)})),k}var hY=["x","y","opacity","align","baseline"],pY=["top-left","left","bottom-left","top","bottom","top-right","right","bottom-right"];function vY(e){wu.call(this,null,e)}function mY(e,t){var n,r,a,i,o,u,s=[],c=function(e){return e(i)};if(null==t)s.push(e);else for(n={},r=0,a=e.length;r<a;++r)i=e[r],(u=n[o=t.map(c)])||(n[o]=u=[],u.dims=o,s.push(u)),u.push(i);return s}function gY(e){wu.call(this,null,e)}vY.Definition={type:"Label",metadata:{modifies:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"sort",type:"compare"},{name:"anchor",type:"string",array:!0,default:pY},{name:"offset",type:"number",array:!0,default:[1]},{name:"padding",type:"number",default:0},{name:"lineAnchor",type:"string",values:["start","end"],default:"end"},{name:"markIndex",type:"number",default:0},{name:"avoidBaseMark",type:"boolean",default:!0},{name:"avoidMarks",type:"data",array:!0},{name:"method",type:"string",default:"naive"},{name:"as",type:"string",array:!0,length:hY.length,default:hY}]},dt(vY,wu,{transform:function(e,t){var n=e.modified();if(n||t.changed(t.ADD_REM)||function(n){var r=e[n];return Ye(r)&&t.modified(r.fields)}("sort")){e.size&&2===e.size.length||ue("Size parameter should be specified as a [width, height] array.");var r=e.as||hY;return dY(t.materialize(t.SOURCE).source,e.size,e.sort,Xe(e.offset||1),Xe(e.anchor||pY),e.avoidMarks||[],!1!==e.avoidBaseMark,e.lineAnchor||"end",e.markIndex||0,e.padding||0,e.method||"naive").forEach((function(e){var t=e.datum;t[r[0]]=e.x,t[r[1]]=e.y,t[r[2]]=e.opacity,t[r[3]]=e.align,t[r[4]]=e.baseline})),t.reflow(n).modifies(r)}}}),gY.Definition={type:"Loess",metadata:{generates:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"bandwidth",type:"number",default:.3},{name:"as",type:"string",array:!0}]},dt(gY,wu,{transform:function(e,t){var n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){var r=mY(t.materialize(t.SOURCE).source,e.groupby),a=(e.groupby||[]).map(ne),i=a.length,o=e.as||[ne(e.x),ne(e.y)],u=[];r.forEach((function(t){Cs(t,e.x,e.y,e.bandwidth||.3).forEach((function(e){for(var n={},r=0;r<i;++r)n[a[r]]=t.dims[r];n[o[0]]=e[0],n[o[1]]=e[1],u.push(Zo(n))}))})),this.value&&(n.rem=this.value),this.value=n.add=n.source=u}return n}});var yY={linear:ys,log:bs,exp:xs,pow:ws,quad:ks,poly:_s};function bY(e){wu.call(this,null,e)}bY.Definition={type:"Regression",metadata:{generates:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"method",type:"string",default:"linear",values:Object.keys(yY)},{name:"order",type:"number",default:3},{name:"extent",type:"number",array:!0,length:2},{name:"params",type:"boolean",default:!1},{name:"as",type:"string",array:!0}]},dt(bY,wu,{transform:function(e,t){var n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){var r=mY(t.materialize(t.SOURCE).source,e.groupby),a=(e.groupby||[]).map(ne),i=e.method||"linear",o=e.order||3,u=function(e,t){return"poly"===e?t:"quad"===e?2:1}(i,o),s=e.as||[ne(e.x),ne(e.y)],c=yY[i],l=[],f=e.extent;st(yY,i)||ue("Invalid regression method: "+i),null!=f&&"log"===i&&f[0]<=0&&(t.dataflow.warn("Ignoring extent with values <= 0 for log regression."),f=null),r.forEach((function(n){if(n.length<=u)t.dataflow.warn("Skipping regression with more parameters than data points.");else{var r=c(n,e.x,e.y,o);if(e.params)l.push(Zo({keys:n.dims,coef:r.coef,rSquared:r.rSquared}));else{var d=f||it(n,e.x),h=function(e){for(var t={},r=0;r<a.length;++r)t[a[r]]=n.dims[r];t[s[0]]=e[0],t[s[1]]=e[1],l.push(Zo(t))};"linear"===i?d.forEach((function(e){return h([e,r.predict(e)])})):Ts(r.predict,d,25,200).forEach(h)}}})),this.value&&(n.rem=this.value),this.value=n.add=n.source=l}return n}});var xY=Math.pow(2,-52),wY=new Uint32Array(512),kY=function(){function e(t){(0,op.Z)(this,e);var n=t.length>>1;if(n>0&&"number"!==typeof t[0])throw new Error("Expected coords to contain numbers.");this.coords=t;var r=Math.max(2*n-5,0);this._triangles=new Uint32Array(3*r),this._halfedges=new Int32Array(3*r),this._hashSize=Math.ceil(Math.sqrt(n)),this._hullPrev=new Uint32Array(n),this._hullNext=new Uint32Array(n),this._hullTri=new Uint32Array(n),this._hullHash=new Int32Array(this._hashSize).fill(-1),this._ids=new Uint32Array(n),this._dists=new Float64Array(n),this.update()}return(0,up.Z)(e,[{key:"update",value:function(){for(var e=this.coords,t=this._hullPrev,n=this._hullNext,r=this._hullTri,a=this._hullHash,i=e.length>>1,o=1/0,u=1/0,s=-1/0,c=-1/0,l=0;l<i;l++){var f=e[2*l],d=e[2*l+1];f<o&&(o=f),d<u&&(u=d),f>s&&(s=f),d>c&&(c=d),this._ids[l]=l}for(var h,p,v,m=(o+s)/2,g=(u+c)/2,y=1/0,b=0;b<i;b++){var x=_Y(m,g,e[2*b],e[2*b+1]);x<y&&(h=b,y=x)}var w=e[2*h],k=e[2*h+1];y=1/0;for(var _=0;_<i;_++)if(_!==h){var S=_Y(w,k,e[2*_],e[2*_+1]);S<y&&S>0&&(p=_,y=S)}for(var C=e[2*p],A=e[2*p+1],E=1/0,N=0;N<i;N++)if(N!==h&&N!==p){var T=EY(w,k,C,A,e[2*N],e[2*N+1]);T<E&&(v=N,E=T)}var I=e[2*v],D=e[2*v+1];if(E===1/0){for(var F=0;F<i;F++)this._dists[F]=e[2*F]-e[0]||e[2*F+1]-e[1];NY(this._ids,this._dists,0,i-1);for(var M=new Uint32Array(i),O=0,R=0,j=-1/0;R<i;R++){var B=this._ids[R];this._dists[B]>j&&(M[O++]=B,j=this._dists[B])}return this.hull=M.subarray(0,O),this.triangles=new Uint32Array(0),void(this.halfedges=new Uint32Array(0))}if(CY(w,k,C,A,I,D)){var z=p,Z=C,L=A;p=v,C=I,A=D,v=z,I=Z,D=L}var P=function(e,t,n,r,a,i){var o=n-e,u=r-t,s=a-e,c=i-t,l=o*o+u*u,f=s*s+c*c,d=.5/(o*c-u*s);return{x:e+(c*l-u*f)*d,y:t+(o*f-s*l)*d}}(w,k,C,A,I,D);this._cx=P.x,this._cy=P.y;for(var U=0;U<i;U++)this._dists[U]=_Y(e[2*U],e[2*U+1],P.x,P.y);NY(this._ids,this._dists,0,i-1),this._hullStart=h;var W=3;n[h]=t[v]=p,n[p]=t[h]=v,n[v]=t[p]=h,r[h]=0,r[p]=1,r[v]=2,a.fill(-1),a[this._hashKey(w,k)]=h,a[this._hashKey(C,A)]=p,a[this._hashKey(I,D)]=v,this.trianglesLen=0,this._addTriangle(h,p,v,-1,-1,-1);for(var V,q,G=0;G<this._ids.length;G++){var H=this._ids[G],X=e[2*H],K=e[2*H+1];if(!(G>0&&Math.abs(X-V)<=xY&&Math.abs(K-q)<=xY)&&(V=X,q=K,H!==h&&H!==p&&H!==v)){for(var Y=0,$=0,Q=this._hashKey(X,K);$<this._hashSize&&(-1===(Y=a[(Q+$)%this._hashSize])||Y===n[Y]);$++);for(var J=Y=t[Y],ee=void 0;ee=n[J],!CY(X,K,e[2*J],e[2*J+1],e[2*ee],e[2*ee+1]);)if((J=ee)===Y){J=-1;break}if(-1!==J){var te=this._addTriangle(J,H,n[J],-1,-1,r[J]);r[H]=this._legalize(te+2),r[J]=te,W++;for(var ne=n[J];ee=n[ne],CY(X,K,e[2*ne],e[2*ne+1],e[2*ee],e[2*ee+1]);)te=this._addTriangle(ne,H,ee,r[H],-1,r[ne]),r[H]=this._legalize(te+2),n[ne]=ne,W--,ne=ee;if(J===Y)for(;CY(X,K,e[2*(ee=t[J])],e[2*ee+1],e[2*J],e[2*J+1]);)te=this._addTriangle(ee,H,J,-1,r[J],r[ee]),this._legalize(te+2),r[ee]=te,n[J]=J,W--,J=ee;this._hullStart=t[H]=J,n[J]=t[ne]=H,n[H]=ne,a[this._hashKey(X,K)]=H,a[this._hashKey(e[2*J],e[2*J+1])]=J}}}this.hull=new Uint32Array(W);for(var re=0,ae=this._hullStart;re<W;re++)this.hull[re]=ae,ae=n[ae];this.triangles=this._triangles.subarray(0,this.trianglesLen),this.halfedges=this._halfedges.subarray(0,this.trianglesLen)}},{key:"_hashKey",value:function(e,t){return Math.floor(function(e,t){var n=e/(Math.abs(e)+Math.abs(t));return(t>0?3-n:1+n)/4}(e-this._cx,t-this._cy)*this._hashSize)%this._hashSize}},{key:"_legalize",value:function(e){for(var t=this._triangles,n=this._halfedges,r=this.coords,a=0,i=0;;){var o=n[e],u=e-e%3;if(i=u+(e+2)%3,-1!==o){var s=o-o%3,c=u+(e+1)%3,l=s+(o+2)%3,f=t[i],d=t[e],h=t[c],p=t[l];if(AY(r[2*f],r[2*f+1],r[2*d],r[2*d+1],r[2*h],r[2*h+1],r[2*p],r[2*p+1])){t[e]=p,t[o]=f;var v=n[l];if(-1===v){var m=this._hullStart;do{if(this._hullTri[m]===l){this._hullTri[m]=e;break}m=this._hullPrev[m]}while(m!==this._hullStart)}this._link(e,v),this._link(o,n[i]),this._link(i,l);var g=s+(o+1)%3;a<wY.length&&(wY[a++]=g)}else{if(0===a)break;e=wY[--a]}}else{if(0===a)break;e=wY[--a]}}return i}},{key:"_link",value:function(e,t){this._halfedges[e]=t,-1!==t&&(this._halfedges[t]=e)}},{key:"_addTriangle",value:function(e,t,n,r,a,i){var o=this.trianglesLen;return this._triangles[o]=e,this._triangles[o+1]=t,this._triangles[o+2]=n,this._link(o,r),this._link(o+1,a),this._link(o+2,i),this.trianglesLen+=3,o}}],[{key:"from",value:function(t){for(var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:IY,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:DY,a=t.length,i=new Float64Array(2*a),o=0;o<a;o++){var u=t[o];i[2*o]=n(u),i[2*o+1]=r(u)}return new e(i)}}]),e}();function _Y(e,t,n,r){var a=e-n,i=t-r;return a*a+i*i}function SY(e,t,n,r,a,i){var o=(r-t)*(a-e),u=(n-e)*(i-t);return Math.abs(o-u)>=33306690738754716e-32*Math.abs(o+u)?o-u:0}function CY(e,t,n,r,a,i){return(SY(a,i,e,t,n,r)||SY(e,t,n,r,a,i)||SY(n,r,a,i,e,t))<0}function AY(e,t,n,r,a,i,o,u){var s=e-o,c=t-u,l=n-o,f=r-u,d=a-o,h=i-u,p=l*l+f*f,v=d*d+h*h;return s*(f*v-p*h)-c*(l*v-p*d)+(s*s+c*c)*(l*h-f*d)<0}function EY(e,t,n,r,a,i){var o=n-e,u=r-t,s=a-e,c=i-t,l=o*o+u*u,f=s*s+c*c,d=.5/(o*c-u*s),h=(c*l-u*f)*d,p=(o*f-s*l)*d;return h*h+p*p}function NY(e,t,n,r){if(r-n<=20)for(var a=n+1;a<=r;a++){for(var i=e[a],o=t[i],u=a-1;u>=n&&t[e[u]]>o;)e[u+1]=e[u--];e[u+1]=i}else{var s=n+1,c=r;TY(e,n+r>>1,s),t[e[n]]>t[e[r]]&&TY(e,n,r),t[e[s]]>t[e[r]]&&TY(e,s,r),t[e[n]]>t[e[s]]&&TY(e,n,s);for(var l=e[s],f=t[l];;){do{s++}while(t[e[s]]<f);do{c--}while(t[e[c]]>f);if(c<s)break;TY(e,s,c)}e[n+1]=e[c],e[c]=l,r-s+1>=c-n?(NY(e,t,s,r),NY(e,t,n,c-1)):(NY(e,t,n,c-1),NY(e,t,s,r))}}function TY(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function IY(e){return e[0]}function DY(e){return e[1]}var FY=1e-6,MY=function(){function e(){(0,op.Z)(this,e),this._x0=this._y0=this._x1=this._y1=null,this._=""}return(0,up.Z)(e,[{key:"moveTo",value:function(e,t){this._+="M".concat(this._x0=this._x1=+e,",").concat(this._y0=this._y1=+t)}},{key:"closePath",value:function(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")}},{key:"lineTo",value:function(e,t){this._+="L".concat(this._x1=+e,",").concat(this._y1=+t)}},{key:"arc",value:function(e,t,n){var r=(e=+e)+(n=+n),a=t=+t;if(n<0)throw new Error("negative radius");null===this._x1?this._+="M".concat(r,",").concat(a):(Math.abs(this._x1-r)>FY||Math.abs(this._y1-a)>FY)&&(this._+="L"+r+","+a),n&&(this._+="A".concat(n,",").concat(n,",0,1,1,").concat(e-n,",").concat(t,"A").concat(n,",").concat(n,",0,1,1,").concat(this._x1=r,",").concat(this._y1=a))}},{key:"rect",value:function(e,t,n,r){this._+="M".concat(this._x0=this._x1=+e,",").concat(this._y0=this._y1=+t,"h").concat(+n,"v").concat(+r,"h").concat(-n,"Z")}},{key:"value",value:function(){return this._||null}}]),e}(),OY=function(){function e(){(0,op.Z)(this,e),this._=[]}return(0,up.Z)(e,[{key:"moveTo",value:function(e,t){this._.push([e,t])}},{key:"closePath",value:function(){this._.push(this._[0].slice())}},{key:"lineTo",value:function(e,t){this._.push([e,t])}},{key:"value",value:function(){return this._.length?this._:null}}]),e}(),RY=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,960,500],r=(0,Cn.Z)(n,4),a=r[0],i=r[1],o=r[2],u=r[3];if((0,op.Z)(this,e),!((o=+o)>=(a=+a))||!((u=+u)>=(i=+i)))throw new Error("invalid bounds");this.delaunay=t,this._circumcenters=new Float64Array(2*t.points.length),this.vectors=new Float64Array(2*t.points.length),this.xmax=o,this.xmin=a,this.ymax=u,this.ymin=i,this._init()}return(0,up.Z)(e,[{key:"update",value:function(){return this.delaunay.update(),this._init(),this}},{key:"_init",value:function(){for(var e,t,n=this.delaunay,r=n.points,a=n.hull,i=n.triangles,o=this.vectors,u=this.circumcenters=this._circumcenters.subarray(0,i.length/3*2),s=0,c=0,l=i.length;s<l;s+=3,c+=2){var f=2*i[s],d=2*i[s+1],h=2*i[s+2],p=r[f],v=r[f+1],m=r[d],g=r[d+1],y=r[h],b=r[h+1],x=m-p,w=g-v,k=y-p,_=b-v,S=x*x+w*w,C=k*k+_*_,A=2*(x*_-w*k);if(A)if(Math.abs(A)<1e-8)e=(p+y)/2,t=(v+b)/2;else{var E=1/A;e=p+(_*S-w*C)*E,t=v+(x*C-k*S)*E}else e=(p+y)/2-1e8*_,t=(v+b)/2+1e8*k;u[c]=e,u[c+1]=t}var N,T,I,D=a[a.length-1],F=4*D,M=r[2*D],O=r[2*D+1];o.fill(0);for(var R=0;R<a.length;++R)N=F,T=M,I=O,F=4*(D=a[R]),M=r[2*D],O=r[2*D+1],o[N+2]=o[F]=I-O,o[N+3]=o[F+1]=M-T}},{key:"render",value:function(e){var t=null==e?e=new MY:void 0,n=this.delaunay,r=n.halfedges,a=n.inedges,i=n.hull,o=this.circumcenters,u=this.vectors;if(i.length<=1)return null;for(var s=0,c=r.length;s<c;++s){var l=r[s];if(!(l<s)){var f=2*Math.floor(s/3),d=2*Math.floor(l/3),h=o[f],p=o[f+1],v=o[d],m=o[d+1];this._renderSegment(h,p,v,m,e)}}for(var g,y=i[i.length-1],b=0;b<i.length;++b){g=y,y=i[b];var x=2*Math.floor(a[y]/3),w=o[x],k=o[x+1],_=4*g,S=this._project(w,k,u[_+2],u[_+3]);S&&this._renderSegment(w,k,S[0],S[1],e)}return t&&t.value()}},{key:"renderBounds",value:function(e){var t=null==e?e=new MY:void 0;return e.rect(this.xmin,this.ymin,this.xmax-this.xmin,this.ymax-this.ymin),t&&t.value()}},{key:"renderCell",value:function(e,t){var n=null==t?t=new MY:void 0,r=this._clip(e);if(null!==r&&r.length){t.moveTo(r[0],r[1]);for(var a=r.length;r[0]===r[a-2]&&r[1]===r[a-1]&&a>1;)a-=2;for(var i=2;i<a;i+=2)r[i]===r[i-2]&&r[i+1]===r[i-1]||t.lineTo(r[i],r[i+1]);return t.closePath(),n&&n.value()}}},{key:"cellPolygons",value:w().mark((function e(){var t,n,r,a;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this.delaunay.points,n=0,r=t.length/2;case 2:if(!(n<r)){e.next=11;break}if(!(a=this.cellPolygon(n))){e.next=8;break}return a.index=n,e.next=8,a;case 8:++n,e.next=2;break;case 11:case"end":return e.stop()}}),e,this)}))},{key:"cellPolygon",value:function(e){var t=new OY;return this.renderCell(e,t),t.value()}},{key:"_renderSegment",value:function(e,t,n,r,a){var i,o=this._regioncode(e,t),u=this._regioncode(n,r);0===o&&0===u?(a.moveTo(e,t),a.lineTo(n,r)):(i=this._clipSegment(e,t,n,r,o,u))&&(a.moveTo(i[0],i[1]),a.lineTo(i[2],i[3]))}},{key:"contains",value:function(e,t,n){return(t=+t)===t&&(n=+n)===n&&this.delaunay._step(e,t,n)===e}},{key:"neighbors",value:w().mark((function e(t){var n,r,a,i,o,u,s,c,l;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n=this._clip(t))){e.next=33;break}r=(0,Rt.Z)(this.delaunay.neighbors(t)),e.prev=3,r.s();case 5:if((a=r.n()).done){e.next=25;break}if(i=a.value,!(o=this._clip(i))){e.next=23;break}u=0,s=n.length;case 10:if(!(u<s)){e.next=23;break}c=0,l=o.length;case 12:if(!(c<l)){e.next=20;break}if(n[u]!=o[c]||n[u+1]!=o[c+1]||n[(u+2)%s]!=o[(c+l-2)%l]||n[(u+3)%s]!=o[(c+l-1)%l]){e.next=17;break}return e.next=16,i;case 16:return e.abrupt("break",23);case 17:c+=2,e.next=12;break;case 20:u+=2,e.next=10;break;case 23:e.next=5;break;case 25:e.next=30;break;case 27:e.prev=27,e.t0=e.catch(3),r.e(e.t0);case 30:return e.prev=30,r.f(),e.finish(30);case 33:case"end":return e.stop()}}),e,this,[[3,27,30,33]])}))},{key:"_cell",value:function(e){var t=this.circumcenters,n=this.delaunay,r=n.inedges,a=n.halfedges,i=n.triangles,o=r[e];if(-1===o)return null;var u=[],s=o;do{var c=Math.floor(s/3);if(u.push(t[2*c],t[2*c+1]),i[s=s%3===2?s-2:s+1]!==e)break;s=a[s]}while(s!==o&&-1!==s);return u}},{key:"_clip",value:function(e){if(0===e&&1===this.delaunay.hull.length)return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];var t=this._cell(e);if(null===t)return null;var n=this.vectors,r=4*e;return n[r]||n[r+1]?this._clipInfinite(e,t,n[r],n[r+1],n[r+2],n[r+3]):this._clipFinite(e,t)}},{key:"_clipFinite",value:function(e,t){for(var n,r,a,i,o,u=t.length,s=null,c=t[u-2],l=t[u-1],f=this._regioncode(c,l),d=0;d<u;d+=2)if(n=c,r=l,c=t[d],l=t[d+1],a=f,f=this._regioncode(c,l),0===a&&0===f)i=o,o=0,s?s.push(c,l):s=[c,l];else{var h=void 0,p=void 0,v=void 0,m=void 0,g=void 0;if(0===a){if(null===(h=this._clipSegment(n,r,c,l,a,f)))continue;var y=h,b=(0,Cn.Z)(y,4);p=b[0],v=b[1],m=b[2],g=b[3]}else{if(null===(h=this._clipSegment(c,l,n,r,f,a)))continue;var x=h,w=(0,Cn.Z)(x,4);m=w[0],g=w[1],p=w[2],v=w[3],i=o,o=this._edgecode(p,v),i&&o&&this._edge(e,i,o,s,s.length),s?s.push(p,v):s=[p,v]}i=o,o=this._edgecode(m,g),i&&o&&this._edge(e,i,o,s,s.length),s?s.push(m,g):s=[m,g]}if(s)i=o,o=this._edgecode(s[0],s[1]),i&&o&&this._edge(e,i,o,s,s.length);else if(this.contains(e,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2))return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];return s}},{key:"_clipSegment",value:function(e,t,n,r,a,i){for(;;){if(0===a&&0===i)return[e,t,n,r];if(a&i)return null;var o=void 0,u=void 0,s=a||i;8&s?(o=e+(n-e)*(this.ymax-t)/(r-t),u=this.ymax):4&s?(o=e+(n-e)*(this.ymin-t)/(r-t),u=this.ymin):2&s?(u=t+(r-t)*(this.xmax-e)/(n-e),o=this.xmax):(u=t+(r-t)*(this.xmin-e)/(n-e),o=this.xmin),a?(e=o,t=u,a=this._regioncode(e,t)):(n=o,r=u,i=this._regioncode(n,r))}}},{key:"_clipInfinite",value:function(e,t,n,r,a,i){var o,u=Array.from(t);if((o=this._project(u[0],u[1],n,r))&&u.unshift(o[0],o[1]),(o=this._project(u[u.length-2],u[u.length-1],a,i))&&u.push(o[0],o[1]),u=this._clipFinite(e,u))for(var s,c=0,l=u.length,f=this._edgecode(u[l-2],u[l-1]);c<l;c+=2)s=f,f=this._edgecode(u[c],u[c+1]),s&&f&&(c=this._edge(e,s,f,u,c),l=u.length);else this.contains(e,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2)&&(u=[this.xmin,this.ymin,this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax]);return u}},{key:"_edge",value:function(e,t,n,r,a){for(;t!==n;){var i=void 0,o=void 0;switch(t){case 5:t=4;continue;case 4:t=6,i=this.xmax,o=this.ymin;break;case 6:t=2;continue;case 2:t=10,i=this.xmax,o=this.ymax;break;case 10:t=8;continue;case 8:t=9,i=this.xmin,o=this.ymax;break;case 9:t=1;continue;case 1:t=5,i=this.xmin,o=this.ymin}r[a]===i&&r[a+1]===o||!this.contains(e,i,o)||(r.splice(a,0,i,o),a+=2)}if(r.length>4)for(var u=0;u<r.length;u+=2){var s=(u+2)%r.length,c=(u+4)%r.length;(r[u]===r[s]&&r[s]===r[c]||r[u+1]===r[s+1]&&r[s+1]===r[c+1])&&(r.splice(s,2),u-=2)}return a}},{key:"_project",value:function(e,t,n,r){var a,i,o,u=1/0;if(r<0){if(t<=this.ymin)return null;(a=(this.ymin-t)/r)<u&&(o=this.ymin,i=e+(u=a)*n)}else if(r>0){if(t>=this.ymax)return null;(a=(this.ymax-t)/r)<u&&(o=this.ymax,i=e+(u=a)*n)}if(n>0){if(e>=this.xmax)return null;(a=(this.xmax-e)/n)<u&&(i=this.xmax,o=t+(u=a)*r)}else if(n<0){if(e<=this.xmin)return null;(a=(this.xmin-e)/n)<u&&(i=this.xmin,o=t+(u=a)*r)}return[i,o]}},{key:"_edgecode",value:function(e,t){return(e===this.xmin?1:e===this.xmax?2:0)|(t===this.ymin?4:t===this.ymax?8:0)}},{key:"_regioncode",value:function(e,t){return(e<this.xmin?1:e>this.xmax?2:0)|(t<this.ymin?4:t>this.ymax?8:0)}}]),e}(),jY=w().mark(VY),BY=2*Math.PI,zY=Math.pow;function ZY(e){return e[0]}function LY(e){return e[1]}function PY(e,t,n){return[e+Math.sin(e+t)*n,t+Math.cos(e-t)*n]}var UY=function(){function e(t){(0,op.Z)(this,e),this._delaunator=new kY(t),this.inedges=new Int32Array(t.length/2),this._hullIndex=new Int32Array(t.length/2),this.points=this._delaunator.coords,this._init()}return(0,up.Z)(e,[{key:"update",value:function(){return this._delaunator.update(),this._init(),this}},{key:"_init",value:function(){var e=this._delaunator,t=this.points;if(e.hull&&e.hull.length>2&&function(e){for(var t=e.triangles,n=e.coords,r=0;r<t.length;r+=3){var a=2*t[r],i=2*t[r+1],o=2*t[r+2];if((n[o]-n[a])*(n[i+1]-n[a+1])-(n[i]-n[a])*(n[o+1]-n[a+1])>1e-10)return!1}return!0}(e)){this.collinear=Int32Array.from({length:t.length/2},(function(e,t){return t})).sort((function(e,n){return t[2*e]-t[2*n]||t[2*e+1]-t[2*n+1]}));for(var n=this.collinear[0],r=this.collinear[this.collinear.length-1],a=[t[2*n],t[2*n+1],t[2*r],t[2*r+1]],i=1e-8*Math.hypot(a[3]-a[1],a[2]-a[0]),o=0,u=t.length/2;o<u;++o){var s=PY(t[2*o],t[2*o+1],i);t[2*o]=s[0],t[2*o+1]=s[1]}this._delaunator=new kY(t)}else delete this.collinear;for(var c=this.halfedges=this._delaunator.halfedges,l=this.hull=this._delaunator.hull,f=this.triangles=this._delaunator.triangles,d=this.inedges.fill(-1),h=this._hullIndex.fill(-1),p=0,v=c.length;p<v;++p){var m=f[p%3===2?p-2:p+1];-1!==c[p]&&-1!==d[m]||(d[m]=p)}for(var g=0,y=l.length;g<y;++g)h[l[g]]=g;l.length<=2&&l.length>0&&(this.triangles=new Int32Array(3).fill(-1),this.halfedges=new Int32Array(3).fill(-1),this.triangles[0]=l[0],this.triangles[1]=l[1],this.triangles[2]=l[1],d[l[0]]=1,2===l.length&&(d[l[1]]=0))}},{key:"voronoi",value:function(e){return new RY(this,e)}},{key:"neighbors",value:w().mark((function e(t){var n,r,a,i,o,u,s,c,l,f,d;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.inedges,r=this.hull,a=this._hullIndex,i=this.halfedges,o=this.triangles,!(u=this.collinear)){e.next=10;break}if(!((s=u.indexOf(t))>0)){e.next=6;break}return e.next=6,u[s-1];case 6:if(!(s<u.length-1)){e.next=9;break}return e.next=9,u[s+1];case 9:return e.abrupt("return");case 10:if(-1!==(c=n[t])){e.next=13;break}return e.abrupt("return");case 13:l=c,f=-1;case 14:return e.next=16,f=o[l];case 16:if(o[l=l%3===2?l-2:l+1]===t){e.next=19;break}return e.abrupt("return");case 19:if(-1!==(l=i[l])){e.next=26;break}if((d=r[(a[t]+1)%r.length])===f){e.next=25;break}return e.next=25,d;case 25:return e.abrupt("return");case 26:if(l!==c){e.next=14;break}case 27:case"end":return e.stop()}}),e,this)}))},{key:"find",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if((e=+e)!==e||(t=+t)!==t)return-1;for(var r,a=n;(r=this._step(n,e,t))>=0&&r!==n&&r!==a;)n=r;return r}},{key:"_step",value:function(e,t,n){var r=this.inedges,a=this.hull,i=this._hullIndex,o=this.halfedges,u=this.triangles,s=this.points;if(-1===r[e]||!s.length)return(e+1)%(s.length>>1);var c=e,l=zY(t-s[2*e],2)+zY(n-s[2*e+1],2),f=r[e],d=f;do{var h=u[d],p=zY(t-s[2*h],2)+zY(n-s[2*h+1],2);if(p<l&&(l=p,c=h),u[d=d%3===2?d-2:d+1]!==e)break;if(-1===(d=o[d])){if((d=a[(i[e]+1)%a.length])!==h&&zY(t-s[2*d],2)+zY(n-s[2*d+1],2)<l)return d;break}}while(d!==f);return c}},{key:"render",value:function(e){for(var t=null==e?e=new MY:void 0,n=this.points,r=this.halfedges,a=this.triangles,i=0,o=r.length;i<o;++i){var u=r[i];if(!(u<i)){var s=2*a[i],c=2*a[u];e.moveTo(n[s],n[s+1]),e.lineTo(n[c],n[c+1])}}return this.renderHull(e),t&&t.value()}},{key:"renderPoints",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,n=null==e?e=new MY:void 0,r=this.points,a=0,i=r.length;a<i;a+=2){var o=r[a],u=r[a+1];e.moveTo(o+t,u),e.arc(o,u,t,0,BY)}return n&&n.value()}},{key:"renderHull",value:function(e){var t=null==e?e=new MY:void 0,n=this.hull,r=this.points,a=2*n[0],i=n.length;e.moveTo(r[a],r[a+1]);for(var o=1;o<i;++o){var u=2*n[o];e.lineTo(r[u],r[u+1])}return e.closePath(),t&&t.value()}},{key:"hullPolygon",value:function(){var e=new OY;return this.renderHull(e),e.value()}},{key:"renderTriangle",value:function(e,t){var n=null==t?t=new MY:void 0,r=this.points,a=this.triangles,i=2*a[e*=3],o=2*a[e+1],u=2*a[e+2];return t.moveTo(r[i],r[i+1]),t.lineTo(r[o],r[o+1]),t.lineTo(r[u],r[u+1]),t.closePath(),n&&n.value()}},{key:"trianglePolygons",value:w().mark((function e(){var t,n,r;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this.triangles,n=0,r=t.length/3;case 2:if(!(n<r)){e.next=8;break}return e.next=5,this.trianglePolygon(n);case 5:++n,e.next=2;break;case 8:case"end":return e.stop()}}),e,this)}))},{key:"trianglePolygon",value:function(e){var t=new OY;return this.renderTriangle(e,t),t.value()}}],[{key:"from",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ZY,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:LY,a=arguments.length>3?arguments[3]:void 0;return new e("length"in t?WY(t,n,r,a):Float64Array.from(VY(t,n,r,a)))}}]),e}();function WY(e,t,n,r){for(var a=e.length,i=new Float64Array(2*a),o=0;o<a;++o){var u=e[o];i[2*o]=t.call(r,u,o,e),i[2*o+1]=n.call(r,u,o,e)}return i}function VY(e,t,n,r){var a,i,o,u;return w().wrap((function(s){for(;;)switch(s.prev=s.next){case 0:a=0,i=(0,Rt.Z)(e),s.prev=2,i.s();case 4:if((o=i.n()).done){s.next=13;break}return u=o.value,s.next=8,t.call(r,u,a,e);case 8:return s.next=10,n.call(r,u,a,e);case 10:++a;case 11:s.next=4;break;case 13:s.next=18;break;case 15:s.prev=15,s.t0=s.catch(2),i.e(s.t0);case 18:return s.prev=18,i.f(),s.finish(18);case 21:case"end":return s.stop()}}),jY,null,[[2,15,18,21]])}function qY(e){wu.call(this,null,e)}qY.Definition={type:"Voronoi",metadata:{modifies:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"size",type:"number",array:!0,length:2},{name:"extent",type:"array",array:!0,length:2,default:[[-1e5,-1e5],[1e5,1e5]],content:{type:"number",array:!0,length:2}},{name:"as",type:"string",default:"path"}]};var GY=[-1e5,-1e5,1e5,1e5];function HY(e){for(var t=e[0][0],n=e[0][1],r=e.length-1;e[r][0]===t&&e[r][1]===n;--r);return"M"+e.slice(0,r+1).join("L")+"Z"}function XY(e,t,n){return e.fields=t||[],e.fname=n,e}function KY(e){return 1===e.length?YY(e[0]):$Y(e)}dt(qY,wu,{transform:function(e,t){var n=e.as||"path",r=t.source;if(!r||!r.length)return t;var a=e.size;a=a?[0,0,a[0],a[1]]:(a=e.extent)?[a[0][0],a[0][1],a[1][0],a[1][1]]:GY;for(var i=this.value=UY.from(r,e.x,e.y).voronoi(a),o=0,u=r.length;o<u;++o){var s=i.cellPolygon(o);r[o][n]=s?HY(s):null}return t.reflow(e.modified()).modifies(n)}});var YY=function(e){return function(t){return t[e]}},$Y=function(e){var t=e.length;return function(n){for(var r=0;r<t;++r)n=n[e[r]];return n}};function QY(e){throw Error(e)}function JY(e){var t,n,r,a=[],i=e.length,o=null,u=0,s="";function c(){a.push(s+e.substring(t,n)),s="",t=n+1}for(e+="",t=n=0;n<i;++n)if("\\"===(r=e[n]))s+=e.substring(t,n++),t=n;else if(r===o)c(),o=null,u=-1;else{if(o)continue;t===u&&'"'===r||t===u&&"'"===r?(t=n+1,o=r):"."!==r||u?"["===r?(n>t&&c(),u=t=n+1):"]"===r&&(u||QY("Access path missing open bracket: "+e),u>0&&c(),u=0,t=n+1):n>t?c():t=n+1}return u&&QY("Access path missing closing bracket: "+e),o&&QY("Access path missing closing quote: "+e),n>t&&(n++,c()),a}function e$(e,t,n){var r=JY(e);return e=1===r.length?r[0]:e,XY((n&&n.get||KY)(r),[e],t||e)}e$("id"),XY((function(e){return e}),[],"identity"),XY((function(){return 0}),[],"zero"),XY((function(){return 1}),[],"one"),XY((function(){return!0}),[],"true"),XY((function(){return!1}),[],"false");var t$=Array.isArray;function n$(e){return e[e.length-1]}function r$(e){return null==e||""===e?null:+e}function a$(e){return null!=e?t$(e)?e:[e]:[]}function i$(e){return"function"===typeof e}Object.prototype.hasOwnProperty;var o$,u$,s$,c$,l$,f$,d$;var h$="year",p$="quarter",v$="month",m$="week",g$="date",y$="day",b$="dayofyear",x$="hours",w$="minutes",k$="seconds",_$="milliseconds";[h$,p$,v$,m$,g$,y$,b$,x$,w$,k$,_$].reduce((function(e,t,n){return e[t]=1+n,e}),{});o$={},(0,Xn.Z)(o$,h$,"%Y "),(0,Xn.Z)(o$,p$,"Q%q "),(0,Xn.Z)(o$,v$,"%b "),(0,Xn.Z)(o$,g$,"%d "),(0,Xn.Z)(o$,m$,"W%U "),(0,Xn.Z)(o$,y$,"%a "),(0,Xn.Z)(o$,b$,"%j "),(0,Xn.Z)(o$,x$,"%H:00"),(0,Xn.Z)(o$,w$,"00:%M"),(0,Xn.Z)(o$,k$,":%S"),(0,Xn.Z)(o$,_$,".%L"),(0,Xn.Z)(o$,"".concat(h$,"-").concat(v$),"%Y-%m "),(0,Xn.Z)(o$,"".concat(h$,"-").concat(v$,"-").concat(g$),"%Y-%m-%d "),(0,Xn.Z)(o$,"".concat(x$,"-").concat(w$),"%H:%M");var S$=new Date;function C$(e){return S$.setFullYear(e),S$.setMonth(0),S$.setDate(1),S$.setHours(0,0,0,0),S$}function A$(e){return ir.count(C$(e.getFullYear())-1,e)}function E$(e){return cr.count(C$(e.getFullYear())-1,e)}function N$(e){return C$(e).getDay()}function T$(e){var t=Date.UTC(e.getUTCFullYear(),0,1);return or.count(t-1,e)}function I$(e){var t=Date.UTC(e.getUTCFullYear(),0,1);return gr.count(t-1,e)}function D$(e){return S$.setTime(Date.UTC(e,0,1)),S$.getUTCDay()}function F$(e,t,n){return t+7*e-(n+6)%7}u$={},(0,Xn.Z)(u$,h$,(function(e){return e.getFullYear()})),(0,Xn.Z)(u$,p$,(function(e){return Math.floor(e.getMonth()/3)})),(0,Xn.Z)(u$,v$,(function(e){return e.getMonth()})),(0,Xn.Z)(u$,g$,(function(e){return e.getDate()})),(0,Xn.Z)(u$,x$,(function(e){return e.getHours()})),(0,Xn.Z)(u$,w$,(function(e){return e.getMinutes()})),(0,Xn.Z)(u$,k$,(function(e){return e.getSeconds()})),(0,Xn.Z)(u$,_$,(function(e){return e.getMilliseconds()})),(0,Xn.Z)(u$,b$,(function(e){return A$(e)})),(0,Xn.Z)(u$,m$,(function(e){return E$(e)})),(0,Xn.Z)(u$,"weekday",(function(e,t){return F$(E$(e),e.getDay(),N$(t))})),(0,Xn.Z)(u$,y$,(function(e,t){return F$(1,e.getDay(),N$(t))})),s$={},(0,Xn.Z)(s$,p$,(function(e){return 3*e})),(0,Xn.Z)(s$,m$,(function(e,t){return F$(e,0,N$(t))}));c$={},(0,Xn.Z)(c$,h$,(function(e){return e.getUTCFullYear()})),(0,Xn.Z)(c$,p$,(function(e){return Math.floor(e.getUTCMonth()/3)})),(0,Xn.Z)(c$,v$,(function(e){return e.getUTCMonth()})),(0,Xn.Z)(c$,g$,(function(e){return e.getUTCDate()})),(0,Xn.Z)(c$,x$,(function(e){return e.getUTCHours()})),(0,Xn.Z)(c$,w$,(function(e){return e.getUTCMinutes()})),(0,Xn.Z)(c$,k$,(function(e){return e.getUTCSeconds()})),(0,Xn.Z)(c$,_$,(function(e){return e.getUTCMilliseconds()})),(0,Xn.Z)(c$,b$,(function(e){return T$(e)})),(0,Xn.Z)(c$,m$,(function(e){return I$(e)})),(0,Xn.Z)(c$,y$,(function(e,t){return F$(1,e.getUTCDay(),D$(t))})),(0,Xn.Z)(c$,"weekday",(function(e,t){return F$(I$(e),e.getUTCDay(),D$(t))})),l$={},(0,Xn.Z)(l$,p$,(function(e){return 3*e})),(0,Xn.Z)(l$,m$,(function(e,t){return F$(e,0,D$(t))}));f$={},(0,Xn.Z)(f$,h$,Sr),(0,Xn.Z)(f$,p$,Ar.every(3)),(0,Xn.Z)(f$,v$,Ar),(0,Xn.Z)(f$,m$,cr),(0,Xn.Z)(f$,g$,ir),(0,Xn.Z)(f$,y$,ir),(0,Xn.Z)(f$,b$,ir),(0,Xn.Z)(f$,x$,Nr),(0,Xn.Z)(f$,w$,Ir),(0,Xn.Z)(f$,k$,Fr),(0,Xn.Z)(f$,_$,Mr),d$={},(0,Xn.Z)(d$,h$,Cr),(0,Xn.Z)(d$,p$,Er.every(3)),(0,Xn.Z)(d$,v$,Er),(0,Xn.Z)(d$,m$,gr),(0,Xn.Z)(d$,g$,or),(0,Xn.Z)(d$,y$,or),(0,Xn.Z)(d$,b$,or),(0,Xn.Z)(d$,x$,Tr),(0,Xn.Z)(d$,w$,Dr),(0,Xn.Z)(d$,k$,Fr),(0,Xn.Z)(d$,_$,Mr);var M$,O$,R$=[h$,v$,g$,x$,w$,k$,_$],j$=R$.slice(0,-1),B$=j$.slice(0,-1),z$=B$.slice(0,-1);z$.slice(0,-1);var Z$="linear",L$="log",P$="pow",U$="sqrt",W$="symlog",V$="time",q$="utc",G$="sequential",H$="diverging",X$="quantile",K$="quantize",Y$="threshold",$$="continuous",Q$="discrete",J$="discretizing",eQ="interpolating",tQ="temporal";function nQ(){var e,t,n=zg().unknown(void 0),r=n.domain,a=n.range,i=[0,1],o=!1,u=0,s=0,c=.5;function l(){var n=r().length,l=i[1]<i[0],f=i[1-l],d=function(e,t,n){var r=e-t+2*n;return e?r>0?r:1:0}(n,u,s),h=i[l-0];e=(f-h)/(d||1),o&&(e=Math.floor(e)),h+=(f-h-e*(n-u))*c,t=e*(1-u),o&&(h=Math.round(h),t=Math.round(t));var p=em(n).map((function(t){return h+e*t}));return a(l?p.reverse():p)}return delete n.unknown,n.domain=function(e){return arguments.length?(r(e),l()):r()},n.range=function(e){return arguments.length?(i=[+e[0],+e[1]],l()):i.slice()},n.rangeRound=function(e){return i=[+e[0],+e[1]],o=!0,l()},n.bandwidth=function(){return t},n.step=function(){return e},n.round=function(e){return arguments.length?(o=!!e,l()):o},n.padding=function(e){return arguments.length?(s=Math.max(0,Math.min(1,e)),u=s,l()):u},n.paddingInner=function(e){return arguments.length?(u=Math.max(0,Math.min(1,e)),l()):u},n.paddingOuter=function(e){return arguments.length?(s=Math.max(0,Math.min(1,e)),l()):s},n.align=function(e){return arguments.length?(c=Math.max(0,Math.min(1,e)),l()):c},n.invertRange=function(e){if(null!=e[0]&&null!=e[1]){var n,o,u,s=i[1]<i[0],c=s?a().reverse():a(),l=c.length-1,f=+e[0],d=+e[1];if(f===f&&d===d&&(d<f&&(u=f,f=d,d=u),!(d<c[0]||f>i[1-s])))return n=Math.max(0,um(c,f)-1),o=f===d?n:um(c,d)-1,f-c[n]>t+1e-10&&++n,s&&(u=n,n=l-o,o=l-u),n>o?void 0:r().slice(n,o+1)}},n.invert=function(e){var t=n.invertRange([e,e]);return t?t[0]:t},n.copy=function(){return nQ().domain(r()).range(i).round(o).paddingInner(u).paddingOuter(s).align(c)},l()}function rQ(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,e.copy=function(){return rQ(t())},e}var aQ=Array.prototype.map;function iQ(e){return aQ.call(e,r$)}var oQ=Array.prototype.slice;var uQ=new Map,sQ=Symbol("vega_scale");function cQ(e,t,n){var r=function(){var n=t();return n.invertRange||(n.invertRange=n.invert?function(e){return function(t){var n,r=t[0],a=t[1];return a<r&&(n=r,r=a,a=n),[e.invert(r),e.invert(a)]}}(n):n.invertExtent?function(e){return function(t){var n,r,a,i,o=e.range(),u=t[0],s=t[1],c=-1;for(s<u&&(r=u,u=s,s=r),a=0,i=o.length;a<i;++a)o[a]>=u&&o[a]<=s&&(c<0&&(c=a),n=a);if(!(c<0))return u=e.invertExtent(o[c]),s=e.invertExtent(o[n]),[void 0===u[0]?u[1]:u[0],void 0===s[1]?s[0]:s[1]]}}(n):void 0),n.type=e,function(e){return e[sQ]=!0,e}(n)};return r.metadata=function(e){for(var t={},n=e.length,r=0;r<n;++r)t[e[r]]=!0;return t}(a$(n)),r}function lQ(e,t,n){return arguments.length>1?(uQ.set(e,cQ(e,t,n)),this):fQ(e)?uQ.get(e):void 0}function fQ(e){return uQ.has(e)}lQ("identity",Em),lQ(Z$,Am,$$),lQ(L$,jm,[$$,L$]),lQ(P$,Pm,$$),lQ(U$,Um,$$),lQ(W$,Gm,$$),lQ(V$,ig,[$$,tQ]),lQ(q$,og,[$$,tQ]),lQ(G$,cg,[$$,eQ]),lQ("".concat(G$,"-").concat(Z$),cg,[$$,eQ]),lQ("".concat(G$,"-").concat(L$),lg,[$$,eQ,L$]),lQ("".concat(G$,"-").concat(P$),dg,[$$,eQ]),lQ("".concat(G$,"-").concat(U$),hg,[$$,eQ]),lQ("".concat(G$,"-").concat(W$),fg,[$$,eQ]),lQ("".concat(H$,"-").concat(Z$),mg,[$$,eQ]),lQ("".concat(H$,"-").concat(L$),gg,[$$,eQ,L$]),lQ("".concat(H$,"-").concat(P$),bg,[$$,eQ]),lQ("".concat(H$,"-").concat(U$),xg,[$$,eQ]),lQ("".concat(H$,"-").concat(W$),yg,[$$,eQ]),lQ(X$,kg,[J$,X$]),lQ(K$,_g,J$),lQ(Y$,Sg,J$),lQ("bin-ordinal",(function e(){var t=[],n=[];function r(e){return null==e||e!==e?void 0:n[(sm(t,e)-1)%n.length]}return r.domain=function(e){return arguments.length?(t=iQ(e),r):t.slice()},r.range=function(e){return arguments.length?(n=oQ.call(e),r):n.slice()},r.tickFormat=function(e,n){return Sm(t[0],n$(t),null==e?10:e,n)},r.copy=function(){return e().domain(r.domain()).range(r.range())},r}),[Q$,J$]),lQ("ordinal",zg,Q$),lQ("band",nQ,Q$),lQ("point",(function(){return rQ(nQ().paddingInner(1))}),Q$);function dQ(e,t,n){return pg.Z(function(e,t){var n=Pg[function(e){return"interpolate"+e.toLowerCase().split("-").map((function(e){return e[0].toUpperCase()+e.slice(1)})).join("")}(e)];return null!=t&&n&&n.gamma?n.gamma(t):n}(t||"rgb",n),e)}function hQ(e){for(var t=e.length/6|0,n=new Array(t),r=0;r<t;)n[r]="#"+e.slice(6*r,6*++r);return n}function pQ(e,t){for(var n in e)mQ(n,t(e[n]))}var vQ={};function mQ(e,t){return e=e&&e.toLowerCase(),arguments.length>1?(vQ[e]=t,this):vQ[e]}pQ({category10:"1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf",category20:"1f77b4aec7e8ff7f0effbb782ca02c98df8ad62728ff98969467bdc5b0d58c564bc49c94e377c2f7b6d27f7f7fc7c7c7bcbd22dbdb8d17becf9edae5",category20b:"393b795254a36b6ecf9c9ede6379398ca252b5cf6bcedb9c8c6d31bd9e39e7ba52e7cb94843c39ad494ad6616be7969c7b4173a55194ce6dbdde9ed6",category20c:"3182bd6baed69ecae1c6dbefe6550dfd8d3cfdae6bfdd0a231a35474c476a1d99bc7e9c0756bb19e9ac8bcbddcdadaeb636363969696bdbdbdd9d9d9",tableau10:"4c78a8f58518e4575672b7b254a24beeca3bb279a2ff9da69d755dbab0ac",tableau20:"4c78a89ecae9f58518ffbf7954a24b88d27ab79a20f2cf5b43989483bcb6e45756ff9d9879706ebab0acd67195fcbfd2b279a2d6a5c99e765fd8b5a5",accent:"7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666",dark2:"1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666",paired:"a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928",pastel1:"fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2",pastel2:"b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc",set1:"e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999",set2:"66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3",set3:"8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f"},hQ),pQ({blues:"cfe1f2bed8eca8cee58fc1de74b2d75ba3cf4592c63181bd206fb2125ca40a4a90",greens:"d3eecdc0e6baabdda594d3917bc77d60ba6c46ab5e329a512089430e7735036429",greys:"e2e2e2d4d4d4c4c4c4b1b1b19d9d9d8888887575756262624d4d4d3535351e1e1e",oranges:"fdd8b3fdc998fdb87bfda55efc9244f87f2cf06b18e4580bd14904b93d029f3303",purples:"e2e1efd4d4e8c4c5e0b4b3d6a3a0cc928ec3827cb97566ae684ea25c3696501f8c",reds:"fdc9b4fcb49afc9e80fc8767fa7051f6573fec3f2fdc2a25c81b1db21218970b13",blueGreen:"d5efedc1e8e0a7ddd18bd2be70c6a958ba9144ad77319c5d2089460e7736036429",bluePurple:"ccddecbad0e4a8c2dd9ab0d4919cc98d85be8b6db28a55a6873c99822287730f71",greenBlue:"d3eecec5e8c3b1e1bb9bd8bb82cec269c2ca51b2cd3c9fc7288abd1675b10b60a1",orangeRed:"fddcaffdcf9bfdc18afdad77fb9562f67d53ee6545e24932d32d1ebf130da70403",purpleBlue:"dbdaebc8cee4b1c3de97b7d87bacd15b9fc93a90c01e7fb70b70ab056199045281",purpleBlueGreen:"dbd8eac8cee4b0c3de93b7d872acd1549fc83892bb1c88a3097f8702736b016353",purpleRed:"dcc9e2d3b3d7ce9eccd186c0da6bb2e14da0e23189d91e6fc61159ab07498f023a",redPurple:"fccfccfcbec0faa9b8f98faff571a5ec539ddb3695c41b8aa908808d0179700174",yellowGreen:"e4f4acd1eca0b9e2949ed68880c97c62bb6e47aa5e3297502083440e723b036034",yellowOrangeBrown:"feeaa1fedd84fecc63feb746fca031f68921eb7215db5e0bc54c05ab3d038f3204",yellowOrangeRed:"fee087fed16ffebd59fea849fd903efc7335f9522bee3423de1b20ca0b22af0225",blueOrange:"134b852f78b35da2cb9dcae1d2e5eff2f0ebfce0bafbbf74e8932fc5690d994a07",brownBlueGreen:"704108a0651ac79548e3c78af3e6c6eef1eac9e9e48ed1c74da79e187a72025147",purpleGreen:"5b1667834792a67fb6c9aed3e6d6e8eff0efd9efd5aedda971bb75368e490e5e29",purpleOrange:"4114696647968f83b7b9b4d6dadbebf3eeeafce0bafbbf74e8932fc5690d994a07",redBlue:"8c0d25bf363adf745ef4ae91fbdbc9f2efeed2e5ef9dcae15da2cb2f78b3134b85",redGrey:"8c0d25bf363adf745ef4ae91fcdccbfaf4f1e2e2e2c0c0c0969696646464343434",yellowGreenBlue:"eff9bddbf1b4bde5b594d5b969c5be45b4c22c9ec02182b82163aa23479c1c3185",redYellowBlue:"a50026d4322cf16e43fcac64fedd90faf8c1dcf1ecabd6e875abd04a74b4313695",redYellowGreen:"a50026d4322cf16e43fcac63fedd8df9f7aed7ee8ea4d86e64bc6122964f006837",pinkYellowGreen:"8e0152c0267edd72adf0b3d6faddedf5f3efe1f2cab6de8780bb474f9125276419",spectral:"9e0142d13c4bf0704afcac63fedd8dfbf8b0e0f3a1a9dda269bda94288b55e4fa2",viridis:"440154470e61481a6c482575472f7d443a834144873d4e8a39568c35608d31688e2d708e2a788e27818e23888e21918d1f988b1fa08822a8842ab07f35b77943bf7154c56866cc5d7ad1518fd744a5db36bcdf27d2e21be9e51afde725",magma:"0000040404130b0924150e3720114b2c11603b0f704a107957157e651a80721f817f24828c29819a2e80a8327db6377ac43c75d1426fde4968e95462f1605df76f5cfa7f5efc8f65fe9f6dfeaf78febf84fece91fddea0fcedaffcfdbf",inferno:"0000040403130c0826170c3b240c4f330a5f420a68500d6c5d126e6b176e781c6d86216b932667a12b62ae305cbb3755c73e4cd24644dd513ae65c30ed6925f3771af8850ffb9506fca50afcb519fac62df6d645f2e661f3f484fcffa4",plasma:"0d088723069033059742039d5002a25d01a66a00a87801a88405a7900da49c179ea72198b12a90ba3488c33d80cb4779d35171da5a69e16462e76e5bed7953f2834cf68f44fa9a3dfca636fdb32ffec029fcce25f9dc24f5ea27f0f921",cividis:"00205100235800265d002961012b65042e670831690d346b11366c16396d1c3c6e213f6e26426e2c456e31476e374a6e3c4d6e42506e47536d4c566d51586e555b6e5a5e6e5e616e62646f66676f6a6a706e6d717270717573727976737c79747f7c75827f758682768985778c8877908b78938e789691789a94789e9778a19b78a59e77a9a177aea575b2a874b6ab73bbaf71c0b26fc5b66dc9b96acebd68d3c065d8c462ddc85fe2cb5ce7cf58ebd355f0d652f3da4ff7de4cfae249fce647",rainbow:"6e40aa883eb1a43db3bf3cafd83fa4ee4395fe4b83ff576eff6659ff7847ff8c38f3a130e2b72fcfcc36bee044aff05b8ff4576ff65b52f6673af27828ea8d1ddfa319d0b81cbecb23abd82f96e03d82e14c6edb5a5dd0664dbf6e40aa",sinebow:"ff4040fc582af47218e78d0bd5a703bfbf00a7d5038de70b72f41858fc2a40ff402afc5818f4720be78d03d5a700bfbf03a7d50b8de71872f42a58fc4040ff582afc7218f48d0be7a703d5bf00bfd503a7e70b8df41872fc2a58ff4040",turbo:"23171b32204a3e2a71453493493eae4b49c54a53d7485ee44569ee4074f53c7ff8378af93295f72e9ff42ba9ef28b3e926bce125c5d925cdcf27d5c629dcbc2de3b232e9a738ee9d3ff39347f68950f9805afc7765fd6e70fe667cfd5e88fc5795fb51a1f84badf545b9f140c5ec3cd0e637dae034e4d931ecd12ef4c92bfac029ffb626ffad24ffa223ff9821ff8d1fff821dff771cfd6c1af76118f05616e84b14df4111d5380fcb2f0dc0260ab61f07ac1805a313029b0f00950c00910b00",browns:"eedbbdecca96e9b97ae4a865dc9856d18954c7784cc0673fb85536ad44339f3632",tealBlues:"bce4d89dd3d181c3cb65b3c245a2b9368fae347da0306a932c5985",teals:"bbdfdfa2d4d58ac9c975bcbb61b0af4da5a43799982b8b8c1e7f7f127273006667",warmGreys:"dcd4d0cec5c1c0b8b4b3aaa7a59c9998908c8b827f7e7673726866665c5a59504e",goldGreen:"f4d166d5ca60b6c35c98bb597cb25760a6564b9c533f8f4f33834a257740146c36",goldOrange:"f4d166f8be5cf8aa4cf5983bf3852aef701be2621fd65322c54923b142239e3a26",goldRed:"f4d166f6be59f9aa51fc964ef6834bee734ae56249db5247cf4244c43141b71d3e",lightGreyRed:"efe9e6e1dad7d5cbc8c8bdb9bbaea9cd967ddc7b43e15f19df4011dc000b",lightGreyTeal:"e4eaead6dcddc8ced2b7c2c7a6b4bc64b0bf22a6c32295c11f85be1876bc",lightMulti:"e0f1f2c4e9d0b0de9fd0e181f6e072f6c053f3993ef77440ef4a3c",lightOrange:"f2e7daf7d5baf9c499fab184fa9c73f68967ef7860e8645bde515bd43d5b",lightTealBlue:"e3e9e0c0dccf9aceca7abfc859afc0389fb9328dad2f7ca0276b95255988",darkBlue:"3232322d46681a5c930074af008cbf05a7ce25c0dd38daed50f3faffffff",darkGold:"3c3c3c584b37725e348c7631ae8b2bcfa424ecc31ef9de30fff184ffffff",darkGreen:"3a3a3a215748006f4d048942489e4276b340a6c63dd2d836ffeb2cffffaa",darkMulti:"3737371f5287197d8c29a86995ce3fffe800ffffff",darkRed:"3434347036339e3c38cc4037e75d1eec8620eeab29f0ce32ffeb2c"},(function(e){return dQ(hQ(e))}));M$={},(0,Xn.Z)(M$,X$,"quantiles"),(0,Xn.Z)(M$,K$,"thresholds"),(0,Xn.Z)(M$,Y$,"domain"),O$={},(0,Xn.Z)(O$,X$,"quantiles"),(0,Xn.Z)(O$,K$,"domain");var gQ=Math.random;Math.sqrt(2*Math.PI),Math.SQRT2;Math.PI;var yQ=Math.PI/180,bQ=2048;function xQ(){var e,t,n,r,a,i,o,u=[256,256],s=CQ,c=[],l=Math.random,f={};function d(e,t,n){for(var r,a,i,o=t.x,c=t.y,f=Math.sqrt(u[0]*u[0]+u[1]*u[1]),d=s(u),h=l()<.5?1:-1,p=-h;(r=d(p+=h))&&(a=~~r[0],i=~~r[1],!(Math.min(Math.abs(a),Math.abs(i))>=f));)if(t.x=o+a,t.y=c+i,!(t.x+t.x0<0||t.y+t.y0<0||t.x+t.x1>u[0]||t.y+t.y1>u[1])&&(!n||!kQ(t,e,u[0]))&&(!n||SQ(t,n))){for(var v,m=t.sprite,g=t.width>>5,y=u[0]>>5,b=t.x-(g<<4),x=127&b,w=32-x,k=t.y1-t.y0,_=(t.y+t.y0)*y+(b>>5),S=0;S<k;S++){v=0;for(var C=0;C<=g;C++)e[_+C]|=v<<w|(C<g?(v=m[S*g+C])>>>x:0);_+=y}return t.sprite=null,!0}return!1}return f.layout=function(){for(var s=function(e){e.width=e.height=1;var t=Math.sqrt(e.getContext("2d").getImageData(0,0,1,1).data.length>>2);e.width=2048/t,e.height=bQ/t;var n=e.getContext("2d");return n.fillStyle=n.strokeStyle="red",n.textAlign="center",{context:n,ratio:t}}(Ip()),f=function(e){var t=[],n=-1;for(;++n<e;)t[n]=0;return t}((u[0]>>5)*u[1]),h=null,p=c.length,v=-1,m=[],g=c.map((function(u){return{text:e(u),font:t(u),style:r(u),weight:a(u),rotate:i(u),size:~~(n(u)+1e-14),padding:o(u),xoff:0,yoff:0,x1:0,y1:0,x0:0,y0:0,hasText:!1,sprite:null,datum:u}})).sort((function(e,t){return t.size-e.size}));++v<p;){var y=g[v];y.x=u[0]*(l()+.5)>>1,y.y=u[1]*(l()+.5)>>1,wQ(s,y,g,v),y.hasText&&d(f,y,h)&&(m.push(y),h?_Q(h,y):h=[{x:y.x+y.x0,y:y.y+y.y0},{x:y.x+y.x1,y:y.y+y.y1}],y.x-=u[0]>>1,y.y-=u[1]>>1)}return m},f.words=function(e){return arguments.length?(c=e,f):c},f.size=function(e){return arguments.length?(u=[+e[0],+e[1]],f):u},f.font=function(e){return arguments.length?(t=AQ(e),f):t},f.fontStyle=function(e){return arguments.length?(r=AQ(e),f):r},f.fontWeight=function(e){return arguments.length?(a=AQ(e),f):a},f.rotate=function(e){return arguments.length?(i=AQ(e),f):i},f.text=function(t){return arguments.length?(e=AQ(t),f):e},f.spiral=function(e){return arguments.length?(s=EQ[e]||e,f):s},f.fontSize=function(e){return arguments.length?(n=AQ(e),f):n},f.padding=function(e){return arguments.length?(o=AQ(e),f):o},f.random=function(e){return arguments.length?(l=e,f):l},f}function wQ(e,t,n,r){if(!t.sprite){var a=e.context,i=e.ratio;a.clearRect(0,0,2048/i,bQ/i);var o,u,s,c,l,f=0,d=0,h=0,p=n.length;for(--r;++r<p;){if(t=n[r],a.save(),a.font=t.style+" "+t.weight+" "+~~((t.size+1)/i)+"px "+t.font,o=a.measureText(t.text+"m").width*i,s=t.size<<1,t.rotate){var v=Math.sin(t.rotate*yQ),m=Math.cos(t.rotate*yQ),g=o*m,y=o*v,b=s*m,x=s*v;o=Math.max(Math.abs(g+x),Math.abs(g-x))+31>>5<<5,s=~~Math.max(Math.abs(y+b),Math.abs(y-b))}else o=o+31>>5<<5;if(s>h&&(h=s),f+o>=2048&&(f=0,d+=h,h=0),d+s>=bQ)break;a.translate((f+(o>>1))/i,(d+(s>>1))/i),t.rotate&&a.rotate(t.rotate*yQ),a.fillText(t.text,0,0),t.padding&&(a.lineWidth=2*t.padding,a.strokeText(t.text,0,0)),a.restore(),t.width=o,t.height=s,t.xoff=f,t.yoff=d,t.x1=o>>1,t.y1=s>>1,t.x0=-t.x1,t.y0=-t.y1,t.hasText=!0,f+=o}for(var w=a.getImageData(0,0,2048/i,bQ/i).data,k=[];--r>=0;)if((t=n[r]).hasText){for(u=(o=t.width)>>5,s=t.y1-t.y0,c=0;c<s*u;c++)k[c]=0;if(null==(f=t.xoff))return;d=t.yoff;var _=0,S=-1;for(l=0;l<s;l++){for(c=0;c<o;c++){var C=u*l+(c>>5),A=w[2048*(d+l)+(f+c)<<2]?1<<31-c%32:0;k[C]|=A,_|=A}_?S=l:(t.y0++,s--,l--,d++)}t.y1=t.y0+S,t.sprite=k.slice(0,(t.y1-t.y0)*u)}}}function kQ(e,t,n){n>>=5;for(var r,a=e.sprite,i=e.width>>5,o=e.x-(i<<4),u=127&o,s=32-u,c=e.y1-e.y0,l=(e.y+e.y0)*n+(o>>5),f=0;f<c;f++){r=0;for(var d=0;d<=i;d++)if((r<<s|(d<i?(r=a[f*i+d])>>>u:0))&t[l+d])return!0;l+=n}return!1}function _Q(e,t){var n=e[0],r=e[1];t.x+t.x0<n.x&&(n.x=t.x+t.x0),t.y+t.y0<n.y&&(n.y=t.y+t.y0),t.x+t.x1>r.x&&(r.x=t.x+t.x1),t.y+t.y1>r.y&&(r.y=t.y+t.y1)}function SQ(e,t){return e.x+e.x1>t[0].x&&e.x+e.x0<t[1].x&&e.y+e.y1>t[0].y&&e.y+e.y0<t[1].y}function CQ(e){var t=e[0]/e[1];return function(e){return[t*(e*=.1)*Math.cos(e),e*Math.sin(e)]}}function AQ(e){return"function"===typeof e?e:function(){return e}}var EQ={archimedean:CQ,rectangular:function(e){var t=4*e[0]/e[1],n=0,r=0;return function(e){var a=e<0?-1:1;switch(Math.sqrt(1+4*a*e)-a&3){case 0:n+=t;break;case 1:r+=4;break;case 2:n-=t;break;default:r-=4}return[n,r]}}},NQ=["x","y","font","fontSize","fontStyle","fontWeight","angle"],TQ=["text","font","rotate","fontSize","fontStyle","fontWeight"];function IQ(e){wu.call(this,xQ(),e)}function DQ(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function FQ(e){var t=e,n=e;function r(e,t,r,a){for(null==r&&(r=0),null==a&&(a=e.length);r<a;){var i=r+a>>>1;n(e[i],t)<0?r=i+1:a=i}return r}return 1===e.length&&(t=function(t,n){return e(t)-n},n=function(e){return function(t,n){return DQ(e(t),n)}}(e)),{left:r,center:function(e,n,a,i){null==a&&(a=0),null==i&&(i=e.length);var o=r(e,n,a,i-1);return o>a&&t(e[o-1],n)>-t(e[o],n)?o-1:o},right:function(e,t,r,a){for(null==r&&(r=0),null==a&&(a=e.length);r<a;){var i=r+a>>>1;n(e[i],t)>0?a=i:r=i+1}return r}}}IQ.Definition={type:"Wordcloud",metadata:{modifies:!0},params:[{name:"size",type:"number",array:!0,length:2},{name:"font",type:"string",expr:!0,default:"sans-serif"},{name:"fontStyle",type:"string",expr:!0,default:"normal"},{name:"fontWeight",type:"string",expr:!0,default:"normal"},{name:"fontSize",type:"number",expr:!0,default:14},{name:"fontSizeRange",type:"number",array:"nullable",default:[10,50]},{name:"rotate",type:"number",expr:!0,default:0},{name:"text",type:"field"},{name:"spiral",type:"string",values:["archimedean","rectangular"]},{name:"padding",type:"number",expr:!0},{name:"as",type:"string",array:!0,length:7,default:NQ}]},function(e,t,n){var r=e.prototype=Object.create(t.prototype);Object.defineProperty(r,"constructor",{value:e,writable:!0,enumerable:!0,configurable:!0}),function(e){for(var t,n,r=1,a=arguments.length;r<a;++r)for(n in t=arguments[r])e[n]=t[n]}(r,n)}(IQ,wu,{transform:function(e,t){!e.size||e.size[0]&&e.size[1]||QY("Wordcloud size dimensions must be non-zero.");var n=e.modified();if(n||t.changed(t.ADD_REM)||TQ.some((function(n){var r=e[n];return i$(r)&&t.modified(r.fields)}))){var r,a=t.materialize(t.SOURCE).source,i=this.value,o=e.as||NQ,u=e.fontSize||14;if(i$(u)?r=e.fontSizeRange:u=function(e){return i$(e)?e:function(){return e}}(u),r){var s=u,c=lQ("sqrt")().domain(function(e,t){var n,r,a,i,o=0;if(e&&(n=e.length))if(null==t){for(r=e[o];o<n&&(null==r||r!==r);r=e[++o]);for(a=i=r;o<n;++o)null!=(r=e[o])&&(r<a&&(a=r),r>i&&(i=r))}else{for(r=t(e[o]);o<n&&(null==r||r!==r);r=t(e[++o]));for(a=i=r;o<n;++o)null!=(r=t(e[o]))&&(r<a&&(a=r),r>i&&(i=r))}return[a,i]}(a,s)).range(r);u=function(e){return c(s(e))}}a.forEach((function(e){e[o[0]]=NaN,e[o[1]]=NaN,e[o[3]]=0}));for(var l,f,d=i.words(a).text(e.text).size(e.size||[500,500]).padding(e.padding||1).spiral(e.spiral||"archimedean").rotate(e.rotate||0).font(e.font||"sans-serif").fontStyle(e.fontStyle||"normal").fontWeight(e.fontWeight||"normal").fontSize(u).random(gQ).layout(),h=i.size(),p=h[0]>>1,v=h[1]>>1,m=d.length,g=0;g<m;++g)(f=(l=d[g]).datum)[o[0]]=l.x+p,f[o[1]]=l.y+v,f[o[2]]=l.font,f[o[3]]=l.size,f[o[4]]=l.style,f[o[5]]=l.weight,f[o[6]]=l.rotate;return t.reflow(n).modifies(o)}}});var MQ=FQ(DQ),OQ=MQ.right,RQ=MQ.left;FQ((function(e){return null===e?NaN:+e})).center;var jQ=function(e){return new Uint8Array(e)},BQ=function(e){return new Uint16Array(e)},zQ=function(e){return new Uint32Array(e)};function ZQ(e,t,n){var r=(t<257?jQ:t<65537?BQ:zQ)(e);return n&&r.set(n),r}function LQ(e,t,n){var r=1<<t;return{one:r,zero:~r,range:n.slice(),bisect:e.bisect,index:e.index,size:e.size,onAdd:function(e,t){var n,a=this,i=a.bisect(a.range,e.value),o=e.index,u=i[0],s=i[1],c=o.length;for(n=0;n<u;++n)t[o[n]]|=r;for(n=s;n<c;++n)t[o[n]]|=r;return a}}}function PQ(){var e=zQ(0),t=[],n=0;return{insert:function(r,a,i){if(!a.length)return[];var o,u,s,c=n,l=a.length,f=zQ(l),d=Array(l);for(s=0;s<l;++s)d[s]=r(a[s]),f[s]=s;if(d=function(e,t){return e.sort.call(t,(function(t,n){var r=e[t],a=e[n];return r<a?-1:r>a?1:0})),function(e,t){return Array.from(t,(function(t){return e[t]}))}(e,t)}(d,f),c)o=t,u=e,t=Array(c+l),e=zQ(c+l),function(e,t,n,r,a,i,o,u,s){var c,l=0,f=0;for(c=0;l<r&&f<o;++c)t[l]<a[f]?(u[c]=t[l],s[c]=n[l++]):(u[c]=a[f],s[c]=i[f++]+e);for(;l<r;++l,++c)u[c]=t[l],s[c]=n[l];for(;f<o;++f,++c)u[c]=a[f],s[c]=i[f]+e}(i,o,u,c,d,f,l,t,e);else{if(i>0)for(s=0;s<l;++s)f[s]+=i;t=d,e=f}return n=c+l,{index:f,value:d}},remove:function(r,a){var i,o,u,s=n;for(o=0;!a[e[o]]&&o<s;++o);for(u=o;o<s;++o)a[i=e[o]]||(e[u]=i,t[u]=t[o],++u);n=s-r},bisect:function(e,r){var a;return r?a=r.length:(r=t,a=n),[RQ(r,e[0],0,a),OQ(r,e[1],0,a)]},reindex:function(t){for(var r=0,a=n;r<a;++r)e[r]=t[e[r]]},index:function(){return e},size:function(){return n}}}function UQ(e){wu.call(this,function(){var e=8,t=[],n=zQ(0),r=ZQ(0,e),a=ZQ(0,e);return{data:function(){return t},seen:function(){return n=function(e,t,n){return e.length>=t?e:((n=n||new e.constructor(t)).set(e),n)}(n,t.length)},add:function(e){for(var n,r=0,a=t.length,i=e.length;r<i;++r)(n=e[r])._index=a++,t.push(n)},remove:function(e,n){var i,o,u,s=t.length,c=Array(s-e),l=t;for(o=0;!n[o]&&o<s;++o)c[o]=t[o],l[o]=o;for(u=o;o<s;++o)i=t[o],n[o]?l[o]=-1:(l[o]=u,r[u]=r[o],a[u]=a[o],c[u]=i,i._index=u++),r[o]=0;return t=c,l},size:function(){return t.length},curr:function(){return r},prev:function(){return a},reset:function(e){return a[e]=r[e]},all:function(){return e<257?255:e<65537?65535:4294967295},set:function(e,t){r[e]|=t},clear:function(e,t){r[e]&=~t},resize:function(t,n){(t>r.length||n>e)&&(e=Math.max(n,e),r=ZQ(t,e,r),a=ZQ(t,e))}}}(),e),this._indices=null,this._dims=null}function WQ(e){wu.call(this,null,e)}UQ.Definition={type:"CrossFilter",metadata:{},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"query",type:"array",array:!0,required:!0,content:{type:"number",array:!0,length:2}}]},dt(UQ,wu,{transform:function(e,t){return this._dims?e.modified("fields")||e.fields.some((function(e){return t.modified(e.fields)}))?this.reinit(e,t):this.eval(e,t):this.init(e,t)},init:function(e,t){for(var n,r,a=e.fields,i=e.query,o=this._indices={},u=this._dims=[],s=i.length,c=0;c<s;++c)r=o[n=a[c].fname]||(o[n]=PQ()),u.push(LQ(r,c,i[c]));return this.eval(e,t)},reinit:function(e,t){var n,r,a,i,o,u,s,c,l,f=t.materialize().fork(),d=e.fields,h=e.query,p=this._indices,v=this._dims,m=this.value,g=m.curr(),y=m.prev(),b=m.all(),x=f.rem=f.add,w=f.mod,k=h.length,_={};if(y.set(g),t.rem.length&&(o=this.remove(e,t,f)),t.add.length&&m.add(t.add),t.mod.length)for(u={},s=0,c=(i=t.mod).length;s<c;++s)u[i[s]._index]=1;for(s=0;s<k;++s)l=d[s],(!v[s]||e.modified("fields",s)||t.modified(l.fields))&&((n=_[a=l.fname])||(p[a]=r=PQ(),_[a]=n=r.insert(l,t.source,0)),v[s]=LQ(r,s,h[s]).onAdd(n,g));for(s=0,c=m.data().length;s<c;++s)o[s]||(y[s]!==g[s]?x.push(s):u[s]&&g[s]!==b&&w.push(s));return m.mask=(1<<k)-1,f},eval:function(e,t){var n=t.materialize().fork(),r=this._dims.length,a=0;return t.rem.length&&(this.remove(e,t,n),a|=(1<<r)-1),e.modified("query")&&!e.modified("fields")&&(a|=this.update(e,t,n)),t.add.length&&(this.insert(e,t,n),a|=(1<<r)-1),t.mod.length&&(this.modify(t,n),a|=(1<<r)-1),this.value.mask=a,n},insert:function(e,t,n){var r,a,i,o=t.add,u=this.value,s=this._dims,c=this._indices,l=e.fields,f={},d=n.add,h=u.size()+o.length,p=s.length,v=u.size();u.resize(h,p),u.add(o);var m=u.curr(),g=u.prev(),y=u.all();for(r=0;r<p;++r)i=f[a=l[r].fname]||(f[a]=c[a].insert(l[r],o,v)),s[r].onAdd(i,m);for(;v<h;++v)g[v]=y,m[v]!==y&&d.push(v)},modify:function(e,t){var n,r,a,i=t.mod,o=this.value,u=o.curr(),s=o.all(),c=e.mod;for(n=0,r=c.length;n<r;++n)u[a=c[n]._index]!==s&&i.push(a)},remove:function(e,t,n){var r,a,i,o,u=this._indices,s=this.value,c=s.curr(),l=s.prev(),f=s.all(),d={},h=n.rem,p=t.rem;for(r=0,a=p.length;r<a;++r)d[i=p[r]._index]=1,l[i]=o=c[i],c[i]=f,o!==f&&h.push(i);for(i in u)u[i].remove(a,d);return this.reindex(t,a,d),d},reindex:function(e,t,n){var r=this._indices,a=this.value;e.runAfter((function(){var e=a.remove(t,n);for(var i in r)r[i].reindex(e)}))},update:function(e,t,n){var r,a,i=this._dims,o=e.query,u=t.stamp,s=i.length,c=0;for(n.filters=0,a=0;a<s;++a)e.modified("query",a)&&(r=a,++c);if(1===c)c=i[r].one,this.incrementOne(i[r],o[r],n.add,n.rem);else for(a=0,c=0;a<s;++a)e.modified("query",a)&&(c|=i[a].one,this.incrementAll(i[a],o[a],u,n.add),n.rem=n.add);return c},incrementAll:function(e,t,n,r){var a,i,o,u=this.value,s=u.seen(),c=u.curr(),l=u.prev(),f=e.index(),d=e.bisect(e.range),h=e.bisect(t),p=h[0],v=h[1],m=d[0],g=d[1],y=e.one;if(p<m)for(a=p,i=Math.min(m,v);a<i;++a)s[o=f[a]]!==n&&(l[o]=c[o],s[o]=n,r.push(o)),c[o]^=y;else if(p>m)for(a=m,i=Math.min(p,g);a<i;++a)s[o=f[a]]!==n&&(l[o]=c[o],s[o]=n,r.push(o)),c[o]^=y;if(v>g)for(a=Math.max(p,g),i=v;a<i;++a)s[o=f[a]]!==n&&(l[o]=c[o],s[o]=n,r.push(o)),c[o]^=y;else if(v<g)for(a=Math.max(m,v),i=g;a<i;++a)s[o=f[a]]!==n&&(l[o]=c[o],s[o]=n,r.push(o)),c[o]^=y;e.range=t.slice()},incrementOne:function(e,t,n,r){var a,i,o,u=this.value.curr(),s=e.index(),c=e.bisect(e.range),l=e.bisect(t),f=l[0],d=l[1],h=c[0],p=c[1],v=e.one;if(f<h)for(a=f,i=Math.min(h,d);a<i;++a)u[o=s[a]]^=v,n.push(o);else if(f>h)for(a=h,i=Math.min(f,p);a<i;++a)u[o=s[a]]^=v,r.push(o);if(d>p)for(a=Math.max(f,p),i=d;a<i;++a)u[o=s[a]]^=v,n.push(o);else if(d<p)for(a=Math.max(h,d),i=p;a<i;++a)u[o=s[a]]^=v,r.push(o);e.range=t.slice()}}),WQ.Definition={type:"ResolveFilter",metadata:{},params:[{name:"ignore",type:"number",required:!0,description:"A bit mask indicating which filters to ignore."},{name:"filter",type:"object",required:!0,description:"Per-tuple filter bitmaps from a CrossFilter transform."}]},dt(WQ,wu,{transform:function(e,t){var n=~(e.ignore||0),r=e.filter,a=r.mask;if(0===(a&n))return t.StopPropagation;var i=t.fork(t.ALL),o=r.data(),u=r.curr(),s=r.prev(),c=function(e){return u[e]&n?null:o[e]};return i.filter(i.MOD,c),a&a-1?(i.filter(i.ADD,(function(e){var t=u[e]&n;return!t&&t^s[e]&n?o[e]:null})),i.filter(i.REM,(function(e){var t=u[e]&n;return t&&!(t^t^s[e]&n)?o[e]:null}))):(i.filter(i.ADD,c),i.filter(i.REM,(function(e){return(u[e]&n)===a?o[e]:null}))),i.filter(i.SOURCE,(function(e){return c(e._index)}))}});var VQ=Math.sqrt(50),qQ=Math.sqrt(10),GQ=Math.sqrt(2);function HQ(e,t,n){return e.fields=t||[],e.fname=n,e}function XQ(e){return 1===e.length?KQ(e[0]):YQ(e)}var KQ=function(e){return function(t){return t[e]}},YQ=function(e){var t=e.length;return function(n){for(var r=0;r<t;++r)n=n[e[r]];return n}};function $Q(e){throw Error(e)}function QQ(e){var t,n,r,a=[],i=e.length,o=null,u=0,s="";function c(){a.push(s+e.substring(t,n)),s="",t=n+1}for(e+="",t=n=0;n<i;++n)if("\\"===(r=e[n]))s+=e.substring(t,n++),t=n;else if(r===o)c(),o=null,u=-1;else{if(o)continue;t===u&&'"'===r||t===u&&"'"===r?(t=n+1,o=r):"."!==r||u?"["===r?(n>t&&c(),u=t=n+1):"]"===r&&(u||$Q("Access path missing open bracket: "+e),u>0&&c(),u=0,t=n+1):n>t?c():t=n+1}return u&&$Q("Access path missing closing bracket: "+e),o&&$Q("Access path missing closing quote: "+e),n>t&&(n++,c()),a}function JQ(e,t,n){var r=QQ(e);return e=1===r.length?r[0]:e,HQ((n&&n.get||XQ)(r),[e],t||e)}JQ("id");var eJ=HQ((function(e){return e}),[],"identity"),tJ=(HQ((function(){return 0}),[],"zero"),HQ((function(){return 1}),[],"one"),HQ((function(){return!0}),[],"true"));HQ((function(){return!1}),[],"false");var nJ=Array.isArray;function rJ(e){return e===Object(e)}function aJ(e){return e[e.length-1]}function iJ(e){return null==e||""===e?null:+e}var oJ=function(e){return function(t){return e*Math.exp(t)}},uJ=function(e){return function(t){return Math.log(e*t)}},sJ=function(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}},cJ=function(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}},lJ=function(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}};function fJ(e,t,n,r){var a=n(e[0]),i=n(aJ(e)),o=(i-a)*t;return[r(a-o),r(i-o)]}function dJ(e,t,n,r,a){var i=r(e[0]),o=r(aJ(e)),u=null!=t?r(t):(i+o)/2;return[a(u+(i-u)*n),a(u+(o-u)*n)]}function hJ(e){return null!=e?nJ(e)?e:[e]:[]}function pJ(e){return"function"===typeof e}function vJ(e){for(var t,n,r=1,a=arguments.length;r<a;++r)for(n in t=arguments[r])e[n]=t[n];return e}var mJ=Object.prototype.hasOwnProperty;function gJ(e,t){return mJ.call(e,t)}function yJ(e){return"[object Date]"===Object.prototype.toString.call(e)}function bJ(e){return"number"===typeof e}function xJ(e){return"string"===typeof e}function wJ(e,t){for(var n="";--t>=0;)n+=e;return n}function kJ(e){return nJ(e)?"["+e.map(kJ)+"]":rJ(e)||xJ(e)?JSON.stringify(e).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):e}var _J=function(e){return bJ(e)||yJ(e)?e:Date.parse(e)};function SJ(e){for(var t={},n=e.length,r=0;r<n;++r)t[e[r]]=!0;return t}var CJ,AJ,EJ,NJ,TJ,IJ="Literal",DJ="Property",FJ="ArrayExpression",MJ="BinaryExpression",OJ="CallExpression",RJ="ConditionalExpression",jJ="LogicalExpression",BJ="MemberExpression",zJ="ObjectExpression",ZJ="UnaryExpression";function LJ(e){this.type=e}LJ.prototype.visit=function(e){var t,n,r;if(e(this))return 1;for(n=0,r=(t=function(e){switch(e.type){case FJ:return e.elements;case MJ:case jJ:return[e.left,e.right];case OJ:return[e.callee].concat(e.arguments);case RJ:return[e.test,e.consequent,e.alternate];case BJ:return[e.object,e.property];case zJ:return e.properties;case DJ:return[e.key,e.value];case ZJ:return[e.argument];default:return[]}}(this)).length;n<r;++n)if(t[n].visit(e))return 1};(CJ={})[1]="Boolean",CJ[2]="<end>",CJ[3]="Identifier",CJ[4]="Keyword",CJ[5]="Null",CJ[6]="Numeric",CJ[7]="Punctuator",CJ[8]="String",CJ[9]="RegularExpression";var PJ="Identifier",UJ="Unexpected token %0",WJ="Invalid regular expression",VJ="Invalid regular expression: missing /",qJ="Octal literals are not allowed in strict mode.",GJ="ILLEGAL",HJ="Disabled.",XJ=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0620-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u08A0-\\u08B2\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971-\\u0980\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D\\u0C58\\u0C59\\u0C60\\u0C61\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0CF1\\u0CF2\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D60\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EDC-\\u0EDF\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u1820-\\u1877\\u1880-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19C1-\\u19C7\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF\\u1BBA-\\u1BE5\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1CE9-\\u1CEC\\u1CEE-\\u1CF1\\u1CF5\\u1CF6\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005-\\u3007\\u3021-\\u3029\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B\\uA640-\\uA66E\\uA67F-\\uA69D\\uA6A0-\\uA6EF\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA8F2-\\uA8F7\\uA8FB\\uA90A-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF\\uA9E0-\\uA9E4\\uA9E6-\\uA9EF\\uA9FA-\\uA9FE\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA60-\\uAA76\\uAA7A\\uAA7E-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABE2\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]"),KJ=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0300-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u0483-\\u0487\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u0591-\\u05BD\\u05BF\\u05C1\\u05C2\\u05C4\\u05C5\\u05C7\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0610-\\u061A\\u0620-\\u0669\\u066E-\\u06D3\\u06D5-\\u06DC\\u06DF-\\u06E8\\u06EA-\\u06FC\\u06FF\\u0710-\\u074A\\u074D-\\u07B1\\u07C0-\\u07F5\\u07FA\\u0800-\\u082D\\u0840-\\u085B\\u08A0-\\u08B2\\u08E4-\\u0963\\u0966-\\u096F\\u0971-\\u0983\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BC-\\u09C4\\u09C7\\u09C8\\u09CB-\\u09CE\\u09D7\\u09DC\\u09DD\\u09DF-\\u09E3\\u09E6-\\u09F1\\u0A01-\\u0A03\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A3C\\u0A3E-\\u0A42\\u0A47\\u0A48\\u0A4B-\\u0A4D\\u0A51\\u0A59-\\u0A5C\\u0A5E\\u0A66-\\u0A75\\u0A81-\\u0A83\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABC-\\u0AC5\\u0AC7-\\u0AC9\\u0ACB-\\u0ACD\\u0AD0\\u0AE0-\\u0AE3\\u0AE6-\\u0AEF\\u0B01-\\u0B03\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3C-\\u0B44\\u0B47\\u0B48\\u0B4B-\\u0B4D\\u0B56\\u0B57\\u0B5C\\u0B5D\\u0B5F-\\u0B63\\u0B66-\\u0B6F\\u0B71\\u0B82\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BBE-\\u0BC2\\u0BC6-\\u0BC8\\u0BCA-\\u0BCD\\u0BD0\\u0BD7\\u0BE6-\\u0BEF\\u0C00-\\u0C03\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D-\\u0C44\\u0C46-\\u0C48\\u0C4A-\\u0C4D\\u0C55\\u0C56\\u0C58\\u0C59\\u0C60-\\u0C63\\u0C66-\\u0C6F\\u0C81-\\u0C83\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBC-\\u0CC4\\u0CC6-\\u0CC8\\u0CCA-\\u0CCD\\u0CD5\\u0CD6\\u0CDE\\u0CE0-\\u0CE3\\u0CE6-\\u0CEF\\u0CF1\\u0CF2\\u0D01-\\u0D03\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D-\\u0D44\\u0D46-\\u0D48\\u0D4A-\\u0D4E\\u0D57\\u0D60-\\u0D63\\u0D66-\\u0D6F\\u0D7A-\\u0D7F\\u0D82\\u0D83\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0DCA\\u0DCF-\\u0DD4\\u0DD6\\u0DD8-\\u0DDF\\u0DE6-\\u0DEF\\u0DF2\\u0DF3\\u0E01-\\u0E3A\\u0E40-\\u0E4E\\u0E50-\\u0E59\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB9\\u0EBB-\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EC8-\\u0ECD\\u0ED0-\\u0ED9\\u0EDC-\\u0EDF\\u0F00\\u0F18\\u0F19\\u0F20-\\u0F29\\u0F35\\u0F37\\u0F39\\u0F3E-\\u0F47\\u0F49-\\u0F6C\\u0F71-\\u0F84\\u0F86-\\u0F97\\u0F99-\\u0FBC\\u0FC6\\u1000-\\u1049\\u1050-\\u109D\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u135D-\\u135F\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1714\\u1720-\\u1734\\u1740-\\u1753\\u1760-\\u176C\\u176E-\\u1770\\u1772\\u1773\\u1780-\\u17D3\\u17D7\\u17DC\\u17DD\\u17E0-\\u17E9\\u180B-\\u180D\\u1810-\\u1819\\u1820-\\u1877\\u1880-\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1920-\\u192B\\u1930-\\u193B\\u1946-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19B0-\\u19C9\\u19D0-\\u19D9\\u1A00-\\u1A1B\\u1A20-\\u1A5E\\u1A60-\\u1A7C\\u1A7F-\\u1A89\\u1A90-\\u1A99\\u1AA7\\u1AB0-\\u1ABD\\u1B00-\\u1B4B\\u1B50-\\u1B59\\u1B6B-\\u1B73\\u1B80-\\u1BF3\\u1C00-\\u1C37\\u1C40-\\u1C49\\u1C4D-\\u1C7D\\u1CD0-\\u1CD2\\u1CD4-\\u1CF6\\u1CF8\\u1CF9\\u1D00-\\u1DF5\\u1DFC-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u200C\\u200D\\u203F\\u2040\\u2054\\u2071\\u207F\\u2090-\\u209C\\u20D0-\\u20DC\\u20E1\\u20E5-\\u20F0\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D7F-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2DE0-\\u2DFF\\u2E2F\\u3005-\\u3007\\u3021-\\u302F\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u3099\\u309A\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA62B\\uA640-\\uA66F\\uA674-\\uA67D\\uA67F-\\uA69D\\uA69F-\\uA6F1\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA827\\uA840-\\uA873\\uA880-\\uA8C4\\uA8D0-\\uA8D9\\uA8E0-\\uA8F7\\uA8FB\\uA900-\\uA92D\\uA930-\\uA953\\uA960-\\uA97C\\uA980-\\uA9C0\\uA9CF-\\uA9D9\\uA9E0-\\uA9FE\\uAA00-\\uAA36\\uAA40-\\uAA4D\\uAA50-\\uAA59\\uAA60-\\uAA76\\uAA7A-\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEF\\uAAF2-\\uAAF6\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABEA\\uABEC\\uABED\\uABF0-\\uABF9\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE00-\\uFE0F\\uFE20-\\uFE2D\\uFE33\\uFE34\\uFE4D-\\uFE4F\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF10-\\uFF19\\uFF21-\\uFF3A\\uFF3F\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]");function YJ(e,t){if(!e)throw new Error("ASSERT: "+t)}function $J(e){return e>=48&&e<=57}function QJ(e){return"0123456789abcdefABCDEF".indexOf(e)>=0}function JJ(e){return"01234567".indexOf(e)>=0}function e0(e){return 32===e||9===e||11===e||12===e||160===e||e>=5760&&[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].indexOf(e)>=0}function t0(e){return 10===e||13===e||8232===e||8233===e}function n0(e){return 36===e||95===e||e>=65&&e<=90||e>=97&&e<=122||92===e||e>=128&&XJ.test(String.fromCharCode(e))}function r0(e){return 36===e||95===e||e>=65&&e<=90||e>=97&&e<=122||e>=48&&e<=57||92===e||e>=128&&KJ.test(String.fromCharCode(e))}var a0={if:1,in:1,do:1,var:1,for:1,new:1,try:1,let:1,this:1,else:1,case:1,void:1,with:1,enum:1,while:1,break:1,catch:1,throw:1,const:1,yield:1,class:1,super:1,return:1,typeof:1,delete:1,switch:1,export:1,import:1,public:1,static:1,default:1,finally:1,extends:1,package:1,private:1,function:1,continue:1,debugger:1,interface:1,protected:1,instanceof:1,implements:1};function i0(){for(;EJ<NJ;){var e=AJ.charCodeAt(EJ);if(!e0(e)&&!t0(e))break;++EJ}}function o0(e){var t,n,r,a=0;for(n="u"===e?4:2,t=0;t<n;++t)EJ<NJ&&QJ(AJ[EJ])?(r=AJ[EJ++],a=16*a+"0123456789abcdef".indexOf(r.toLowerCase())):k0({},UJ,GJ);return String.fromCharCode(a)}function u0(){var e,t,n,r;for(t=0,"}"===(e=AJ[EJ])&&k0({},UJ,GJ);EJ<NJ&&QJ(e=AJ[EJ++]);)t=16*t+"0123456789abcdef".indexOf(e.toLowerCase());return(t>1114111||"}"!==e)&&k0({},UJ,GJ),t<=65535?String.fromCharCode(t):(n=55296+(t-65536>>10),r=56320+(t-65536&1023),String.fromCharCode(n,r))}function s0(){var e,t;for(e=AJ.charCodeAt(EJ++),t=String.fromCharCode(e),92===e&&(117!==AJ.charCodeAt(EJ)&&k0({},UJ,GJ),++EJ,(e=o0("u"))&&"\\"!==e&&n0(e.charCodeAt(0))||k0({},UJ,GJ),t=e);EJ<NJ&&r0(e=AJ.charCodeAt(EJ));)++EJ,t+=String.fromCharCode(e),92===e&&(t=t.substr(0,t.length-1),117!==AJ.charCodeAt(EJ)&&k0({},UJ,GJ),++EJ,(e=o0("u"))&&"\\"!==e&&r0(e.charCodeAt(0))||k0({},UJ,GJ),t+=e);return t}function c0(){var e,t;return e=EJ,t=92===AJ.charCodeAt(EJ)?s0():function(){var e,t;for(e=EJ++;EJ<NJ;){if(92===(t=AJ.charCodeAt(EJ)))return EJ=e,s0();if(!r0(t))break;++EJ}return AJ.slice(e,EJ)}(),{type:1===t.length?3:a0.hasOwnProperty(t)?4:"null"===t?5:"true"===t||"false"===t?1:3,value:t,start:e,end:EJ}}function l0(){var e,t,n,r,a=EJ,i=AJ.charCodeAt(EJ),o=AJ[EJ];switch(i){case 46:case 40:case 41:case 59:case 44:case 123:case 125:case 91:case 93:case 58:case 63:case 126:return++EJ,{type:7,value:String.fromCharCode(i),start:a,end:EJ};default:if(61===(e=AJ.charCodeAt(EJ+1)))switch(i){case 43:case 45:case 47:case 60:case 62:case 94:case 124:case 37:case 38:case 42:return EJ+=2,{type:7,value:String.fromCharCode(i)+String.fromCharCode(e),start:a,end:EJ};case 33:case 61:return EJ+=2,61===AJ.charCodeAt(EJ)&&++EJ,{type:7,value:AJ.slice(a,EJ),start:a,end:EJ}}}return">>>="===(r=AJ.substr(EJ,4))?{type:7,value:r,start:a,end:EJ+=4}:">>>"===(n=r.substr(0,3))||"<<="===n||">>="===n?{type:7,value:n,start:a,end:EJ+=3}:o===(t=n.substr(0,2))[1]&&"+-<>&|".indexOf(o)>=0||"=>"===t?{type:7,value:t,start:a,end:EJ+=2}:("//"===t&&k0({},UJ,GJ),"<>=!+-*%&|^/".indexOf(o)>=0?{type:7,value:o,start:a,end:++EJ}:void k0({},UJ,GJ))}function f0(){var e,t,n;if(YJ($J((n=AJ[EJ]).charCodeAt(0))||"."===n,"Numeric literal must start with a decimal digit or a decimal point"),t=EJ,e="","."!==n){if(e=AJ[EJ++],n=AJ[EJ],"0"===e){if("x"===n||"X"===n)return++EJ,function(e){for(var t="";EJ<NJ&&QJ(AJ[EJ]);)t+=AJ[EJ++];return 0===t.length&&k0({},UJ,GJ),n0(AJ.charCodeAt(EJ))&&k0({},UJ,GJ),{type:6,value:parseInt("0x"+t,16),start:e,end:EJ}}(t);if(JJ(n))return function(e){for(var t="0"+AJ[EJ++];EJ<NJ&&JJ(AJ[EJ]);)t+=AJ[EJ++];return(n0(AJ.charCodeAt(EJ))||$J(AJ.charCodeAt(EJ)))&&k0({},UJ,GJ),{type:6,value:parseInt(t,8),octal:!0,start:e,end:EJ}}(t);n&&$J(n.charCodeAt(0))&&k0({},UJ,GJ)}for(;$J(AJ.charCodeAt(EJ));)e+=AJ[EJ++];n=AJ[EJ]}if("."===n){for(e+=AJ[EJ++];$J(AJ.charCodeAt(EJ));)e+=AJ[EJ++];n=AJ[EJ]}if("e"===n||"E"===n)if(e+=AJ[EJ++],"+"!==(n=AJ[EJ])&&"-"!==n||(e+=AJ[EJ++]),$J(AJ.charCodeAt(EJ)))for(;$J(AJ.charCodeAt(EJ));)e+=AJ[EJ++];else k0({},UJ,GJ);return n0(AJ.charCodeAt(EJ))&&k0({},UJ,GJ),{type:6,value:parseFloat(e),start:t,end:EJ}}function d0(){var e,t,n,r;return TJ=null,i0(),e=EJ,t=function(){var e,t,n,r;for(YJ("/"===(e=AJ[EJ]),"Regular expression literal must start with a slash"),t=AJ[EJ++],n=!1,r=!1;EJ<NJ;)if(t+=e=AJ[EJ++],"\\"===e)t0((e=AJ[EJ++]).charCodeAt(0))&&k0({},VJ),t+=e;else if(t0(e.charCodeAt(0)))k0({},VJ);else if(n)"]"===e&&(n=!1);else{if("/"===e){r=!0;break}"["===e&&(n=!0)}return r||k0({},VJ),{value:t.substr(1,t.length-2),literal:t}}(),n=function(){var e,t,n;for(t="",n="";EJ<NJ&&r0((e=AJ[EJ]).charCodeAt(0));)++EJ,"\\"===e&&EJ<NJ?k0({},UJ,GJ):(n+=e,t+=e);return n.search(/[^gimuy]/g)>=0&&k0({},WJ,n),{value:n,literal:t}}(),r=function(e,t){var n=e;t.indexOf("u")>=0&&(n=n.replace(/\\u\{([0-9a-fA-F]+)\}/g,(function(e,t){if(parseInt(t,16)<=1114111)return"x";k0({},WJ)})).replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"x"));try{new RegExp(n)}catch(r){k0({},WJ)}try{return new RegExp(e,t)}catch(a){return null}}(t.value,n.value),{literal:t.literal+n.literal,value:r,regex:{pattern:t.value,flags:n.value},start:e,end:EJ}}function h0(){if(i0(),EJ>=NJ)return{type:2,start:EJ,end:EJ};var e=AJ.charCodeAt(EJ);return n0(e)?c0():40===e||41===e||59===e?l0():39===e||34===e?function(){var e,t,n,r,a="",i=!1;for(YJ("'"===(e=AJ[EJ])||'"'===e,"String literal must starts with a quote"),t=EJ,++EJ;EJ<NJ;){if((n=AJ[EJ++])===e){e="";break}if("\\"===n)if((n=AJ[EJ++])&&t0(n.charCodeAt(0)))"\r"===n&&"\n"===AJ[EJ]&&++EJ;else switch(n){case"u":case"x":"{"===AJ[EJ]?(++EJ,a+=u0()):a+=o0(n);break;case"n":a+="\n";break;case"r":a+="\r";break;case"t":a+="\t";break;case"b":a+="\b";break;case"f":a+="\f";break;case"v":a+="\v";break;default:JJ(n)?(0!==(r="01234567".indexOf(n))&&(i=!0),EJ<NJ&&JJ(AJ[EJ])&&(i=!0,r=8*r+"01234567".indexOf(AJ[EJ++]),"0123".indexOf(n)>=0&&EJ<NJ&&JJ(AJ[EJ])&&(r=8*r+"01234567".indexOf(AJ[EJ++]))),a+=String.fromCharCode(r)):a+=n}else{if(t0(n.charCodeAt(0)))break;a+=n}}return""!==e&&k0({},UJ,GJ),{type:8,value:a,octal:i,start:t,end:EJ}}():46===e?$J(AJ.charCodeAt(EJ+1))?f0():l0():$J(e)?f0():l0()}function p0(){var e=TJ;return EJ=e.end,TJ=h0(),EJ=e.end,e}function v0(){var e=EJ;TJ=h0(),EJ=e}function m0(e,t,n){var r=new LJ("||"===e||"&&"===e?"LogicalExpression":"BinaryExpression");return r.operator=e,r.left=t,r.right=n,r}function g0(e,t){var n=new LJ("CallExpression");return n.callee=e,n.arguments=t,n}function y0(e){var t=new LJ(PJ);return t.name=e,t}function b0(e){var t=new LJ("Literal");return t.value=e.value,t.raw=AJ.slice(e.start,e.end),e.regex&&("//"===t.raw&&(t.raw="/(?:)/"),t.regex=e.regex),t}function x0(e,t,n){var r=new LJ("MemberExpression");return r.computed="["===e,r.object=t,r.property=n,r.computed||(n.member=!0),r}function w0(e,t,n){var r=new LJ("Property");return r.key=t,r.value=n,r.kind=e,r}function k0(e,t){var n,r=Array.prototype.slice.call(arguments,2),a=t.replace(/%(\d)/g,(function(e,t){return YJ(t<r.length,"Message reference must be in range"),r[t]}));throw(n=new Error(a)).index=EJ,n.description=a,n}function _0(e){2===e.type&&k0(e,"Unexpected end of input"),6===e.type&&k0(e,"Unexpected number"),8===e.type&&k0(e,"Unexpected string"),3===e.type&&k0(e,"Unexpected identifier"),4===e.type&&k0(e,"Unexpected reserved word"),k0(e,UJ,e.value)}function S0(e){var t=p0();7===t.type&&t.value===e||_0(t)}function C0(e){return 7===TJ.type&&TJ.value===e}function A0(e){return 4===TJ.type&&TJ.value===e}function E0(){var e=[];for(EJ=TJ.start,S0("[");!C0("]");)C0(",")?(p0(),e.push(null)):(e.push(Z0()),C0("]")||S0(","));return p0(),function(e){var t=new LJ("ArrayExpression");return t.elements=e,t}(e)}function N0(){EJ=TJ.start;var e=p0();return 8===e.type||6===e.type?(e.octal&&k0(e,qJ),b0(e)):y0(e.value)}function T0(){var e,t,n;return EJ=TJ.start,3===(e=TJ).type?(n=N0(),S0(":"),w0("init",n,Z0())):2!==e.type&&7!==e.type?(t=N0(),S0(":"),w0("init",t,Z0())):void _0(e)}function I0(){var e,t,n=[],r={},a=String;for(EJ=TJ.start,S0("{");!C0("}");)t="$"+((e=T0()).key.type===PJ?e.key.name:a(e.key.value)),Object.prototype.hasOwnProperty.call(r,t)?k0({},"Duplicate data property in object literal not allowed in strict mode"):r[t]=!0,n.push(e),C0("}")||S0(",");return S0("}"),function(e){var t=new LJ("ObjectExpression");return t.properties=e,t}(n)}var D0={if:1};function F0(){var e,t,n;if(C0("("))return function(){S0("(");var e=L0();return S0(")"),e}();if(C0("["))return E0();if(C0("{"))return I0();if(e=TJ.type,EJ=TJ.start,3===e||D0[TJ.value])n=y0(p0().value);else if(8===e||6===e)TJ.octal&&k0(TJ,qJ),n=b0(p0());else{if(4===e)throw new Error(HJ);1===e?((t=p0()).value="true"===t.value,n=b0(t)):5===e?((t=p0()).value=null,n=b0(t)):C0("/")||C0("/=")?(n=b0(d0()),v0()):_0(p0())}return n}function M0(){var e=[];if(S0("("),!C0(")"))for(;EJ<NJ&&(e.push(Z0()),!C0(")"));)S0(",");return S0(")"),e}function O0(){return S0("."),function(){EJ=TJ.start;var e=p0();return function(e){return 3===e.type||4===e.type||1===e.type||5===e.type}(e)||_0(e),y0(e.value)}()}function R0(){S0("[");var e=L0();return S0("]"),e}function j0(){var e=function(){var e;for(e=F0();;)if(C0("."))e=x0(".",e,O0());else if(C0("("))e=g0(e,M0());else{if(!C0("["))break;e=x0("[",e,R0())}return e}();if(7===TJ.type&&(C0("++")||C0("--")))throw new Error(HJ);return e}function B0(){var e,t;if(7!==TJ.type&&4!==TJ.type)t=j0();else{if(C0("++")||C0("--"))throw new Error(HJ);if(C0("+")||C0("-")||C0("~")||C0("!"))e=p0(),t=B0(),t=function(e,t){var n=new LJ("UnaryExpression");return n.operator=e,n.argument=t,n.prefix=!0,n}(e.value,t);else{if(A0("delete")||A0("void")||A0("typeof"))throw new Error(HJ);t=j0()}}return t}function z0(e){var t=0;if(7!==e.type&&4!==e.type)return 0;switch(e.value){case"||":t=1;break;case"&&":t=2;break;case"|":t=3;break;case"^":t=4;break;case"&":t=5;break;case"==":case"!=":case"===":case"!==":t=6;break;case"<":case">":case"<=":case">=":case"instanceof":case"in":t=7;break;case"<<":case">>":case">>>":t=8;break;case"+":case"-":t=9;break;case"*":case"/":case"%":t=11}return t}function Z0(){var e,t;return e=function(){var e,t,n,r,a,i,o,u,s,c;if(e=TJ,s=B0(),0===(a=z0(r=TJ)))return s;for(r.prec=a,p0(),t=[e,TJ],i=[s,r,o=B0()];(a=z0(TJ))>0;){for(;i.length>2&&a<=i[i.length-2].prec;)o=i.pop(),u=i.pop().value,s=i.pop(),t.pop(),n=m0(u,s,o),i.push(n);(r=p0()).prec=a,i.push(r),t.push(TJ),n=B0(),i.push(n)}for(n=i[c=i.length-1],t.pop();c>1;)t.pop(),n=m0(i[c-1].value,i[c-2],n),c-=2;return n}(),C0("?")&&(p0(),t=Z0(),S0(":"),e=function(e,t,n){var r=new LJ("ConditionalExpression");return r.test=e,r.consequent=t,r.alternate=n,r}(e,t,Z0())),e}function L0(){var e=Z0();if(C0(","))throw new Error(HJ);return e}var P0={NaN:"NaN",E:"Math.E",LN2:"Math.LN2",LN10:"Math.LN10",LOG2E:"Math.LOG2E",LOG10E:"Math.LOG10E",PI:"Math.PI",SQRT1_2:"Math.SQRT1_2",SQRT2:"Math.SQRT2",MIN_VALUE:"Number.MIN_VALUE",MAX_VALUE:"Number.MAX_VALUE"};function U0(e){function t(t,n,r){return function(a){return function(t,n,r,a){var i=e(n[0]);return r&&(i=r+"("+i+")",0===r.lastIndexOf("new ",0)&&(i="("+i+")")),i+"."+t+(a<0?"":0===a?"()":"("+n.slice(1).map(e).join(",")+")")}(t,a,n,r)}}var n="new Date",r="String",a="RegExp";return{isNaN:"Number.isNaN",isFinite:"Number.isFinite",abs:"Math.abs",acos:"Math.acos",asin:"Math.asin",atan:"Math.atan",atan2:"Math.atan2",ceil:"Math.ceil",cos:"Math.cos",exp:"Math.exp",floor:"Math.floor",hypot:"Math.hypot",log:"Math.log",max:"Math.max",min:"Math.min",pow:"Math.pow",random:"Math.random",round:"Math.round",sin:"Math.sin",sqrt:"Math.sqrt",tan:"Math.tan",clamp:function(t){t.length<3&&$Q("Missing arguments to clamp function."),t.length>3&&$Q("Too many arguments to clamp function.");var n=t.map(e);return"Math.max("+n[1]+", Math.min("+n[2]+","+n[0]+"))"},now:"Date.now",utc:"Date.UTC",datetime:n,date:t("getDate",n,0),day:t("getDay",n,0),year:t("getFullYear",n,0),month:t("getMonth",n,0),hours:t("getHours",n,0),minutes:t("getMinutes",n,0),seconds:t("getSeconds",n,0),milliseconds:t("getMilliseconds",n,0),time:t("getTime",n,0),timezoneoffset:t("getTimezoneOffset",n,0),utcdate:t("getUTCDate",n,0),utcday:t("getUTCDay",n,0),utcyear:t("getUTCFullYear",n,0),utcmonth:t("getUTCMonth",n,0),utchours:t("getUTCHours",n,0),utcminutes:t("getUTCMinutes",n,0),utcseconds:t("getUTCSeconds",n,0),utcmilliseconds:t("getUTCMilliseconds",n,0),length:t("length",null,-1),parseFloat:"parseFloat",parseInt:"parseInt",upper:t("toUpperCase",r,0),lower:t("toLowerCase",r,0),substring:t("substring",r),split:t("split",r),trim:t("trim",r,0),regexp:a,test:t("test",a),if:function(t){t.length<3&&$Q("Missing arguments to if function."),t.length>3&&$Q("Too many arguments to if function.");var n=t.map(e);return"("+n[0]+"?"+n[1]+":"+n[2]+")"}}}var W0=function(){function e(){(0,op.Z)(this,e),this._partials=new Float64Array(32),this._n=0}return(0,up.Z)(e,[{key:"add",value:function(e){for(var t=this._partials,n=0,r=0;r<this._n&&r<32;r++){var a=t[r],i=e+a,o=Math.abs(e)<Math.abs(a)?e-(i-a):a-(i-e);o&&(t[n++]=o),e=i}return t[n]=e,this._n=n+1,this}},{key:"valueOf",value:function(){var e,t,n,r=this._partials,a=this._n,i=0;if(a>0){for(i=r[--a];a>0&&(e=i,!(n=(t=r[--a])-((i=e+t)-e))););a>0&&(n<0&&r[a-1]<0||n>0&&r[a-1]>0)&&(t=2*n)==(e=i+t)-i&&(i=e)}return i}}]),e}();var V0=1e-6,q0=Math.PI,G0=q0/2,H0=q0/4,X0=2*q0,K0=180/q0,Y0=q0/180,$0=Math.abs,Q0=(Math.atan,Math.atan2),J0=Math.cos,e1=(Math.ceil,Math.exp,Math.floor,Math.hypot),t1=(Math.log,Math.pow,Math.sin),n1=(Math.sign,Math.sqrt);Math.tan;function r1(e){return e>1?G0:e<-1?-G0:Math.asin(e)}function a1(){}function i1(e,t){e&&u1.hasOwnProperty(e.type)&&u1[e.type](e,t)}var o1={Feature:function(e,t){i1(e.geometry,t)},FeatureCollection:function(e,t){for(var n=e.features,r=-1,a=n.length;++r<a;)i1(n[r].geometry,t)}},u1={Sphere:function(e,t){t.sphere()},Point:function(e,t){e=e.coordinates,t.point(e[0],e[1],e[2])},MultiPoint:function(e,t){for(var n=e.coordinates,r=-1,a=n.length;++r<a;)e=n[r],t.point(e[0],e[1],e[2])},LineString:function(e,t){s1(e.coordinates,t,0)},MultiLineString:function(e,t){for(var n=e.coordinates,r=-1,a=n.length;++r<a;)s1(n[r],t,0)},Polygon:function(e,t){c1(e.coordinates,t)},MultiPolygon:function(e,t){for(var n=e.coordinates,r=-1,a=n.length;++r<a;)c1(n[r],t)},GeometryCollection:function(e,t){for(var n=e.geometries,r=-1,a=n.length;++r<a;)i1(n[r],t)}};function s1(e,t,n){var r,a=-1,i=e.length-n;for(t.lineStart();++a<i;)r=e[a],t.point(r[0],r[1],r[2]);t.lineEnd()}function c1(e,t){var n=-1,r=e.length;for(t.polygonStart();++n<r;)s1(e[n],t,1);t.polygonEnd()}function l1(e,t){e&&o1.hasOwnProperty(e.type)?o1[e.type](e,t):i1(e,t)}var f1,d1,h1,p1,v1,m1,g1,y1,b1,x1,w1,k1,_1,S1,C1,A1,E1=new W0,N1=new W0,T1={point:a1,lineStart:a1,lineEnd:a1,polygonStart:function(){E1=new W0,T1.lineStart=I1,T1.lineEnd=D1},polygonEnd:function(){var e=+E1;N1.add(e<0?X0+e:e),this.lineStart=this.lineEnd=this.point=a1},sphere:function(){N1.add(X0)}};function I1(){T1.point=F1}function D1(){M1(f1,d1)}function F1(e,t){T1.point=M1,f1=e,d1=t,h1=e*=Y0,p1=J0(t=(t*=Y0)/2+H0),v1=t1(t)}function M1(e,t){var n=(e*=Y0)-h1,r=n>=0?1:-1,a=r*n,i=J0(t=(t*=Y0)/2+H0),o=t1(t),u=v1*o,s=p1*i+u*J0(a),c=u*r*t1(a);E1.add(Q0(c,s)),h1=e,p1=i,v1=o}function O1(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}var R1,j1,B1,z1,Z1,L1,P1,U1,W1,V1,q1,G1,H1,X1,K1,Y1,$1={point:Q1,lineStart:e2,lineEnd:t2,polygonStart:function(){$1.point=n2,$1.lineStart=r2,$1.lineEnd=a2,S1=new W0,T1.polygonStart()},polygonEnd:function(){T1.polygonEnd(),$1.point=Q1,$1.lineStart=e2,$1.lineEnd=t2,E1<0?(m1=-(y1=180),g1=-(b1=90)):S1>V0?b1=90:S1<-1e-6&&(g1=-90),A1[0]=m1,A1[1]=y1},sphere:function(){m1=-(y1=180),g1=-(b1=90)}};function Q1(e,t){C1.push(A1=[m1=e,y1=e]),t<g1&&(g1=t),t>b1&&(b1=t)}function J1(e,t){var n=function(e){var t=e[0],n=e[1],r=J0(n);return[r*J0(t),r*t1(t),t1(n)]}([e*Y0,t*Y0]);if(_1){var r=O1(_1,n),a=O1([r[1],-r[0],0],r);!function(e){var t=n1(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]/=t,e[1]/=t,e[2]/=t}(a),a=function(e){return[Q0(e[1],e[0]),r1(e[2])]}(a);var i,o=e-x1,u=o>0?1:-1,s=a[0]*K0*u,c=$0(o)>180;c^(u*x1<s&&s<u*e)?(i=a[1]*K0)>b1&&(b1=i):c^(u*x1<(s=(s+360)%360-180)&&s<u*e)?(i=-a[1]*K0)<g1&&(g1=i):(t<g1&&(g1=t),t>b1&&(b1=t)),c?e<x1?i2(m1,e)>i2(m1,y1)&&(y1=e):i2(e,y1)>i2(m1,y1)&&(m1=e):y1>=m1?(e<m1&&(m1=e),e>y1&&(y1=e)):e>x1?i2(m1,e)>i2(m1,y1)&&(y1=e):i2(e,y1)>i2(m1,y1)&&(m1=e)}else C1.push(A1=[m1=e,y1=e]);t<g1&&(g1=t),t>b1&&(b1=t),_1=n,x1=e}function e2(){$1.point=J1}function t2(){A1[0]=m1,A1[1]=y1,$1.point=Q1,_1=null}function n2(e,t){if(_1){var n=e-x1;S1.add($0(n)>180?n+(n>0?360:-360):n)}else w1=e,k1=t;T1.point(e,t),J1(e,t)}function r2(){T1.lineStart()}function a2(){n2(w1,k1),T1.lineEnd(),$0(S1)>V0&&(m1=-(y1=180)),A1[0]=m1,A1[1]=y1,_1=null}function i2(e,t){return(t-=e)<0?t+360:t}function o2(e,t){return e[0]-t[0]}function u2(e,t){return e[0]<=e[1]?e[0]<=t&&t<=e[1]:t<e[0]||e[1]<t}var s2={sphere:a1,point:c2,lineStart:f2,lineEnd:p2,polygonStart:function(){s2.lineStart=v2,s2.lineEnd=m2},polygonEnd:function(){s2.lineStart=f2,s2.lineEnd=p2}};function c2(e,t){e*=Y0;var n=J0(t*=Y0);l2(n*J0(e),n*t1(e),t1(t))}function l2(e,t,n){++R1,B1+=(e-B1)/R1,z1+=(t-z1)/R1,Z1+=(n-Z1)/R1}function f2(){s2.point=d2}function d2(e,t){e*=Y0;var n=J0(t*=Y0);X1=n*J0(e),K1=n*t1(e),Y1=t1(t),s2.point=h2,l2(X1,K1,Y1)}function h2(e,t){e*=Y0;var n=J0(t*=Y0),r=n*J0(e),a=n*t1(e),i=t1(t),o=Q0(n1((o=K1*i-Y1*a)*o+(o=Y1*r-X1*i)*o+(o=X1*a-K1*r)*o),X1*r+K1*a+Y1*i);j1+=o,L1+=o*(X1+(X1=r)),P1+=o*(K1+(K1=a)),U1+=o*(Y1+(Y1=i)),l2(X1,K1,Y1)}function p2(){s2.point=c2}function v2(){s2.point=g2}function m2(){y2(G1,H1),s2.point=c2}function g2(e,t){G1=e,H1=t,e*=Y0,t*=Y0,s2.point=y2;var n=J0(t);X1=n*J0(e),K1=n*t1(e),Y1=t1(t),l2(X1,K1,Y1)}function y2(e,t){e*=Y0;var n=J0(t*=Y0),r=n*J0(e),a=n*t1(e),i=t1(t),o=K1*i-Y1*a,u=Y1*r-X1*i,s=X1*a-K1*r,c=e1(o,u,s),l=r1(c),f=c&&-l/c;W1.add(f*o),V1.add(f*u),q1.add(f*s),j1+=l,L1+=l*(X1+(X1=r)),P1+=l*(K1+(K1=a)),U1+=l*(Y1+(Y1=i)),l2(X1,K1,Y1)}function b2(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function x2(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function w2(){}var k2=.7,_2=1.4285714285714286,S2="\\s*([+-]?\\d+)\\s*",C2="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",A2="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",E2=/^#([0-9a-f]{3,8})$/,N2=new RegExp("^rgb\\("+[S2,S2,S2]+"\\)$"),T2=new RegExp("^rgb\\("+[A2,A2,A2]+"\\)$"),I2=new RegExp("^rgba\\("+[S2,S2,S2,C2]+"\\)$"),D2=new RegExp("^rgba\\("+[A2,A2,A2,C2]+"\\)$"),F2=new RegExp("^hsl\\("+[C2,A2,A2]+"\\)$"),M2=new RegExp("^hsla\\("+[C2,A2,A2,C2]+"\\)$"),O2={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function R2(){return this.rgb().formatHex()}function j2(){return this.rgb().formatRgb()}function B2(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=E2.exec(e))?(n=t[1].length,t=parseInt(t[1],16),6===n?z2(t):3===n?new U2(t>>8&15|t>>4&240,t>>4&15|240&t,(15&t)<<4|15&t,1):8===n?Z2(t>>24&255,t>>16&255,t>>8&255,(255&t)/255):4===n?Z2(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|240&t,((15&t)<<4|15&t)/255):null):(t=N2.exec(e))?new U2(t[1],t[2],t[3],1):(t=T2.exec(e))?new U2(255*t[1]/100,255*t[2]/100,255*t[3]/100,1):(t=I2.exec(e))?Z2(t[1],t[2],t[3],t[4]):(t=D2.exec(e))?Z2(255*t[1]/100,255*t[2]/100,255*t[3]/100,t[4]):(t=F2.exec(e))?G2(t[1],t[2]/100,t[3]/100,1):(t=M2.exec(e))?G2(t[1],t[2]/100,t[3]/100,t[4]):O2.hasOwnProperty(e)?z2(O2[e]):"transparent"===e?new U2(NaN,NaN,NaN,0):null}function z2(e){return new U2(e>>16&255,e>>8&255,255&e,1)}function Z2(e,t,n,r){return r<=0&&(e=t=n=NaN),new U2(e,t,n,r)}function L2(e){return e instanceof w2||(e=B2(e)),e?new U2((e=e.rgb()).r,e.g,e.b,e.opacity):new U2}function P2(e,t,n,r){return 1===arguments.length?L2(e):new U2(e,t,n,null==r?1:r)}function U2(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}function W2(){return"#"+q2(this.r)+q2(this.g)+q2(this.b)}function V2(){var e=this.opacity;return(1===(e=isNaN(e)?1:Math.max(0,Math.min(1,e)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===e?")":", "+e+")")}function q2(e){return((e=Math.max(0,Math.min(255,Math.round(e)||0)))<16?"0":"")+e.toString(16)}function G2(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new K2(e,t,n,r)}function H2(e){if(e instanceof K2)return new K2(e.h,e.s,e.l,e.opacity);if(e instanceof w2||(e=B2(e)),!e)return new K2;if(e instanceof K2)return e;var t=(e=e.rgb()).r/255,n=e.g/255,r=e.b/255,a=Math.min(t,n,r),i=Math.max(t,n,r),o=NaN,u=i-a,s=(i+a)/2;return u?(o=t===i?(n-r)/u+6*(n<r):n===i?(r-t)/u+2:(t-n)/u+4,u/=s<.5?i+a:2-i-a,o*=60):u=s>0&&s<1?0:o,new K2(o,u,s,e.opacity)}function X2(e,t,n,r){return 1===arguments.length?H2(e):new K2(e,t,n,null==r?1:r)}function K2(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}function Y2(e,t,n){return 255*(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)}b2(w2,B2,{copy:function(e){return Object.assign(new this.constructor,this,e)},displayable:function(){return this.rgb().displayable()},hex:R2,formatHex:R2,formatHsl:function(){return H2(this).formatHsl()},formatRgb:j2,toString:j2}),b2(U2,P2,x2(w2,{brighter:function(e){return e=null==e?_2:Math.pow(_2,e),new U2(this.r*e,this.g*e,this.b*e,this.opacity)},darker:function(e){return e=null==e?k2:Math.pow(k2,e),new U2(this.r*e,this.g*e,this.b*e,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:W2,formatHex:W2,formatRgb:V2,toString:V2})),b2(K2,X2,x2(w2,{brighter:function(e){return e=null==e?_2:Math.pow(_2,e),new K2(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=null==e?k2:Math.pow(k2,e),new K2(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=this.h%360+360*(this.h<0),t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,a=2*n-r;return new U2(Y2(e>=240?e-240:e+120,a,r),Y2(e,a,r),Y2(e<120?e+240:e-120,a,r),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var e=this.opacity;return(1===(e=isNaN(e)?1:Math.max(0,Math.min(1,e)))?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(1===e?")":", "+e+")")}}));var $2=Math.PI/180,Q2=180/Math.PI,J2=.96422,e3=.82521,t3=4/29,n3=6/29,r3=.12841854934601665;function a3(e){if(e instanceof o3)return new o3(e.l,e.a,e.b,e.opacity);if(e instanceof h3)return p3(e);e instanceof U2||(e=L2(e));var t,n,r=l3(e.r),a=l3(e.g),i=l3(e.b),o=u3((.2225045*r+.7168786*a+.0606169*i)/1);return r===a&&a===i?t=n=o:(t=u3((.4360747*r+.3850649*a+.1430804*i)/J2),n=u3((.0139322*r+.0971045*a+.7141733*i)/e3)),new o3(116*o-16,500*(t-o),200*(o-n),e.opacity)}function i3(e,t,n,r){return 1===arguments.length?a3(e):new o3(e,t,n,null==r?1:r)}function o3(e,t,n,r){this.l=+e,this.a=+t,this.b=+n,this.opacity=+r}function u3(e){return e>.008856451679035631?Math.pow(e,1/3):e/r3+t3}function s3(e){return e>n3?e*e*e:r3*(e-t3)}function c3(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function l3(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function f3(e){if(e instanceof h3)return new h3(e.h,e.c,e.l,e.opacity);if(e instanceof o3||(e=a3(e)),0===e.a&&0===e.b)return new h3(NaN,0<e.l&&e.l<100?0:NaN,e.l,e.opacity);var t=Math.atan2(e.b,e.a)*Q2;return new h3(t<0?t+360:t,Math.sqrt(e.a*e.a+e.b*e.b),e.l,e.opacity)}function d3(e,t,n,r){return 1===arguments.length?f3(e):new h3(e,t,n,null==r?1:r)}function h3(e,t,n,r){this.h=+e,this.c=+t,this.l=+n,this.opacity=+r}function p3(e){if(isNaN(e.h))return new o3(e.l,0,0,e.opacity);var t=e.h*$2;return new o3(e.l,Math.cos(t)*e.c,Math.sin(t)*e.c,e.opacity)}function v3(e){return e instanceof Fg?e:new Fg(e)}function m3(e,t,n){return e.fields=t||[],e.fname=n,e}function g3(e){return 1===e.length?y3(e[0]):b3(e)}b2(o3,i3,x2(w2,{brighter:function(e){return new o3(this.l+18*(null==e?1:e),this.a,this.b,this.opacity)},darker:function(e){return new o3(this.l-18*(null==e?1:e),this.a,this.b,this.opacity)},rgb:function(){var e=(this.l+16)/116,t=isNaN(this.a)?e:e+this.a/500,n=isNaN(this.b)?e:e-this.b/200;return new U2(c3(3.1338561*(t=J2*s3(t))-1.6168667*(e=1*s3(e))-.4906146*(n=e3*s3(n))),c3(-.9787684*t+1.9161415*e+.033454*n),c3(.0719453*t-.2289914*e+1.4052427*n),this.opacity)}})),b2(h3,d3,x2(w2,{brighter:function(e){return new h3(this.h,this.c,this.l+18*(null==e?1:e),this.opacity)},darker:function(e){return new h3(this.h,this.c,this.l-18*(null==e?1:e),this.opacity)},rgb:function(){return p3(this).rgb()}}));var y3=function(e){return function(t){return t[e]}},b3=function(e){var t=e.length;return function(n){for(var r=0;r<t;++r)n=n[e[r]];return n}};function x3(e){throw Error(e)}function w3(e){var t,n,r,a=[],i=e.length,o=null,u=0,s="";function c(){a.push(s+e.substring(t,n)),s="",t=n+1}for(e+="",t=n=0;n<i;++n)if("\\"===(r=e[n]))s+=e.substring(t,n++),t=n;else if(r===o)c(),o=null,u=-1;else{if(o)continue;t===u&&'"'===r||t===u&&"'"===r?(t=n+1,o=r):"."!==r||u?"["===r?(n>t&&c(),u=t=n+1):"]"===r&&(u||x3("Access path missing open bracket: "+e),u>0&&c(),u=0,t=n+1):n>t?c():t=n+1}return u&&x3("Access path missing closing bracket: "+e),o&&x3("Access path missing closing quote: "+e),n>t&&(n++,c()),a}function k3(e,t,n){var r=w3(e);return e=1===r.length?r[0]:e,m3((n&&n.get||g3)(r),[e],t||e)}k3("id"),m3((function(e){return e}),[],"identity"),m3((function(){return 0}),[],"zero"),m3((function(){return 1}),[],"one"),m3((function(){return!0}),[],"true"),m3((function(){return!1}),[],"false");var _3=Array.isArray;function S3(e){return e[e.length-1]}function C3(e){return null==e||""===e?null:+e}function A3(e){return null!=e?_3(e)?e:[e]:[]}function E3(e){for(var t,n,r=1,a=arguments.length;r<a;++r)for(n in t=arguments[r])e[n]=t[n];return e}var N3=Object.prototype.hasOwnProperty;function T3(e,t){return N3.call(e,t)}function I3(e,t,n,r){var a,i=t[0],o=t[t.length-1];return i>o&&(a=i,i=o,o=a),r=void 0===r||r,((n=void 0===n||n)?i<=e:i<e)&&(r?e<=o:e<o)}function D3(e){return"[object Date]"===Object.prototype.toString.call(e)}var F3,M3="Literal",O3="Property",R3="ArrayExpression",j3="BinaryExpression",B3="CallExpression",z3="ConditionalExpression",Z3="LogicalExpression",L3="MemberExpression",P3="ObjectExpression",U3="UnaryExpression";function W3(e){this.type=e}W3.prototype.visit=function(e){var t,n,r;if(e(this))return 1;for(n=0,r=(t=function(e){switch(e.type){case R3:return e.elements;case j3:case Z3:return[e.left,e.right];case B3:return[e.callee].concat(e.arguments);case z3:return[e.test,e.consequent,e.alternate];case L3:return[e.object,e.property];case P3:return e.properties;case O3:return[e.key,e.value];case U3:return[e.argument];default:return[]}}(this)).length;n<r;++n)if(t[n].visit(e))return 1};(F3={})[1]="Boolean",F3[2]="<end>",F3[3]="Identifier",F3[4]="Keyword",F3[5]="Null",F3[6]="Numeric",F3[7]="Punctuator",F3[8]="String",F3[9]="RegularExpression";var V3;var q3=Symbol("vega_selection_getter");function G3(e){return e.getter&&e.getter[q3]||(e.getter=k3(e.field),e.getter[q3]=!0),e.getter}var H3="intersect",X3="union",K3="_vgsid_",Y3=k3(K3),$3="index:unit";function Q3(e,t){for(var n,r,a=t.fields,i=t.values,o=a.length,u=0;u<o;++u)if(D3(n=G3(r=a[u])(e))&&(n=C3(n)),D3(i[u])&&(i[u]=C3(i[u])),_3(i[u])&&D3(i[u][0])&&(i[u]=i[u].map(C3)),"E"===r.type){if(_3(i[u])?i[u].indexOf(n)<0:n!==i[u])return!1}else if("R"===r.type){if(!I3(n,i[u]))return!1}else if("R-RE"===r.type){if(!I3(n,i[u],!0,!1))return!1}else if("R-E"===r.type){if(!I3(n,i[u],!1,!1))return!1}else if("R-LE"===r.type&&!I3(n,i[u],!1,!0))return!1;return!0}var J3=rm(Y3),e4=J3.left,t4=J3.right;var n4=(V3={},(0,Xn.Z)(V3,"".concat(K3,"_union"),(function(){for(var e=new Fg,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(var a=0,i=n;a<i.length;a++){var o,u=i[a],s=(0,Rt.Z)(u);try{for(s.s();!(o=s.n()).done;){var c=o.value;e.add(c)}}catch(l){s.e(l)}finally{s.f()}}return e})),(0,Xn.Z)(V3,"".concat(K3,"_intersect"),(function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];e=new Fg(e),n=n.map(v3);var a,i=(0,Rt.Z)(e);try{e:for(i.s();!(a=i.n()).done;){var o,u=a.value,s=(0,Rt.Z)(n);try{for(s.s();!(o=s.n()).done;){var c=o.value;if(!c.has(u)){e.delete(u);continue e}}}catch(l){s.e(l)}finally{s.f()}}}catch(l){i.e(l)}finally{i.f()}return e})),(0,Xn.Z)(V3,"E_union",(function(e,t){if(!e.length)return t;for(var n=0,r=t.length;n<r;++n)e.indexOf(t[n])<0&&e.push(t[n]);return e})),(0,Xn.Z)(V3,"E_intersect",(function(e,t){return e.length?e.filter((function(e){return t.indexOf(e)>=0})):t})),(0,Xn.Z)(V3,"R_union",(function(e,t){var n=C3(t[0]),r=C3(t[1]);return n>r&&(n=t[1],r=t[0]),e.length?(e[0]>n&&(e[0]=n),e[1]<r&&(e[1]=r),e):[n,r]})),(0,Xn.Z)(V3,"R_intersect",(function(e,t){var n=C3(t[0]),r=C3(t[1]);return n>r&&(n=t[1],r=t[0]),e.length?r<e[0]||e[1]<n?[]:(e[0]<n&&(e[0]=n),e[1]>r&&(e[1]=r),e):[n,r]})),V3);function r4(e,t,n,r){t[0].type!==M3&&x3("First argument to selection functions must be a string literal.");var a=t[0].value,i="unit",o="@unit",u=":"+a;(t.length>=2&&S3(t).value)!==H3||T3(r,o)||(r["@unit"]=n.getData(a).indataRef(n,i)),T3(r,u)||(r[u]=n.getData(a).tuplesRef())}function a4(e){var t=this.context.data[e];return t?t.values.value:[]}var i4=function(e){return function(t,n){return this.context.dataflow.locale()[e](n)(t)}},o4=i4("format"),u4=i4("timeFormat"),s4=i4("utcFormat"),c4=i4("timeParse"),l4=i4("utcParse"),f4=new Date(2e3,0,1);function d4(e,t,n){return Number.isInteger(e)&&Number.isInteger(t)?(f4.setYear(2e3),f4.setMonth(e),f4.setDate(t),u4.call(this,f4,n)):""}function h4(e,t,n,r){t[0].type!==IJ&&$Q("First argument to data functions must be a string literal.");var a=t[0].value,i=":"+a;if(!gJ(i,r))try{r[i]=n.getData(a).tuplesRef()}catch(o){}}function p4(e,t,n,r){if(t[0].type===IJ)v4(n,r,t[0].value);else for(e in n.scales)v4(n,r,e)}function v4(e,t,n){var r="%"+n;if(!gJ(t,r))try{t[r]=e.scaleRef(n)}catch(a){}}function m4(e,t){var n;return pJ(e)?e:xJ(e)?(n=t.scales[e])&&n.value:void 0}function g4(e,t,n){t.__bandwidth=function(e){return e&&e.bandwidth?e.bandwidth():0},n._bandwidth=p4,n._range=p4,n._scale=p4;var r=function(t){return"_["+(t.type===IJ?kJ("%"+t.value):kJ("%")+"+"+e(t))+"]"};return{_bandwidth:function(e){return"this.__bandwidth(".concat(r(e[0]),")")},_range:function(e){return"".concat(r(e[0]),".range()")},_scale:function(t){return"".concat(r(t[0]),"(").concat(e(t[1]),")")}}}function y4(e,t){return function(n,r,a){if(n){var i=m4(n,(a||this).context);return i&&i.path[e](r)}return t(r)}}var b4=y4("area",(function(e){return N1=new W0,l1(e,T1),2*N1})),x4=y4("bounds",(function(e){var t,n,r,a,i,o,u;if(b1=y1=-(m1=g1=1/0),C1=[],l1(e,$1),n=C1.length){for(C1.sort(o2),t=1,i=[r=C1[0]];t<n;++t)u2(r,(a=C1[t])[0])||u2(r,a[1])?(i2(r[0],a[1])>i2(r[0],r[1])&&(r[1]=a[1]),i2(a[0],r[1])>i2(r[0],r[1])&&(r[0]=a[0])):i.push(r=a);for(o=-1/0,t=0,r=i[n=i.length-1];t<=n;r=a,++t)a=i[t],(u=i2(r[1],a[0]))>o&&(o=u,m1=a[0],y1=r[1])}return C1=A1=null,m1===1/0||g1===1/0?[[NaN,NaN],[NaN,NaN]]:[[m1,g1],[y1,b1]]})),w4=y4("centroid",(function(e){R1=j1=B1=z1=Z1=L1=P1=U1=0,W1=new W0,V1=new W0,q1=new W0,l1(e,s2);var t=+W1,n=+V1,r=+q1,a=e1(t,n,r);return a<1e-12&&(t=L1,n=P1,r=U1,j1<V0&&(t=B1,n=z1,r=Z1),(a=e1(t,n,r))<1e-12)?[NaN,NaN]:[Q0(n,t)*K0,r1(r/a)*K0]}));function k4(e,t,n){try{e[t].apply(e,["EXPRESSION"].concat([].slice.call(n)))}catch(r){e.warn(r)}return n[n.length-1]}function _4(e){var t=e/255;return t<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4)}function S4(e){var t=P2(e);return.2126*_4(t.r)+.7152*_4(t.g)+.0722*_4(t.b)}function C4(e,t){return e===t||e!==e&&t!==t||(nJ(e)?!(!nJ(t)||e.length!==t.length)&&function(e,t){for(var n=0,r=e.length;n<r;++n)if(!C4(e[n],t[n]))return!1;return!0}(e,t):!(!rJ(e)||!rJ(t))&&A4(e,t))}function A4(e,t){for(var n in e)if(!C4(e[n],t[n]))return!1;return!0}function E4(e){return function(t){return A4(e,t)}}var N4={};function T4(e){return nJ(e)||ArrayBuffer.isView(e)?e:null}function I4(e){return T4(e)||(xJ(e)?e:null)}var D4=function(e){return e.data};function F4(e,t){var n=a4.call(t,e);return n.root&&n.root.lookup||{}}var M4=function(){return"undefined"!==typeof window&&window||null};var O4={random:function(){return Uu()},cumulativeNormal:Ju,cumulativeLogNormal:is,cumulativeUniform:fs,densityNormal:Qu,densityLogNormal:as,densityUniform:ls,quantileNormal:es,quantileLogNormal:os,quantileUniform:ds,sampleNormal:$u,sampleLogNormal:rs,sampleUniform:cs,isArray:nJ,isBoolean:function(e){return"boolean"===typeof e},isDate:yJ,isDefined:function(e){return void 0!==e},isNumber:bJ,isObject:rJ,isRegExp:function(e){return"[object RegExp]"===Object.prototype.toString.call(e)},isString:xJ,isTuple:jo,isValid:function(e){return null!=e&&e===e},toBoolean:function(e){return null==e||""===e?null:!(!e||"false"===e||"0"===e)&&!!e},toDate:function(e,t){return t=t||_J,null==e||""===e?null:t(e)},toNumber:iJ,toString:function(e){return null==e||""===e?null:e+""},indexof:function(e){for(var t,n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];return(t=I4(e)).indexOf.apply(t,r)},join:function(e){for(var t,n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];return(t=T4(e)).join.apply(t,r)},lastindexof:function(e){for(var t,n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];return(t=I4(e)).lastIndexOf.apply(t,r)},replace:function(e,t,n){return pJ(n)&&$Q("Function argument passed to replace."),String(e).replace(t,n)},reverse:function(e){return T4(e).slice().reverse()},slice:function(e){for(var t,n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];return(t=I4(e)).slice.apply(t,r)},flush:function(e,t,n,r,a,i){if(!n&&0!==n)return i;var o,u=+n,s=e[0],c=aJ(e);c<s&&(o=s,s=c,c=o),o=Math.abs(t-s);var l=Math.abs(c-t);return o<l&&o<=u?r:l<=u?a:i},lerp:function(e,t){var n=e[0],r=aJ(e),a=+t;return a?1===a?r:n+a*(r-n):n},merge:function(){var e=[].slice.call(arguments);return e.unshift({}),vJ.apply(void 0,(0,cn.Z)(e))},pad:function(e,t,n,r){var a=n||" ",i=e+"",o=t-i.length;return o<=0?i:"left"===r?wJ(a,o)+i:"center"===r?wJ(a,~~(o/2))+i+wJ(a,Math.ceil(o/2)):i+wJ(a,o)},peek:aJ,pluck:function(e,t){var n=N4[t]||(N4[t]=JQ(t));return nJ(e)?e.map(n):n(e)},span:function(e){return e&&aJ(e)-e[0]||0},inrange:function(e,t,n,r){var a,i=t[0],o=t[t.length-1];return i>o&&(a=i,i=o,o=a),r=void 0===r||r,((n=void 0===n||n)?i<=e:i<e)&&(r?e<=o:e<o)},truncate:function(e,t,n,r){var a=null!=r?r:"\u2026",i=e+"",o=i.length,u=Math.max(0,t-a.length);return o<=t?i:"left"===n?a+i.slice(o-u):"center"===n?i.slice(0,Math.ceil(u/2))+a+i.slice(o-~~(u/2)):i.slice(0,u)+a},rgb:P2,lab:i3,hcl:d3,hsl:X2,luminance:S4,contrast:function(e,t){var n=S4(e),r=S4(t);return(Math.max(n,r)+.05)/(Math.min(n,r)+.05)},sequence:function(e,t,n){e=+e,t=+t,n=(a=arguments.length)<2?(t=e,e=0,1):a<3?1:+n;for(var r=-1,a=0|Math.max(0,Math.ceil((t-e)/n)),i=new Array(a);++r<a;)i[r]=e+r*n;return i},format:o4,utcFormat:s4,utcParse:l4,utcOffset:Bl,utcSequence:Ll,timeFormat:u4,timeParse:c4,timeOffset:jl,timeSequence:Zl,timeUnitSpecifier:sl,monthFormat:function(e){return d4.call(this,e,1,"%B")},monthAbbrevFormat:function(e){return d4.call(this,e,1,"%b")},dayFormat:function(e){return d4.call(this,0,2+e,"%A")},dayAbbrevFormat:function(e){return d4.call(this,0,2+e,"%a")},quarter:function(e){return 1+~~(new Date(e).getMonth()/3)},utcquarter:function(e){return 1+~~(new Date(e).getUTCMonth()/3)},week:dl,utcweek:yl,dayofyear:fl,utcdayofyear:gl,warn:function(){return k4(this.context.dataflow,"warn",arguments)},info:function(){return k4(this.context.dataflow,"info",arguments)},debug:function(){return k4(this.context.dataflow,"debug",arguments)},extent:function(e,t){var n,r,a,i,o=0;if(e&&(n=e.length))if(null==t){for(r=e[o];o<n&&(null==r||r!==r);r=e[++o]);for(a=i=r;o<n;++o)null!=(r=e[o])&&(r<a&&(a=r),r>i&&(i=r))}else{for(r=t(e[o]);o<n&&(null==r||r!==r);r=t(e[++o]));for(a=i=r;o<n;++o)null!=(r=t(e[o]))&&(r<a&&(a=r),r>i&&(i=r))}return[a,i]},inScope:function(e){var t=this.context.group,n=!1;if(t)for(;e;){if(e===t){n=!0;break}e=e.mark.group}return n},intersect:function(e,t,n){if(!e)return[];var r=(0,Cn.Z)(e,2),a=r[0],i=r[1],o=(new dG).set(a[0],a[1],i[0],i[1]);return LK(n||this.context.dataflow.scenegraph().root,o,function(e){var t=null;if(e){var n=hJ(e.marktype),r=hJ(e.markname);t=function(e){return(!n.length||n.some((function(t){return e.marktype===t})))&&(!r.length||r.some((function(t){return e.name===t})))}}return t}(t))},clampRange:function(e,t,n){var r,a=e[0],i=e[1];return i<a&&(r=i,i=a,a=r),(r=i-a)>=n-t?[t,n]:[a=Math.min(Math.max(a,t),n-r),a+r]},pinchDistance:function(e){var t=e.touches,n=t[0].clientX-t[1].clientX,r=t[0].clientY-t[1].clientY;return Math.sqrt(n*n+r*r)},pinchAngle:function(e){var t=e.touches;return Math.atan2(t[0].clientY-t[1].clientY,t[0].clientX-t[1].clientX)},screen:function(){var e=M4();return e?e.screen:{}},containerSize:function(){var e=this.context.dataflow,t=e.container&&e.container();return t?[t.clientWidth,t.clientHeight]:[void 0,void 0]},windowSize:function(){var e=M4();return e?[e.innerWidth,e.innerHeight]:[void 0,void 0]},bandspace:function(e,t,n){return GT(e||0,t||0,n||0)},setdata:function(e,t){var n=this.context.dataflow,r=this.context.data[e].input;return n.pulse(r,n.changeset().remove(tJ).insert(t)),1},pathShape:function(e){var t=null;return function(n){return n?Rq(n,t=t||Sq(e)):e}},panLinear:function(e,t){return fJ(e,t,iJ,eJ)},panLog:function(e,t){var n=Math.sign(e[0]);return fJ(e,t,uJ(n),oJ(n))},panPow:function(e,t,n){return fJ(e,t,lJ(n),lJ(1/n))},panSymlog:function(e,t,n){return fJ(e,t,sJ(n),cJ(n))},zoomLinear:function(e,t,n){return dJ(e,t,n,iJ,eJ)},zoomLog:function(e,t,n){var r=Math.sign(e[0]);return dJ(e,t,n,uJ(r),oJ(r))},zoomPow:function(e,t,n,r){return dJ(e,t,n,lJ(r),lJ(1/r))},zoomSymlog:function(e,t,n,r){return dJ(e,t,n,sJ(r),cJ(r))},encode:function(e,t,n){if(e){var r=this.context.dataflow,a=e.mark.source;r.pulse(a,r.changeset().encode(e,t))}return void 0!==n?n:e},modify:function(e,t,n,r,a,i){var o,u,s=this.context.dataflow,c=this.context.data[e],l=c.input,f=s.stamp(),d=c.changes;if(!1===s._trigger||!(l.value.length||t||r))return 0;if((!d||d.stamp<f)&&(c.changes=d=s.changeset(),d.stamp=f,s.runAfter((function(){c.modified=!0,s.pulse(l,d).run()}),!0,1)),n&&(o=!0===n?tJ:nJ(n)||jo(n)?n:E4(n),d.remove(o)),t&&d.insert(t),r&&(o=E4(r),l.value.some(o)?d.remove(o):d.insert(r)),a)for(u in i)d.modify(a,u,i[u]);return 1}},R4=["view","item","group","xy","x","y"],j4="this.",B4={},z4={forbidden:["_"],allowed:["datum","event","item"],fieldvar:"datum",globalvar:function(e){return"_[".concat(kJ("$"+e),"]")},functions:function(e){var t=U0(e);for(var n in R4.forEach((function(e){return t[e]="event.vega."+e})),O4)t[n]=j4+n;return vJ(t,g4(e,O4,B4)),t},constants:P0,visitors:B4},Z4=function(e){var t=(e=e||{}).allowed?SJ(e.allowed):{},n=e.forbidden?SJ(e.forbidden):{},r=e.constants||P0,a=(e.functions||U0)(f),i=e.globalvar,o=e.fieldvar,u=pJ(i)?i:function(e){return"".concat(i,'["').concat(e,'"]')},s={},c={},l=0;function f(e){if(xJ(e))return e;var t=d[e.type];return null==t&&$Q("Unsupported type: "+e.type),t(e)}var d={Literal:function(e){return e.raw},Identifier:function(e){var a=e.name;return l>0?a:gJ(n,a)?$Q("Illegal identifier: "+a):gJ(r,a)?r[a]:gJ(t,a)?a:(s[a]=1,u(a))},MemberExpression:function(e){var t=!e.computed,n=f(e.object);t&&(l+=1);var r=f(e.property);return n===o&&(c[function(e){var t=e&&e.length-1;return t&&('"'===e[0]&&'"'===e[t]||"'"===e[0]&&"'"===e[t])?e.slice(1,-1):e}(r)]=1),t&&(l-=1),n+(t?"."+r:"["+r+"]")},CallExpression:function(e){"Identifier"!==e.callee.type&&$Q("Illegal callee type: "+e.callee.type);var t=e.callee.name,n=e.arguments,r=gJ(a,t)&&a[t];return r||$Q("Unrecognized function: "+t),pJ(r)?r(n):r+"("+n.map(f).join(",")+")"},ArrayExpression:function(e){return"["+e.elements.map(f).join(",")+"]"},BinaryExpression:function(e){return"("+f(e.left)+" "+e.operator+" "+f(e.right)+")"},UnaryExpression:function(e){return"("+e.operator+f(e.argument)+")"},ConditionalExpression:function(e){return"("+f(e.test)+"?"+f(e.consequent)+":"+f(e.alternate)+")"},LogicalExpression:function(e){return"("+f(e.left)+e.operator+f(e.right)+")"},ObjectExpression:function(e){return"{"+e.properties.map(f).join(",")+"}"},Property:function(e){l+=1;var t=f(e.key);return l-=1,t+":"+f(e.value)}};function h(e){var t={code:f(e),globals:Object.keys(s),fields:Object.keys(c)};return s={},c={},t}return h.functions=a,h.constants=r,h}(z4);function L4(e,t,n){return 1===arguments.length?O4[e]:(O4[e]=t,n&&(B4[e]=n),Z4&&(Z4.functions[e]=j4+e),this)}function P4(e,t){var n,r={};try{n=function(e){EJ=0,NJ=(AJ=e).length,TJ=null,v0();var t=L0();if(2!==TJ.type)throw new Error("Unexpect token after expression.");return t}(e=xJ(e)?e:kJ(e)+"")}catch(i){$Q("Expression parse error: "+e)}n.visit((function(e){if(e.type===OJ){var n=e.callee.name,a=z4.visitors[n];a&&a(n,e.arguments,t,r)}}));var a=Z4(n);return a.globals.forEach((function(e){var n="$"+e;!gJ(r,n)&&t.getSignal(e)&&(r[n]=t.signalRef(e))})),{$expr:vJ({code:a.code},t.options.ast?{ast:n}:null),$fields:a.fields,$params:r}}function U4(e,t,n){return e.fields=t||[],e.fname=n,e}function W4(e){return 1===e.length?V4(e[0]):q4(e)}L4("bandwidth",(function(e,t){var n=m4(e,(t||this).context);return n&&n.bandwidth?n.bandwidth():0}),p4),L4("copy",(function(e,t){var n=m4(e,(t||this).context);return n?n.copy():void 0}),p4),L4("domain",(function(e,t){var n=m4(e,(t||this).context);return n?n.domain():[]}),p4),L4("range",(function(e,t){var n=m4(e,(t||this).context);return n&&n.range?n.range():[]}),p4),L4("invert",(function(e,t,n){var r=m4(e,(n||this).context);return r?nJ(t)?(r.invertRange||r.invert)(t):(r.invert||r.invertExtent)(t):void 0}),p4),L4("scale",(function(e,t,n){var r=m4(e,(n||this).context);return r?r(t):void 0}),p4),L4("gradient",(function(e,t,n,r,a){e=m4(e,(a||this).context);var i=bq(t,n),o=e.domain(),u=o[0],s=aJ(o),c=eJ;return s-u?c=OI(e,u,s):e=(e.interpolator?wI("sequential")().interpolator(e.interpolator()):wI("linear")().interpolate(e.interpolate()).range(e.range())).domain([u=0,s=1]),e.ticks&&(u!==(o=e.ticks(+r||15))[0]&&o.unshift(u),s!==aJ(o)&&o.push(s)),o.forEach((function(t){return i.stop(c(t),e(t))})),i}),p4),L4("geoArea",b4,p4),L4("geoBounds",x4,p4),L4("geoCentroid",w4,p4),L4("geoShape",(function(e,t,n){var r=m4(e,(n||this).context);return function(e){return r?r.path.context(e)(t):""}}),p4),L4("indata",(function(e,t,n){var r=this.context.data[e]["index:"+t],a=r?r.value.get(n):void 0;return a?a.count:a}),(function(e,t,n,r){t[0].type!==IJ&&$Q("First argument to indata must be a string literal."),t[1].type!==IJ&&$Q("Second argument to indata must be a string literal.");var a=t[0].value,i=t[1].value,o="@"+i;gJ(o,r)||(r[o]=n.getData(a).indataRef(n,i))})),L4("data",a4,h4),L4("treePath",(function(e,t,n){var r=F4(e,this),a=r[t],i=r[n];return a&&i?a.path(i).map(D4):void 0}),h4),L4("treeAncestors",(function(e,t){var n=F4(e,this)[t];return n?n.ancestors().map(D4):void 0}),h4),L4("vlSelectionTest",(function(e,t,n){for(var r,a,i,o,u,s=this.context.data[e],c=s?s.values.value:[],l=s?s[$3]&&s[$3].value:void 0,f=n===H3,d=c.length,h=0;h<d;++h)if(r=c[h],l&&f){if(-1===(i=(a=a||{})[o=r.unit]||0))continue;if(u=Q3(t,r),a[o]=u?-1:++i,u&&1===l.size)return!0;if(!u&&i===l.get(o).count)return!1}else if(f^(u=Q3(t,r)))return u;return d&&f}),r4),L4("vlSelectionIdTest",(function(e,t,n){var r=this.context.data[e],a=r?r.values.value:[],i=r?r[$3]&&r[$3].value:void 0,o=n===H3,u=Y3(t),s=e4(a,u);if(s===a.length)return!1;if(Y3(a[s])!==u)return!1;if(i&&o){if(1===i.size)return!0;if(t4(a,u)-s<i.size)return!1}return!0}),r4),L4("vlSelectionResolve",(function(e,t,n,r){for(var a,i,o,u,s,c,l,f,d,h,p,v,m=this.context.data[e],g=m?m.values.value:[],y={},b={},x={},w=g.length,k=0;k<w;++k)if(u=(a=g[k]).unit,i=a.fields,o=a.values,i&&o){for(p=0,v=i.length;p<v;++p)s=i[p],f=(l=y[s.field]||(y[s.field]={}))[u]||(l[u]=[]),x[s.field]=d=s.type.charAt(0),h=n4["".concat(d,"_union")],l[u]=h(f,A3(o[p]));n&&(f=b[u]||(b[u]=[])).push(A3(o).reduce((function(e,t,n){return e[i[n].field]=t,e}),{}))}else s=K3,c=Y3(a),(f=(l=y[s]||(y[s]={}))[u]||(l[u]=[])).push(c),n&&(f=b[u]||(b[u]=[])).push((0,Xn.Z)({},K3,c));return t=t||X3,y._vgsid_?y._vgsid_=n4["".concat(K3,"_").concat(t)].apply(n4,(0,cn.Z)(Object.values(y._vgsid_))):Object.keys(y).forEach((function(e){y[e]=Object.keys(y[e]).map((function(t){return y[e][t]})).reduce((function(n,r){return void 0===n?r:n4["".concat(x[e],"_").concat(t)](n,r)}))})),g=Object.keys(b),n&&g.length&&(y[r?"vlPoint":"vlMulti"]=t===X3?(0,Xn.Z)({},"or",g.reduce((function(e,t){return e.push.apply(e,(0,cn.Z)(b[t])),e}),[])):(0,Xn.Z)({},"and",g.map((function(e){return(0,Xn.Z)({},"or",b[e])})))),y}),r4),L4("vlSelectionTuples",(function(e,t){return e.map((function(e){return E3(t.fields?{values:t.fields.map((function(t){return G3(t)(e.datum)}))}:(0,Xn.Z)({},K3,Y3(e.datum)),t)}))}));var V4=function(e){return function(t){return t[e]}},q4=function(e){var t=e.length;return function(n){for(var r=0;r<t;++r)n=n[e[r]];return n}};function G4(e){throw Error(e)}function H4(e){var t,n,r,a=[],i=e.length,o=null,u=0,s="";function c(){a.push(s+e.substring(t,n)),s="",t=n+1}for(e+="",t=n=0;n<i;++n)if("\\"===(r=e[n]))s+=e.substring(t,n++),t=n;else if(r===o)c(),o=null,u=-1;else{if(o)continue;t===u&&'"'===r||t===u&&"'"===r?(t=n+1,o=r):"."!==r||u?"["===r?(n>t&&c(),u=t=n+1):"]"===r&&(u||G4("Access path missing open bracket: "+e),u>0&&c(),u=0,t=n+1):n>t?c():t=n+1}return u&&G4("Access path missing closing bracket: "+e),o&&G4("Access path missing closing quote: "+e),n>t&&(n++,c()),a}function X4(e,t,n){var r=H4(e);return e=1===r.length?r[0]:e,U4((n&&n.get||W4)(r),[e],t||e)}X4("id"),U4((function(e){return e}),[],"identity"),U4((function(){return 0}),[],"zero"),U4((function(){return 1}),[],"one");var K4=U4((function(){return!0}),[],"true");U4((function(){return!1}),[],"false");var Y4=Array.isArray;function $4(e){return e===Object(e)}function Q4(e){return null!=e?Y4(e)?e:[e]:[]}function J4(e){return"function"===typeof e}var e5=function(e,t){return(e<t||null==e)&&null!=t?-1:(e>t||null==t)&&null!=e?1:(t=t instanceof Date?+t:t,(e=e instanceof Date?+e:e)!==e&&t===t?-1:t!==t&&e===e?1:0)},t5=function(e,t){return 1===e.length?n5(e[0],t[0]):r5(e,t,e.length)},n5=function(e,t){return function(n,r){return e5(e(n),e(r))*t}},r5=function(e,t,n){return t.push(0),function(r,a){for(var i,o=0,u=-1;0===o&&++u<n;)i=e[u],o=e5(i(r),i(a));return o*t[u]}};var a5=Object.prototype.hasOwnProperty;function i5(e,t){return a5.call(e,t)}function o5(e){return Y4(e)?"["+e.map(o5)+"]":$4(e)||"string"===typeof e?JSON.stringify(e).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):e}function u5(e){for(var t={},n=e.length,r=0;r<n;++r)t[e[r]]=!0;return t}var s5=u5(["rule"]),c5=u5(["group","image","rect"]);function l5(e){return(e+"").toLowerCase()}function f5(e,t,n){n.endsWith(";")||(n="return("+n+");");var r=Function.apply(void 0,(0,cn.Z)(t.concat(n)));return e&&e.functions?r.bind(e.functions):r}var d5={operator:function(e,t){return f5(e,["_"],t.code)},parameter:function(e,t){return f5(e,["datum","_"],t.code)},event:function(e,t){return f5(e,["event"],t.code)},handler:function(e,t){return f5(e,["_","event"],"var datum=event.item&&event.item.datum;return ".concat(t.code,";"))},encode:function(e,t){var n=t.marktype,r=t.channels,a="var o=item,datum=o.datum,m=0,$;";for(var i in r){var o="o["+o5(i)+"]";a+="$=".concat(r[i].code,";if(").concat(o,"!==$)").concat(o,"=$,m=1;")}return a+=function(e,t){var n="";return s5[t]||(e.x2&&(e.x?(c5[t]&&(n+="if(o.x>o.x2)$=o.x,o.x=o.x2,o.x2=$;"),n+="o.width=o.x2-o.x;"):n+="o.x=o.x2-(o.width||0);"),e.xc&&(n+="o.x=o.xc-(o.width||0)/2;"),e.y2&&(e.y?(c5[t]&&(n+="if(o.y>o.y2)$=o.y,o.y=o.y2,o.y2=$;"),n+="o.height=o.y2-o.y;"):n+="o.y=o.y2-(o.height||0);"),e.yc&&(n+="o.y=o.yc-(o.height||0)/2;")),n}(r,n),f5(e,["item","_"],a+="return m;")},codegen:{get:function(e){var t="[".concat(e.map(o5).join("]["),"]"),n=Function("_","return _".concat(t,";"));return n.path=t,n},comparator:function(e,t){var n,r=Function("a","b","var u, v; return "+e.map((function(e,r){var a,i,o=t[r];return e.path?(a="a".concat(e.path),i="b".concat(e.path)):((n=n||{})["f"+r]=e,a="this.f".concat(r,"(a)"),i="this.f".concat(r,"(b)")),function(e,t,n,r){return"((u = ".concat(e,") < (v = ").concat(t,") || u == null) && v != null ? ").concat(n,"\n  : (u > v || v == null) && u != null ? ").concat(r,"\n  : ((v = v instanceof Date ? +v : v), (u = u instanceof Date ? +u : u)) !== u && v === v ? ").concat(n,"\n  : v !== v && u === u ? ").concat(r," : ")}(a,i,-o,o)})).join("")+"0;");return n?r.bind(n):r}}};function h5(e,t,n){if(!e||!$4(e))return e;for(var r,a=0,i=p5.length;a<i;++a)if(i5(e,(r=p5[a]).key))return r.parse(e,t,n);return e}var p5=[{key:"$ref",parse:function(e,t){return t.get(e.$ref)||G4("Operator not defined: "+e.$ref)}},{key:"$key",parse:function(e,t){var n="k:"+e.$key+"_"+!!e.$flat;return t.fn[n]||(t.fn[n]=function(e,t,n){e&&(e=t?Q4(e).map((function(e){return e.replace(/\\(.)/g,"$1")})):Q4(e));var r,a=e&&e.length,i=n&&n.get||W4,o=function(e){return i(t?[e]:H4(e))};if(a)if(1===a){var u=o(e[0]);r=function(e){return""+u(e)}}else{var s=e.map(o);r=function(e){for(var t=""+s[0](e),n=0;++n<a;)t+="|"+s[n](e);return t}}else r=function(){return""};return U4(r,e,"key")}(e.$key,e.$flat,t.expr.codegen))}},{key:"$expr",parse:function(e,t,n){e.$params&&t.parseParameters(e.$params,n);var r="e:"+e.$expr.code;return t.fn[r]||(t.fn[r]=U4(t.parameterExpression(e.$expr),e.$fields))}},{key:"$field",parse:function(e,t){if(!e.$field)return null;var n="f:"+e.$field+"_"+e.$name;return t.fn[n]||(t.fn[n]=X4(e.$field,e.$name,t.expr.codegen))}},{key:"$encode",parse:function(e,t){var n=e.$encode,r={};for(var a in n){var i=n[a];r[a]=U4(t.encodeExpression(i.$expr),i.$fields),r[a].output=i.$output}return r}},{key:"$compare",parse:function(e,t){var n="c:"+e.$compare+"_"+e.$order,r=Q4(e.$compare).map((function(e){return e&&e.$tupleid?Bo:e}));return t.fn[n]||(t.fn[n]=function(e,t,n){n=n||{},t=Q4(t)||[];var r=[],a=[],i={},o=n.comparator||t5;return Q4(e).forEach((function(e,o){var u;null!=e&&(r.push("descending"===t[o]?-1:1),a.push(e=J4(e)?e:X4(e,null,n)),(u=e,(null==u?null:u.fields)||[]).forEach((function(e){return i[e]=1})))})),0===a.length?null:U4(o(a,r),Object.keys(i))}(r,e.$order,t.expr.codegen))}},{key:"$context",parse:function(e,t){return t}},{key:"$subflow",parse:function(e,t){var n=e.$subflow;return function(e,r,a){var i=t.fork().parse(n),o=i.get(n.operators[0].id),u=i.signals.parent;return u&&u.set(a),o.detachSubflow=function(){return t.detach(i)},o}}},{key:"$tupleid",parse:function(){return Bo}}];var v5={skip:!0};function m5(e,t,n,r){return new g5(e,t,n,r)}function g5(e,t,n,r){this.dataflow=e,this.transforms=t,this.events=e.events.bind(e),this.expr=r||d5,this.signals={},this.scales={},this.nodes={},this.data={},this.fn={},n&&(this.functions=Object.create(n),this.functions.context=this)}function y5(e){this.dataflow=e.dataflow,this.transforms=e.transforms,this.events=e.events,this.expr=e.expr,this.signals=Object.create(e.signals),this.scales=Object.create(e.scales),this.nodes=Object.create(e.nodes),this.data=Object.create(e.data),this.fn=Object.create(e.fn),e.functions&&(this.functions=Object.create(e.functions),this.functions.context=this)}g5.prototype=y5.prototype={fork:function(){var e=new y5(this);return(this.subcontext||(this.subcontext=[])).push(e),e},detach:function(e){this.subcontext=this.subcontext.filter((function(t){return t!==e}));for(var t=Object.keys(e.nodes),n=0,r=t;n<r.length;n++){var a=r[n];e.nodes[a]._targets=null}for(var i=0,o=t;i<o.length;i++){var u=o[i];e.nodes[u].detach()}e.nodes=null},get:function(e){return this.nodes[e]},set:function(e,t){return this.nodes[e]=t},add:function(e,t){var n=this,r=n.dataflow,a=e.value;if(n.set(e.id,t),function(e){return"collect"===l5(e)}(e.type)&&a&&(a.$ingest?r.ingest(t,a.$ingest,a.$format):a.$request?r.preload(t,a.$request,a.$format):r.pulse(t,r.changeset().insert(a))),e.root&&(n.root=t),e.parent){var i=n.get(e.parent.$ref);i?(r.connect(i,[t]),t.targets().add(i)):(n.unresolved=n.unresolved||[]).push((function(){i=n.get(e.parent.$ref),r.connect(i,[t]),t.targets().add(i)}))}if(e.signal&&(n.signals[e.signal]=t),e.scale&&(n.scales[e.scale]=t),e.data){var o=function(r){var a=n.data[r]||(n.data[r]={});e.data[r].forEach((function(e){return a[e]=t}))};for(var u in e.data)o(u)}},resolve:function(){return(this.unresolved||[]).forEach((function(e){return e()})),delete this.unresolved,this},operator:function(e,t){this.add(e,this.dataflow.add(e.value,t))},transform:function(e,t){this.add(e,this.dataflow.add(this.transforms[l5(t)]))},stream:function(e,t){this.set(e.id,t)},update:function(e,t,n,r,a){this.dataflow.on(t,n,r,a,e.options)},operatorExpression:function(e){return this.expr.operator(this,e)},parameterExpression:function(e){return this.expr.parameter(this,e)},eventExpression:function(e){return this.expr.event(this,e)},handlerExpression:function(e){return this.expr.handler(this,e)},encodeExpression:function(e){return this.expr.encode(this,e)},parse:function(e){var t=this,n=e.operators||[];return e.background&&(t.background=e.background),e.eventConfig&&(t.eventConfig=e.eventConfig),e.locale&&(t.locale=e.locale),n.forEach((function(e){return t.parseOperator(e)})),n.forEach((function(e){return t.parseOperatorParameters(e)})),(e.streams||[]).forEach((function(e){return t.parseStream(e)})),(e.updates||[]).forEach((function(e){return t.parseUpdate(e)})),t.resolve()},parseOperator:function(e){var t=this;!function(e){return"operator"===l5(e)}(e.type)&&e.type?t.transform(e,e.type):t.operator(e,e.update?t.operatorExpression(e.update):null)},parseOperatorParameters:function(e){var t=this;if(e.params){var n=t.get(e.id);n||G4("Invalid operator id: "+e.id),t.dataflow.connect(n,n.parameters(t.parseParameters(e.params),e.react,e.initonly))}},parseParameters:function(e,t){t=t||{};var n=this;for(var r in e){var a=e[r];t[r]=Y4(a)?a.map((function(e){return h5(e,n,t)})):h5(a,n,t)}return t},parseStream:function(e){var t,n=this,r=null!=e.filter?n.eventExpression(e.filter):void 0,a=null!=e.stream?n.get(e.stream):void 0;e.source?a=n.events(e.source,e.type,r):e.merge&&(a=(t=e.merge.map((function(e){return n.get(e)})))[0].merge.apply(t[0],t.slice(1))),e.between&&(t=e.between.map((function(e){return n.get(e)})),a=a.between(t[0],t[1])),e.filter&&(a=a.filter(r)),null!=e.throttle&&(a=a.throttle(+e.throttle)),null!=e.debounce&&(a=a.debounce(+e.debounce)),null==a&&G4("Invalid stream definition: "+JSON.stringify(e)),e.consume&&a.consume(!0),n.stream(e,a)},parseUpdate:function(e){var t,n=this,r=$4(r=e.source)?r.$ref:r,a=n.get(r),i=e.update,o=void 0;a||G4("Source not defined: "+e.source),t=e.target&&e.target.$expr?n.eventExpression(e.target.$expr):n.get(e.target),i&&i.$expr&&(i.$params&&(o=n.parseParameters(i.$params)),i=n.handlerExpression(i.$expr)),n.update(e,a,t,i,o)},getState:function(e){var t=this,n={};if(e.signals){var r=n.signals={};Object.keys(t.signals).forEach((function(n){var a=t.signals[n];e.signals(n,a)&&(r[n]=a.value)}))}if(e.data){var a=n.data={};Object.keys(t.data).forEach((function(n){var r=t.data[n];e.data(n,r)&&(a[n]=r.input.value)}))}return t.subcontext&&!1!==e.recurse&&(n.subcontext=t.subcontext.map((function(t){return t.getState(e)}))),n},setState:function(e){var t=this,n=t.dataflow,r=e.data,a=e.signals;Object.keys(a||{}).forEach((function(e){n.update(t.signals[e],a[e],v5)})),Object.keys(r||{}).forEach((function(e){n.pulse(t.data[e].input,n.changeset().remove(K4).insert(r[e]))})),(e.subcontext||[]).forEach((function(e,n){var r=t.subcontext[n];r&&r.setState(e)}))}};var b5,x5,w5=0,k5=0,_5=0,S5=0,C5=0,A5=0,E5="object"===typeof performance&&performance.now?performance:Date,N5="object"===typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function T5(){return C5||(N5(I5),C5=E5.now()+A5)}function I5(){C5=0}function D5(){this._call=this._time=this._next=null}function F5(){C5=(S5=E5.now())+A5,w5=k5=0;try{!function(){T5(),++w5;for(var e,t=b5;t;)(e=C5-t._time)>=0&&t._call.call(null,e),t=t._next;--w5}()}finally{w5=0,function(){var e,t,n=b5,r=1/0;for(;n;)n._call?(r>n._time&&(r=n._time),e=n,n=n._next):(t=n._next,n._next=null,n=e?e._next=t:b5=t);x5=e,O5(r)}(),C5=0}}function M5(){var e=E5.now(),t=e-S5;t>1e3&&(A5-=t,S5=e)}function O5(e){w5||(k5&&(k5=clearTimeout(k5)),e-C5>24?(e<1/0&&(k5=setTimeout(F5,e-E5.now()-A5)),_5&&(_5=clearInterval(_5))):(_5||(S5=E5.now(),_5=setInterval(M5,1e3)),w5=1,N5(F5)))}function R5(e,t){e&&(null==t?e.removeAttribute("aria-label"):e.setAttribute("aria-label",t))}D5.prototype=function(e,t,n){var r=new D5;return r.restart(e,t,n),r}.prototype={constructor:D5,restart:function(e,t,n){if("function"!==typeof e)throw new TypeError("callback is not a function");n=(null==n?T5():+n)+(null==t?0:+t),this._next||x5===this||(x5?x5._next=this:b5=this,x5=this),this._call=e,this._time=n,O5()},stop:function(){this._call&&(this._call=null,this._time=1/0,O5())}};var j5="default";function B5(e,t){var n=e.globalCursor()?"undefined"!==typeof document&&document.body:e.container();if(n)return null==t?n.style.removeProperty("cursor"):n.style.cursor=t}function z5(e,t){var n=e._runtime.data;return st(n,t)||ue("Unrecognized data set: "+t),n[t]}function Z5(e,t){Vo(t)||ue("Second argument to changes must be a changeset.");var n=z5(this,e);return n.modified=!0,this.pulse(n.input,t)}function L5(e){var t=e.padding();return Math.max(0,e._viewWidth+t.left+t.right)}function P5(e){var t=e.padding();return Math.max(0,e._viewHeight+t.top+t.bottom)}function U5(e){var t=e.padding(),n=e._origin;return[t.left+n[0],t.top+n[1]]}function W5(e){var t=U5(e),n=L5(e),r=P5(e);e._renderer.background(e.background()),e._renderer.resize(n,r,t),e._handler.origin(t),e._resizeListeners.forEach((function(t){try{t(n,r)}catch(a){e.error(a)}}))}function V5(e,t,n){var r,a,i=e._renderer,o=i&&i.canvas();return o&&(a=U5(e),(r=SX(t.changedTouches?t.changedTouches[0]:t,o))[0]-=a[0],r[1]-=a[1]),t.dataflow=e,t.item=n,t.vega=function(e,t,n){var r=t?"group"===t.mark.marktype?t:t.mark.group:null;function a(e){var n,a=r;if(e)for(n=t;n;n=n.mark.group)if(n.mark.name===e){a=n;break}return a&&a.mark&&a.mark.interactive?a:{}}function i(e){if(!e)return n;bt(e)&&(e=a(e));for(var t=n.slice();e;)t[0]-=e.x||0,t[1]-=e.y||0,e=e.mark&&e.mark.group;return t}return{view:nt(e),item:nt(t||{}),group:a,xy:i,x:function(e){return i(e)[0]},y:function(e){return i(e)[1]}}}(e,n,r),t}var q5="view",G5={trap:!1};function H5(e,t,n,r){e._eventListeners.push({type:n,sources:Xe(t),handler:r})}function X5(e,t,n){var r=e._eventConfig&&e._eventConfig[t];return!(!1===r||Se(r)&&!r[n])||(e.warn("Blocked ".concat(t," ").concat(n," event listener.")),!1)}function K5(e){return e.item}function Y5(e){return e.item.mark.source}function $5(e){return function(t,n){return n.vega.view().changeset().encode(n.item,e)}}function Q5(e,t,n){var r=document.createElement(e);for(var a in t)r.setAttribute(a,t[a]);return null!=n&&(r.textContent=n),r}function J5(e,t,n,r){var a=n.event||"input",i=function(){return e.update(t.value)};r.signal(n.signal,t.value),t.addEventListener(a,i),H5(r,t,a,i),e.set=function(e){t.value=e,t.dispatchEvent(function(e){return"undefined"!==typeof Event?new Event(e):{type:e}}(a))}}function e6(e,t,n,r){var a=r.signal(n.signal),i=Q5("div",{class:"vega-bind"}),o="radio"===n.input?i:i.appendChild(Q5("label"));o.appendChild(Q5("span",{class:"vega-bind-name"},n.name||n.signal)),t.appendChild(i);var u=t6;switch(n.input){case"checkbox":u=n6;break;case"select":u=r6;break;case"radio":u=a6;break;case"range":u=i6}u(e,o,n,a)}function t6(e,t,n,r){var a=Q5("input");for(var i in n)"signal"!==i&&"element"!==i&&a.setAttribute("input"===i?"type":i,n[i]);a.setAttribute("name",n.signal),a.value=r,t.appendChild(a),a.addEventListener("input",(function(){return e.update(a.value)})),e.elements=[a],e.set=function(e){return a.value=e}}function n6(e,t,n,r){var a={type:"checkbox",name:n.signal};r&&(a.checked=!0);var i=Q5("input",a);t.appendChild(i),i.addEventListener("change",(function(){return e.update(i.checked)})),e.elements=[i],e.set=function(e){return i.checked=!!e||null}}function r6(e,t,n,r){var a=Q5("select",{name:n.signal}),i=n.labels||[];n.options.forEach((function(e,t){var n={value:e};o6(e,r)&&(n.selected=!0),a.appendChild(Q5("option",n,(i[t]||e)+""))})),t.appendChild(a),a.addEventListener("change",(function(){e.update(n.options[a.selectedIndex])})),e.elements=[a],e.set=function(e){for(var t=0,r=n.options.length;t<r;++t)if(o6(n.options[t],e))return void(a.selectedIndex=t)}}function a6(e,t,n,r){var a=Q5("span",{class:"vega-bind-radio"}),i=n.labels||[];t.appendChild(a),e.elements=n.options.map((function(t,o){var u={type:"radio",name:n.signal,value:t};o6(t,r)&&(u.checked=!0);var s=Q5("input",u);s.addEventListener("change",(function(){return e.update(t)}));var c=Q5("label",{},(i[o]||t)+"");return c.prepend(s),a.appendChild(c),s})),e.set=function(t){for(var n=e.elements,r=n.length,a=0;a<r;++a)o6(n[a].value,t)&&(n[a].checked=!0)}}function i6(e,t,n,r){r=void 0!==r?r:(+n.max+ +n.min)/2;var a=null!=n.max?n.max:Math.max(100,+r)||100,i=n.min||Math.min(0,a,+r)||0,o=n.step||function(e,t,n){var r=Math.abs(t-e)/Math.max(0,n),a=Math.pow(10,Math.floor(Math.log(r)/Math.LN10)),i=r/a;return i>=VQ?a*=10:i>=qQ?a*=5:i>=GQ&&(a*=2),t<e?-a:a}(i,a,100),u=Q5("input",{type:"range",name:n.signal,min:i,max:a,step:o});u.value=r;var s=Q5("span",{},+r);t.appendChild(u),t.appendChild(s);var c=function(){s.textContent=u.value,e.update(+u.value)};u.addEventListener("input",c),u.addEventListener("change",c),e.elements=[u],e.set=function(e){u.value=e,s.textContent=e}}function o6(e,t){return e===t||e+""===t+""}function u6(e,t,n,r,a,i){return(t=t||new r(e.loader())).initialize(n,L5(e),P5(e),U5(e),a,i).background(e.background())}function s6(e,t){return t?function(){try{t.apply(this,arguments)}catch(n){e.error(n)}}:null}function c6(e,t,n){if("string"===typeof t){if("undefined"===typeof document)return e.error("DOM document instance not found."),null;if(!(t=document.querySelector(t)))return e.error("Signal bind element not found: "+t),null}if(t&&n)try{t.innerHTML=""}catch(r){t=null,e.error(r)}return t}var l6=function(e){return+e||0};function f6(e){return Se(e)?{top:l6(e.top),bottom:l6(e.bottom),left:l6(e.left),right:l6(e.right)}:function(e){return{top:e,bottom:e,left:e,right:e}}(l6(e))}function d6(e,t,n,r){return h6.apply(this,arguments)}function h6(){return h6=(0,jt.Z)(w().mark((function e(t,n,r,a){var i,o;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=ZK(n),(o=i&&i.headless)||ue("Unrecognized renderer type: "+n),e.next=4,t.runAsync();case 4:return e.abrupt("return",u6(t,null,null,o,r,a).renderAsync(t._scenegraph.root));case 5:case"end":return e.stop()}}),e)}))),h6.apply(this,arguments)}function p6(){return p6=(0,jt.Z)(w().mark((function e(t,n){var r;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t!==BK.Canvas&&t!==BK.SVG&&t!==BK.PNG&&ue("Unrecognized image type: "+t),e.next=3,d6(this,t,n);case 3:return r=e.sent,e.abrupt("return",t===BK.SVG?v6(r.svg(),"image/svg+xml"):r.canvas().toDataURL("image/png"));case 5:case"end":return e.stop()}}),e,this)}))),p6.apply(this,arguments)}function v6(e,t){var n=new Blob([e],{type:t});return window.URL.createObjectURL(n)}function m6(){return(m6=(0,jt.Z)(w().mark((function e(t,n){var r;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d6(this,BK.Canvas,t,n);case 2:return r=e.sent,e.abrupt("return",r.canvas());case 4:case"end":return e.stop()}}),e,this)})))).apply(this,arguments)}function g6(){return(g6=(0,jt.Z)(w().mark((function e(t){var n;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d6(this,BK.SVG,t);case 2:return n=e.sent,e.abrupt("return",n.svg());case 4:case"end":return e.stop()}}),e,this)})))).apply(this,arguments)}var y6="width",b6="height",x6="padding",w6={skip:!0};function k6(e,t){var n=e.autosize(),r=e.padding();return t-(n&&n.contains===x6?r.left+r.right:0)}function _6(e,t){var n=e.autosize(),r=e.padding();return t-(n&&n.contains===x6?r.top+r.bottom:0)}function S6(e,t){return t.modified&&_e(t.input.value)&&e.indexOf("_:vega:_")}function C6(e,t){return!("parent"===e||t instanceof ku.proxy)}function A6(e,t,n,r){var a=e.element();a&&a.setAttribute("title",function(e){return null==e?"":_e(e)?E6(e):Se(e)&&!vt(e)?(t=e,Object.keys(t).map((function(e){var n=t[e];return e+": "+(_e(n)?E6(n):N6(n))})).join("\n")):e+"";var t}(r))}function E6(e){return"["+e.map(N6).join(", ")+"]"}function N6(e){return _e(e)?"[\u2026]":Se(e)&&!vt(e)?"{\u2026}":e}function T6(e,t){var n=this;if(t=t||{},bu.call(n),t.loader&&n.loader(t.loader),t.logger&&n.logger(t.logger),null!=t.logLevel&&n.logLevel(t.logLevel),t.locale||e.locale){var r=at({},e.locale,t.locale);n.locale(RV(r.number,r.time))}n._el=null,n._elBind=null,n._renderType=t.renderer||BK.Canvas,n._scenegraph=new gX;var a=n._scenegraph.root;n._renderer=null,n._tooltip=t.tooltip||A6,n._redraw=!0,n._handler=(new WX).scene(a),n._globalCursor=!1,n._preventDefault=!1,n._timers=[],n._eventListeners=[],n._resizeListeners=[],n._eventConfig=function(e){var t=at({defaults:{}},e),n=function(e,t){t.forEach((function(t){_e(e[t])&&(e[t]=Ft(e[t]))}))};return n(t.defaults,["prevent","allow"]),n(t,["view","window","selector"]),t}(e.eventConfig),n.globalCursor(n._eventConfig.globalCursor);var i=function(e,t,n){return m5(e,ku,O4,n).parse(t)}(n,e,t.expr);n._runtime=i,n._signals=i.signals,n._bind=(e.bindings||[]).map((function(e){return{state:null,param:at({},e)}})),i.root&&i.root.set(a),a.source=i.data.root.input,n.pulse(i.data.root.input,n.changeset().insert(a.items)),n._width=n.width(),n._height=n.height(),n._viewWidth=k6(n,n._width),n._viewHeight=_6(n,n._height),n._origin=[0,0],n._resize=0,n._autosize=1,function(e){var t=e._signals,n=t.width,r=t.height,a=t.padding;function i(){e._autosize=e._resize=1}e._resizeWidth=e.add(null,(function(t){e._width=t.size,e._viewWidth=k6(e,t.size),i()}),{size:n}),e._resizeHeight=e.add(null,(function(t){e._height=t.size,e._viewHeight=_6(e,t.size),i()}),{size:r});var o=e.add(null,i,{pad:a});e._resizeWidth.rank=n.rank+1,e._resizeHeight.rank=r.rank+1,o.rank=a.rank+1}(n),function(e){e.add(null,(function(t){return e._background=t.bg,e._resize=1,t.bg}),{bg:e._signals.background})}(n),function(e){var t=e._signals.cursor||(e._signals.cursor=e.add({user:j5,item:null}));e.on(e.events("view","mousemove"),t,(function(e,n){var r=t.value,a=r?bt(r)?r:r.user:j5,i=n.item&&n.item.cursor||null;return r&&a===r.user&&i==r.item?r:{user:a,item:i}})),e.add(null,(function(t){var n=t.cursor,r=this.value;return bt(n)||(r=n.item,n=n.user),B5(e,n&&n!==j5?n:r||n),r}),{cursor:t})}(n),n.description(e.description),t.hover&&n.hover(),t.container&&n.initialize(t.container,t.bind)}function I6(e,t){return st(e._signals,t)?e._signals[t]:ue("Unrecognized signal name: "+Et(t))}function D6(e,t){var n=(e._targets||[]).filter((function(e){return e._update&&e._update.handler===t}));return n.length?n[0]:null}function F6(e,t,n,r){var a=D6(n,r);return a||((a=s6(e,(function(){return r(t,n.value)}))).handler=r,e.on(n,null,a)),e}function M6(e,t,n){var r=D6(t,n);return r&&t._targets.remove(r),e}dt(T6,bu,{evaluate:function(e,t,n){var r=this;return(0,jt.Z)(w().mark((function a(){return w().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,bu.prototype.evaluate.call(r,e,t);case 2:if(!r._redraw&&!r._resize){a.next=14;break}if(a.prev=3,!r._renderer){a.next=8;break}return r._resize&&(r._resize=0,W5(r)),a.next=8,r._renderer.renderAsync(r._scenegraph.root);case 8:r._redraw=!1,a.next=14;break;case 11:a.prev=11,a.t0=a.catch(3),r.error(a.t0);case 14:return n&&Fo(r,n),a.abrupt("return",r);case 16:case"end":return a.stop()}}),a,null,[[3,11]])})))()},dirty:function(e){this._redraw=!0,this._renderer&&this._renderer.dirty(e)},description:function(e){if(arguments.length){var t=null!=e?e+"":null;return t!==this._desc&&R5(this._el,this._desc=t),this}return this._desc},container:function(){return this._el},scenegraph:function(){return this._scenegraph},origin:function(){return this._origin.slice()},signal:function(e,t,n){var r=I6(this,e);return 1===arguments.length?r.value:this.update(r,t,n)},width:function(e){return arguments.length?this.signal("width",e):this.signal("width")},height:function(e){return arguments.length?this.signal("height",e):this.signal("height")},padding:function(e){return arguments.length?this.signal("padding",f6(e)):f6(this.signal("padding"))},autosize:function(e){return arguments.length?this.signal("autosize",e):this.signal("autosize")},background:function(e){return arguments.length?this.signal("background",e):this.signal("background")},renderer:function(e){return arguments.length?(ZK(e)||ue("Unrecognized renderer type: "+e),e!==this._renderType&&(this._renderType=e,this._resetRenderer()),this):this._renderType},tooltip:function(e){return arguments.length?(e!==this._tooltip&&(this._tooltip=e,this._resetRenderer()),this):this._tooltip},loader:function(e){return arguments.length?(e!==this._loader&&(bu.prototype.loader.call(this,e),this._resetRenderer()),this):this._loader},resize:function(){return this._autosize=1,this.touch(I6(this,"autosize"))},_resetRenderer:function(){this._renderer&&(this._renderer=null,this.initialize(this._el,this._elBind))},_resizeView:function(e,t,n,r,a,i){this.runAfter((function(o){var u=0;o._autosize=0,o.width()!==n&&(u=1,o.signal(y6,n,w6),o._resizeWidth.skip(!0)),o.height()!==r&&(u=1,o.signal(b6,r,w6),o._resizeHeight.skip(!0)),o._viewWidth!==e&&(o._resize=1,o._viewWidth=e),o._viewHeight!==t&&(o._resize=1,o._viewHeight=t),o._origin[0]===a[0]&&o._origin[1]===a[1]||(o._resize=1,o._origin=a),u&&o.run("enter"),i&&o.runAfter((function(e){return e.resize()}))}),!1,1)},addEventListener:function(e,t,n){var r=t;return n&&!1===n.trap||((r=s6(this,t)).raw=t),this._handler.on(e,r),this},removeEventListener:function(e,t){for(var n,r,a=this._handler.handlers(e),i=a.length;--i>=0;)if(r=a[i].type,n=a[i].handler,e===r&&(t===n||t===n.raw)){this._handler.off(r,n);break}return this},addResizeListener:function(e){var t=this._resizeListeners;return t.indexOf(e)<0&&t.push(e),this},removeResizeListener:function(e){var t=this._resizeListeners,n=t.indexOf(e);return n>=0&&t.splice(n,1),this},addSignalListener:function(e,t){return F6(this,e,I6(this,e),t)},removeSignalListener:function(e,t){return M6(this,I6(this,e),t)},addDataListener:function(e,t){return F6(this,e,z5(this,e).values,t)},removeDataListener:function(e,t){return M6(this,z5(this,e).values,t)},globalCursor:function(e){if(arguments.length){if(this._globalCursor!==!!e){var t=B5(this,null);this._globalCursor=!!e,t&&B5(this,t)}return this}return this._globalCursor},preventDefault:function(e){return arguments.length?(this._preventDefault=e,this):this._preventDefault},timer:function(e,t){this._timers.push(function(e,t,n){var r=new D5,a=t;return null==t?(r.restart(e,t,n),r):(r._restart=r.restart,r.restart=function(e,t,n){t=+t,n=null==n?T5():+n,r._restart((function i(o){o+=a,r._restart(i,a+=t,n),e(o)}),t,n)},r.restart(e,t,n),r)}((function(t){e({timestamp:Date.now(),elapsed:t})}),t))},events:function(e,t,n){var r,a=this,i=new Jo(n),o=function(n,r){a.runAsync(null,(function(){e===q5&&function(e,t){var n=e._eventConfig.defaults,r=n.prevent,a=n.allow;return!1!==r&&!0!==a&&(!0===r||!1===a||(r?r[t]:a?!a[t]:e.preventDefault()))}(a,t)&&n.preventDefault(),i.receive(V5(a,n,r))}))};if("timer"===e)X5(a,"timer",t)&&a.timer(o,t);else if(e===q5)X5(a,"view",t)&&a.addEventListener(t,o,G5);else if("window"===e?X5(a,"window",t)&&"undefined"!==typeof window&&(r=[window]):"undefined"!==typeof document&&X5(a,"selector",t)&&(r=document.querySelectorAll(e)),r){for(var u=0,s=r.length;u<s;++u)r[u].addEventListener(t,o);H5(a,r,t,o)}else a.warn("Can not resolve event source: "+e);return i},finalize:function(){var e,t,n,r=this._tooltip,a=this._timers,i=this._eventListeners;for(e=a.length;--e>=0;)a[e].stop();for(e=i.length;--e>=0;)for(t=(n=i[e]).sources.length;--t>=0;)n.sources[t].removeEventListener(n.type,n.handler);return r&&r.call(this,this._handler,null,null,null),this},hover:function(e,t){return t=[t||"update",(e=[e||"hover"])[0]],this.on(this.events("view","mouseover",K5),Y5,$5(e)),this.on(this.events("view","mouseout",K5),Y5,$5(t)),this},data:function(e,t){return arguments.length<2?z5(this,e).values.value:Z5.call(this,e,qo().remove(pe).insert(t))},change:Z5,insert:function(e,t){return Z5.call(this,e,qo().insert(t))},remove:function(e,t){return Z5.call(this,e,qo().remove(t))},scale:function(e){var t=this._runtime.scales;return st(t,e)||ue("Unrecognized scale or projection: "+e),t[e].value},initialize:function(e,t){var n=this,r=n._renderType,a=n._eventConfig.bind,i=ZK(r);e=n._el=e?c6(n,e,!0):null,function(e){var t=e.container();t&&(t.setAttribute("role","graphics-document"),t.setAttribute("aria-roleDescription","visualization"),R5(t,e.description()))}(n),i||n.error("Unrecognized renderer type: "+r);var o=i.handler||WX,u=e?i.renderer:i.headless;return n._renderer=u?u6(n,n._renderer,e,u):null,n._handler=function(e,t,n,r){var a=new r(e.loader(),s6(e,e.tooltip())).scene(e.scenegraph().root).initialize(n,U5(e),e);return t&&t.handlers().forEach((function(e){a.on(e.type,e.handler)})),a}(n,n._handler,e,o),n._redraw=!0,e&&"none"!==a&&(t=t?n._elBind=c6(n,t,!0):e.appendChild(Q5("form",{class:"vega-bindings"})),n._bind.forEach((function(e){e.param.element&&"container"!==a&&(e.element=c6(n,e.param.element,!!e.param.input))})),n._bind.forEach((function(e){!function(e,t,n){if(t){var r=n.param,a=n.state;a||(a=n.state={elements:null,active:!1,set:null,update:function(t){t!=e.signal(r.signal)&&e.runAsync(null,(function(){a.source=!0,e.signal(r.signal,t)}))}},r.debounce&&(a.update=rt(r.debounce,a.update))),(null==r.input&&r.element?J5:e6)(a,t,r,e),a.active||(e.on(e._signals[r.signal],null,(function(){a.source?a.source=!1:a.set(e.signal(r.signal))})),a.active=!0)}}(n,e.element||t,e)}))),n},toImageURL:function(e,t){return p6.apply(this,arguments)},toCanvas:function(e,t){return m6.apply(this,arguments)},toSVG:function(e){return g6.apply(this,arguments)},getState:function(e){return this._runtime.getState(e||{data:S6,signals:C6,recurse:!0})},setState:function(e){return this.runAsync(null,(function(t){t._trigger=!1,t._runtime.setState(e)}),(function(e){e._trigger=!0})),this}});var O6,R6,j6="[",B6="]",z6=/[[\]{}]/,Z6={"*":1,arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1};function L6(e,t,n,r,a){for(var i,o=e.length,u=0;t<o;++t){if(i=e[t],!u&&i===n)return t;a&&a.indexOf(i)>=0?--u:r&&r.indexOf(i)>=0&&++u}return t}function P6(e){for(var t=[],n=e.length,r=0,a=0;a<n;)a=L6(e,a,",","[{","]}"),t.push(e.substring(r,a).trim()),r=++a;if(0===t.length)throw"Empty event selector: "+e;return t}function U6(e){return"["===e[0]?function(e){var t,n=e.length,r=1;if((r=L6(e,r,B6,j6,B6))===n)throw"Empty between selector: "+e;if(2!==(t=P6(e.substring(1,r))).length)throw"Between selector must have two elements: "+e;if(">"!==(e=e.slice(r+1).trim())[0])throw"Expected '>' after between selector: "+e;t=t.map(U6);var a=U6(e.slice(1).trim());if(a.between)return{between:t,stream:a};a.between=t;return a}(e):function(e){var t,n,r={source:O6},a=[],i=[0,0],o=0,u=0,s=e.length,c=0;if("}"===e[s-1]){if(!((c=e.lastIndexOf("{"))>=0))throw"Unmatched right brace: "+e;try{i=function(e){var t=e.split(",");if(!e.length||t.length>2)throw e;return t.map((function(t){var n=+t;if(n!==n)throw e;return n}))}(e.substring(c+1,s-1))}catch(l){throw"Invalid throttle specification: "+e}s=(e=e.slice(0,c).trim()).length,c=0}if(!s)throw e;"@"===e[0]&&(o=++c);(t=L6(e,c,":"))<s&&(a.push(e.substring(u,t).trim()),u=c=++t);if((c=L6(e,c,j6))===s)a.push(e.substring(u,s).trim());else if(a.push(e.substring(u,c).trim()),n=[],(u=++c)===s)throw"Unmatched left bracket: "+e;for(;c<s;){if((c=L6(e,c,B6))===s)throw"Unmatched left bracket: "+e;if(n.push(e.substring(u,c).trim()),c<s-1&&e[++c]!==j6)throw"Expected left bracket: "+e;u=++c}if(!(s=a.length)||z6.test(a[s-1]))throw"Invalid event selector: "+e;s>1?(r.type=a[1],o?r.markname=a[0].slice(1):!function(e){return R6[e]}(a[0])?r.source=a[0]:r.marktype=a[0]):r.type=a[0];"!"===r.type.slice(-1)&&(r.consume=!0,r.type=r.type.slice(0,-1));null!=n&&(r.filter=n);i[0]&&(r.throttle=i[0]);i[1]&&(r.debounce=i[1]);return r}(e)}function W6(e){return Se(e)?e:{type:e||"pad"}}var V6=function(e){return+e||0};function q6(e){return Se(e)?e.signal?e:{top:V6(e.top),bottom:V6(e.bottom),left:V6(e.left),right:V6(e.right)}:{top:t=V6(e),bottom:t,left:t,right:t};var t}var G6=function(e){return Se(e)&&!_e(e)?at({},e):{value:e}};function H6(e,t,n,r){return null!=n?(Se(n)&&!_e(n)||_e(n)&&n.length&&Se(n[0])?e.update[t]=n:e[r||"enter"][t]={value:n},1):0}function X6(e,t,n){for(var r in t)H6(e,r,t[r]);for(var a in n)H6(e,a,n[a],"update")}function K6(e,t,n){for(var r in t)n&&st(n,r)||(e[r]=at(e[r]||{},t[r]));return e}function Y6(e,t){return t&&(t.enter&&t.enter[e]||t.update&&t.update[e])}var $6="mark",Q6="frame",J6="scope",e8="legend-label",t8="title-text",n8="title-subtitle";function r8(e,t,n){e[t]=n&&n.signal?{signal:n.signal}:{value:n}}var a8=function(e){return bt(e)?Et(e):e.signal?"(".concat(e.signal,")"):s8(e)};function i8(e){if(null!=e.gradient)return function(e){var t=[e.start,e.stop,e.count].map((function(e){return null==e?null:Et(e)}));for(;t.length&&null==Te(t);)t.pop();return t.unshift(a8(e.gradient)),"gradient(".concat(t.join(","),")")}(e);var t=e.signal?"(".concat(e.signal,")"):e.color?function(e){return e.c?o8("hcl",e.h,e.c,e.l):e.h||e.s?o8("hsl",e.h,e.s,e.l):e.l||e.a?o8("lab",e.l,e.a,e.b):e.r||e.g||e.b?o8("rgb",e.r,e.g,e.b):null}(e.color):null!=e.field?s8(e.field):void 0!==e.value?Et(e.value):void 0;return null!=e.scale&&(t=function(e,t){var n=a8(e.scale);null!=e.range?t="lerp(_range(".concat(n,"), ").concat(+e.range,")"):(void 0!==t&&(t="_scale(".concat(n,", ").concat(t,")")),e.band&&(t=(t?t+"+":"")+"_bandwidth(".concat(n,")")+(1===+e.band?"":"*"+u8(e.band)),e.extra&&(t="(datum.extra ? _scale(".concat(n,", datum.extra.value) : ").concat(t,")"))),null==t&&(t="0"));return t}(e,t)),void 0===t&&(t=null),null!=e.exponent&&(t="pow(".concat(t,",").concat(u8(e.exponent),")")),null!=e.mult&&(t+="*".concat(u8(e.mult))),null!=e.offset&&(t+="+".concat(u8(e.offset))),e.round&&(t="round(".concat(t,")")),t}var o8=function(e,t,n,r){return"(".concat(e,"(").concat([t,n,r].map(i8).join(","),")+'')")};function u8(e){return Se(e)?"("+i8(e)+")":e}function s8(e){return c8(Se(e)?e:{datum:e})}function c8(e){var t,n,r;if(e.signal)t="datum",r=e.signal;else if(e.group||e.parent){for(n=Math.max(1,e.level||1),t="item";n-- >0;)t+=".mark.group";e.parent?(r=e.parent,t+=".datum"):r=e.group}else e.datum?(t="datum",r=e.datum):ue("Invalid field reference: "+Et(e));return e.signal||(r=bt(r)?se(r).map(Et).join("]["):c8(r)),t+"["+r+"]"}function l8(e,t,n,r,a,i){var o={};for(var u in(i=i||{}).encoders={$encode:o},e=function(e,t,n,r,a){var i,o,u,s={},c={};for(o in o="lineBreak","text"!==t||null==a[o]||Y6(o,e)||r8(s,o,a[o]),("legend"==n||String(n).startsWith("axis"))&&(n=null),u=n===Q6?a.group:n===$6?at({},a.mark,a[t]):null)Y6(o,e)||("fill"===o||"stroke"===o)&&(Y6("fill",e)||Y6("stroke",e))||r8(s,o,u[o]);for(o in Xe(r).forEach((function(t){var n=a.style&&a.style[t];for(var r in n)Y6(r,e)||r8(s,r,n[r])})),e=at({},e),s)(u=s[o]).signal?(i=i||{})[o]=u:c[o]=u;return e.enter=at(c,e.enter),i&&(e.update=at(i,e.update)),e}(e,t,n,r,a.config),e)o[u]=f8(e[u],t,i,a);return i}function f8(e,t,n,r){var a,i={},o={};for(var u in e)null!=e[u]&&(i[u]=d8((a=e[u],_e(a)?function(e){var t="";return e.forEach((function(e){var n=i8(e);t+=e.test?"(".concat(e.test,")?").concat(n,":"):n})),":"===Te(t)&&(t+="null"),t}(a):i8(a)),r,n,o));return{$expr:{marktype:t,channels:i},$fields:Object.keys(o),$output:Object.keys(e)}}function d8(e,t,n,r){var a=P4(e,t);return a.$fields.forEach((function(e){return r[e]=1})),at(n,a.$params),a.$expr}var h8=["value","update","init","react","bind"];function p8(e,t){ue(e+' for "outer" push: '+Et(t))}function v8(e,t){var n=e.name;if("outer"===e.push)t.signals[n]||p8("No prior signal definition",n),h8.forEach((function(t){void 0!==e[t]&&p8("Invalid property ",t)}));else{var r=t.addSignal(n,e.value);!1===e.react&&(r.react=!1),e.bind&&t.addBinding(n,e.bind)}}function m8(e,t,n,r){this.id=-1,this.type=e,this.value=t,this.params=n,r&&(this.parent=r)}function g8(e,t,n,r){return new m8(e,t,n,r)}function y8(e,t){return g8("operator",e,t)}function b8(e){var t={$ref:e.id};return e.id<0&&(e.refs=e.refs||[]).push(t),t}function x8(e,t){return t?{$field:e,$name:t}:{$field:e}}var w8=x8("key");function k8(e,t){return{$compare:e,$order:t}}function _8(e,t){return(e&&e.signal?"$"+e.signal:e||"")+(e&&t?"_":"")+(t&&t.signal?"$"+t.signal:t||"")}var S8="scope",C8="view";function A8(e){return e&&e.signal}function E8(e){if(A8(e))return!0;if(Se(e))for(var t in e)if(E8(e[t]))return!0;return!1}function N8(e,t){return null!=e?e:t}function T8(e){return e&&e.signal||e}var I8="timer";function D8(e,t){return(e.merge?F8:e.stream?M8:e.type?O8:ue("Invalid stream specification: "+Et(e)))(e,t)}function F8(e,t){var n=e.merge.map((function(e){return D8(e,t)})),r=R8({merge:n},e,t);return t.addStream(r).id}function M8(e,t){var n=R8({stream:D8(e.stream,t)},e,t);return t.addStream(n).id}function O8(e,t){var n;e.type===I8?(n=t.event(I8,e.throttle),e={between:e.between,filter:e.filter}):n=t.event(function(e){return e===S8?C8:e||C8}(e.source),e.type);var r=R8({stream:n},e,t);return 1===Object.keys(r).length?n:t.addStream(r).id}function R8(e,t,n){var r=t.between;return r&&(2!==r.length&&ue('Stream "between" parameter must have 2 entries: '+Et(t)),e.between=[D8(r[0],n),D8(r[1],n)]),r=t.filter?[].concat(t.filter):[],(t.marktype||t.markname||t.markrole)&&r.push(function(e,t,n){var r="event.item";return r+(e&&"*"!==e?"&&"+r+".mark.marktype==='"+e+"'":"")+(n?"&&"+r+".mark.role==='"+n+"'":"")+(t?"&&"+r+".mark.name==='"+t+"'":"")}(t.marktype,t.markname,t.markrole)),t.source===S8&&r.push("inScope(event.item)"),r.length&&(e.filter=P4("("+r.join(")&&(")+")",n).$expr),null!=(r=t.throttle)&&(e.throttle=+r),null!=(r=t.debounce)&&(e.debounce=+r),t.consume&&(e.consume=!0),e}var j8={code:"_.$value",ast:{type:"Identifier",value:"value"}};function B8(e,t,n){var r=e.encode,a={target:n},i=e.events,o=e.update,u=[];i||ue("Signal update missing events specification."),bt(i)&&(i=function(e,t,n){return O6=t||"view",R6=n||Z6,P6(e.trim()).map(U6)}(i,t.isSubscope()?S8:C8)),i=Xe(i).filter((function(e){return e.signal||e.scale?(u.push(e),0):1})),u.length>1&&(u=[z8(u)]),i.length&&u.push(i.length>1?{merge:i}:i[0]),null!=r&&(o&&ue("Signal encode and update are mutually exclusive."),o="encode(item(),"+Et(r)+")"),a.update=bt(o)?P4(o,t):null!=o.expr?P4(o.expr,t):null!=o.value?o.value:null!=o.signal?{$expr:j8,$params:{$value:t.signalRef(o.signal)}}:ue("Invalid signal update specification."),e.force&&(a.options={force:!0}),u.forEach((function(e){return t.addUpdate(at(function(e,t){return{source:e.signal?t.signalRef(e.signal):e.scale?t.scaleRef(e.scale):D8(e,t)}}(e,t),a))}))}function z8(e){return{signal:"["+e.map((function(e){return e.scale?'scale("'+e.scale+'")':e.signal}))+"]"}}var Z8=function(e){return function(t,n,r){return g8(e,n,t||void 0,r)}},L8=Z8("aggregate"),P8=Z8("axisticks"),U8=Z8("bound"),W8=Z8("collect"),V8=Z8("compare"),q8=Z8("datajoin"),G8=Z8("encode"),H8=Z8("expression"),X8=Z8("facet"),K8=Z8("field"),Y8=Z8("key"),$8=Z8("legendentries"),Q8=Z8("load"),J8=Z8("mark"),e7=Z8("multiextent"),t7=Z8("multivalues"),n7=Z8("overlap"),r7=Z8("params"),a7=Z8("prefacet"),i7=Z8("projection"),o7=Z8("proxy"),u7=Z8("relay"),s7=Z8("render"),c7=Z8("scale"),l7=Z8("sieve"),f7=Z8("sortitems"),d7=Z8("viewlayout"),h7=Z8("values"),p7=0,v7={min:"min",max:"max",count:"sum"};function m7(e,t){var n,r=t.getScale(e.name).params;for(n in r.domain=x7(e.domain,e,t),null!=e.range&&(r.range=N7(e,t,r)),null!=e.interpolate&&function(e,t){t.interpolate=g7(e.type||e),null!=e.gamma&&(t.interpolateGamma=g7(e.gamma))}(e.interpolate,r),null!=e.nice&&(r.nice=function(e){return Se(e)?{interval:g7(e.interval),step:g7(e.step)}:g7(e)}(e.nice)),null!=e.bins&&(r.bins=function(e,t){return e.signal||_e(e)?y7(e,t):t.objectProperty(e)}(e.bins,t)),e)st(r,n)||"name"===n||(r[n]=g7(e[n],t))}function g7(e,t){return Se(e)?e.signal?t.signalRef(e.signal):ue("Unsupported object: "+Et(e)):e}function y7(e,t){return e.signal?t.signalRef(e.signal):e.map((function(e){return g7(e,t)}))}function b7(e){ue("Can not find data set: "+Et(e))}function x7(e,t,n){if(e)return e.signal?n.signalRef(e.signal):(_e(e)?w7:e.fields?_7:k7)(e,t,n);null==t.domainMin&&null==t.domainMax||ue("No scale domain defined for domainMin/domainMax to override.")}function w7(e,t,n){return e.map((function(e){return g7(e,n)}))}function k7(e,t,n){var r=n.getData(e.data);return r||b7(e.data),CI(t.type)?r.valuesRef(n,e.field,C7(e.sort,!1)):TI(t.type)?r.domainRef(n,e.field):r.extentRef(n,e.field)}function _7(e,t,n){var r=e.data,a=e.fields.reduce((function(e,t){return t=bt(t)?{data:r,field:t}:_e(t)||t.signal?function(e,t){var n="_:vega:_"+p7++,r=W8({});if(_e(e))r.value={$ingest:e};else if(e.signal){var a="setdata("+Et(n)+","+e.signal+")";r.params.input=t.signalRef(a)}return t.addDataPipeline(n,[r,l7({})]),{data:n,field:"data"}}(t,n):t,e.push(t),e}),[]);return(CI(t.type)?S7:TI(t.type)?A7:E7)(e,n,a)}function S7(e,t,n){var r,a,i=C7(e.sort,!0),o=n.map((function(e){var n=t.getData(e.data);return n||b7(e.data),n.countsRef(t,e.field,i)})),u={groupby:w8,pulse:o};i&&(r=i.op||"count",a=i.field?_8(r,i.field):"count",u.ops=[v7[r]],u.fields=[t.fieldRef(a)],u.as=[a]),r=t.add(L8(u));var s=t.add(W8({pulse:b8(r)}));return a=t.add(h7({field:w8,sort:t.sortRef(i),pulse:b8(s)})),b8(a)}function C7(e,t){return e&&(e.field||e.op?e.field||"count"===e.op?t&&e.field&&e.op&&!v7[e.op]&&ue("Multiple domain scales can not be sorted using "+e.op):ue("No field provided for sort aggregate op: "+e.op):Se(e)?e.field="key":e={field:"key"}),e}function A7(e,t,n){var r=n.map((function(e){var n=t.getData(e.data);return n||b7(e.data),n.domainRef(t,e.field)}));return b8(t.add(t7({values:r})))}function E7(e,t,n){var r=n.map((function(e){var n=t.getData(e.data);return n||b7(e.data),n.extentRef(t,e.field)}));return b8(t.add(e7({extents:r})))}function N7(e,t,n){var r=t.config.range,a=e.range;if(a.signal)return t.signalRef(a.signal);if(bt(a)){if(r&&st(r,a))return N7(e=at({},e,{range:r[a]}),t,n);"width"===a?a=[0,{signal:"width"}]:"height"===a?a=CI(e.type)?[0,{signal:"height"}]:[{signal:"height"},0]:ue("Unrecognized scale range value: "+Et(a))}else{if(a.scheme)return n.scheme=_e(a.scheme)?y7(a.scheme,t):g7(a.scheme,t),a.extent&&(n.schemeExtent=y7(a.extent,t)),void(a.count&&(n.schemeCount=g7(a.count,t)));if(a.step)return void(n.rangeStep=g7(a.step,t));if(CI(e.type)&&!_e(a))return x7(a,e,t);_e(a)||ue("Unsupported range type: "+Et(a))}return a.map((function(e){return(_e(e)?y7:g7)(e,t)}))}function T7(e,t,n){return _e(e)?e.map((function(e){return T7(e,t,n)})):Se(e)?e.signal?n.signalRef(e.signal):"fit"===t?e:ue("Unsupported parameter object: "+Et(e)):e}var I7="top",D7="left",F7="right",M7="bottom",O7="center",R7="index",j7="label",B7="perc",z7="value",Z7="guide-label",L7="guide-title",P7="group-title",U7="group-subtitle",W7="symbol",V7="gradient",q7="discrete",G7="size",H7=[G7,"shape","fill","stroke","strokeWidth","strokeDash","opacity"],X7={name:1,style:1,interactive:1},K7={value:0},Y7={value:1},$7="group",Q7="rect",J7="rule",e9="text";function t9(e){return e.type=$7,e.interactive=e.interactive||!1,e}function n9(e,t){var n=function(n,r){return N8(e[n],N8(t[n],r))};return n.isVertical=function(n){return"vertical"===N8(e.direction,t.direction||(n?t.symbolDirection:t.gradientDirection))},n.gradientLength=function(){return N8(e.gradientLength,t.gradientLength||t.gradientWidth)},n.gradientThickness=function(){return N8(e.gradientThickness,t.gradientThickness||t.gradientHeight)},n.entryColumns=function(){return N8(e.columns,N8(t.columns,+n.isVertical(!0)))},n}function r9(e,t){var n=t&&(t.update&&t.update[e]||t.enter&&t.enter[e]);return n&&n.signal?n:n?n.value:null}function a9(e,t,n){return"item.anchor === '".concat("start","' ? ").concat(e," : item.anchor === '").concat("end","' ? ").concat(t," : ").concat(n)}var i9=a9(Et(D7),Et(F7),Et(O7));function o9(e,t){return t?e?Se(e)?Object.assign({},e,{offset:o9(e.offset,t)}):{value:e,offset:t}:t:e}function u9(e,t){return t?(e.name=t.name,e.style=t.style||e.style,e.interactive=!!t.interactive,e.encode=K6(e.encode,t,X7)):e.interactive=!1,e}function s9(e,t,n,r){var a,i,o,u,s,c=n9(e,n),l=c.isVertical(),f=c.gradientThickness(),d=c.gradientLength();l?(i=[0,1],o=[0,0],u=f,s=d):(i=[0,0],o=[1,0],u=d,s=f);var h={enter:a={opacity:K7,x:K7,y:K7,width:G6(u),height:G6(s)},update:at({},a,{opacity:Y7,fill:{gradient:t,start:i,stop:o}}),exit:{opacity:K7}};return X6(h,{stroke:c("gradientStrokeColor"),strokeWidth:c("gradientStrokeWidth")},{opacity:c("gradientOpacity")}),u9({type:Q7,role:"legend-gradient",encode:h},r)}function c9(e,t,n,r,a){var i,o,u,s,c=n9(e,n),l=c.isVertical(),f=c.gradientThickness(),d=c.gradientLength(),h="";l?(i="y",u="y2",o="x",s="width",h="1-"):(i="x",u="x2",o="y",s="height");var p={opacity:K7,fill:{scale:t,field:z7}};p[i]={signal:h+"datum."+B7,mult:d},p[o]=K7,p[u]={signal:h+"datum.perc2",mult:d},p[s]=G6(f);var v={enter:p,update:at({},p,{opacity:Y7}),exit:{opacity:K7}};return X6(v,{stroke:c("gradientStrokeColor"),strokeWidth:c("gradientStrokeWidth")},{opacity:c("gradientOpacity")}),u9({type:Q7,role:"legend-band",key:z7,from:a,encode:v},r)}var l9="datum.".concat(B7,'<=0?"').concat(D7,'":datum.').concat(B7,'>=1?"').concat(F7,'":"').concat(O7,'"'),f9="datum.".concat(B7,'<=0?"').concat(M7,'":datum.').concat(B7,'>=1?"').concat(I7,'":"').concat("middle",'"');function d9(e,t,n,r){var a,i,o,u,s=n9(e,t),c=s.isVertical(),l=G6(s.gradientThickness()),f=s.gradientLength(),d=s("labelOverlap"),h="",p={enter:a={opacity:K7},update:i={opacity:Y7,text:{field:j7}},exit:{opacity:K7}};return X6(p,{fill:s("labelColor"),fillOpacity:s("labelOpacity"),font:s("labelFont"),fontSize:s("labelFontSize"),fontStyle:s("labelFontStyle"),fontWeight:s("labelFontWeight"),limit:N8(e.labelLimit,t.gradientLabelLimit)}),c?(a.align={value:"left"},a.baseline=i.baseline={signal:f9},o="y",u="x",h="1-"):(a.align=i.align={signal:l9},a.baseline={value:"top"},o="x",u="y"),a[o]=i[o]={signal:h+"datum."+B7,mult:f},a[u]=i[u]=l,l.offset=N8(e.labelOffset,t.gradientLabelOffset)||0,d=d?{separation:s("labelSeparation"),method:d,order:"datum.index"}:void 0,u9({type:e9,role:e8,style:Z7,key:z7,from:r,encode:p,overlap:d},n)}function h9(e,t,n,r,a){var i,o,u,s,c,l=n9(e,t),f=n.entries,d=!(!f||!f.interactive),h=f?f.name:void 0,p=l("clipHeight"),v=l("symbolOffset"),m={data:"value"},g="(".concat(a,") ? datum.").concat("offset"," : datum.").concat(G7),y=p?G6(p):{field:G7},b="datum.".concat(R7),x="max(1, ".concat(a,")");y.mult=.5,i={enter:o={opacity:K7,x:{signal:g,mult:.5,offset:v},y:y},update:u={opacity:Y7,x:o.x,y:o.y},exit:{opacity:K7}};var w=null,k=null;e.fill||(w=t.symbolBaseFillColor,k=t.symbolBaseStrokeColor),X6(i,{fill:l("symbolFillColor",w),shape:l("symbolType"),size:l("symbolSize"),stroke:l("symbolStrokeColor",k),strokeDash:l("symbolDash"),strokeDashOffset:l("symbolDashOffset"),strokeWidth:l("symbolStrokeWidth")},{opacity:l("symbolOpacity")}),H7.forEach((function(t){e[t]&&(u[t]=o[t]={scale:e[t],field:z7})}));var _=u9({type:"symbol",role:"legend-symbol",key:z7,from:m,clip:!!p||void 0,encode:i},n.symbols),S=G6(v);S.offset=l("labelOffset"),X6(i={enter:o={opacity:K7,x:{signal:g,offset:S},y:y},update:u={opacity:Y7,text:{field:j7},x:o.x,y:o.y},exit:{opacity:K7}},{align:l("labelAlign"),baseline:l("labelBaseline"),fill:l("labelColor"),fillOpacity:l("labelOpacity"),font:l("labelFont"),fontSize:l("labelFontSize"),fontStyle:l("labelFontStyle"),fontWeight:l("labelFontWeight"),limit:l("labelLimit")});var C=u9({type:e9,role:e8,style:Z7,key:z7,from:m,encode:i},n.labels);return i={enter:{noBound:{value:!p},width:K7,height:p?G6(p):K7,opacity:K7},exit:{opacity:K7},update:u={opacity:Y7,row:{signal:null},column:{signal:null}}},l.isVertical(!0)?(s="ceil(item.mark.items.length / ".concat(x,")"),u.row.signal="".concat(b,"%").concat(s),u.column.signal="floor(".concat(b," / ").concat(s,")"),c={field:["row",b]}):(u.row.signal="floor(".concat(b," / ").concat(x,")"),u.column.signal="".concat(b," % ").concat(x),c={field:b}),u.column.signal="(".concat(a,")?").concat(u.column.signal,":").concat(b),t9({role:J6,from:r={facet:{data:r,name:"value",groupby:R7}},encode:K6(i,f,X7),marks:[_,C],name:h,interactive:d,sort:c})}var p9='item.orient === "left"',v9='item.orient === "right"',m9="(".concat(p9," || ").concat(v9,")"),g9="datum.vgrad && ".concat(m9),y9=a9('"top"','"bottom"','"middle"'),b9=a9('"right"','"left"','"center"'),x9="datum.vgrad && ".concat(v9," ? (").concat(b9,") : (").concat(m9," && !(datum.vgrad && ").concat(p9,')) ? "left" : ').concat(i9),w9="item._anchor || (".concat(m9,' ? "middle" : "start")'),k9="".concat(g9," ? (").concat(p9," ? -90 : 90) : 0"),_9="".concat(m9," ? (datum.vgrad ? (").concat(v9,' ? "bottom" : "top") : ').concat(y9,') : "top"');function S9(e,t){var n;return Se(e)&&(e.signal?n=e.signal:e.path?n="pathShape("+C9(e.path)+")":e.sphere&&(n="geoShape("+C9(e.sphere)+', {type: "Sphere"})')),n?t.signalRef(n):!!e}function C9(e){return Se(e)&&e.signal?e.signal:Et(e)}function A9(e){var t=e.role||"";return t.indexOf("axis")&&t.indexOf("legend")&&t.indexOf("title")?e.type===$7?J6:t||$6:t}function E9(e){return{marktype:e.type,name:e.name||void 0,role:e.role||A9(e),zindex:+e.zindex||void 0,aria:e.aria,description:e.description}}function N9(e,t){return e&&e.signal?t.signalRef(e.signal):!1!==e}function T9(e,t){var n=_u(e.type);n||ue("Unrecognized transform type: "+Et(e.type));var r=g8(n.type.toLowerCase(),null,I9(n,e,t));return e.signal&&t.addSignal(e.signal,t.proxy(r)),r.metadata=n.metadata||{},r}function I9(e,t,n){for(var r={},a=e.params.length,i=0;i<a;++i){var o=e.params[i];r[o.name]=D9(o,t,n)}return r}function D9(e,t,n){var r=e.type,a=t[e.name];return"index"===r?function(e,t,n){bt(t.from)||ue('Lookup "from" parameter must be a string literal.');return n.getData(t.from).lookupRef(n,t.key)}(0,t,n):void 0!==a?"param"===r?function(e,t,n){var r=t[e.name];return e.array?(_e(r)||ue("Expected an array of sub-parameters. Instead: "+Et(r)),r.map((function(t){return M9(e,t,n)}))):M9(e,r,n)}(e,t,n):"projection"===r?n.projectionRef(t[e.name]):e.array&&!A8(a)?a.map((function(t){return F9(e,t,n)})):F9(e,a,n):void(e.required&&ue("Missing required "+Et(t.type)+" parameter: "+Et(e.name)))}function F9(e,t,n){var r=e.type;if(A8(t))return B9(r)?ue("Expression references can not be signals."):z9(r)?n.fieldRef(t):Z9(r)?n.compareRef(t):n.signalRef(t.signal);var a=e.expr||z9(r);return a&&O9(t)?n.exprRef(t.expr,t.as):a&&R9(t)?x8(t.field,t.as):B9(r)?P4(t,n):j9(r)?b8(n.getData(t).values):z9(r)?x8(t):Z9(r)?n.compareRef(t):t}function M9(e,t,n){for(var r,a=e.params.length,i=0;i<a;++i){for(var o in(r=e.params[i]).key)if(r.key[o]!==t[o]){r=null;break}if(r)break}r||ue("Unsupported parameter: "+Et(t));var u=at(I9(r,t,n),r.key);return b8(n.add(r7(u)))}var O9=function(e){return e&&e.expr},R9=function(e){return e&&e.field},j9=function(e){return"data"===e},B9=function(e){return"expr"===e},z9=function(e){return"field"===e},Z9=function(e){return"compare"===e};function L9(e,t){return e.$ref?e:e.data&&e.data.$ref?e.data:b8(t.getData(e.data).output)}function P9(e,t,n,r,a){this.scope=e,this.input=t,this.output=n,this.values=r,this.aggregate=a,this.index={}}function U9(e){return bt(e)?e:null}function W9(e,t,n){var r,a=_8(n.op,n.field);if(t.ops){for(var i=0,o=t.as.length;i<o;++i)if(t.as[i]===a)return}else t.ops=["count"],t.fields=[null],t.as=["count"];n.op&&(t.ops.push((r=n.op.signal)?e.signalRef(r):n.op),t.fields.push(e.fieldRef(n.field)),t.as.push(a))}function V9(e,t,n,r,a,i,o){var u,s,c=t[n]||(t[n]={}),l=function(e){return Se(e)?("descending"===e.order?"-":"+")+_8(e.op,e.field):""}(i),f=U9(a);if(null!=f&&(e=t.scope,u=c[f+=l?"|"+l:""]),!u){var d=i?{field:w8,pulse:t.countsRef(e,a,i)}:{field:e.fieldRef(a),pulse:b8(t.output)};l&&(d.sort=e.sortRef(i)),s=e.add(g8(r,void 0,d)),o&&(t.index[a]=s),u=b8(s),null!=f&&(c[f]=u)}return u}function q9(e,t,n){var r=e.remove,a=e.insert,i=e.toggle,o=e.modify,u=e.values,s=t.add(y8()),c=P4("if("+e.trigger+',modify("'+n+'",'+[a,r,i,o,u].map((function(e){return null==e?"null":e})).join(",")+"),0)",t);s.update=c.$expr,s.params=c.$params}function G9(e,t){var n,r,a,i,o,u,s,c=A9(e),l=e.type===$7,f=e.from&&e.from.facet,d=e.overlap,h=e.layout||c===J6||c===Q6,p=c===$6||h||f,v=function(e,t,n){var r,a,i,o,u;return e?(r=e.facet)&&(t||ue("Only group marks can be faceted."),null!=r.field?o=u=L9(r,n):(e.data?u=b8(n.getData(e.data).aggregate):((i=T9(at({type:"aggregate",groupby:Xe(r.groupby)},r.aggregate),n)).params.key=n.keyRef(r.groupby),i.params.pulse=L9(r,n),o=u=b8(n.add(i))),a=n.keyRef(r.groupby,!0))):o=b8(n.add(W8(null,[{}]))),o||(o=L9(e,n)),{key:a,pulse:o,parent:u}}(e.from,l,t),m=b8(r=t.add(q8({key:v.key||(e.key?x8(e.key):void 0),pulse:v.pulse,clean:!l})));r=a=t.add(W8({pulse:m})),r=t.add(J8({markdef:E9(e),interactive:N9(e.interactive,t),clip:S9(e.clip,t),context:{$context:!0},groups:t.lookup(),parent:t.signals.parent?t.signalRef("parent"):null,index:t.markpath(),pulse:b8(r)}));var g=b8(r);(r=i=t.add(G8(l8(e.encode,e.type,c,e.style,t,{mod:!1,pulse:g})))).params.parent=t.encode(),e.transform&&e.transform.forEach((function(e){var n=T9(e,t),a=n.metadata;(a.generates||a.changes)&&ue("Mark transforms should not generate new data."),a.nomod||(i.params.mod=!0),n.params.pulse=b8(r),t.add(r=n)})),e.sort&&(r=t.add(f7({sort:t.compareRef(e.sort),pulse:b8(r)})));var y=b8(r);(f||h)&&(u=b8(h=t.add(d7({layout:t.objectProperty(e.layout),legends:t.legends,mark:g,pulse:y}))));var b=t.add(U8({mark:g,pulse:u||y}));s=b8(b),l&&(p&&((n=t.operators).pop(),h&&n.pop()),t.pushState(y,u||s,m),f?function(e,t,n){var r,a=e.from.facet,i=a.name,o=L9(a,t);a.name||ue("Facet must have a name: "+Et(a)),a.data||ue("Facet must reference a data set: "+Et(a)),a.field?r=t.add(a7({field:t.fieldRef(a.field),pulse:o})):a.groupby?r=t.add(X8({key:t.keyRef(a.groupby),group:b8(t.proxy(n.parent)),pulse:o})):ue("Facet must specify groupby or field: "+Et(a));var u=t.fork(),s=u.add(W8()),c=u.add(l7({pulse:b8(s)}));u.addData(i,new P9(u,s,s,c)),u.addSignal("parent",null),r.params.subflow={$subflow:u.parse(e).toRuntime()}}(e,t,v):p?function(e,t,n){var r=t.add(a7({pulse:n.pulse})),a=t.fork();a.add(l7()),a.addSignal("parent",null),r.params.subflow={$subflow:a.parse(e).toRuntime()}}(e,t,v):t.parse(e),t.popState(),p&&(h&&n.push(h),n.push(b))),d&&(s=function(e,t,n){var r=e.method,a=e.bound,i=e.separation,o={separation:A8(i)?n.signalRef(i.signal):i,method:A8(r)?n.signalRef(r.signal):r,pulse:t};e.order&&(o.sort=n.compareRef({field:e.order}));if(a){var u=a.tolerance;o.boundTolerance=A8(u)?n.signalRef(u.signal):+u,o.boundScale=n.scaleRef(a.scale),o.boundOrient=a.orient}return b8(n.add(n7(o)))}(d,s,t));var x=t.add(s7({pulse:s})),w=t.add(l7({pulse:b8(x)},void 0,t.parent()));null!=e.name&&(o=e.name,t.addData(o,new P9(t,a,x,w)),e.on&&e.on.forEach((function(e){(e.insert||e.remove||e.toggle)&&ue("Marks only support modify triggers."),q9(e,t,o)})))}function H9(e,t){var n,r,a,i=t.config.legend,o=e.encode||{},u=n9(e,i),s=o.legend||{},c=s.name||void 0,l=s.interactive,f=s.style,d={},h=0;H7.forEach((function(t){return e[t]?(d[t]=e[t],h=h||e[t]):0})),h||ue("Missing valid scale for legend.");var p=function(e,t){var n=e.type||W7;e.type||1!==function(e){return H7.reduce((function(t,n){return t+(e[n]?1:0)}),0)}(e)||!e.fill&&!e.stroke||(n=SI(t)?V7:AI(t)?q7:W7);return n!==V7?n:AI(t)?q7:V7}(e,t.scaleType(h)),v={title:null!=e.title,scales:d,type:p,vgrad:"symbol"!==p&&u.isVertical()},m=b8(t.add(W8(null,[v]))),g=b8(t.add($8(r={type:p,scale:t.scaleRef(h),count:t.objectProperty(u("tickCount")),limit:t.property(u("symbolLimit")),values:t.objectProperty(e.values),minstep:t.property(e.tickMinStep),formatType:t.property(e.formatType),formatSpecifier:t.property(e.format)})));return p===V7?(a=[s9(e,h,i,o.gradient),d9(e,i,o.labels,g)],r.count=r.count||t.signalRef("max(2,2*floor((".concat(T8(u.gradientLength()),")/100))"))):p===q7?a=[c9(e,h,i,o.gradient,g),d9(e,i,o.labels,g)]:(n=function(e,t){var n=n9(e,t);return{align:n("gridAlign"),columns:n.entryColumns(),center:{row:!0,column:!1},padding:{row:n("rowPadding"),column:n("columnPadding")}}}(e,i),a=[h9(e,i,o,g,T8(n.columns))],r.size=function(e,t,n){var r=T8(K9("size",e,n)),a=T8(K9("strokeWidth",e,n)),i=T8(function(e,t,n){return r9("fontSize",e)||function(e,t,n){var r=t.config.style[n];return r&&r[e]}("fontSize",t,n)}(n[1].encode,t,Z7));return P4("max(ceil(sqrt(".concat(r,")+").concat(a,"),").concat(i,")"),t)}(e,t,a[0].marks)),a=[t9({role:"legend-entry",from:m,encode:{enter:{x:{value:0},y:{value:0}}},marks:a,layout:n,interactive:l})],v.title&&a.push(function(e,t,n,r){var a=n9(e,t),i={enter:{opacity:K7},update:{opacity:Y7,x:{field:{group:"padding"}},y:{field:{group:"padding"}}},exit:{opacity:K7}};return X6(i,{orient:a("titleOrient"),_anchor:a("titleAnchor"),anchor:{signal:w9},angle:{signal:k9},align:{signal:x9},baseline:{signal:_9},text:e.title,fill:a("titleColor"),fillOpacity:a("titleOpacity"),font:a("titleFont"),fontSize:a("titleFontSize"),fontStyle:a("titleFontStyle"),fontWeight:a("titleFontWeight"),limit:a("titleLimit"),lineHeight:a("titleLineHeight")},{align:a("titleAlign"),baseline:a("titleBaseline")}),u9({type:e9,role:"legend-title",style:L7,from:r,encode:i},n)}(e,i,o.title,m)),G9(t9({role:"legend",from:m,encode:K6(X9(u,e,i),s,X7),marks:a,aria:u("aria"),description:u("description"),zindex:u("zindex"),name:c,interactive:l,style:f}),t)}function X9(e,t,n){var r={enter:{},update:{}};return X6(r,{orient:e("orient"),offset:e("offset"),padding:e("padding"),titlePadding:e("titlePadding"),cornerRadius:e("cornerRadius"),fill:e("fillColor"),stroke:e("strokeColor"),strokeWidth:n.strokeWidth,strokeDash:n.strokeDash,x:e("legendX"),y:e("legendY"),format:t.format,formatType:t.formatType}),r}function K9(e,t,n){return t[e]?'scale("'.concat(t[e],'",datum)'):r9(e,n[0].encode)}P9.fromEntries=function(e,t){var n=t.length,r=t[n-1],a=t[n-2],i=t[0],o=null,u=1;for(i&&"load"===i.type&&(i=t[1]),e.add(t[0]);u<n;++u)t[u].params.pulse=b8(t[u-1]),e.add(t[u]),"aggregate"===t[u].type&&(o=t[u]);return new P9(e,i,a,r,o)},P9.prototype={countsRef:function(e,t,n){var r,a,i,o=this,u=o.counts||(o.counts={}),s=U9(t);return null!=s&&(e=o.scope,r=u[s]),r?n&&n.field&&W9(e,r.agg.params,n):(i={groupby:e.fieldRef(t,"key"),pulse:b8(o.output)},n&&n.field&&W9(e,i,n),a=e.add(L8(i)),r=e.add(W8({pulse:b8(a)})),r={agg:a,ref:b8(r)},null!=s&&(u[s]=r)),r.ref},tuplesRef:function(){return b8(this.values)},extentRef:function(e,t){return V9(e,this,"extent","extent",t,!1)},domainRef:function(e,t){return V9(e,this,"domain","values",t,!1)},valuesRef:function(e,t,n){return V9(e,this,"vals","values",t,n||!0)},lookupRef:function(e,t){return V9(e,this,"lookup","tupleindex",t,!1)},indataRef:function(e,t){return V9(e,this,"indata","tupleindex",t,!0,!0)}};var Y9='item.orient==="'.concat(D7,'"?-90:item.orient==="').concat(F7,'"?90:0');function $9(e,t){var n=n9(e=bt(e)?{text:e}:e,t.config.title),r=e.encode||{},a=r.group||{},i=a.name||void 0,o=a.interactive,u=a.style,s=[],c=b8(t.add(W8(null,[{}])));return s.push(function(e,t,n,r){var a={value:0},i=e.text,o={enter:{opacity:a},update:{opacity:{value:1}},exit:{opacity:a}};return X6(o,{text:i,align:{signal:"item.mark.group.align"},angle:{signal:"item.mark.group.angle"},limit:{signal:"item.mark.group.limit"},baseline:"top",dx:t("dx"),dy:t("dy"),fill:t("color"),font:t("font"),fontSize:t("fontSize"),fontStyle:t("fontStyle"),fontWeight:t("fontWeight"),lineHeight:t("lineHeight")},{align:t("align"),angle:t("angle"),baseline:t("baseline")}),u9({type:e9,role:t8,style:P7,from:r,encode:o},n)}(e,n,function(e){var t=e.encode;return t&&t.title||at({name:e.name,interactive:e.interactive,style:e.style},t)}(e),c)),e.subtitle&&s.push(function(e,t,n,r){var a={value:0},i=e.subtitle,o={enter:{opacity:a},update:{opacity:{value:1}},exit:{opacity:a}};return X6(o,{text:i,align:{signal:"item.mark.group.align"},angle:{signal:"item.mark.group.angle"},limit:{signal:"item.mark.group.limit"},baseline:"top",dx:t("dx"),dy:t("dy"),fill:t("subtitleColor"),font:t("subtitleFont"),fontSize:t("subtitleFontSize"),fontStyle:t("subtitleFontStyle"),fontWeight:t("subtitleFontWeight"),lineHeight:t("subtitleLineHeight")},{align:t("align"),angle:t("angle"),baseline:t("baseline")}),u9({type:e9,role:n8,style:U7,from:r,encode:o},n)}(e,n,r.subtitle,c)),G9(t9({role:"title",from:c,encode:Q9(n,a),marks:s,aria:n("aria"),description:n("description"),zindex:n("zindex"),name:i,interactive:o,style:u}),t)}function Q9(e,t){var n={enter:{},update:{}};return X6(n,{orient:e("orient"),anchor:e("anchor"),align:{signal:i9},angle:{signal:Y9},limit:e("limit"),frame:e("frame"),offset:e("offset")||0,padding:e("subtitlePadding")}),K6(n,t,X7)}function J9(e,t){var n=[];e.transform&&e.transform.forEach((function(e){n.push(T9(e,t))})),e.on&&e.on.forEach((function(n){q9(n,t,e.name)})),t.addDataPipeline(e.name,function(e,t,n){var r,a,i,o,u,s=[],c=null,l=!1,f=!1;e.values?A8(e.values)||E8(e.format)?(s.push(tee(t,e)),s.push(c=eee())):s.push(c=eee({$ingest:e.values,$format:e.format})):e.url?E8(e.url)||E8(e.format)?(s.push(tee(t,e)),s.push(c=eee())):s.push(c=eee({$request:e.url,$format:e.format})):e.source&&(c=r=Xe(e.source).map((function(e){return b8(t.getData(e).output)})),s.push(null));for(a=0,i=n.length;a<i;++a)u=(o=n[a]).metadata,c||u.source||s.push(c=eee()),s.push(o),u.generates&&(f=!0),u.modifies&&!f&&(l=!0),u.source?c=o:u.changes&&(c=null);r&&(i=r.length-1,s[0]=u7({derive:l,pulse:i?r:r[0]}),(l||i)&&s.splice(1,0,eee()));c||s.push(eee());return s.push(l7({})),s}(e,t,n))}function eee(e){var t=W8({},e);return t.metadata={source:!0},t}function tee(e,t){return Q8({url:t.url?e.property(t.url):void 0,async:t.async?e.property(t.async):void 0,values:t.values?e.property(t.values):void 0,format:e.objectProperty(t.format)})}var nee=function(e){return e===M7||e===I7},ree=function(e,t,n){return A8(e)?cee(e.signal,t,n):e===D7||e===I7?t:n},aee=function(e,t,n){return A8(e)?uee(e.signal,t,n):nee(e)?t:n},iee=function(e,t,n){return A8(e)?see(e.signal,t,n):nee(e)?n:t},oee=function(e,t,n){return A8(e)?lee(e.signal,t,n):e===I7?{value:t}:{value:n}},uee=function(e,t,n){return dee("".concat(e," === '").concat(I7,"' || ").concat(e," === '").concat(M7,"'"),t,n)},see=function(e,t,n){return dee("".concat(e," !== '").concat(I7,"' && ").concat(e," !== '").concat(M7,"'"),t,n)},cee=function(e,t,n){return pee("".concat(e," === '").concat(D7,"' || ").concat(e," === '").concat(I7,"'"),t,n)},lee=function(e,t,n){return pee("".concat(e," === '").concat(I7,"'"),t,n)},fee=function(e,t,n){return pee("".concat(e," === '").concat(F7,"'"),t,n)},dee=function(e,t,n){return t=null!=t?G6(t):t,n=null!=n?G6(n):n,hee(t)&&hee(n)?(t=t?t.signal||Et(t.value):null,n=n?n.signal||Et(n.value):null,{signal:"".concat(e," ? (").concat(t,") : (").concat(n,")")}):[at({test:e},t)].concat(n||[])},hee=function(e){return null==e||1===Object.keys(e).length},pee=function(e,t,n){return{signal:"".concat(e," ? (").concat(mee(t),") : (").concat(mee(n),")")}},vee=function(e,t,n,r,a){return{signal:(null!=r?"".concat(e," === '").concat(D7,"' ? (").concat(mee(r),") : "):"")+(null!=n?"".concat(e," === '").concat(M7,"' ? (").concat(mee(n),") : "):"")+(null!=a?"".concat(e," === '").concat(F7,"' ? (").concat(mee(a),") : "):"")+(null!=t?"".concat(e," === '").concat(I7,"' ? (").concat(mee(t),") : "):"")+"(null)"}},mee=function(e){return A8(e)?e.signal:null==e?null:Et(e)},gee=function(e,t){var n=e.signal;return n&&n.endsWith("(null)")?{signal:n.slice(0,-6)+t.signal}:e};function yee(e,t,n,r){var a;if(t&&st(t,e))return t[e];if(st(n,e))return n[e];if(e.startsWith("title")){switch(e){case"titleColor":a="fill";break;case"titleFont":case"titleFontSize":case"titleFontWeight":a=e[5].toLowerCase()+e.slice(6)}return r["guide-title"][a]}if(e.startsWith("label")){switch(e){case"labelColor":a="fill";break;case"labelFont":case"labelFontSize":a=e[5].toLowerCase()+e.slice(6)}return r["guide-label"][a]}return null}function bee(e){var t,n={},r=(0,Rt.Z)(e);try{for(r.s();!(t=r.n()).done;){var a=t.value;if(a)for(var i in a)n[i]=1}}catch(o){r.e(o)}finally{r.f()}return Object.keys(n)}function xee(e,t){return{scale:e.scale,range:t}}function wee(e,t,n,r,a){var i,o,u,s=n9(e,t),c=e.orient,l=e.gridScale,f=ree(c,1,-1),d=function(e,t){if(1===t);else if(Se(e)){for(var n=e=at({},e);null!=n.mult;){if(!Se(n.mult))return n.mult=A8(t)?{signal:"(".concat(n.mult,") * (").concat(t.signal,")")}:n.mult*t,e;n=n.mult=at({},n.mult)}n.mult=t}else e=A8(t)?{signal:"(".concat(t.signal,") * (").concat(e||0,")")}:t*(e||0);return e}(e.offset,f),h={enter:i={opacity:K7},update:u={opacity:Y7},exit:o={opacity:K7}};X6(h,{stroke:s("gridColor"),strokeCap:s("gridCap"),strokeDash:s("gridDash"),strokeDashOffset:s("gridDashOffset"),strokeOpacity:s("gridOpacity"),strokeWidth:s("gridWidth")});var p={scale:e.scale,field:z7,band:a.band,extra:a.extra,offset:a.offset,round:s("tickRound")},v=aee(c,{signal:"height"},{signal:"width"}),m=l?{scale:l,range:0,mult:f,offset:d}:{value:0,offset:d},g=l?{scale:l,range:1,mult:f,offset:d}:at(v,{mult:f,offset:d});return i.x=u.x=aee(c,p,m),i.y=u.y=iee(c,p,m),i.x2=u.x2=iee(c,g),i.y2=u.y2=aee(c,g),o.x=aee(c,p),o.y=iee(c,p),u9({type:J7,role:"axis-grid",key:z7,from:r,encode:h},n)}function kee(e,t,n,r,a){return{signal:'flush(range("'+e+'"), scale("'+e+'", datum.value), '+t+","+n+","+r+","+a+")"}}function _ee(e,t,n,r,a,i){var o,u=n9(e,t),s=e.orient,c=e.scale,l=ree(s,-1,1),f=T8(u("labelFlush")),d=T8(u("labelFlushOffset")),h=u("labelAlign"),p=u("labelBaseline"),v=0===f||!!f,m=G6(a);m.mult=l,m.offset=G6(u("labelPadding")||0),m.offset.mult=l;var g={scale:c,field:z7,band:.5,offset:o9(i.offset,u("labelOffset"))},y=aee(s,v?kee(c,f,'"left"','"right"','"center"'):{value:"center"},function(e,t,n){return A8(e)?fee(e.signal,t,n):e===F7?{value:t}:{value:n}}(s,"left","right")),b=aee(s,oee(s,"bottom","top"),v?kee(c,f,'"top"','"bottom"','"middle"'):{value:"middle"}),x=kee(c,f,"-(".concat(d,")"),d,0);v=v&&d;var w={opacity:K7,x:aee(s,g,m),y:iee(s,g,m)},k={enter:w,update:o={opacity:Y7,text:{field:j7},x:w.x,y:w.y,align:y,baseline:b},exit:{opacity:K7,x:w.x,y:w.y}};X6(k,{dx:!h&&v?aee(s,x):null,dy:!p&&v?iee(s,x):null}),X6(k,{angle:u("labelAngle"),fill:u("labelColor"),fillOpacity:u("labelOpacity"),font:u("labelFont"),fontSize:u("labelFontSize"),fontWeight:u("labelFontWeight"),fontStyle:u("labelFontStyle"),limit:u("labelLimit"),lineHeight:u("labelLineHeight")},{align:h,baseline:p});var _=u("labelBound"),S=u("labelOverlap");return S=S||_?{separation:u("labelSeparation"),method:S,order:"datum.index",bound:_?{scale:c,orient:s,tolerance:_}:null}:void 0,o.align!==y&&(o.align=gee(o.align,y)),o.baseline!==b&&(o.baseline=gee(o.baseline,b)),u9({type:e9,role:"axis-label",style:Z7,key:z7,from:r,encode:k,overlap:S},n)}function See(e,t,n,r){var a,i,o=n9(e,t),u=e.orient,s=ree(u,-1,1),c={enter:a={opacity:K7,anchor:G6(o("titleAnchor",null)),align:{signal:i9}},update:i=at({},a,{opacity:Y7,text:G6(e.title)}),exit:{opacity:K7}},l={signal:'lerp(range("'.concat(e.scale,'"), ').concat(a9(0,1,.5),")")};return i.x=aee(u,l),i.y=iee(u,l),a.angle=aee(u,K7,function(e,t){return 0===t?0:A8(e)?{signal:"(".concat(e.signal,") * ").concat(t)}:{value:e*t}}(s,90)),a.baseline=aee(u,oee(u,M7,I7),{value:M7}),i.angle=a.angle,i.baseline=a.baseline,X6(c,{fill:o("titleColor"),fillOpacity:o("titleOpacity"),font:o("titleFont"),fontSize:o("titleFontSize"),fontStyle:o("titleFontStyle"),fontWeight:o("titleFontWeight"),limit:o("titleLimit"),lineHeight:o("titleLineHeight")},{align:o("titleAlign"),angle:o("titleAngle"),baseline:o("titleBaseline")}),function(e,t,n,r){var a=function(e,t){return null!=e?(n.update[t]=gee(G6(e),n.update[t]),!1):!Y6(t,r)},i=a(e("titleX"),"x"),o=a(e("titleY"),"y");n.enter.auto=o===i?G6(o):aee(t,G6(o),G6(i))}(o,u,c,n),c.update.align=gee(c.update.align,a.align),c.update.angle=gee(c.update.angle,a.angle),c.update.baseline=gee(c.update.baseline,a.baseline),u9({type:e9,role:"axis-title",style:L7,from:r,encode:c},n)}function Cee(e,t){var n,r=function(e,t){var n,r,a,i=t.config,o=i.style,u=i.axis,s="band"===t.scaleType(e.scale)&&i.axisBand,c=e.orient;if(A8(c)){var l=bee([i.axisX,i.axisY]),f=bee([i.axisTop,i.axisBottom,i.axisLeft,i.axisRight]);n={};var d,h=(0,Rt.Z)(l);try{for(h.s();!(d=h.n()).done;)n[a=d.value]=aee(c,yee(a,i.axisX,u,o),yee(a,i.axisY,u,o))}catch(m){h.e(m)}finally{h.f()}r={};var p,v=(0,Rt.Z)(f);try{for(v.s();!(p=v.n()).done;)r[a=p.value]=vee(c.signal,yee(a,i.axisTop,u,o),yee(a,i.axisBottom,u,o),yee(a,i.axisLeft,u,o),yee(a,i.axisRight,u,o))}catch(m){v.e(m)}finally{v.f()}}else n=c===I7||c===M7?i.axisX:i.axisY,r=i["axis"+c[0].toUpperCase()+c.slice(1)];return n||r||s?at({},u,n,r,s):u}(e,t),a=e.encode||{},i=a.axis||{},o=i.name||void 0,u=i.interactive,s=i.style,c=n9(e,r),l=function(e){var t,n,r=e("tickBand"),a=e("tickOffset");return r?r.signal?(t={signal:"(".concat(r.signal,") === 'extent' ? 1 : 0.5")},n={signal:"(".concat(r.signal,") === 'extent'")},Se(a)||(a={signal:"(".concat(r.signal,") === 'extent' ? 0 : ").concat(a)})):"extent"===r?(t=1,n=!0,a=0):(t=.5,n=!1):(t=e("bandPosition"),n=e("tickExtra")),{extra:n,band:t,offset:a}}(c),f={scale:e.scale,ticks:!!c("ticks"),labels:!!c("labels"),grid:!!c("grid"),domain:!!c("domain"),title:null!=e.title},d=b8(t.add(W8({},[f]))),h=b8(t.add(P8({scale:t.scaleRef(e.scale),extra:t.property(l.extra),count:t.objectProperty(e.tickCount),values:t.objectProperty(e.values),minstep:t.property(e.tickMinStep),formatType:t.property(e.formatType),formatSpecifier:t.property(e.format)}))),p=[];return f.grid&&p.push(wee(e,r,a.grid,h,l)),f.ticks&&(n=c("tickSize"),p.push(function(e,t,n,r,a,i){var o,u,s,c=n9(e,t),l=e.orient,f=ree(l,-1,1),d={enter:o={opacity:K7},update:s={opacity:Y7},exit:u={opacity:K7}};X6(d,{stroke:c("tickColor"),strokeCap:c("tickCap"),strokeDash:c("tickDash"),strokeDashOffset:c("tickDashOffset"),strokeOpacity:c("tickOpacity"),strokeWidth:c("tickWidth")});var h=G6(a);h.mult=f;var p={scale:e.scale,field:z7,band:i.band,extra:i.extra,offset:i.offset,round:c("tickRound")};return s.y=o.y=aee(l,K7,p),s.y2=o.y2=aee(l,h),u.x=aee(l,p),s.x=o.x=iee(l,K7,p),s.x2=o.x2=iee(l,h),u.y=iee(l,p),u9({type:J7,role:"axis-tick",key:z7,from:r,encode:d},n)}(e,r,a.ticks,h,n,l))),f.labels&&(n=f.ticks?n:0,p.push(_ee(e,r,a.labels,h,n,l))),f.domain&&p.push(function(e,t,n,r){var a,i,o=n9(e,t),u=e.orient,s={enter:a={opacity:K7},update:i={opacity:Y7},exit:{opacity:K7}};X6(s,{stroke:o("domainColor"),strokeCap:o("domainCap"),strokeDash:o("domainDash"),strokeDashOffset:o("domainDashOffset"),strokeWidth:o("domainWidth"),strokeOpacity:o("domainOpacity")});var c=xee(e,0),l=xee(e,1);return a.x=i.x=aee(u,c,K7),a.x2=i.x2=aee(u,l),a.y=i.y=iee(u,c,K7),a.y2=i.y2=iee(u,l),u9({type:J7,role:"axis-domain",from:r,encode:s},n)}(e,r,a.domain,d)),f.title&&p.push(See(e,r,a.title,d)),G9(t9({role:"axis",from:d,encode:K6(Aee(c,e),i,X7),marks:p,aria:c("aria"),description:c("description"),zindex:c("zindex"),name:o,interactive:u,style:s}),t)}function Aee(e,t){var n={enter:{},update:{}};return X6(n,{orient:e("orient"),offset:e("offset")||0,position:N8(t.position,0),titlePadding:e("titlePadding"),minExtent:e("minExtent"),maxExtent:e("maxExtent"),range:{signal:'abs(span(range("'.concat(t.scale,'")))')},translate:e("translate"),format:t.format,formatType:t.formatType}),n}function Eee(e,t,n){var r=Xe(e.signals),a=Xe(e.scales);return n||r.forEach((function(e){return v8(e,t)})),Xe(e.projections).forEach((function(e){return function(e,t){var n=t.config.projection||{},r={};for(var a in e)"name"!==a&&(r[a]=T7(e[a],a,t));for(var i in n)null==r[i]&&(r[i]=T7(n[i],i,t));t.addProjection(e.name,r)}(e,t)})),a.forEach((function(e){return function(e,t){var n=e.type||"linear";kI(n)||ue("Unrecognized scale type: "+Et(n)),t.addScale(e.name,{type:n,domain:void 0})}(e,t)})),Xe(e.data).forEach((function(e){return J9(e,t)})),a.forEach((function(e){return m7(e,t)})),(n||r).forEach((function(e){return function(e,t){var n=t.getSignal(e.name),r=e.update;e.init&&(r?ue("Signals can not include both init and update expressions."):(r=e.init,n.initonly=!0)),r&&(r=P4(r,t),n.update=r.$expr,n.params=r.$params),e.on&&e.on.forEach((function(e){return B8(e,t,n.id)}))}(e,t)})),Xe(e.axes).forEach((function(e){return Cee(e,t)})),Xe(e.marks).forEach((function(e){return G9(e,t)})),Xe(e.legends).forEach((function(e){return H9(e,t)})),e.title&&$9(e.title,t),t.parseLambdas(),t}function Nee(e,t){var n=t.config,r=b8(t.root=t.add(y8())),a=function(e,t){var n=function(n){return N8(e[n],t[n])},r=[Tee("background",n("background")),Tee("autosize",W6(n("autosize"))),Tee("padding",q6(n("padding"))),Tee("width",n("width")||0),Tee("height",n("height")||0)],a=r.reduce((function(e,t){return e[t.name]=t,e}),{}),i={};return Xe(e.signals).forEach((function(e){st(a,e.name)?e=at(a[e.name],e):r.push(e),i[e.name]=e})),Xe(t.signals).forEach((function(e){st(i,e.name)||st(a,e.name)||r.push(e)})),r}(e,n);a.forEach((function(e){return v8(e,t)})),t.description=e.description||n.description,t.eventConfig=n.events,t.legends=t.objectProperty(n.legend&&n.legend.layout),t.locale=n.locale;var i=t.add(W8()),o=t.add(G8(l8(function(e){return K6({enter:{x:{value:0},y:{value:0}},update:{width:{signal:"width"},height:{signal:"height"}}},e)}(e.encode),$7,Q6,e.style,t,{pulse:b8(i)}))),u=t.add(d7({layout:t.objectProperty(e.layout),legends:t.legends,autosize:t.signalRef("autosize"),mark:r,pulse:b8(o)}));t.operators.pop(),t.pushState(b8(o),b8(u),null),Eee(e,t,a),t.operators.push(u);var s=t.add(U8({mark:r,pulse:b8(u)}));return s=t.add(s7({pulse:b8(s)})),s=t.add(l7({pulse:b8(s)})),t.addData("root",new P9(t,i,i,s)),t}function Tee(e,t){return t&&t.signal?{name:e,update:t.signal}:{name:e,value:t}}function Iee(e,t){this.config=e||{},this.options=t||{},this.bindings=[],this.field={},this.signals={},this.lambdas={},this.scales={},this.events={},this.data={},this.streams=[],this.updates=[],this.operators=[],this.eventConfig=null,this.locale=null,this._id=0,this._subid=0,this._nextsub=[0],this._parent=[],this._encode=[],this._lookup=[],this._markpath=[]}function Dee(e){this.config=e.config,this.options=e.options,this.legends=e.legends,this.field=Object.create(e.field),this.signals=Object.create(e.signals),this.lambdas=Object.create(e.lambdas),this.scales=Object.create(e.scales),this.events=Object.create(e.events),this.data=Object.create(e.data),this.streams=[],this.updates=[],this.operators=[],this._id=0,this._subid=++e._nextsub[0],this._nextsub=e._nextsub,this._parent=e._parent.slice(),this._encode=e._encode.slice(),this._lookup=e._lookup.slice(),this._markpath=e._markpath}function Fee(e){return(_e(e)?Mee:Oee)(e)}function Mee(e){for(var t=e.length,n="[",r=0;r<t;++r){var a=e[r];n+=(r>0?",":"")+(Se(a)?a.signal||Fee(a):Et(a))}return n+"]"}function Oee(e){var t,n,r="{",a=0;for(t in e)n=e[t],r+=(++a>1?",":"")+Et(t)+":"+(Se(n)?n.signal||Fee(n):Et(n));return r+"}"}function Ree(e,t,n){return Se(e)||ue("Input Vega specification must be an object."),t=Ae(function(){var e="sans-serif",t="#4c78a8",n="#000",r="#888",a="#ddd";return{description:"Vega visualization",padding:0,autosize:"pad",background:null,events:{defaults:{allow:["wheel"]}},group:null,mark:null,arc:{fill:t},area:{fill:t},image:null,line:{stroke:t,strokeWidth:2},path:{stroke:t},rect:{fill:t},rule:{stroke:n},shape:{stroke:t},symbol:{fill:t,size:64},text:{fill:n,font:e,fontSize:11},trail:{fill:t,size:2},style:{"guide-label":{fill:n,font:e,fontSize:10},"guide-title":{fill:n,font:e,fontSize:11,fontWeight:"bold"},"group-title":{fill:n,font:e,fontSize:13,fontWeight:"bold"},"group-subtitle":{fill:n,font:e,fontSize:12},point:{size:30,strokeWidth:2,shape:"circle"},circle:{size:30,strokeWidth:2},square:{size:30,strokeWidth:2,shape:"square"},cell:{fill:"transparent",stroke:a}},title:{orient:"top",anchor:"middle",offset:4,subtitlePadding:3},axis:{minExtent:0,maxExtent:200,bandPosition:.5,domain:!0,domainWidth:1,domainColor:r,grid:!1,gridWidth:1,gridColor:a,labels:!0,labelAngle:0,labelLimit:180,labelOffset:0,labelPadding:2,ticks:!0,tickColor:r,tickOffset:0,tickRound:!0,tickSize:5,tickWidth:1,titlePadding:4},axisBand:{tickOffset:-.5},projection:{type:"mercator"},legend:{orient:"right",padding:0,gridAlign:"each",columnPadding:10,rowPadding:2,symbolDirection:"vertical",gradientDirection:"vertical",gradientLength:200,gradientThickness:16,gradientStrokeColor:a,gradientStrokeWidth:0,gradientLabelOffset:2,labelAlign:"left",labelBaseline:"middle",labelLimit:160,labelOffset:4,labelOverlap:!0,symbolLimit:30,symbolType:"circle",symbolSize:100,symbolOffset:0,symbolStrokeWidth:1.5,symbolBaseFillColor:"transparent",symbolBaseStrokeColor:r,titleLimit:180,titleOrient:"top",titlePadding:5,layout:{offset:18,direction:"horizontal",left:{direction:"vertical"},right:{direction:"vertical"}}},range:{category:{scheme:"tableau10"},ordinal:{scheme:"blues"},heatmap:{scheme:"yellowgreenblue"},ramp:{scheme:"blues"},diverging:{scheme:"blueorange",extent:[1,0]},symbol:["circle","square","triangle-up","cross","diamond","triangle-right","triangle-down","triangle-left"]}}}(),t,e.config),Nee(e,new Iee(t,n)).toRuntime()}Iee.prototype=Dee.prototype={parse:function(e){return Eee(e,this)},fork:function(){return new Dee(this)},isSubscope:function(){return this._subid>0},toRuntime:function(){return this.finish(),{description:this.description,operators:this.operators,streams:this.streams,updates:this.updates,bindings:this.bindings,eventConfig:this.eventConfig,locale:this.locale}},id:function(){return(this._subid?this._subid+":":0)+this._id++},add:function(e){return this.operators.push(e),e.id=this.id(),e.refs&&(e.refs.forEach((function(t){t.$ref=e.id})),e.refs=null),e},proxy:function(e){var t=e instanceof m8?b8(e):e;return this.add(o7({value:t}))},addStream:function(e){return this.streams.push(e),e.id=this.id(),e},addUpdate:function(e){return this.updates.push(e),e},finish:function(){var e,t;for(e in this.root&&(this.root.root=!0),this.signals)this.signals[e].signal=e;for(e in this.scales)this.scales[e].scale=e;function n(e,t,n){var r;e&&((r=e.data||(e.data={}))[t]||(r[t]=[])).push(n)}for(e in this.data)for(var r in n((t=this.data[e]).input,e,"input"),n(t.output,e,"output"),n(t.values,e,"values"),t.index)n(t.index[r],e,"index:"+r);return this},pushState:function(e,t,n){this._encode.push(b8(this.add(l7({pulse:e})))),this._parent.push(t),this._lookup.push(n?b8(this.proxy(n)):null),this._markpath.push(-1)},popState:function(){this._encode.pop(),this._parent.pop(),this._lookup.pop(),this._markpath.pop()},parent:function(){return Te(this._parent)},encode:function(){return Te(this._encode)},lookup:function(){return Te(this._lookup)},markpath:function(){var e=this._markpath;return++e[e.length-1]},fieldRef:function(e,t){if(bt(e))return x8(e,t);e.signal||ue("Unsupported field reference: "+Et(e));var n=e.signal,r=this.field[n];if(!r){var a={name:this.signalRef(n)};t&&(a.as=t),this.field[n]=r=b8(this.add(K8(a)))}return r},compareRef:function(e){var t=this,n=!1,r=function(e){return A8(e)?(n=!0,t.signalRef(e.signal)):function(e){return e&&e.expr}(e)?(n=!0,t.exprRef(e.expr)):e},a=Xe(e.field).map(r),i=Xe(e.order).map(r);return n?b8(this.add(V8({fields:a,orders:i}))):k8(a,i)},keyRef:function(e,t){var n=!1,r=this.signals;return e=Xe(e).map((function(e){return A8(e)?(n=!0,b8(r[e.signal])):e})),n?b8(this.add(Y8({fields:e,flat:t}))):function(e,t){var n={$key:e};return t&&(n.$flat=!0),n}(e,t)},sortRef:function(e){if(!e)return e;var t=_8(e.op,e.field),n=e.order||"ascending";return n.signal?b8(this.add(V8({fields:t,orders:this.signalRef(n.signal)}))):k8(t,n)},event:function(e,t){var n=e+":"+t;if(!this.events[n]){var r=this.id();this.streams.push({id:r,source:e,type:t}),this.events[n]=r}return this.events[n]},hasOwnSignal:function(e){return st(this.signals,e)},addSignal:function(e,t){this.hasOwnSignal(e)&&ue("Duplicate signal name: "+Et(e));var n=t instanceof m8?t:this.add(y8(t));return this.signals[e]=n},getSignal:function(e){return this.signals[e]||ue("Unrecognized signal name: "+Et(e)),this.signals[e]},signalRef:function(e){return this.signals[e]?b8(this.signals[e]):(st(this.lambdas,e)||(this.lambdas[e]=this.add(y8(null))),b8(this.lambdas[e]))},parseLambdas:function(){for(var e=Object.keys(this.lambdas),t=0,n=e.length;t<n;++t){var r=e[t],a=P4(r,this),i=this.lambdas[r];i.params=a.$params,i.update=a.$expr}},property:function(e){return e&&e.signal?this.signalRef(e.signal):e},objectProperty:function(e){return e&&Se(e)?this.signalRef(e.signal||Fee(e)):e},exprRef:function(e,t){var n={expr:P4(e,this)};return t&&(n.expr.$name=t),b8(this.add(H8(n)))},addBinding:function(e,t){this.bindings||ue("Nested signals do not support binding: "+Et(e)),this.bindings.push(at({signal:e},t))},addScaleProj:function(e,t){st(this.scales,e)&&ue("Duplicate scale or projection name: "+Et(e)),this.scales[e]=this.add(t)},addScale:function(e,t){this.addScaleProj(e,c7(t))},addProjection:function(e,t){this.addScaleProj(e,i7(t))},getScale:function(e){return this.scales[e]||ue("Unrecognized scale name: "+Et(e)),this.scales[e]},scaleRef:function(e){return b8(this.getScale(e))},scaleType:function(e){return this.getScale(e).params.type},projectionRef:function(e){return this.scaleRef(e)},projectionType:function(e){return this.scaleType(e)},addData:function(e,t){return st(this.data,e)&&ue("Duplicate data set name: "+Et(e)),this.data[e]=t},getData:function(e){return this.data[e]||ue("Undefined data set name: "+Et(e)),this.data[e]},addDataPipeline:function(e,t){return st(this.data,e)&&ue("Duplicate data set name: "+Et(e)),this.addData(e,P9.fromEntries(this,t))}};var jee,Bee,zee,Zee,Lee,Pee="Property",Uee="ArrayExpression",Wee="BinaryExpression",Vee="CallExpression",qee="ConditionalExpression",Gee="LogicalExpression",Hee="MemberExpression",Xee="ObjectExpression",Kee="UnaryExpression";function Yee(e){this.type=e}Yee.prototype.visit=function(e){var t,n,r;if(e(this))return 1;for(n=0,r=(t=function(e){switch(e.type){case Uee:return e.elements;case Wee:case Gee:return[e.left,e.right];case Vee:return[e.callee].concat(e.arguments);case qee:return[e.test,e.consequent,e.alternate];case Hee:return[e.object,e.property];case Xee:return e.properties;case Pee:return[e.key,e.value];case Kee:return[e.argument];default:return[]}}(this)).length;n<r;++n)if(t[n].visit(e))return 1};(jee={})[1]="Boolean",jee[2]="<end>",jee[3]="Identifier",jee[4]="Keyword",jee[5]="Null",jee[6]="Numeric",jee[7]="Punctuator",jee[8]="String",jee[9]="RegularExpression";var $ee="Identifier",Qee="Unexpected token %0",Jee="Invalid regular expression",ete="Invalid regular expression: missing /",tte="Octal literals are not allowed in strict mode.",nte="ILLEGAL",rte="Disabled.",ate=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0620-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u08A0-\\u08B2\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971-\\u0980\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D\\u0C58\\u0C59\\u0C60\\u0C61\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0CF1\\u0CF2\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D60\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EDC-\\u0EDF\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u1820-\\u1877\\u1880-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19C1-\\u19C7\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF\\u1BBA-\\u1BE5\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1CE9-\\u1CEC\\u1CEE-\\u1CF1\\u1CF5\\u1CF6\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005-\\u3007\\u3021-\\u3029\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B\\uA640-\\uA66E\\uA67F-\\uA69D\\uA6A0-\\uA6EF\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA8F2-\\uA8F7\\uA8FB\\uA90A-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF\\uA9E0-\\uA9E4\\uA9E6-\\uA9EF\\uA9FA-\\uA9FE\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA60-\\uAA76\\uAA7A\\uAA7E-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABE2\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]"),ite=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0300-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u0483-\\u0487\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u0591-\\u05BD\\u05BF\\u05C1\\u05C2\\u05C4\\u05C5\\u05C7\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0610-\\u061A\\u0620-\\u0669\\u066E-\\u06D3\\u06D5-\\u06DC\\u06DF-\\u06E8\\u06EA-\\u06FC\\u06FF\\u0710-\\u074A\\u074D-\\u07B1\\u07C0-\\u07F5\\u07FA\\u0800-\\u082D\\u0840-\\u085B\\u08A0-\\u08B2\\u08E4-\\u0963\\u0966-\\u096F\\u0971-\\u0983\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BC-\\u09C4\\u09C7\\u09C8\\u09CB-\\u09CE\\u09D7\\u09DC\\u09DD\\u09DF-\\u09E3\\u09E6-\\u09F1\\u0A01-\\u0A03\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A3C\\u0A3E-\\u0A42\\u0A47\\u0A48\\u0A4B-\\u0A4D\\u0A51\\u0A59-\\u0A5C\\u0A5E\\u0A66-\\u0A75\\u0A81-\\u0A83\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABC-\\u0AC5\\u0AC7-\\u0AC9\\u0ACB-\\u0ACD\\u0AD0\\u0AE0-\\u0AE3\\u0AE6-\\u0AEF\\u0B01-\\u0B03\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3C-\\u0B44\\u0B47\\u0B48\\u0B4B-\\u0B4D\\u0B56\\u0B57\\u0B5C\\u0B5D\\u0B5F-\\u0B63\\u0B66-\\u0B6F\\u0B71\\u0B82\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BBE-\\u0BC2\\u0BC6-\\u0BC8\\u0BCA-\\u0BCD\\u0BD0\\u0BD7\\u0BE6-\\u0BEF\\u0C00-\\u0C03\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D-\\u0C44\\u0C46-\\u0C48\\u0C4A-\\u0C4D\\u0C55\\u0C56\\u0C58\\u0C59\\u0C60-\\u0C63\\u0C66-\\u0C6F\\u0C81-\\u0C83\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBC-\\u0CC4\\u0CC6-\\u0CC8\\u0CCA-\\u0CCD\\u0CD5\\u0CD6\\u0CDE\\u0CE0-\\u0CE3\\u0CE6-\\u0CEF\\u0CF1\\u0CF2\\u0D01-\\u0D03\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D-\\u0D44\\u0D46-\\u0D48\\u0D4A-\\u0D4E\\u0D57\\u0D60-\\u0D63\\u0D66-\\u0D6F\\u0D7A-\\u0D7F\\u0D82\\u0D83\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0DCA\\u0DCF-\\u0DD4\\u0DD6\\u0DD8-\\u0DDF\\u0DE6-\\u0DEF\\u0DF2\\u0DF3\\u0E01-\\u0E3A\\u0E40-\\u0E4E\\u0E50-\\u0E59\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB9\\u0EBB-\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EC8-\\u0ECD\\u0ED0-\\u0ED9\\u0EDC-\\u0EDF\\u0F00\\u0F18\\u0F19\\u0F20-\\u0F29\\u0F35\\u0F37\\u0F39\\u0F3E-\\u0F47\\u0F49-\\u0F6C\\u0F71-\\u0F84\\u0F86-\\u0F97\\u0F99-\\u0FBC\\u0FC6\\u1000-\\u1049\\u1050-\\u109D\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u135D-\\u135F\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1714\\u1720-\\u1734\\u1740-\\u1753\\u1760-\\u176C\\u176E-\\u1770\\u1772\\u1773\\u1780-\\u17D3\\u17D7\\u17DC\\u17DD\\u17E0-\\u17E9\\u180B-\\u180D\\u1810-\\u1819\\u1820-\\u1877\\u1880-\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1920-\\u192B\\u1930-\\u193B\\u1946-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19B0-\\u19C9\\u19D0-\\u19D9\\u1A00-\\u1A1B\\u1A20-\\u1A5E\\u1A60-\\u1A7C\\u1A7F-\\u1A89\\u1A90-\\u1A99\\u1AA7\\u1AB0-\\u1ABD\\u1B00-\\u1B4B\\u1B50-\\u1B59\\u1B6B-\\u1B73\\u1B80-\\u1BF3\\u1C00-\\u1C37\\u1C40-\\u1C49\\u1C4D-\\u1C7D\\u1CD0-\\u1CD2\\u1CD4-\\u1CF6\\u1CF8\\u1CF9\\u1D00-\\u1DF5\\u1DFC-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u200C\\u200D\\u203F\\u2040\\u2054\\u2071\\u207F\\u2090-\\u209C\\u20D0-\\u20DC\\u20E1\\u20E5-\\u20F0\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D7F-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2DE0-\\u2DFF\\u2E2F\\u3005-\\u3007\\u3021-\\u302F\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u3099\\u309A\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA62B\\uA640-\\uA66F\\uA674-\\uA67D\\uA67F-\\uA69D\\uA69F-\\uA6F1\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA827\\uA840-\\uA873\\uA880-\\uA8C4\\uA8D0-\\uA8D9\\uA8E0-\\uA8F7\\uA8FB\\uA900-\\uA92D\\uA930-\\uA953\\uA960-\\uA97C\\uA980-\\uA9C0\\uA9CF-\\uA9D9\\uA9E0-\\uA9FE\\uAA00-\\uAA36\\uAA40-\\uAA4D\\uAA50-\\uAA59\\uAA60-\\uAA76\\uAA7A-\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEF\\uAAF2-\\uAAF6\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABEA\\uABEC\\uABED\\uABF0-\\uABF9\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE00-\\uFE0F\\uFE20-\\uFE2D\\uFE33\\uFE34\\uFE4D-\\uFE4F\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF10-\\uFF19\\uFF21-\\uFF3A\\uFF3F\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]");function ote(e,t){if(!e)throw new Error("ASSERT: "+t)}function ute(e){return e>=48&&e<=57}function ste(e){return"0123456789abcdefABCDEF".indexOf(e)>=0}function cte(e){return"01234567".indexOf(e)>=0}function lte(e){return 32===e||9===e||11===e||12===e||160===e||e>=5760&&[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].indexOf(e)>=0}function fte(e){return 10===e||13===e||8232===e||8233===e}function dte(e){return 36===e||95===e||e>=65&&e<=90||e>=97&&e<=122||92===e||e>=128&&ate.test(String.fromCharCode(e))}function hte(e){return 36===e||95===e||e>=65&&e<=90||e>=97&&e<=122||e>=48&&e<=57||92===e||e>=128&&ite.test(String.fromCharCode(e))}var pte={if:1,in:1,do:1,var:1,for:1,new:1,try:1,let:1,this:1,else:1,case:1,void:1,with:1,enum:1,while:1,break:1,catch:1,throw:1,const:1,yield:1,class:1,super:1,return:1,typeof:1,delete:1,switch:1,export:1,import:1,public:1,static:1,default:1,finally:1,extends:1,package:1,private:1,function:1,continue:1,debugger:1,interface:1,protected:1,instanceof:1,implements:1};function vte(){for(;zee<Zee;){var e=Bee.charCodeAt(zee);if(!lte(e)&&!fte(e))break;++zee}}function mte(e){var t,n,r,a=0;for(n="u"===e?4:2,t=0;t<n;++t)zee<Zee&&ste(Bee[zee])?(r=Bee[zee++],a=16*a+"0123456789abcdef".indexOf(r.toLowerCase())):Fte({},Qee,nte);return String.fromCharCode(a)}function gte(){var e,t,n,r;for(t=0,"}"===(e=Bee[zee])&&Fte({},Qee,nte);zee<Zee&&ste(e=Bee[zee++]);)t=16*t+"0123456789abcdef".indexOf(e.toLowerCase());return(t>1114111||"}"!==e)&&Fte({},Qee,nte),t<=65535?String.fromCharCode(t):(n=55296+(t-65536>>10),r=56320+(t-65536&1023),String.fromCharCode(n,r))}function yte(){var e,t;for(e=Bee.charCodeAt(zee++),t=String.fromCharCode(e),92===e&&(117!==Bee.charCodeAt(zee)&&Fte({},Qee,nte),++zee,(e=mte("u"))&&"\\"!==e&&dte(e.charCodeAt(0))||Fte({},Qee,nte),t=e);zee<Zee&&hte(e=Bee.charCodeAt(zee));)++zee,t+=String.fromCharCode(e),92===e&&(t=t.substr(0,t.length-1),117!==Bee.charCodeAt(zee)&&Fte({},Qee,nte),++zee,(e=mte("u"))&&"\\"!==e&&hte(e.charCodeAt(0))||Fte({},Qee,nte),t+=e);return t}function bte(){var e,t;return e=zee,t=92===Bee.charCodeAt(zee)?yte():function(){var e,t;for(e=zee++;zee<Zee;){if(92===(t=Bee.charCodeAt(zee)))return zee=e,yte();if(!hte(t))break;++zee}return Bee.slice(e,zee)}(),{type:1===t.length?3:pte.hasOwnProperty(t)?4:"null"===t?5:"true"===t||"false"===t?1:3,value:t,start:e,end:zee}}function xte(){var e,t,n,r,a=zee,i=Bee.charCodeAt(zee),o=Bee[zee];switch(i){case 46:case 40:case 41:case 59:case 44:case 123:case 125:case 91:case 93:case 58:case 63:case 126:return++zee,{type:7,value:String.fromCharCode(i),start:a,end:zee};default:if(61===(e=Bee.charCodeAt(zee+1)))switch(i){case 43:case 45:case 47:case 60:case 62:case 94:case 124:case 37:case 38:case 42:return zee+=2,{type:7,value:String.fromCharCode(i)+String.fromCharCode(e),start:a,end:zee};case 33:case 61:return zee+=2,61===Bee.charCodeAt(zee)&&++zee,{type:7,value:Bee.slice(a,zee),start:a,end:zee}}}return">>>="===(r=Bee.substr(zee,4))?{type:7,value:r,start:a,end:zee+=4}:">>>"===(n=r.substr(0,3))||"<<="===n||">>="===n?{type:7,value:n,start:a,end:zee+=3}:o===(t=n.substr(0,2))[1]&&"+-<>&|".indexOf(o)>=0||"=>"===t?{type:7,value:t,start:a,end:zee+=2}:("//"===t&&Fte({},Qee,nte),"<>=!+-*%&|^/".indexOf(o)>=0?{type:7,value:o,start:a,end:++zee}:void Fte({},Qee,nte))}function wte(){var e,t,n;if(ote(ute((n=Bee[zee]).charCodeAt(0))||"."===n,"Numeric literal must start with a decimal digit or a decimal point"),t=zee,e="","."!==n){if(e=Bee[zee++],n=Bee[zee],"0"===e){if("x"===n||"X"===n)return++zee,function(e){for(var t="";zee<Zee&&ste(Bee[zee]);)t+=Bee[zee++];return 0===t.length&&Fte({},Qee,nte),dte(Bee.charCodeAt(zee))&&Fte({},Qee,nte),{type:6,value:parseInt("0x"+t,16),start:e,end:zee}}(t);if(cte(n))return function(e){for(var t="0"+Bee[zee++];zee<Zee&&cte(Bee[zee]);)t+=Bee[zee++];return(dte(Bee.charCodeAt(zee))||ute(Bee.charCodeAt(zee)))&&Fte({},Qee,nte),{type:6,value:parseInt(t,8),octal:!0,start:e,end:zee}}(t);n&&ute(n.charCodeAt(0))&&Fte({},Qee,nte)}for(;ute(Bee.charCodeAt(zee));)e+=Bee[zee++];n=Bee[zee]}if("."===n){for(e+=Bee[zee++];ute(Bee.charCodeAt(zee));)e+=Bee[zee++];n=Bee[zee]}if("e"===n||"E"===n)if(e+=Bee[zee++],"+"!==(n=Bee[zee])&&"-"!==n||(e+=Bee[zee++]),ute(Bee.charCodeAt(zee)))for(;ute(Bee.charCodeAt(zee));)e+=Bee[zee++];else Fte({},Qee,nte);return dte(Bee.charCodeAt(zee))&&Fte({},Qee,nte),{type:6,value:parseFloat(e),start:t,end:zee}}function kte(){var e,t,n,r;return Lee=null,vte(),e=zee,t=function(){var e,t,n,r;for(ote("/"===(e=Bee[zee]),"Regular expression literal must start with a slash"),t=Bee[zee++],n=!1,r=!1;zee<Zee;)if(t+=e=Bee[zee++],"\\"===e)fte((e=Bee[zee++]).charCodeAt(0))&&Fte({},ete),t+=e;else if(fte(e.charCodeAt(0)))Fte({},ete);else if(n)"]"===e&&(n=!1);else{if("/"===e){r=!0;break}"["===e&&(n=!0)}return r||Fte({},ete),{value:t.substr(1,t.length-2),literal:t}}(),n=function(){var e,t,n;for(t="",n="";zee<Zee&&hte((e=Bee[zee]).charCodeAt(0));)++zee,"\\"===e&&zee<Zee?Fte({},Qee,nte):(n+=e,t+=e);return n.search(/[^gimuy]/g)>=0&&Fte({},Jee,n),{value:n,literal:t}}(),r=function(e,t){var n=e;t.indexOf("u")>=0&&(n=n.replace(/\\u\{([0-9a-fA-F]+)\}/g,(function(e,t){if(parseInt(t,16)<=1114111)return"x";Fte({},Jee)})).replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"x"));try{new RegExp(n)}catch(r){Fte({},Jee)}try{return new RegExp(e,t)}catch(a){return null}}(t.value,n.value),{literal:t.literal+n.literal,value:r,regex:{pattern:t.value,flags:n.value},start:e,end:zee}}function _te(){if(vte(),zee>=Zee)return{type:2,start:zee,end:zee};var e=Bee.charCodeAt(zee);return dte(e)?bte():40===e||41===e||59===e?xte():39===e||34===e?function(){var e,t,n,r,a="",i=!1;for(ote("'"===(e=Bee[zee])||'"'===e,"String literal must starts with a quote"),t=zee,++zee;zee<Zee;){if((n=Bee[zee++])===e){e="";break}if("\\"===n)if((n=Bee[zee++])&&fte(n.charCodeAt(0)))"\r"===n&&"\n"===Bee[zee]&&++zee;else switch(n){case"u":case"x":"{"===Bee[zee]?(++zee,a+=gte()):a+=mte(n);break;case"n":a+="\n";break;case"r":a+="\r";break;case"t":a+="\t";break;case"b":a+="\b";break;case"f":a+="\f";break;case"v":a+="\v";break;default:cte(n)?(0!==(r="01234567".indexOf(n))&&(i=!0),zee<Zee&&cte(Bee[zee])&&(i=!0,r=8*r+"01234567".indexOf(Bee[zee++]),"0123".indexOf(n)>=0&&zee<Zee&&cte(Bee[zee])&&(r=8*r+"01234567".indexOf(Bee[zee++]))),a+=String.fromCharCode(r)):a+=n}else{if(fte(n.charCodeAt(0)))break;a+=n}}return""!==e&&Fte({},Qee,nte),{type:8,value:a,octal:i,start:t,end:zee}}():46===e?ute(Bee.charCodeAt(zee+1))?wte():xte():ute(e)?wte():xte()}function Ste(){var e=Lee;return zee=e.end,Lee=_te(),zee=e.end,e}function Cte(){var e=zee;Lee=_te(),zee=e}function Ate(e,t,n){var r=new Yee("||"===e||"&&"===e?"LogicalExpression":"BinaryExpression");return r.operator=e,r.left=t,r.right=n,r}function Ete(e,t){var n=new Yee("CallExpression");return n.callee=e,n.arguments=t,n}function Nte(e){var t=new Yee($ee);return t.name=e,t}function Tte(e){var t=new Yee("Literal");return t.value=e.value,t.raw=Bee.slice(e.start,e.end),e.regex&&("//"===t.raw&&(t.raw="/(?:)/"),t.regex=e.regex),t}function Ite(e,t,n){var r=new Yee("MemberExpression");return r.computed="["===e,r.object=t,r.property=n,r.computed||(n.member=!0),r}function Dte(e,t,n){var r=new Yee("Property");return r.key=t,r.value=n,r.kind=e,r}function Fte(e,t){var n,r=Array.prototype.slice.call(arguments,2),a=t.replace(/%(\d)/g,(function(e,t){return ote(t<r.length,"Message reference must be in range"),r[t]}));throw(n=new Error(a)).index=zee,n.description=a,n}function Mte(e){2===e.type&&Fte(e,"Unexpected end of input"),6===e.type&&Fte(e,"Unexpected number"),8===e.type&&Fte(e,"Unexpected string"),3===e.type&&Fte(e,"Unexpected identifier"),4===e.type&&Fte(e,"Unexpected reserved word"),Fte(e,Qee,e.value)}function Ote(e){var t=Ste();7===t.type&&t.value===e||Mte(t)}function Rte(e){return 7===Lee.type&&Lee.value===e}function jte(e){return 4===Lee.type&&Lee.value===e}function Bte(){var e=[];for(zee=Lee.start,Ote("[");!Rte("]");)Rte(",")?(Ste(),e.push(null)):(e.push(Kte()),Rte("]")||Ote(","));return Ste(),function(e){var t=new Yee("ArrayExpression");return t.elements=e,t}(e)}function zte(){zee=Lee.start;var e=Ste();return 8===e.type||6===e.type?(e.octal&&Fte(e,tte),Tte(e)):Nte(e.value)}function Zte(){var e,t,n;return zee=Lee.start,3===(e=Lee).type?(n=zte(),Ote(":"),Dte("init",n,Kte())):2!==e.type&&7!==e.type?(t=zte(),Ote(":"),Dte("init",t,Kte())):void Mte(e)}function Lte(){var e,t,n=[],r={},a=String;for(zee=Lee.start,Ote("{");!Rte("}");)t="$"+((e=Zte()).key.type===$ee?e.key.name:a(e.key.value)),Object.prototype.hasOwnProperty.call(r,t)?Fte({},"Duplicate data property in object literal not allowed in strict mode"):r[t]=!0,n.push(e),Rte("}")||Ote(",");return Ote("}"),function(e){var t=new Yee("ObjectExpression");return t.properties=e,t}(n)}var Pte={if:1};function Ute(){var e,t,n;if(Rte("("))return function(){Ote("(");var e=Yte();return Ote(")"),e}();if(Rte("["))return Bte();if(Rte("{"))return Lte();if(e=Lee.type,zee=Lee.start,3===e||Pte[Lee.value])n=Nte(Ste().value);else if(8===e||6===e)Lee.octal&&Fte(Lee,tte),n=Tte(Ste());else{if(4===e)throw new Error(rte);1===e?((t=Ste()).value="true"===t.value,n=Tte(t)):5===e?((t=Ste()).value=null,n=Tte(t)):Rte("/")||Rte("/=")?(n=Tte(kte()),Cte()):Mte(Ste())}return n}function Wte(){var e=[];if(Ote("("),!Rte(")"))for(;zee<Zee&&(e.push(Kte()),!Rte(")"));)Ote(",");return Ote(")"),e}function Vte(){return Ote("."),function(){zee=Lee.start;var e=Ste();return function(e){return 3===e.type||4===e.type||1===e.type||5===e.type}(e)||Mte(e),Nte(e.value)}()}function qte(){Ote("[");var e=Yte();return Ote("]"),e}function Gte(){var e=function(){var e;for(e=Ute();;)if(Rte("."))e=Ite(".",e,Vte());else if(Rte("("))e=Ete(e,Wte());else{if(!Rte("["))break;e=Ite("[",e,qte())}return e}();if(7===Lee.type&&(Rte("++")||Rte("--")))throw new Error(rte);return e}function Hte(){var e,t;if(7!==Lee.type&&4!==Lee.type)t=Gte();else{if(Rte("++")||Rte("--"))throw new Error(rte);if(Rte("+")||Rte("-")||Rte("~")||Rte("!"))e=Ste(),t=Hte(),t=function(e,t){var n=new Yee("UnaryExpression");return n.operator=e,n.argument=t,n.prefix=!0,n}(e.value,t);else{if(jte("delete")||jte("void")||jte("typeof"))throw new Error(rte);t=Gte()}}return t}function Xte(e){var t=0;if(7!==e.type&&4!==e.type)return 0;switch(e.value){case"||":t=1;break;case"&&":t=2;break;case"|":t=3;break;case"^":t=4;break;case"&":t=5;break;case"==":case"!=":case"===":case"!==":t=6;break;case"<":case">":case"<=":case">=":case"instanceof":case"in":t=7;break;case"<<":case">>":case">>>":t=8;break;case"+":case"-":t=9;break;case"*":case"/":case"%":t=11}return t}function Kte(){var e,t;return e=function(){var e,t,n,r,a,i,o,u,s,c;if(e=Lee,s=Hte(),0===(a=Xte(r=Lee)))return s;for(r.prec=a,Ste(),t=[e,Lee],i=[s,r,o=Hte()];(a=Xte(Lee))>0;){for(;i.length>2&&a<=i[i.length-2].prec;)o=i.pop(),u=i.pop().value,s=i.pop(),t.pop(),n=Ate(u,s,o),i.push(n);(r=Ste()).prec=a,i.push(r),t.push(Lee),n=Hte(),i.push(n)}for(n=i[c=i.length-1],t.pop();c>1;)t.pop(),n=Ate(i[c-1].value,i[c-2],n),c-=2;return n}(),Rte("?")&&(Ste(),t=Kte(),Ote(":"),e=function(e,t,n){var r=new Yee("ConditionalExpression");return r.test=e,r.consequent=t,r.alternate=n,r}(e,t,Kte())),e}function Yte(){var e=Kte();if(Rte(","))throw new Error(rte);return e}function $te(e){zee=0,Zee=(Bee=e).length,Lee=null,Cte();var t=Yte();if(2!==Lee.type)throw new Error("Unexpect token after expression.");return t}var Qte={NaN:"NaN",E:"Math.E",LN2:"Math.LN2",LN10:"Math.LN10",LOG2E:"Math.LOG2E",LOG10E:"Math.LOG10E",PI:"Math.PI",SQRT1_2:"Math.SQRT1_2",SQRT2:"Math.SQRT2",MIN_VALUE:"Number.MIN_VALUE",MAX_VALUE:"Number.MAX_VALUE"};function Jte(e){function t(t,n,r){return function(a){return function(t,n,r,a){var i=e(n[0]);return r&&(i=r+"("+i+")",0===r.lastIndexOf("new ",0)&&(i="("+i+")")),i+"."+t+(a<0?"":0===a?"()":"("+n.slice(1).map(e).join(",")+")")}(t,a,n,r)}}var n="new Date",r="String",a="RegExp";return{isNaN:"Number.isNaN",isFinite:"Number.isFinite",abs:"Math.abs",acos:"Math.acos",asin:"Math.asin",atan:"Math.atan",atan2:"Math.atan2",ceil:"Math.ceil",cos:"Math.cos",exp:"Math.exp",floor:"Math.floor",log:"Math.log",max:"Math.max",min:"Math.min",pow:"Math.pow",random:"Math.random",round:"Math.round",sin:"Math.sin",sqrt:"Math.sqrt",tan:"Math.tan",clamp:function(t){t.length<3&&ue("Missing arguments to clamp function."),t.length>3&&ue("Too many arguments to clamp function.");var n=t.map(e);return"Math.max("+n[1]+", Math.min("+n[2]+","+n[0]+"))"},now:"Date.now",utc:"Date.UTC",datetime:n,date:t("getDate",n,0),day:t("getDay",n,0),year:t("getFullYear",n,0),month:t("getMonth",n,0),hours:t("getHours",n,0),minutes:t("getMinutes",n,0),seconds:t("getSeconds",n,0),milliseconds:t("getMilliseconds",n,0),time:t("getTime",n,0),timezoneoffset:t("getTimezoneOffset",n,0),utcdate:t("getUTCDate",n,0),utcday:t("getUTCDay",n,0),utcyear:t("getUTCFullYear",n,0),utcmonth:t("getUTCMonth",n,0),utchours:t("getUTCHours",n,0),utcminutes:t("getUTCMinutes",n,0),utcseconds:t("getUTCSeconds",n,0),utcmilliseconds:t("getUTCMilliseconds",n,0),length:t("length",null,-1),parseFloat:"parseFloat",parseInt:"parseInt",upper:t("toUpperCase",r,0),lower:t("toLowerCase",r,0),substring:t("substring",r),split:t("split",r),trim:t("trim",r,0),regexp:a,test:t("test",a),if:function(t){t.length<3&&ue("Missing arguments to if function."),t.length>3&&ue("Too many arguments to if function.");var n=t.map(e);return"("+n[0]+"?"+n[1]+":"+n[2]+")"}}}function ene(e){var t=(e=e||{}).allowed?Ft(e.allowed):{},n=e.forbidden?Ft(e.forbidden):{},r=e.constants||Qte,a=(e.functions||Jte)(f),i=e.globalvar,o=e.fieldvar,u=Ye(i)?i:function(e){return"".concat(i,'["').concat(e,'"]')},s={},c={},l=0;function f(e){if(bt(e))return e;var t=d[e.type];return null==t&&ue("Unsupported type: "+e.type),t(e)}var d={Literal:function(e){return e.raw},Identifier:function(e){var a=e.name;return l>0?a:st(n,a)?ue("Illegal identifier: "+a):st(r,a)?r[a]:st(t,a)?a:(s[a]=1,u(a))},MemberExpression:function(e){var t=!e.computed,n=f(e.object);t&&(l+=1);var r=f(e.property);return n===o&&(c[function(e){var t=e&&e.length-1;return t&&('"'===e[0]&&'"'===e[t]||"'"===e[0]&&"'"===e[t])?e.slice(1,-1):e}(r)]=1),t&&(l-=1),n+(t?"."+r:"["+r+"]")},CallExpression:function(e){"Identifier"!==e.callee.type&&ue("Illegal callee type: "+e.callee.type);var t=e.callee.name,n=e.arguments,r=st(a,t)&&a[t];return r||ue("Unrecognized function: "+t),Ye(r)?r(n):r+"("+n.map(f).join(",")+")"},ArrayExpression:function(e){return"["+e.elements.map(f).join(",")+"]"},BinaryExpression:function(e){return"("+f(e.left)+" "+e.operator+" "+f(e.right)+")"},UnaryExpression:function(e){return"("+e.operator+f(e.argument)+")"},ConditionalExpression:function(e){return"("+f(e.test)+"?"+f(e.consequent)+":"+f(e.alternate)+")"},LogicalExpression:function(e){return"("+f(e.left)+e.operator+f(e.right)+")"},ObjectExpression:function(e){return"{"+e.properties.map(f).join(",")+"}"},Property:function(e){l+=1;var t=f(e.key);return l-=1,t+":"+f(e.value)}};function h(e){var t={code:f(e),globals:Object.keys(s),fields:Object.keys(c)};return s={},c={},t}return h.functions=a,h.constants=r,h}var tne,nne,rne="[",ane="]",ine=/[[\]{}]/,one={"*":1,arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1};function une(e,t,n){return tne=t||"view",nne=n||one,cne(e.trim()).map(lne)}function sne(e,t,n,r,a){for(var i,o=e.length,u=0;t<o;++t){if(i=e[t],!u&&i===n)return t;a&&a.indexOf(i)>=0?--u:r&&r.indexOf(i)>=0&&++u}return t}function cne(e){for(var t=[],n=e.length,r=0,a=0;a<n;)a=sne(e,a,",","[{","]}"),t.push(e.substring(r,a).trim()),r=++a;if(0===t.length)throw"Empty event selector: "+e;return t}function lne(e){return"["===e[0]?function(e){var t,n=e.length,r=1;if((r=sne(e,r,ane,rne,ane))===n)throw"Empty between selector: "+e;if(2!==(t=cne(e.substring(1,r))).length)throw"Between selector must have two elements: "+e;if(">"!==(e=e.slice(r+1).trim())[0])throw"Expected '>' after between selector: "+e;t=t.map(lne);var a=lne(e.slice(1).trim());if(a.between)return{between:t,stream:a};a.between=t;return a}(e):function(e){var t,n,r={source:tne},a=[],i=[0,0],o=0,u=0,s=e.length,c=0;if("}"===e[s-1]){if(!((c=e.lastIndexOf("{"))>=0))throw"Unmatched right brace: "+e;try{i=function(e){var t=e.split(",");if(!e.length||t.length>2)throw e;return t.map((function(t){var n=+t;if(n!==n)throw e;return n}))}(e.substring(c+1,s-1))}catch(l){throw"Invalid throttle specification: "+e}s=(e=e.slice(0,c).trim()).length,c=0}if(!s)throw e;"@"===e[0]&&(o=++c);(t=sne(e,c,":"))<s&&(a.push(e.substring(u,t).trim()),u=c=++t);if((c=sne(e,c,rne))===s)a.push(e.substring(u,s).trim());else if(a.push(e.substring(u,c).trim()),n=[],(u=++c)===s)throw"Unmatched left bracket: "+e;for(;c<s;){if((c=sne(e,c,ane))===s)throw"Unmatched left bracket: "+e;if(n.push(e.substring(u,c).trim()),c<s-1&&e[++c]!==rne)throw"Expected left bracket: "+e;u=++c}if(!(s=a.length)||ine.test(a[s-1]))throw"Invalid event selector: "+e;s>1?(r.type=a[1],o?r.markname=a[0].slice(1):!function(e){return nne[e]}(a[0])?r.source=a[0]:r.marktype=a[0]):r.type=a[0];"!"===r.type.slice(-1)&&(r.consume=!0,r.type=r.type.slice(0,-1));null!=n&&(r.filter=n);i[0]&&(r.throttle=i[0]);i[1]&&(r.debounce=i[1]);return r}(e)}var fne="5.20.0";at(ku,i,o,s,c,l,d,f,h,p,v,m);var dne=fne;function hne(e,t,n){return e.fields=t||[],e.fname=n,e}function pne(e){return 1===e.length?vne(e[0]):mne(e)}var vne=function(e){return function(t){return t[e]}},mne=function(e){var t=e.length;return function(n){for(var r=0;r<t;++r)n=n[e[r]];return n}};function gne(e){throw Error(e)}function yne(e){var t,n,r,a=[],i=null,o=0,u=e.length,s="";function c(){a.push(s+e.substring(t,n)),s="",t=n+1}for(e+="",t=n=0;n<u;++n)if("\\"===(r=e[n]))s+=e.substring(t,n),s+=e.substring(++n,++n),t=n;else if(r===i)c(),i=null,o=-1;else{if(i)continue;t===o&&'"'===r||t===o&&"'"===r?(t=n+1,i=r):"."!==r||o?"["===r?(n>t&&c(),o=t=n+1):"]"===r&&(o||gne("Access path missing open bracket: "+e),o>0&&c(),o=0,t=n+1):n>t?c():t=n+1}return o&&gne("Access path missing closing bracket: "+e),i&&gne("Access path missing closing quote: "+e),n>t&&(n++,c()),a}var bne=[],xne=(function(e,t,n){var r=yne(e);e=1===r.length?r[0]:e,hne((n&&n.get||pne)(r),[e],t||e)}("id"),hne((function(e){return e}),bne,"identity"));hne((function(){return 0}),bne,"zero"),hne((function(){return 1}),bne,"one"),hne((function(){return!0}),bne,"true"),hne((function(){return!1}),bne,"false");function wne(e,t,n){var r=[t].concat([].slice.call(n));console[e].apply(console,r)}var kne=Array.isArray;function _ne(e){return e===Object(e)}var Sne=function(e){return"__proto__"!==e};function Cne(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.reduce((function(e,t){for(var n in t)if("signals"===n)e.signals=Ene(e.signals,t.signals);else{var r="legend"===n?{layout:1}:"style"===n||null;Ane(e,n,t[n],r)}return e}),{})}function Ane(e,t,n,r){var a,i;if(Sne(t))if(_ne(n)&&!kne(n))for(a in i=_ne(e[t])?e[t]:e[t]={},n)r&&(!0===r||r[a])?Ane(i,a,n[a]):Sne(a)&&(i[a]=n[a]);else e[t]=n}function Ene(e,t){if(null==e)return t;var n={},r=[];function a(e){n[e.name]||(n[e.name]=1,r.push(e))}return t.forEach(a),e.forEach(a),r}function Nne(e){return null!=e?kne(e)?e:[e]:[]}var Tne=Object.prototype.hasOwnProperty;function Ine(e,t){return Tne.call(e,t)}function Dne(e){return"boolean"===typeof e}function Fne(e){return"number"===typeof e}function Mne(e){return"string"===typeof e}function One(e){return kne(e)?"["+e.map(One)+"]":_ne(e)||Mne(e)?JSON.stringify(e).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):e}function Rne(e){for(var t={},n=0,r=e.length;n<r;++n)t[e[n]]=!0;return t}function jne(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]])}return n}Object.create;Object.create;Array.prototype.flat||Object.defineProperty(Array.prototype,"flat",{configurable:!0,value:function e(){var t=isNaN(arguments[0])?1:Number(arguments[0]);return t?Array.prototype.reduce.call(this,(function(n,r){return Array.isArray(r)?n.push.apply(n,e.call(r,t-1)):n.push(r),n}),[]):Array.prototype.slice.call(this)},writable:!0}),Array.prototype.flatMap||Object.defineProperty(Array.prototype,"flatMap",{configurable:!0,value:function(e){return Array.prototype.map.apply(this,arguments).flat()},writable:!0});var Bne=n(3991),zne=n.n(Bne),Zne=n(8262),Lne=n.n(Zne),Pne=n(2248),Une=n.n(Pne);function Wne(e){return!!e.or}function Vne(e){return!!e.and}function qne(e){return!!e.not}function Gne(e,t){if(qne(e))Gne(e.not,t);else if(Vne(e)){var n,r=(0,Rt.Z)(e.and);try{for(r.s();!(n=r.n()).done;){Gne(n.value,t)}}catch(o){r.e(o)}finally{r.f()}}else if(Wne(e)){var a,i=(0,Rt.Z)(e.or);try{for(i.s();!(a=i.n()).done;){Gne(a.value,t)}}catch(o){i.e(o)}finally{i.f()}}else t(e)}function Hne(e,t){return qne(e)?{not:Hne(e.not,t)}:Vne(e)?{and:e.and.map((function(e){return Hne(e,t)}))}:Wne(e)?{or:e.or.map((function(e){return Hne(e,t)}))}:t(e)}var Xne=Lne(),Kne=zne();function Yne(e,t){var n,r={},a=(0,Rt.Z)(t);try{for(a.s();!(n=a.n()).done;){var i=n.value;Ine(e,i)&&(r[i]=e[i])}}catch(o){a.e(o)}finally{a.f()}return r}function $ne(e,t){var n,r=Object.assign({},e),a=(0,Rt.Z)(t);try{for(a.s();!(n=a.n()).done;){delete r[n.value]}}catch(i){a.e(i)}finally{a.f()}return r}Set.prototype.toJSON=function(){return"Set(".concat((0,cn.Z)(this).map((function(e){return Une()(e)})).join(","),")")};var Qne=Une();function Jne(e){if(Fne(e))return e;var t=Mne(e)?e:Une()(e);if(t.length<250)return t;for(var n=0,r=0;r<t.length;r++){n=(n<<5)-n+t.charCodeAt(r),n&=n}return n}function ere(e){return!1===e||null===e}function tre(e,t){return e.indexOf(t)>-1}function nre(e,t){var n,r=0,a=(0,Rt.Z)(e.entries());try{for(a.s();!(n=a.n()).done;){var i=(0,Cn.Z)(n.value,2),o=i[0];if(t(i[1],o,r++))return!0}}catch(u){a.e(u)}finally{a.f()}return!1}function rre(e,t){var n,r=0,a=(0,Rt.Z)(e.entries());try{for(a.s();!(n=a.n()).done;){var i=(0,Cn.Z)(n.value,2),o=i[0];if(!t(i[1],o,r++))return!1}}catch(u){a.e(u)}finally{a.f()}return!0}function are(e,t){var n,r=(0,Rt.Z)(lre(t));try{for(r.s();!(n=r.n()).done;){var a=n.value;Ane(e,a,t[a],!0)}}catch(i){r.e(i)}finally{r.f()}}function ire(e,t){var n,r,a=[],i={},o=(0,Rt.Z)(e);try{for(o.s();!(r=o.n()).done;){var u=r.value;(n=t(u))in i||(i[n]=1,a.push(u))}}catch(s){o.e(s)}finally{o.f()}return a}function ore(e,t){var n,r=(0,Rt.Z)(e);try{for(r.s();!(n=r.n()).done;){var a=n.value;if(t.has(a))return!0}}catch(i){r.e(i)}finally{r.f()}return!1}function ure(e){var t,n=new Set,r=(0,Rt.Z)(e);try{var a=function(){var e,r=yne(t.value).map((function(e,t){return 0===t?e:"[".concat(e,"]")})),a=r.map((function(e,t){return r.slice(0,t+1).join("")})),i=(0,Rt.Z)(a);try{for(i.s();!(e=i.n()).done;){var o=e.value;n.add(o)}}catch(u){i.e(u)}finally{i.f()}};for(r.s();!(t=r.n()).done;)a()}catch(i){r.e(i)}finally{r.f()}return n}function sre(e,t){return void 0===e||void 0===t||ore(ure(e),ure(t))}function cre(e){return 0===lre(e).length}var lre=Object.keys,fre=Object.values;function dre(e){var t=[];for(var n in e)Ine(e,n)&&t.push({key:n,value:e[n]});return t}function hre(e){return!0===e||!1===e}function pre(e){var t=e.replace(/\W/g,"_");return(e.match(/^\d+/)?"_":"")+t}function vre(e,t){return qne(e)?"!("+vre(e.not,t)+")":Vne(e)?"("+e.and.map((function(e){return vre(e,t)})).join(") && (")+")":Wne(e)?"("+e.or.map((function(e){return vre(e,t)})).join(") || (")+")":t(e)}function mre(e,t){if(0===t.length)return!0;var n=t.shift();return n in e&&mre(e[n],t)&&delete e[n],cre(e)}function gre(e){return e.charAt(0).toUpperCase()+e.substr(1)}function yre(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"datum",n=yne(e),r=[],a=1;a<=n.length;a++){var i="[".concat(n.slice(0,a).map(One).join("]["),"]");r.push("".concat(t).concat(i))}return r.join(" && ")}function bre(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"datum";return"".concat(t,"[").concat(One(yne(e).join(".")),"]")}function xre(e){return e.replace(/(\[|\]|\.|'|")/g,"\\$1")}function wre(e){return"".concat(yne(e).map(xre).join("\\."))}function kre(e,t,n){return e.replace(new RegExp(t.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&"),"g"),n)}function _re(e){return"".concat(yne(e).join("."))}function Sre(e){return e?yne(e).length:0}function Cre(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(var r=0,a=t;r<a.length;r++){var i=a[r];if(void 0!==i)return i}}var Are=42;function Ere(e){return function(e){return 0===e.indexOf("__")}(e)?e:"__".concat(e)}function Nre(e){if(void 0!==e)return(e%360+360)%360}function Tre(e){return!!Fne(e)||!isNaN(e)&&!isNaN(parseFloat(e))}var Ire={domainColor:{part:"domain",vgProp:"stroke"},labelAlign:{part:"labels",vgProp:"align"},labelBaseline:{part:"labels",vgProp:"baseline"},labelColor:{part:"labels",vgProp:"fill"},labelFont:{part:"labels",vgProp:"font"},labelFontSize:{part:"labels",vgProp:"fontSize"},labelFontStyle:{part:"labels",vgProp:"fontStyle"},labelFontWeight:{part:"labels",vgProp:"fontWeight"},labelOpacity:{part:"labels",vgProp:"opacity"},labelOffset:null,labelPadding:null,gridColor:{part:"grid",vgProp:"stroke"},gridDash:{part:"grid",vgProp:"strokeDash"},gridDashOffset:{part:"grid",vgProp:"strokeDash"},gridOpacity:{part:"grid",vgProp:"opacity"},gridWidth:{part:"grid",vgProp:"strokeWidth"},tickColor:{part:"ticks",vgProp:"stroke"},tickDash:{part:"ticks",vgProp:"strokeDash"},tickDashOffset:{part:"ticks",vgProp:"strokeDash"},tickOpacity:{part:"ticks",vgProp:"opacity"},tickSize:null,tickWidth:{part:"ticks",vgProp:"strokeWidth"},titleColor:{part:"title",vgProp:"fill"},title:null};function Dre(e){return e&&e.condition}var Fre=["domain","grid","labels","ticks","title"],Mre={grid:"grid",gridCap:"grid",gridColor:"grid",gridDash:"grid",gridDashOffset:"grid",gridOpacity:"grid",gridScale:"grid",gridWidth:"grid",orient:"main",bandPosition:"both",aria:"main",description:"main",domain:"main",domainCap:"main",domainColor:"main",domainDash:"main",domainDashOffset:"main",domainOpacity:"main",domainWidth:"main",format:"main",formatType:"main",labelAlign:"main",labelAngle:"main",labelBaseline:"main",labelBound:"main",labelColor:"main",labelFlush:"main",labelFlushOffset:"main",labelFont:"main",labelFontSize:"main",labelFontStyle:"main",labelFontWeight:"main",labelLimit:"main",labelLineHeight:"main",labelOffset:"main",labelOpacity:"main",labelOverlap:"main",labelPadding:"main",labels:"main",labelSeparation:"main",maxExtent:"main",minExtent:"main",offset:"both",position:"main",tickCap:"main",tickColor:"main",tickDash:"main",tickDashOffset:"main",tickMinStep:"main",tickOffset:"both",tickOpacity:"main",tickRound:"both",ticks:"main",tickSize:"main",tickWidth:"both",title:"main",titleAlign:"main",titleAnchor:"main",titleAngle:"main",titleBaseline:"main",titleColor:"main",titleFont:"main",titleFontSize:"main",titleFontStyle:"main",titleFontWeight:"main",titleLimit:"main",titleLineHeight:"main",titleOpacity:"main",titlePadding:"main",titleX:"main",titleY:"main",encode:"both",scale:"both",tickBand:"both",tickCount:"both",tickExtra:"both",translate:"both",values:"both",zindex:"both"},Ore={orient:1,aria:1,bandPosition:1,description:1,domain:1,domainCap:1,domainColor:1,domainDash:1,domainDashOffset:1,domainOpacity:1,domainWidth:1,format:1,formatType:1,grid:1,gridCap:1,gridColor:1,gridDash:1,gridDashOffset:1,gridOpacity:1,gridWidth:1,labelAlign:1,labelAngle:1,labelBaseline:1,labelBound:1,labelColor:1,labelFlush:1,labelFlushOffset:1,labelFont:1,labelFontSize:1,labelFontStyle:1,labelFontWeight:1,labelLimit:1,labelLineHeight:1,labelOffset:1,labelOpacity:1,labelOverlap:1,labelPadding:1,labels:1,labelSeparation:1,maxExtent:1,minExtent:1,offset:1,position:1,tickBand:1,tickCap:1,tickColor:1,tickCount:1,tickDash:1,tickDashOffset:1,tickExtra:1,tickMinStep:1,tickOffset:1,tickOpacity:1,tickRound:1,ticks:1,tickSize:1,tickWidth:1,title:1,titleAlign:1,titleAnchor:1,titleAngle:1,titleBaseline:1,titleColor:1,titleFont:1,titleFontSize:1,titleFontStyle:1,titleFontWeight:1,titleLimit:1,titleLineHeight:1,titleOpacity:1,titlePadding:1,titleX:1,titleY:1,translate:1,values:1,zindex:1},Rre=Object.assign(Object.assign({},Ore),{style:1,labelExpr:1,encoding:1});function jre(e){return!!Rre[e]}lre(Rre);var Bre={arc:"arc",area:"area",bar:"bar",image:"image",line:"line",point:"point",rect:"rect",rule:"rule",text:"text",tick:"tick",trail:"trail",circle:"circle",square:"square",geoshape:"geoshape"},zre=Bre.arc,Zre=Bre.area,Lre=Bre.bar,Pre=Bre.image,Ure=Bre.line,Wre=Bre.point,Vre=Bre.rect,qre=Bre.rule,Gre=Bre.text,Hre=Bre.tick,Xre=Bre.trail,Kre=Bre.circle,Yre=Bre.square,$re=Bre.geoshape;function Qre(e){return tre(["line","area","trail"],e)}function Jre(e){return tre(["rect","bar","image","arc"],e)}var eae=lre(Bre);function tae(e){return e.type}Rne(eae);var nae=[].concat(["stroke","strokeWidth","strokeDash","strokeDashOffset","strokeOpacity","strokeJoin","strokeMiterLimit"],["fill","fillOpacity"]),rae=lre({color:1,filled:1,invalid:1,order:1,radius2:1,theta2:1,timeUnitBand:1,timeUnitBandPosition:1}),aae={horizontal:["cornerRadiusTopRight","cornerRadiusBottomRight"],vertical:["cornerRadiusTopLeft","cornerRadiusTopRight"]},iae={binSpacing:1,continuousBandSize:5,timeUnitBandPosition:.5},oae={binSpacing:0,continuousBandSize:5,timeUnitBandPosition:.5};function uae(e){return"mark"in e}var sae=function(){function e(t,n){(0,op.Z)(this,e),this.name=t,this.run=n}return(0,up.Z)(e,[{key:"hasMatchingType",value:function(e){return!!uae(e)&&function(e){return tae(e)?e.type:e}(e.mark)===this.name}}]),e}(),cae={argmax:1,argmin:1,average:1,count:1,distinct:1,product:1,max:1,mean:1,median:1,min:1,missing:1,q1:1,q3:1,ci0:1,ci1:1,stderr:1,stdev:1,stdevp:1,sum:1,valid:1,values:1,variance:1,variancep:1},lae={count:1,min:1,max:1};function fae(e){return!!e&&!!e.argmin}function dae(e){return!!e&&!!e.argmax}lre(cae);function hae(e){return Mne(e)&&!!cae[e]}var pae=["count","valid","missing","distinct"];function vae(e){return Mne(e)&&tre(pae,e)}var mae=["count","sum","distinct","valid","missing"],gae=Rne(["mean","average","median","q1","q3","min","max"]),yae="row",bae="column",xae="facet",wae="x",kae="y",_ae="x2",Sae="y2",Cae="radius",Aae="radius2",Eae="theta",Nae="theta2",Tae="latitude",Iae="longitude",Dae="latitude2",Fae="longitude2",Mae="color",Oae="fill",Rae="stroke",jae="shape",Bae="size",zae="angle",Zae="opacity",Lae="fillOpacity",Pae="strokeOpacity",Uae="strokeWidth",Wae="strokeDash",Vae="text",qae="order",Gae="detail",Hae="key",Xae="tooltip",Kae="href",Yae="url",$ae="description",Qae={theta:1,theta2:1,radius:1,radius2:1};function Jae(e){return e in Qae}var eie={longitude:1,longitude2:1,latitude:1,latitude2:1};var tie=lre(eie),nie=Object.assign(Object.assign(Object.assign(Object.assign({},{x:1,y:1,x2:1,y2:1}),Qae),eie),{color:1,fill:1,stroke:1,opacity:1,fillOpacity:1,strokeOpacity:1,strokeWidth:1,strokeDash:1,size:1,angle:1,shape:1,order:1,text:1,detail:1,key:1,tooltip:1,href:1,url:1,description:1});function rie(e){return e===Mae||e===Oae||e===Rae}var aie={row:1,column:1,facet:1},iie=lre(aie),oie=Object.assign(Object.assign({},nie),aie),uie=lre(oie),sie=(oie.order,oie.detail,oie.tooltip,jne(oie,["order","detail","tooltip"])),cie=(sie.row,sie.column,sie.facet,jne(sie,["row","column","facet"]));lre(sie),lre(cie);function lie(e){return!!oie[e]}var fie=[_ae,Sae,Dae,Fae,Nae,Aae];function die(e){return hie(e)!==e}function hie(e){switch(e){case _ae:return wae;case Sae:return kae;case Dae:return Tae;case Fae:return Iae;case Nae:return Eae;case Aae:return Cae}return e}function pie(e){if(Jae(e))switch(e){case Eae:return"startAngle";case Nae:return"endAngle";case Cae:return"outerRadius";case Aae:return"innerRadius"}return e}function vie(e){switch(e){case wae:return _ae;case kae:return Sae;case Tae:return Dae;case Iae:return Fae;case Eae:return Nae;case Cae:return Aae}}function mie(e){switch(e){case wae:case _ae:return"width";case kae:case Sae:return"height"}}lre(nie),nie.x,nie.y,nie.x2,nie.y2,nie.latitude,nie.longitude,nie.latitude2,nie.longitude2,nie.theta,nie.theta2,nie.radius,nie.radius2;var gie=jne(nie,["x","y","x2","y2","latitude","longitude","latitude2","longitude2","theta","theta2","radius","radius2"]),yie=lre(gie),bie={x:1,y:1},xie=lre(bie);function wie(e){return e in bie}var kie={theta:1,radius:1},_ie=lre(kie);function Sie(e){return"width"===e?wae:kae}gie.text,gie.tooltip,gie.href,gie.url,gie.description,gie.detail,gie.key,gie.order;var Cie=jne(gie,["text","tooltip","href","url","description","detail","key","order"]),Aie=lre(Cie);var Eie=Object.assign(Object.assign(Object.assign({},bie),kie),Cie),Nie=lre(Eie);function Tie(e){return!!Eie[e]}function Iie(e,t){return function(e){switch(e){case Mae:case Oae:case Rae:case $ae:case Gae:case Hae:case Xae:case Kae:case qae:case Zae:case Lae:case Pae:case Uae:case xae:case yae:case bae:return Die;case wae:case kae:case Tae:case Iae:return Fie;case _ae:case Sae:case Dae:case Fae:return{area:"always",bar:"always",image:"always",rect:"always",rule:"always",circle:"binned",point:"binned",square:"binned",tick:"binned",line:"binned",trail:"binned"};case Bae:return{point:"always",tick:"always",rule:"always",circle:"always",square:"always",bar:"always",text:"always",line:"always",trail:"always"};case Wae:return{line:"always",point:"always",tick:"always",rule:"always",circle:"always",square:"always",bar:"always",geoshape:"always"};case jae:return{point:"always",geoshape:"always"};case Vae:return{text:"always"};case zae:return{point:"always",square:"always",text:"always"};case Yae:return{image:"always"};case Eae:case Cae:return{text:"always",arc:"always"};case Nae:case Aae:return{arc:"always"}}}(e)[t]}var Die={arc:"always",area:"always",bar:"always",circle:"always",geoshape:"always",image:"always",line:"always",rule:"always",point:"always",rect:"always",square:"always",trail:"always",text:"always",tick:"always"},Fie=jne(Die,["geoshape"]);function Mie(e){switch(e){case wae:case kae:case Eae:case Cae:case Bae:case zae:case Uae:case Zae:case Lae:case Pae:case _ae:case Sae:case Nae:case Aae:return;case xae:case yae:case bae:case jae:case Wae:case Vae:case Xae:case Kae:case Yae:case $ae:return"discrete";case Mae:case Oae:case Rae:return"flexible";case Tae:case Iae:case Dae:case Fae:case Gae:case Hae:case qae:return}}function Oie(e){return Dne(e)&&(e=uce(e,void 0)),"bin"+lre(e).map((function(t){return zie(e[t])?pre("_".concat(t,"_").concat(Object.entries(e[t]))):pre("_".concat(t,"_").concat(e[t]))})).join("")}function Rie(e){return!0===e||Bie(e)&&!e.binned}function jie(e){return"binned"===e||Bie(e)&&!0===e.binned}function Bie(e){return _ne(e)}function zie(e){return null===e||void 0===e?void 0:e.selection}function Zie(e){switch(e){case yae:case bae:case Bae:case Mae:case Oae:case Rae:case Uae:case Zae:case Lae:case Pae:case jae:return 6;case Wae:return 4;default:return 10}}var Lie=n(5647);function Pie(e){return"Invalid specification ".concat(JSON.stringify(e),'. Make sure the specification includes at least one of the following properties: "mark", "layer", "facet", "hconcat", "vconcat", "concat", or "repeat".')}var Uie='Autosize "fit" only works for single views and layered views.';function Wie(e){return"".concat("width"==e?"Width":"Height",' "container" only works for single views and layered views.')}function Vie(e){var t="width"==e?"x":"y";return"".concat("width"==e?"Width":"Height",' "container" only works well with autosize "fit" or "fit-').concat(t,'".')}function qie(e){return e?'Dropping "fit-'.concat(e,'" because spec has discrete ').concat(mie(e),"."):'Dropping "fit" because spec has discrete size.'}function Gie(e){return'Cannot project a selection on encoding channel "'.concat(e,'", which has no field.')}function Hie(e,t){return'Cannot project a selection on encoding channel "'.concat(e,'" as it uses an aggregate function ("').concat(t,'").')}function Xie(e){return"Selection not supported for ".concat(e," yet.")}function Kie(e){return'The "columns" property cannot be used when "'.concat(e,'" has nested row/column.')}function Yie(e,t,n){return'An ancestor parsed field "'.concat(e,'" as ').concat(n," but a child wants to parse the field as ").concat(t,".")}function $ie(e){return"Ignoring an invalid transform: ".concat(Qne(e),".")}function Qie(e){return"Config.customFormatTypes is not true, thus custom format type and format for channel ".concat(e," are dropped.")}function Jie(e){return'Invalid field type "'.concat(e,'".')}function eoe(e,t){var n=t.fill,r=t.stroke;return"Dropping color ".concat(e," as the plot also has ").concat(n&&r?"fill and stroke":n?"fill":"stroke",".")}function toe(e,t){return"Dropping ".concat(Qne(e),' from channel "').concat(t,'" since it does not contain any data field, datum, value, or signal.')}function noe(e,t,n){return"".concat(e,' dropped as it is incompatible with "').concat(t,'"').concat(n?" when ".concat(n):"",".")}function roe(e){return"".concat(e," encoding should be discrete (ordinal / nominal / binned).")}function aoe(e,t){return'Using discrete channel "'.concat(e,'" to encode "').concat(t,'" field can be misleading as it does not encode ').concat("ordinal"===t?"order":"magnitude",".")}function ioe(e){return"Using unaggregated domain with raw field has no effect (".concat(Qne(e),").")}function ooe(e){return'Unaggregated domain not applicable for "'.concat(e,'" since it produces values outside the origin domain of the source data.')}function uoe(e){return"Unaggregated domain is currently unsupported for log scale (".concat(Qne(e),").")}function soe(e,t,n){return"".concat(n,"-scale's \"").concat(t,'" is dropped as it does not work with ').concat(e," scale.")}function coe(e){return'The step for "'.concat(e,'" is dropped because the ').concat("width"===e?"x":"y"," is continuous.")}var loe="Domains that should be unioned has conflicting sort properties. Sort will be set to true.";function foe(e){return'Cannot stack "'.concat(e,'" if there is already "').concat(e,'2".')}function doe(e){return"Cannot stack non-linear scale (".concat(e,").")}function hoe(e){return'Stacking is applied even though the aggregate function is non-summative ("'.concat(e,'").')}function poe(e,t){return"Invalid ".concat(e,": ").concat(Qne(t),".")}function voe(e){return"1D error band does not support ".concat(e,".")}function moe(e){return"Channel ".concat(e,' is required for "binned" bin.')}var goe=function(e,t){var n=e||0;return{level:function(e){return arguments.length?(n=+e,this):n},error:function(){return n>=1&&wne(t||"error","ERROR",arguments),this},warn:function(){return n>=2&&wne(t||"warn","WARN",arguments),this},info:function(){return n>=3&&wne(t||"log","INFO",arguments),this},debug:function(){return n>=4&&wne(t||"log","DEBUG",arguments),this}}}(2),yoe=goe;function boe(e){return yoe=e}function xoe(){return yoe=goe}function woe(){var e;(e=yoe).warn.apply(e,arguments)}function koe(e){if(e&&_ne(e)){var t,n=(0,Rt.Z)(Foe);try{for(n.s();!(t=n.n()).done;){if(t.value in e)return!0}}catch(r){n.e(r)}finally{n.f()}}return!1}var _oe=["january","february","march","april","may","june","july","august","september","october","november","december"],Soe=_oe.map((function(e){return e.substr(0,3)})),Coe=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"],Aoe=Coe.map((function(e){return e.substr(0,3)}));function Eoe(e,t){var n=[];if(t&&void 0!==e.day&&lre(e).length>1&&(woe(function(e){return"Dropping day from datetime ".concat(Qne(e)," as day cannot be combined with other units.")}(e)),delete(e=Kne(e)).day),void 0!==e.year?n.push(e.year):n.push(2012),void 0!==e.month){var r=t?function(e){if(Tre(e)&&(e=+e),Fne(e))return e-1;var t=e.toLowerCase(),n=_oe.indexOf(t);if(-1!==n)return n;var r=t.substr(0,3),a=Soe.indexOf(r);if(-1!==a)return a;throw new Error(poe("month",e))}(e.month):e.month;n.push(r)}else if(void 0!==e.quarter){var a=t?function(e){if(Tre(e)&&(e=+e),Fne(e))return e>4&&woe(poe("quarter",e)),e-1;throw new Error(poe("quarter",e))}(e.quarter):e.quarter;n.push(Fne(a)?3*a:a+"*3")}else n.push(0);if(void 0!==e.date)n.push(e.date);else if(void 0!==e.day){var i=t?function(e){if(Tre(e)&&(e=+e),Fne(e))return e%7;var t=e.toLowerCase(),n=Coe.indexOf(t);if(-1!==n)return n;var r=t.substr(0,3),a=Aoe.indexOf(r);if(-1!==a)return a;throw new Error(poe("day",e))}(e.day):e.day;n.push(Fne(i)?i+1:i+"+1")}else n.push(1);for(var o=0,u=["hours","minutes","seconds","milliseconds"];o<u.length;o++){var s=e[u[o]];n.push("undefined"===typeof s?0:s)}return n}function Noe(e){var t=Eoe(e,!0).join(", ");return e.utc?"utc(".concat(t,")"):"datetime(".concat(t,")")}function Toe(e){var t=Eoe(e,!1).join(", ");return e.utc?"utc(".concat(t,")"):"datetime(".concat(t,")")}function Ioe(e){var t=Eoe(e,!0);return e.utc?+new Date(Date.UTC.apply(Date,(0,cn.Z)(t))):+(0,Lie.Z)(Date,(0,cn.Z)(t))}var Doe={year:1,quarter:1,month:1,week:1,day:1,dayofyear:1,date:1,hours:1,minutes:1,seconds:1,milliseconds:1},Foe=lre(Doe);function Moe(e){return e.startsWith("utc")}var Ooe={"year-month":"%b %Y ","year-month-date":"%b %d, %Y "};function Roe(e){var t,n=[],r=(0,Rt.Z)(Foe);try{for(r.s();!(t=r.n()).done;){var a=t.value;joe(e,a)&&n.push(a)}}catch(i){r.e(i)}finally{r.f()}return n}function joe(e,t){var n=e.indexOf(t);return!(n<0)&&(!(n>0&&"seconds"===t&&"i"===e.charAt(n-1))&&(!(e.length>n+3&&"day"===t&&"o"===e.charAt(n+3))&&!(n>0&&"year"===t&&"f"===e.charAt(n-1))))}function Boe(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{end:!1},a=r.end,i=yre(t),o=Moe(e)?"utc":"";function u(e){return"quarter"===e?"(".concat(o,"quarter(").concat(i,")-1)"):"".concat(o).concat(e,"(").concat(i,")")}var s,c={},l=(0,Rt.Z)(Foe);try{for(l.s();!(s=l.n()).done;){var f=s.value;joe(e,f)&&(c[f]=u(f),n=f)}}catch(d){l.e(d)}finally{l.f()}return a&&(c[n]+="+1"),Toe(c)}function zoe(e){if(e){var t=Roe(e);return"timeUnitSpecifier(".concat(Une()(t),", ").concat(Une()(Ooe),")")}}function Zoe(e){var t;if(e)return Mne(e)?t={unit:e}:_ne(e)&&(t=Object.assign(Object.assign({},e),e.unit?{unit:e.unit}:{})),Moe(t.unit)&&(t.utc=!0,t.unit=t.unit.substr(3)),t}function Loe(e){var t=Zoe(e),n=t.utc,r=jne(t,["utc"]);return r.unit?(n?"utc":"")+lre(r).map((function(e){return pre("".concat("unit"===e?"":"_".concat(e,"_")).concat(r[e]))})).join(""):(n?"utc":"")+"timeunit"+lre(r).map((function(e){return pre("_".concat(e,"_").concat(r[e]))})).join("")}function Poe(e){return e&&!!e.signal}function Uoe(e){return!!e.step}function Woe(e){return!kne(e)&&("field"in e&&"data"in e)}var Voe=lre({aria:1,description:1,ariaRole:1,ariaRoleDescription:1,blend:1,opacity:1,fill:1,fillOpacity:1,stroke:1,strokeCap:1,strokeWidth:1,strokeOpacity:1,strokeDash:1,strokeDashOffset:1,strokeJoin:1,strokeOffset:1,strokeMiterLimit:1,startAngle:1,endAngle:1,padAngle:1,innerRadius:1,outerRadius:1,size:1,shape:1,interpolate:1,tension:1,orient:1,align:1,baseline:1,text:1,dir:1,dx:1,dy:1,ellipsis:1,limit:1,radius:1,theta:1,angle:1,font:1,fontSize:1,fontWeight:1,fontStyle:1,lineBreak:1,lineHeight:1,cursor:1,href:1,tooltip:1,cornerRadius:1,cornerRadiusTopLeft:1,cornerRadiusTopRight:1,cornerRadiusBottomLeft:1,cornerRadiusBottomRight:1,aspect:1,width:1,height:1}),qoe={arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1},Goe=["cornerRadius","cornerRadiusTopLeft","cornerRadiusTopRight","cornerRadiusBottomLeft","cornerRadiusBottomRight"];function Hoe(e){return e&&!!e.field&&void 0!==e.equal}function Xoe(e){return e&&!!e.field&&void 0!==e.lt}function Koe(e){return e&&!!e.field&&void 0!==e.lte}function Yoe(e){return e&&!!e.field&&void 0!==e.gt}function $oe(e){return e&&!!e.field&&void 0!==e.gte}function Qoe(e){if(e&&e.field){if(kne(e.range)&&2===e.range.length)return!0;if(Poe(e.range))return!0}return!1}function Joe(e){return e&&!!e.field&&(kne(e.oneOf)||kne(e.in))}function eue(e){return e&&!!e.field&&void 0!==e.valid}function tue(e){return Joe(e)||Hoe(e)||Qoe(e)||Xoe(e)||Yoe(e)||Koe(e)||$oe(e)}function nue(e,t){return lce(e,{timeUnit:t,wrapTime:!0})}function rue(e,t){return e.map((function(e){return nue(e,t)}))}function aue(e){var t,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=e.field,a=null===(t=Zoe(e.timeUnit))||void 0===t?void 0:t.unit,i=a?"time("+Boe(a,r)+")":Vse(e,{expr:"datum"});if(Hoe(e))return i+"==="+nue(e.equal,a);if(Xoe(e)){var o=e.lt;return"".concat(i,"<").concat(nue(o,a))}if(Yoe(e)){var u=e.gt;return"".concat(i,">").concat(nue(u,a))}if(Koe(e)){var s=e.lte;return"".concat(i,"<=").concat(nue(s,a))}if($oe(e)){var c=e.gte;return"".concat(i,">=").concat(nue(c,a))}if(Joe(e))return"indexof([".concat(rue(e.oneOf,a).join(","),"], ").concat(i,") !== -1");if(eue(e))return iue(i,e.valid);if(Qoe(e)){var l=e.range,f=Poe(l)?{signal:"".concat(l.signal,"[0]")}:l[0],d=Poe(l)?{signal:"".concat(l.signal,"[1]")}:l[1];if(null!==f&&null!==d&&n)return"inrange("+i+", ["+nue(f,a)+", "+nue(d,a)+"])";var h=[];return null!==f&&h.push("".concat(i," >= ").concat(nue(f,a))),null!==d&&h.push("".concat(i," <= ").concat(nue(d,a))),h.length>0?h.join(" && "):"true"}throw new Error("Invalid field predicate: ".concat(JSON.stringify(e)))}function iue(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return t?"isValid(".concat(e,") && isFinite(+").concat(e,")"):"!isValid(".concat(e,") || !isFinite(+").concat(e,")")}function oue(e){var t;return tue(e)&&e.timeUnit?Object.assign(Object.assign({},e),{timeUnit:null===(t=Zoe(e.timeUnit))||void 0===t?void 0:t.unit}):e}var uue={quantitative:"quantitative",ordinal:"ordinal",temporal:"temporal",nominal:"nominal",geojson:"geojson"};var sue=uue.quantitative,cue=uue.ordinal,lue=uue.temporal,fue=uue.nominal,due=uue.geojson,hue=lre(uue);var pue="linear",vue="log",mue="pow",gue="sqrt",yue="symlog",bue="time",xue="utc",wue="quantile",kue="quantize",_ue="threshold",Sue="point",Cue="band",Aue={linear:"numeric",log:"numeric",pow:"numeric",sqrt:"numeric",symlog:"numeric",identity:"numeric",sequential:"numeric",time:"time",utc:"time",ordinal:"ordinal","bin-ordinal":"bin-ordinal",point:"ordinal-position",band:"ordinal-position",quantile:"discretizing",quantize:"discretizing",threshold:"discretizing"},Eue=lre(Aue);function Nue(e,t){var n=Aue[e],r=Aue[t];return n===r||"ordinal-position"===n&&"time"===r||"ordinal-position"===r&&"time"===n}var Tue={linear:0,log:1,pow:1,sqrt:1,symlog:1,identity:1,sequential:1,time:0,utc:0,point:10,band:11,ordinal:0,"bin-ordinal":0,quantile:0,quantize:0,threshold:0};function Iue(e){return Tue[e]}var Due=["linear","log","pow","sqrt","symlog","time","utc"],Fue=Rne(Due),Mue=Rne(["linear","log","pow","sqrt","symlog"]);var Oue=Rne(["quantile","quantize","threshold"]),Rue=Rne(Due.concat(["quantile","quantize","threshold","sequential","identity"])),jue=Rne(["ordinal","bin-ordinal","point","band"]);function Bue(e){return e in jue}function zue(e){return e in Rue}function Zue(e){return e in Fue}function Lue(e){return e in Oue}function Pue(e){return null===e||void 0===e?void 0:e.selection}var Uue={type:1,domain:1,domainMid:1,align:1,range:1,scheme:1,bins:1,reverse:1,round:1,clamp:1,nice:1,base:1,exponent:1,constant:1,interpolate:1,zero:1,padding:1,paddingInner:1,paddingOuter:1},Wue=(lre(Uue),jne(Uue,["type","domain","range","scheme"])),Vue=lre(Wue);!function(){var e,t,n={},r=(0,Rt.Z)(uie);try{for(r.s();!(t=r.n()).done;){var a,i=t.value,o=(0,Rt.Z)(hue);try{for(o.s();!(a=o.n()).done;){var u,s=a.value,c=(0,Rt.Z)(Eue);try{for(c.s();!(u=c.n()).done;){var l=u.value,f=Kue(i,s);Xue(i,l)&&Hue(l,s)&&(n[f]=null!==(e=n[f])&&void 0!==e?e:[],n[f].push(l))}}catch(d){c.e(d)}finally{c.f()}}}catch(d){o.e(d)}finally{o.f()}}}catch(d){r.e(d)}finally{r.f()}}();function que(e,t){switch(t){case"type":case"domain":case"reverse":case"range":return!0;case"scheme":case"interpolate":return!tre(["point","band","identity"],e);case"bins":return!tre(["point","band","identity","ordinal"],e);case"round":return Zue(e)||"band"===e||"point"===e;case"padding":return Zue(e)||tre(["point","band"],e);case"paddingOuter":case"align":return tre(["point","band"],e);case"paddingInner":return"band"===e;case"domainMid":case"clamp":return Zue(e);case"nice":return Zue(e)||"quantize"===e||"threshold"===e;case"exponent":return"pow"===e;case"base":return"log"===e;case"constant":return"symlog"===e;case"zero":return zue(e)&&!tre(["log","time","utc","threshold","quantile"],e)}}function Gue(e,t){switch(t){case"interpolate":case"scheme":case"domainMid":return rie(e)?void 0:'Cannot use the scale property "'.concat(e,'" with non-color channel.');case"align":case"type":case"bins":case"domain":case"range":case"base":case"exponent":case"constant":case"nice":case"padding":case"paddingInner":case"paddingOuter":case"reverse":case"round":case"clamp":case"zero":return}}function Hue(e,t){return tre([cue,fue],t)?void 0===e||Bue(e):t===lue?tre([bue,xue,void 0],e):t!==sue||tre([vue,mue,gue,yue,wue,kue,_ue,pue,void 0],e)}function Xue(e,t){if(!Tie(e))return!1;switch(e){case wae:case kae:case Eae:case Cae:return Zue(t)||tre(["band","point"],t);case Bae:case Uae:case Zae:case Lae:case Pae:case zae:return Zue(t)||Lue(t)||tre(["band","point","ordinal"],t);case Mae:case Oae:case Rae:return"band"!==t;case Wae:return"ordinal"===t||Lue(t);case jae:return"ordinal"===t}}function Kue(e,t){return e+"_"+t}function Yue(e){var t=e.channel,n=e.channelDef,r=e.markDef,a=e.scale,i=e.config,o=nse(e);return Dse(n)&&!vae(n.aggregate)&&a&&Zue(a.get("type"))&&!1===a.get("zero")?$ue({fieldDef:n,channel:t,markDef:r,ref:o,config:i}):o}function $ue(e){var t=e.fieldDef,n=e.channel,r=e.markDef,a=e.ref,i=e.config;return Qre(r.type)||null===bce("invalid",r,i)?a:[Que(t,n),a]}function Que(e,t){var n=Jue(e,!0),r="y"===hie(t)?{field:{group:"height"}}:{value:0};return Object.assign({test:n},r)}function Jue(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return iue(Mne(e)?e:Vse(e,{expr:"datum"}),!t)}function ese(e,t,n,r){var a={};if(t&&(a.scale=t),Mse(e)){var i=e.datum;koe(i)?a.signal=Noe(i):Poe(i)?a.signal=i.signal:a.value=i}else a.field=Vse(e,n);if(r){var o=r.offset,u=r.band;o&&(a.offset=o),u&&(a.band=u)}return a}function tse(e){var t=e.scaleName,n=e.fieldOrDatumDef,r=e.fieldOrDatumDef2,a=e.offset,i=e.startSuffix,o=e.band,u=void 0===o?.5:o,s=0<u&&u<1?"datum":void 0,c=Vse(n,{expr:s,suffix:i}),l=void 0!==r?Vse(r,{expr:s}):Vse(n,{suffix:"end",expr:s}),f={};if(0===u||1===u){f.scale=t;var d=0===u?c:l;f.field=d}else{var h="".concat(u," * ").concat(c," + ").concat(1-u," * ").concat(l);f.signal='scale("'.concat(t,'", ').concat(h,")")}return a&&(f.offset=a),f}function nse(e){var t,n=e.channel,r=e.channelDef,a=e.channel2Def,i=e.markDef,o=e.config,u=e.scaleName,s=e.scale,c=e.stack,l=e.offset,f=e.defaultRef,d=e.band;if(r){if(jse(r)){if(Bse(r)){d=null!==d&&void 0!==d?d:Ase({channel:n,fieldDef:r,fieldDef2:a,markDef:i,stack:c,config:o,isMidPoint:!0});var h=r.bin,p=r.timeUnit,v=r.type;if(Rie(h)||d&&p&&v===lue)return c&&c.impute?ese(r,u,{binSuffix:"mid"},{offset:l}):d?tse({scaleName:u,fieldOrDatumDef:r,band:d,offset:l}):ese(r,u,dce(r,n)?{binSuffix:"range"}:{},{offset:l});if(jie(h)){if(Dse(a))return tse({scaleName:u,fieldOrDatumDef:r,fieldOrDatumDef2:a,band:d,offset:l});woe(moe(n===wae?_ae:Sae))}}var m=null===s||void 0===s?void 0:s.get("type");return ese(r,u,Bue(m)?{binSuffix:"range"}:{},{offset:l,band:"band"===m?null!==(t=null!==d&&void 0!==d?d:r.band)&&void 0!==t?t:.5:void 0})}if(zse(r)){var g=r.value,y=l?{offset:l}:{};return Object.assign(Object.assign({},rse(n,g)),y)}}return"function"===typeof f&&(f=f()),f?Object.assign(Object.assign({},f),l?{offset:l}:{}):f}function rse(e,t){return tre(["x","x2"],e)&&"width"===t?{field:{group:"width"}}:tre(["y","y2"],e)&&"height"===t?{field:{group:"height"}}:vce(t)}function ase(e){return e&&"number"!==e&&"time"!==e}function ise(e,t,n){return"".concat(e,"(").concat(t).concat(n?", ".concat(JSON.stringify(n)):"",")")}function ose(e){var t,n,r=e.fieldOrDatumDef,a=e.format,i=e.formatType,o=e.expr,u=e.normalizeStack,s=e.config;if(ase(i))return sse({fieldOrDatumDef:r,format:a,formatType:i,expr:o,config:s});var c=use(r,o,u);if(cce(r)){var l=function(e,t,n,r,a){return!t||n?(n=Mne(n)?n:r,"".concat(a?"utc":"time","Format(").concat(e,", '").concat(n,"')")):function(e,t,n){if(e){var r=zoe(e),a=n||Moe(e);return"".concat(a?"utc":"time","Format(").concat(t,", ").concat(r,")")}}(t,e,a)}(c,Dse(r)?null===(t=Zoe(r.timeUnit))||void 0===t?void 0:t.unit:void 0,a,s.timeFormat,Zse(r)&&(null===(n=r.scale)||void 0===n?void 0:n.type)===xue);return l?{signal:l}:void 0}return a=fse(Fse(r),a,s),Dse(r)&&Rie(r.bin)?{signal:pse(c,Vse(r,{expr:o,binSuffix:"end"}),a,i,s)}:a||"quantitative"===Fse(r)?{signal:"".concat(dse(c,a))}:{signal:"isValid(".concat(c,") ? ").concat(c,' : ""+').concat(c)}}function use(e,t,n){return Dse(e)?n?"".concat(Vse(e,{expr:t,suffix:"end"}),"-").concat(Vse(e,{expr:t,suffix:"start"})):Vse(e,{expr:t}):function(e){var t=e.datum;return koe(t)?Noe(t):"".concat(JSON.stringify(t))}(e)}function sse(e){var t=e.fieldOrDatumDef,n=e.format,r=e.formatType,a=e.expr,i=e.normalizeStack,o=e.config,u=e.field;return u=null!==u&&void 0!==u?u:use(t,a,i),Dse(t)&&Rie(t.bin)?{signal:pse(u,Vse(t,{expr:a,binSuffix:"end"}),n,r,o)}:{signal:ise(r,u,n)}}function cse(e,t,n,r,a,i){var o;if(!ase(r))return cce(e)?function(e,t,n,r){if(e)return e;if(t)return{signal:zoe(t)};return r?void 0:n.timeFormat}(n,Dse(e)?null===(o=Zoe(e.timeUnit))||void 0===o?void 0:o.unit:void 0,a,i):fse(t,n,a)}function lse(e,t,n){return e&&(Poe(e)||"number"===e||"time"===e)?e:cce(t)&&"time"!==n&&"utc"!==n?"time":void 0}function fse(e,t,n){return Mne(t)?t:e===sue?n.numberFormat:void 0}function dse(e,t){return"format(".concat(e,', "').concat(t||"",'")')}function hse(e,t,n,r){var a;return ase(n)?ise(n,e,t):dse(e,null!==(a=Mne(t)?t:void 0)&&void 0!==a?a:r.numberFormat)}function pse(e,t,n,r,a){var i=hse(e,n,r,a),o=hse(t,n,r,a);return"".concat(iue(e,!1),' ? "null" : ').concat(i,' + "').concat(" \u2013 ",'" + ').concat(o)}var vse="min",mse={x:1,y:1,color:1,fill:1,stroke:1,strokeWidth:1,size:1,shape:1,fillOpacity:1,strokeOpacity:1,opacity:1,text:1};function gse(e){return e in mse}function yse(e){return!!e&&!!e.encoding}function bse(e){return!!e&&("count"===e.op||!!e.field)}function xse(e){return!!e&&kne(e)}function wse(e){return"row"in e||"column"in e}function kse(e){return!!e&&"header"in e}function _se(e){return"facet"in e}function Sse(e){var t=e.field,n=e.timeUnit,r=e.bin,a=e.aggregate;return Object.assign(Object.assign(Object.assign(Object.assign({},n?{timeUnit:n}:{}),r?{bin:r}:{}),a?{aggregate:a}:{}),{field:t})}function Cse(e){return Bse(e)&&"sort"in e}function Ase(e){var t=e.channel,n=e.fieldDef,r=e.fieldDef2,a=e.markDef,i=e.stack,o=e.config,u=e.isMidPoint;if(jse(n)&&void 0!==n.band)return n.band;if(Dse(n)){var s=n.timeUnit,c=n.bin;if(s&&!r)return u?xce("timeUnitBandPosition",a,o):Jre(a.type)?xce("timeUnitBand",a,o):0;if(Rie(c))return Jre(a.type)&&!u?1:.5}return(null===i||void 0===i?void 0:i.fieldChannel)===t&&u?.5:void 0}function Ese(e,t,n,r,a,i){return!!(Rie(t.bin)||t.timeUnit&&Bse(t)&&"temporal"===t.type)&&!!Ase({channel:e,fieldDef:t,fieldDef2:n,stack:r,markDef:a,config:i})}function Nse(e){return!!e&&"condition"in e}function Tse(e){var t=e&&e.condition;return!!t&&!kne(t)&&Dse(t)}function Ise(e){var t=e&&e.condition;return!!t&&!kne(t)&&jse(t)}function Dse(e){return!!e&&(!!e.field||"count"===e.aggregate)}function Fse(e){return e&&e.type}function Mse(e){return!!e&&"datum"in e}function Ose(e){return Bse(e)&&Gse(e)||Rse(e)}function Rse(e){return Mse(e)&&Fne(e.datum)}function jse(e){return Dse(e)||Mse(e)}function Bse(e){return!!e&&("field"in e&&"type"in e||"count"===e.aggregate)}function zse(e){return e&&"value"in e&&"value"in e}function Zse(e){return!!e&&("scale"in e||"sort"in e)}function Lse(e){return e&&("axis"in e||"stack"in e||"impute"in e)}function Pse(e){return!!e&&"legend"in e}function Use(e){return!!e&&("format"in e||"formatType"in e)}function Wse(e){return"op"in e}function Vse(e){var t,n,r,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=e.field,o=a.prefix,u=a.suffix,s="";if(Hse(e))i=Ere("count");else{var c;if(!a.nofn)if(Wse(e))c=e.op;else{var l=e.bin,f=e.aggregate,d=e.timeUnit;Rie(l)?(c=Oie(l),u=(null!==(t=a.binSuffix)&&void 0!==t?t:"")+(null!==(n=a.suffix)&&void 0!==n?n:"")):f?dae(f)?(s='["'.concat(i,'"]'),i="argmax_".concat(f.argmax)):fae(f)?(s='["'.concat(i,'"]'),i="argmin_".concat(f.argmin)):c=String(f):d&&(c=Loe(d),u=(!tre(["range","mid"],a.binSuffix)&&a.binSuffix||"")+(null!==(r=a.suffix)&&void 0!==r?r:""))}c&&(i=i?"".concat(c,"_").concat(i):c)}return u&&(i="".concat(i,"_").concat(u)),o&&(i="".concat(o,"_").concat(i)),a.forAs?_re(i):a.expr?bre(i,a.expr)+s:wre(i)+s}function qse(e){switch(e.type){case"nominal":case"ordinal":case"geojson":return!0;case"quantitative":return Dse(e)&&!!e.bin;case"temporal":return!1}throw new Error(Jie(e.type))}function Gse(e){return!qse(e)}function Hse(e){return"count"===e.aggregate}var Xse=function(e,t){switch(t.fieldTitle){case"plain":return e.field;case"functional":return function(e){var t=e.aggregate,n=e.bin,r=e.timeUnit,a=e.field;if(dae(t))return"".concat(a," for argmax(").concat(t.argmax,")");if(fae(t))return"".concat(a," for argmin(").concat(t.argmin,")");var i=Zoe(r),o=t||(null===i||void 0===i?void 0:i.unit)||(null===i||void 0===i?void 0:i.maxbins)&&"timeunit"||Rie(n)&&"bin";return o?o.toUpperCase()+"("+a+")":a}(e);default:return function(e,t){var n,r=e.field,a=e.bin,i=e.timeUnit,o=e.aggregate;if("count"===o)return t.countTitle;if(Rie(a))return"".concat(r," (binned)");if(i){var u=null===(n=Zoe(i))||void 0===n?void 0:n.unit;if(u)return"".concat(r," (").concat(Roe(u).join("-"),")")}else if(o)return dae(o)?"".concat(r," for max ").concat(o.argmax):fae(o)?"".concat(r," for min ").concat(o.argmin):"".concat(gre(o)," of ").concat(r);return r}(e,t)}},Kse=Xse;function Yse(e){Kse=e}function $se(){Yse(Xse)}function Qse(e,t,n){var r,a,i=n.allowDisabling,o=n.includeDefault,u=void 0===o||o,s=(null!==(r=Jse(e))&&void 0!==r?r:{}).title;if(!Dse(e))return s;var c=e,l=u?ece(c,t):void 0;return i?Cre(s,c.title,l):null!==(a=null!==s&&void 0!==s?s:c.title)&&void 0!==a?a:l}function Jse(e){return Lse(e)&&e.axis?e.axis:Pse(e)&&e.legend?e.legend:kse(e)&&e.header?e.header:void 0}function ece(e,t){return Kse(e,t)}function tce(e){var t;if(Use(e))return{format:e.format,formatType:e.formatType};var n=null!==(t=Jse(e))&&void 0!==t?t:{};return{format:n.format,formatType:n.formatType}}function nce(e){return Dse(e)?e:Tse(e)?e.condition:void 0}function rce(e){return jse(e)?e:Ise(e)?e.condition:void 0}function ace(e,t,n){return Mne(e)||Fne(e)||Dne(e)?(woe(function(e,t,n){return"Channel ".concat(e," is a ").concat(t,". Converted to {value: ").concat(Qne(n),"}.")}(t,Mne(e)?"string":Fne(e)?"number":"boolean",e)),{value:e}):jse(e)?ice(e,t,n):Ise(e)?Object.assign(Object.assign({},e),{condition:ice(e.condition,t,n)}):e}function ice(e,t,n){if(Use(e)){e.format;var r=e.formatType,a=jne(e,["format","formatType"]);if(ase(r)&&!n.customFormatTypes)return woe(Qie(t)),ice(a,t,n)}else{var i=Lse(e)?"axis":Pse(e)?"legend":kse(e)?"header":null;if(i&&e[i]){var o=e[i],u=(o.format,o.formatType),s=jne(o,["format","formatType"]);if(ase(u)&&!n.customFormatTypes)return woe(Qie(t)),ice(Object.assign(Object.assign({},e),(0,Xn.Z)({},i,s)),t,n)}}return Dse(e)?oce(e,t):function(e){var t=e.type;if(t)return e;var n=e.datum;return t=Fne(n)?"quantitative":Mne(n)?"nominal":koe(n)?"temporal":void 0,Object.assign(Object.assign({},e),{type:t})}(e)}function oce(e,t){var n=e.aggregate,r=e.timeUnit,a=e.bin,i=e.field,o=Object.assign({},e);if(!n||hae(n)||dae(n)||fae(n)||(woe(function(e){return'Invalid aggregation operator "'.concat(e,'".')}(n)),delete o.aggregate),r&&(o.timeUnit=Zoe(r)),i&&(o.field="".concat(i)),Rie(a)&&(o.bin=uce(a,t)),jie(a)&&!wie(t)&&woe("Channel ".concat(t,' should not be used with "binned" bin.')),Bse(o)){var u=o.type,s=function(e){if(e)switch(e=e.toLowerCase()){case"q":case sue:return"quantitative";case"t":case lue:return"temporal";case"o":case cue:return"ordinal";case"n":case fue:return"nominal";case due:return"geojson"}}(u);u!==s&&(o.type=s),"quantitative"!==u&&vae(n)&&(woe(function(e,t){return'Invalid field type "'.concat(e,'" for aggregate: "').concat(t,'", using "quantitative" instead.')}(u,n)),o.type="quantitative")}else if(!die(t)){var c=function(e,t){if(e.timeUnit)return"temporal";if(Rie(e.bin))return"quantitative";switch(Mie(t)){case"continuous":default:return"quantitative";case"discrete":case"flexible":return"nominal"}}(o,t);woe(function(e,t){return'Missing type for channel "'.concat(e,'", using "').concat(t,'" instead.')}(t,c)),o.type=c}if(Bse(o)){var l=function(e,t){var n=e.type;if("geojson"===n&&"shape"!==t)return{compatible:!1,warning:"Channel ".concat(t," should not be used with a geojson data.")};switch(t){case yae:case bae:case xae:return Gse(e)?{compatible:!1,warning:roe(t)}:sce;case wae:case kae:case Mae:case Oae:case Rae:case Vae:case Gae:case Hae:case Xae:case Kae:case Yae:case zae:case Eae:case Cae:case $ae:return sce;case Iae:case Fae:case Tae:case Dae:return n!==sue?{compatible:!1,warning:"Channel ".concat(t," should be used with a quantitative field only, not ").concat(e.type," field.")}:sce;case Zae:case Lae:case Pae:case Uae:case Bae:case Nae:case Aae:case _ae:case Sae:return"nominal"!==n||e.sort?sce:{compatible:!1,warning:"Channel ".concat(t," should not be used with an unsorted discrete field.")};case Wae:return tre(["ordinal","nominal"],e.type)?sce:{compatible:!1,warning:"StrokeDash channel should be used with only discrete data."};case jae:return tre(["ordinal","nominal","geojson"],e.type)?sce:{compatible:!1,warning:"Shape channel should be used with only either discrete or geojson data."};case qae:return"nominal"!==e.type||"sort"in e?sce:{compatible:!1,warning:"Channel order is inappropriate for nominal field, which has no inherent order."}}}(o,t),f=l.compatible,d=l.warning;f||woe(d)}if(Cse(o)&&Mne(o.sort)){var h=o.sort;if(gse(h))return Object.assign(Object.assign({},o),{sort:{encoding:h}});var p=h.substr(1);if("-"===h.charAt(0)&&gse(p))return Object.assign(Object.assign({},o),{sort:{encoding:p,order:"descending"}})}if(kse(o)){var v=o.header,m=v.orient,g=jne(v,["orient"]);if(m)return Object.assign(Object.assign({},o),{header:Object.assign(Object.assign({},g),{labelOrient:v.labelOrient||m,titleOrient:v.titleOrient||m})})}return o}function uce(e,t){return Dne(e)?{maxbins:Zie(t)}:"binned"===e?{binned:!0}:e.maxbins||e.step?e:Object.assign(Object.assign({},e),{maxbins:Zie(t)})}var sce={compatible:!0};function cce(e){var t=tce(e).formatType;return"time"===t||!t&&function(e){return e&&("temporal"===e.type||Dse(e)&&!!e.timeUnit)}(e)}function lce(e,t){var n,r,a=t.timeUnit,i=t.type,o=t.wrapTime,u=t.undefinedIfExprNotRequired,s=a&&(null===(n=Zoe(a))||void 0===n?void 0:n.unit),c=s||"temporal"===i;return Poe(e)?r=e.signal:koe(e)?(c=!0,r=Noe(e)):(Mne(e)||Fne(e))&&c&&(r="datetime(".concat(JSON.stringify(e),")"),function(e){return!!Doe[e]}(s)&&(Fne(e)&&e<1e4||Mne(e)&&isNaN(Date.parse(e)))&&(r=Noe((0,Xn.Z)({},s,e)))),r?o&&c?"time(".concat(r,")"):r:u?void 0:JSON.stringify(e)}function fce(e,t){var n=e.type;return t.map((function(t){var r=lce(t,{timeUnit:Dse(e)?e.timeUnit:void 0,type:n,undefinedIfExprNotRequired:!0});return void 0!==r?{signal:r}:t}))}function dce(e,t){return Rie(e.bin)?Tie(t)&&tre(["ordinal","nominal"],e.type):(console.warn("Only call this method for binned field defs."),!1)}function hce(e){var t=e.anchor,n=e.frame,r=e.offset,a=e.orient,i=e.color,o=e.subtitleColor,u=e.subtitleFont,s=e.subtitleFontSize,c=e.subtitleFontStyle,l=e.subtitleFontWeight,f=e.subtitleLineHeight,d=e.subtitlePadding,h=jne(e,["anchor","frame","offset","orient","color","subtitleColor","subtitleFont","subtitleFontSize","subtitleFontStyle","subtitleFontWeight","subtitleLineHeight","subtitlePadding"]),p=Object.assign(Object.assign({},h),i?{fill:i}:{}),v=Object.assign(Object.assign(Object.assign(Object.assign({},t?{anchor:t}:{}),n?{frame:n}:{}),r?{offset:r}:{}),a?{orient:a}:{}),m=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},o?{subtitleColor:o}:{}),u?{subtitleFont:u}:{}),s?{subtitleFontSize:s}:{}),c?{subtitleFontStyle:c}:{}),l?{subtitleFontWeight:l}:{}),f?{subtitleLineHeight:f}:{}),d?{subtitlePadding:d}:{});return{titleMarkConfig:p,subtitleMarkConfig:Yne(p,["align","baseline","dx","dy","limit"]),nonMark:v,subtitle:m}}function pce(e){return Mne(e)||kne(e)&&Mne(e[0])}function vce(e){return Poe(e)?e:void 0!==e?{value:e}:void 0}function mce(e){return Poe(e)?e.signal:One(e.value)}function gce(e){return Poe(e)?e.signal:null==e?null:One(e)}function yce(e){var t;return[].concat(e.type,null!==(t=e.style)&&void 0!==t?t:[])}function bce(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},a=r.vgChannel,i=r.ignoreVgConfig;return a&&void 0!==t[a]?t[a]:void 0!==t[e]?t[e]:!i||a&&a!==e?xce(e,t,n,r):void 0}function xce(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},a=r.vgChannel;return Cre(a?wce(e,t,n.style):void 0,wce(e,t,n.style),a?n[t.type][a]:void 0,n[t.type][e],a?n.mark[a]:n.mark[e])}function wce(e,t,n){return kce(e,yce(t),n)}function kce(e,t,n){var r;t=Nne(t);var a,i=(0,Rt.Z)(t);try{for(i.s();!(a=i.n()).done;){var o=n[a.value];o&&void 0!==o[e]&&(r=o[e])}}catch(u){i.e(u)}finally{i.f()}return r}function _ce(e,t){return Nne(e).reduce((function(e,n){var r;return e.field.push(Vse(n,t)),e.order.push(null!==(r=n.sort)&&void 0!==r?r:"ascending"),e}),{field:[],order:[]})}function Sce(e,t){var n=(0,cn.Z)(e);return t.forEach((function(e){var t,r=(0,Rt.Z)(n);try{for(r.s();!(t=r.n()).done;){var a=t.value;if(Xne(a,e))return}}catch(i){r.e(i)}finally{r.f()}n.push(e)})),n}function Cce(e,t){return Xne(e,t)||!t?e:e?[].concat((0,cn.Z)(Nne(e)),(0,cn.Z)(Nne(t))).join(", "):t}function Ace(e,t){var n=e.value,r=t.value;if(null==n||null===r)return{explicit:e.explicit,value:null};if((pce(n)||Poe(n))&&(pce(r)||Poe(r)))return{explicit:e.explicit,value:Cce(n,r)};if(pce(n)||Poe(n))return{explicit:e.explicit,value:n};if(pce(r)||Poe(r))return{explicit:e.explicit,value:r};if(!pce(n)&&!Poe(n)&&!pce(r)&&!Poe(r))return{explicit:e.explicit,value:Sce(n,r)};throw new Error("It should never reach here")}function Ece(e,t){var n=e&&e[t];return!!n&&(kne(n)?nre(n,(function(e){return!!e.field})):Dse(n)||Tse(n))}function Nce(e){return nre(uie,(function(t){if(Ece(e,t)){var n=e[t];if(kne(n))return nre(n,(function(e){return!!e.aggregate}));var r=nce(n);return r&&!!r.aggregate}return!1}))}function Tce(e,t){var n=[],r=[],a=[],i=[],o={};return Fce(e,(function(u,s){if(Dse(u)){var c=u.field,l=u.aggregate,f=u.bin,d=u.timeUnit,h=jne(u,["field","aggregate","bin","timeUnit"]);if(l||d||f){var p,v=Jse(u),m=v&&v.title,g=Vse(u,{forAs:!0}),y=Object.assign(Object.assign(Object.assign({},m?[]:{title:Qse(u,t,{allowDisabling:!0})}),h),{field:g});if(l){if(dae(l)?(p="argmax",g=Vse({op:"argmax",field:l.argmax},{forAs:!0}),y.field="".concat(g,".").concat(c)):fae(l)?(p="argmin",g=Vse({op:"argmin",field:l.argmin},{forAs:!0}),y.field="".concat(g,".").concat(c)):"boxplot"!==l&&"errorbar"!==l&&"errorband"!==l&&(p=l),p){var b={op:p,as:g};c&&(b.field=c),i.push(b)}}else if(n.push(g),Bse(u)&&Rie(f)){if(r.push({bin:f,field:c,as:g}),n.push(Vse(u,{binSuffix:"end"})),dce(u,s)&&n.push(Vse(u,{binSuffix:"range"})),wie(s)){var x={field:g+"_end"};o[s+"2"]=x}y.bin="binned",die(s)||(y.type=sue)}else if(d){a.push({timeUnit:d,field:c,as:g});var w=Bse(u)&&u.type!==lue&&"time";w&&(s===Vae||s===Xae?y.formatType=w:!function(e){return!!gie[e]}(s)?wie(s)&&(y.axis=Object.assign({formatType:w},y.axis)):y.legend=Object.assign({formatType:w},y.legend))}o[s]=y}else n.push(c),o[s]=e[s]}else o[s]=e[s]})),{bins:r,timeUnits:a,aggregate:i,groupby:n,encoding:o}}function Ice(e,t,n){var r=t.type;return lre(e).reduce((function(a,i){if(!lie(i))return woe(function(e){return"".concat(e,"-encoding is dropped as ").concat(e," is not a valid encoding channel.")}(i)),a;var o=e[i];if("angle"!==i||"arc"!==r||e.theta||(woe("Arc marks uses theta channel rather than angle, replacing angle with theta."),i=Eae),!function(e,t,n){var r=Iie(t,n);if(!r)return!1;if("binned"===r){var a=e[t===_ae?wae:kae];return!!(Dse(a)&&Dse(e[t])&&jie(a.bin))}return!0}(e,i,r))return woe(noe(i,r)),a;if(i===Bae&&"line"===r){var u=nce(e[i]);if(null===u||void 0===u?void 0:u.aggregate)return woe("Line marks cannot encode size with a non-groupby field. You may want to use trail marks instead."),a}if(i===Mae&&(t.filled?"fill"in e:"stroke"in e))return woe(eoe("encoding",{fill:"fill"in e,stroke:"stroke"in e})),a;if(i===Gae||i===qae&&!kne(o)&&!zse(o)||i===Xae&&kne(o))o&&(a[i]=Nne(o).reduce((function(e,t){return Dse(t)?e.push(oce(t,i)):woe(toe(t,i)),e}),[]));else{if(i===Xae&&null===o)a[i]=null;else if(!Dse(o)&&!Mse(o)&&!zse(o)&&!Nse(o)&&!Poe(o))return woe(toe(o,i)),a;a[i]=ace(o,i,n)}return a}),{})}function Dce(e){var t,n=[],r=(0,Rt.Z)(lre(e));try{for(r.s();!(t=r.n()).done;){var a=t.value;if(Ece(e,a)){var i,o=Nne(e[a]),u=(0,Rt.Z)(o);try{for(u.s();!(i=u.n()).done;){var s=i.value;Dse(s)?n.push(s):Tse(s)&&n.push(s.condition)}}catch(c){u.e(c)}finally{u.f()}}}}catch(c){r.e(c)}finally{r.f()}return n}function Fce(e,t,n){if(e){var r,a=(0,Rt.Z)(lre(e));try{for(a.s();!(r=a.n()).done;){var i=r.value,o=e[i];if(kne(o)){var u,s=(0,Rt.Z)(o);try{for(s.s();!(u=s.n()).done;){var c=u.value;t.call(n,c,i)}}catch(l){s.e(l)}finally{s.f()}}else t.call(n,o,i)}}catch(l){a.e(l)}finally{a.f()}}}function Mce(e,t,n,r){return e?lre(e).reduce((function(n,a){var i=e[a];return kne(i)?i.reduce((function(e,n){return t.call(r,e,n,a)}),n):t.call(r,n,i,a)}),n):n}function Oce(e,t){return lre(t).reduce((function(n,r){switch(r){case wae:case kae:case Kae:case $ae:case Yae:case _ae:case Sae:case Eae:case Nae:case Cae:case Aae:case Tae:case Iae:case Dae:case Fae:case Vae:case jae:case zae:case Xae:return n;case qae:if("line"===e||"trail"===e)return n;case Gae:case Hae:var a=t[r];if(kne(a)||Dse(a)){var i,o=(0,Rt.Z)(Nne(a));try{for(o.s();!(i=o.n()).done;){var u=i.value;u.aggregate||n.push(Vse(u,{}))}}catch(c){o.e(c)}finally{o.f()}}return n;case Bae:if("trail"===e)return n;case Mae:case Oae:case Rae:case Zae:case Lae:case Pae:case Wae:case Uae:var s=nce(t[r]);return s&&!s.aggregate&&n.push(Vse(s,{})),n}}),[])}function Rce(e,t,n){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];if("tooltip"in n)return{tooltip:n.tooltip};var a=e.map((function(e){var n=e.fieldPrefix,a=e.titlePrefix,i=r?" of ".concat(t.field):"";return{field:n+t.field,type:t.type,title:Poe(a)?{signal:a+'"'.concat(escape(i),'"')}:a+i}}));return{tooltip:[].concat((0,cn.Z)(a),(0,cn.Z)(Dce(n)))}}function jce(e){var t=e.axis,n=e.title,r=e.field;return t&&void 0!==t.title?void 0:Cre(n,r)}function Bce(e,t,n,r,a){var i=n.scale,o=n.axis;return function(u){var s=u.partName,c=u.mark,l=u.positionPrefix,f=u.endPositionPrefix,d=void 0===f?void 0:f,h=u.aria,p=u.extraEncoding,v=void 0===p?{}:p,m=jce(n);return zce(e,s,a,h,{mark:c,encoding:Object.assign(Object.assign(Object.assign((0,Xn.Z)({},t,Object.assign(Object.assign(Object.assign({field:l+"_"+n.field,type:n.type},void 0!==m?{title:m}:{}),void 0!==i?{scale:i}:{}),void 0!==o?{axis:o}:{})),Mne(d)?(0,Xn.Z)({},t+"2",{field:d+"_"+n.field}):{}),r),v)})}}function zce(e,t,n,r,a){var i=e.clip,o=e.color,u=e.opacity,s=e.type;return e[t]||void 0===e[t]&&n[t]?[Object.assign(Object.assign({},a),{mark:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},n[t]),i?{clip:i}:{}),o?{color:o}:{}),u?{opacity:u}:{}),tae(a.mark)?a.mark:{type:a.mark}),{style:"".concat(s,"-").concat(t)}),Dne(e[t])?{}:e[t]),!1===r?{aria:r}:{})})]:[]}function Zce(e,t,n){var r=e.encoding,a="vertical"===t?"y":"x",i=r[a],o=r[a+"2"],u=r[a+"Error"],s=r[a+"Error2"];return{continuousAxisChannelDef:Lce(i,n),continuousAxisChannelDef2:Lce(o,n),continuousAxisChannelDefError:Lce(u,n),continuousAxisChannelDefError2:Lce(s,n),continuousAxis:a}}function Lce(e,t){if(e&&e.aggregate){var n=e.aggregate,r=jne(e,["aggregate"]);return n!==t&&woe(function(e,t){return"Continuous axis should not have customized aggregation function ".concat(e,"; ").concat(t," already agregates the axis.")}(n,t)),r}return e}function Pce(e,t){var n=e.mark,r=e.encoding,a=r.x,i=r.y;if(Ose(a)){if(Ose(i)){var o=Dse(a)&&a.aggregate,u=Dse(i)&&i.aggregate;if(o||u!==t){if(u||o!==t){if(o===t&&u===t)throw new Error("Both x and y cannot have aggregate");return tae(n)&&n.orient?n.orient:"vertical"}return"horizontal"}return"vertical"}return"horizontal"}if(Ose(i))return"vertical";throw new Error("Need a valid continuous axis for "+t+"s")}var Uce="boxplot",Wce=new sae(Uce,qce);function Vce(e){return Fne(e)?"tukey":e}function qce(e,t){var n,r,a=t.config,i=e.mark,o=(e.encoding,e.selection),u=(e.projection,jne(e,["mark","encoding","selection","projection"])),s=tae(i)?i:{type:i};o&&woe(Xie("boxplot"));var c,l=null!==(n=s.extent)&&void 0!==n?n:a.boxplot.extent,f=bce("size",s,a),d=Vce(l),h=function(e,t,n){var r=Pce(e,Uce),a=Zce(e,r,Uce),i=a.continuousAxisChannelDef,o=a.continuousAxis,u=i.field,s=Vce(t),c=[].concat((0,cn.Z)(Gce(u)),[{op:"median",field:u,as:"mid_box_"+u},{op:"min",field:u,as:("min-max"===s?"lower_whisker_":"min_")+u},{op:"max",field:u,as:("min-max"===s?"upper_whisker_":"max_")+u}]),l="min-max"===s||"tukey"===s?[]:[{calculate:'datum["upper_box_'.concat(u,'"] - datum["lower_box_').concat(u,'"]'),as:"iqr_"+u},{calculate:'min(datum["upper_box_'.concat(u,'"] + datum["iqr_').concat(u,'"] * ').concat(t,', datum["max_').concat(u,'"])'),as:"upper_whisker_"+u},{calculate:'max(datum["lower_box_'.concat(u,'"] - datum["iqr_').concat(u,'"] * ').concat(t,', datum["min_').concat(u,'"])'),as:"lower_whisker_"+u}],f=e.encoding,d=o,h=(f[d],function(e){var t,n,r=e.tooltip,a=jne(e,["tooltip"]);if(!r)return{filteredEncoding:e};if(kne(r)){var i,o=(0,Rt.Z)(r);try{for(o.s();!(i=o.n()).done;){var u=i.value;u.aggregate?(t||(t=[]),t.push(u)):(n||(n=[]),n.push(u))}}catch(s){o.e(s)}finally{o.f()}t&&(a.tooltip=t)}else r.aggregate?a.tooltip=r:n=r;return kne(n)&&1===n.length&&(n=n[0]),{customTooltipWithoutAggregatedField:n,filteredEncoding:a}}(jne(f,["symbol"===typeof d?d:d+""]))),p=h.customTooltipWithoutAggregatedField,v=Tce(h.filteredEncoding,n),m=v.bins,g=v.timeUnits,y=v.aggregate,b=v.groupby,x=v.encoding,w="vertical"===r?"horizontal":"vertical",k=r;return{transform:[].concat((0,cn.Z)(m),(0,cn.Z)(g),[{aggregate:[].concat((0,cn.Z)(y),(0,cn.Z)(c)),groupby:b}],l),groupby:b,aggregate:y,continuousAxisChannelDef:i,continuousAxis:o,encodingWithoutContinuousAxis:x,ticksOrient:w,boxOrient:k,customTooltipWithoutAggregatedField:p}}(e,l,a),p=h.transform,v=h.continuousAxisChannelDef,m=h.continuousAxis,g=h.groupby,y=h.aggregate,b=h.encodingWithoutContinuousAxis,x=h.ticksOrient,w=h.boxOrient,k=h.customTooltipWithoutAggregatedField,_=(b.color,b.size),S=jne(b,["color","size"]),C=function(e){return Bce(s,m,v,e,a.boxplot)},A=C(S),E=C(b),N=C(Object.assign(Object.assign({},S),_?{size:_}:{})),T=Rce([{fieldPrefix:"min-max"===d?"upper_whisker_":"max_",titlePrefix:"Max"},{fieldPrefix:"upper_box_",titlePrefix:"Q3"},{fieldPrefix:"mid_box_",titlePrefix:"Median"},{fieldPrefix:"lower_box_",titlePrefix:"Q1"},{fieldPrefix:"min-max"===d?"lower_whisker_":"min_",titlePrefix:"Min"}],v,b),I={type:"tick",color:"black",opacity:1,orient:x,invalid:null},D="min-max"===d?T:Rce([{fieldPrefix:"upper_whisker_",titlePrefix:"Upper Whisker"},{fieldPrefix:"lower_whisker_",titlePrefix:"Lower Whisker"}],v,b),F=[].concat((0,cn.Z)(A({partName:"rule",mark:{type:"rule",invalid:null},positionPrefix:"lower_whisker",endPositionPrefix:"lower_box",aria:!1,extraEncoding:D})),(0,cn.Z)(A({partName:"rule",mark:{type:"rule",invalid:null},positionPrefix:"upper_box",endPositionPrefix:"upper_whisker",aria:!1,extraEncoding:D})),(0,cn.Z)(A({partName:"ticks",mark:I,positionPrefix:"lower_whisker",aria:!1,extraEncoding:D})),(0,cn.Z)(A({partName:"ticks",mark:I,positionPrefix:"upper_whisker",aria:!1,extraEncoding:D}))),M=[].concat((0,cn.Z)("tukey"!==d?F:[]),(0,cn.Z)(E({partName:"box",mark:Object.assign(Object.assign({type:"bar"},f?{size:f}:{}),{orient:w,invalid:null}),positionPrefix:"lower_box",endPositionPrefix:"upper_box",aria:!1,extraEncoding:T})),(0,cn.Z)(N({partName:"median",mark:Object.assign(Object.assign(Object.assign({type:"tick",invalid:null},_ne(a.boxplot.median)&&a.boxplot.median.color?{color:a.boxplot.median.color}:{}),f?{size:f}:{}),{orient:x,ariaRoleDescription:"box"}),positionPrefix:"mid_box",extraEncoding:T})));if("min-max"!==d){var O='datum["lower_box_'.concat(v.field,'"]'),R='datum["upper_box_'.concat(v.field,'"]'),j="(".concat(R," - ").concat(O,")"),B="".concat(O," - ").concat(l," * ").concat(j),z="".concat(R," + ").concat(l," * ").concat(j),Z='datum["'.concat(v.field,'"]'),L={joinaggregate:Gce(v.field),groupby:g},P=void 0;"tukey"===d&&(P={transform:[{filter:"(".concat(B," <= ").concat(Z,") && (").concat(Z," <= ").concat(z,")")},{aggregate:[{op:"min",field:v.field,as:"lower_whisker_"+v.field},{op:"max",field:v.field,as:"upper_whisker_"+v.field},{op:"min",field:"lower_box_"+v.field,as:"lower_box_"+v.field},{op:"max",field:"upper_box_"+v.field,as:"upper_box_"+v.field}].concat((0,cn.Z)(y)),groupby:g}],layer:F});S.tooltip;var U=jne(S,["tooltip"]),W=v.scale,V=v.axis,q=jce(v),G=zce(s,"outliers",a.boxplot,!0,{transform:[{filter:"(".concat(Z," < ").concat(B,") || (").concat(Z," > ").concat(z,")")}],mark:"point",encoding:Object.assign(Object.assign((0,Xn.Z)({},m,Object.assign(Object.assign(Object.assign({field:v.field,type:v.type},void 0!==q?{title:q}:{}),void 0!==W?{scale:W}:{}),void 0!==V?{axis:V}:{})),U),k?{tooltip:k}:{})})[0];G&&P?c={transform:[L],layer:[G,P]}:G?(c=G).transform.unshift(L):P&&(c=P).transform.unshift(L)}return c?Object.assign(Object.assign({},u),{layer:[c,{transform:p,layer:M}]}):Object.assign(Object.assign({},u),{transform:(null!==(r=u.transform)&&void 0!==r?r:[]).concat(p),layer:M})}function Gce(e){return[{op:"q1",field:e,as:"lower_box_"+e},{op:"q3",field:e,as:"upper_box_"+e}]}var Hce="errorbar",Xce=new sae(Hce,Kce);function Kce(e,t){var n=t.config,r=$ce(e,Hce,n),a=r.transform,i=r.continuousAxisChannelDef,o=r.continuousAxis,u=r.encodingWithoutContinuousAxis,s=r.ticksOrient,c=r.markDef,l=r.outerSpec,f=r.tooltipEncoding,d=Bce(c,o,i,u,n.errorbar),h={type:"tick",orient:s},p=[].concat((0,cn.Z)(d({partName:"ticks",mark:h,positionPrefix:"lower",aria:!1,extraEncoding:f})),(0,cn.Z)(d({partName:"ticks",mark:h,positionPrefix:"upper",aria:!1,extraEncoding:f})),(0,cn.Z)(d({partName:"rule",mark:{type:"rule",ariaRoleDescription:"errorbar"},positionPrefix:"lower",endPositionPrefix:"upper",extraEncoding:f})));return Object.assign(Object.assign(Object.assign({},l),{transform:a}),p.length>1?{layer:p}:Object.assign({},p[0]))}function Yce(e,t){var n=e.encoding;if(function(e){return(jse(e.x)||jse(e.y))&&!jse(e.x2)&&!jse(e.y2)&&!jse(e.xError)&&!jse(e.xError2)&&!jse(e.yError)&&!jse(e.yError2)}(n))return{orient:Pce(e,t),inputType:"raw"};var r=function(e){return jse(e.x2)||jse(e.y2)}(n),a=function(e){return jse(e.xError)||jse(e.xError2)||jse(e.yError)||jse(e.yError2)}(n),i=n.x,o=n.y;if(r){if(a)throw new Error("".concat(t," cannot be both type aggregated-upper-lower and aggregated-error"));var u=n.x2,s=n.y2;if(jse(u)&&jse(s))throw new Error("".concat(t," cannot have both x2 and y2"));if(jse(u)){if(Ose(i))return{orient:"horizontal",inputType:"aggregated-upper-lower"};throw new Error("Both x and x2 have to be quantitative in ".concat(t))}if(jse(s)){if(Ose(o))return{orient:"vertical",inputType:"aggregated-upper-lower"};throw new Error("Both y and y2 have to be quantitative in ".concat(t))}throw new Error("No ranged axis")}var c=n.xError,l=n.xError2,f=n.yError,d=n.yError2;if(jse(l)&&!jse(c))throw new Error("".concat(t," cannot have xError2 without xError"));if(jse(d)&&!jse(f))throw new Error("".concat(t," cannot have yError2 without yError"));if(jse(c)&&jse(f))throw new Error("".concat(t," cannot have both xError and yError with both are quantiative"));if(jse(c)){if(Ose(i))return{orient:"horizontal",inputType:"aggregated-error"};throw new Error("All x, xError, and xError2 (if exist) have to be quantitative")}if(jse(f)){if(Ose(o))return{orient:"vertical",inputType:"aggregated-error"};throw new Error("All y, yError, and yError2 (if exist) have to be quantitative")}throw new Error("No ranged axis")}function $ce(e,t,n){var r,a=e.mark,i=e.encoding,o=e.selection,u=(e.projection,jne(e,["mark","encoding","selection","projection"])),s=tae(a)?a:{type:a};o&&woe(Xie(t));var c=Yce(e,t),l=c.orient,f=c.inputType,d=Zce(e,l,t),h=d.continuousAxisChannelDef,p=d.continuousAxisChannelDef2,v=d.continuousAxisChannelDefError,m=d.continuousAxisChannelDefError2,g=d.continuousAxis,y=function(e,t,n,r,a,i,o,u){var s,c=[],l=[],f=t.field,d=!1;if("raw"===i){var h,p,v,m=e.center?e.center:e.extent?"iqr"===e.extent?"median":"mean":u.errorbar.center,g=e.extent?e.extent:"mean"===m?"stderr":"iqr";if("median"===m!==("iqr"===g)&&woe(function(e,t,n){return"".concat(e," is not usually used with ").concat(t," for ").concat(n,".")}(m,g,o)),"stderr"===g||"stdev"===g)c=[{op:g,field:f,as:"extent_"+f},{op:m,field:f,as:"center_"+f}],l=[{calculate:'datum["center_'.concat(f,'"] + datum["extent_').concat(f,'"]'),as:"upper_"+f},{calculate:'datum["center_'.concat(f,'"] - datum["extent_').concat(f,'"]'),as:"lower_"+f}],s=[{fieldPrefix:"center_",titlePrefix:gre(m)},{fieldPrefix:"upper_",titlePrefix:Qce(m,g,"+")},{fieldPrefix:"lower_",titlePrefix:Qce(m,g,"-")}],d=!0;else e.center&&e.extent&&woe(function(e,t){return"Center is not needed to be specified in ".concat(t," when extent is ").concat(e,".")}(e.extent,o)),"ci"===g?(h="mean",p="ci0",v="ci1"):(h="median",p="q1",v="q3"),c=[{op:p,field:f,as:"lower_"+f},{op:v,field:f,as:"upper_"+f},{op:h,field:f,as:"center_"+f}],s=[{fieldPrefix:"upper_",titlePrefix:Qse({field:f,aggregate:v,type:"quantitative"},u,{allowDisabling:!1})},{fieldPrefix:"lower_",titlePrefix:Qse({field:f,aggregate:p,type:"quantitative"},u,{allowDisabling:!1})},{fieldPrefix:"center_",titlePrefix:Qse({field:f,aggregate:h,type:"quantitative"},u,{allowDisabling:!1})}]}else{(e.center||e.extent)&&woe(function(e,t){return"".concat(t?"extent ":"").concat(t&&e?"and ":"").concat(e?"center ":"").concat(t&&e?"are ":"is ","not needed when data are aggregated.")}(e.center,e.extent)),"aggregated-upper-lower"===i?(s=[],l=[{calculate:'datum["'.concat(n.field,'"]'),as:"upper_"+f},{calculate:'datum["'.concat(f,'"]'),as:"lower_"+f}]):"aggregated-error"===i&&(s=[{fieldPrefix:"",titlePrefix:f}],l=[{calculate:'datum["'.concat(f,'"] + datum["').concat(r.field,'"]'),as:"upper_"+f}],a?l.push({calculate:'datum["'.concat(f,'"] + datum["').concat(a.field,'"]'),as:"lower_"+f}):l.push({calculate:'datum["'.concat(f,'"] - datum["').concat(r.field,'"]'),as:"lower_"+f}));var y,b=(0,Rt.Z)(l);try{for(b.s();!(y=b.n()).done;){var x=y.value;s.push({fieldPrefix:x.as.substring(0,6),titlePrefix:kre(kre(x.calculate,'datum["',""),'"]',"")})}}catch(w){b.e(w)}finally{b.f()}}return{postAggregateCalculates:l,errorBarSpecificAggregate:c,tooltipSummary:s,tooltipTitleWithFieldName:d}}(s,h,p,v,m,f,t,n),b=y.errorBarSpecificAggregate,x=y.postAggregateCalculates,w=y.tooltipSummary,k=y.tooltipTitleWithFieldName,_=i,S=g,C=(_[S],"x"===g?"x2":"y2"),A=(_[C],"x"===g?"xError":"yError"),E=(_[A],"x"===g?"xError2":"yError2"),N=(_[E],Tce(jne(_,["symbol"===typeof S?S:S+"","symbol"===typeof C?C:C+"","symbol"===typeof A?A:A+"","symbol"===typeof E?E:E+""]),n)),T=N.bins,I=N.timeUnits,D=N.aggregate,F=N.groupby,M=N.encoding,O=[].concat((0,cn.Z)(D),(0,cn.Z)(b)),R="raw"!==f?[]:F,j=Rce(w,h,M,k);return{transform:[].concat((0,cn.Z)(null!==(r=u.transform)&&void 0!==r?r:[]),(0,cn.Z)(T),(0,cn.Z)(I),(0,cn.Z)(0===O.length?[]:[{aggregate:O,groupby:R}]),(0,cn.Z)(x)),groupby:R,continuousAxisChannelDef:h,continuousAxis:g,encodingWithoutContinuousAxis:M,ticksOrient:"vertical"===l?"horizontal":"vertical",markDef:s,outerSpec:u,tooltipEncoding:j}}function Qce(e,t,n){return gre(e)+" "+n+" "+t}var Jce="errorband",ele=new sae(Jce,tle);function tle(e,t){var n=t.config,r=$ce(e,Jce,n),a=r.transform,i=r.continuousAxisChannelDef,o=r.continuousAxis,u=r.encodingWithoutContinuousAxis,s=r.markDef,c=r.outerSpec,l=r.tooltipEncoding,f=s,d=Bce(f,o,i,u,n.errorband),h=void 0!==e.encoding.x&&void 0!==e.encoding.y,p={type:h?"area":"rect"},v={type:h?"line":"rule"},m=Object.assign(Object.assign({},f.interpolate?{interpolate:f.interpolate}:{}),f.tension&&f.interpolate?{tension:f.tension}:{});return h?(p=Object.assign(Object.assign(Object.assign({},p),m),{ariaRoleDescription:"errorband"}),v=Object.assign(Object.assign({},v),m)):f.interpolate?woe(voe("interpolate")):f.tension&&woe(voe("tension")),Object.assign(Object.assign({},c),{transform:a,layer:[].concat((0,cn.Z)(d({partName:"band",mark:p,positionPrefix:"lower",endPositionPrefix:"upper",extraEncoding:l})),(0,cn.Z)(d({partName:"borders",mark:v,positionPrefix:"lower",aria:!1,extraEncoding:l})),(0,cn.Z)(d({partName:"borders",mark:v,positionPrefix:"upper",aria:!1,extraEncoding:l})))})}var nle={};function rle(e,t,n){var r=new sae(e,t);nle[e]={normalizer:r,parts:n}}rle(Uce,qce,["box","median","outliers","rule","ticks"]),rle(Hce,Kce,["ticks","rule"]),rle(Jce,tle,["band","borders"]);var ale=["gradientHorizontalMaxLength","gradientHorizontalMinLength","gradientVerticalMaxLength","gradientVerticalMinLength","unselectedOpacity"],ile=["size","shape","fill","stroke","strokeDash","strokeWidth","opacity"],ole={fillColor:{part:"legend",vgProp:"fill"},gradientStrokeColor:{part:"gradient",vgProp:"stroke"},labelColor:{part:"labels",vgProp:"fill"},strokeColor:{part:"legend",vgProp:"stroke"},symbolFillColor:{part:"symbols",vgProp:"fill"},symbolStrokeColor:{part:"symbols",vgProp:"stroke"},titleColor:{part:"title",vgProp:"fill"}},ule={aria:1,clipHeight:1,columnPadding:1,columns:1,cornerRadius:1,description:1,direction:1,fillColor:1,format:1,formatType:1,gradientLength:1,gradientOpacity:1,gradientStrokeColor:1,gradientStrokeWidth:1,gradientThickness:1,gridAlign:1,labelAlign:1,labelBaseline:1,labelColor:1,labelFont:1,labelFontSize:1,labelFontStyle:1,labelFontWeight:1,labelLimit:1,labelOffset:1,labelOpacity:1,labelOverlap:1,labelPadding:1,labelSeparation:1,legendX:1,legendY:1,offset:1,orient:1,padding:1,rowPadding:1,strokeColor:1,symbolDash:1,symbolDashOffset:1,symbolFillColor:1,symbolLimit:1,symbolOffset:1,symbolOpacity:1,symbolSize:1,symbolStrokeColor:1,symbolStrokeWidth:1,symbolType:1,tickCount:1,tickMinStep:1,title:1,titleAlign:1,titleAnchor:1,titleBaseline:1,titleColor:1,titleFont:1,titleFontSize:1,titleFontStyle:1,titleFontWeight:1,titleLimit:1,titleLineHeight:1,titleOpacity:1,titleOrient:1,titlePadding:1,type:1,values:1,zindex:1},sle=(lre(ule),"_vgsid_"),cle={single:{on:"click",fields:[sle],resolve:"global",empty:"all",clear:"dblclick"},multi:{on:"click",fields:[sle],toggle:"event.shiftKey",resolve:"global",empty:"all",clear:"dblclick"},interval:{on:"[mousedown, window:mouseup] > window:mousemove!",encodings:["x","y"],translate:"[mousedown, window:mouseup] > window:mousemove!",zoom:"wheel!",mark:{fill:"#333",fillOpacity:.125,stroke:"white"},resolve:"global",clear:"dblclick"}};function lle(e){return!!e&&("legend"===e||!!e.legend)}function fle(e){return lle(e)&&_ne(e)}function dle(e){return"concat"in e}function hle(e){return"vconcat"in e}function ple(e){return"hconcat"in e}function vle(e){return _ne(e)&&void 0!==e.step}function mle(e){return e.view||e.width||e.height}var gle=lre({align:1,bounds:1,center:1,columns:1,spacing:1});function yle(e,t){var n;return null!==(n=e[t])&&void 0!==n?n:e["width"===t?"continuousWidth":"continuousHeight"]}function ble(e,t){var n=xle(e,t);return vle(n)?n.step:wle}function xle(e,t){var n;return Cre(null!==(n=e[t])&&void 0!==n?n:e["width"===t?"discreteWidth":"discreteHeight"],{step:e.step})}var wle=20;var kle={background:"white",padding:5,timeFormat:"%b %d, %Y",countTitle:"Count of Records",view:{continuousWidth:200,continuousHeight:200,step:wle},mark:{color:"#4c78a8",invalid:"filter",timeUnitBand:1},arc:{},area:{},bar:iae,circle:{},geoshape:{},image:{},line:{},point:{},rect:oae,rule:{color:"black"},square:{},text:{color:"black"},tick:{thickness:1},trail:{},boxplot:{size:14,extent:1.5,box:{},median:{color:"white"},outliers:{},rule:{},ticks:null},errorbar:{center:"mean",rule:!0,ticks:!1},errorband:{band:{opacity:.3},borders:!1},scale:{pointPadding:.5,barBandPaddingInner:.1,rectBandPaddingInner:0,minBandSize:2,minFontSize:8,maxFontSize:40,minOpacity:.3,maxOpacity:.8,minSize:9,minStrokeWidth:1,maxStrokeWidth:4,quantileCount:4,quantizeCount:4},projection:{},legend:{gradientHorizontalMaxLength:200,gradientHorizontalMinLength:100,gradientVerticalMaxLength:200,gradientVerticalMinLength:64,unselectedOpacity:.35},header:{titlePadding:10,labelPadding:10},headerColumn:{},headerRow:{},headerFacet:{},selection:cle,style:{},title:{},facet:{spacing:20},concat:{spacing:20}},_le=["#4c78a8","#f58518","#e45756","#72b7b2","#54a24b","#eeca3b","#b279a2","#ff9da6","#9d755d","#bab0ac"],Sle={text:11,guideLabel:10,guideTitle:11,groupTitle:13,groupSubtitle:12},Cle={blue:_le[0],orange:_le[1],red:_le[2],teal:_le[3],green:_le[4],yellow:_le[5],purple:_le[6],pink:_le[7],brown:_le[8],gray0:"#000",gray1:"#111",gray2:"#222",gray3:"#333",gray4:"#444",gray5:"#555",gray6:"#666",gray7:"#777",gray8:"#888",gray9:"#999",gray10:"#aaa",gray11:"#bbb",gray12:"#ccc",gray13:"#ddd",gray14:"#eee",gray15:"#fff"};function Ale(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{signals:[{name:"color",value:_ne(e)?Object.assign(Object.assign({},Cle),e):Cle}],mark:{color:{signal:"color.blue"}},rule:{color:{signal:"color.gray0"}},text:{color:{signal:"color.gray0"}},style:{"guide-label":{fill:{signal:"color.gray0"}},"guide-title":{fill:{signal:"color.gray0"}},"group-title":{fill:{signal:"color.gray0"}},"group-subtitle":{fill:{signal:"color.gray0"}},cell:{stroke:{signal:"color.gray8"}}},axis:{domainColor:{signal:"color.gray13"},gridColor:{signal:"color.gray8"},tickColor:{signal:"color.gray13"}},range:{category:[{signal:"color.blue"},{signal:"color.orange"},{signal:"color.red"},{signal:"color.teal"},{signal:"color.green"},{signal:"color.yellow"},{signal:"color.purple"},{signal:"color.pink"},{signal:"color.brown"},{signal:"color.grey8"}]}}}function Ele(e){return{signals:[{name:"fontSize",value:_ne(e)?Object.assign(Object.assign({},Sle),e):Sle}],text:{fontSize:{signal:"fontSize.text"}},style:{"guide-label":{fontSize:{signal:"fontSize.guideLabel"}},"guide-title":{fontSize:{signal:"fontSize.guideTitle"}},"group-title":{fontSize:{signal:"fontSize.groupTitle"}},"group-subtitle":{fontSize:{signal:"fontSize.groupSubtitle"}}}}}function Nle(e){return{text:{font:e},style:{"guide-label":{font:e},"guide-title":{font:e},"group-title":{font:e},"group-subtitle":{font:e}}}}function Tle(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.color,n=e.font,r=e.fontSize,a=jne(e,["color","font","fontSize"]);return Cne({},kle,n?Nle(n):{},t?Ale(t):{},r?Ele(r):{},a||{})}var Ile=["view"].concat((0,cn.Z)(eae)),Dle=["color","fontSize","background","padding","facet","concat","numberFormat","timeFormat","countTitle","header","axisQuantitative","axisTemporal","axisDiscrete","axisPoint","axisXBand","axisXPoint","axisXDiscrete","axisXQuantitative","axisXTemporal","axisYBand","axisYPoint","axisYDiscrete","axisYQuantitative","axisYTemporal","scale","selection","overlay"],Fle=Object.assign({view:["continuousWidth","continuousHeight","discreteWidth","discreteHeight","step"]},{area:["line","point"],bar:["binSpacing","continuousBandSize","discreteBandSize"],rect:["binSpacing","continuousBandSize","discreteBandSize"],line:["point"],tick:["bandSize","thickness"]});function Mle(e){e=Kne(e);var t,n=(0,Rt.Z)(Dle);try{for(n.s();!(t=n.n()).done;){delete e[t.value]}}catch(_){n.e(_)}finally{n.f()}if(e.axis)for(var r in e.axis)Dre(e.axis[r])&&delete e.axis[r];if(e.legend){var a,i=(0,Rt.Z)(ale);try{for(i.s();!(a=i.n()).done;){var o=a.value;delete e.legend[o]}}catch(_){i.e(_)}finally{i.f()}}if(e.mark){var u,s=(0,Rt.Z)(rae);try{for(s.s();!(u=s.n()).done;){var c=u.value;delete e.mark[c]}}catch(_){s.e(_)}finally{s.f()}e.mark.tooltip&&_ne(e.mark.tooltip)&&delete e.mark.tooltip}var l,f=(0,Rt.Z)(Ile);try{for(f.s();!(l=f.n()).done;){var d,h=l.value,p=(0,Rt.Z)(rae);try{for(p.s();!(d=p.n()).done;){var v=d.value;delete e[h][v]}}catch(_){p.e(_)}finally{p.f()}var m=Fle[h];if(m){var g,y=(0,Rt.Z)(m);try{for(y.s();!(g=y.n()).done;){var b=g.value;delete e[h][b]}}catch(_){y.e(_)}finally{y.f()}}Ole(e,h)}}catch(_){f.e(_)}finally{f.f()}var x,w=(0,Rt.Z)(lre(nle));try{for(w.s();!(x=w.n()).done;){delete e[x.value]}}catch(_){w.e(_)}finally{w.f()}for(var k in function(e){var t=hce(e.title),n=t.titleMarkConfig,r=t.subtitleMarkConfig,a=t.subtitle;cre(n)||(e.style["group-title"]=Object.assign(Object.assign({},e.style["group-title"]),n));cre(r)||(e.style["group-subtitle"]=Object.assign(Object.assign({},e.style["group-subtitle"]),r));cre(a)?delete e.title:e.title=a}(e),e)_ne(e[k])&&cre(e[k])&&delete e[k];return cre(e)?void 0:e}function Ole(e,t,n,r){var a=r?e[t][r]:e[t];"view"===t&&(n="cell");var i=Object.assign(Object.assign({},a),e.style[null!==n&&void 0!==n?n:t]);cre(i)||(e.style[null!==n&&void 0!==n?n:t]=i),r||delete e[t]}function Rle(e){return"layer"in e}var jle=function(){function e(){(0,op.Z)(this,e)}return(0,up.Z)(e,[{key:"map",value:function(e,t){return _se(e)?this.mapFacet(e,t):function(e){return"repeat"in e}(e)?this.mapRepeat(e,t):ple(e)?this.mapHConcat(e,t):hle(e)?this.mapVConcat(e,t):dle(e)?this.mapConcat(e,t):this.mapLayerOrUnit(e,t)}},{key:"mapLayerOrUnit",value:function(e,t){if(Rle(e))return this.mapLayer(e,t);if(uae(e))return this.mapUnit(e,t);throw new Error(Pie(e))}},{key:"mapLayer",value:function(e,t){var n=this;return Object.assign(Object.assign({},e),{layer:e.layer.map((function(e){return n.mapLayerOrUnit(e,t)}))})}},{key:"mapHConcat",value:function(e,t){var n=this;return Object.assign(Object.assign({},e),{hconcat:e.hconcat.map((function(e){return n.map(e,t)}))})}},{key:"mapVConcat",value:function(e,t){var n=this;return Object.assign(Object.assign({},e),{vconcat:e.vconcat.map((function(e){return n.map(e,t)}))})}},{key:"mapConcat",value:function(e,t){var n=this,r=e.concat,a=jne(e,["concat"]);return Object.assign(Object.assign({},a),{concat:r.map((function(e){return n.map(e,t)}))})}},{key:"mapFacet",value:function(e,t){return Object.assign(Object.assign({},e),{spec:this.map(e.spec,t)})}},{key:"mapRepeat",value:function(e,t){return Object.assign(Object.assign({},e),{spec:this.map(e.spec,t)})}}]),e}(),Ble={zero:1,center:1,normalize:1};function zle(e){return e in Ble}var Zle=new Set([zre,Lre,Zre,qre,Wre,Kre,Yre,Ure,Gre,Hre]),Lle=new Set([Lre,Zre,zre]);function Ple(e,t){var n,r,a="x"===t?"y":"radius",i=e[t],o=e[a];if(Dse(i)&&Dse(o))if("quantitative"===Fse(i)&&"quantitative"===Fse(o)){if(i.stack)return t;if(o.stack)return a;var u=Dse(i)&&!!i.aggregate;if(u!==(Dse(o)&&!!o.aggregate))return u?t:a;var s=null===(n=i.scale)||void 0===n?void 0:n.type,c=null===(r=o.scale)||void 0===r?void 0:r.type;if(s&&"linear"!==s)return a;if(c&&"linear"!==c)return t}else{if("quantitative"===Fse(i))return t;if("quantitative"===Fse(o))return a}else{if("quantitative"===Fse(i))return t;if("quantitative"===Fse(o))return a}}function Ule(e){switch(e){case"x":return"y";case"y":return"x";case"theta":return"radius";case"radius":return"theta"}}function Wle(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=tae(e)?e.type:e;if(!Zle.has(r))return null;var a=Ple(t,"x")||Ple(t,"theta");if(!a)return null;var i=t[a],o=Dse(i)?Vse(i,{}):void 0,u=Ule(a),s=t[u],c=Dse(s)?Vse(s,{}):void 0;c===o&&(c=void 0,s=void 0,u=void 0);var l,f=yie.reduce((function(e,n){if("tooltip"!==n&&Ece(t,n)){var r,a=t[n],i=(0,Rt.Z)(Nne(a));try{for(i.s();!(r=i.n()).done;){var o=nce(r.value);if(!o.aggregate){var u=Vse(o,{});u&&u===c||e.push({channel:n,fieldDef:o})}}}catch(s){i.e(s)}finally{i.f()}}return e}),[]);if(void 0!==i.stack?l=Dne(i.stack)?i.stack?"zero":null:i.stack:f.length>0&&Lle.has(r)&&(l="zero"),!l||!zle(l))return null;if(Nce(t)&&0===f.length)return null;if(i.scale&&i.scale.type&&i.scale.type!==pue){if(n.disallowNonLinearStack)return null;woe(doe(i.scale.type))}return jse(t[vie(a)])?(void 0!==i.stack&&woe(foe(a)),null):(Dse(i)&&i.aggregate&&!tre(mae,i.aggregate)&&woe(hoe(i.aggregate)),{groupbyChannel:s?u:void 0,groupbyField:c,fieldChannel:a,impute:null!==i.impute&&Qre(r),stackBy:f,offset:l})}function Vle(e){e.point,e.line;var t=jne(e,["point","line"]);return lre(t).length>1?t:t.type}function qle(e){for(var t=0,n=["line","area","rule","trail"];t<n.length;t++){var r=n[t];e[r]&&(e=Object.assign(Object.assign({},e),(0,Xn.Z)({},r,$ne(e[r],["point","line"]))))}return e}function Gle(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;return"transparent"===e.point?{opacity:0}:e.point?_ne(e.point)?e.point:{}:void 0!==e.point?null:t.point||n.shape?_ne(t.point)?t.point:{}:void 0}function Hle(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e.line?!0===e.line?{}:e.line:void 0!==e.line?null:t.line?!0===t.line?{}:t.line:void 0}var Xle=function(){function e(){(0,op.Z)(this,e),this.name="path-overlay"}return(0,up.Z)(e,[{key:"hasMatchingType",value:function(e,t){if(uae(e)){var n=e.mark,r=e.encoding,a=tae(n)?n:{type:n};switch(a.type){case"line":case"rule":case"trail":return!!Gle(a,t[a.type],r);case"area":return!!Gle(a,t[a.type],r)||!!Hle(a,t[a.type])}}return!1}},{key:"run",value:function(e,t,n){var r=t.config,a=e.selection,i=e.projection,o=e.encoding,u=e.mark,s=jne(e,["selection","projection","encoding","mark"]),c=tae(u)?u:{type:u},l=Gle(c,r[c.type],o),f="area"===c.type&&Hle(c,r[c.type]),d=[Object.assign(Object.assign({},a?{selection:a}:{}),{mark:Vle(Object.assign(Object.assign({},"area"===c.type&&void 0===c.opacity&&void 0===c.fillOpacity?{opacity:.7}:{}),c)),encoding:$ne(o,["shape"])})],h=Wle(c,o),p=o;if(h){var v=h.fieldChannel,m=h.offset;p=Object.assign(Object.assign({},o),(0,Xn.Z)({},v,Object.assign(Object.assign({},o[v]),m?{stack:m}:{})))}return f&&d.push(Object.assign(Object.assign({},i?{projection:i}:{}),{mark:Object.assign(Object.assign({type:"line"},Yne(c,["clip","interpolate","tension","tooltip"])),f),encoding:p})),l&&d.push(Object.assign(Object.assign({},i?{projection:i}:{}),{mark:Object.assign(Object.assign({type:"point",opacity:1,filled:!0},Yne(c,["clip","tooltip"])),l),encoding:p})),n(Object.assign(Object.assign({},s),{layer:d}),Object.assign(Object.assign({},t),{config:qle(r)}))}}]),e}(),Kle=function(){function e(){(0,op.Z)(this,e),this.name="RangeStep"}return(0,up.Z)(e,[{key:"hasMatchingType",value:function(e){var t;if(uae(e)&&e.encoding){var n,r=(0,Rt.Z)(xie);try{for(r.s();!(n=r.n()).done;){var a=n.value,i=e.encoding[a];if(i&&jse(i)&&(null===(t=null===i||void 0===i?void 0:i.scale)||void 0===t?void 0:t.rangeStep))return!0}}catch(o){r.e(o)}finally{r.f()}}return!1}},{key:"run",value:function(e){var t,n,r={},a=Object.assign({},e.encoding),i=(0,Rt.Z)(xie);try{for(i.s();!(n=i.n()).done;){var o=n.value,u=mie(o),s=a[o];if(s&&jse(s)&&(null===(t=null===s||void 0===s?void 0:s.scale)||void 0===t?void 0:t.rangeStep)){var c=s.scale,l=jne(s,["scale"]),f=c,d=(f.rangeStep,jne(f,["rangeStep"]));r[u]={step:c.rangeStep},woe('Scale\'s "rangeStep" is deprecated and will be removed in Vega-Lite 5.0. Please use "width"/"height": {"step": ...} instead. See https://vega.github.io/vega-lite/docs/size.html.'),a=Object.assign(Object.assign({},a),(0,Xn.Z)({},o,Object.assign(Object.assign({},l),cre(d)?{}:{scale:d})))}}}catch(h){i.e(h)}finally{i.f()}return Object.assign(Object.assign(Object.assign({},r),e),{encoding:a})}}]),e}();function Yle(e,t){return t?wse(e)?nfe(e,t):Jle(e,t):e}function $le(e,t){return t?nfe(e,t):e}function Qle(e,t,n){var r=t[e];return function(e){return e&&!Mne(e)&&"repeat"in e}(r)?r.repeat in n?Object.assign(Object.assign({},t),(0,Xn.Z)({},e,n[r.repeat])):void woe(function(e){return'Unknown repeated value "'.concat(e,'".')}(r.repeat)):t}function Jle(e,t){if(void 0!==(e=Qle("field",e,t))){if(null===e)return null;if(Cse(e)&&bse(e.sort)){var n=Qle("field",e.sort,t);e=Object.assign(Object.assign({},e),n?{sort:n}:{})}return e}}function efe(e,t){if(Dse(e))return Jle(e,t);var n=Qle("datum",e,t);return n===e||n.type||(n.type="nominal"),n}function tfe(e,t){if(!jse(e)){if(Ise(e)){var n=efe(e.condition,t);if(n)return Object.assign(Object.assign({},e),{condition:n});e.condition;return jne(e,["condition"])}return e}var r=efe(e,t);return r||(Nse(e)?{condition:e.condition}:void 0)}function nfe(e,t){var n={};for(var r in e)if(Ine(e,r)){var a=e[r];if(kne(a))n[r]=a.map((function(e){return tfe(e,t)})).filter((function(e){return e}));else{var i=tfe(a,t);void 0!==i&&(n[r]=i)}}return n}var rfe=function(){function e(){(0,op.Z)(this,e),this.name="RuleForRangedLine"}return(0,up.Z)(e,[{key:"hasMatchingType",value:function(e){if(uae(e)){var t=e.encoding;if("line"===e.mark){var n,r=(0,Rt.Z)(fie);try{for(r.s();!(n=r.n()).done;){var a=n.value,i=t[hie(a)];if(t[a]&&(Dse(i)&&!jie(i.bin)||Mse(i)))return!0}}catch(o){r.e(o)}finally{r.f()}}}return!1}},{key:"run",value:function(e,t,n){var r,a,i=e.encoding;return woe((r=!!i.x2,a=!!i.y2,"Line mark is for continuous lines and thus cannot be used with ".concat(r&&a?"x2 and y2":r?"x2":"y2",". We will use the rule mark (line segments) instead."))),n(Object.assign(Object.assign({},e),{mark:"rule"}),t)}}]),e}(),afe=function(e){(0,Ng.Z)(n,e);var t=(0,Tg.Z)(n);function n(){var e;return(0,op.Z)(this,n),(e=t.apply(this,arguments)).nonFacetUnitNormalizers=[Wce,Xce,ele,new Xle,new rfe,new Kle],e}return(0,up.Z)(n,[{key:"map",value:function(e,t){if(uae(e)){var r=Ece(e.encoding,yae),a=Ece(e.encoding,bae),i=Ece(e.encoding,xae);if(r||a||i)return this.mapFacetedUnit(e,t)}return(0,Ag.Z)((0,Eg.Z)(n.prototype),"map",this).call(this,e,t)}},{key:"mapUnit",value:function(e,t){var n=t.parentEncoding,r=t.parentProjection,a=Object.assign(Object.assign({},e),{encoding:$le(e.encoding,t.repeater)});if(n||r)return this.mapUnitWithParentEncodingOrProjection(a,t);var i,o=this.mapLayerOrUnit.bind(this),u=(0,Rt.Z)(this.nonFacetUnitNormalizers);try{for(u.s();!(i=u.n()).done;){var s=i.value;if(s.hasMatchingType(a,t.config))return s.run(a,t,o)}}catch(c){u.e(c)}finally{u.f()}return a}},{key:"mapRepeat",value:function(e,t){return function(e){return!kne(e.repeat)&&e.repeat.layer}(e)?this.mapLayerRepeat(e,t):this.mapNonLayerRepeat(e,t)}},{key:"mapLayerRepeat",value:function(e,t){var n=this,r=e.repeat,a=e.spec,i=jne(e,["repeat","spec"]),o=r.row,u=r.column,s=r.layer,c=t.repeater,l=void 0===c?{}:c,f=t.repeaterPrefix,d=void 0===f?"":f;return o||u?this.mapRepeat(Object.assign(Object.assign({},e),{repeat:Object.assign(Object.assign({},o?{row:o}:{}),u?{column:u}:{}),spec:{repeat:{layer:s},spec:a}}),t):Object.assign(Object.assign({},i),{layer:s.map((function(e){var r=Object.assign(Object.assign({},l),{layer:e}),i=(a.name||"")+d+"child__layer_".concat(pre(e)),o=n.mapLayerOrUnit(a,Object.assign(Object.assign({},t),{repeater:r,repeaterPrefix:i}));return o.name=i,o}))})}},{key:"mapNonLayerRepeat",value:function(e,t){var n,r=e,a=r.repeat,i=r.spec,o=r.data,u=jne(e,["repeat","spec","data"]);!kne(a)&&e.columns&&(e=$ne(e,["columns"]),woe(Kie("repeat")));var s,c=[],l=t.repeater,f=void 0===l?{}:l,d=t.repeaterPrefix,h=void 0===d?"":d,p=!kne(a)&&a.row||[f?f.row:null],v=!kne(a)&&a.column||[f?f.column:null],m=kne(a)&&a||[f?f.repeat:null],g=(0,Rt.Z)(m);try{for(g.s();!(s=g.n()).done;){var y,b=s.value,x=(0,Rt.Z)(p);try{for(x.s();!(y=x.n()).done;){var w,k=y.value,_=(0,Rt.Z)(v);try{for(_.s();!(w=_.n()).done;){var S=w.value,C={repeat:b,row:k,column:S,layer:f.layer},A=(i.name||"")+h+"child__"+(kne(a)?"".concat(pre(b)):(a.row?"row_".concat(pre(k)):"")+(a.column?"column_".concat(pre(S)):"")),E=this.map(i,Object.assign(Object.assign({},t),{repeater:C,repeaterPrefix:A}));E.name=A,c.push($ne(E,["data"]))}}catch(T){_.e(T)}finally{_.f()}}}catch(T){x.e(T)}finally{x.f()}}}catch(T){g.e(T)}finally{g.f()}var N=kne(a)?e.columns:a.column?a.column.length:1;return Object.assign(Object.assign({data:null!==(n=i.data)&&void 0!==n?n:o,align:"all"},u),{columns:N,concat:c})}},{key:"mapFacet",value:function(e,t){return wse(e.facet)&&e.columns&&(e=$ne(e,["columns"]),woe(Kie("facet"))),(0,Ag.Z)((0,Eg.Z)(n.prototype),"mapFacet",this).call(this,e,t)}},{key:"mapUnitWithParentEncodingOrProjection",value:function(e,t){var n=e.encoding,r=e.projection,a=t.parentEncoding,i=t.parentProjection,o=t.config,u=ofe({parentProjection:i,projection:r}),s=ife({parentEncoding:a,encoding:$le(n,t.repeater)});return this.mapUnit(Object.assign(Object.assign(Object.assign({},e),u?{projection:u}:{}),s?{encoding:s}:{}),{config:o})}},{key:"mapFacetedUnit",value:function(e,t){var n=e.encoding,r=n.row,a=n.column,i=n.facet,o=jne(n,["row","column","facet"]),u=e.mark,s=e.width,c=e.projection,l=e.height,f=e.view,d=e.selection,h=(e.encoding,jne(e,["mark","width","projection","height","view","selection","encoding"])),p=this.getFacetMappingAndLayout({row:r,column:a,facet:i},t),v=p.facetMapping,m=p.layout,g=$le(o,t.repeater);return this.mapFacet(Object.assign(Object.assign(Object.assign({},h),m),{facet:v,spec:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},s?{width:s}:{}),l?{height:l}:{}),f?{view:f}:{}),c?{projection:c}:{}),{mark:u,encoding:g}),d?{selection:d}:{})}),t)}},{key:"getFacetMappingAndLayout",value:function(e,t){var n,r=e.row,a=e.column,i=e.facet;if(r||a){i&&woe((m=[].concat((0,cn.Z)(r?[yae]:[]),(0,cn.Z)(a?[bae]:[])),"Facet encoding dropped as ".concat(m.join(" and ")," ").concat(m.length>1?"are":"is"," also specified.")));for(var o={},u={},s=0,c=[yae,bae];s<c.length;s++){var l=c[s],f=e[l];if(f){f.align,f.center,f.spacing,f.columns;var d=jne(f,["align","center","spacing","columns"]);o[l]=d;for(var h=0,p=["align","center","spacing"];h<p.length;h++){var v=p[h];void 0!==f[v]&&(u[v]=null!==(n=u[v])&&void 0!==n?n:{},u[v][l]=f[v])}}}return{facetMapping:o,layout:u}}var m,g=i.align,y=i.center,b=i.spacing,x=i.columns;return{facetMapping:Yle(jne(i,["align","center","spacing","columns"]),t.repeater),layout:Object.assign(Object.assign(Object.assign(Object.assign({},g?{align:g}:{}),y?{center:y}:{}),b?{spacing:b}:{}),x?{columns:x}:{})}}},{key:"mapLayer",value:function(e,t){var r=t.parentEncoding,a=t.parentProjection,i=jne(t,["parentEncoding","parentProjection"]),o=e.encoding,u=e.projection,s=jne(e,["encoding","projection"]),c=Object.assign(Object.assign({},i),{parentEncoding:ife({parentEncoding:r,encoding:o}),parentProjection:ofe({parentProjection:a,projection:u})});return(0,Ag.Z)((0,Eg.Z)(n.prototype),"mapLayer",this).call(this,s,c)}}]),n}(jle);function ife(e){var t,n=e.parentEncoding,r=e.encoding;if(n&&r){var a=lre(n).reduce((function(e,t){return r[t]&&e.push(t),e}),[]);a.length>0&&woe("Layer's shared ".concat((t=a).join(",")," channel ").concat(1===t.length?"is":"are"," overriden."))}var i=Object.assign(Object.assign({},null!==n&&void 0!==n?n:{}),null!==r&&void 0!==r?r:{});return cre(i)?void 0:i}function ofe(e){var t=e.parentProjection,n=e.projection;return t&&n&&woe(function(e){var t=e.parentProjection,n=e.projection;return"Layer's shared projection ".concat(Qne(t)," is overridden by a child projection ").concat(Qne(n),".")}({parentProjection:t,projection:n})),null!==n&&void 0!==n?n:t}function ufe(e,t){void 0===t&&(t=Tle(e.config));var n=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return sfe.map(e,{config:t})}(e,t),r=function(e,t,n){var r=t.width,a=t.height,i=uae(e)||Rle(e),o={};i?"container"==r&&"container"==a?(o.type="fit",o.contains="padding"):"container"==r?(o.type="fit-x",o.contains="padding"):"container"==a&&(o.type="fit-y",o.contains="padding"):("container"==r&&(woe(Wie("width")),r=void 0),"container"==a&&(woe(Wie("height")),a=void 0));var u=Object.assign(Object.assign(Object.assign({type:"pad"},o),n?cfe(n.autosize):{}),cfe(e.autosize));"fit"!==u.type||i||(woe(Uie),u.type="pad");"container"==r&&"fit"!=u.type&&"fit-x"!=u.type&&woe(Vie("width"));"container"==a&&"fit"!=u.type&&"fit-y"!=u.type&&woe(Vie("height"));if(Xne(u,{type:"pad"}))return;return u}(n,{width:e.width,height:e.height,autosize:e.autosize},t);return Object.assign(Object.assign({},n),r?{autosize:r}:{})}var sfe=new afe;function cfe(e){return Mne(e)?{type:e}:null!==e&&void 0!==e?e:{}}var lfe=["background","padding"];function ffe(e){return lfe.reduce((function(t,n){return e&&void 0!==e[n]&&(t[n]=e[n]),t}),{})}var dfe=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,op.Z)(this,e),this.explicit=t,this.implicit=n}return(0,up.Z)(e,[{key:"clone",value:function(){return new e(Kne(this.explicit),Kne(this.implicit))}},{key:"combine",value:function(){return Object.assign(Object.assign({},this.explicit),this.implicit)}},{key:"get",value:function(e){return Cre(this.explicit[e],this.implicit[e])}},{key:"getWithExplicit",value:function(e){return void 0!==this.explicit[e]?{explicit:!0,value:this.explicit[e]}:void 0!==this.implicit[e]?{explicit:!1,value:this.implicit[e]}:{explicit:!1,value:void 0}}},{key:"setWithExplicit",value:function(e,t){void 0!==t.value&&this.set(e,t.value,t.explicit)}},{key:"set",value:function(e,t,n){return delete this[n?"implicit":"explicit"][e],this[n?"explicit":"implicit"][e]=t,this}},{key:"copyKeyFromSplit",value:function(e,t){void 0!==t.explicit[e]?this.set(e,t.explicit[e],!0):void 0!==t.implicit[e]&&this.set(e,t.implicit[e],!1)}},{key:"copyKeyFromObject",value:function(e,t){void 0!==t[e]&&this.set(e,t[e],!0)}},{key:"copyAll",value:function(e){var t,n=(0,Rt.Z)(lre(e.combine()));try{for(n.s();!(t=n.n()).done;){var r=t.value,a=e.getWithExplicit(r);this.setWithExplicit(r,a)}}catch(i){n.e(i)}finally{n.f()}}}]),e}();function hfe(e){return{explicit:!0,value:e}}function pfe(e){return{explicit:!1,value:e}}function vfe(e){return function(t,n,r,a){var i=e(t.value,n.value);return i>0?t:i<0?n:mfe(t,n,r,a)}}function mfe(e,t,n,r){return e.explicit&&t.explicit&&woe(function(e,t,n,r){return"Conflicting ".concat(t.toString(),' property "').concat(e.toString(),'" (').concat(Qne(n)," and ").concat(Qne(r),"). Using ").concat(Qne(n),".")}(n,r,e.value,t.value)),e}function gfe(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:mfe;return void 0===e||void 0===e.value?t:e.explicit&&!t.explicit?e:t.explicit&&!e.explicit?t:Xne(e.value,t.value)?e:a(e,t,n,r)}var yfe=function(e){(0,Ng.Z)(n,e);var t=(0,Tg.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return(0,op.Z)(this,n),(e=t.call(this,r,a)).explicit=r,e.implicit=a,e.parseNothing=i,e}return(0,up.Z)(n,[{key:"clone",value:function(){var e=(0,Ag.Z)((0,Eg.Z)(n.prototype),"clone",this).call(this);return e.parseNothing=this.parseNothing,e}}]),n}(dfe);function bfe(e){return"url"in e}function xfe(e){return"values"in e}function wfe(e){return"name"in e&&!bfe(e)&&!xfe(e)&&!kfe(e)}function kfe(e){return e&&(_fe(e)||Sfe(e)||Cfe(e))}function _fe(e){return"sequence"in e}function Sfe(e){return"sphere"in e}function Cfe(e){return"graticule"in e}var Afe="main",Efe="raw";function Nfe(e){return"filter"in e}function Tfe(e){return"lookup"in e}function Ife(e){return"pivot"in e}function Dfe(e){return"density"in e}function Ffe(e){return"quantile"in e}function Mfe(e){return"regression"in e}function Ofe(e){return"loess"in e}function Rfe(e){return"sample"in e}function jfe(e){return"window"in e}function Bfe(e){return"joinaggregate"in e}function zfe(e){return"flatten"in e}function Zfe(e){return"calculate"in e}function Lfe(e){return"bin"in e}function Pfe(e){return"impute"in e}function Ufe(e){return"timeUnit"in e}function Wfe(e){return"aggregate"in e}function Vfe(e){return"stack"in e}function qfe(e){return"fold"in e}function Gfe(e,t,n,r){var a=Nse(t)&&t.condition,i=r(t);if(a){var o=Nne(a).map((function(t){var n=r(t),a=function(e){return e.selection}(t)?zpe(e,t.selection):Lpe(e,t.test);return Object.assign({test:a},n)}));return(0,Xn.Z)({},n,[].concat((0,cn.Z)(o),(0,cn.Z)(void 0!==i?[i]:[])))}return void 0!==i?(0,Xn.Z)({},n,i):{}}function Hfe(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"text",n=e.encoding[t];return Gfe(e,n,t,(function(t){return Xfe(t,e.config)}))}function Xfe(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"datum";if(e){if(zse(e))return vce(e.value);if(jse(e)){var r=tce(e),a=r.format,i=r.formatType;return ose({fieldOrDatumDef:e,format:a,formatType:i,expr:n,config:t})}}}function Kfe(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.encoding,r=e.markDef,a=e.config,i=e.stack,o=n.tooltip;if(kne(o))return{tooltip:$fe({tooltip:o},i,a,t)};var u=t.reactiveGeom?"datum.datum":"datum";return Gfe(e,o,"tooltip",(function(e){var o=Xfe(e,a,u);if(o)return o;if(null!==e){var s=bce("tooltip",r,a);return!0===s&&(s={content:"encoding"}),Mne(s)?{value:s}:_ne(s)?"encoding"===s.content?$fe(n,i,a,t):{signal:u}:void 0}}))}function Yfe(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},a=r.reactiveGeom,i={},o=a?"datum.datum":"datum",u=[];function s(r,a){var s,c=hie(a),l=Bse(r)?r:Object.assign(Object.assign({},r),{type:e[c].type}),f=Nne(Qse(l,n,{allowDisabling:!1})).join(", ");if(wie(a)){var d="x"===a?"x2":"y2",h=nce(e[d]);if(jie(l.bin)&&h){var p=Vse(l,{expr:o}),v=Vse(h,{expr:o}),m=tce(l);s=pse(p,v,m.format,m.formatType,n),i[d]=!0}else if(t&&t.fieldChannel===a&&"normalize"===t.offset){var g=tce(l);s=ose({fieldOrDatumDef:l,format:g.format,formatType:g.formatType,expr:o,config:n,normalizeStack:!0}).signal}}s=null!==s&&void 0!==s?s:Xfe(l,n,o).signal,u.push({channel:a,key:f,value:s})}Fce(e,(function(e,t){Dse(e)?s(e,t):Tse(e)&&s(e.condition,t)}));for(var c={},l=0,f=u;l<f.length;l++){var d=f[l],h=d.channel,p=d.key,v=d.value;i[h]||c[p]||(c[One(p)]=v)}return c}function $fe(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},a=r.reactiveGeom,i=Yfe(e,t,n,{reactiveGeom:a}),o=dre(i).map((function(e){var t=e.key,n=e.value;return"".concat(t,": ").concat(n)}));return o.length>0?{signal:"{".concat(o.join(", "),"}")}:void 0}function Qfe(e){var t=bce("aria",e.markDef,e.config);return!1===t?{}:Object.assign(Object.assign(Object.assign({},t?{aria:t}:{}),function(e){var t=e.mark,n=e.markDef,r=e.config;if(!1===r.aria)return{};var a=bce("ariaRoleDescription",n,r);if(null!=a)return{ariaRoleDescription:{value:a}};return t in qoe?{}:{ariaRoleDescription:{value:t}}}(e)),function(e){var t=e.encoding,n=e.markDef,r=e.config,a=e.stack,i=t.description;if(i)return Gfe(e,i,"description",(function(t){return Xfe(t,e.config)}));var o=bce("description",n,r);if(null!=o)return{description:vce(o)};if(!1===r.aria)return{};var u=Yfe(t,a,r);if(cre(u))return;return{description:{signal:dre(u).map((function(e){var t=e.key,n=e.value;return"".concat(t,' + ": " + (').concat(n,")")})).join(' + "; " + ')}}}(e))}function Jfe(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=t.markDef,a=t.encoding,i=t.config,o=n.vgChannel,u=n.defaultRef,s=n.defaultValue;void 0===u&&void 0!==(s=null!==s&&void 0!==s?s:bce(e,r,i,{vgChannel:o,ignoreVgConfig:!0}))&&(u=vce(s));var c=a[e];return Gfe(t,c,null!==o&&void 0!==o?o:e,(function(n){return nse({channel:e,channelDef:n,markDef:r,config:i,scaleName:t.scaleName(e),scale:t.getScaleComponent(e),stack:null,defaultRef:u})}))}function ede(e){var t,n,r,a,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{filled:void 0},o=e.markDef,u=e.encoding,s=e.config,c=o.type,l=null!==(t=i.filled)&&void 0!==t?t:bce("filled",o,s),f=tre(["bar","point","circle","square","geoshape"],c)?"transparent":void 0,d=null!==(r=null!==(n=bce(!0===l?"color":void 0,o,s,{vgChannel:"fill"}))&&void 0!==n?n:s.mark[!0===l&&"color"])&&void 0!==r?r:f,h=null!==(a=bce(!1===l?"color":void 0,o,s,{vgChannel:"stroke"}))&&void 0!==a?a:s.mark[!1===l&&"color"],p=l?"fill":"stroke",v=Object.assign(Object.assign({},d?{fill:vce(d)}:{}),h?{stroke:vce(h)}:{});return o.color&&(l?o.fill:o.stroke)&&woe(eoe("property",{fill:"fill"in o,stroke:"stroke"in o})),Object.assign(Object.assign(Object.assign(Object.assign({},v),Jfe("color",e,{vgChannel:p,defaultValue:l?d:h})),Jfe("fill",e,{defaultValue:u.fill?d:void 0})),Jfe("stroke",e,{defaultValue:u.stroke?h:void 0}))}function tde(e,t){var n=function(e){switch(e){case wae:return"xOffset";case kae:return"yOffset";case _ae:return"x2Offset";case Sae:return"y2Offset";case Eae:return"thetaOffset";case Cae:return"radiusOffset";case Nae:return"theta2Offset";case Aae:return"radius2Offset"}}(e),r=t[n];if(r)return r}function nde(e,t,n){var r=n.defaultPos,a=n.vgChannel,i=n.isMidPoint,o=t.encoding,u=t.markDef,s=t.config,c=t.stack,l=o[e],f=o[vie(e)],d=t.scaleName(e),h=t.getScaleComponent(e),p=tde(e,u),v=rde({model:t,defaultPos:r,channel:e,scaleName:d,scale:h}),m=!l&&wie(e)&&(o.latitude||o.longitude)?{field:t.getName(e)}:function(e){var t=e.channel,n=e.channelDef,r=e.isMidPoint,a=e.scaleName,i=e.stack,o=e.offset,u=e.markDef,s=e.config;if(jse(n)&&i&&t===i.fieldChannel){if(Dse(n)){var c=Ase({channel:t,fieldDef:n,isMidPoint:r,markDef:u,stack:i,config:s});if(void 0!==c)return tse({scaleName:a,fieldOrDatumDef:n,startSuffix:"start",band:c,offset:o})}return ese(n,a,{suffix:"end"},{offset:o})}return Yue(e)}({channel:e,channelDef:l,channel2Def:f,markDef:u,config:s,isMidPoint:i,scaleName:d,scale:h,stack:c,offset:p,defaultRef:v});return m?(0,Xn.Z)({},a||e,m):void 0}function rde(e){var t=e.model,n=e.defaultPos,r=e.channel,a=e.scaleName,i=e.scale,o=t.markDef,u=t.config;return function(){var e=hie(r),s=pie(r),c=bce(r,o,u,{vgChannel:s});if(void 0!==c)return rse(r,c);switch(n){case"zeroOrMin":case"zeroOrMax":if(a){var l=i.get("type");if(tre([vue,bue,xue],l));else if(i.domainDefinitelyIncludesZero())return{scale:a,value:0}}if("zeroOrMin"===n)return"y"===e?{field:{group:"height"}}:{value:0};switch(e){case"radius":return{signal:"min(".concat(t.width.signal,",").concat(t.height.signal,")/2")};case"theta":return{signal:"2*PI"};case"x":return{field:{group:"width"}};case"y":return{value:0}}break;case"mid":var f=t[mie(r)];return Object.assign(Object.assign({},f),{mult:.5})}}}var ade={left:"x",center:"xc",right:"x2"},ide={top:"y",middle:"yc",bottom:"y2"};function ode(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"middle";if("radius"===e||"theta"===e)return pie(e);var a="x"===e?"align":"baseline",i=bce(a,t,n);return"x"===e?ade[i||("top"===r?"left":"center")]:ide[i||r]}function ude(e,t,n){var r=n.defaultPos,a=n.defaultPos2;return n.range?sde(e,t,{defaultPos:r,defaultPos2:a}):nde(e,t,{defaultPos:r})}function sde(e,t,n){var r=n.defaultPos,a=n.defaultPos2,i=t.markDef,o=t.config,u=vie(e),s=mie(e),c=function(e,t,n){var r,a=e.encoding,i=e.mark,o=e.markDef,u=e.stack,s=e.config,c=hie(n),l=mie(n),f=pie(n),d=a[c],h=e.scaleName(c),p=e.getScaleComponent(c),v=tde(n in a||n in o?n:c,e.markDef);if(!d&&("x2"===n||"y2"===n)&&(a.latitude||a.longitude))return(0,Xn.Z)({},f,{field:e.getName(n)});var m=function(e){var t=e.channel,n=e.channelDef,r=e.channel2Def,a=e.markDef,i=e.config,o=e.scaleName,u=e.scale,s=e.stack,c=e.offset,l=e.defaultRef;if(jse(n)&&s&&t.charAt(0)===s.fieldChannel.charAt(0))return ese(n,o,{suffix:"start"},{offset:c});return Yue({channel:t,channelDef:r,scaleName:o,scale:u,stack:s,markDef:a,config:i,offset:c,defaultRef:l})}({channel:n,channelDef:d,channel2Def:a[n],markDef:o,config:s,scaleName:h,scale:p,stack:u,offset:v,defaultRef:void 0});if(void 0!==m)return(0,Xn.Z)({},f,m);return cde(n,o)||cde(n,(r={},(0,Xn.Z)(r,n,wce(n,o,s.style)),(0,Xn.Z)(r,l,wce(l,o,s.style)),r))||cde(n,s[i])||cde(n,s.mark)||(0,Xn.Z)({},f,rde({model:e,defaultPos:t,channel:n,scaleName:h,scale:p})())}(t,a,u),l=c[s]?ode(e,i,o):pie(e);return Object.assign(Object.assign({},nde(e,t,{defaultPos:r,vgChannel:l})),c)}function cde(e,t){var n=mie(e),r=pie(e);return void 0!==t[r]?(0,Xn.Z)({},r,rse(e,t[r])):void 0!==t[e]?(0,Xn.Z)({},r,rse(e,t[e])):t[n]?(0,Xn.Z)({},n,rse(e,t[n])):void 0}function lde(e,t,n){var r,a,i,o,u=e.config,s=e.encoding,c=e.markDef,l=e.stack,f=vie(t),d=mie(t),h=s[t],p=s[f],v=e.getScaleComponent(t),m=v?v.get("type"):void 0,g=e.scaleName(t),y=c.orient,b=null!==(a=null!==(r=s[d])&&void 0!==r?r:s.size)&&void 0!==a?a:bce("size",c,u,{vgChannel:d}),x="bar"===n&&("x"===t?"vertical"===y:"horizontal"===y);if(Dse(h)&&(Rie(h.bin)||jie(h.bin)||h.timeUnit&&!p)&&!b&&!Bue(m)){var w=Ase({channel:t,fieldDef:h,stack:l,markDef:c,config:u}),k=null===(i=e.component.axes[t])||void 0===i?void 0:i[0];return function(e){var t,n=e.fieldDef,r=e.fieldDef2,a=e.channel,i=e.band,o=e.scaleName,u=e.markDef,s=e.spacing,c=void 0===s?0:s,l=e.axisTranslate,f=e.reverse,d=e.config,h=vie(a),p=pie(a),v=pie(h),m=tde(a,u);if(Rie(n.bin)||n.timeUnit)return t={},(0,Xn.Z)(t,v,dde({channel:a,fieldDef:n,scaleName:o,markDef:u,band:(1-i)/2,offset:fde(h,c,f,l,m),config:d})),(0,Xn.Z)(t,p,dde({channel:a,fieldDef:n,scaleName:o,markDef:u,band:1-(1-i)/2,offset:fde(a,c,f,l,m),config:d})),t;if(jie(n.bin)){var g,y,b=ese(n,o,{},{offset:fde(h,c,f,l,m)});if(Dse(r))return g={},(0,Xn.Z)(g,v,b),(0,Xn.Z)(g,p,ese(r,o,{},{offset:fde(a,c,f,l,m)})),g;if(Bie(n.bin)&&n.bin.step)return y={},(0,Xn.Z)(y,v,b),(0,Xn.Z)(y,p,{signal:'scale("'.concat(o,'", ').concat(Vse(n,{expr:"datum"})," + ").concat(n.bin.step,")"),offset:fde(a,c,f,l,m)}),y}return void woe(moe(h))}({fieldDef:h,fieldDef2:p,channel:t,markDef:c,scaleName:g,band:w,axisTranslate:null!==(o=null===k||void 0===k?void 0:k.get("translate"))&&void 0!==o?o:.5,spacing:wie(t)?bce("binSpacing",c,u):void 0,reverse:v.get("reverse"),config:u})}return(jse(h)&&Bue(m)||x)&&!p?function(e,t,n,r){var a,i,o=r.markDef,u=r.encoding,s=r.config,c=r.stack,l=o.orient,f=r.scaleName(n),d=r.getScaleComponent(n),h=mie(n),p=vie(n),v="horizontal"===l&&"y"===n||"vertical"===l&&"x"===n,m=bce(v?"size":h,o,s,{vgChannel:h});(u.size||void 0!==m)&&(v?i=Jfe("size",r,{vgChannel:h,defaultValue:m}):woe(function(e){return'Cannot apply size to non-oriented mark "'.concat(e,'".')}(o.type)));var g=null!==(a=jse(t)?Ase({channel:n,fieldDef:t,markDef:o,stack:c,config:s}):void 0)&&void 0!==a?a:1;i=i||(0,Xn.Z)({},h,function(e,t,n,r,a,i){if(r){var o=r.get("type");if("point"===o||"band"===o){if(void 0!==a[e].discreteBandSize)return{value:a[e].discreteBandSize};if(o===Sue){var u=r.get("range");return Uoe(u)&&Fne(u.step)?{value:u.step-2}:{value:wle-2}}return{scale:n,band:i}}return{value:a[e].continuousBandSize}}var s=ble(a.view,t),c=Cre(a[e].discreteBandSize,s-2);return void 0!==c?{value:c}:void 0}(e,h,f,d,s,g));var y="band"!==(null===d||void 0===d?void 0:d.get("type"))||!("band"in i[h]),b=ode(n,o,s,y?"middle":"top"),x=tde(n,o),w=Yue({channel:n,channelDef:t,markDef:o,config:s,scaleName:f,scale:d,stack:c,offset:x,defaultRef:rde({model:r,defaultPos:"mid",channel:n,scaleName:f,scale:d}),band:y?.5:(1-g)/2});if(h)return Object.assign((0,Xn.Z)({},b,w),i);var k,_=pie(p),S=i[h],C=x?Object.assign(Object.assign({},S),{offset:x}):S;return k={},(0,Xn.Z)(k,b,w),(0,Xn.Z)(k,_,kne(w)?[w[0],Object.assign(Object.assign({},w[1]),{offset:C})]:Object.assign(Object.assign({},w),{offset:C})),k}(n,h,t,e):sde(t,e,{defaultPos:"zeroOrMax",defaultPos2:"zeroOrMin"})}function fde(e,t,n,r,a){if(Jae(e))return 0;var i="x"===e||"y2"===e?-t/2:t/2;if(Poe(n)){var o=gce(a);return{signal:"".concat(n.signal," ? ").concat(r-i).concat(o?"-"+o:""," : ").concat(r+i).concat(o?"+"+o:"")}}if(Poe(a)){var u=r+(n?-i:i);return{signal:"".concat(u||"").concat(n?" - ":u?" + ":"").concat(a.signal)}}return a=a||0,r+(n?-a-i:+a+i)}function dde(e){var t=e.channel,n=e.fieldDef,r=e.scaleName,a=e.markDef,i=e.band,o=e.offset,u=e.config;return $ue({fieldDef:n,channel:t,markDef:a,ref:tse({scaleName:r,fieldOrDatumDef:n,band:i,offset:o}),config:u})}var hde=new Set(["aria"]);function pde(e,t){var n="include"===t.color?ede(e):{},r=n.fill,a=void 0===r?void 0:r,i=n.stroke,o=void 0===i?void 0:i;return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},function(e,t){return Voe.reduce((function(n,r){return hde.has(r)||void 0===e[r]||"ignore"===t[r]||(n[r]=vce(e[r])),n}),{})}(e.markDef,t)),vde(e,"fill",a)),vde(e,"stroke",o)),Jfe("opacity",e)),Jfe("fillOpacity",e)),Jfe("strokeOpacity",e)),Jfe("strokeWidth",e)),Jfe("strokeDash",e)),Kfe(e)),Hfe(e,"href")),Qfe(e))}function vde(e,t,n){var r=e.config,a=e.mark;if("hide"===bce("invalid",e.markDef,r)&&n&&!Qre(a)){var i=function(e,t){var n=t.invalid,r=void 0!==n&&n,a=t.channels.reduce((function(t,n){var r=e.getScaleComponent(n);if(r){var a=r.get("type"),i=e.vgField(n,{expr:"datum"});i&&zue(a)&&(t[i]=!0)}return t}),{}),i=lre(a);if(i.length>0){var o=r?"||":"&&";return i.map((function(e){return Jue(e,r)})).join(" ".concat(o," "))}return}(e,{invalid:!0,channels:Nie});if(i)return(0,Xn.Z)({},t,[{test:i,value:null}].concat((0,cn.Z)(Nne(n))))}return n?(0,Xn.Z)({},t,n):{}}function mde(e){var t=e.config;if(bce("invalid",e.markDef,t)){var n=function(e,t){var n=t.invalid,r=void 0!==n&&n,a=t.channels.reduce((function(t,n){var r=e.getScaleComponent(n);if(r){var a=r.get("type"),i=e.vgField(n,{expr:"datum"});i&&zue(a)&&(t[i]=!0)}return t}),{}),i=lre(a);if(i.length>0){var o=r?"||":"&&";return i.map((function(e){return Jue(e,r)})).join(" ".concat(o," "))}return}(e,{channels:xie});if(n)return{defined:{signal:n}}}return{}}function gde(e,t){if(void 0!==t)return(0,Xn.Z)({},e,vce(t))}var yde="voronoi",bde={has:function(e){return"interval"!==e.type&&e.nearest},parse:function(e,t){if(t.events){var n,r=(0,Rt.Z)(t.events);try{for(r.s();!(n=r.n()).done;){n.value.markname=e.getName(yde)}}catch(a){r.e(a)}finally{r.f()}}},marks:function(e,t,n){var r=t.project.hasChannel,a=r.x,i=r.y,o=e.mark;if(Qre(o))return woe('The "nearest" transform is not supported for '.concat(o," marks.")),n;var u={name:e.getName(yde),type:"path",interactive:!0,from:{data:e.getName("marks")},encode:{update:Object.assign({fill:{value:"transparent"},strokeWidth:{value:.35},stroke:{value:"transparent"},isVoronoi:{value:!0}},Kfe(e,{reactiveGeom:!0}))},transform:[{type:"voronoi",x:{expr:a||!i?"datum.datum.x || 0":"0"},y:{expr:i||!a?"datum.datum.y || 0":"0"},size:[e.getSizeSignalRef("width"),e.getSizeSignalRef("height")]}]},s=0,c=!1;return n.forEach((function(t,n){var r,a=null!==(r=t.name)&&void 0!==r?r:"";a===e.component.mark[0].name?s=n:a.indexOf(yde)>=0&&(c=!0)})),c||n.splice(s+1,0,u),n}},xde=bde,wde=function(){function e(t,n){(0,op.Z)(this,e),this.debugName=n,this._children=[],this._parent=null,t&&(this.parent=t)}return(0,up.Z)(e,[{key:"clone",value:function(){throw new Error("Cannot clone node")}},{key:"parent",get:function(){return this._parent},set:function(e){this._parent=e,e&&e.addChild(this)}},{key:"children",get:function(){return this._children}},{key:"numChildren",value:function(){return this._children.length}},{key:"addChild",value:function(e,t){this._children.indexOf(e)>-1?console.warn("Attempt to add the same child twice."):void 0!==t?this._children.splice(t,0,e):this._children.push(e)}},{key:"removeChild",value:function(e){var t=this._children.indexOf(e);return this._children.splice(t,1),t}},{key:"remove",value:function(){var e,t=this._parent.removeChild(this),n=(0,Rt.Z)(this._children);try{for(n.s();!(e=n.n()).done;){var r=e.value;r._parent=this._parent,this._parent.addChild(r,t++)}}catch(a){n.e(a)}finally{n.f()}}},{key:"insertAsParentOf",value:function(e){var t=e.parent;t.removeChild(this),this.parent=t,e.parent=this}},{key:"swapWithParent",value:function(){var e,t=this._parent,n=t.parent,r=(0,Rt.Z)(this._children);try{for(r.s();!(e=r.n()).done;){e.value.parent=t}}catch(a){r.e(a)}finally{r.f()}this._children=[],t.removeChild(this),t.parent.removeChild(t),this.parent=n,t.parent=this}}]),e}(),kde=function(e){(0,Ng.Z)(n,e);var t=(0,Tg.Z)(n);function n(e,r,a,i){var o;return(0,op.Z)(this,n),(o=t.call(this,e,r)).type=a,o.refCounts=i,o._source=o._name=r,o.refCounts&&!(o._name in o.refCounts)&&(o.refCounts[o._name]=0),o}return(0,up.Z)(n,[{key:"clone",value:function(){var e=new this.constructor;return e.debugName="clone_"+this.debugName,e._source=this._source,e._name="clone_"+this._name,e.type=this.type,e.refCounts=this.refCounts,e.refCounts[e._name]=0,e}},{key:"dependentFields",value:function(){return new Set}},{key:"producedFields",value:function(){return new Set}},{key:"hash",value:function(){return void 0===this._hash&&(this._hash="Output ".concat(function(e){var t=++Are;return e?String(e)+t:t}())),this._hash}},{key:"getSource",value:function(){return this.refCounts[this._name]++,this._source}},{key:"isRequired",value:function(){return!!this.refCounts[this._name]}},{key:"setSource",value:function(e){this._source=e}}]),n}(wde),_de=function(e){(0,Ng.Z)(n,e);var t=(0,Tg.Z)(n);function n(e,r){var a;return(0,op.Z)(this,n),(a=t.call(this,e)).formula=r,a}return(0,up.Z)(n,[{key:"clone",value:function(){return new n(null,Kne(this.formula))}},{key:"merge",value:function(e){for(var t in this.formula=Object.assign({},this.formula),e.formula)this.formula[t]&&!e.formula[t].band||(this.formula[t]=e.formula[t]);var n,r=(0,Rt.Z)(e.children);try{for(r.s();!(n=r.n()).done;){var a=n.value;e.removeChild(a),a.parent=this}}catch(i){r.e(i)}finally{r.f()}e.remove()}},{key:"producedFields",value:function(){return new Set(fre(this.formula).map((function(e){return e.as})))}},{key:"dependentFields",value:function(){return new Set(fre(this.formula).map((function(e){return e.field})))}},{key:"hash",value:function(){return"TimeUnit ".concat(Jne(this.formula))}},{key:"assemble",value:function(){var e,t=[],n=(0,Rt.Z)(fre(this.formula));try{for(n.s();!(e=n.n()).done;){var r=e.value,a=r.field,i=r.as,o=Zoe(r.timeUnit),u=o.unit,s=o.utc,c=jne(o,["unit","utc"]);t.push(Object.assign(Object.assign(Object.assign(Object.assign({field:wre(a),type:"timeunit"},u?{units:Roe(u)}:{}),s?{timezone:"utc"}:{}),c),{as:[i,"".concat(i,"_end")]}))}}catch(l){n.e(l)}finally{n.f()}return t}}],[{key:"makeFromEncoding",value:function(e,t){var r=t.reduceFieldDef((function(e,n,r){var a=n.field,i=n.timeUnit,o=bge(t)?t.encoding[vie(r)]:void 0,u=bge(t)&&Ese(r,n,o,t.stack,t.markDef,t.config);if(i){var s=Vse(n,{forAs:!0});e[Jne({as:s,field:a,timeUnit:i})]=Object.assign({as:s,field:a,timeUnit:i},u?{band:!0}:{})}return e}),{});return cre(r)?null:new n(e,r)}},{key:"makeFromTransform",value:function(e,t){var r=Object.assign({},t),a=r.timeUnit,i=jne(r,["timeUnit"]),o=Zoe(a),u=Object.assign(Object.assign({},i),{timeUnit:o});return new n(e,(0,Xn.Z)({},Jne(u),u))}}]),n}(wde),Sde="_tuple_fields",Cde=(0,up.Z)((function e(){(0,op.Z)(this,e);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];this.items=n,this.hasChannel={},this.hasField={}})),Ade={has:function(){return!0},parse:function(e,t,n){var r,a,i,o=t.name,u=null!==(r=t.project)&&void 0!==r?r:t.project=new Cde,s={},c={},l=new Set,f=function(e,t){for(var n="visual"===t?e.channel:e.field,r=pre("".concat(o,"_").concat(n)),a=1;l.has(r);a++)r=pre("".concat(o,"_").concat(n,"_").concat(a));return l.add(r),(0,Xn.Z)({},t,r)};if(!n.fields&&!n.encodings){var d=e.config.selection[n.type];if(n.init){var h,p=(0,Rt.Z)(Nne(n.init));try{for(p.s();!(h=p.n()).done;){var v,m=h.value,g=(0,Rt.Z)(lre(m));try{for(g.s();!(v=g.n()).done;){var y=v.value;cie[y]?(n.encodings||(n.encodings=[])).push(y):"interval"===n.type?(woe('Interval selections should be initialized using "x" and/or "y" keys.'),n.encodings=d.encodings):(n.fields||(n.fields=[])).push(y)}}catch(M){g.e(M)}finally{g.f()}}}catch(M){p.e(M)}finally{p.f()}}else n.encodings=d.encodings,n.fields=d.fields}var b,x=(0,Rt.Z)(null!==(a=n.fields)&&void 0!==a?a:[]);try{for(x.s();!(b=x.n()).done;){var w=b.value,k={type:"E",field:w};k.signals=Object.assign({},f(k,"data")),u.items.push(k),u.hasField[w]=k}}catch(M){x.e(M)}finally{x.f()}var _,S=(0,Rt.Z)(null!==(i=n.encodings)&&void 0!==i?i:[]);try{for(S.s();!(_=S.n()).done;){var C=_.value,A=e.fieldDef(C);if(A){var E=A.field;if(A.aggregate){woe(Hie(C,A.aggregate));continue}if(!E){woe(Gie(C));continue}if(A.timeUnit){E=e.vgField(C);var N={timeUnit:A.timeUnit,as:E,field:A.field};c[Jne(N)]=N}if(!s[E]){var T="E";if("interval"===t.type)zue(e.getScaleComponent(C).get("type"))&&(T="R");else A.bin&&(T="R-RE");var I={field:E,channel:C,type:T};I.signals=Object.assign(Object.assign({},f(I,"data")),f(I,"visual")),u.items.push(s[E]=I),u.hasField[E]=u.hasChannel[C]=s[E]}}else woe(Gie(C))}}catch(M){S.e(M)}finally{S.f()}if(n.init){var D=function(e){return u.items.map((function(t){return void 0!==e[t.channel]?e[t.channel]:e[t.field]}))};if("interval"===n.type)t.init=D(n.init);else{var F=Nne(n.init);t.init=F.map(D)}}cre(c)||(u.timeUnit=new _de(null,c))},signals:function(e,t,n){var r=t.name+Sde,a=n.filter((function(e){return e.name===r}));return a.length>0?n:n.concat({name:r,value:t.project.items.map((function(e){e.signals,e.hasLegend;var t=jne(e,["signals","hasLegend"]);return t.field=wre(t.field),t}))})}},Ede={has:function(e){return"single"===e.type&&"global"===e.resolve&&e.bind&&"scales"!==e.bind&&!lle(e.bind)},parse:function(e,t,n,r){r.on||delete t.events,r.clear||delete t.clear},topLevelSignals:function(e,t,n){var r=t.name,a=t.project,i=t.bind,o=t.init&&t.init[0],u=xde.has(t)?"(item().isVoronoi ? datum.datum : datum)":"datum";return a.items.forEach((function(e,a){var s,c,l=pre("".concat(r,"_").concat(e.field)),f=n.filter((function(e){return e.name===l}));f.length||n.unshift(Object.assign(Object.assign({name:l},o?{init:Hde(o[a])}:{value:null}),{on:t.events?[{events:t.events,update:"datum && item().mark.marktype !== 'group' ? ".concat(u,"[").concat(One(e.field),"] : null")}]:[],bind:null!==(c=null!==(s=i[e.field])&&void 0!==s?s:i[e.channel])&&void 0!==c?c:i}))})),n},signals:function(e,t,n){var r=t.name,a=t.project,i=n.filter((function(e){return e.name===r+ahe}))[0],o=r+Sde,u=a.items.map((function(e){return pre("".concat(r,"_").concat(e.field))})),s=u.map((function(e){return"".concat(e," !== null")})).join(" && ");return u.length&&(i.update="".concat(s," ? {fields: ").concat(o,", values: [").concat(u.join(", "),"]} : null")),delete i.value,delete i.on,n}},Nde=Ede,Tde="_toggle",Ide={has:function(e){return"multi"===e.type&&!!e.toggle},signals:function(e,t,n){return n.concat({name:t.name+Tde,value:!1,on:[{events:t.events,update:t.toggle}]})},modifyExpr:function(e,t){var n=t.name+ahe,r=t.name+Tde;return"".concat(r," ? null : ").concat(n,", ")+("global"===t.resolve?"".concat(r," ? null : true, "):"".concat(r," ? null : {unit: ").concat(lhe(e),"}, "))+"".concat(r," ? ").concat(n," : null")}},Dde={has:function(e){return void 0!==e.clear&&!1!==e.clear},parse:function(e,t,n){n.clear&&(t.clear=Mne(n.clear)?une(n.clear,"scope"):n.clear)},topLevelSignals:function(e,t,n){if(Nde.has(t)){var r,a=(0,Rt.Z)(t.project.items);try{var i=function(){var e=r.value,a=n.findIndex((function(n){return n.name===pre("".concat(t.name,"_").concat(e.field))}));-1!==a&&n[a].on.push({events:t.clear,update:"null"})};for(a.s();!(r=a.n()).done;)i()}catch(o){a.e(o)}finally{a.f()}}return n},signals:function(e,t,n){function r(e,r){-1!==e&&n[e].on&&n[e].on.push({events:t.clear,update:r})}if("interval"===t.type){var a,i=(0,Rt.Z)(t.project.items);try{var o=function(){var e=a.value,t=n.findIndex((function(t){return t.name===e.signals.visual}));(r(t,"[0, 0]"),-1===t)&&r(n.findIndex((function(t){return t.name===e.signals.data})),"null")};for(i.s();!(a=i.n()).done;)o()}catch(s){i.e(s)}finally{i.f()}}else{var u=n.findIndex((function(e){return e.name===t.name+ahe}));r(u,"null"),Ide.has(t)&&r(u=n.findIndex((function(e){return e.name===t.name+Tde})),"false")}return n}},Fde={has:function(e){return"interval"===e.type&&"global"===e.resolve&&e.bind&&"scales"===e.bind},parse:function(e,t){var n,r=t.scales=[],a=(0,Rt.Z)(t.project.items);try{for(a.s();!(n=a.n()).done;){var i=n.value,o=i.channel;if(Tie(o)){var u=e.getScaleComponent(o),s=u?u.get("type"):void 0;if(u&&zue(s)){var c={selection:t.name,field:i.field};u.set("selectionExtent",c,!0),r.push(i)}else woe("Scale bindings are currently only supported for scales with unbinned, continuous domains.")}}}catch(l){a.e(l)}finally{a.f()}},topLevelSignals:function(e,t,n){var r=t.scales.filter((function(e){return 0===n.filter((function(t){return t.name===e.signals.data})).length}));if(!e.parent||Rde(e)||0===r.length)return n;var a=n.filter((function(e){return e.name===t.name}))[0],i=a.update;if(i.indexOf(ohe)>=0)a.update="{".concat(r.map((function(e){return"".concat(One(e.field),": ").concat(e.signals.data)})).join(", "),"}");else{var o,u=(0,Rt.Z)(r);try{for(u.s();!(o=u.n()).done;){var s=o.value,c="".concat(One(s.field),": ").concat(s.signals.data);i.indexOf(c)<0&&(i="".concat(i.substring(0,i.length-1),", ").concat(c,"}"))}}catch(l){u.e(l)}finally{u.f()}a.update=i}return n.concat(r.map((function(e){return{name:e.signals.data}})))},signals:function(e,t,n){if(e.parent&&!Rde(e)){var r,a=(0,Rt.Z)(t.scales);try{var i=function(){var e=r.value,t=n.filter((function(t){return t.name===e.signals.data}))[0];t.push="outer",delete t.value,delete t.update};for(a.s();!(r=a.n()).done;)i()}catch(o){a.e(o)}finally{a.f()}}return n}},Mde=Fde;function Ode(e,t){var n=One(e.scaleName(t));return"domain(".concat(n,")")}function Rde(e){var t;return e.parent&&kge(e.parent)&&(null!==(t=!e.parent.parent)&&void 0!==t?t:Rde(e.parent.parent))}var jde={has:function(e){var t="global"===e.resolve&&e.bind&&lle(e.bind),n=1===e.project.items.length&&e.project.items[0].field!==sle;return t&&!n&&woe("Legend bindings are only supported for selections over an individual field or encoding channel."),t&&n},parse:function(e,t,n,r){var a;if(r.on||delete t.events,r.clear||delete t.clear,r.on||r.clear){var i,o='event.item && indexof(event.item.mark.role, "legend") < 0',u=(0,Rt.Z)(t.events);try{for(u.s();!(i=u.n()).done;){var s=i.value;s.filter=Nne(null!==(a=s.filter)&&void 0!==a?a:[]),s.filter.indexOf(o)<0&&s.filter.push(o)}}catch(f){u.e(f)}finally{u.f()}}var c=fle(t.bind)?t.bind.legend:"click",l=Mne(c)?une(c,"view"):Nne(c);t.bind={legend:{merge:l}}},topLevelSignals:function(e,t,n){var r,a=t.name,i=fle(t.bind)&&t.bind.legend,o=function(e){return function(t){var n=Kne(t);return n.markname=e,n}},u=(0,Rt.Z)(t.project.items);try{var s=function(){var e=r.value;if(!e.hasLegend)return"continue";var u="".concat(pre(e.field),"_legend"),s="".concat(a,"_").concat(u),c=n.filter((function(e){return e.name===s}));if(0===c.length){var l=i.merge.map(o("".concat(u,"_symbols"))).concat(i.merge.map(o("".concat(u,"_labels")))).concat(i.merge.map(o("".concat(u,"_entries"))));n.unshift(Object.assign(Object.assign({name:s},t.init?{}:{value:null}),{on:[{events:l,update:"datum.value || item().items[0].items[0].datum.value",force:!0},{events:i.merge,update:"!event.item || !datum ? null : ".concat(s),force:!0}]}))}};for(u.s();!(r=u.n()).done;)s()}catch(c){u.e(c)}finally{u.f()}return n},signals:function(e,t,n){var r=t.name,a=t.project,i=n.find((function(e){return e.name===r+ahe})),o=r+Sde,u=a.items.filter((function(e){return e.hasLegend})).map((function(e){return pre("".concat(r,"_").concat(pre(e.field),"_legend"))})),s=u.map((function(e){return"".concat(e," !== null")})).join(" && "),c="".concat(s," ? {fields: ").concat(o,", values: [").concat(u.join(", "),"]} : null");t.events&&u.length>0?i.on.push({events:u.map((function(e){return{signal:e}})),update:c}):u.length>0&&(i.update=c,delete i.value,delete i.on);var l=n.find((function(e){return e.name===r+Tde})),f=fle(t.bind)&&t.bind.legend;return l&&(t.events?l.on.push(Object.assign(Object.assign({},l.on[0]),{events:f})):l.on[0].events=f),n}};var Bde="_translate_anchor",zde="_translate_delta",Zde={has:function(e){return"interval"===e.type&&e.translate},signals:function(e,t,n){var r=t.name,a=Mde.has(t),i=r+Bde,o=t.project.hasChannel,u=o.x,s=o.y,c=une(t.translate,"scope");return a||(c=c.map((function(e){return e.between[0].markname=r+Yde,e}))),n.push({name:i,value:{},on:[{events:c.map((function(e){return e.between[0]})),update:"{x: x(unit), y: y(unit)"+(void 0!==u?", extent_x: "+(a?Ode(e,wae):"slice(".concat(u.signals.visual,")")):"")+(void 0!==s?", extent_y: "+(a?Ode(e,kae):"slice(".concat(s.signals.visual,")")):"")+"}"}]},{name:r+zde,value:{},on:[{events:c,update:"{x: ".concat(i,".x - x(unit), y: ").concat(i,".y - y(unit)}")}]}),void 0!==u&&Lde(e,t,u,"width",n),void 0!==s&&Lde(e,t,s,"height",n),n}};function Lde(e,t,n,r,a){var i,o=t.name,u=o+Bde,s=o+zde,c=n.channel,l=Mde.has(t),f=a.filter((function(e){return e.name===n.signals[l?"data":"visual"]}))[0],d=e.getSizeSignalRef(r).signal,h=e.getScaleComponent(c),p=h.get("type"),v=l&&c===wae?"-":"",m="".concat(u,".extent_").concat(c),g="".concat(v).concat(s,".").concat(c," / ")+(l?"".concat(d):"span(".concat(m,")")),y="".concat(l?"log"===p?"panLog":"pow"===p?"panPow":"panLinear":"panLinear","(").concat(m,", ").concat(g)+(l&&"pow"===p?", ".concat(null!==(i=h.get("exponent"))&&void 0!==i?i:1):"")+")";f.on.push({events:{signal:s},update:l?y:"clampRange(".concat(y,", 0, ").concat(d,")")})}var Pde="_zoom_anchor",Ude="_zoom_delta",Wde={has:function(e){return"interval"===e.type&&e.zoom},signals:function(e,t,n){var r=t.name,a=Mde.has(t),i=r+Ude,o=t.project.hasChannel,u=o.x,s=o.y,c=One(e.scaleName(wae)),l=One(e.scaleName(kae)),f=une(t.zoom,"scope");return a||(f=f.map((function(e){return e.markname=r+Yde,e}))),n.push({name:r+Pde,on:[{events:f,update:a?"{"+[c?"x: invert(".concat(c,", x(unit))"):"",l?"y: invert(".concat(l,", y(unit))"):""].filter((function(e){return!!e})).join(", ")+"}":"{x: x(unit), y: y(unit)}"}]},{name:i,on:[{events:f,force:!0,update:"pow(1.001, event.deltaY * pow(16, event.deltaMode))"}]}),void 0!==u&&Vde(e,t,u,"width",n),void 0!==s&&Vde(e,t,s,"height",n),n}};function Vde(e,t,n,r,a){var i,o=t.name,u=n.channel,s=Mde.has(t),c=a.filter((function(e){return e.name===n.signals[s?"data":"visual"]}))[0],l=e.getSizeSignalRef(r).signal,f=e.getScaleComponent(u),d=f.get("type"),h=s?Ode(e,u):c.name,p=o+Ude,v="".concat(o).concat(Pde,".").concat(u),m="".concat(s?"log"===d?"zoomLog":"pow"===d?"zoomPow":"zoomLinear":"zoomLinear","(").concat(h,", ").concat(v,", ").concat(p)+(s&&"pow"===d?", ".concat(null!==(i=f.get("exponent"))&&void 0!==i?i:1):"")+")";c.on.push({events:{signal:p},update:s?m:"clampRange(".concat(m,", 0, ").concat(l,")")})}var qde=[Ade,Ide,Mde,jde,Zde,Wde,Nde,xde,Dde];function Gde(e,t){var n,r=(0,Rt.Z)(qde);try{for(r.s();!(n=r.n()).done;){var a=n.value;a.has(e)&&t(a)}}catch(i){r.e(i)}finally{r.f()}}function Hde(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:xne;if(kne(e)){var r=e.map((function(e){return Hde(e,t,n)}));return t?"[".concat(r.join(", "),"]"):r}return koe(e)?n(t?Noe(e):Ioe(e)):t?n(JSON.stringify(e)):e}function Xde(e,t){return she(e,(function(n,r){t=r.marks?r.marks(e,n,t):t,Gde(n,(function(r){r.marks&&(t=r.marks(e,n,t))}))})),t}function Kde(e){return e.map((function(e){return e.on&&!e.on.length&&delete e.on,e}))}var Yde="_brush",$de="_scale_trigger",Qde={signals:function(e,t){var n=t.name,r=n+Sde,a=Mde.has(t),i=[],o=[],u=[];if(t.translate&&!a){var s="!event.item || event.item.mark.name !== ".concat(One(n+Yde));Jde(t,(function(e,t){var n,r=Nne(null!==(n=t.between[0].filter)&&void 0!==n?n:t.between[0].filter=[]);return r.indexOf(s)<0&&r.push(s),e}))}t.project.items.forEach((function(n,r){var a=n.channel;if(a===wae||a===kae){var s=t.init?t.init[r]:null,c=function(e,t,n,r){var a=n.channel,i=n.signals.visual,o=n.signals.data,u=Mde.has(t),s=One(e.scaleName(a)),c=e.getScaleComponent(a),l=c?c.get("type"):void 0,f=function(e){return"scale(".concat(s,", ").concat(e,")")},d=e.getSizeSignalRef(a===wae?"width":"height").signal,h="".concat(a,"(unit)"),p=Jde(t,(function(e,t){return[].concat((0,cn.Z)(e),[{events:t.between[0],update:"[".concat(h,", ").concat(h,"]")},{events:t,update:"[".concat(i,"[0], clamp(").concat(h,", 0, ").concat(d,")]")}])}));return p.push({events:{signal:t.name+$de},update:zue(l)?"[".concat(f("".concat(o,"[0]")),", ").concat(f("".concat(o,"[1]")),"]"):"[0, 0]"}),u?[{name:o,on:[]}]:[Object.assign(Object.assign({name:i},r?{init:Hde(r,!0,f)}:{value:[]}),{on:p}),Object.assign(Object.assign({name:o},r?{init:Hde(r)}:{}),{on:[{events:{signal:i},update:"".concat(i,"[0] === ").concat(i,"[1] ? null : invert(").concat(s,", ").concat(i,")")}]})]}(e,t,n,s),l=n.signals.data,f=n.signals.visual,d=One(e.scaleName(a)),h=zue(e.getScaleComponent(a).get("type"))?"+":"";i.push.apply(i,(0,cn.Z)(c)),o.push(l),u.push({scaleName:e.scaleName(a),expr:"(!isArray(".concat(l,") || ")+"(".concat(h,"invert(").concat(d,", ").concat(f,")[0] === ").concat(h).concat(l,"[0] && ")+"".concat(h,"invert(").concat(d,", ").concat(f,")[1] === ").concat(h).concat(l,"[1]))")})}else woe("Interval selections only support x and y encoding channels.")})),a||i.push({name:n+$de,value:{},on:[{events:u.map((function(e){return{scale:e.scaleName}})),update:u.map((function(e){return e.expr})).join(" && ")+" ? ".concat(n+$de," : {}")}]});var c=t.init,l="unit: ".concat(lhe(e),", fields: ").concat(r,", values");return i.concat(Object.assign(Object.assign({name:n+ahe},c?{init:"{".concat(l,": ").concat(Hde(c),"}")}:{}),{on:[{events:[{signal:o.join(" || ")}],update:o.join(" && ")+" ? {".concat(l,": [").concat(o,"]} : null")}]}))},modifyExpr:function(e,t){return t.name+ahe+", "+("global"===t.resolve?"true":"{unit: ".concat(lhe(e),"}"))},marks:function(e,t,n){var r=t.name,a=t.project.hasChannel,i=a.x,o=a.y,u=i&&i.signals.visual,s=o&&o.signals.visual,c="data(".concat(One(t.name+rhe),")");if(Mde.has(t))return n;var l={x:void 0!==i?{signal:"".concat(u,"[0]")}:{value:0},y:void 0!==o?{signal:"".concat(s,"[0]")}:{value:0},x2:void 0!==i?{signal:"".concat(u,"[1]")}:{field:{group:"width"}},y2:void 0!==o?{signal:"".concat(s,"[1]")}:{field:{group:"height"}}};if("global"===t.resolve){var f,d=(0,Rt.Z)(lre(l));try{for(d.s();!(f=d.n()).done;){var h=f.value;l[h]=[Object.assign({test:"".concat(c,".length && ").concat(c,"[0].unit === ").concat(lhe(e))},l[h]),{value:0}]}}catch(x){d.e(x)}finally{d.f()}}var p=t.mark,v=p.fill,m=p.fillOpacity,g=p.cursor,y=jne(p,["fill","fillOpacity","cursor"]),b=lre(y).reduce((function(e,t){return e[t]=[{test:[void 0!==i&&"".concat(u,"[0] !== ").concat(u,"[1]"),void 0!==o&&"".concat(s,"[0] !== ").concat(s,"[1]")].filter((function(e){return e})).join(" && "),value:y[t]},{value:null}],e}),{});return[{name:r+Yde+"_bg",type:"rect",clip:!0,encode:{enter:{fill:{value:v},fillOpacity:{value:m}},update:l}}].concat((0,cn.Z)(n),[{name:r+Yde,type:"rect",clip:!0,encode:{enter:Object.assign(Object.assign({},g?{cursor:{value:g}}:{}),{fill:{value:"transparent"}}),update:Object.assign(Object.assign({},l),b)}}])}};function Jde(e,t){return e.events.reduce((function(e,n){return n.between?t(e,n):(woe("".concat(n," is not an ordered event stream for interval selections.")),e)}),[])}function ehe(e,t){var n=t.name,r=n+Sde,a=t.project,i="(item().isVoronoi ? datum.datum : datum)",o=a.items.map((function(t){var n=e.fieldDef(t.channel);return n&&n.bin?"[".concat(i,"[").concat(One(e.vgField(t.channel,{})),"], ")+"".concat(i,"[").concat(One(e.vgField(t.channel,{binSuffix:"end"})),"]]"):"".concat(i,"[").concat(One(t.field),"]")})).join(", "),u="unit: ".concat(lhe(e),", fields: ").concat(r,", values"),s=t.events;return[{name:n+ahe,on:s?[{events:s,update:"datum && item().mark.marktype !== 'group' ? {".concat(u,": [").concat(o,"]} : null"),force:!0}]:[]}]}var the={signals:ehe,modifyExpr:function(e,t){return t.name+ahe+", "+("global"===t.resolve?"null":"{unit: ".concat(lhe(e),"}"))}},nhe={signals:ehe,modifyExpr:function(e,t){return t.name+ahe+", "+("global"===t.resolve?"true":"{unit: ".concat(lhe(e),"}"))}},rhe="_store",ahe="_tuple",ihe="_modify",ohe="vlSelectionResolve",uhe={single:nhe,multi:the,interval:Qde};function she(e,t){var n=e.component.selection;if(n){var r,a=(0,Rt.Z)(fre(n));try{for(a.s();!(r=a.n()).done;){var i=r.value;if(!0===t(i,uhe[i.type]))break}}catch(o){a.e(o)}finally{a.f()}}}function che(e){for(var t=e.parent;t&&!xge(t);)t=t.parent;return t}function lhe(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{escape:!0},n=t.escape,r=n?One(e.name):e.name,a=che(e);if(a){var i,o=a.facet,u=(0,Rt.Z)(iie);try{for(u.s();!(i=u.n()).done;){var s=i.value;o[s]&&(r+=" + '__facet_".concat(s,"_' + (facet[").concat(One(a.vgField(s)),"])"))}}catch(c){u.e(c)}finally{u.f()}}return r}function fhe(e){var t=!1;return she(e,(function(e){t=t||e.project.items.some((function(e){return e.field===sle}))})),t}var dhe,hhe,phe,vhe,mhe,ghe="Property",yhe="ArrayExpression",bhe="BinaryExpression",xhe="CallExpression",whe="ConditionalExpression",khe="LogicalExpression",_he="MemberExpression",She="ObjectExpression",Che="UnaryExpression";function Ahe(e){this.type=e}Ahe.prototype.visit=function(e){var t,n,r;if(e(this))return 1;for(n=0,r=(t=function(e){switch(e.type){case yhe:return e.elements;case bhe:case khe:return[e.left,e.right];case xhe:return[e.callee].concat(e.arguments);case whe:return[e.test,e.consequent,e.alternate];case _he:return[e.object,e.property];case She:return e.properties;case ghe:return[e.key,e.value];case Che:return[e.argument];default:return[]}}(this)).length;n<r;++n)if(t[n].visit(e))return 1};(dhe={})[1]="Boolean",dhe[2]="<end>",dhe[3]="Identifier",dhe[4]="Keyword",dhe[5]="Null",dhe[6]="Numeric",dhe[7]="Punctuator",dhe[8]="String",dhe[9]="RegularExpression";var Ehe="Identifier",Nhe="Unexpected token %0",The="Invalid regular expression",Ihe="Invalid regular expression: missing /",Dhe="Octal literals are not allowed in strict mode.",Fhe="ILLEGAL",Mhe="Disabled.",Ohe=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0620-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u08A0-\\u08B2\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971-\\u0980\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D\\u0C58\\u0C59\\u0C60\\u0C61\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0CF1\\u0CF2\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D60\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EDC-\\u0EDF\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u1820-\\u1877\\u1880-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19C1-\\u19C7\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF\\u1BBA-\\u1BE5\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1CE9-\\u1CEC\\u1CEE-\\u1CF1\\u1CF5\\u1CF6\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005-\\u3007\\u3021-\\u3029\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B\\uA640-\\uA66E\\uA67F-\\uA69D\\uA6A0-\\uA6EF\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA8F2-\\uA8F7\\uA8FB\\uA90A-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF\\uA9E0-\\uA9E4\\uA9E6-\\uA9EF\\uA9FA-\\uA9FE\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA60-\\uAA76\\uAA7A\\uAA7E-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABE2\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]"),Rhe=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0300-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u0483-\\u0487\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u0591-\\u05BD\\u05BF\\u05C1\\u05C2\\u05C4\\u05C5\\u05C7\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0610-\\u061A\\u0620-\\u0669\\u066E-\\u06D3\\u06D5-\\u06DC\\u06DF-\\u06E8\\u06EA-\\u06FC\\u06FF\\u0710-\\u074A\\u074D-\\u07B1\\u07C0-\\u07F5\\u07FA\\u0800-\\u082D\\u0840-\\u085B\\u08A0-\\u08B2\\u08E4-\\u0963\\u0966-\\u096F\\u0971-\\u0983\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BC-\\u09C4\\u09C7\\u09C8\\u09CB-\\u09CE\\u09D7\\u09DC\\u09DD\\u09DF-\\u09E3\\u09E6-\\u09F1\\u0A01-\\u0A03\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A3C\\u0A3E-\\u0A42\\u0A47\\u0A48\\u0A4B-\\u0A4D\\u0A51\\u0A59-\\u0A5C\\u0A5E\\u0A66-\\u0A75\\u0A81-\\u0A83\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABC-\\u0AC5\\u0AC7-\\u0AC9\\u0ACB-\\u0ACD\\u0AD0\\u0AE0-\\u0AE3\\u0AE6-\\u0AEF\\u0B01-\\u0B03\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3C-\\u0B44\\u0B47\\u0B48\\u0B4B-\\u0B4D\\u0B56\\u0B57\\u0B5C\\u0B5D\\u0B5F-\\u0B63\\u0B66-\\u0B6F\\u0B71\\u0B82\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BBE-\\u0BC2\\u0BC6-\\u0BC8\\u0BCA-\\u0BCD\\u0BD0\\u0BD7\\u0BE6-\\u0BEF\\u0C00-\\u0C03\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D-\\u0C44\\u0C46-\\u0C48\\u0C4A-\\u0C4D\\u0C55\\u0C56\\u0C58\\u0C59\\u0C60-\\u0C63\\u0C66-\\u0C6F\\u0C81-\\u0C83\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBC-\\u0CC4\\u0CC6-\\u0CC8\\u0CCA-\\u0CCD\\u0CD5\\u0CD6\\u0CDE\\u0CE0-\\u0CE3\\u0CE6-\\u0CEF\\u0CF1\\u0CF2\\u0D01-\\u0D03\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D-\\u0D44\\u0D46-\\u0D48\\u0D4A-\\u0D4E\\u0D57\\u0D60-\\u0D63\\u0D66-\\u0D6F\\u0D7A-\\u0D7F\\u0D82\\u0D83\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0DCA\\u0DCF-\\u0DD4\\u0DD6\\u0DD8-\\u0DDF\\u0DE6-\\u0DEF\\u0DF2\\u0DF3\\u0E01-\\u0E3A\\u0E40-\\u0E4E\\u0E50-\\u0E59\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB9\\u0EBB-\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EC8-\\u0ECD\\u0ED0-\\u0ED9\\u0EDC-\\u0EDF\\u0F00\\u0F18\\u0F19\\u0F20-\\u0F29\\u0F35\\u0F37\\u0F39\\u0F3E-\\u0F47\\u0F49-\\u0F6C\\u0F71-\\u0F84\\u0F86-\\u0F97\\u0F99-\\u0FBC\\u0FC6\\u1000-\\u1049\\u1050-\\u109D\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u135D-\\u135F\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1714\\u1720-\\u1734\\u1740-\\u1753\\u1760-\\u176C\\u176E-\\u1770\\u1772\\u1773\\u1780-\\u17D3\\u17D7\\u17DC\\u17DD\\u17E0-\\u17E9\\u180B-\\u180D\\u1810-\\u1819\\u1820-\\u1877\\u1880-\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1920-\\u192B\\u1930-\\u193B\\u1946-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19B0-\\u19C9\\u19D0-\\u19D9\\u1A00-\\u1A1B\\u1A20-\\u1A5E\\u1A60-\\u1A7C\\u1A7F-\\u1A89\\u1A90-\\u1A99\\u1AA7\\u1AB0-\\u1ABD\\u1B00-\\u1B4B\\u1B50-\\u1B59\\u1B6B-\\u1B73\\u1B80-\\u1BF3\\u1C00-\\u1C37\\u1C40-\\u1C49\\u1C4D-\\u1C7D\\u1CD0-\\u1CD2\\u1CD4-\\u1CF6\\u1CF8\\u1CF9\\u1D00-\\u1DF5\\u1DFC-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u200C\\u200D\\u203F\\u2040\\u2054\\u2071\\u207F\\u2090-\\u209C\\u20D0-\\u20DC\\u20E1\\u20E5-\\u20F0\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D7F-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2DE0-\\u2DFF\\u2E2F\\u3005-\\u3007\\u3021-\\u302F\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u3099\\u309A\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA62B\\uA640-\\uA66F\\uA674-\\uA67D\\uA67F-\\uA69D\\uA69F-\\uA6F1\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA827\\uA840-\\uA873\\uA880-\\uA8C4\\uA8D0-\\uA8D9\\uA8E0-\\uA8F7\\uA8FB\\uA900-\\uA92D\\uA930-\\uA953\\uA960-\\uA97C\\uA980-\\uA9C0\\uA9CF-\\uA9D9\\uA9E0-\\uA9FE\\uAA00-\\uAA36\\uAA40-\\uAA4D\\uAA50-\\uAA59\\uAA60-\\uAA76\\uAA7A-\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEF\\uAAF2-\\uAAF6\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABEA\\uABEC\\uABED\\uABF0-\\uABF9\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE00-\\uFE0F\\uFE20-\\uFE2D\\uFE33\\uFE34\\uFE4D-\\uFE4F\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF10-\\uFF19\\uFF21-\\uFF3A\\uFF3F\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]");function jhe(e,t){if(!e)throw new Error("ASSERT: "+t)}function Bhe(e){return e>=48&&e<=57}function zhe(e){return"0123456789abcdefABCDEF".indexOf(e)>=0}function Zhe(e){return"01234567".indexOf(e)>=0}function Lhe(e){return 32===e||9===e||11===e||12===e||160===e||e>=5760&&[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].indexOf(e)>=0}function Phe(e){return 10===e||13===e||8232===e||8233===e}function Uhe(e){return 36===e||95===e||e>=65&&e<=90||e>=97&&e<=122||92===e||e>=128&&Ohe.test(String.fromCharCode(e))}function Whe(e){return 36===e||95===e||e>=65&&e<=90||e>=97&&e<=122||e>=48&&e<=57||92===e||e>=128&&Rhe.test(String.fromCharCode(e))}var Vhe={if:1,in:1,do:1,var:1,for:1,new:1,try:1,let:1,this:1,else:1,case:1,void:1,with:1,enum:1,while:1,break:1,catch:1,throw:1,const:1,yield:1,class:1,super:1,return:1,typeof:1,delete:1,switch:1,export:1,import:1,public:1,static:1,default:1,finally:1,extends:1,package:1,private:1,function:1,continue:1,debugger:1,interface:1,protected:1,instanceof:1,implements:1};function qhe(){for(var e;phe<vhe&&(Lhe(e=hhe.charCodeAt(phe))||Phe(e));)++phe}function Ghe(e){var t,n,r,a=0;for(n="u"===e?4:2,t=0;t<n;++t)phe<vhe&&zhe(hhe[phe])?(r=hhe[phe++],a=16*a+"0123456789abcdef".indexOf(r.toLowerCase())):spe({},Nhe,Fhe);return String.fromCharCode(a)}function Hhe(){var e,t,n,r;for(t=0,"}"===(e=hhe[phe])&&spe({},Nhe,Fhe);phe<vhe&&zhe(e=hhe[phe++]);)t=16*t+"0123456789abcdef".indexOf(e.toLowerCase());return(t>1114111||"}"!==e)&&spe({},Nhe,Fhe),t<=65535?String.fromCharCode(t):(n=55296+(t-65536>>10),r=56320+(t-65536&1023),String.fromCharCode(n,r))}function Xhe(){var e,t;for(e=hhe.charCodeAt(phe++),t=String.fromCharCode(e),92===e&&(117!==hhe.charCodeAt(phe)&&spe({},Nhe,Fhe),++phe,(e=Ghe("u"))&&"\\"!==e&&Uhe(e.charCodeAt(0))||spe({},Nhe,Fhe),t=e);phe<vhe&&Whe(e=hhe.charCodeAt(phe));)++phe,t+=String.fromCharCode(e),92===e&&(t=t.substr(0,t.length-1),117!==hhe.charCodeAt(phe)&&spe({},Nhe,Fhe),++phe,(e=Ghe("u"))&&"\\"!==e&&Whe(e.charCodeAt(0))||spe({},Nhe,Fhe),t+=e);return t}function Khe(){var e,t;return e=phe,t=92===hhe.charCodeAt(phe)?Xhe():function(){var e,t;for(e=phe++;phe<vhe;){if(92===(t=hhe.charCodeAt(phe)))return phe=e,Xhe();if(!Whe(t))break;++phe}return hhe.slice(e,phe)}(),{type:1===t.length?3:Vhe.hasOwnProperty(t)?4:"null"===t?5:"true"===t||"false"===t?1:3,value:t,start:e,end:phe}}function Yhe(){var e,t,n,r,a=phe,i=hhe.charCodeAt(phe),o=hhe[phe];switch(i){case 46:case 40:case 41:case 59:case 44:case 123:case 125:case 91:case 93:case 58:case 63:case 126:return++phe,{type:7,value:String.fromCharCode(i),start:a,end:phe};default:if(61===(e=hhe.charCodeAt(phe+1)))switch(i){case 43:case 45:case 47:case 60:case 62:case 94:case 124:case 37:case 38:case 42:return phe+=2,{type:7,value:String.fromCharCode(i)+String.fromCharCode(e),start:a,end:phe};case 33:case 61:return phe+=2,61===hhe.charCodeAt(phe)&&++phe,{type:7,value:hhe.slice(a,phe),start:a,end:phe}}}return">>>="===(r=hhe.substr(phe,4))?{type:7,value:r,start:a,end:phe+=4}:">>>"===(n=r.substr(0,3))||"<<="===n||">>="===n?{type:7,value:n,start:a,end:phe+=3}:o===(t=n.substr(0,2))[1]&&"+-<>&|".indexOf(o)>=0||"=>"===t?{type:7,value:t,start:a,end:phe+=2}:"<>=!+-*%&|^/".indexOf(o)>=0?{type:7,value:o,start:a,end:++phe}:void spe({},Nhe,Fhe)}function $he(){var e,t,n;if(jhe(Bhe((n=hhe[phe]).charCodeAt(0))||"."===n,"Numeric literal must start with a decimal digit or a decimal point"),t=phe,e="","."!==n){if(e=hhe[phe++],n=hhe[phe],"0"===e){if("x"===n||"X"===n)return++phe,function(e){for(var t="";phe<vhe&&zhe(hhe[phe]);)t+=hhe[phe++];return 0===t.length&&spe({},Nhe,Fhe),Uhe(hhe.charCodeAt(phe))&&spe({},Nhe,Fhe),{type:6,value:parseInt("0x"+t,16),start:e,end:phe}}(t);if(Zhe(n))return function(e){for(var t="0"+hhe[phe++];phe<vhe&&Zhe(hhe[phe]);)t+=hhe[phe++];return(Uhe(hhe.charCodeAt(phe))||Bhe(hhe.charCodeAt(phe)))&&spe({},Nhe,Fhe),{type:6,value:parseInt(t,8),octal:!0,start:e,end:phe}}(t);n&&Bhe(n.charCodeAt(0))&&spe({},Nhe,Fhe)}for(;Bhe(hhe.charCodeAt(phe));)e+=hhe[phe++];n=hhe[phe]}if("."===n){for(e+=hhe[phe++];Bhe(hhe.charCodeAt(phe));)e+=hhe[phe++];n=hhe[phe]}if("e"===n||"E"===n)if(e+=hhe[phe++],"+"!==(n=hhe[phe])&&"-"!==n||(e+=hhe[phe++]),Bhe(hhe.charCodeAt(phe)))for(;Bhe(hhe.charCodeAt(phe));)e+=hhe[phe++];else spe({},Nhe,Fhe);return Uhe(hhe.charCodeAt(phe))&&spe({},Nhe,Fhe),{type:6,value:parseFloat(e),start:t,end:phe}}function Qhe(){var e,t,n,r;return mhe=null,qhe(),e=phe,t=function(){var e,t,n,r;for(jhe("/"===(e=hhe[phe]),"Regular expression literal must start with a slash"),t=hhe[phe++],n=!1,r=!1;phe<vhe;)if(t+=e=hhe[phe++],"\\"===e)Phe((e=hhe[phe++]).charCodeAt(0))&&spe({},Ihe),t+=e;else if(Phe(e.charCodeAt(0)))spe({},Ihe);else if(n)"]"===e&&(n=!1);else{if("/"===e){r=!0;break}"["===e&&(n=!0)}return r||spe({},Ihe),{value:t.substr(1,t.length-2),literal:t}}(),n=function(){var e,t,n;for(t="",n="";phe<vhe&&Whe((e=hhe[phe]).charCodeAt(0));)++phe,"\\"===e&&phe<vhe?spe({},Nhe,Fhe):(n+=e,t+=e);return n.search(/[^gimuy]/g)>=0&&spe({},The,n),{value:n,literal:t}}(),r=function(e,t){var n=e;t.indexOf("u")>=0&&(n=n.replace(/\\u\{([0-9a-fA-F]+)\}/g,(function(e,t){if(parseInt(t,16)<=1114111)return"x";spe({},The)})).replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"x"));try{new RegExp(n)}catch(r){spe({},The)}try{return new RegExp(e,t)}catch(a){return null}}(t.value,n.value),{literal:t.literal+n.literal,value:r,regex:{pattern:t.value,flags:n.value},start:e,end:phe}}function Jhe(){var e;return qhe(),phe>=vhe?{type:2,start:phe,end:phe}:Uhe(e=hhe.charCodeAt(phe))?Khe():40===e||41===e||59===e?Yhe():39===e||34===e?function(){var e,t,n,r,a="",i=!1;for(jhe("'"===(e=hhe[phe])||'"'===e,"String literal must starts with a quote"),t=phe,++phe;phe<vhe;){if((n=hhe[phe++])===e){e="";break}if("\\"===n)if((n=hhe[phe++])&&Phe(n.charCodeAt(0)))"\r"===n&&"\n"===hhe[phe]&&++phe;else switch(n){case"u":case"x":"{"===hhe[phe]?(++phe,a+=Hhe()):a+=Ghe(n);break;case"n":a+="\n";break;case"r":a+="\r";break;case"t":a+="\t";break;case"b":a+="\b";break;case"f":a+="\f";break;case"v":a+="\v";break;default:Zhe(n)?(0!==(r="01234567".indexOf(n))&&(i=!0),phe<vhe&&Zhe(hhe[phe])&&(i=!0,r=8*r+"01234567".indexOf(hhe[phe++]),"0123".indexOf(n)>=0&&phe<vhe&&Zhe(hhe[phe])&&(r=8*r+"01234567".indexOf(hhe[phe++]))),a+=String.fromCharCode(r)):a+=n}else{if(Phe(n.charCodeAt(0)))break;a+=n}}return""!==e&&spe({},Nhe,Fhe),{type:8,value:a,octal:i,start:t,end:phe}}():46===e?Bhe(hhe.charCodeAt(phe+1))?$he():Yhe():Bhe(e)?$he():Yhe()}function epe(){var e;return phe=(e=mhe).end,mhe=Jhe(),phe=e.end,e}function tpe(){var e;e=phe,mhe=Jhe(),phe=e}function npe(e,t,n){var r=new Ahe("||"===e||"&&"===e?"LogicalExpression":"BinaryExpression");return r.operator=e,r.left=t,r.right=n,r}function rpe(e,t){var n=new Ahe("CallExpression");return n.callee=e,n.arguments=t,n}function ape(e){var t=new Ahe(Ehe);return t.name=e,t}function ipe(e){var t=new Ahe("Literal");return t.value=e.value,t.raw=hhe.slice(e.start,e.end),e.regex&&("//"===t.raw&&(t.raw="/(?:)/"),t.regex=e.regex),t}function ope(e,t,n){var r=new Ahe("MemberExpression");return r.computed="["===e,r.object=t,r.property=n,r.computed||(n.member=!0),r}function upe(e,t,n){var r=new Ahe("Property");return r.key=t,r.value=n,r.kind=e,r}function spe(e,t){var n,r=Array.prototype.slice.call(arguments,2),a=t.replace(/%(\d)/g,(function(e,t){return jhe(t<r.length,"Message reference must be in range"),r[t]}));throw(n=new Error(a)).index=phe,n.description=a,n}function cpe(e){2===e.type&&spe(e,"Unexpected end of input"),6===e.type&&spe(e,"Unexpected number"),8===e.type&&spe(e,"Unexpected string"),3===e.type&&spe(e,"Unexpected identifier"),4===e.type&&spe(e,"Unexpected reserved word"),spe(e,Nhe,e.value)}function lpe(e){var t=epe();7===t.type&&t.value===e||cpe(t)}function fpe(e){return 7===mhe.type&&mhe.value===e}function dpe(e){return 4===mhe.type&&mhe.value===e}function hpe(){var e=[];for(phe=mhe.start,lpe("[");!fpe("]");)fpe(",")?(epe(),e.push(null)):(e.push(Cpe()),fpe("]")||lpe(","));return epe(),function(e){var t=new Ahe("ArrayExpression");return t.elements=e,t}(e)}function ppe(){var e;return phe=mhe.start,8===(e=epe()).type||6===e.type?(e.octal&&spe(e,Dhe),ipe(e)):ape(e.value)}function vpe(){var e,t,n;return phe=mhe.start,3===(e=mhe).type?(n=ppe(),lpe(":"),upe("init",n,Cpe())):2!==e.type&&7!==e.type?(t=ppe(),lpe(":"),upe("init",t,Cpe())):void cpe(e)}function mpe(){var e,t,n=[],r={},a=String;for(phe=mhe.start,lpe("{");!fpe("}");)t="$"+((e=vpe()).key.type===Ehe?e.key.name:a(e.key.value)),Object.prototype.hasOwnProperty.call(r,t)?spe({},"Duplicate data property in object literal not allowed in strict mode"):r[t]=!0,n.push(e),fpe("}")||lpe(",");return lpe("}"),function(e){var t=new Ahe("ObjectExpression");return t.properties=e,t}(n)}var gpe={if:1};function ype(){var e,t,n;if(fpe("("))return function(){var e;return lpe("("),e=Ape(),lpe(")"),e}();if(fpe("["))return hpe();if(fpe("{"))return mpe();if(e=mhe.type,phe=mhe.start,3===e||gpe[mhe.value])n=ape(epe().value);else if(8===e||6===e)mhe.octal&&spe(mhe,Dhe),n=ipe(epe());else{if(4===e)throw new Error(Mhe);1===e?((t=epe()).value="true"===t.value,n=ipe(t)):5===e?((t=epe()).value=null,n=ipe(t)):fpe("/")||fpe("/=")?(n=ipe(Qhe()),tpe()):cpe(epe())}return n}function bpe(){var e=[];if(lpe("("),!fpe(")"))for(;phe<vhe&&(e.push(Cpe()),!fpe(")"));)lpe(",");return lpe(")"),e}function xpe(){return lpe("."),function(){var e;return phe=mhe.start,function(e){return 3===e.type||4===e.type||1===e.type||5===e.type}(e=epe())||cpe(e),ape(e.value)}()}function wpe(){var e;return lpe("["),e=Ape(),lpe("]"),e}function kpe(){var e=function(){var e;for(e=ype();;)if(fpe("."))e=ope(".",e,xpe());else if(fpe("("))e=rpe(e,bpe());else{if(!fpe("["))break;e=ope("[",e,wpe())}return e}();if(7===mhe.type&&(fpe("++")||fpe("--")))throw new Error(Mhe);return e}function _pe(){var e,t;if(7!==mhe.type&&4!==mhe.type)t=kpe();else{if(fpe("++")||fpe("--"))throw new Error(Mhe);if(fpe("+")||fpe("-")||fpe("~")||fpe("!"))e=epe(),t=_pe(),t=function(e,t){var n=new Ahe("UnaryExpression");return n.operator=e,n.argument=t,n.prefix=!0,n}(e.value,t);else{if(dpe("delete")||dpe("void")||dpe("typeof"))throw new Error(Mhe);t=kpe()}}return t}function Spe(e){var t=0;if(7!==e.type&&4!==e.type)return 0;switch(e.value){case"||":t=1;break;case"&&":t=2;break;case"|":t=3;break;case"^":t=4;break;case"&":t=5;break;case"==":case"!=":case"===":case"!==":t=6;break;case"<":case">":case"<=":case">=":case"instanceof":case"in":t=7;break;case"<<":case">>":case">>>":t=8;break;case"+":case"-":t=9;break;case"*":case"/":case"%":t=11}return t}function Cpe(){var e,t;return e=function(){var e,t,n,r,a,i,o,u,s,c;if(e=mhe,s=_pe(),0===(a=Spe(r=mhe)))return s;for(r.prec=a,epe(),t=[e,mhe],i=[s,r,o=_pe()];(a=Spe(mhe))>0;){for(;i.length>2&&a<=i[i.length-2].prec;)o=i.pop(),u=i.pop().value,s=i.pop(),t.pop(),n=npe(u,s,o),i.push(n);(r=epe()).prec=a,i.push(r),t.push(mhe),n=_pe(),i.push(n)}for(n=i[c=i.length-1],t.pop();c>1;)t.pop(),n=npe(i[c-1].value,i[c-2],n),c-=2;return n}(),fpe("?")&&(epe(),t=Cpe(),lpe(":"),e=function(e,t,n){var r=new Ahe("ConditionalExpression");return r.test=e,r.consequent=t,r.alternate=n,r}(e,t,Cpe())),e}function Ape(){var e=Cpe();if(fpe(","))throw new Error(Mhe);return e}function Epe(e,t,n){return e.fields=t||[],e.fname=n,e}function Npe(e){return 1===e.length?Tpe(e[0]):Ipe(e)}var Tpe=function(e){return function(t){return t[e]}},Ipe=function(e){var t=e.length;return function(n){for(var r=0;r<t;++r)n=n[e[r]];return n}};function Dpe(e){throw Error(e)}function Fpe(e){var t,n,r,a=[],i=e.length,o=null,u=0,s="";function c(){a.push(s+e.substring(t,n)),s="",t=n+1}for(e+="",t=n=0;n<i;++n)if("\\"===(r=e[n]))s+=e.substring(t,n++),t=n;else if(r===o)c(),o=null,u=-1;else{if(o)continue;t===u&&'"'===r||t===u&&"'"===r?(t=n+1,o=r):"."!==r||u?"["===r?(n>t&&c(),u=t=n+1):"]"===r&&(u||Dpe("Access path missing open bracket: "+e),u>0&&c(),u=0,t=n+1):n>t?c():t=n+1}return u&&Dpe("Access path missing closing bracket: "+e),o&&Dpe("Access path missing closing quote: "+e),n>t&&(n++,c()),a}function Mpe(e,t,n){var r=Fpe(e);return e=1===r.length?r[0]:e,Epe((n&&n.get||Npe)(r),[e],t||e)}Mpe("id"),Epe((function(e){return e}),[],"identity"),Epe((function(){return 0}),[],"zero"),Epe((function(){return 1}),[],"one"),Epe((function(){return!0}),[],"true"),Epe((function(){return!1}),[],"false");Array.isArray;Object.prototype.hasOwnProperty;function Ope(e){var t=[];return"Identifier"===e.type?[e.name]:"Literal"===e.type?[e.value]:("MemberExpression"===e.type&&(t.push.apply(t,(0,cn.Z)(Ope(e.object))),t.push.apply(t,(0,cn.Z)(Ope(e.property)))),t)}function Rpe(e){return"MemberExpression"===e.object.type?Rpe(e.object):"datum"===e.object.name}function jpe(e){var t=function(e){phe=0,vhe=(hhe=e).length,mhe=null,tpe();var t=Ape();if(2!==mhe.type)throw new Error("Unexpect token after expression.");return t}(e),n=new Set;return t.visit((function(e){"MemberExpression"===e.type&&Rpe(e)&&n.add(Ope(e).slice(1).join("."))})),n}var Bpe=function(e){(0,Ng.Z)(n,e);var t=(0,Tg.Z)(n);function n(e,r,a){var i;return(0,op.Z)(this,n),(i=t.call(this,e)).model=r,i.filter=a,i.expr=Lpe(i.model,i.filter,(0,Cg.Z)(i)),i._dependentFields=jpe(i.expr),i}return(0,up.Z)(n,[{key:"clone",value:function(){return new n(null,this.model,Kne(this.filter))}},{key:"dependentFields",value:function(){return this._dependentFields}},{key:"producedFields",value:function(){return new Set}},{key:"assemble",value:function(){return{type:"filter",expr:this.expr}}},{key:"hash",value:function(){return"Filter ".concat(this.expr)}}]),n}(wde);function zpe(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"datum",a=[];function i(t){var i=pre(t),o=e.getSelectionComponent(i,t),u=One(i+rhe);if(o.project.timeUnit){var s=null!==n&&void 0!==n?n:e.component.data.raw,c=o.project.timeUnit.clone();s.parent?c.insertAsParentOf(s):s.parent=c}return"none"!==o.empty&&a.push(u),"vlSelectionTest(".concat(u,", ").concat(r)+("global"===o.resolve?")":", ".concat(One(o.resolve),")"))}var o=vre(t,i);return(a.length?"!("+a.map((function(e){return"length(data(".concat(e,"))")})).join(" || ")+") || ":"")+"(".concat(o,")")}function Zpe(e,t){var n=t.encoding,r=t.field;if(n||r){if(n&&!r){var a=e.project.items.filter((function(e){return e.channel===n}));!a.length||a.length>1?(r=e.project.items[0].field,woe((a.length?"Multiple ":"No ")+"matching ".concat(One(n)," encoding found for selection ").concat(One(t.selection),". ")+'Using "field": '.concat(One(r),"."))):r=a[0].field}}else r=e.project.items[0].field,e.project.items.length>1&&woe('A "field" or "encoding" must be specified when using a selection as a scale domain. '+'Using "field": '.concat(One(r),"."));return"".concat(e.name,"[").concat(One(r),"]")}function Lpe(e,t,n){return vre(t,(function(t){return Mne(t)?t:function(e){return null===e||void 0===e?void 0:e.selection}(t)?zpe(e,t.selection,n):aue(t)}))}function Ppe(e,t){if(e)return kne(e)&&!pce(e)?e.map((function(e){return ece(e,t)})).join(", "):e}function Upe(e,t,n,r){var a,i,o;e.encode=null!==(a=e.encode)&&void 0!==a?a:{},e.encode[t]=null!==(i=e.encode[t])&&void 0!==i?i:{},e.encode[t].update=null!==(o=e.encode[t].update)&&void 0!==o?o:{},e.encode[t].update[n]=r}function Wpe(e,t,n){var r,a,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{header:!1},o=e.combine(),u=o.disable,s=o.orient,c=o.scale,l=o.labelExpr,f=o.title,d=o.zindex,h=jne(o,["disable","orient","scale","labelExpr","title","zindex"]);if(!u){for(var p in h){var v=Mre[p],m=h[p];if(v&&v!==t&&"both"!==v)delete h[p];else if(Dre(m)){var g=m.condition,y=jne(m,["condition"]),b=Nne(g),x=Ire[p];if(x){var w=x.vgProp,k=x.part,_=[].concat((0,cn.Z)(b.map((function(e){var t=e.test,n=jne(e,["test"]);return Object.assign({test:Lpe(null,t)},n)}))),[y]);Upe(h,k,w,_),delete h[p]}else if(null===x){var S={signal:b.map((function(e){var t=e.test,n=jne(e,["test"]);return"".concat(Lpe(null,t)," ? ").concat(mce(n)," : ")})).join("")+mce(y)};h[p]=S}}else if(Poe(m)){var C=Ire[p];if(C){var A=C.vgProp,E=C.part;Upe(h,E,A,m),delete h[p]}}}if("grid"===t){if(!h.grid)return;if(h.encode){var N=h.encode.grid;h.encode=Object.assign({},N?{grid:N}:{}),cre(h.encode)&&delete h.encode}return Object.assign(Object.assign({scale:c,orient:s},h),{domain:!1,labels:!1,aria:!1,maxExtent:0,minExtent:0,ticks:!1,zindex:Cre(d,0)})}if(i.header||!e.mainExtracted){if(void 0!==l){var T=l;(null===(a=null===(r=h.encode)||void 0===r?void 0:r.labels)||void 0===a?void 0:a.update)&&Poe(h.encode.labels.update.text)&&(T=kre(l,"datum.label",h.encode.labels.update.text.signal)),Upe(h,"labels","text",{signal:T})}if(null===h.labelAlign&&delete h.labelAlign,h.encode){var I,D=(0,Rt.Z)(Fre);try{for(D.s();!(I=D.n()).done;){var F=I.value;e.hasAxisPart(F)||delete h.encode[F]}}catch(O){D.e(O)}finally{D.f()}cre(h.encode)&&delete h.encode}var M=Ppe(f,n);return Object.assign(Object.assign(Object.assign(Object.assign({scale:c,orient:s,grid:!1},M?{title:M}:{}),h),!1===n.aria?{aria:!1}:{}),{zindex:Cre(d,0)})}}}function Vpe(e){var t,n=e.component.axes,r=[],a=(0,Rt.Z)(xie);try{for(a.s();!(t=a.n()).done;){var i=t.value;if(n[i]){var o,u=(0,Rt.Z)(n[i]);try{for(u.s();!(o=u.n()).done;){var s=o.value;if(!s.get("disable")&&!s.get("gridScale")){var c="x"===i?"height":"width",l=e.getSizeSignalRef(c).signal;c!==l&&r.push({name:c,update:l})}}}catch(f){u.e(f)}finally{u.f()}}}}catch(f){a.e(f)}finally{a.f()}return r}var qpe={titleAlign:"align",titleAnchor:"anchor",titleAngle:"angle",titleBaseline:"baseline",titleColor:"color",titleFont:"font",titleFontSize:"fontSize",titleFontStyle:"fontStyle",titleFontWeight:"fontWeight",titleLimit:"limit",titleLineHeight:"lineHeight",titleOrient:"orient",titlePadding:"offset"},Gpe={labelAlign:"align",labelAnchor:"anchor",labelAngle:"angle",labelBaseline:"baseline",labelColor:"color",labelFont:"font",labelFontSize:"fontSize",labelFontStyle:"fontStyle",labelFontWeight:"fontWeight",labelLimit:"limit",labelLineHeight:"lineHeight",labelOrient:"orient",labelPadding:"offset"},Hpe=lre(qpe),Xpe=lre(Gpe);function Kpe(e,t,n,r){return Object.assign.apply(null,[{}].concat((0,cn.Z)(e.map((function(e){if("axisOrient"===e){var a,i="x"===n?"bottom":"left",o=t["x"===n?"axisBottom":"axisLeft"]||{},u=t["x"===n?"axisTop":"axisRight"]||{},s=new Set([].concat((0,cn.Z)(lre(o)),(0,cn.Z)(lre(u)))),c={},l=(0,Rt.Z)(s.values());try{for(l.s();!(a=l.n()).done;){var f=a.value;c[f]={signal:"".concat(r.signal,' === "').concat(i,'" ? ').concat(gce(o[f])," : ").concat(gce(u[f]))}}}catch(d){l.e(d)}finally{l.f()}return c}return t[e]})))))}function Ype(e,t,n,r){var a="band"===t?["axisDiscrete","axisBand"]:"point"===t?["axisDiscrete","axisPoint"]:function(e){return e in Mue}(t)?["axisQuantitative"]:"time"===t||"utc"===t?["axisTemporal"]:[],i="x"===e?"axisX":"axisY",o=Poe(n)?"axisOrient":"axis"+gre(n),u=[].concat(a,(0,cn.Z)(a.map((function(e){return i+e.substr(4)})))),s=["axis",o,i];return{vlOnlyAxisConfig:Kpe(u,r,e,n),vgAxisConfig:Kpe(s,r,e,n),axisConfigStyle:$pe([].concat(s,(0,cn.Z)(u)),r)}}function $pe(e,t){var n,r,a=[{}],i=(0,Rt.Z)(e);try{for(i.s();!(r=i.n()).done;){var o=null===(n=t[r.value])||void 0===n?void 0:n.style;if(o){o=Nne(o);var u,s=(0,Rt.Z)(o);try{for(s.s();!(u=s.n()).done;){var c=u.value;a.push(t.style[c])}}catch(l){s.e(l)}finally{s.f()}}}}catch(l){i.e(l)}finally{i.f()}return Object.assign.apply(null,a)}function Qpe(e,t,n){var r,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=kce(e,n,t.style);if(void 0!==i)return{configFrom:"style",configValue:i};for(var o=0,u=["vlOnlyAxisConfig","vgAxisConfig","axisConfigStyle"];o<u.length;o++){var s=u[o];if(void 0!==(null===(r=a[s])||void 0===r?void 0:r[e]))return{configFrom:s,configValue:a[s][e]}}return{}}var Jpe={scale:function(e){var t=e.model,n=e.channel;return t.scaleName(n)},format:function(e){var t=e.fieldOrDatumDef,n=e.config,r=e.axis,a=r.format,i=r.formatType;return cse(t,t.type,a,i,n,!0)},formatType:function(e){var t=e.axis,n=e.fieldOrDatumDef,r=e.scaleType,a=t.formatType;return lse(a,n,r)},grid:function(e){var t,n=e.fieldOrDatumDef,r=e.axis,a=e.scaleType;return(!Dse(n)||!jie(n.bin))&&(null!==(t=r.grid)&&void 0!==t?t:function(e,t){return!Bue(e)&&Dse(t)&&!Rie(null===t||void 0===t?void 0:t.bin)}(a,n))},gridScale:function(e){return function(e,t){var n="x"===t?"y":"x";if(e.getScaleComponent(n))return e.scaleName(n);return}(e.model,e.channel)},labelAlign:function(e){var t=e.axis,n=e.labelAngle,r=e.orient,a=e.channel;return t.labelAlign||nve(n,r,a)},labelAngle:function(e){return e.labelAngle},labelBaseline:function(e){var t=e.axis,n=e.labelAngle,r=e.orient,a=e.channel;return t.labelBaseline||tve(n,r,a)},labelFlush:function(e){var t,n=e.axis,r=e.fieldOrDatumDef,a=e.channel;return null!==(t=n.labelFlush)&&void 0!==t?t:function(e,t){if("x"===t&&tre(["quantitative","temporal"],e))return!0;return}(r.type,a)},labelOverlap:function(e){var t,n=e.axis,r=e.fieldOrDatumDef,a=e.scaleType;return null!==(t=n.labelOverlap)&&void 0!==t?t:function(e,t){if("nominal"!==e)return"log"!==t||"greedy";return}(r.type,a)},orient:function(e){return e.orient},tickCount:function(e){var t,n=e.channel,r=e.model,a=e.axis,i=e.fieldOrDatumDef,o=e.scaleType,u="x"===n?"width":"y"===n?"height":void 0,s=u?r.getSizeSignalRef(u):void 0;return null!==(t=a.tickCount)&&void 0!==t?t:function(e){var t,n=e.fieldOrDatumDef,r=e.scaleType,a=e.size;if(!e.values&&!Bue(r)&&"log"!==r){if(Dse(n)){if(Rie(n.bin))return{signal:"ceil(".concat(a.signal,"/10)")};if(n.timeUnit&&tre(["month","hours","day","quarter"],null===(t=Zoe(n.timeUnit))||void 0===t?void 0:t.unit))return}return{signal:"ceil(".concat(a.signal,"/40)")}}return}({fieldOrDatumDef:i,scaleType:o,size:s,values:a.values})},title:function(e){var t=e.axis,n=e.model,r=e.channel;if(void 0!==t.title)return t.title;var a=rve(n,r);if(void 0!==a)return a;var i=n.typedFieldDef(r),o="x"===r?"x2":"y2",u=n.fieldDef(o);return Sce(i?[Sse(i)]:[],Dse(u)?[Sse(u)]:[])},values:function(e){return function(e,t){var n=e.values;if(kne(n))return fce(t,n);if(Poe(n))return n;return}(e.axis,e.fieldOrDatumDef)},zindex:function(e){var t,n=e.axis,r=e.fieldOrDatumDef,a=e.mark;return null!==(t=n.zindex)&&void 0!==t?t:function(e,t){if("rect"===e&&qse(t))return 1;return 0}(a,r)}};function eve(e){return"(((".concat(e.signal," % 360) + 360) % 360)")}function tve(e,t,n,r){if(void 0!==e){if("x"===n){if(Poe(e)){var a=eve(e),i=Poe(t)?"(".concat(t.signal,' === "top")'):"top"===t;return{signal:"(45 < ".concat(a," && ").concat(a," < 135) || (225 < ").concat(a," && ").concat(a,' < 315) ? "middle" :')+"(".concat(a," <= 45 || 315 <= ").concat(a,") === ").concat(i,' ? "bottom" : "top"')}}if(45<e&&e<135||225<e&&e<315)return"middle";if(Poe(t)){var o=e<=45||315<=e?"===":"!==";return{signal:"".concat(t.signal," ").concat(o,' "top" ? "bottom" : "top"')}}return(e<=45||315<=e)===("top"===t)?"bottom":"top"}if(Poe(e)){var u=eve(e),s=Poe(t)?"(".concat(t.signal,' === "left")'):"left"===t,c=r?'"middle"':"null";return{signal:"".concat(u," <= 45 || 315 <= ").concat(u," || (135 <= ").concat(u," && ").concat(u," <= 225) ? ").concat(c," : (45 <= ").concat(u," && ").concat(u," <= 135) === ").concat(s,' ? "top" : "bottom"')}}if(e<=45||315<=e||135<=e&&e<=225)return r?"middle":null;if(Poe(t)){var l=45<=e&&e<=135?"===":"!==";return{signal:"".concat(t.signal," ").concat(l,' "left" ? "top" : "bottom"')}}return(45<=e&&e<=135)===("left"===t)?"top":"bottom"}}function nve(e,t,n){if(void 0!==e){var r="x"===n,a=r?0:90,i=r?"bottom":"left";if(Poe(e)){var o=eve(e),u=Poe(t)?"(".concat(t.signal,' === "').concat(i,'")'):t===i;return{signal:"(".concat(a?"("+o+" + 90)":o," % 180 === 0) ? ").concat(r?null:'"center"'," :")+"(".concat(a," < ").concat(o," && ").concat(o," < ").concat(180+a,") === ").concat(u,' ? "left" : "right"')}}if((e+a)%180===0)return r?null:"center";if(Poe(t)){var s=a<e&&e<180+a?"===":"!==",c="".concat(t.signal," ").concat(s,' "').concat(i,'"');return{signal:"".concat(c,' ? "left" : "right"')}}return(a<e&&e<180+a)===(t===i)?"left":"right"}}function rve(e,t){var n="x"===t?"x2":"y2",r=e.fieldDef(t),a=e.fieldDef(n),i=r?r.title:void 0,o=a?a.title:void 0;return i&&o?Cce(i,o):i||(o||(void 0!==i?i:void 0!==o?o:void 0))}var ave=function(e){(0,Ng.Z)(n,e);var t=(0,Tg.Z)(n);function n(e,r){var a;return(0,op.Z)(this,n),(a=t.call(this,e)).transform=r,a._dependentFields=jpe(a.transform.calculate),a}return(0,up.Z)(n,[{key:"clone",value:function(){return new n(null,Kne(this.transform))}},{key:"producedFields",value:function(){return new Set([this.transform.as])}},{key:"dependentFields",value:function(){return this._dependentFields}},{key:"assemble",value:function(){return{type:"formula",expr:this.transform.calculate,as:this.transform.as}}},{key:"hash",value:function(){return"Calculate ".concat(Jne(this.transform))}}],[{key:"parseAllForSortIndex",value:function(e,t){return t.forEachFieldDef((function(t,r){if(Zse(t)&&xse(t.sort)){var a=t.field,i=t.timeUnit,o=t.sort,u=o.map((function(e,t){return"".concat(aue({field:a,timeUnit:i,equal:e})," ? ").concat(t," : ")})).join("")+o.length;e=new n(e,{calculate:u,as:ive(t,r,{forAs:!0})})}})),e}}]),n}(wde);function ive(e,t,n){return Vse(e,Object.assign({prefix:t,suffix:"sort_index"},null!==n&&void 0!==n?n:{}))}function ove(e,t){return tre(["top","bottom"],t)?"column":tre(["left","right"],t)||"row"===e?"row":"column"}function uve(e,t,n,r){var a="row"===r?n.headerRow:"column"===r?n.headerColumn:n.headerFacet;return Cre(((null===t||void 0===t?void 0:t.header)||{})[e],a[e],n.header[e])}function sve(e,t,n,r){var a,i={},o=(0,Rt.Z)(e);try{for(o.s();!(a=o.n()).done;){var u=a.value,s=uve(u,t,n,r);void 0!==s&&(i[u]=s)}}catch(c){o.e(c)}finally{o.f()}return i}var cve=["row","column"],lve=["header","footer"];function fve(e,t){var n=e.component.layoutHeaders[t].title,r=e.config?e.config:void 0,a=e.component.layoutHeaders[t].facetFieldDef?e.component.layoutHeaders[t].facetFieldDef:void 0,i=sve(["titleAnchor","titleAngle","titleOrient"],a,r,t),o=i.titleAnchor,u=i.titleAngle,s=ove(t,i.titleOrient),c=Nre(u);return{name:"".concat(t,"-title"),type:"group",role:"".concat(s,"-title"),title:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({text:n},"row"===t?{orient:"left"}:{}),{style:"guide-title"}),hve(c,s)),dve(s,c,o)),xve(r,a,t,Hpe,qpe))}}function dve(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"middle";switch(n){case"start":return{align:"left"};case"end":return{align:"right"}}var r=nve(t,"row"===e?"left":"top","row"===e?"y":"x");return r?{align:r}:{}}function hve(e,t){var n=tve(e,"row"===t?"left":"top","row"===t?"y":"x",!0);return n?{baseline:n}:{}}function pve(e,t){var n,r=e.component.layoutHeaders[t],a=[],i=(0,Rt.Z)(lve);try{for(i.s();!(n=i.n()).done;){var o=n.value;if(r[o]){var u,s=(0,Rt.Z)(r[o]);try{for(s.s();!(u=s.n()).done;){var c=gve(e,t,o,r,u.value);null!=c&&a.push(c)}}catch(l){s.e(l)}finally{s.f()}}}}catch(l){i.e(l)}finally{i.f()}return a}function vve(e,t){var n,r=e.sort;return bse(r)?{field:Vse(r,{expr:"datum"}),order:null!==(n=r.order)&&void 0!==n?n:"ascending"}:kne(r)?{field:ive(e,t,{expr:"datum"}),order:"ascending"}:{field:Vse(e,{expr:"datum"}),order:null!==r&&void 0!==r?r:"ascending"}}function mve(e,t,n){var r=sve(["format","formatType","labelAngle","labelAnchor","labelOrient","labelExpr"],e,n,t),a=r.format,i=r.formatType,o=r.labelAngle,u=r.labelAnchor,s=r.labelOrient,c=r.labelExpr,l=ose({fieldOrDatumDef:e,format:a,formatType:i,expr:"parent",config:n}).signal,f=ove(t,s);return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({text:{signal:c?kre(kre(c,"datum.label",l),"datum.value",Vse(e,{expr:"parent"})):l}},"row"===t?{orient:"left"}:{}),{style:"guide-label",frame:"group"}),hve(o,f)),dve(f,o,u)),xve(n,e,t,Xpe,Gpe))}function gve(e,t,n,r,a){if(a){var i=null,o=r.facetFieldDef,u=e.config?e.config:void 0;if(o&&a.labels){var s=sve(["labelOrient"],o,u,t).labelOrient;("row"===t&&!tre(["top","bottom"],s)||"column"===t&&!tre(["left","right"],s))&&(i=mve(o,t,u))}var c=xge(e)&&!wse(e.facet),l=a.axes,f=(null===l||void 0===l?void 0:l.length)>0;if(i||f){var d="row"===t?"height":"width";return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:e.getName("".concat(t,"_").concat(n)),type:"group",role:"".concat(t,"-").concat(n)},r.facetFieldDef?{from:{data:e.getName(t+"_domain")},sort:vve(o,t)}:{}),f&&c?{from:{data:e.getName("facet_domain_".concat(t))}}:{}),i?{title:i}:{}),a.sizeSignal?{encode:{update:(0,Xn.Z)({},d,a.sizeSignal)}}:{}),f?{axes:l}:{})}}return null}var yve={column:{start:0,end:1},row:{start:1,end:0}};function bve(e,t){return yve[t][e]}function xve(e,t,n,r,a){var i,o={},u=(0,Rt.Z)(r);try{for(u.s();!(i=u.n()).done;){var s=i.value;if(a[s]){var c=uve(s,t,e,n);void 0!==c&&(o[a[s]]=c)}}}catch(l){u.e(l)}finally{u.f()}return o}function wve(e){return[].concat((0,cn.Z)(kve(e,"width")),(0,cn.Z)(kve(e,"height")),(0,cn.Z)(kve(e,"childWidth")),(0,cn.Z)(kve(e,"childHeight")))}function kve(e,t){var n="width"===t?"x":"y",r=e.component.layoutSize.get(t);if(!r||"merged"===r)return[];var a=e.getSizeSignalRef(t).signal;if("step"===r){var i=e.getScaleComponent(n);if(i){var o=i.get("type"),u=i.get("range");if(Bue(o)&&Uoe(u)){var s=e.scaleName(n);if(xge(e.parent))if("independent"===e.parent.component.resolve.scale[n])return[_ve(s,u)];return[_ve(s,u),{name:a,update:Sve(s,i,"domain('".concat(s,"').length"))}]}}throw new Error("layout size is step although width/height is not step.")}if("container"==r){var c=a.endsWith("width"),l=c?"containerSize()[0]":"containerSize()[1]",f=yle(e.config.view,c?"width":"height"),d="isFinite(".concat(l,") ? ").concat(l," : ").concat(f);return[{name:a,init:d,on:[{update:d,events:"window:resize"}]}]}return[{name:a,value:r}]}function _ve(e,t){return{name:e+"_step",value:t.step}}function Sve(e,t,n){var r=t.get("type"),a=t.get("padding"),i=Cre(t.get("paddingOuter"),a),o=t.get("paddingInner");return o="band"===r?void 0!==o?o:a:1,"bandspace(".concat(n,", ").concat(o,", ").concat(i,") * ").concat(e,"_step")}function Cve(e){return"childWidth"===e?"width":"childHeight"===e?"height":e}function Ave(e,t){return lre(e).reduce((function(n,r){var a=e[r];return Object.assign(Object.assign({},n),Gfe(t,a,r,(function(e){return Poe(e)?e:{value:e.value}})))}),{})}function Eve(e,t){if(kge(t)||xge(t))return"shared";if(wge(t))return wie(e)?"independent":"shared";throw new Error("invalid model type for resolve")}function Nve(e,t){var n=e.scale[t],r=wie(t)?"axis":"legend";return"independent"===n?("shared"===e[r][t]&&woe(function(e){return'Setting the scale to be independent for "'.concat(e,'" means we also have to set the guide (axis or legend) to be independent.')}(t)),"independent"):e[r][t]||"shared"}var Tve=Object.assign(Object.assign({},ule),{disable:1,labelExpr:1,selections:1,opacity:1,shape:1,stroke:1,fill:1,size:1,strokeWidth:1,strokeDash:1,encode:1}),Ive=lre(Tve),Dve=function(e){(0,Ng.Z)(n,e);var t=(0,Tg.Z)(n);function n(){return(0,op.Z)(this,n),t.apply(this,arguments)}return(0,up.Z)(n)}(dfe),Fve={symbols:function(e,t){var n,r,a,i,o,u=t.fieldOrDatumDef,s=t.model,c=t.channel,l=t.legendCmpt;if("symbol"!==t.legendType)return;var f=s.markDef,d=s.encoding,h=s.config,p=s.mark,v=f.filled&&"trail"!==p,m=Object.assign(Object.assign({},function(e,t,n){var r,a=(0,Rt.Z)(n);try{for(a.s();!(r=a.n()).done;){var i=r.value,o=xce(i,t.markDef,t.config);void 0!==o&&(e[i]=vce(o))}}catch(u){a.e(u)}finally{a.f()}return e}({},s,nae)),ede(s,{filled:v})),g=null!==(n=Mve(d.opacity))&&void 0!==n?n:f.opacity;if(m.fill)if("fill"===c||v&&c===Mae)delete m.fill;else if(m.fill.field)l.get("symbolFillColor")?delete m.fill:(m.fill=vce(null!==(r=h.legend.symbolBaseFillColor)&&void 0!==r?r:"black"),m.fillOpacity=vce(null!==g&&void 0!==g?g:1));else if(kne(m.fill)){var y=null!==(o=null!==(i=Ove(null!==(a=d.fill)&&void 0!==a?a:d.color))&&void 0!==i?i:f.fill)&&void 0!==o?o:v&&f.color;y&&(m.fill=vce(y))}if(m.stroke)if("stroke"===c||!v&&c===Mae)delete m.stroke;else if(m.stroke.field)delete m.stroke;else if(kne(m.stroke)){var b=Cre(Ove(d.stroke||d.color),f.stroke,v?f.color:void 0);b&&(m.stroke={value:b})}if(c!==Zae){var x=Dse(u)&&jve(s,l,u);x?m.opacity=[Object.assign({test:x},vce(null!==g&&void 0!==g?g:1)),vce(h.legend.unselectedOpacity)]:g&&(m.opacity=vce(g))}return cre(m=Object.assign(Object.assign({},m),e))?void 0:m},gradient:function(e,t){var n=t.model;if("gradient"!==t.legendType)return;var r={},a=Mve(n.encoding.opacity)||n.markDef.opacity;a&&(r.opacity=vce(a));return cre(r=Object.assign(Object.assign({},r),e))?void 0:r},labels:function(e,t){var n=t.fieldOrDatumDef,r=t.model,a=t.channel,i=t.legendCmpt,o=r.legend(a)||{},u=r.config,s=Dse(n)?jve(r,i,n):void 0,c=s?[{test:s,value:1},{value:u.legend.unselectedOpacity}]:void 0,l=o.format,f=o.formatType,d=ase(f)?sse({fieldOrDatumDef:n,field:"datum.value",format:l,formatType:f,config:u}):void 0,h=Object.assign(Object.assign(Object.assign({},c?{opacity:c}:{}),d?{text:d}:{}),e);return cre(h)?void 0:h},entries:function(e,t){var n=t.legendCmpt.get("selections");return(null===n||void 0===n?void 0:n.length)?Object.assign(Object.assign({},e),{fill:{value:"transparent"}}):e}};function Mve(e){return Rve(e,(function(e,t){return Math.max(e,t.value)}))}function Ove(e){return Rve(e,(function(e,t){return Cre(e,t.value)}))}function Rve(e,t){return function(e){var t=e&&e.condition;return!!t&&(kne(t)||zse(t))}(e)?Nne(e.condition).reduce(t,e.value):zse(e)?e.value:void 0}function jve(e,t,n){var r=t.get("selections");if(null===r||void 0===r?void 0:r.length){var a=One(n.field);return r.map((function(e){var t=One(pre(e)+rhe);return"(!length(data(".concat(t,")) || (").concat(e,"[").concat(a,"] && indexof(").concat(e,"[").concat(a,"], datum.value) >= 0))")})).join(" || ")}}var Bve={direction:function(e){return e.direction},format:function(e){var t=e.fieldOrDatumDef,n=e.legend,r=e.config,a=n.format,i=n.formatType;return cse(t,t.type,a,i,r,!1)},formatType:function(e){var t=e.legend,n=e.fieldOrDatumDef,r=e.scaleType,a=t.formatType;return lse(a,n,r)},gradientLength:function(e){var t,n,r=e.legend,a=e.legendConfig;return null!==(n=null!==(t=r.gradientLength)&&void 0!==t?t:a.gradientLength)&&void 0!==n?n:function(e){var t=e.legendConfig,n=e.model,r=e.direction,a=e.orient,i=e.scaleType,o=t.gradientHorizontalMaxLength,u=t.gradientHorizontalMinLength,s=t.gradientVerticalMaxLength,c=t.gradientVerticalMinLength;if(Zue(i))return"horizontal"===r?"top"===a||"bottom"===a?Lve(n,"width",u,o):u:Lve(n,"height",c,s);return}(e)},labelOverlap:function(e){var t,n,r=e.legend,a=e.legendConfig,i=e.scaleType;return null!==(n=null!==(t=r.labelOverlap)&&void 0!==t?t:a.labelOverlap)&&void 0!==n?n:function(e){if(tre(["quantile","threshold","log"],e))return"greedy";return}(i)},symbolType:function(e){var t,n=e.legend,r=e.markDef,a=e.channel,i=e.encoding;return null!==(t=n.symbolType)&&void 0!==t?t:function(e,t,n,r){var a;if("shape"!==t){var i=null!==(a=Ove(n))&&void 0!==a?a:r;if(i)return i}switch(e){case"bar":case"rect":case"image":case"square":return"square";case"line":case"trail":case"rule":return"stroke";case"arc":case"point":case"circle":case"tick":case"geoshape":case"area":case"text":return"circle"}}(r.type,a,i.shape,r.shape)},title:function(e){return Qse(e.fieldOrDatumDef,e.config,{allowDisabling:!0})},type:function(e){var t=e.legendType,n=e.scaleType;if(rie(e.channel)&&Zue(n)){if("gradient"===t)return}else if("symbol"===t)return;return t},values:function(e){var t=e.fieldOrDatumDef;return function(e,t){var n=e.values;if(kne(n))return fce(t,n);if(Poe(n))return n;return}(e.legend,t)}};function zve(e){return Cre(e.legend.type,function(e){var t=e.channel,n=e.timeUnit,r=e.scaleType;if(rie(t)){if(tre(["quarter","month","day"],n))return"symbol";if(Zue(r))return"gradient"}return"symbol"}(e))}function Zve(e){var t,n,r=e.legendConfig,a=e.legendType,i=e.orient;return null!==(n=null!==(t=e.legend.direction)&&void 0!==t?t:r[a?"gradientDirection":"symbolDirection"])&&void 0!==n?n:function(e,t){switch(e){case"top":case"bottom":return"horizontal";case"left":case"right":case"none":case void 0:return;default:return"gradient"===t?"horizontal":void 0}}(i,a)}function Lve(e,t,n,r){var a=e.getSizeSignalRef(t).signal;return{signal:"clamp(".concat(a,", ").concat(n,", ").concat(r,")")}}function Pve(e){var t=bge(e)?function(e){for(var t=e.encoding,n={},r=0,a=[Mae].concat((0,cn.Z)(ile));r<a.length;r++){var i=a[r],o=rce(t[i]);o&&e.getScaleComponent(i)&&(i===jae&&Dse(o)&&o.type===due||(n[i]=Wve(e,i)))}return n}(e):function(e){var t,n=e.component,r=n.legends,a=n.resolve,i=(0,Rt.Z)(e.children);try{for(i.s();!(t=i.n()).done;){var o=t.value;Pve(o);var u,s=(0,Rt.Z)(lre(o.component.legends));try{for(s.s();!(u=s.n()).done;){var c=u.value;a.legend[c]=Nve(e.component.resolve,c),"shared"===a.legend[c]&&(r[c]=Vve(r[c],o.component.legends[c]),r[c]||(a.legend[c]="independent",delete r[c]))}}catch(m){s.e(m)}finally{s.f()}}}catch(m){i.e(m)}finally{i.f()}var l,f=(0,Rt.Z)(lre(r));try{for(f.s();!(l=f.n()).done;){var d,h=l.value,p=(0,Rt.Z)(e.children);try{for(p.s();!(d=p.n()).done;){var v=d.value;v.component.legends[h]&&("shared"===a.legend[h]&&delete v.component.legends[h])}}catch(m){p.e(m)}finally{p.f()}}}catch(m){f.e(m)}finally{f.f()}return r}(e);return e.component.legends=t,t}function Uve(e,t,n,r){switch(t){case"disable":return void 0!==n;case"values":return!!(null===n||void 0===n?void 0:n.values);case"title":if("title"===t&&e===(null===r||void 0===r?void 0:r.title))return!0}return e===(n||{})[t]}function Wve(e,t){var n,r,a,i=e.legend(t),o=e.markDef,u=e.encoding,s=e.config,c=s.legend,l=new Dve({},function(e,t){var n=e.scaleName(t);if("trail"===e.mark){if("color"===t)return{stroke:n};if("size"===t)return{strokeWidth:n}}return"color"===t?e.markDef.filled?{fill:n}:{stroke:n}:(0,Xn.Z)({},t,n)}(e,t));!function(e,t,n){var r,a=null===(r=e.fieldDef(t))||void 0===r?void 0:r.field;she(e,(function(e){var r,i,o=null!==(r=e.project.hasField[a])&&void 0!==r?r:e.project.hasChannel[t];if(o&&jde.has(e)){var u=null!==(i=n.get("selections"))&&void 0!==i?i:[];u.push(e.name),n.set("selections",u,!1),o.hasLegend=!0}}))}(e,t,l);var f=void 0!==i?!i:c.disable;if(l.set("disable",f,void 0!==i),f)return l;i=i||{};var d,h=e.getScaleComponent(t).get("type"),p=rce(u[t]),v=Dse(p)?null===(n=Zoe(p.timeUnit))||void 0===n?void 0:n.unit:void 0,m=i.orient||s.legend.orient||"right",g=zve({legend:i,channel:t,timeUnit:v,scaleType:h}),y={legend:i,channel:t,model:e,markDef:o,encoding:u,fieldOrDatumDef:p,legendConfig:c,config:s,scaleType:h,orient:m,legendType:g,direction:Zve({legend:i,legendType:g,orient:m,legendConfig:c})},b=(0,Rt.Z)(Ive);try{for(b.s();!(d=b.n()).done;){var x=d.value,w=x in Bve?Bve[x](y):i[x];if(void 0!==w){var k=Uve(w,x,i,e.fieldDef(t));(k||void 0===s.legend[x])&&l.set(x,w,k)}}}catch(F){b.e(F)}finally{b.f()}for(var _=null!==(r=null===i||void 0===i?void 0:i.encoding)&&void 0!==r?r:{},S=l.get("selections"),C={},A={fieldOrDatumDef:p,model:e,channel:t,legendCmpt:l,legendType:g},E=0,N=["labels","legend","title","symbols","gradient","entries"];E<N.length;E++){var T=N[E],I=Ave(null!==(a=_[T])&&void 0!==a?a:{},e),D=T in Fve?Fve[T](I,A):I;void 0===D||cre(D)||(C[T]=Object.assign(Object.assign(Object.assign({},(null===S||void 0===S?void 0:S.length)&&Dse(p)?{name:"".concat(pre(p.field),"_legend_").concat(T)}:{}),(null===S||void 0===S?void 0:S.length)?{interactive:!!S}:{}),{update:D}))}return cre(C)||l.set("encode",C,!!(null===i||void 0===i?void 0:i.encoding)),l}function Vve(e,t){var n,r,a,i;if(!e)return t.clone();var o=e.getWithExplicit("orient"),u=t.getWithExplicit("orient");if(!o.explicit||!u.explicit||o.value===u.value){var s,c=!1,l=(0,Rt.Z)(Ive);try{var f=function(){var n=s.value,r=gfe(e.getWithExplicit(n),t.getWithExplicit(n),n,"legend",(function(e,t){switch(n){case"symbolType":return function(e,t){if("circle"===t.value)return t;return e}(e,t);case"title":return Ace(e,t);case"type":return c=!0,pfe("symbol")}return mfe(e,t,n,"legend")}));e.setWithExplicit(n,r)};for(l.s();!(s=l.n()).done;)f()}catch(d){l.e(d)}finally{l.f()}return c&&((null===(r=null===(n=e.implicit)||void 0===n?void 0:n.encode)||void 0===r?void 0:r.gradient)&&mre(e.implicit,["encode","gradient"]),(null===(i=null===(a=e.explicit)||void 0===a?void 0:a.encode)||void 0===i?void 0:i.gradient)&&mre(e.explicit,["encode","gradient"])),e}}function qve(e,t,n,r){var a,i,o;e.encode=null!==(a=e.encode)&&void 0!==a?a:{},e.encode[t]=null!==(i=e.encode[t])&&void 0!==i?i:{},e.encode[t].update=null!==(o=e.encode[t].update)&&void 0!==o?o:{},e.encode[t].update[n]=r}function Gve(e){var t,n=e.component.legends,r={},a=(0,Rt.Z)(lre(n));try{for(a.s();!(t=a.n()).done;){var i=t.value,o=e.getScaleComponent(i),u=Qne(o.get("domains"));if(r[u]){var s,c=(0,Rt.Z)(r[u]);try{for(c.s();!(s=c.n()).done;){Vve(s.value,n[i])||r[u].push(n[i])}}catch(f){c.e(f)}finally{c.f()}}else r[u]=[n[i].clone()]}}catch(f){a.e(f)}finally{a.f()}var l=fre(r).flat().map((function(t){return function(e,t){var n,r,a,i=e.combine(),o=i.disable,u=i.labelExpr,s=(i.selections,jne(i,["disable","labelExpr","selections"]));if(o)return;!1===t.aria&&void 0==s.aria&&(s.aria=!1);if(null===(n=s.encode)||void 0===n?void 0:n.symbols){var c=s.encode.symbols.update;!c.fill||"transparent"===c.fill.value||c.stroke||s.stroke||(c.stroke={value:"transparent"});var l,d=(0,Rt.Z)(ile);try{for(d.s();!(l=d.n()).done;){var h=l.value;s[h]&&delete c[h]}}catch(f){d.e(f)}finally{d.f()}}s.title||delete s.title;if(void 0!==u){var p=u;(null===(a=null===(r=s.encode)||void 0===r?void 0:r.labels)||void 0===a?void 0:a.update)&&Poe(s.encode.labels.update.text)&&(p=kre(u,"datum.label",s.encode.labels.update.text.signal)),qve(s,"labels","text",{signal:p})}for(var v in s){var m=s[v];if(Poe(m)){var g=ole[v];if(g){var y=g.vgProp;qve(s,g.part,y,m),delete s[v]}}}return s}(t,e.config)})).filter((function(e){return void 0!==e}));return l}function Hve(e){return kge(e)||wge(e)?function(e){return e.children.reduce((function(e,t){return e.concat(t.assembleProjections())}),Xve(e))}(e):Xve(e)}function Xve(e){var t=e.component.projection;if(!t||t.merged)return[];var n=t.combine(),r=n.name;if(t.data){var a={signal:"[".concat(t.size.map((function(e){return e.signal})).join(", "),"]")},i=t.data.reduce((function(t,n){var r=Poe(n)?n.signal:"data('".concat(e.lookupDataSource(n),"')");return tre(t,r)||t.push(r),t}),[]);if(i.length<=0)throw new Error("Projection's fit didn't find any data sources");return[Object.assign({name:r,size:a,fit:{signal:i.length>1?"[".concat(i.join(", "),"]"):i[0]}},n)]}return[Object.assign(Object.assign({name:r},{translate:{signal:"[width / 2, height / 2]"}}),n)]}var Kve=["type","clipAngle","clipExtent","center","rotate","precision","reflectX","reflectY","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"],Yve=function(e){(0,Ng.Z)(n,e);var t=(0,Tg.Z)(n);function n(e,r,a,i){var o;return(0,op.Z)(this,n),(o=t.call(this,Object.assign({},r),{name:e})).specifiedProjection=r,o.size=a,o.data=i,o.merged=!1,o}return(0,up.Z)(n,[{key:"isFit",get:function(){return!!this.data}}]),n}(dfe);function $ve(e){e.component.projection=bge(e)?function(e){var t;if(e.hasProjection){var n=e.specifiedProjection,r=!(n&&(null!=n.scale||null!=n.translate)),a=r?[e.getSizeSignalRef("width"),e.getSizeSignalRef("height")]:void 0,i=r?function(e){for(var t=[],n=e.encoding,r=0,a=[[Iae,Tae],[Fae,Dae]];r<a.length;r++){var i=a[r];(rce(n[i[0]])||rce(n[i[1]]))&&t.push({signal:e.getName("geojson_".concat(t.length))})}e.channelHasField(jae)&&e.typedFieldDef(jae).type===due&&t.push({signal:e.getName("geojson_".concat(t.length))});0===t.length&&t.push(e.requestDataName(Afe));return t}(e):void 0;return new Yve(e.projectionName(!0),Object.assign(Object.assign({},null!==(t=e.config.projection)&&void 0!==t?t:{}),null!==n&&void 0!==n?n:{}),a,i)}return}(e):function(e){if(0===e.children.length)return;var t,n,r=(0,Rt.Z)(e.children);try{for(r.s();!(n=r.n()).done;){$ve(n.value)}}catch(d){r.e(d)}finally{r.f()}var a=rre(e.children,(function(e){var n=e.component.projection;if(n){if(t){var r=function(e,t){var n=rre(Kve,(function(n){return!Ine(e.explicit,n)&&!Ine(t.explicit,n)||!(!Ine(e.explicit,n)||!Ine(t.explicit,n)||Qne(e.get(n))!==Qne(t.get(n)))}));if(Qne(e.size)===Qne(t.size)){if(n)return e;if(Qne(e.explicit)===Qne({}))return t;if(Qne(t.explicit)===Qne({}))return e}return null}(t,n);return r&&(t=r),!!r}return t=n,!0}return!0}));if(t&&a){var i,o=e.projectionName(!0),u=new Yve(o,t.specifiedProjection,t.size,Kne(t.data)),s=(0,Rt.Z)(e.children);try{for(s.s();!(i=s.n()).done;){var c=i.value,l=c.component.projection;if(l){var f;if(l.isFit)(f=u.data).push.apply(f,(0,cn.Z)(c.component.projection.data));c.renameProjection(l.get("name"),o),l.merged=!0}}}catch(d){s.e(d)}finally{s.f()}return u}return}(e)}var Qve=n(4506);function Jve(e,t){return"".concat(Oie(e),"_").concat(t)}function eme(e,t,n){var r,a=Jve(null!==(r=uce(n,void 0))&&void 0!==r?r:{},t);return e.getName("".concat(a,"_bins"))}function tme(e,t,n){var r,a;r=function(e){return"as"in e}(e)?Mne(e.as)?[e.as,"".concat(e.as,"_end")]:[e.as[0],e.as[1]]:[Vse(e,{forAs:!0}),Vse(e,{binSuffix:"end",forAs:!0})];var i=Object.assign({},uce(t,void 0)),o=Jve(i,e.field),u=function(e,t){return{signal:e.getName("".concat(t,"_bins")),extentSignal:e.getName("".concat(t,"_extent"))}}(n,o),s=u.signal,c=u.extentSignal;if(zie(i.extent)){var l=i.extent,f=l.selection;a=Zpe(n.getSelectionComponent(pre(f),f),l),delete i.extent}return{key:o,binComponent:Object.assign(Object.assign(Object.assign({bin:i,field:e.field,as:[r]},s?{signal:s}:{}),c?{extentSignal:c}:{}),a?{span:a}:{})}}var nme=function(e){(0,Ng.Z)(n,e);var t=(0,Tg.Z)(n);function n(e,r){var a;return(0,op.Z)(this,n),(a=t.call(this,e)).bins=r,a}return(0,up.Z)(n,[{key:"clone",value:function(){return new n(null,Kne(this.bins))}},{key:"merge",value:function(e,t){var n,r=(0,Rt.Z)(lre(e.bins));try{for(r.s();!(n=r.n()).done;){var a=n.value;a in this.bins?(t(e.bins[a].signal,this.bins[a].signal),this.bins[a].as=ire([].concat((0,cn.Z)(this.bins[a].as),(0,cn.Z)(e.bins[a].as)),Jne)):this.bins[a]=e.bins[a]}}catch(s){r.e(s)}finally{r.f()}var i,o=(0,Rt.Z)(e.children);try{for(o.s();!(i=o.n()).done;){var u=i.value;e.removeChild(u),u.parent=this}}catch(s){o.e(s)}finally{o.f()}e.remove()}},{key:"producedFields",value:function(){return new Set(fre(this.bins).map((function(e){return e.as})).flat(2))}},{key:"dependentFields",value:function(){return new Set(fre(this.bins).map((function(e){return e.field})))}},{key:"hash",value:function(){return"Bin ".concat(Jne(this.bins))}},{key:"assemble",value:function(){return fre(this.bins).flatMap((function(e){var t=[],n=(0,Qve.Z)(e.as),r=n[0],a=n.slice(1),i=e.bin,o=i.extent,u=jne(i,["extent"]),s=Object.assign(Object.assign(Object.assign({type:"bin",field:wre(e.field),as:r,signal:e.signal},zie(o)?{extent:null}:{extent:o}),e.span?{span:{signal:"span(".concat(e.span,")")}}:{}),u);!o&&e.extentSignal&&(t.push({type:"extent",field:wre(e.field),signal:e.extentSignal}),s.extent={signal:e.extentSignal}),t.push(s);var c,l=(0,Rt.Z)(a);try{for(l.s();!(c=l.n()).done;)for(var f=c.value,d=0;d<2;d++)t.push({type:"formula",expr:Vse({field:r[d]},{expr:"datum"}),as:f[d]})}catch(h){l.e(h)}finally{l.f()}return e.formula&&t.push({type:"formula",expr:e.formula,as:e.formulaAs}),t}))}}],[{key:"makeFromEncoding",value:function(e,t){var r=t.reduceFieldDef((function(e,n,r){if(Bse(n)&&Rie(n.bin)){var a=tme(n,n.bin,t),i=a.key,o=a.binComponent;e[i]=Object.assign(Object.assign(Object.assign({},o),e[i]),function(e,t,n,r){var a,i;if(dce(t,n)){var o=bge(e)&&null!==(i=null!==(a=e.axis(n))&&void 0!==a?a:e.legend(n))&&void 0!==i?i:{},u=Vse(t,{expr:"datum"}),s=Vse(t,{expr:"datum",binSuffix:"end"});return{formulaAs:Vse(t,{binSuffix:"range",forAs:!0}),formula:pse(u,s,o.format,o.formatType,r)}}return{}}(t,n,r,t.config))}return e}),{});return cre(r)?null:new n(e,r)}},{key:"makeFromTransform",value:function(e,t,r){var a=tme(t,t.bin,r),i=a.key,o=a.binComponent;return new n(e,(0,Xn.Z)({},i,o))}}]),n}(wde),rme=function(e){(0,Ng.Z)(n,e);var t=(0,Tg.Z)(n);function n(e){var r,a;if((0,op.Z)(this,n),r=t.call(this,null),kfe(e=null!==e&&void 0!==e?e:{name:"source"})||(a=e.format?Object.assign({},$ne(e.format,["parse"])):{}),xfe(e))r._data={values:e.values};else if(bfe(e)){if(r._data={url:e.url},!a.type){var i=/(?:\.([^.]+))?$/.exec(e.url)[1];tre(["json","csv","tsv","dsv","topojson"],i)||(i="json"),a.type=i}}else Sfe(e)?r._data={values:[{type:"Sphere"}]}:(wfe(e)||kfe(e))&&(r._data={});return r._generator=kfe(e),e.name&&(r._name=e.name),a&&!cre(a)&&(r._data.format=a),r}return(0,up.Z)(n,[{key:"dependentFields",value:function(){return new Set}},{key:"producedFields",value:function(){}},{key:"data",get:function(){return this._data}},{key:"hasName",value:function(){return!!this._name}},{key:"isGenerator",get:function(){return this._generator}},{key:"dataName",get:function(){return this._name},set:function(e){this._name=e}},{key:"parent",set:function(e){throw new Error("Source nodes have to be roots.")}},{key:"remove",value:function(){throw new Error("Source nodes are roots and cannot be removed.")}},{key:"hash",value:function(){throw new Error("Cannot hash sources")}},{key:"assemble",value:function(){return Object.assign(Object.assign({name:this._name},this._data),{transform:[]})}}]),n}(wde);function ame(e){var t,n=(0,Rt.Z)(e);try{for(n.s();!(t=n.n()).done;){var r,a=t.value,i=(0,Rt.Z)(a.children);try{for(i.s();!(r=i.n()).done;){var o=r.value;if(o.parent!==a)return console.error("Dataflow graph is inconsistent.",a,o),!1}}catch(u){i.e(u)}finally{i.f()}if(!ame(a.children))return!1}}catch(u){n.e(u)}finally{n.f()}return!0}var ime=function(e){(0,Ng.Z)(n,e);var t=(0,Tg.Z)(n);function n(e,r){var a;return(0,op.Z)(this,n),(a=t.call(this,e)).params=r,a}return(0,up.Z)(n,[{key:"clone",value:function(){return new n(null,this.params)}},{key:"dependentFields",value:function(){return new Set}},{key:"producedFields",value:function(){}},{key:"hash",value:function(){return"Graticule ".concat(Jne(this.params))}},{key:"assemble",value:function(){return Object.assign({type:"graticule"},!0===this.params?{}:this.params)}}]),n}(wde),ome=function(e){(0,Ng.Z)(n,e);var t=(0,Tg.Z)(n);function n(e,r){var a;return(0,op.Z)(this,n),(a=t.call(this,e)).params=r,a}return(0,up.Z)(n,[{key:"clone",value:function(){return new n(null,this.params)}},{key:"dependentFields",value:function(){return new Set}},{key:"producedFields",value:function(){var e;return new Set([null!==(e=this.params.as)&&void 0!==e?e:"data"])}},{key:"hash",value:function(){return"Hash ".concat(Jne(this.params))}},{key:"assemble",value:function(){return Object.assign({type:"sequence"},this.params)}}]),n}(wde);function ume(e){return e instanceof rme||e instanceof ime||e instanceof ome}var sme=function(){function e(){(0,op.Z)(this,e),this._mutated=!1}return(0,up.Z)(e,[{key:"setMutated",value:function(){this._mutated=!0}},{key:"mutatedFlag",get:function(){return this._mutated}}]),e}(),cme=function(e){(0,Ng.Z)(n,e);var t=(0,Tg.Z)(n);function n(){var e;return(0,op.Z)(this,n),(e=t.call(this))._continue=!1,e}return(0,up.Z)(n,[{key:"setContinue",value:function(){this._continue=!0}},{key:"continueFlag",get:function(){return this._continue}},{key:"flags",get:function(){return{continueFlag:this.continueFlag,mutatedFlag:this.mutatedFlag}},set:function(e){var t=e.continueFlag,n=e.mutatedFlag;t&&this.setContinue(),n&&this.setMutated()}},{key:"reset",value:function(){}},{key:"optimizeNextFromLeaves",value:function(e){if(ume(e))return!1;var t=e.parent;return this.run(e).continueFlag&&this.optimizeNextFromLeaves(t),this.mutatedFlag}}]),n}(sme),lme=function(e){(0,Ng.Z)(n,e);var t=(0,Tg.Z)(n);function n(){return(0,op.Z)(this,n),t.apply(this,arguments)}return(0,up.Z)(n)}(sme);function fme(e,t,n,r){var a=bge(r)?r.encoding[vie(t)]:void 0;if(Bse(n)&&bge(r)&&Ese(t,n,a,r.stack,r.markDef,r.config))e.add(Vse(n,{})),e.add(Vse(n,{suffix:"end"})),n.bin&&dce(n,t)&&e.add(Vse(n,{binSuffix:"range"}));else if(function(e){return e in eie}(t)){var i=function(e){switch(e){case Tae:return"y";case Dae:return"y2";case Iae:return"x";case Fae:return"x2"}}(t);e.add(r.getName(i))}else e.add(Vse(n));return e}var dme=function(e){(0,Ng.Z)(n,e);var t=(0,Tg.Z)(n);function n(e,r,a){var i;return(0,op.Z)(this,n),(i=t.call(this,e)).dimensions=r,i.measures=a,i}return(0,up.Z)(n,[{key:"clone",value:function(){return new n(null,new Set(this.dimensions),Kne(this.measures))}},{key:"groupBy",get:function(){return this.dimensions}},{key:"merge",value:function(e){return function(e,t){if(e.size!==t.size)return!1;var n,r=(0,Rt.Z)(e);try{for(r.s();!(n=r.n()).done;){var a=n.value;if(!t.has(a))return!1}}catch(i){r.e(i)}finally{r.f()}return!0}(this.dimensions,e.dimensions)?(function(e,t){var n,r,a=(0,Rt.Z)(lre(t));try{for(a.s();!(r=a.n()).done;){var i,o=r.value,u=t[o],s=(0,Rt.Z)(lre(u));try{for(s.s();!(i=s.n()).done;){var c=i.value;o in e?e[o][c]=new Set([].concat((0,cn.Z)(null!==(n=e[o][c])&&void 0!==n?n:[]),(0,cn.Z)(u[c]))):e[o]=(0,Xn.Z)({},c,u[c])}}catch(l){s.e(l)}finally{s.f()}}}catch(l){a.e(l)}finally{a.f()}}(this.measures,e.measures),!0):(function(){var e;(e=yoe).debug.apply(e,arguments)}("different dimensions, cannot merge"),!1)}},{key:"addDimensions",value:function(e){e.forEach(this.dimensions.add,this.dimensions)}},{key:"dependentFields",value:function(){return new Set([].concat((0,cn.Z)(this.dimensions),(0,cn.Z)(lre(this.measures))))}},{key:"producedFields",value:function(){var e,t=new Set,n=(0,Rt.Z)(lre(this.measures));try{for(n.s();!(e=n.n()).done;){var r,a=e.value,i=(0,Rt.Z)(lre(this.measures[a]));try{for(i.s();!(r=i.n()).done;){var o=r.value,u=this.measures[a][o];0===u.size?t.add("".concat(o,"_").concat(a)):u.forEach(t.add,t)}}catch(s){i.e(s)}finally{i.f()}}}catch(s){n.e(s)}finally{n.f()}return t}},{key:"hash",value:function(){return"Aggregate ".concat(Jne({dimensions:this.dimensions,measures:this.measures}))}},{key:"assemble",value:function(){var e,t=[],n=[],r=[],a=(0,Rt.Z)(lre(this.measures));try{for(a.s();!(e=a.n()).done;){var i,o=e.value,u=(0,Rt.Z)(lre(this.measures[o]));try{for(u.s();!(i=u.n()).done;){var s,c=i.value,l=(0,Rt.Z)(this.measures[o][c]);try{for(l.s();!(s=l.n()).done;){var f=s.value;r.push(f),t.push(c),n.push("*"===o?null:wre(o))}}catch(d){l.e(d)}finally{l.f()}}}catch(d){u.e(d)}finally{u.f()}}}catch(d){a.e(d)}finally{a.f()}return{type:"aggregate",groupby:(0,cn.Z)(this.dimensions).map(wre),ops:t,fields:n,as:r}}}],[{key:"makeFromEncoding",value:function(e,t){var r=!1;t.forEachFieldDef((function(e){e.aggregate&&(r=!0)}));var a={},i=new Set;return r?(t.forEachFieldDef((function(e,n){var r,o,u,s,c=e.aggregate,l=e.field;if(c)if("count"===c)a["*"]=null!==(r=a["*"])&&void 0!==r?r:{},a["*"].count=new Set([Vse(e,{forAs:!0})]);else{if(fae(c)||dae(c)){var f=fae(c)?"argmin":"argmax",d=c[f];a[d]=null!==(o=a[d])&&void 0!==o?o:{},a[d][f]=new Set([Vse({op:f,field:d},{forAs:!0})])}else a[l]=null!==(u=a[l])&&void 0!==u?u:{},a[l][c]=new Set([Vse(e,{forAs:!0})]);Tie(n)&&"unaggregated"===t.scaleDomain(n)&&(a[l]=null!==(s=a[l])&&void 0!==s?s:{},a[l].min=new Set([Vse({field:l,aggregate:"min"},{forAs:!0})]),a[l].max=new Set([Vse({field:l,aggregate:"max"},{forAs:!0})]))}else fme(i,n,e,t)})),i.size+lre(a).length===0?null:new n(e,i,a)):null}},{key:"makeFromTransform",value:function(e,t){var r,a,i,o,u=new Set,s={},c=(0,Rt.Z)(t.aggregate);try{for(c.s();!(o=c.n()).done;){var l=o.value,f=l.op,d=l.field,h=l.as;f&&("count"===f?(s["*"]=null!==(r=s["*"])&&void 0!==r?r:{},s["*"].count=new Set([h||Vse(l,{forAs:!0})])):(s[d]=null!==(a=s[d])&&void 0!==a?a:{},s[d][f]=new Set([h||Vse(l,{forAs:!0})])))}}catch(g){c.e(g)}finally{c.f()}var p,v=(0,Rt.Z)(null!==(i=t.groupby)&&void 0!==i?i:[]);try{for(v.s();!(p=v.n()).done;){var m=p.value;u.add(m)}}catch(g){v.e(g)}finally{v.f()}return u.size+lre(s).length===0?null:new n(e,u,s)}}]),n}(wde),hme=function(e){(0,Ng.Z)(n,e);var t=(0,Tg.Z)(n);function n(e,r,a,i){var o;(0,op.Z)(this,n),(o=t.call(this,e)).model=r,o.name=a,o.data=i;var u,s=(0,Rt.Z)(iie);try{for(s.s();!(u=s.n()).done;){var c=u.value,l=r.facet[c];if(l){var f=l.bin,d=l.sort;o[c]=Object.assign({name:r.getName("".concat(c,"_domain")),fields:[Vse(l)].concat((0,cn.Z)(Rie(f)?[Vse(l,{binSuffix:"end"})]:[]))},bse(d)?{sortField:d}:kne(d)?{sortIndexField:ive(l,c)}:{})}}}catch(h){s.e(h)}finally{s.f()}return o.childModel=r.child,o}return(0,up.Z)(n,[{key:"hash",value:function(){var e,t="Facet",n=(0,Rt.Z)(iie);try{for(n.s();!(e=n.n()).done;){var r=e.value;this[r]&&(t+=" ".concat(r.charAt(0),":").concat(Jne(this[r])))}}catch(a){n.e(a)}finally{n.f()}return t}},{key:"fields",get:function(){var e,t,n=[],r=(0,Rt.Z)(iie);try{for(r.s();!(t=r.n()).done;){var a=t.value;(null===(e=this[a])||void 0===e?void 0:e.fields)&&n.push.apply(n,(0,cn.Z)(this[a].fields))}}catch(i){r.e(i)}finally{r.f()}return n}},{key:"dependentFields",value:function(){var e,t=new Set(this.fields),n=(0,Rt.Z)(iie);try{for(n.s();!(e=n.n()).done;){var r=e.value;this[r]&&(this[r].sortField&&t.add(this[r].sortField.field),this[r].sortIndexField&&t.add(this[r].sortIndexField))}}catch(a){n.e(a)}finally{n.f()}return t}},{key:"producedFields",value:function(){return new Set}},{key:"getSource",value:function(){return this.name}},{key:"getChildIndependentFieldsWithStep",value:function(){var e,t={},n=(0,Rt.Z)(xie);try{for(n.s();!(e=n.n()).done;){var r=e.value,a=this.childModel.component.scales[r];if(a&&!a.merged){var i=a.get("type"),o=a.get("range");if(Bue(i)&&Uoe(o)){var u=Qme(Jme(this.childModel,r));u?t[r]=u:woe("Unknown field for ".concat(r,". Cannot calculate view size."))}}}}catch(s){n.e(s)}finally{n.f()}return t}},{key:"assembleRowColumnHeaderData",value:function(e,t,n){var r={row:"y",column:"x"}[e],a=[],i=[],o=[];n&&n[r]&&(t?(a.push("distinct_".concat(n[r])),i.push("max")):(a.push(n[r]),i.push("distinct")),o.push("distinct_".concat(n[r])));var u=this[e],s=u.sortField,c=u.sortIndexField;if(s){var l=s.op,f=void 0===l?vse:l,d=s.field;a.push(d),i.push(f),o.push(Vse(s,{forAs:!0}))}else c&&(a.push(c),i.push("max"),o.push(c));return{name:this[e].name,source:null!==t&&void 0!==t?t:this.data,transform:[Object.assign({type:"aggregate",groupby:this[e].fields},a.length?{fields:a,ops:i,as:o}:{})]}}},{key:"assembleFacetHeaderData",value:function(e){var t,n,r,a=this.model.layout.columns,i=this.model.component.layoutHeaders,o=[],u={},s=(0,Rt.Z)(cve);try{for(s.s();!(r=s.n()).done;){var c,l=r.value,f=(0,Rt.Z)(lve);try{for(f.s();!(c=f.n()).done;){var d,h=c.value,p=null!==(t=i[l]&&i[l][h])&&void 0!==t?t:[],v=(0,Rt.Z)(p);try{for(v.s();!(d=v.n()).done;){if((null===(n=d.value.axes)||void 0===n?void 0:n.length)>0){u[l]=!0;break}}}catch(x){v.e(x)}finally{v.f()}}}catch(x){f.e(x)}finally{f.f()}if(u[l]){var m='length(data("'.concat(this.facet.name,'"))'),g="row"===l?a?{signal:"ceil(".concat(m," / ").concat(a,")")}:1:a?{signal:"min(".concat(m,", ").concat(a,")")}:{signal:m};o.push({name:"".concat(this.facet.name,"_").concat(l),transform:[{type:"sequence",start:0,stop:g}]})}}}catch(x){s.e(x)}finally{s.f()}var y=u.row,b=u.column;return(y||b)&&o.unshift(this.assembleRowColumnHeaderData("facet",null,e)),o}},{key:"assemble",value:function(){var e,t,n=[],r=null,a=this.getChildIndependentFieldsWithStep(),i=this.column,o=this.row,u=this.facet;if(i&&o&&(a.x||a.y)){r="cross_".concat(this.column.name,"_").concat(this.row.name);var s=[].concat(null!==(e=a.x)&&void 0!==e?e:[],null!==(t=a.y)&&void 0!==t?t:[]),c=s.map((function(){return"distinct"}));n.push({name:r,source:this.data,transform:[{type:"aggregate",groupby:this.fields,fields:s,ops:c}]})}for(var l=0,f=[bae,yae];l<f.length;l++){var d=f[l];this[d]&&n.push(this.assembleRowColumnHeaderData(d,r,a))}if(u){var h=this.assembleFacetHeaderData(a);h&&n.push.apply(n,(0,cn.Z)(h))}return n}}]),n}(wde);function pme(e){return"'"===e[0]&&"'"===e[e.length-1]||'"'===e[0]&&'"'===e[e.length-1]?e.slice(1,-1):e}function vme(e,t){var n=yre(e);if("number"===t)return"toNumber(".concat(n,")");if("boolean"===t)return"toBoolean(".concat(n,")");if("string"===t)return"toString(".concat(n,")");if("date"===t)return"toDate(".concat(n,")");if("flatten"===t)return n;if(0===t.indexOf("date:")){var r=pme(t.slice(5,t.length));return"timeParse(".concat(n,",'").concat(r,"')")}if(0===t.indexOf("utc:")){var a=pme(t.slice(4,t.length));return"utcParse(".concat(n,",'").concat(a,"')")}return woe('Unrecognized parse "'.concat(t,'".')),null}function mme(e){var t={};return Gne(e.filter,(function(e){var n;if(tue(e)){var r=null;Hoe(e)?r=e.equal:Qoe(e)?r=e.range[0]:Joe(e)&&(r=(null!==(n=e.oneOf)&&void 0!==n?n:e.in)[0]),r&&(koe(r)?t[e.field]="date":Fne(r)?t[e.field]="number":Mne(r)&&(t[e.field]="string")),e.timeUnit&&(t[e.field]="date")}})),t}function gme(e){var t={};function n(e){var n;cce(e)?t[e.field]="date":"quantitative"===e.type&&(Mne(n=e.aggregate)&&tre(["min","max"],n))?t[e.field]="number":Sre(e.field)>1?e.field in t||(t[e.field]="flatten"):Zse(e)&&bse(e.sort)&&Sre(e.sort.field)>1&&(e.sort.field in t||(t[e.sort.field]="flatten"))}if((bge(e)||xge(e))&&e.forEachFieldDef((function(t,r){if(Bse(t))n(t);else{var a=hie(r),i=e.fieldDef(a);n(Object.assign(Object.assign({},t),{type:i.type}))}})),bge(e)){var r=e.mark,a=e.markDef,i=e.encoding;if(Qre(r)&&!e.encoding.order){var o=i["horizontal"===a.orient?"y":"x"];Dse(o)&&"quantitative"===o.type&&!(o.field in t)&&(t[o.field]="number")}}return t}var yme=function(e){(0,Ng.Z)(n,e);var t=(0,Tg.Z)(n);function n(e,r){var a;return(0,op.Z)(this,n),(a=t.call(this,e))._parse=r,a}return(0,up.Z)(n,[{key:"clone",value:function(){return new n(null,Kne(this._parse))}},{key:"hash",value:function(){return"Parse ".concat(Jne(this._parse))}},{key:"parse",get:function(){return this._parse}},{key:"merge",value:function(e){this._parse=Object.assign(Object.assign({},this._parse),e.parse),e.remove()}},{key:"assembleFormatParse",value:function(){var e,t={},n=(0,Rt.Z)(lre(this._parse));try{for(n.s();!(e=n.n()).done;){var r=e.value,a=this._parse[r];1===Sre(r)&&(t[r]=a)}}catch(i){n.e(i)}finally{n.f()}return t}},{key:"producedFields",value:function(){return new Set(lre(this._parse))}},{key:"dependentFields",value:function(){return new Set(lre(this._parse))}},{key:"assembleTransforms",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return lre(this._parse).filter((function(e){return!t||Sre(e)>1})).map((function(t){var n=vme(t,e._parse[t]);return n?{type:"formula",expr:n,as:_re(t)}:null})).filter((function(e){return null!==e}))}}],[{key:"makeExplicit",value:function(e,t,n){var r={},a=t.data;return!kfe(a)&&a&&a.format&&a.format.parse&&(r=a.format.parse),this.makeWithAncestors(e,r,{},n)}},{key:"makeWithAncestors",value:function(e,t,r,a){var i,o=(0,Rt.Z)(lre(r));try{for(o.s();!(i=o.n()).done;){var u=i.value,s=a.getWithExplicit(u);void 0!==s.value&&(s.explicit||s.value===r[u]||"derived"===s.value||"flatten"===r[u]?delete r[u]:woe(Yie(u,r[u],s.value)))}}catch(b){o.e(b)}finally{o.f()}var c,l=(0,Rt.Z)(lre(t));try{for(l.s();!(c=l.n()).done;){var f=c.value,d=a.get(f);void 0!==d&&(d===t[f]?delete t[f]:woe(Yie(f,t[f],d)))}}catch(b){l.e(b)}finally{l.f()}var h=new dfe(t,r);a.copyAll(h);var p,v={},m=(0,Rt.Z)(lre(h.combine()));try{for(m.s();!(p=m.n()).done;){var g=p.value,y=h.get(g);null!==y&&(v[g]=y)}}catch(b){m.e(b)}finally{m.f()}return 0===lre(v).length||a.parseNothing?null:new n(e,v)}}]),n}(wde),bme=function(e){(0,Ng.Z)(n,e);var t=(0,Tg.Z)(n);function n(e){return(0,op.Z)(this,n),t.call(this,e)}return(0,up.Z)(n,[{key:"clone",value:function(){return new n(null)}},{key:"dependentFields",value:function(){return new Set}},{key:"producedFields",value:function(){return new Set([sle])}},{key:"hash",value:function(){return"Identifier"}},{key:"assemble",value:function(){return{type:"identifier",as:sle}}}]),n}(wde),xme=function(e){(0,Ng.Z)(n,e);var t=(0,Tg.Z)(n);function n(e,r){var a;return(0,op.Z)(this,n),(a=t.call(this,e)).transform=r,a}return(0,up.Z)(n,[{key:"clone",value:function(){return new n(null,Kne(this.transform))}},{key:"addDimensions",value:function(e){this.transform.groupby=ire(this.transform.groupby.concat(e),(function(e){return e}))}},{key:"dependentFields",value:function(){var e=new Set;return this.transform.groupby&&this.transform.groupby.forEach(e.add,e),this.transform.joinaggregate.map((function(e){return e.field})).filter((function(e){return void 0!==e})).forEach(e.add,e),e}},{key:"producedFields",value:function(){return new Set(this.transform.joinaggregate.map(this.getDefaultName))}},{key:"getDefaultName",value:function(e){var t;return null!==(t=e.as)&&void 0!==t?t:Vse(e)}},{key:"hash",value:function(){return"JoinAggregateTransform ".concat(Jne(this.transform))}},{key:"assemble",value:function(){var e,t=[],n=[],r=[],a=(0,Rt.Z)(this.transform.joinaggregate);try{for(a.s();!(e=a.n()).done;){var i=e.value;n.push(i.op),r.push(this.getDefaultName(i)),t.push(void 0===i.field?null:i.field)}}catch(u){a.e(u)}finally{a.f()}var o=this.transform.groupby;return Object.assign({type:"joinaggregate",as:r,ops:n,fields:t},void 0!==o?{groupby:o}:{})}}]),n}(wde);var wme=function(e){(0,Ng.Z)(n,e);var t=(0,Tg.Z)(n);function n(e,r){var a;return(0,op.Z)(this,n),(a=t.call(this,e))._stack=r,a}return(0,up.Z)(n,[{key:"clone",value:function(){return new n(null,Kne(this._stack))}},{key:"stack",get:function(){return this._stack}},{key:"addDimensions",value:function(e){var t;(t=this._stack.facetby).push.apply(t,(0,cn.Z)(e))}},{key:"dependentFields",value:function(){var e=new Set;return e.add(this._stack.stackField),this.getGroupbyFields().forEach(e.add,e),this._stack.facetby.forEach(e.add,e),this._stack.sort.field.forEach(e.add,e),e}},{key:"producedFields",value:function(){return new Set(this._stack.as)}},{key:"hash",value:function(){return"Stack ".concat(Jne(this._stack))}},{key:"getGroupbyFields",value:function(){var e=this._stack,t=e.dimensionFieldDef,n=e.impute,r=e.groupby;return t?t.bin?n?[Vse(t,{binSuffix:"mid"})]:[Vse(t,{}),Vse(t,{binSuffix:"end"})]:[Vse(t)]:null!==r&&void 0!==r?r:[]}},{key:"assemble",value:function(){var e=[],t=this._stack,n=t.facetby,r=t.dimensionFieldDef,a=t.stackField,i=t.stackby,o=t.sort,u=t.offset,s=t.impute,c=t.as;if(s&&r){var l=r.band,f=void 0===l?.5:l;r.bin&&e.push({type:"formula",expr:"".concat(f,"*")+Vse(r,{expr:"datum"})+"+".concat(1-f,"*")+Vse(r,{expr:"datum",binSuffix:"end"}),as:Vse(r,{binSuffix:"mid",forAs:!0})}),e.push({type:"impute",field:a,groupby:[].concat((0,cn.Z)(i),(0,cn.Z)(n)),key:Vse(r,{binSuffix:"mid"}),method:"value",value:0})}return e.push({type:"stack",groupby:[].concat((0,cn.Z)(this.getGroupbyFields()),(0,cn.Z)(n)),field:a,sort:o,as:c,offset:u}),e}}],[{key:"makeFromTransform",value:function(e,t){var r=t.stack,a=t.groupby,i=t.as,o=t.offset,u=void 0===o?"zero":o,s=[],c=[];if(void 0!==t.sort){var l,f=(0,Rt.Z)(t.sort);try{for(f.s();!(l=f.n()).done;){var d=l.value;s.push(d.field),c.push(Cre(d.order,"ascending"))}}catch(v){f.e(v)}finally{f.f()}}var h,p={field:s,order:c};return h=function(e){return kne(e)&&e.every((function(e){return Mne(e)}))&&e.length>1}(i)?i:Mne(i)?[i,i+"_end"]:[t.stack+"_start",t.stack+"_end"],new n(e,{stackField:r,groupby:a,offset:u,sort:p,facetby:[],as:h})}},{key:"makeFromEncoding",value:function(e,t){var r=t.stack,a=t.encoding;if(!r)return null;var i,o=r.groupbyChannel,u=r.fieldChannel,s=r.offset,c=r.impute;o&&(i=nce(a[o]));var l,f=function(e){return e.stack.stackBy.reduce((function(e,t){var n=Vse(t.fieldDef);return n&&e.push(n),e}),[])}(t),d=t.encoding.order;return l=kne(d)||Dse(d)?_ce(d):f.reduce((function(e,t){return e.field.push(t),e.order.push("y"===u?"descending":"ascending"),e}),{field:[],order:[]}),new n(e,{dimensionFieldDef:i,stackField:t.vgField(u),facetby:[],stackby:f,sort:l,offset:s,impute:c,as:[t.vgField(u,{suffix:"start",forAs:!0}),t.vgField(u,{suffix:"end",forAs:!0})]})}}]),n}(wde),kme=function(e){(0,Ng.Z)(n,e);var t=(0,Tg.Z)(n);function n(e,r){var a;return(0,op.Z)(this,n),(a=t.call(this,e)).transform=r,a}return(0,up.Z)(n,[{key:"clone",value:function(){return new n(null,Kne(this.transform))}},{key:"addDimensions",value:function(e){this.transform.groupby=ire(this.transform.groupby.concat(e),(function(e){return e}))}},{key:"dependentFields",value:function(){var e,t,n=new Set;return(null!==(e=this.transform.groupby)&&void 0!==e?e:[]).forEach(n.add,n),(null!==(t=this.transform.sort)&&void 0!==t?t:[]).forEach((function(e){return n.add(e.field)})),this.transform.window.map((function(e){return e.field})).filter((function(e){return void 0!==e})).forEach(n.add,n),n}},{key:"producedFields",value:function(){return new Set(this.transform.window.map(this.getDefaultName))}},{key:"getDefaultName",value:function(e){var t;return null!==(t=e.as)&&void 0!==t?t:Vse(e)}},{key:"hash",value:function(){return"WindowTransform ".concat(Jne(this.transform))}},{key:"assemble",value:function(){var e,t,n=[],r=[],a=[],i=[],o=(0,Rt.Z)(this.transform.window);try{for(o.s();!(t=o.n()).done;){var u=t.value;r.push(u.op),a.push(this.getDefaultName(u)),i.push(void 0===u.param?null:u.param),n.push(void 0===u.field?null:u.field)}}catch(g){o.e(g)}finally{o.f()}var s=this.transform.frame,c=this.transform.groupby;if(s&&null===s[0]&&null===s[1]&&r.every((function(e){return hae(e)})))return Object.assign({type:"joinaggregate",as:a,ops:r,fields:n},void 0!==c?{groupby:c}:{});var l=[],f=[];if(void 0!==this.transform.sort){var d,h=(0,Rt.Z)(this.transform.sort);try{for(h.s();!(d=h.n()).done;){var p=d.value;l.push(p.field),f.push(null!==(e=p.order)&&void 0!==e?e:"ascending")}}catch(g){h.e(g)}finally{h.f()}}var v={field:l,order:f},m=this.transform.ignorePeers;return Object.assign(Object.assign(Object.assign({type:"window",params:i,as:a,ops:r,fields:n,sort:v},void 0!==m?{ignorePeers:m}:{}),void 0!==c?{groupby:c}:{}),void 0!==s?{frame:s}:{})}}]),n}(wde),_me=function(e){(0,Ng.Z)(n,e);var t=(0,Tg.Z)(n);function n(){return(0,op.Z)(this,n),t.apply(this,arguments)}return(0,up.Z)(n,[{key:"run",value:function(e){var t=e.parent;if(e instanceof yme){if(ume(t))return this.flags;if(t.numChildren()>1)return this.setContinue(),this.flags;if(t instanceof yme)this.setMutated(),t.merge(e);else{if(sre(t.producedFields(),e.dependentFields()))return this.setContinue(),this.flags;this.setMutated(),e.swapWithParent()}}return this.setContinue(),this.flags}}]),n}(cme),Sme=function(e){(0,Ng.Z)(n,e);var t=(0,Tg.Z)(n);function n(){return(0,op.Z)(this,n),t.apply(this,arguments)}return(0,up.Z)(n,[{key:"mergeNodes",value:function(e,t){var n,r=t.shift(),a=(0,Rt.Z)(t);try{for(a.s();!(n=a.n()).done;){var i=n.value;e.removeChild(i),i.parent=r,i.remove()}}catch(o){a.e(o)}finally{a.f()}}},{key:"run",value:function(e){for(var t=e.children.map((function(e){return e.hash()})),n={},r=0;r<t.length;r++)void 0===n[t[r]]?n[t[r]]=[e.children[r]]:n[t[r]].push(e.children[r]);var a,i=(0,Rt.Z)(lre(n));try{for(i.s();!(a=i.n()).done;){var o=a.value;n[o].length>1&&(this.setMutated(),this.mergeNodes(e,n[o]))}}catch(l){i.e(l)}finally{i.f()}var u,s=(0,Rt.Z)(e.children);try{for(s.s();!(u=s.n()).done;){var c=u.value;this.run(c)}}catch(l){s.e(l)}finally{s.f()}return this.mutatedFlag}}]),n}(lme),Cme=function(e){(0,Ng.Z)(n,e);var t=(0,Tg.Z)(n);function n(){return(0,op.Z)(this,n),t.apply(this,arguments)}return(0,up.Z)(n,[{key:"run",value:function(e){return e instanceof kde||e.numChildren()>0||e instanceof hme||(this.setMutated(),e.remove()),this.flags}}]),n}(cme),Ame=function(e){(0,Ng.Z)(n,e);var t=(0,Tg.Z)(n);function n(){var e;return(0,op.Z)(this,n),(e=t.apply(this,arguments)).fields=new Set,e.prev=null,e}return(0,up.Z)(n,[{key:"run",value:function(e){if(this.setContinue(),e instanceof _de){var t=e.producedFields();ore(t,this.fields)?(this.setMutated(),this.prev.remove()):this.fields=new Set([].concat((0,cn.Z)(this.fields),(0,cn.Z)(t))),this.prev=e}return this.flags}},{key:"reset",value:function(){this.fields.clear()}}]),n}(cme),Eme=function(e){(0,Ng.Z)(n,e);var t=(0,Tg.Z)(n);function n(){return(0,op.Z)(this,n),t.apply(this,arguments)}return(0,up.Z)(n,[{key:"run",value:function(e){this.setContinue();var t,n=e.parent.children.filter((function(e){return e instanceof _de})),r=n.pop(),a=(0,Rt.Z)(n);try{for(a.s();!(t=a.n()).done;){var i=t.value;this.setMutated(),r.merge(i)}}catch(o){a.e(o)}finally{a.f()}return this.flags}}]),n}(cme);function Nme(e){if(e instanceof hme)if(1!==e.numChildren()||e.children[0]instanceof kde){var t=e.model.component.data.main;Tme(t);var n,r=(u=e,function e(t){if(!(t instanceof hme)){var n=t.clone();if(n instanceof kde){var r=jme+n.getSource();n.setSource(r),u.model.component.data.outputNodes[r]=n}else(n instanceof dme||n instanceof wme||n instanceof kme||n instanceof xme)&&n.addDimensions(u.fields);var a,i=(0,Rt.Z)(t.children.flatMap(e));try{for(i.s();!(a=i.n()).done;)a.value.parent=n}catch(o){i.e(o)}finally{i.f()}return[n]}return t.children.flatMap(e)}),a=e.children.map(r).flat(),i=(0,Rt.Z)(a);try{for(i.s();!(n=i.n()).done;){n.value.parent=t}}catch(s){i.e(s)}finally{i.f()}}else{var o=e.children[0];(o instanceof dme||o instanceof wme||o instanceof kme||o instanceof xme)&&o.addDimensions(e.fields),o.swapWithParent(),Nme(e)}else e.children.map(Nme);var u}function Tme(e){if(e instanceof kde&&e.type===Afe&&1===e.numChildren()){var t=e.children[0];t instanceof hme||(t.swapWithParent(),Tme(e))}}var Ime=function(e){(0,Ng.Z)(n,e);var t=(0,Tg.Z)(n);function n(){return(0,op.Z)(this,n),t.call(this)}return(0,up.Z)(n,[{key:"run",value:function(e){e instanceof kde&&!e.isRequired()&&(this.setMutated(),e.remove());var t,n=(0,Rt.Z)(e.children);try{for(n.s();!(t=n.n()).done;){var r=t.value;this.run(r)}}catch(a){n.e(a)}finally{n.f()}return this.mutatedFlag}}]),n}(lme),Dme=function(e){(0,Ng.Z)(n,e);var t=(0,Tg.Z)(n);function n(e){var r;return(0,op.Z)(this,n),(r=t.call(this)).requiresSelectionId=e&&fhe(e),r}return(0,up.Z)(n,[{key:"run",value:function(e){e instanceof bme&&(this.requiresSelectionId&&(ume(e.parent)||e.parent instanceof dme||e.parent instanceof yme)||(this.setMutated(),e.remove()));var t,n=(0,Rt.Z)(e.children);try{for(n.s();!(t=n.n()).done;){var r=t.value;this.run(r)}}catch(a){n.e(a)}finally{n.f()}return this.mutatedFlag}}]),n}(lme),Fme=function(e){(0,Ng.Z)(n,e);var t=(0,Tg.Z)(n);function n(){return(0,op.Z)(this,n),t.apply(this,arguments)}return(0,up.Z)(n,[{key:"run",value:function(e){var t=e.parent,n=(0,cn.Z)(t.children),r=t.children.filter((function(e){return e instanceof yme}));if(t.numChildren()>1&&r.length>=1){var a,i={},o=new Set,u=(0,Rt.Z)(r);try{for(u.s();!(a=u.n()).done;){var s,c=a.value.parse,l=(0,Rt.Z)(lre(c));try{for(l.s();!(s=l.n()).done;){var f=s.value;f in i?i[f]!==c[f]&&o.add(f):i[f]=c[f]}}catch(w){l.e(w)}finally{l.f()}}}catch(w){u.e(w)}finally{u.f()}var d,h=(0,Rt.Z)(o);try{for(h.s();!(d=h.n()).done;){delete i[d.value]}}catch(w){h.e(w)}finally{h.f()}if(!cre(i)){this.setMutated();var p,v=new yme(t,i),m=(0,Rt.Z)(n);try{for(m.s();!(p=m.n()).done;){var g=p.value;if(g instanceof yme){var y,b=(0,Rt.Z)(lre(i));try{for(b.s();!(y=b.n()).done;){var x=y.value;delete g.parse[x]}}catch(w){b.e(w)}finally{b.f()}}t.removeChild(g),g.parent=v,g instanceof yme&&0===lre(g.parse).length&&g.remove()}}catch(w){m.e(w)}finally{m.f()}}}return this.setContinue(),this.flags}}]),n}(cme),Mme=function(e){(0,Ng.Z)(n,e);var t=(0,Tg.Z)(n);function n(){return(0,op.Z)(this,n),t.apply(this,arguments)}return(0,up.Z)(n,[{key:"run",value:function(e){var t,n=e.parent,r=n.children.filter((function(e){return e instanceof dme})),a={},i=(0,Rt.Z)(r);try{for(i.s();!(t=i.n()).done;){var o=t.value,u=Jne(o.groupBy);u in a||(a[u]=[]),a[u].push(o)}}catch(v){i.e(v)}finally{i.f()}var s,c=(0,Rt.Z)(lre(a));try{for(c.s();!(s=c.n()).done;){var l=a[s.value];if(l.length>1){var f,d=l.pop(),h=(0,Rt.Z)(l);try{for(h.s();!(f=h.n()).done;){var p=f.value;d.merge(p)&&(n.removeChild(p),p.parent=d,p.remove(),this.setMutated())}}catch(v){h.e(v)}finally{h.f()}}}}catch(v){c.e(v)}finally{c.f()}return this.setContinue(),this.flags}}]),n}(cme),Ome=function(e){(0,Ng.Z)(n,e);var t=(0,Tg.Z)(n);function n(e){var r;return(0,op.Z)(this,n),(r=t.call(this)).model=e,r}return(0,up.Z)(n,[{key:"run",value:function(e){var t,n=e.parent,r=!(ume(n)||n instanceof Bpe||n instanceof yme||n instanceof bme),a=[],i=[],o=(0,Rt.Z)(n.children);try{for(o.s();!(t=o.n()).done;){var u=t.value;u instanceof nme&&(r&&!sre(n.producedFields(),u.dependentFields())?a.push(u):i.push(u))}}catch(m){o.e(m)}finally{o.f()}if(a.length>0){var s,c=a.pop(),l=(0,Rt.Z)(a);try{for(l.s();!(s=l.n()).done;){var f=s.value;c.merge(f,this.model.renameSignal.bind(this.model))}}catch(m){l.e(m)}finally{l.f()}this.setMutated(),n instanceof nme?n.merge(c,this.model.renameSignal.bind(this.model)):c.swapWithParent()}if(i.length>1){var d,h=i.pop(),p=(0,Rt.Z)(i);try{for(p.s();!(d=p.n()).done;){var v=d.value;h.merge(v,this.model.renameSignal.bind(this.model))}}catch(m){p.e(m)}finally{p.f()}this.setMutated()}return this.setContinue(),this.flags}}]),n}(cme),Rme=function(e){(0,Ng.Z)(n,e);var t=(0,Tg.Z)(n);function n(){return(0,op.Z)(this,n),t.apply(this,arguments)}return(0,up.Z)(n,[{key:"run",value:function(e){var t=e.parent,n=(0,cn.Z)(t.children),r=nre(n,(function(e){return e instanceof kde}));if(!r||t.numChildren()<=1)return this.setContinue(),this.flags;var a,i,o=[],u=(0,Rt.Z)(n);try{for(u.s();!(i=u.n()).done;){var s=i.value;if(s instanceof kde){for(var c=s;1===c.numChildren();){var l=c.children[0];if(!(l instanceof kde))break;c=l}o.push.apply(o,(0,cn.Z)(c.children)),a?(t.removeChild(s),s.parent=a.parent,a.parent.removeChild(a),a.parent=c,this.setMutated()):a=c}else o.push(s)}}catch(p){u.e(p)}finally{u.f()}if(o.length){this.setMutated();var f,d=(0,Rt.Z)(o);try{for(d.s();!(f=d.n()).done;){var h=f.value;h.parent.removeChild(h),h.parent=a}}catch(p){d.e(p)}finally{d.f()}}return this.setContinue(),this.flags}}]),n}(cme),jme="scale_";function Bme(e){var t=[];function n(e){if(0===e.numChildren())t.push(e);else{var r,a=(0,Rt.Z)(e.children);try{for(a.s();!(r=a.n()).done;){n(r.value)}}catch(i){a.e(i)}finally{a.f()}}}var r,a=(0,Rt.Z)(e);try{for(a.s();!(r=a.n()).done;){n(r.value)}}catch(i){a.e(i)}finally{a.f()}return t}function zme(e){return e}function Zme(e,t){return t.map((function(t){if(e instanceof cme){var n=e.optimizeNextFromLeaves(t);return e.reset(),n}return e.run(t)})).some(zme)}function Lme(e,t){var n=e.sources,r=new Set;return r.add(Zme(new Ime,n)),r.add(Zme(new Dme(t),n)),n=n.filter((function(e){return e.numChildren()>0})),r.add(Zme(new Cme,Bme(n))),n=n.filter((function(e){return e.numChildren()>0})),r.add(Zme(new _me,Bme(n))),r.add(Zme(new Ome(t),Bme(n))),r.add(Zme(new Ame,Bme(n))),r.add(Zme(new Fme,Bme(n))),r.add(Zme(new Mme,Bme(n))),r.add(Zme(new Eme,Bme(n))),r.add(Zme(new Sme,n)),r.add(Zme(new Rme,Bme(n))),e.sources=n,r.has(!0)}function Pme(e,t){ame(e.sources);for(var n=0,r=0,a=0;a<5&&Lme(e,t);a++)n++;e.sources.map(Nme);for(var i=0;i<5&&Lme(e,t);i++)r++;ame(e.sources),5===Math.max(n,r)&&woe("Maximum optimization runs(".concat(5,") reached."))}var Ume=function(){function e(t){(0,op.Z)(this,e),Object.defineProperty(this,"signal",{enumerable:!0,get:t})}return(0,up.Z)(e,null,[{key:"fromName",value:function(t,n){return new e((function(){return t(n)}))}}]),e}();function Wme(e){bge(e)?function(e){var t,n=e.component.scales,r=(0,Rt.Z)(lre(n));try{for(r.s();!(t=r.n()).done;){var a=t.value,i=Vme(e,a);if(n[a].setWithExplicit("domains",i),Xme(e,a),e.component.data.isFaceted){for(var o=e;!xge(o)&&o.parent;)o=o.parent;if("shared"===o.component.resolve.scale[a]){var u,s=(0,Rt.Z)(i.value);try{for(s.s();!(u=s.n()).done;){var c=u.value;Woe(c)&&(c.data=jme+c.data.replace(jme,""))}}catch(l){s.e(l)}finally{s.f()}}}}}catch(l){r.e(l)}finally{r.f()}}(e):function(e){var t,n=(0,Rt.Z)(e.children);try{for(n.s();!(t=n.n()).done;){Wme(t.value)}}catch(h){n.e(h)}finally{n.f()}var r,a=e.component.scales,i=(0,Rt.Z)(lre(a));try{for(i.s();!(r=i.n()).done;){var o,u=r.value,s=void 0,c=null,l=(0,Rt.Z)(e.children);try{for(l.s();!(o=l.n()).done;){var f=o.value.component.scales[u];if(f){s=void 0===s?f.getWithExplicit("domains"):gfe(s,f.getWithExplicit("domains"),"domains","scale",Yme);var d=f.get("selectionExtent");c&&d&&c.selection!==d.selection&&woe("The same selection must be used to override scale domains in a layered view."),c=d}}}catch(h){l.e(h)}finally{l.f()}a[u].setWithExplicit("domains",s),c&&a[u].set("selectionExtent",c,!0)}}catch(h){i.e(h)}finally{i.f()}}(e)}function Vme(e,t){var n=e.getScaleComponent(t).get("type"),r=e.encoding,a=function(e,t,n,r){if("unaggregated"===e){var a=Kme(t,n),i=a.valid,o=a.reason;if(!i)return void woe(o)}else if(void 0===e&&r.useUnaggregatedDomain&&Kme(t,n).valid)return"unaggregated";return e}(e.scaleDomain(t),e.typedFieldDef(t),n,e.config.scale);return a!==e.scaleDomain(t)&&(e.specifiedScales[t]=Object.assign(Object.assign({},e.specifiedScales[t]),{domain:a})),"x"===t&&rce(r.x2)?rce(r.x)?gfe(Gme(n,a,e,"x"),Gme(n,a,e,"x2"),"domain","scale",Yme):Gme(n,a,e,"x2"):"y"===t&&rce(r.y2)?rce(r.y)?gfe(Gme(n,a,e,"y"),Gme(n,a,e,"y2"),"domain","scale",Yme):Gme(n,a,e,"y2"):Gme(n,a,e,t)}function qme(e,t,n){var r,a=null===(r=Zoe(n))||void 0===r?void 0:r.unit;return"temporal"===t||a?function(e,t,n){return e.map((function(e){var r=lce(e,{timeUnit:n,type:t});return{signal:"{data: ".concat(r,"}")}}))}(e,t,a):[e]}function Gme(e,t,n,r){var a=rce(n.encoding[r]),i=a.type,o=a.timeUnit;if(function(e){return e&&e.unionWith}(t)){var u=Gme(e,void 0,n,r),s=qme(t.unionWith,i,o);return hfe([].concat((0,cn.Z)(u.value),(0,cn.Z)(s)))}if(Poe(t))return hfe([t]);if(t&&"unaggregated"!==t&&!Pue(t))return hfe(qme(t,i,o));var c=n.stack;if(c&&r===c.fieldChannel){if("normalize"===c.offset)return pfe([[0,1]]);var l=n.requestDataName(Afe);return pfe([{data:l,field:n.vgField(r,{suffix:"start"})},{data:l,field:n.vgField(r,{suffix:"end"})}])}var f=Tie(r)&&Dse(a)?function(e,t,n){if(!Bue(n))return;var r=e.fieldDef(t),a=r.sort;if(xse(a))return{op:"min",field:ive(r,t),order:"ascending"};var i=e.stack,o=i?[].concat((0,cn.Z)(i.groupbyField?[i.groupbyField]:[]),(0,cn.Z)(i.stackBy.map((function(e){return e.fieldDef.field})))):void 0;if(bse(a))return Hme(a,i&&!tre(o,a.field));if(yse(a)){var u=a.encoding,s=a.order,c=e.fieldDef(u),l=c.aggregate,f=c.field,d=i&&!tre(o,f);if(fae(l)||dae(l))return Hme({field:Vse(c),order:s},d);if(hae(l)||!l)return Hme({op:l,field:f,order:s},d)}else{if("descending"===a)return{op:"min",field:e.vgField(t),order:"descending"};if(tre(["ascending",void 0],a))return!0}return}(n,r,e):void 0;if(Mse(a))return pfe(qme([a.datum],i,o));var d=a;if("unaggregated"===t){var h=n.requestDataName(Afe),p=a.field;return pfe([{data:h,field:Vse({field:p,aggregate:"min"})},{data:h,field:Vse({field:p,aggregate:"max"})}])}if(Rie(d.bin)){if(Bue(e))return pfe("bin-ordinal"===e?[]:[{data:hre(f)?n.requestDataName(Afe):n.requestDataName(Efe),field:n.vgField(r,dce(d,r)?{binSuffix:"range"}:{}),sort:!0!==f&&_ne(f)?f:{field:n.vgField(r,{}),op:"min"}}]);var v=d.bin;if(Rie(v)){var m=eme(n,d.field,v);return pfe([new Ume((function(){var e=n.getSignalName(m);return"[".concat(e,".start, ").concat(e,".stop]")}))])}return pfe([{data:n.requestDataName(Afe),field:n.vgField(r,{})}])}if(d.timeUnit&&tre(["time","utc"],e)&&Ese(r,d,bge(n)?n.encoding[vie(r)]:void 0,n.stack,n.markDef,n.config)){var g=n.requestDataName(Afe);return pfe([{data:g,field:n.vgField(r)},{data:g,field:n.vgField(r,{suffix:"end"})}])}return pfe(f?[{data:hre(f)?n.requestDataName(Afe):n.requestDataName(Efe),field:n.vgField(r),sort:f}]:[{data:n.requestDataName(Afe),field:n.vgField(r)}])}function Hme(e,t){var n=e.op,r=e.field,a=e.order;return Object.assign(Object.assign({op:null!==n&&void 0!==n?n:t?"sum":vse},r?{field:wre(r)}:{}),a?{order:a}:{})}function Xme(e,t){var n,r=e.component.scales[t],a=e.specifiedScales[t].domain,i=null===(n=e.fieldDef(t))||void 0===n?void 0:n.bin,o=Pue(a)&&a,u=Bie(i)&&zie(i.extent)&&i.extent;(o||u)&&r.set("selectionExtent",null!==o&&void 0!==o?o:u,!0)}function Kme(e,t){var n=e.aggregate,r=e.type;return n?Mne(n)&&!gae[n]?{valid:!1,reason:ooe(n)}:"quantitative"===r&&"log"===t?{valid:!1,reason:uoe(e)}:{valid:!0}:{valid:!1,reason:ioe(e)}}function Yme(e,t,n,r){return e.explicit&&t.explicit&&woe(function(e,t,n,r){return"Conflicting ".concat(t.toString(),' property "').concat(e.toString(),'" (').concat(Qne(n)," and ").concat(Qne(r),"). Using the union of the two domains.")}(n,r,e.value,t.value)),{explicit:e.explicit,value:[].concat((0,cn.Z)(e.value),(0,cn.Z)(t.value))}}function $me(e){var t=ire(e.map((function(e){if(Woe(e)){e.sort;return jne(e,["sort"])}return e})),Jne),n=ire(e.map((function(e){if(Woe(e)){var t=e.sort;return void 0===t||hre(t)||("op"in t&&"count"===t.op&&delete t.field,"ascending"===t.order&&delete t.order),t}})).filter((function(e){return void 0!==e})),Jne);if(0!==t.length){if(1===t.length){var r=e[0];if(Woe(r)&&n.length>0){var a=n[0];if(n.length>1)woe(loe),a=!0;else if(_ne(a)&&"field"in a){var i=a.field;r.field===i&&(a=!a.order||{order:a.order})}return Object.assign(Object.assign({},r),{sort:a})}return r}var o,u=ire(n.map((function(e){return hre(e)||!("op"in e)||e.op in lae?e:(woe(function(e){return"Dropping sort property ".concat(Qne(e),' as unioned domains only support boolean or op "count", "min", and "max".')}(e)),!0)})),Jne);1===u.length?o=u[0]:u.length>1&&(woe(loe),o=!0);var s=ire(e.map((function(e){return Woe(e)?e.data:null})),(function(e){return e}));return 1===s.length&&null!==s[0]?Object.assign({data:s[0],fields:t.map((function(e){return e.field}))},o?{sort:o}:{}):Object.assign({fields:t},o?{sort:o}:{})}}function Qme(e){if(Woe(e)&&Mne(e.field))return e.field;if(function(e){return!kne(e)&&"fields"in e&&!("data"in e)}(e)){var t,n,r=(0,Rt.Z)(e.fields);try{for(r.s();!(n=r.n()).done;){var a=n.value;if(Woe(a)&&Mne(a.field))if(t){if(t!==a.field)return woe("Detected faceted independent scales that union domain of multiple fields from different data sources. We will use the first field. The result view size may be incorrect."),t}else t=a.field}}catch(o){r.e(o)}finally{r.f()}return woe("Detected faceted independent scales that union domain of the same fields from different source. We will assume that this is the same field from a different fork of the same data source. However, if this is not the case, the result view size may be incorrect."),t}if(function(e){return!kne(e)&&"fields"in e&&"data"in e}(e)){woe("Detected faceted independent scales that union domain of multiple fields from the same data source. We will use the first field. The result view size may be incorrect.");var i=e.fields[0];return Mne(i)?i:void 0}}function Jme(e,t){var n=e.component.scales[t].get("domains").map((function(t){return Woe(t)&&(t.data=e.lookupDataSource(t.data)),t}));return $me(n)}function ege(e){return kge(e)||wge(e)?e.children.reduce((function(e,t){return e.concat(ege(t))}),tge(e)):tge(e)}function tge(e){return lre(e.component.scales).reduce((function(t,n){var r=e.component.scales[n];if(r.merged)return t;var a,i=r.combine(),o=i.name,u=i.type,s=i.selectionExtent,c=(i.domains,i.range,i.reverse),l=jne(i,["name","type","selectionExtent","domains","range","reverse"]),f=function(e,t,n){if(wie(n)&&Uoe(e))return{step:{signal:t+"_step"}};return e}(i.range,o,n);s&&(a=function(e,t){var n=t.selection;return{signal:Zpe(e.getSelectionComponent(n,pre(n)),t)}}(e,s));var d=Jme(e,n);return t.push(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:o,type:u},d?{domain:d}:{}),a?{domainRaw:a}:{}),{range:f}),void 0!==c?{reverse:c}:{}),l)),t}),[])}var nge=function(e){(0,Ng.Z)(n,e);var t=(0,Tg.Z)(n);function n(e,r){var a;return(0,op.Z)(this,n),(a=t.call(this,{},{name:e})).merged=!1,a.setWithExplicit("type",r),a}return(0,up.Z)(n,[{key:"domainDefinitelyIncludesZero",value:function(){return!1!==this.get("zero")||nre(this.get("domains"),(function(e){return kne(e)&&2===e.length&&e[0]<=0&&e[1]>=0}))}}]),n}(dfe),rge=["range","scheme"];function age(e){return"x"===e?"width":"y"===e?"height":void 0}function ige(e,t){var n=e.fieldDef(t);if(n&&n.bin&&Rie(n.bin)){var r=eme(e,n.field,n.bin),a=age(t),i=e.getName(a);return new Ume((function(){var t=e.getSignalName(r),n="(".concat(t,".stop - ").concat(t,".start) / ").concat(t,".step");return"".concat(e.getSignalName(i)," / (").concat(n,")")}))}}function oge(e,t){var n,r=t.specifiedScales[e],a=t.size,i=t.getScaleComponent(e).get("type"),o=(0,Rt.Z)(rge);try{for(o.s();!(n=o.n()).done;){var u=n.value;if(void 0!==r[u]){var s=que(i,u),c=Gue(e,u);if(s)if(c)woe(c);else switch(u){case"range":return kne(r.range)&&wie(e)?hfe(r.range.map((function(e){if("width"===e||"height"===e){var n=t.getName(e),r=t.getSignalName.bind(t);return Ume.fromName(r,n)}return e}))):hfe(r.range);case"scheme":return hfe(uge(r[u]))}else woe(soe(i,u,e))}}}catch(d){o.e(d)}finally{o.f()}if(e===wae||e===kae){var l=e===wae?"width":"height",f=a[l];if(vle(f)){if(Bue(i))return hfe({step:f.step});woe(coe(l))}}return pfe(function(e,t){var n=t.size,r=t.config,a=t.mark,i=t.encoding,o=t.getSignalName.bind(t),u=rce(i[e]).type,s=t.getScaleComponent(e).get("type"),c=t.specifiedScales[e],l=c.domain,f=c.domainMid;switch(e){case wae:case kae:if(tre(["point","band"],s))if(e!==wae||n.width){if(e===kae&&!n.height){var d=xle(r.view,"height");if(vle(d))return d}}else{var h=xle(r.view,"width");if(vle(h))return h}var p=age(e),v=t.getName(p);return e===kae&&zue(s)?[Ume.fromName(o,v),0]:[0,Ume.fromName(o,v)];case Bae:var m=sge(a,t.component.scales[e].get("zero"),r),g=function(e,t,n,r){var a={x:ige(n,"x"),y:ige(n,"y")};switch(e){case"bar":case"tick":if(void 0!==r.scale.maxBandSize)return r.scale.maxBandSize;var i=lge(t,a,r.view);return Fne(i)?i-1:new Ume((function(){return"".concat(i.signal," - 1")}));case"line":case"trail":case"rule":return r.scale.maxStrokeWidth;case"text":return r.scale.maxFontSize;case"point":case"square":case"circle":if(r.scale.maxSize)return r.scale.maxSize;var o=lge(t,a,r.view);return Fne(o)?Math.pow(cge*o,2):new Ume((function(){return"pow(".concat(cge," * ").concat(o.signal,", 2)")}))}throw new Error(noe("size",e))}(a,n,t,r);return Lue(s)?function(e,t,n){var r=function(){var r=gce(t),a=gce(e),i="(".concat(r," - ").concat(a,") / (").concat(n," - 1)");return"sequence(".concat(a,", ").concat(r," + ").concat(i,", ").concat(i,")")};return Poe(t)?new Ume(r):{signal:r()}}(m,g,function(e,t,n,r){switch(e){case"quantile":return t.scale.quantileCount;case"quantize":return t.scale.quantizeCount;case"threshold":return void 0!==n&&kne(n)?n.length+1:(woe(function(e){return"Domain for ".concat(e," is required for threshold scale.")}(r)),3)}}(s,r,l,e)):[m,g];case Eae:return[0,2*Math.PI];case zae:return[0,360];case Cae:return[0,new Ume((function(){var e=t.getSignalName("width"),n=t.getSignalName("height");return"min(".concat(e,",").concat(n,")/2")}))];case Uae:return[r.scale.minStrokeWidth,r.scale.maxStrokeWidth];case Wae:return[[1,0],[4,2],[2,1],[1,1],[1,2,4,2]];case jae:return"symbol";case Mae:case Oae:case Rae:return"ordinal"===s?"nominal"===u?"category":"ordinal":void 0!==f?"diverging":"rect"===a||"geoshape"===a?"heatmap":"ramp";case Zae:case Lae:case Pae:return[r.scale.minOpacity,r.scale.maxOpacity]}throw new Error("Scale range undefined for channel ".concat(e))}(e,t))}function uge(e){return function(e){return!Mne(e)&&!!e.name}(e)?Object.assign({scheme:e.name},$ne(e,["name"])):{scheme:e}}function sge(e,t,n){if(t)return Poe(t)?{signal:"".concat(t.signal," ? 0 : ").concat(sge(e,!1,n))}:0;switch(e){case"bar":case"tick":return n.scale.minBandSize;case"line":case"trail":case"rule":return n.scale.minStrokeWidth;case"text":return n.scale.minFontSize;case"point":case"square":case"circle":return n.scale.minSize}throw new Error(noe("size",e))}var cge=.95;function lge(e,t,n){var r=vle(e.width)?e.width.step:ble(n,"width"),a=vle(e.height)?e.height.step:ble(n,"height");return t.x||t.y?new Ume((function(){var e=[t.x?t.x.signal:r,t.y?t.y.signal:a];return"min(".concat(e.join(", "),")")})):Math.min(r,a)}function fge(e,t){bge(e)?function(e,t){var n,r=e.component.scales,a=e.config,i=e.encoding,o=e.markDef,u=e.specifiedScales,s=(0,Rt.Z)(lre(r));try{for(s.s();!(n=s.n()).done;){var c=n.value,l=u[c],f=r[c],d=e.getScaleComponent(c),h=rce(i[c]),p=l[t],v=d.get("type"),m=d.get("padding"),g=d.get("paddingInner"),y=que(v,t),b=Gue(c,t);if(void 0!==p&&(y?b&&woe(b):woe(soe(v,t,c))),y&&void 0===b)if(void 0!==p)f.copyKeyFromObject(t,l);else{var x=t in dge?dge[t]({model:e,channel:c,fieldOrDatumDef:h,scaleType:v,scalePadding:m,scalePaddingInner:g,domain:l.domain,markDef:o,config:a}):a.scale[t];void 0!==x&&f.set(t,x,!1)}}}catch(w){s.e(w)}finally{s.f()}}(e,t):pge(e,t)}var dge={bins:function(e){var t=e.model,n=e.fieldOrDatumDef;return Dse(n)?function(e,t){var n=t.bin;if(Rie(n)){var r=eme(e,t.field,n);return new Ume((function(){return e.getSignalName(r)}))}if(jie(n)&&Bie(n)&&void 0!==n.step)return{step:n.step};return}(t,n):void 0},interpolate:function(e){return function(e,t){if(tre([Mae,Oae,Rae],e)&&"nominal"!==t)return"hcl";return}(e.channel,e.fieldOrDatumDef.type)},nice:function(e){return function(e,t,n){var r;if((null===(r=nce(n))||void 0===r?void 0:r.bin)||tre([bue,xue],e))return;return t in bie||void 0}(e.scaleType,e.channel,e.fieldOrDatumDef)},padding:function(e){var t=e.channel,n=e.scaleType,r=e.fieldOrDatumDef,a=e.markDef,i=e.config;return function(e,t,n,r,a,i){if(e in bie){if(Zue(t)){if(void 0!==n.continuousPadding)return n.continuousPadding;var o=a.type,u=a.orient;if("bar"===o&&(!Dse(r)||!r.bin&&!r.timeUnit)&&("vertical"===u&&"x"===e||"horizontal"===u&&"y"===e))return i.continuousBandSize}if(t===Sue)return n.pointPadding}return}(t,n,i.scale,r,a,i.bar)},paddingInner:function(e){var t=e.scalePadding,n=e.channel,r=e.markDef,a=e.config;return function(e,t,n,r){if(void 0!==e)return;if(t in bie){var a=r.bandPaddingInner,i=r.barBandPaddingInner,o=r.rectBandPaddingInner;return Cre(a,"bar"===n?i:o)}return}(t,n,r.type,a.scale)},paddingOuter:function(e){var t=e.scalePadding,n=e.channel,r=e.scaleType,a=e.markDef,i=e.scalePaddingInner,o=e.config;return function(e,t,n,r,a,i){if(void 0!==e)return;if(t in bie){if(n===Cue)return Cre(i.bandPaddingOuter,Poe(a)?{signal:"".concat(a.signal,"/2")}:a/2)}return}(t,n,r,a.type,i,o.scale)},reverse:function(e){var t=e.fieldOrDatumDef,n=e.scaleType,r=e.channel,a=e.config;return function(e,t,n,r){if("x"===n&&void 0!==r.xReverse)return zue(e)&&"descending"===t?Poe(r.xReverse)?{signal:"!".concat(r.xReverse.signal)}:!r.xReverse:r.xReverse;if(zue(e)&&"descending"===t)return!0;return}(n,Dse(t)?t.sort:void 0,r,a.scale)},zero:function(e){return function(e,t,n,r,a){if(n&&"unaggregated"!==n&&zue(a)){if(kne(n)){var i=n[0],o=n[n.length-1];if(i<=0&&o>=0)return!0}return!1}if("size"===e&&"quantitative"===t.type&&!Lue(a))return!0;if((!Dse(t)||!t.bin)&&tre([].concat((0,cn.Z)(xie),(0,cn.Z)(_ie)),e)){var u=r.orient;return!tre(["bar","area","line","trail"],r.type)||!("horizontal"===u&&"y"===e||"vertical"===u&&"x"===e)}return!1}(e.channel,e.fieldOrDatumDef,e.domain,e.markDef,e.scaleType)}};function hge(e){bge(e)?function(e){var t,n=e.component.scales,r=(0,Rt.Z)(Nie);try{for(r.s();!(t=r.n()).done;){var a=t.value,i=n[a];if(i){var o=oge(a,e);i.setWithExplicit("range",o)}}}catch(u){r.e(u)}finally{r.f()}}(e):pge(e,"range")}function pge(e,t){var n,r=e.component.scales,a=(0,Rt.Z)(e.children);try{for(a.s();!(n=a.n()).done;){var i=n.value;"range"===t?hge(i):fge(i,t)}}catch(h){a.e(h)}finally{a.f()}var o,u=(0,Rt.Z)(lre(r));try{for(u.s();!(o=u.n()).done;){var s,c=o.value,l=void 0,f=(0,Rt.Z)(e.children);try{for(f.s();!(s=f.n()).done;){var d=s.value.component.scales[c];if(d)l=gfe(l,d.getWithExplicit(t),t,"scale",vfe((function(e,n){return"range"===t&&e.step&&n.step?e.step-n.step:0})))}}catch(h){f.e(h)}finally{f.f()}r[c].setWithExplicit(t,l)}}catch(h){u.e(h)}finally{u.f()}}function vge(e,t,n,r){var a=function(e,t,n){var r;switch(t.type){case"nominal":case"ordinal":if(rie(e)||"discrete"===Mie(e))return"shape"===e&&"ordinal"===t.type&&woe(aoe(e,"ordinal")),"ordinal";if(e in bie){if(tre(["rect","bar","image","rule"],n))return"band"}else if("arc"===n&&e in kie)return"band";return void 0!==t.band||Lse(t)&&(null===(r=t.axis)||void 0===r?void 0:r.tickBand)?"band":"point";case"temporal":return rie(e)?"time":"discrete"===Mie(e)?(woe(aoe(e,"temporal")),"ordinal"):Dse(t)&&t.timeUnit&&Zoe(t.timeUnit).utc?"utc":"time";case"quantitative":return rie(e)?Dse(t)&&Rie(t.bin)?"bin-ordinal":"linear":"discrete"===Mie(e)?(woe(aoe(e,"quantitative")),"ordinal"):"linear";case"geojson":return}throw new Error(Jie(t.type))}(t,n,r),i=e.type;return Tie(t)?void 0!==i?Xue(t,i)?Dse(n)&&!Hue(i,n.type)?(woe(function(e,t){return'FieldDef does not work with "'.concat(e,'" scale. We are using "').concat(t,'" scale instead.')}(i,a)),a):i:(woe(function(e,t,n){return'Channel "'.concat(e,'" does not work with "').concat(t,'" scale. We are using "').concat(n,'" scale instead.')}(t,i,a)),a):a:null}function mge(e){bge(e)?e.component.scales=function(e){var t=e.encoding,n=e.mark;return Nie.reduce((function(r,a){var i=rce(t[a]);if(i&&n===$re&&a===jae&&i.type===due)return r;var o=i&&i.scale;if(i&&null!==o&&!1!==o){var u=vge(o=null!==o&&void 0!==o?o:{},a,i,n);r[a]=new nge(e.scaleName(a+"",!0),{value:u,explicit:o.type===u})}return r}),{})}(e):e.component.scales=function(e){var t,n,r=e.component.scales={},a={},i=e.component.resolve,o=(0,Rt.Z)(e.children);try{for(o.s();!(n=o.n()).done;){var u=n.value;mge(u);var s,c=(0,Rt.Z)(lre(u.component.scales));try{for(c.s();!(s=c.n()).done;){var l=s.value;if(i.scale[l]=null!==(t=i.scale[l])&&void 0!==t?t:Eve(l,e),"shared"===i.scale[l]){var f=a[l],d=u.component.scales[l].getWithExplicit("type");f?Nue(f.value,d.value)?a[l]=gfe(f,d,"type","scale",gge):(i.scale[l]="independent",delete a[l]):a[l]=d}}}catch(k){c.e(k)}finally{c.f()}}}catch(k){o.e(k)}finally{o.f()}var h,p=(0,Rt.Z)(lre(a));try{for(p.s();!(h=p.n()).done;){var v=h.value,m=e.scaleName(v,!0),g=a[v];r[v]=new nge(m,g);var y,b=(0,Rt.Z)(e.children);try{for(b.s();!(y=b.n()).done;){var x=y.value,w=x.component.scales[v];w&&(x.renameScale(w.get("name"),m),w.merged=!0)}}catch(k){b.e(k)}finally{b.f()}}}catch(k){p.e(k)}finally{p.f()}return r}(e)}var gge=vfe((function(e,t){return Iue(e)-Iue(t)}));var yge=function(){function e(){(0,op.Z)(this,e),this.nameMap={}}return(0,up.Z)(e,[{key:"rename",value:function(e,t){this.nameMap[e]=t}},{key:"has",value:function(e){return void 0!==this.nameMap[e]}},{key:"get",value:function(e){for(;this.nameMap[e]&&e!==this.nameMap[e];)e=this.nameMap[e];return e}}]),e}();function bge(e){return"unit"===(null===e||void 0===e?void 0:e.type)}function xge(e){return"facet"===(null===e||void 0===e?void 0:e.type)}function wge(e){return"concat"===(null===e||void 0===e?void 0:e.type)}function kge(e){return"layer"===(null===e||void 0===e?void 0:e.type)}var _ge=function(){function e(t,n,r,a,i,o,u){var s,c,l=this;(0,op.Z)(this,e),this.type=n,this.parent=r,this.config=i,this.view=u,this.children=[],this.correctDataNames=function(e){return e.from&&e.from.data&&(e.from.data=l.lookupDataSource(e.from.data)),e.from&&e.from.facet&&e.from.facet.data&&(e.from.facet.data=l.lookupDataSource(e.from.facet.data)),e},this.parent=r,this.config=i,this.name=null!==(s=t.name)&&void 0!==s?s:a,this.title=pce(t.title)?{text:t.title}:t.title,this.scaleNameMap=r?r.scaleNameMap:new yge,this.projectionNameMap=r?r.projectionNameMap:new yge,this.signalNameMap=r?r.signalNameMap:new yge,this.data=t.data,this.description=t.description,this.transforms=function(e){return e.map((function(e){return Nfe(e)?{filter:Hne(e.filter,oue)}:e}))}(null!==(c=t.transform)&&void 0!==c?c:[]),this.layout="layer"===n||"unit"===n?{}:function(e,t,n){var r,a,i=n[t],o={},u=i.spacing,s=i.columns;void 0!==u&&(o.spacing=u),void 0!==s&&(_se(e)&&!wse(e.facet)||dle(e))&&(o.columns=s),hle(e)&&(o.columns=1);var c,l=(0,Rt.Z)(gle);try{for(l.s();!(c=l.n()).done;){var f=c.value;if(void 0!==e[f])if("spacing"===f){var d=e[f];o[f]=Fne(d)?d:{row:null!==(r=d.row)&&void 0!==r?r:u,column:null!==(a=d.column)&&void 0!==a?a:u}}else o[f]=e[f]}}catch(h){l.e(h)}finally{l.f()}return o}(t,n,i),this.component={data:{sources:r?r.component.data.sources:[],outputNodes:r?r.component.data.outputNodes:{},outputNodeRefCounts:r?r.component.data.outputNodeRefCounts:{},isFaceted:_se(t)||r&&r.component.data.isFaceted&&void 0===t.data},layoutSize:new dfe,layoutHeaders:{row:{},column:{},facet:{}},mark:null,resolve:Object.assign({scale:{},axis:{},legend:{}},o?Kne(o):{}),selection:null,scales:null,projection:null,axes:{},legends:{}}}return(0,up.Z)(e,[{key:"width",get:function(){return this.getSizeSignalRef("width")}},{key:"height",get:function(){return this.getSizeSignalRef("height")}},{key:"parse",value:function(){this.parseScale(),this.parseLayoutSize(),this.renameTopLevelLayoutSizeSignal(),this.parseSelections(),this.parseProjection(),this.parseData(),this.parseAxesAndHeaders(),this.parseLegends(),this.parseMarkGroup()}},{key:"parseScale",value:function(){!function(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).ignoreRange;mge(e),Wme(e);var n,r=(0,Rt.Z)(Vue);try{for(r.s();!(n=r.n()).done;){fge(e,n.value)}}catch(a){r.e(a)}finally{r.f()}t||hge(e)}(this)}},{key:"parseProjection",value:function(){$ve(this)}},{key:"renameTopLevelLayoutSizeSignal",value:function(){"width"!==this.getName("width")&&this.renameSignal(this.getName("width"),"width"),"height"!==this.getName("height")&&this.renameSignal(this.getName("height"),"height")}},{key:"parseLegends",value:function(){Pve(this)}},{key:"assembleGroupStyle",value:function(){var e,t;if("unit"===this.type||"layer"===this.type)return null!==(t=null===(e=this.view)||void 0===e?void 0:e.style)&&void 0!==t?t:"cell"}},{key:"assembleEncodeFromView",value:function(e){e.style;var t,n=jne(e,["style"]),r={},a=(0,Rt.Z)(lre(n));try{for(a.s();!(t=a.n()).done;){var i=t.value,o=n[i];void 0!==o&&(r[i]=vce(o))}}catch(u){a.e(u)}finally{a.f()}return r}},{key:"assembleGroupEncodeEntry",value:function(e){var t={};return this.view&&(t=this.assembleEncodeFromView(this.view)),e||(this.description&&(t.description=vce(this.description)),"unit"!==this.type&&"layer"!==this.type)?cre(t)?void 0:t:Object.assign({width:this.getSizeSignalRef("width"),height:this.getSizeSignalRef("height")},null!==t&&void 0!==t?t:{})}},{key:"assembleLayout",value:function(){if(this.layout){var e=this.layout,t=e.spacing,n=jne(e,["spacing"]),r=this.component,a=this.config,i=function(e,t){var n,r={},a=(0,Rt.Z)(iie);try{for(a.s();!(n=a.n()).done;){var i=n.value,o=e[i];if(null===o||void 0===o?void 0:o.facetFieldDef){var u=sve(["titleAnchor","titleOrient"],o.facetFieldDef,t,i),s=u.titleAnchor,c=ove(i,u.titleOrient),l=bve(s,c);void 0!==l&&(r[c]=l)}}}catch(f){a.e(f)}finally{a.f()}return cre(r)?void 0:r}(r.layoutHeaders,a);return Object.assign(Object.assign(Object.assign({padding:t},this.assembleDefaultLayout()),n),i?{titleBand:i}:{})}}},{key:"assembleDefaultLayout",value:function(){return{}}},{key:"assembleHeaderMarks",value:function(){var e,t=this.component.layoutHeaders,n=[],r=(0,Rt.Z)(iie);try{for(r.s();!(e=r.n()).done;){var a=e.value;t[a].title&&n.push(fve(this,a))}}catch(s){r.e(s)}finally{r.f()}var i,o=(0,Rt.Z)(cve);try{for(o.s();!(i=o.n()).done;){var u=i.value;n=n.concat(pve(this,u))}}catch(s){o.e(s)}finally{o.f()}return n}},{key:"assembleAxes",value:function(){return function(e,t){var n=e.x,r=void 0===n?[]:n,a=e.y,i=void 0===a?[]:a;return[].concat((0,cn.Z)(r.map((function(e){return Wpe(e,"grid",t)}))),(0,cn.Z)(i.map((function(e){return Wpe(e,"grid",t)}))),(0,cn.Z)(r.map((function(e){return Wpe(e,"main",t)}))),(0,cn.Z)(i.map((function(e){return Wpe(e,"main",t)})))).filter((function(e){return e}))}(this.component.axes,this.config)}},{key:"assembleLegends",value:function(){return Gve(this)}},{key:"assembleProjections",value:function(){return Hve(this)}},{key:"assembleTitle",value:function(){var e,t,n,r=null!==(e=this.title)&&void 0!==e?e:{},a=r.encoding,i=jne(r,["encoding"]),o=Object.assign(Object.assign(Object.assign({},hce(this.config.title).nonMark),i),a?{encode:{update:a}}:{});if(o.text)return tre(["unit","layer"],this.type)?tre(["middle",void 0],o.anchor)&&(o.frame=null!==(t=o.frame)&&void 0!==t?t:"group"):o.anchor=null!==(n=o.anchor)&&void 0!==n?n:"start",cre(o)?void 0:o}},{key:"assembleGroup",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t={};(e=e.concat(this.assembleSignals())).length>0&&(t.signals=e);var n=this.assembleLayout();n&&(t.layout=n),t.marks=[].concat(this.assembleHeaderMarks(),this.assembleMarks());var r=!this.parent||xge(this.parent)?ege(this):[];r.length>0&&(t.scales=r);var a=this.assembleAxes();a.length>0&&(t.axes=a);var i=this.assembleLegends();return i.length>0&&(t.legends=i),t}},{key:"getName",value:function(e){return pre((this.name?this.name+"_":"")+e)}},{key:"requestDataName",value:function(e){var t,n=this.getName(e),r=this.component.data.outputNodeRefCounts;return r[n]=(null!==(t=r[n])&&void 0!==t?t:0)+1,n}},{key:"getSizeSignalRef",value:function(e){if(xge(this.parent)){var t=Sie(Cve(e)),n=this.component.scales[t];if(n&&!n.merged){var r=n.get("type"),a=n.get("range");if(Bue(r)&&Uoe(a)){var i=n.get("name"),o=Qme(Jme(this,t));return o?{signal:Sve(i,n,Vse({aggregate:"distinct",field:o},{expr:"datum"}))}:(woe("Unknown field for ".concat(t,". Cannot calculate view size.")),null)}}}return{signal:this.signalNameMap.get(this.getName(e))}}},{key:"lookupDataSource",value:function(e){var t=this.component.data.outputNodes[e];return t?t.getSource():e}},{key:"getSignalName",value:function(e){return this.signalNameMap.get(e)}},{key:"renameSignal",value:function(e,t){this.signalNameMap.rename(e,t)}},{key:"renameScale",value:function(e,t){this.scaleNameMap.rename(e,t)}},{key:"renameProjection",value:function(e,t){this.projectionNameMap.rename(e,t)}},{key:"scaleName",value:function(e,t){return t?this.getName(e):lie(e)&&Tie(e)&&this.component.scales[e]||this.scaleNameMap.has(this.getName(e))?this.scaleNameMap.get(this.getName(e)):void 0}},{key:"projectionName",value:function(e){return e?this.getName("projection"):this.component.projection&&!this.component.projection.merged||this.projectionNameMap.has(this.getName("projection"))?this.projectionNameMap.get(this.getName("projection")):void 0}},{key:"getScaleComponent",value:function(e){if(!this.component.scales)throw new Error("getScaleComponent cannot be called before parseScale(). Make sure you have called parseScale or use parseUnitModelWithScale().");var t=this.component.scales[e];return t&&!t.merged?t:this.parent?this.parent.getScaleComponent(e):void 0}},{key:"getSelectionComponent",value:function(e,t){var n=this.component.selection[e];if(!n&&this.parent&&(n=this.parent.getSelectionComponent(e,t)),!n)throw new Error('Cannot find a selection named "'.concat(t,'".'));return n}},{key:"hasAxisOrientSignalRef",value:function(){var e,t;return(null===(e=this.component.axes.x)||void 0===e?void 0:e.some((function(e){return e.hasOrientSignalRef()})))||(null===(t=this.component.axes.y)||void 0===t?void 0:t.some((function(e){return e.hasOrientSignalRef()})))}}]),e}(),Sge=function(e){(0,Ng.Z)(n,e);var t=(0,Tg.Z)(n);function n(){return(0,op.Z)(this,n),t.apply(this,arguments)}return(0,up.Z)(n,[{key:"vgField",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.fieldDef(e);if(n)return Vse(n,t)}},{key:"reduceFieldDef",value:function(e,t){return Mce(this.getMapping(),(function(t,n,r){var a=nce(n);return a?e(t,a,r):t}),t)}},{key:"forEachFieldDef",value:function(e,t){Fce(this.getMapping(),(function(t,n){var r=nce(t);r&&e(r,n)}),t)}}]),n}(_ge),Cge=function(e){(0,Ng.Z)(n,e);var t=(0,Tg.Z)(n);function n(e,r){var a,i,o,u;(0,op.Z)(this,n),(a=t.call(this,e)).transform=r,a.transform=Kne(r);var s=null!==(i=a.transform.as)&&void 0!==i?i:[void 0,void 0];return a.transform.as=[null!==(o=s[0])&&void 0!==o?o:"value",null!==(u=s[1])&&void 0!==u?u:"density"],a}return(0,up.Z)(n,[{key:"clone",value:function(){return new n(null,Kne(this.transform))}},{key:"dependentFields",value:function(){var e;return new Set([this.transform.density].concat((0,cn.Z)(null!==(e=this.transform.groupby)&&void 0!==e?e:[])))}},{key:"producedFields",value:function(){return new Set(this.transform.as)}},{key:"hash",value:function(){return"DensityTransform ".concat(Jne(this.transform))}},{key:"assemble",value:function(){var e=this.transform,t=e.density,n=jne(e,["density"]);return Object.assign({type:"kde",field:t},n)}}]),n}(wde),Age=function(e){(0,Ng.Z)(n,e);var t=(0,Tg.Z)(n);function n(e,r){var a;return(0,op.Z)(this,n),(a=t.call(this,e)).filter=r,a}return(0,up.Z)(n,[{key:"clone",value:function(){return new n(null,Object.assign({},this.filter))}},{key:"dependentFields",value:function(){return new Set(lre(this.filter))}},{key:"producedFields",value:function(){return new Set}},{key:"hash",value:function(){return"FilterInvalid ".concat(Jne(this.filter))}},{key:"assemble",value:function(){var e=this,t=lre(this.filter).reduce((function(t,n){var r=e.filter[n],a=Vse(r,{expr:"datum"});return null!==r&&("temporal"===r.type?t.push("(isDate(".concat(a,") || (isValid(").concat(a,") && isFinite(+").concat(a,")))")):"quantitative"===r.type&&(t.push("isValid(".concat(a,")")),t.push("isFinite(+".concat(a,")")))),t}),[]);return t.length>0?{type:"filter",expr:t.join(" && ")}:null}}],[{key:"make",value:function(e,t){var r=t.config,a=t.mark;if("filter"!==bce("invalid",t.markDef,r))return null;var i=t.reduceFieldDef((function(e,n,r){var i=Tie(r)&&t.getScaleComponent(r);i&&(zue(i.get("type"))&&"count"!==n.aggregate&&!Qre(a)&&(e[n.field]=n));return e}),{});return lre(i).length?new n(e,i):null}}]),n}(wde),Ege=function(e){(0,Ng.Z)(n,e);var t=(0,Tg.Z)(n);function n(e,r){var a;(0,op.Z)(this,n),(a=t.call(this,e)).transform=r,a.transform=Kne(r);var i=a.transform,o=i.flatten,u=i.as,s=void 0===u?[]:u;return a.transform.as=o.map((function(e,t){var n;return null!==(n=s[t])&&void 0!==n?n:e})),a}return(0,up.Z)(n,[{key:"clone",value:function(){return new n(this.parent,Kne(this.transform))}},{key:"dependentFields",value:function(){return new Set(this.transform.flatten)}},{key:"producedFields",value:function(){return new Set(this.transform.as)}},{key:"hash",value:function(){return"FlattenTransform ".concat(Jne(this.transform))}},{key:"assemble",value:function(){var e=this.transform;return{type:"flatten",fields:e.flatten,as:e.as}}}]),n}(wde),Nge=function(e){(0,Ng.Z)(n,e);var t=(0,Tg.Z)(n);function n(e,r){var a,i,o,u;(0,op.Z)(this,n),(a=t.call(this,e)).transform=r,a.transform=Kne(r);var s=null!==(i=a.transform.as)&&void 0!==i?i:[void 0,void 0];return a.transform.as=[null!==(o=s[0])&&void 0!==o?o:"key",null!==(u=s[1])&&void 0!==u?u:"value"],a}return(0,up.Z)(n,[{key:"clone",value:function(){return new n(null,Kne(this.transform))}},{key:"dependentFields",value:function(){return new Set(this.transform.fold)}},{key:"producedFields",value:function(){return new Set(this.transform.as)}},{key:"hash",value:function(){return"FoldTransform ".concat(Jne(this.transform))}},{key:"assemble",value:function(){var e=this.transform;return{type:"fold",fields:e.fold,as:e.as}}}]),n}(wde),Tge=function(e){(0,Ng.Z)(n,e);var t=(0,Tg.Z)(n);function n(e,r,a,i){var o;return(0,op.Z)(this,n),(o=t.call(this,e)).fields=r,o.geojson=a,o.signal=i,o}return(0,up.Z)(n,[{key:"clone",value:function(){return new n(null,Kne(this.fields),this.geojson,this.signal)}},{key:"dependentFields",value:function(){var e,t=(null!==(e=this.fields)&&void 0!==e?e:[]).filter(Mne);return new Set([].concat((0,cn.Z)(this.geojson?[this.geojson]:[]),(0,cn.Z)(t)))}},{key:"producedFields",value:function(){return new Set}},{key:"hash",value:function(){return"GeoJSON ".concat(this.geojson," ").concat(this.signal," ").concat(Jne(this.fields))}},{key:"assemble",value:function(){return Object.assign(Object.assign(Object.assign({type:"geojson"},this.fields?{fields:this.fields}:{}),this.geojson?{geojson:this.geojson}:{}),{signal:this.signal})}}],[{key:"parseAll",value:function(e,t){if(t.component.projection&&!t.component.projection.isFit)return e;for(var r=0,a=0,i=[[Iae,Tae],[Fae,Dae]];a<i.length;a++){var o=i[a].map((function(e){var n=rce(t.encoding[e]);return Dse(n)?n.field:Mse(n)?{expr:"".concat(n.datum)}:zse(n)?{expr:"".concat(n.value)}:void 0}));(o[0]||o[1])&&(e=new n(e,o,null,t.getName("geojson_".concat(r++))))}if(t.channelHasField(jae)){var u=t.typedFieldDef(jae);u.type===due&&(e=new n(e,null,u.field,t.getName("geojson_".concat(r++))))}return e}}]),n}(wde),Ige=function(e){(0,Ng.Z)(n,e);var t=(0,Tg.Z)(n);function n(e,r,a,i){var o;return(0,op.Z)(this,n),(o=t.call(this,e)).projection=r,o.fields=a,o.as=i,o}return(0,up.Z)(n,[{key:"clone",value:function(){return new n(null,this.projection,Kne(this.fields),Kne(this.as))}},{key:"dependentFields",value:function(){return new Set(this.fields.filter(Mne))}},{key:"producedFields",value:function(){return new Set(this.as)}},{key:"hash",value:function(){return"Geopoint ".concat(this.projection," ").concat(Jne(this.fields)," ").concat(Jne(this.as))}},{key:"assemble",value:function(){return{type:"geopoint",projection:this.projection,fields:this.fields,as:this.as}}}],[{key:"parseAll",value:function(e,t){if(!t.projectionName())return e;for(var r=0,a=[[Iae,Tae],[Fae,Dae]];r<a.length;r++){var i=a[r],o=i.map((function(e){var n=rce(t.encoding[e]);return Dse(n)?n.field:Mse(n)?{expr:"".concat(n.datum)}:zse(n)?{expr:"".concat(n.value)}:void 0})),u=i[0]===Fae?"2":"";(o[0]||o[1])&&(e=new n(e,t.projectionName(),o,[t.getName("x"+u),t.getName("y"+u)]))}return e}}]),n}(wde),Dge=function(e){(0,Ng.Z)(n,e);var t=(0,Tg.Z)(n);function n(e,r){var a;return(0,op.Z)(this,n),(a=t.call(this,e)).transform=r,a}return(0,up.Z)(n,[{key:"clone",value:function(){return new n(null,Kne(this.transform))}},{key:"dependentFields",value:function(){var e;return new Set([this.transform.impute,this.transform.key].concat((0,cn.Z)(null!==(e=this.transform.groupby)&&void 0!==e?e:[])))}},{key:"producedFields",value:function(){return new Set([this.transform.impute])}},{key:"processSequence",value:function(e){var t=e.start,n=void 0===t?0:t,r=e.stop,a=e.step,i=[n,r].concat((0,cn.Z)(a?[a]:[])).join(",");return{signal:"sequence(".concat(i,")")}}},{key:"hash",value:function(){return"Impute ".concat(Jne(this.transform))}},{key:"assemble",value:function(){var e,t=this.transform,n=t.impute,r=t.key,a=t.keyvals,i=t.method,o=t.groupby,u=t.value,s=t.frame,c=void 0===s?[null,null]:s,l=Object.assign(Object.assign(Object.assign(Object.assign({type:"impute",field:n,key:r},a?{keyvals:(e=a,void 0!==(null===e||void 0===e?void 0:e.stop)?this.processSequence(a):a)}:{}),{method:"value"}),o?{groupby:o}:{}),{value:i&&"value"!==i?null:u});return i&&"value"!==i?[l,Object.assign({type:"window",as:["imputed_".concat(n,"_value")],ops:[i],fields:[n],frame:c,ignorePeers:!1},o?{groupby:o}:{}),{type:"formula",expr:"datum.".concat(n," === null ? datum.imputed_").concat(n,"_value : datum.").concat(n),as:n}]:[l]}}],[{key:"makeFromTransform",value:function(e,t){return new n(e,t)}},{key:"makeFromEncoding",value:function(e,t){var r=t.encoding,a=r.x,i=r.y;if(Dse(a)&&Dse(i)){var o=a.impute?a:i.impute?i:void 0;if(void 0===o)return;var u=a.impute?i:i.impute?a:void 0,s=o.impute,c=s.method,l=s.value,f=s.frame,d=s.keyvals,h=Oce(t.mark,r);return new n(e,Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({impute:o.field,key:u.field},c?{method:c}:{}),void 0!==l?{value:l}:{}),f?{frame:f}:{}),void 0!==d?{keyvals:d}:{}),h.length?{groupby:h}:{}))}return null}}]),n}(wde),Fge=function(e){(0,Ng.Z)(n,e);var t=(0,Tg.Z)(n);function n(e,r){var a,i,o,u;(0,op.Z)(this,n),(a=t.call(this,e)).transform=r,a.transform=Kne(r);var s=null!==(i=a.transform.as)&&void 0!==i?i:[void 0,void 0];return a.transform.as=[null!==(o=s[0])&&void 0!==o?o:r.on,null!==(u=s[1])&&void 0!==u?u:r.loess],a}return(0,up.Z)(n,[{key:"clone",value:function(){return new n(null,Kne(this.transform))}},{key:"dependentFields",value:function(){var e;return new Set([this.transform.loess,this.transform.on].concat((0,cn.Z)(null!==(e=this.transform.groupby)&&void 0!==e?e:[])))}},{key:"producedFields",value:function(){return new Set(this.transform.as)}},{key:"hash",value:function(){return"LoessTransform ".concat(Jne(this.transform))}},{key:"assemble",value:function(){var e=this.transform,t=e.loess,n=e.on,r=jne(e,["loess","on"]);return Object.assign({type:"loess",x:n,y:t},r)}}]),n}(wde),Mge=function(e){(0,Ng.Z)(n,e);var t=(0,Tg.Z)(n);function n(e,r,a){var i;return(0,op.Z)(this,n),(i=t.call(this,e)).transform=r,i.secondary=a,i}return(0,up.Z)(n,[{key:"clone",value:function(){return new n(null,Kne(this.transform),this.secondary)}},{key:"dependentFields",value:function(){return new Set([this.transform.lookup])}},{key:"producedFields",value:function(){return new Set(this.transform.as?Nne(this.transform.as):this.transform.from.fields)}},{key:"hash",value:function(){return"Lookup ".concat(Jne({transform:this.transform,secondary:this.secondary}))}},{key:"assemble",value:function(){var e;if(this.transform.from.fields)e=Object.assign({values:this.transform.from.fields},this.transform.as?{as:Nne(this.transform.as)}:{});else{var t=this.transform.as;Mne(t)||(woe('If "from.fields" is not specified, "as" has to be a string that specifies the key to be used for the data from the secondary source.'),t="_lookup"),e={as:[t]}}return Object.assign(Object.assign({type:"lookup",from:this.secondary,key:this.transform.from.key,fields:[this.transform.lookup]},e),this.transform.default?{default:this.transform.default}:{})}}],[{key:"make",value:function(e,t,r,a){var i=t.component.data.sources,o=r.from,u=null;if(function(e){return"data"in e}(o)){var s=Yge(o.data,i);s||(s=new rme(o.data),i.push(s));var c=t.getName("lookup_".concat(a));u=new kde(s,c,"lookup",t.component.data.outputNodeRefCounts),t.component.data.outputNodes[c]=u}else if(function(e){return"selection"in e}(o)){var l=o.selection;if(r=Object.assign({as:l},r),!(u=t.getSelectionComponent(pre(l),l).materialized))throw new Error('Cannot define and lookup the "'.concat(l,'" selection in the same view. ')+"Try moving the lookup into a second, layered view?")}return new n(e,r,u.getSource())}}]),n}(wde),Oge=function(e){(0,Ng.Z)(n,e);var t=(0,Tg.Z)(n);function n(e,r){var a,i,o,u;(0,op.Z)(this,n),(a=t.call(this,e)).transform=r,a.transform=Kne(r);var s=null!==(i=a.transform.as)&&void 0!==i?i:[void 0,void 0];return a.transform.as=[null!==(o=s[0])&&void 0!==o?o:"prob",null!==(u=s[1])&&void 0!==u?u:"value"],a}return(0,up.Z)(n,[{key:"clone",value:function(){return new n(null,Kne(this.transform))}},{key:"dependentFields",value:function(){var e;return new Set([this.transform.quantile].concat((0,cn.Z)(null!==(e=this.transform.groupby)&&void 0!==e?e:[])))}},{key:"producedFields",value:function(){return new Set(this.transform.as)}},{key:"hash",value:function(){return"QuantileTransform ".concat(Jne(this.transform))}},{key:"assemble",value:function(){var e=this.transform,t=e.quantile,n=jne(e,["quantile"]);return Object.assign({type:"quantile",field:t},n)}}]),n}(wde),Rge=function(e){(0,Ng.Z)(n,e);var t=(0,Tg.Z)(n);function n(e,r){var a,i,o,u;(0,op.Z)(this,n),(a=t.call(this,e)).transform=r,a.transform=Kne(r);var s=null!==(i=a.transform.as)&&void 0!==i?i:[void 0,void 0];return a.transform.as=[null!==(o=s[0])&&void 0!==o?o:r.on,null!==(u=s[1])&&void 0!==u?u:r.regression],a}return(0,up.Z)(n,[{key:"clone",value:function(){return new n(null,Kne(this.transform))}},{key:"dependentFields",value:function(){var e;return new Set([this.transform.regression,this.transform.on].concat((0,cn.Z)(null!==(e=this.transform.groupby)&&void 0!==e?e:[])))}},{key:"producedFields",value:function(){return new Set(this.transform.as)}},{key:"hash",value:function(){return"RegressionTransform ".concat(Jne(this.transform))}},{key:"assemble",value:function(){var e=this.transform,t=e.regression,n=e.on,r=jne(e,["regression","on"]);return Object.assign({type:"regression",x:n,y:t},r)}}]),n}(wde),jge=function(e){(0,Ng.Z)(n,e);var t=(0,Tg.Z)(n);function n(e,r){var a;return(0,op.Z)(this,n),(a=t.call(this,e)).transform=r,a}return(0,up.Z)(n,[{key:"clone",value:function(){return new n(null,Kne(this.transform))}},{key:"addDimensions",value:function(e){var t;this.transform.groupby=ire((null!==(t=this.transform.groupby)&&void 0!==t?t:[]).concat(e),(function(e){return e}))}},{key:"producedFields",value:function(){}},{key:"dependentFields",value:function(){var e;return new Set([this.transform.pivot,this.transform.value].concat((0,cn.Z)(null!==(e=this.transform.groupby)&&void 0!==e?e:[])))}},{key:"hash",value:function(){return"PivotTransform ".concat(Jne(this.transform))}},{key:"assemble",value:function(){var e=this.transform,t=e.pivot,n=e.value,r=e.groupby,a=e.limit,i=e.op;return Object.assign(Object.assign(Object.assign({type:"pivot",field:t,value:n},void 0!==a?{limit:a}:{}),void 0!==i?{op:i}:{}),void 0!==r?{groupby:r}:{})}}]),n}(wde),Bge=function(e){(0,Ng.Z)(n,e);var t=(0,Tg.Z)(n);function n(e,r){var a;return(0,op.Z)(this,n),(a=t.call(this,e)).transform=r,a}return(0,up.Z)(n,[{key:"clone",value:function(){return new n(null,Kne(this.transform))}},{key:"dependentFields",value:function(){return new Set}},{key:"producedFields",value:function(){return new Set}},{key:"hash",value:function(){return"SampleTransform ".concat(Jne(this.transform))}},{key:"assemble",value:function(){return{type:"sample",size:this.transform.sample}}}]),n}(wde);function zge(e){var t=0;return function n(r,a){var i,o,u;if(r instanceof rme&&(r.isGenerator||bfe(r.data)||(e.push(a),a={name:null,source:a.name,transform:[]})),r instanceof yme&&(r.parent instanceof rme&&!a.source?(a.format=Object.assign(Object.assign({},null!==(i=a.format)&&void 0!==i?i:{}),{parse:r.assembleFormatParse()}),(o=a.transform).push.apply(o,(0,cn.Z)(r.assembleTransforms(!0)))):(u=a.transform).push.apply(u,(0,cn.Z)(r.assembleTransforms()))),r instanceof hme){a.name||(a.name="data_".concat(t++)),!a.source||a.transform.length>0?(e.push(a),r.data=a.name):r.data=a.source;var s,c=(0,Rt.Z)(r.assemble());try{for(c.s();!(s=c.n()).done;){var l=s.value;e.push(l)}}catch(v){c.e(v)}finally{c.f()}}else{var f;if((r instanceof ime||r instanceof ome||r instanceof Age||r instanceof Bpe||r instanceof ave||r instanceof Ige||r instanceof Tge||r instanceof dme||r instanceof Mge||r instanceof kme||r instanceof xme||r instanceof Nge||r instanceof Ege||r instanceof Cge||r instanceof Fge||r instanceof Oge||r instanceof Rge||r instanceof bme||r instanceof Bge||r instanceof jge)&&a.transform.push(r.assemble()),r instanceof nme||r instanceof _de||r instanceof Dge||r instanceof wme)(f=a.transform).push.apply(f,(0,cn.Z)(r.assemble()));if(r instanceof kde)if(a.source&&0===a.transform.length)r.setSource(a.source);else if(r.parent instanceof kde)r.setSource(a.name);else{if(a.name||(a.name="data_".concat(t++)),r.setSource(a.name),1===r.numChildren())e.push(a),a={name:null,source:a.name,transform:[]}}switch(r.numChildren()){case 0:r instanceof kde&&(!a.source||a.transform.length>0)&&e.push(a);break;case 1:n(r.children[0],a);break;default:a.name||(a.name="data_".concat(t++));var d=a.name;!a.source||a.transform.length>0?e.push(a):d=a.source;var h,p=(0,Rt.Z)(r.children);try{for(p.s();!(h=p.n()).done;){n(h.value,{name:null,source:d,transform:[]})}}catch(v){p.e(v)}finally{p.f()}}}}}function Zge(e,t){var n,r,a,i=[],o=zge(i),u=0,s=(0,Rt.Z)(e.sources);try{for(s.s();!(a=s.n()).done;){var c=a.value;c.hasName()||(c.dataName="source_".concat(u++));var l=c.assemble();o(c,l)}}catch(T){s.e(T)}finally{s.f()}for(var f=0,d=i;f<d.length;f++){var h=d[f];0===h.transform.length&&delete h.transform}var p,v=0,m=(0,Rt.Z)(i.entries());try{for(m.s();!(p=m.n()).done;){var g=(0,Cn.Z)(p.value,2),y=g[0],b=g[1];0!==(null!==(n=b.transform)&&void 0!==n?n:[]).length||b.source||i.splice(v++,0,i.splice(y,1)[0])}}catch(T){m.e(T)}finally{m.f()}for(var x=0,w=i;x<w.length;x++){var k,_=w[x],S=(0,Rt.Z)(null!==(r=_.transform)&&void 0!==r?r:[]);try{for(S.s();!(k=S.n()).done;){var C=k.value;"lookup"===C.type&&(C.from=e.outputNodes[C.from].getSource())}}catch(T){S.e(T)}finally{S.f()}}for(var A=0,E=i;A<E.length;A++){var N=E[A];N.name in t&&(N.values=t[N.name])}return i}function Lge(e){return"top"===e||"left"===e||Poe(e)?"header":"footer"}function Pge(e,t){var n,r=e.facet,a=e.config,i=e.child,o=e.component;if(e.channelHasField(t)){var u=r[t],s=uve("title",null,a,t),c=Qse(u,a,{allowDisabling:!0,includeDefault:void 0===s||!!s});i.component.layoutHeaders[t].title&&(c=kne(c)?c.join(", "):c,c+=" / "+i.component.layoutHeaders[t].title,i.component.layoutHeaders[t].title=null);var l=uve("labelOrient",u,a,t),f=Cre((null!==(n=u.header)&&void 0!==n?n:{}).labels,a.header.labels,!0),d=tre(["bottom","right"],l)?"footer":"header";o.layoutHeaders[t]=(0,Xn.Z)({title:c,facetFieldDef:u},d,"facet"===t?[]:[Uge(e,t,f)])}}function Uge(e,t,n){var r="row"===t?"height":"width";return{labels:n,sizeSignal:e.child.component.layoutSize.get(r)?e.child.getSizeSignalRef(r):void 0,axes:[]}}function Wge(e,t){var n,r=e.child;if(r.component.axes[t]){var a=e.component,i=a.layoutHeaders,o=a.resolve;if(o.axis[t]=Nve(o,t),"shared"===o.axis[t]){var u,s="x"===t?"column":"row",c=i[s],l=(0,Rt.Z)(r.component.axes[t]);try{for(l.s();!(u=l.n()).done;){var f=u.value,d=Lge(f.get("orient"));c[d]=null!==(n=c[d])&&void 0!==n?n:[Uge(e,s,!1)];var h=Wpe(f,"main",e.config,{header:!0});h&&c[d][0].axes.push(h),f.mainExtracted=!0}}catch(p){l.e(p)}finally{l.f()}}}}function Vge(e){qge(e);var t=1===e.layout.columns?"width":"childWidth",n=void 0===e.layout.columns?"height":"childHeight";Gge(e,t),Gge(e,n)}function qge(e){var t,n=(0,Rt.Z)(e.children);try{for(n.s();!(t=n.n()).done;){t.value.parseLayoutSize()}}catch(r){n.e(r)}finally{n.f()}}function Gge(e,t){var n,r,a=Cve(t),i=Sie(a),o=e.component.resolve,u=e.component.layoutSize,s=(0,Rt.Z)(e.children);try{for(s.s();!(r=s.n()).done;){var c=r.value.component.layoutSize.getWithExplicit(a),l=o.scale[i];if("independent"===l&&"step"===c.value){n=void 0;break}if(n){if("independent"===l&&n.value!==c.value){n=void 0;break}n=gfe(n,c,a,"")}else n=c}}catch(p){s.e(p)}finally{s.f()}if(n){var f,d=(0,Rt.Z)(e.children);try{for(d.s();!(f=d.n()).done;){var h=f.value;e.renameSignal(h.getName(a),e.getName(t)),h.component.layoutSize.set(a,"merged",!1)}}catch(p){d.e(p)}finally{d.f()}u.setWithExplicit(t,n)}else u.setWithExplicit(t,{explicit:!1,value:void 0})}function Hge(e,t){var n="width"===t?"x":"y",r=e.config,a=e.getScaleComponent(n);if(a){var i=a.get("type"),o=a.get("range");if(Bue(i)){var u=xle(r.view,t);return Uoe(o)||vle(u)?"step":u}return yle(r.view,t)}if(e.hasProjection||"arc"===e.mark)return yle(r.view,t);var s=xle(r.view,t);return vle(s)?s.step:s}function Xge(e,t,n){return Vse(t,Object.assign({suffix:"by_".concat(Vse(e))},null!==n&&void 0!==n?n:{}))}var Kge=function(e){(0,Ng.Z)(n,e);var t=(0,Tg.Z)(n);function n(e,r,a,i){var o;return(0,op.Z)(this,n),(o=t.call(this,e,"facet",r,a,i,e.resolve)).child=Aye(e.spec,(0,Cg.Z)(o),o.getName("child"),void 0,i),o.children=[o.child],o.facet=o.initFacet(e.facet,i),o}return(0,up.Z)(n,[{key:"initFacet",value:function(e,t){return wse(e)?Mce(e,(function(e,n,r){return tre([yae,bae],r)?void 0===n.field?(woe(toe(n,r)),e):(e[r]=ace(n,r,t),e):(woe(noe(r,"facet")),e)}),{}):{facet:ace(e,"facet",t)}}},{key:"channelHasField",value:function(e){return!!this.facet[e]}},{key:"fieldDef",value:function(e){return this.facet[e]}},{key:"parseData",value:function(){this.component.data=Qge(this),this.child.parseData()}},{key:"parseLayoutSize",value:function(){qge(this)}},{key:"parseSelections",value:function(){this.child.parseSelections(),this.component.selection=this.child.component.selection}},{key:"parseMarkGroup",value:function(){this.child.parseMarkGroup()}},{key:"parseAxesAndHeaders",value:function(){this.child.parseAxesAndHeaders(),function(e){var t,n=(0,Rt.Z)(iie);try{for(n.s();!(t=n.n()).done;)Pge(e,t.value)}catch(r){n.e(r)}finally{n.f()}Wge(e,"x"),Wge(e,"y")}(this)}},{key:"assembleSelectionTopLevelSignals",value:function(e){return this.child.assembleSelectionTopLevelSignals(e)}},{key:"assembleSignals",value:function(){return this.child.assembleSignals(),[]}},{key:"assembleSelectionData",value:function(e){return this.child.assembleSelectionData(e)}},{key:"getHeaderLayoutMixins",value:function(){var e,t,n,r,a={},i=(0,Rt.Z)(iie);try{for(i.s();!(r=i.n()).done;){var o,u=r.value,s=(0,Rt.Z)(lve);try{for(s.s();!(o=s.n()).done;){var c=o.value,l=this.component.layoutHeaders[u],f=l[c],d=l.facetFieldDef;if(d){var h=uve("titleOrient",d,this.config,u);if(tre(["right","bottom"],h)){var p=ove(u,h);a.titleAnchor=null!==(e=a.titleAnchor)&&void 0!==e?e:{},a.titleAnchor[p]="end"}}if(null===f||void 0===f?void 0:f[0]){var v="row"===u?"height":"width",m="header"===c?"headerBand":"footerBand";"facet"===u||this.child.component.layoutSize.get(v)||(a[m]=null!==(t=a[m])&&void 0!==t?t:{},a[m][u]=.5),l.title&&(a.offset=null!==(n=a.offset)&&void 0!==n?n:{},a.offset["row"===u?"rowTitle":"columnTitle"]=10)}}}catch(g){s.e(g)}finally{s.f()}}}catch(g){i.e(g)}finally{i.f()}return a}},{key:"assembleDefaultLayout",value:function(){var e=this.facet,t=e.column,n=e.row,r=t?this.columnDistinctSignal():n?1:void 0,a="all";return(n||"independent"!==this.component.resolve.scale.x)&&(t||"independent"!==this.component.resolve.scale.y)||(a="none"),Object.assign(Object.assign(Object.assign({},this.getHeaderLayoutMixins()),r?{columns:r}:{}),{bounds:"full",align:a})}},{key:"assembleLayoutSignals",value:function(){return this.child.assembleLayoutSignals()}},{key:"columnDistinctSignal",value:function(){if(!(this.parent&&this.parent instanceof n)){var e=this.getName("column_domain");return{signal:"length(data('".concat(e,"'))")}}}},{key:"assembleGroup",value:function(e){return this.parent&&this.parent instanceof n?Object.assign(Object.assign({},this.channelHasField("column")?{encode:{update:{columns:{field:Vse(this.facet.column,{prefix:"distinct"})}}}}:{}),(0,Ag.Z)((0,Eg.Z)(n.prototype),"assembleGroup",this).call(this,e)):(0,Ag.Z)((0,Eg.Z)(n.prototype),"assembleGroup",this).call(this,e)}},{key:"getCardinalityAggregateForChild",value:function(){var e=[],t=[],r=[];if(this.child instanceof n){if(this.child.channelHasField("column")){var a=Vse(this.child.facet.column);e.push(a),t.push("distinct"),r.push("distinct_".concat(a))}}else{var i,o=(0,Rt.Z)(xie);try{for(o.s();!(i=o.n()).done;){var u=i.value,s=this.child.component.scales[u];if(s&&!s.merged){var c=s.get("type"),l=s.get("range");if(Bue(c)&&Uoe(l)){var f=Qme(Jme(this.child,u));f?(e.push(f),t.push("distinct"),r.push("distinct_".concat(f))):woe("Unknown field for ".concat(u,". Cannot calculate view size."))}}}}catch(d){o.e(d)}finally{o.f()}}return{fields:e,ops:t,as:r}}},{key:"assembleFacet",value:function(){var e,t=this.component.data.facetRoot,n=t.name,r=t.data,a=this.facet,i=a.row,o=a.column,u=this.getCardinalityAggregateForChild(),s=u.fields,c=u.ops,l=u.as,f=[],d=(0,Rt.Z)(iie);try{for(d.s();!(e=d.n()).done;){var h=e.value,p=this.facet[h];if(p){f.push(Vse(p));var v=p.bin,m=p.sort;if(Rie(v)&&f.push(Vse(p,{binSuffix:"end"})),bse(m)){var g=m.field,y=m.op,b=void 0===y?vse:y,x=Xge(p,m);i&&o?(s.push(x),c.push("max"),l.push(x)):(s.push(g),c.push(b),l.push(x))}else if(kne(m)){var w=ive(p,h);s.push(w),c.push("max"),l.push(w)}}}}catch(_){d.e(_)}finally{d.f()}var k=!!i&&!!o;return Object.assign({name:n,data:r,groupby:f},k||s.length>0?{aggregate:Object.assign(Object.assign({},k?{cross:k}:{}),s.length?{fields:s,ops:c,as:l}:{})}:{})}},{key:"facetSortFields",value:function(e){var t=this.facet[e];return t?bse(t.sort)?[Xge(t,t.sort,{expr:"datum"})]:kne(t.sort)?[ive(t,e,{expr:"datum"})]:[Vse(t,{expr:"datum"})]:[]}},{key:"facetSortOrder",value:function(e){var t=this.facet[e];if(t){var n=t.sort;return[(bse(n)?n.order:!kne(n)&&n)||"ascending"]}return[]}},{key:"assembleLabelTitle",value:function(){var e=this.facet,t=this.config;if(e.facet)return mve(e.facet,"facet",t);var n,r={row:["top","bottom"],column:["left","right"]},a=(0,Rt.Z)(cve);try{for(a.s();!(n=a.n()).done;){var i=n.value;if(e[i]){var o=uve("labelOrient",e[i],t,i);if(tre(r[i],o))return mve(e[i],i,t)}}}catch(u){a.e(u)}finally{a.f()}}},{key:"assembleMarks",value:function(){var e=this,t=this.child,n=function(e){var t,n=[],r=zge(n),a=(0,Rt.Z)(e.children);try{for(a.s();!(t=a.n()).done;)r(t.value,{source:e.name,name:null,transform:[]})}catch(i){a.e(i)}finally{a.f()}return n}(this.component.data.facetRoot),r=t.assembleGroupEncodeEntry(!1),a=this.assembleLabelTitle()||t.assembleTitle(),i=t.assembleGroupStyle(),o=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:this.getName("cell"),type:"group"},a?{title:a}:{}),i?{style:i}:{}),{from:{facet:this.assembleFacet()},sort:{field:iie.map((function(t){return e.facetSortFields(t)})).flat(),order:iie.map((function(t){return e.facetSortOrder(t)})).flat()}}),n.length>0?{data:n}:{}),r?{encode:{update:r}}:{}),t.assembleGroup(function(e,t){if(e.component.selection&&lre(e.component.selection).length){var n=One(e.getName("cell"));t.unshift({name:"facet",value:{},on:[{events:une("mousemove","scope"),update:"isTuple(facet) ? facet : group(".concat(n,").datum")}]})}return Kde(t)}(this,[])));return[o]}},{key:"getMapping",value:function(){return this.facet}}]),n}(Sge);function Yge(e,t){var n,r,a,i,o,u,s,c,l,f,d,h=(0,Rt.Z)(t);try{for(h.s();!(d=h.n()).done;){var p=d.value,v=p.data;if((!e.name||!p.hasName()||e.name===p.dataName)&&((!(null===(n=e.format)||void 0===n?void 0:n.mesh)||!(null===(r=v.format)||void 0===r?void 0:r.feature))&&(!(null===(a=e.format)||void 0===a?void 0:a.feature)&&!(null===(i=v.format)||void 0===i?void 0:i.feature)||(null===(o=e.format)||void 0===o?void 0:o.feature)===(null===(u=v.format)||void 0===u?void 0:u.feature))&&(!(null===(s=e.format)||void 0===s?void 0:s.mesh)&&!(null===(c=v.format)||void 0===c?void 0:c.mesh)||(null===(l=e.format)||void 0===l?void 0:l.mesh)===(null===(f=v.format)||void 0===f?void 0:f.mesh))))if(xfe(e)&&xfe(v)){if(Xne(e.values,v.values))return p}else if(bfe(e)&&bfe(v)){if(e.url===v.url)return p}else if(wfe(e)&&e.name===p.dataName)return p}}catch(m){h.e(m)}finally{h.f()}return null}function $ge(e,t){if(e.data||!e.parent){if(null===e.data){var n=new rme({values:[]});return t.push(n),n}var r=Yge(e.data,t);if(r)return kfe(e.data)||(r.data.format=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];for(var a=0,i=n;a<i.length;a++){var o=i[a];are(e,null!==o&&void 0!==o?o:{})}return e}({},e.data.format,r.data.format)),!r.hasName()&&e.data.name&&(r.dataName=e.data.name),r;var a=new rme(e.data);return t.push(a),a}return e.parent.component.data.facetRoot?e.parent.component.data.facetRoot:e.parent.component.data.main}function Qge(e){var t,n,r,a,i,o,u,s,c,l,f=$ge(e,e.component.data.sources),d=e.component.data,h=d.outputNodes,p=d.outputNodeRefCounts,v=e.parent?e.parent.component.data.ancestorParse.clone():new yfe,m=e.data;kfe(m)?(_fe(m)?f=new ome(f,m.sequence):Cfe(m)&&(f=new ime(f,m.graticule)),v.parseNothing=!0):null===(null===(t=null===m||void 0===m?void 0:m.format)||void 0===t?void 0:t.parse)&&(v.parseNothing=!0),f=null!==(n=yme.makeExplicit(f,e,v))&&void 0!==n?n:f,f=new bme(f);var g=e.parent&&kge(e.parent);(bge(e)||xge(e))&&g&&(f=null!==(r=nme.makeFromEncoding(f,e))&&void 0!==r?r:f),e.transforms.length>0&&(f=function(e,t,n){var r,a,i,o=0,u=(0,Rt.Z)(t.transforms);try{for(u.s();!(i=u.n()).done;){var s=i.value,c=void 0,l=void 0;if(Zfe(s))l=e=new ave(e,s),c="derived";else if(Nfe(s)){var f=mme(s);l=e=null!==(r=yme.makeWithAncestors(e,{},f,n))&&void 0!==r?r:e,e=new Bpe(e,t,s.filter)}else if(Lfe(s))l=e=nme.makeFromTransform(e,s,t),c="number";else if(Ufe(s))c="date",void 0===n.getWithExplicit(s.field).value&&(e=new yme(e,(0,Xn.Z)({},s.field,c)),n.set(s.field,c,!1)),l=e=_de.makeFromTransform(e,s);else if(Wfe(s))l=e=dme.makeFromTransform(e,s),c="number",fhe(t)&&(e=new bme(e));else if(Tfe(s))l=e=Mge.make(e,t,s,o++),c="derived";else if(jfe(s))l=e=new kme(e,s),c="number";else if(Bfe(s))l=e=new xme(e,s),c="number";else if(Vfe(s))l=e=wme.makeFromTransform(e,s),c="derived";else if(qfe(s))l=e=new Nge(e,s),c="derived";else if(zfe(s))l=e=new Ege(e,s),c="derived";else if(Ife(s))l=e=new jge(e,s),c="derived";else if(Rfe(s))e=new Bge(e,s);else if(Pfe(s))l=e=Dge.makeFromTransform(e,s),c="derived";else if(Dfe(s))l=e=new Cge(e,s),c="derived";else if(Ffe(s))l=e=new Oge(e,s),c="derived";else if(Mfe(s))l=e=new Rge(e,s),c="derived";else{if(!Ofe(s)){woe($ie(s));continue}l=e=new Fge(e,s),c="derived"}if(l&&void 0!==c){var d,h=(0,Rt.Z)(null!==(a=l.producedFields())&&void 0!==a?a:[]);try{for(h.s();!(d=h.n()).done;){var p=d.value;n.set(p,c,!1)}}catch(v){h.e(v)}finally{h.f()}}}}catch(v){u.e(v)}finally{u.f()}return e}(f,e,v));var y=function(e){var t={};if(bge(e)&&e.component.selection){var n,r=(0,Rt.Z)(lre(e.component.selection));try{for(r.s();!(n=r.n()).done;){var a,i=n.value,o=e.component.selection[i],u=(0,Rt.Z)(o.project.items);try{for(u.s();!(a=u.n()).done;){var s=a.value;!s.channel&&Sre(s.field)>1&&(t[s.field]="flatten")}}catch(c){u.e(c)}finally{u.f()}}}catch(c){r.e(c)}finally{r.f()}}return t}(e),b=gme(e);f=null!==(a=yme.makeWithAncestors(f,{},Object.assign(Object.assign({},y),b),v))&&void 0!==a?a:f,bge(e)&&(f=Tge.parseAll(f,e),f=Ige.parseAll(f,e)),(bge(e)||xge(e))&&(g||(f=null!==(i=nme.makeFromEncoding(f,e))&&void 0!==i?i:f),f=null!==(o=_de.makeFromEncoding(f,e))&&void 0!==o?o:f,f=ave.parseAllForSortIndex(f,e));var x=e.getName(Efe),w=new kde(f,x,Efe,p);if(h[x]=w,f=w,bge(e)){var k=dme.makeFromEncoding(f,e);k&&(f=k,fhe(e)&&(f=new bme(f))),f=null!==(u=Dge.makeFromEncoding(f,e))&&void 0!==u?u:f,f=null!==(s=wme.makeFromEncoding(f,e))&&void 0!==s?s:f}bge(e)&&(f=null!==(c=Age.make(f,e))&&void 0!==c?c:f);var _=e.getName(Afe),S=new kde(f,_,Afe,p);h[_]=S,f=S,bge(e)&&function(e,t){she(e,(function(n){var r=n.name,a=e.getName("lookup_".concat(r));e.component.data.outputNodes[a]=n.materialized=new kde(new Bpe(t,e,{selection:r}),a,"lookup",e.component.data.outputNodeRefCounts)}))}(e,S);var C=null;if(xge(e)){var A=e.getName("facet");f=null!==(l=function(e,t){var n=t.row,r=t.column;if(n&&r){for(var a=null,i=0,o=[n,r];i<o.length;i++){var u=o[i];if(bse(u.sort)){var s=u.sort,c=s.field,l=s.op;e=a=new xme(e,{joinaggregate:[{op:void 0===l?vse:l,field:c,as:Xge(u,u.sort,{forAs:!0})}],groupby:[Vse(u)]})}}return a}return null}(f,e.facet))&&void 0!==l?l:f,C=new hme(f,e,A,S.getSource()),h[A]=C}return Object.assign(Object.assign({},e.component.data),{outputNodes:h,outputNodeRefCounts:p,raw:w,main:S,facetRoot:C,ancestorParse:v})}var Jge=function(e){(0,Ng.Z)(n,e);var t=(0,Tg.Z)(n);function n(e,r,a,i){var o,u,s,c,l;return(0,op.Z)(this,n),o=t.call(this,e,"concat",r,a,i,e.resolve),"shared"!==(null===(s=null===(u=e.resolve)||void 0===u?void 0:u.axis)||void 0===s?void 0:s.x)&&"shared"!==(null===(l=null===(c=e.resolve)||void 0===c?void 0:c.axis)||void 0===l?void 0:l.y)||woe("Axes cannot be shared in concatenated or repeated views yet (https://github.com/vega/vega-lite/issues/2415)."),o.children=o.getChildren(e).map((function(e,t){return Aye(e,(0,Cg.Z)(o),o.getName("concat_"+t),void 0,i)})),o}return(0,up.Z)(n,[{key:"parseData",value:function(){this.component.data=Qge(this);var e,t=(0,Rt.Z)(this.children);try{for(t.s();!(e=t.n()).done;){e.value.parseData()}}catch(n){t.e(n)}finally{t.f()}}},{key:"parseSelections",value:function(){this.component.selection={};var e,t=(0,Rt.Z)(this.children);try{for(t.s();!(e=t.n()).done;){var n=e.value;n.parseSelections();var r,a=(0,Rt.Z)(lre(n.component.selection));try{for(a.s();!(r=a.n()).done;){var i=r.value;this.component.selection[i]=n.component.selection[i]}}catch(o){a.e(o)}finally{a.f()}}}catch(o){t.e(o)}finally{t.f()}}},{key:"parseMarkGroup",value:function(){var e,t=(0,Rt.Z)(this.children);try{for(t.s();!(e=t.n()).done;){e.value.parseMarkGroup()}}catch(n){t.e(n)}finally{t.f()}}},{key:"parseAxesAndHeaders",value:function(){var e,t=(0,Rt.Z)(this.children);try{for(t.s();!(e=t.n()).done;){e.value.parseAxesAndHeaders()}}catch(n){t.e(n)}finally{t.f()}}},{key:"getChildren",value:function(e){return hle(e)?e.vconcat:ple(e)?e.hconcat:e.concat}},{key:"parseLayoutSize",value:function(){Vge(this)}},{key:"parseAxisGroup",value:function(){return null}},{key:"assembleSelectionTopLevelSignals",value:function(e){return this.children.reduce((function(e,t){return t.assembleSelectionTopLevelSignals(e)}),e)}},{key:"assembleSignals",value:function(){return this.children.forEach((function(e){return e.assembleSignals()})),[]}},{key:"assembleLayoutSignals",value:function(){var e,t=wve(this),n=(0,Rt.Z)(this.children);try{for(n.s();!(e=n.n()).done;){var r=e.value;t.push.apply(t,(0,cn.Z)(r.assembleLayoutSignals()))}}catch(a){n.e(a)}finally{n.f()}return t}},{key:"assembleSelectionData",value:function(e){return this.children.reduce((function(e,t){return t.assembleSelectionData(e)}),e)}},{key:"assembleMarks",value:function(){return this.children.map((function(e){var t=e.assembleTitle(),n=e.assembleGroupStyle(),r=e.assembleGroupEncodeEntry(!1);return Object.assign(Object.assign(Object.assign(Object.assign({type:"group",name:e.getName("group")},t?{title:t}:{}),n?{style:n}:{}),r?{encode:{update:r}}:{}),e.assembleGroup())}))}},{key:"assembleDefaultLayout",value:function(){var e=this.layout.columns;return Object.assign(Object.assign({},null!=e?{columns:e}:{}),{bounds:"full",align:"each"})}}]),n}(_ge);var eye=Object.assign(Object.assign({disable:1,gridScale:1,scale:1},Ore),{labelExpr:1,encode:1}),tye=lre(eye),nye=function(e){(0,Ng.Z)(n,e);var t=(0,Tg.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return(0,op.Z)(this,n),(e=t.call(this)).explicit=r,e.implicit=a,e.mainExtracted=i,e}return(0,up.Z)(n,[{key:"clone",value:function(){return new n(Kne(this.explicit),Kne(this.implicit),this.mainExtracted)}},{key:"hasAxisPart",value:function(e){return"axis"===e||("grid"===e||"title"===e?!!this.get(e):!(!1===(t=this.get(e))||null===t));var t}},{key:"hasOrientSignalRef",value:function(){return Poe(this.explicit.orient)}}]),n}(dfe);var rye={bottom:"top",top:"bottom",left:"right",right:"left"};function aye(e,t){if(!e)return t.map((function(e){return e.clone()}));if(e.length===t.length){for(var n=e.length,r=0;r<n;r++){var a=e[r],i=t[r];if(!!a!==!!i)return;if(a&&i){var o=a.getWithExplicit("orient"),u=i.getWithExplicit("orient");if(o.explicit&&u.explicit&&o.value!==u.value)return;e[r]=iye(a,i)}}return e}}function iye(e,t){var n,r=(0,Rt.Z)(tye);try{var a=function(){var r=n.value,a=gfe(e.getWithExplicit(r),t.getWithExplicit(r),r,"axis",(function(e,t){switch(r){case"title":return Ace(e,t);case"gridScale":return{explicit:e.explicit,value:Cre(e.value,t.value)}}return mfe(e,t,r,"axis")}));e.setWithExplicit(r,a)};for(r.s();!(n=r.n()).done;)a()}catch(i){r.e(i)}finally{r.f()}return e}function oye(e,t,n,r,a){if("disable"===t)return void 0!==n;switch(n=n||{},t){case"titleAngle":case"labelAngle":return e===(Poe(n.labelAngle)?n.labelAngle:Nre(n.labelAngle));case"values":return!!n.values;case"encode":return!!n.encoding||!!n.labelAngle;case"title":if(e===rve(r,a))return!0}return e===n[t]}var uye=new Set(["grid","translate","format","formatType","orient","labelExpr","tickCount","position","tickMinStep"]);function sye(e,t){var n,r,a,i=t.axis(e),o=new nye,u=rce(t.encoding[e]),s=t.mark,c=t.config,l=(null===i||void 0===i?void 0:i.orient)||(null===(n=c["x"===e?"axisX":"axisY"])||void 0===n?void 0:n.orient)||(null===(r=c.axis)||void 0===r?void 0:r.orient)||function(e){return"x"===e?"bottom":"left"}(e),f=t.getScaleComponent(e).get("type"),d=Ype(e,f,l,t.config),h=void 0!==i?!i:Qpe("disable",c,null===i||void 0===i?void 0:i.style,d).configValue;if(o.set("disable",h,void 0!==i),h)return o;var p,v=function(e,t,n,r,a){var i=null===t||void 0===t?void 0:t.labelAngle;if(void 0!==i)return Poe(i)?i:Nre(i);var o=Qpe("labelAngle",e.config,null===t||void 0===t?void 0:t.style,a).configValue;return void 0!==o?Nre(o):n===wae&&tre([fue,cue],r.type)?270:void 0}(t,i=i||{},e,u,d),m={fieldOrDatumDef:u,axis:i,channel:e,model:t,scaleType:f,orient:l,labelAngle:v,mark:s,config:c},g=(0,Rt.Z)(tye);try{for(g.s();!(p=g.n()).done;){var y=p.value,b=y in Jpe?Jpe[y](m):jre(y)?i[y]:void 0,x=void 0!==b,w=oye(b,y,i,t,e);if(x&&w)o.set(y,b,w);else{var k=jre(y)&&"values"!==y?Qpe(y,t.config,i.style,d):{},_=k.configValue,S=void 0===_?void 0:_,C=k.configFrom,A=void 0===C?void 0:C,E=void 0!==S;x&&!E?o.set(y,b,w):("vgAxisConfig"!==A||uye.has(y)&&E||Dre(S)||Poe(S))&&o.set(y,S,!1)}}}catch(I){g.e(I)}finally{g.f()}var N=null!==(a=i.encoding)&&void 0!==a?a:{},T=Fre.reduce((function(n,r){var a;if(!o.hasAxisPart(r))return n;var i=Ave(null!==(a=N[r])&&void 0!==a?a:{},t),u="labels"===r?function(e,t,n){var r,a=e.encoding,i=e.config,o=null!==(r=rce(a[t]))&&void 0!==r?r:rce(a[vie(t)]),u=e.axis(t)||{},s=u.format,c=u.formatType;return ase(c)?Object.assign({text:sse({fieldOrDatumDef:o,field:"datum.value",format:s,formatType:c,config:i})},n):n}(t,e,i):i;return void 0===u||cre(u)||(n[r]={update:u}),n}),{});return cre(T)||o.set("encode",T,!!i.encoding||void 0!==i.labelAngle),o}function cye(e){var t,n=e.encoding,r=e.size,a=(0,Rt.Z)(xie);try{for(a.s();!(t=a.n()).done;){var i=t.value,o=mie(i);vle(r[o])&&Ose(n[i])&&(delete r[o],woe(coe(o)))}}catch(u){a.e(u)}finally{a.f()}return r}function lye(e,t,n,r){var a,i,o=r.graticule,u=tae(e)?Object.assign({},e):{type:e},s=bce("orient",u,n);if(u.orient=function(e,t,n){switch(e){case Wre:case Kre:case Yre:case Gre:case Vre:case Pre:return}var r=t.x,a=t.y,i=t.x2,o=t.y2;switch(e){case Lre:if(Dse(r)&&(jie(r.bin)||Dse(a)&&a.aggregate&&!r.aggregate))return"vertical";if(Dse(a)&&(jie(a.bin)||Dse(r)&&r.aggregate&&!a.aggregate))return"horizontal";if(o||i){if(n)return n;if(!i&&(Dse(r)&&r.type===sue&&!Rie(r.bin)||Rse(r)))return"horizontal";if(!o&&(Dse(a)&&a.type===sue&&!Rie(a.bin)||Rse(a)))return"vertical"}case qre:if(i&&(!Dse(r)||!jie(r.bin))&&o&&(!Dse(a)||!jie(a.bin)))return;case Zre:if(o)return Dse(a)&&jie(a.bin)?"horizontal":"vertical";if(i)return Dse(r)&&jie(r.bin)?"vertical":"horizontal";if(e===qre){if(r&&!a)return"vertical";if(a&&!r)return"horizontal"}case Ure:case Hre:var u=Ose(r),s=Ose(a);if(u&&!s)return"tick"!==e?"horizontal":"vertical";if(!u&&s)return"tick"!==e?"vertical":"horizontal";if(u&&s){var c=r,l=a,f=c.type===lue,d=l.type===lue;return f&&!d?"tick"!==e?"vertical":"horizontal":!f&&d?"tick"!==e?"horizontal":"vertical":!c.aggregate&&l.aggregate?"tick"!==e?"vertical":"horizontal":c.aggregate&&!l.aggregate?"tick"!==e?"horizontal":"vertical":n||"vertical"}return n||void 0}return"vertical"}(u.type,t,s),void 0!==s&&s!==u.orient&&woe((a=u.orient,i=s,'Specified orient "'.concat(a,'" overridden with "').concat(i,'".'))),"bar"===u.type&&u.orient){var c=bce("cornerRadiusEnd",u,n);if(void 0!==c){var l,f="horizontal"===u.orient&&t.x2||"vertical"===u.orient&&t.y2?["cornerRadius"]:aae[u.orient],d=(0,Rt.Z)(f);try{for(d.s();!(l=d.n()).done;){u[l.value]=c}}catch(h){d.e(h)}finally{d.f()}void 0!==u.cornerRadiusEnd&&delete u.cornerRadiusEnd}}return void 0===bce("opacity",u,n)&&(u.opacity=function(e,t){if(tre([Wre,Hre,Kre,Yre],e)&&!Nce(t))return.7;return}(u.type,t)),void 0===u.filled&&(u.filled=!o&&function(e,t){var n=xce("filled",e,t),r=e.type;return Cre(n,r!==Wre&&r!==Ure&&r!==qre)}(u,n)),void 0===bce("cursor",u,n)&&(u.cursor=function(e,t,n){if(t.href||e.href||bce("href",e,n))return"pointer";return e.cursor}(u,t,n)),u}function fye(e,t){e.config;return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},pde(e,{align:"ignore",baseline:"ignore",color:"include",size:"include",orient:"ignore",theta:"ignore"})),nde("x",e,{defaultPos:"mid"})),nde("y",e,{defaultPos:"mid"})),Jfe("size",e)),Jfe("angle",e)),function(e,t,n){if(n)return{shape:{value:n}};return Jfe("shape",e)}(e,0,t))}var dye={vgMark:"rule",encodeEntry:function(e){var t=e.markDef.orient;return e.encoding.x||e.encoding.y||e.encoding.latitude||e.encoding.longitude?Object.assign(Object.assign(Object.assign(Object.assign({},pde(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"})),ude("x",e,{defaultPos:"horizontal"===t?"zeroOrMax":"mid",defaultPos2:"zeroOrMin",range:"vertical"!==t})),ude("y",e,{defaultPos:"vertical"===t?"zeroOrMax":"mid",defaultPos2:"zeroOrMin",range:"horizontal"!==t})),Jfe("size",e,{vgChannel:"strokeWidth"})):{}}};var hye={vgMark:"rect",encodeEntry:function(e){var t=e.config,n=e.markDef,r=n.orient,a="horizontal"===r?"width":"height",i="horizontal"===r?"height":"width";return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},pde(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"})),nde("x",e,{defaultPos:"mid",vgChannel:"xc"})),nde("y",e,{defaultPos:"mid",vgChannel:"yc"})),Jfe("size",e,{defaultValue:pye(e),vgChannel:a})),(0,Xn.Z)({},i,vce(bce("thickness",n,t))))}};function pye(e){var t,n=e.config,r=e.markDef,a=r.orient,i="horizontal"===a?"width":"height",o=e.getScaleComponent("horizontal"===a?"x":"y"),u=null!==(t=bce("size",r,n,{vgChannel:i}))&&void 0!==t?t:n.tick.bandSize;if(void 0!==u)return u;var s=o?o.get("range"):void 0;return s&&Uoe(s)&&Fne(s.step)?3*s.step/4:3*ble(n.view,i)/4}var vye={arc:{vgMark:"arc",encodeEntry:function(e){return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},pde(e,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"})),nde("x",e,{defaultPos:"mid"})),nde("y",e,{defaultPos:"mid"})),lde(e,"radius","arc")),lde(e,"theta","arc"))}},area:{vgMark:"area",encodeEntry:function(e){return Object.assign(Object.assign(Object.assign(Object.assign({},pde(e,{align:"ignore",baseline:"ignore",color:"include",orient:"include",size:"ignore",theta:"ignore"})),ude("x",e,{defaultPos:"zeroOrMin",defaultPos2:"zeroOrMin",range:"horizontal"===e.markDef.orient})),ude("y",e,{defaultPos:"zeroOrMin",defaultPos2:"zeroOrMin",range:"vertical"===e.markDef.orient})),mde(e))}},bar:{vgMark:"rect",encodeEntry:function(e){return Object.assign(Object.assign(Object.assign({},pde(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"})),lde(e,"x","bar")),lde(e,"y","bar"))}},circle:{vgMark:"symbol",encodeEntry:function(e){return fye(e,"circle")}},geoshape:{vgMark:"shape",encodeEntry:function(e){return Object.assign({},pde(e,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"}))},postEncodingTransform:function(e){var t=e.encoding.shape;return[Object.assign({type:"geoshape",projection:e.projectionName()},t&&Dse(t)&&t.type===due?{field:Vse(t,{expr:"datum"})}:{})]}},image:{vgMark:"image",encodeEntry:function(e){return Object.assign(Object.assign(Object.assign(Object.assign({},pde(e,{align:"ignore",baseline:"ignore",color:"ignore",orient:"ignore",size:"ignore",theta:"ignore"})),lde(e,"x","image")),lde(e,"y","image")),Hfe(e,"url"))}},line:{vgMark:"line",encodeEntry:function(e){return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},pde(e,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"})),nde("x",e,{defaultPos:"mid"})),nde("y",e,{defaultPos:"mid"})),Jfe("size",e,{vgChannel:"strokeWidth"})),mde(e))}},point:{vgMark:"symbol",encodeEntry:function(e){return fye(e)}},rect:{vgMark:"rect",encodeEntry:function(e){return Object.assign(Object.assign(Object.assign({},pde(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"})),lde(e,"x","rect")),lde(e,"y","rect"))}},rule:dye,square:{vgMark:"symbol",encodeEntry:function(e){return fye(e,"square")}},text:{vgMark:"text",encodeEntry:function(e){var t=e.config;e.encoding;return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},pde(e,{align:"include",baseline:"include",color:"include",size:"ignore",orient:"ignore",theta:"include"})),nde("x",e,{defaultPos:"mid"})),nde("y",e,{defaultPos:"mid"})),Hfe(e)),Jfe("size",e,{vgChannel:"fontSize"})),Jfe("angle",e)),gde("align",function(e,t,n){if(void 0===bce("align",e,n))return"center";return}(e.markDef,0,t))),gde("baseline",function(e,t,n){if(void 0===bce("baseline",e,n))return"middle";return}(e.markDef,0,t))),nde("radius",e,{defaultPos:null,isMidPoint:!0})),nde("theta",e,{defaultPos:null,isMidPoint:!0}))}},tick:hye,trail:{vgMark:"trail",encodeEntry:function(e){return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},pde(e,{align:"ignore",baseline:"ignore",color:"include",size:"include",orient:"ignore",theta:"ignore"})),nde("x",e,{defaultPos:"mid"})),nde("y",e,{defaultPos:"mid"})),Jfe("size",e)),mde(e))}}};function mye(e){return tre([Ure,Zre,Xre],e.mark)?function(e){var t=Oce(e.mark,e.encoding),n=xye(e,{fromPrefix:t.length>0?gye:""});return t.length>0?[{name:e.getName("pathgroup"),type:"group",from:{facet:{name:gye+e.requestDataName(Afe),data:e.requestDataName(Afe),groupby:t}},encode:{update:{width:{field:{group:"width"}},height:{field:{group:"height"}}}},marks:n}]:n}(e):tre([Lre],e.mark)?function(e){var t=Goe.some((function(t){return bce(t,e.markDef,e.config)}));if(e.stack&&!e.fieldDef("size")&&t){var n,r,a=xye(e,{fromPrefix:yye}),i=(0,Cn.Z)(a,1)[0],o=e.scaleName(e.stack.fieldChannel),u=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e.vgField(e.stack.fieldChannel,t)},s=function(e,t){var n=[u({prefix:"min",suffix:"start",expr:t}),u({prefix:"max",suffix:"start",expr:t}),u({prefix:"min",suffix:"end",expr:t}),u({prefix:"max",suffix:"end",expr:t})];return"".concat(e,"(").concat(n.map((function(e){return"scale('".concat(o,"',").concat(e,")")})).join(","),")")};"x"===e.stack.fieldChannel?(n=Object.assign(Object.assign({},Yne(i.encode.update,["y","yc","y2","height"].concat((0,cn.Z)(Goe)))),{x:{signal:s("min","datum")},x2:{signal:s("max","datum")},clip:{value:!0}}),r={x:{field:{group:"x"},mult:-1},height:{field:{group:"height"}}},i.encode.update=Object.assign(Object.assign({},$ne(i.encode.update,["y","yc","y2"])),{height:{field:{group:"height"}}})):(n=Object.assign(Object.assign({},Yne(i.encode.update,["x","xc","x2","width"])),{y:{signal:s("min","datum")},y2:{signal:s("max","datum")},clip:{value:!0}}),r={y:{field:{group:"y"},mult:-1},width:{field:{group:"width"}}},i.encode.update=Object.assign(Object.assign({},$ne(i.encode.update,["x","xc","x2"])),{width:{field:{group:"width"}}}));var c,l=(0,Rt.Z)(Goe);try{for(l.s();!(c=l.n()).done;){var f=c.value,d=xce(f,e.markDef,e.config);i.encode.update[f]?(n[f]=i.encode.update[f],delete i.encode.update[f]):d&&(n[f]=vce(d)),d&&(i.encode.update[f]={value:0})}}catch(v){l.e(v)}finally{l.f()}var h=e.fieldDef(e.stack.groupbyChannel),p=Vse(h)?[Vse(h)]:[];return((null===h||void 0===h?void 0:h.bin)||(null===h||void 0===h?void 0:h.timeUnit))&&p.push(Vse(h,{binSuffix:"end"})),n=["stroke","strokeWidth","strokeJoin","strokeCap","strokeDash","strokeDashOffset","strokeMiterLimit","strokeOpacity"].reduce((function(t,n){if(i.encode.update[n])return Object.assign(Object.assign({},t),(0,Xn.Z)({},n,i.encode.update[n]));var r=xce(n,e.markDef,e.config);return void 0!==r?Object.assign(Object.assign({},t),(0,Xn.Z)({},n,vce(r))):t}),n),n.stroke&&(n.strokeForeground={value:!0},n.strokeOffset={value:0}),[{type:"group",from:{facet:{data:e.requestDataName(Afe),name:yye+e.requestDataName(Afe),groupby:p,aggregate:{fields:[u({suffix:"start"}),u({suffix:"start"}),u({suffix:"end"}),u({suffix:"end"})],ops:["min","max","min","max"]}}},encode:{update:n},marks:[{type:"group",encode:{update:r},marks:[i]}]}]}return xye(e)}(e):xye(e)}var gye="faceted_path_";var yye="stack_group_";function bye(e){var t=e.encoding,n=e.stack,r=e.mark,a=e.markDef,i=e.config,o=t.order;if(!(!kne(o)&&zse(o)&&ere(o.value)||!o&&ere(bce("order",a,i)))){if((kne(o)||Dse(o))&&!n)return _ce(o,{expr:"datum"});if(Qre(r)){var u="horizontal"===a.orient?"y":"x",s=t[u];if(Dse(s)){var c=s.sort;return kne(c)?{field:Vse(s,{prefix:u,suffix:"sort_index",expr:"datum"})}:bse(c)?{field:Vse({aggregate:Nce(e.encoding)?c.op:void 0,field:c.field},{expr:"datum"})}:yse(c)?{field:Vse(e.fieldDef(c.encoding),{expr:"datum"}),order:c.order}:null===c?void 0:{field:Vse(s,{binSuffix:e.stack&&e.stack.impute?"mid":void 0,expr:"datum"})}}}else;}}function xye(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{fromPrefix:""},n=e.mark,r=e.markDef,a=e.config,i=Cre(r.clip,wye(e),kye(e)),o=yce(r),u=e.encoding.key,s=bye(e),c=_ye(e),l=bce("aria",r,a),f=vye[n].postEncodingTransform?vye[n].postEncodingTransform(e):null;return[Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:e.getName("marks"),type:vye[n].vgMark},i?{clip:!0}:{}),o?{style:o}:{}),u?{key:u.field}:{}),s?{sort:s}:{}),c||{}),!1===l?{aria:l}:{}),{from:{data:t.fromPrefix+e.requestDataName(Afe)},encode:{update:vye[n].encodeEntry(e)}}),f?{transform:f}:{})]}function wye(e){var t=e.getScaleComponent("x"),n=e.getScaleComponent("y");return!!(t&&t.get("selectionExtent")||n&&n.get("selectionExtent"))||void 0}function kye(e){var t=e.component.projection;return!(!t||t.isFit)||void 0}function _ye(e){if(!e.component.selection)return null;for(var t=lre(e.component.selection).length,n=t,r=e.parent;r&&0===n;)n=lre(r.component.selection).length,r=r.parent;return n?{interactive:t>0}:null}var Sye=function(e){(0,Ng.Z)(n,e);var t=(0,Tg.Z)(n);function n(e,r,a){var i,o,u,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},c=arguments.length>4?arguments[4]:void 0;(0,op.Z)(this,n),(i=t.call(this,e,"unit",r,a,c,void 0,mle(e)?e.view:void 0)).specifiedScales={},i.specifiedAxes={},i.specifiedLegends={},i.specifiedProjection={},i.selection={},i.children=[];var l=tae(e.mark)?e.mark.type:e.mark;i.markDef=lye(e.mark,null!==(o=e.encoding)&&void 0!==o?o:{},c,{graticule:e.data&&Cfe(e.data)});var f=i.encoding=Ice(null!==(u=e.encoding)&&void 0!==u?u:{},i.markDef,c);return i.size=cye({encoding:f,size:mle(e)?Object.assign(Object.assign(Object.assign({},s),e.width?{width:e.width}:{}),e.height?{height:e.height}:{}):s}),i.stack=Wle(l,f),i.specifiedScales=i.initScales(l,f),i.specifiedAxes=i.initAxes(f),i.specifiedLegends=i.initLegend(f),i.specifiedProjection=e.projection,i.selection=e.selection,i}return(0,up.Z)(n,[{key:"hasProjection",get:function(){var e=this.encoding,t=this.mark===$re,n=e&&tie.some((function(t){return jse(e[t])}));return t||n}},{key:"scaleDomain",value:function(e){var t=this.specifiedScales[e];return t?t.domain:void 0}},{key:"axis",value:function(e){return this.specifiedAxes[e]}},{key:"legend",value:function(e){return this.specifiedLegends[e]}},{key:"initScales",value:function(e,t){return Nie.reduce((function(e,n){var r,a=rce(t[n]);return a&&(e[n]=null!==(r=a.scale)&&void 0!==r?r:{}),e}),{})}},{key:"initAxes",value:function(e){return xie.reduce((function(t,n){var r=e[n];if(jse(r)||n===wae&&jse(e.x2)||n===kae&&jse(e.y2)){var a=jse(r)?r.axis:void 0;t[n]=a?Object.assign({},a):a}return t}),{})}},{key:"initLegend",value:function(e){return Aie.reduce((function(t,n){var r=rce(e[n]);if(r&&function(e){switch(e){case Mae:case Oae:case Rae:case Bae:case jae:case Zae:case Uae:case Wae:return!0;case Lae:case Pae:case zae:return!1}}(n)){var a=r.legend;t[n]=a?Object.assign({},a):a}return t}),{})}},{key:"parseData",value:function(){this.component.data=Qge(this)}},{key:"parseLayoutSize",value:function(){!function(e){var t,n=e.size,r=e.component,a=(0,Rt.Z)(xie);try{for(a.s();!(t=a.n()).done;){var i=mie(t.value);if(n[i]){var o=n[i];r.layoutSize.set(i,vle(o)?"step":o,!0)}else{var u=Hge(e,i);r.layoutSize.set(i,u,!1)}}}catch(s){a.e(s)}finally{a.f()}}(this)}},{key:"parseSelections",value:function(){this.component.selection=function(e,t){var n,r,a={},i=e.config.selection,o=(0,Rt.Z)(lre(null!==t&&void 0!==t?t:{}));try{var u=function(){var o=r.value,u=Kne(t[o]),s=i[u.type],c=(s.fields,s.encodings,jne(s,["fields","encodings"]));for(var l in c)"encodings"===l&&u.fields||"fields"===l&&u.encodings||("mark"===l&&(u[l]=Object.assign(Object.assign({},c[l]),u[l])),void 0!==u[l]&&!0!==u[l]||(u[l]=null!==(n=c[l])&&void 0!==n?n:u[l]));var f=pre(o),d=a[f]=Object.assign(Object.assign({},u),{name:f,events:Mne(u.on)?une(u.on,"scope"):Kne(u.on)});Gde(d,(function(n){n.has(d)&&n.parse&&n.parse(e,d,u,t[o])}))};for(o.s();!(r=o.n()).done;)u()}catch(s){o.e(s)}finally{o.f()}return a}(this,this.selection)}},{key:"parseMarkGroup",value:function(){this.component.mark=mye(this)}},{key:"parseAxesAndHeaders",value:function(){var e;this.component.axes=(e=this,xie.reduce((function(t,n){return e.component.scales[n]&&(t[n]=[sye(n,e)]),t}),{}))}},{key:"assembleSelectionTopLevelSignals",value:function(e){return function(e,t){var n=!1;if(she(e,(function(r,a){var i=r.name,o=One(i+rhe),u=t.filter((function(e){return e.name===i}));if(0===u.length){var s="global"===r.resolve?"union":r.resolve,c="multi"===r.type?", true)":")";t.push({name:r.name,update:"".concat(ohe,"(").concat(o,", ").concat(One(s)).concat(c)})}n=!0,a.topLevelSignals&&(t=a.topLevelSignals(e,r,t)),Gde(r,(function(n){n.topLevelSignals&&(t=n.topLevelSignals(e,r,t))}))})),n){var r=t.filter((function(e){return"unit"===e.name}));0===r.length&&t.unshift({name:"unit",value:{},on:[{events:"mousemove",update:"isTuple(group()) ? group() : unit"}]})}return Kde(t)}(this,e)}},{key:"assembleSignals",value:function(){return[].concat((0,cn.Z)(Vpe(this)),(0,cn.Z)((t=[],she(e=this,(function(n,r){var a,i=n.name,o=r.modifyExpr(e,n);(a=t).push.apply(a,(0,cn.Z)(r.signals(e,n))),Gde(n,(function(r){r.signals&&(t=r.signals(e,n,t)),r.modifyExpr&&(o=r.modifyExpr(e,n,o))})),t.push({name:i+ihe,on:[{events:{signal:n.name+ahe},update:"modify(".concat(One(n.name+rhe),", ").concat(o,")")}]})})),Kde(t))));var e,t}},{key:"assembleSelectionData",value:function(e){return function(e,t){var n=(0,cn.Z)(t);return she(e,(function(t){var r={name:t.name+rhe};if(t.init){var a=t.project.items.map((function(e){return e.signals,jne(e,["signals"])})),i=t.init.map((function(e){return Hde(e,!1)}));r.values="interval"===t.type?[{unit:lhe(e,{escape:!1}),fields:a,values:i}]:i.map((function(t){return{unit:lhe(e,{escape:!1}),fields:a,values:t}}))}n.filter((function(e){return e.name===t.name+rhe})).length||n.push(r)})),n}(this,e)}},{key:"assembleLayout",value:function(){return null}},{key:"assembleLayoutSignals",value:function(){return wve(this)}},{key:"assembleMarks",value:function(){var e,t=null!==(e=this.component.mark)&&void 0!==e?e:[];return this.parent&&kge(this.parent)||(t=Xde(this,t)),t.map(this.correctDataNames)}},{key:"getMapping",value:function(){return this.encoding}},{key:"mark",get:function(){return this.markDef.type}},{key:"channelHasField",value:function(e){return Ece(this.encoding,e)}},{key:"fieldDef",value:function(e){return nce(this.encoding[e])}},{key:"typedFieldDef",value:function(e){var t=this.fieldDef(e);return Bse(t)?t:null}}]),n}(Sge),Cye=function(e){(0,Ng.Z)(n,e);var t=(0,Tg.Z)(n);function n(e,r,a,i,o){var u;(0,op.Z)(this,n),u=t.call(this,e,"layer",r,a,o,e.resolve,e.view);var s=Object.assign(Object.assign(Object.assign({},i),e.width?{width:e.width}:{}),e.height?{height:e.height}:{});return u.children=e.layer.map((function(e,t){if(Rle(e))return new n(e,(0,Cg.Z)(u),u.getName("layer_"+t),s,o);if(uae(e))return new Sye(e,(0,Cg.Z)(u),u.getName("layer_"+t),s,o);throw new Error(Pie(e))})),u}return(0,up.Z)(n,[{key:"parseData",value:function(){this.component.data=Qge(this);var e,t=(0,Rt.Z)(this.children);try{for(t.s();!(e=t.n()).done;){e.value.parseData()}}catch(n){t.e(n)}finally{t.f()}}},{key:"parseLayoutSize",value:function(){var e;qge(e=this),Gge(e,"width"),Gge(e,"height")}},{key:"parseSelections",value:function(){this.component.selection={};var e,t=(0,Rt.Z)(this.children);try{for(t.s();!(e=t.n()).done;){var n=e.value;n.parseSelections();var r,a=(0,Rt.Z)(lre(n.component.selection));try{for(a.s();!(r=a.n()).done;){var i=r.value;this.component.selection[i]=n.component.selection[i]}}catch(o){a.e(o)}finally{a.f()}}}catch(o){t.e(o)}finally{t.f()}}},{key:"parseMarkGroup",value:function(){var e,t=(0,Rt.Z)(this.children);try{for(t.s();!(e=t.n()).done;){e.value.parseMarkGroup()}}catch(n){t.e(n)}finally{t.f()}}},{key:"parseAxesAndHeaders",value:function(){!function(e){var t,n,r=e.component,a=r.axes,i=r.resolve,o={top:0,bottom:0,right:0,left:0},u=(0,Rt.Z)(e.children);try{for(u.s();!(n=u.n()).done;){var s=n.value;s.parseAxesAndHeaders();var c,l=(0,Rt.Z)(lre(s.component.axes));try{for(l.s();!(c=l.n()).done;){var f=c.value;i.axis[f]=Nve(e.component.resolve,f),"shared"===i.axis[f]&&(a[f]=aye(a[f],s.component.axes[f]),a[f]||(i.axis[f]="independent",delete a[f]))}}catch(N){l.e(N)}finally{l.f()}}}catch(N){u.e(N)}finally{u.f()}var d,h=(0,Rt.Z)(xie);try{for(h.s();!(d=h.n()).done;){var p,v=d.value,m=(0,Rt.Z)(e.children);try{for(m.s();!(p=m.n()).done;){var g=p.value;if(g.component.axes[v]){if("independent"===i.axis[v]){a[v]=(null!==(t=a[v])&&void 0!==t?t:[]).concat(g.component.axes[v]);var y,b=(0,Rt.Z)(g.component.axes[v]);try{for(b.s();!(y=b.n()).done;){var x=y.value,w=x.getWithExplicit("orient"),k=w.value,_=w.explicit;if(!Poe(k)){if(o[k]>0&&!_){var S=rye[k];o[k]>o[S]&&x.set("orient",S,!1)}o[k]++}}}catch(N){b.e(N)}finally{b.f()}}delete g.component.axes[v]}}}catch(N){m.e(N)}finally{m.f()}if("independent"===i.axis[v]&&a[v]&&a[v].length>1){var C,A=(0,Rt.Z)(a[v]);try{for(A.s();!(C=A.n()).done;){var E=C.value;E.get("grid")&&!E.explicit.grid&&(E.implicit.grid=!1)}}catch(N){A.e(N)}finally{A.f()}}}}catch(N){h.e(N)}finally{h.f()}}(this)}},{key:"assembleSelectionTopLevelSignals",value:function(e){return this.children.reduce((function(e,t){return t.assembleSelectionTopLevelSignals(e)}),e)}},{key:"assembleSignals",value:function(){return this.children.reduce((function(e,t){return e.concat(t.assembleSignals())}),Vpe(this))}},{key:"assembleLayoutSignals",value:function(){return this.children.reduce((function(e,t){return e.concat(t.assembleLayoutSignals())}),wve(this))}},{key:"assembleSelectionData",value:function(e){return this.children.reduce((function(e,t){return t.assembleSelectionData(e)}),e)}},{key:"assembleTitle",value:function(){var e=(0,Ag.Z)((0,Eg.Z)(n.prototype),"assembleTitle",this).call(this);if(e)return e;var t,r=(0,Rt.Z)(this.children);try{for(r.s();!(t=r.n()).done;){if(e=t.value.assembleTitle())return e}}catch(a){r.e(a)}finally{r.f()}}},{key:"assembleLayout",value:function(){return null}},{key:"assembleMarks",value:function(){return function(e,t){var n,r=(0,Rt.Z)(e.children);try{for(r.s();!(n=r.n()).done;){var a=n.value;bge(a)&&(t=Xde(a,t))}}catch(i){r.e(i)}finally{r.f()}return t}(this,this.children.flatMap((function(e){return e.assembleMarks()})))}},{key:"assembleLegends",value:function(){return this.children.reduce((function(e,t){return e.concat(t.assembleLegends())}),Gve(this))}}]),n}(_ge);function Aye(e,t,n,r,a){if(_se(e))return new Kge(e,t,n,a);if(Rle(e))return new Cye(e,t,n,r,a);if(uae(e))return new Sye(e,t,n,r,a);if(function(e){return hle(e)||ple(e)||dle(e)}(e))return new Jge(e,t,n,a);throw new Error(Pie(e))}function Eye(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t.logger&&boe(t.logger),t.fieldTitle&&Yse(t.fieldTitle);try{var n=Tle(Cne(t.config,e.config)),r=ufe(e,n),a=Aye(r,null,"",void 0,n);a.parse(),Pme(a.component.data,a);var i=Tye(a,Nye(e,r.autosize,n,a),e.datasets,e.usermeta);return{spec:i,normalized:r}}finally{t.logger&&xoe(),t.fieldTitle&&$se()}}function Nye(e,t,n,r){var a,i=r.component.layoutSize.get("width"),o=r.component.layoutSize.get("height");if(void 0===t?(t={type:"pad"},r.hasAxisOrientSignalRef()&&(t.resize=!0)):Mne(t)&&(t={type:t}),i&&o&&("fit"===(a=t.type)||"fit-x"===a||"fit-y"===a))if("step"===i&&"step"===o)woe(qie()),t.type="pad";else if("step"===i||"step"===o){var u="step"===i?"width":"height";woe(qie(Sie(u)));var s="width"===u?"height":"width";t.type=function(e){return e?"fit-".concat(Sie(e)):"fit"}(s)}return Object.assign(Object.assign(Object.assign({},1===lre(t).length&&t.type?"pad"===t.type?{}:{autosize:t.type}:{autosize:t}),ffe(n)),ffe(e))}function Tye(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3?arguments[3]:void 0,a=e.config?Mle(e.config):void 0,i=[].concat(e.assembleSelectionData([]),Zge(e.component.data,n)),o=e.assembleProjections(),u=e.assembleTitle(),s=e.assembleGroupStyle(),c=e.assembleGroupEncodeEntry(!0),l=e.assembleLayoutSignals();return l=l.filter((function(e){return"width"!==e.name&&"height"!==e.name||void 0===e.value||(t[e.name]=+e.value,!1)})),Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({$schema:"https://vega.github.io/schema/vega/v5.json"},e.description?{description:e.description}:{}),t),u?{title:u}:{}),s?{style:s}:{}),c?{encode:{update:c}}:{}),{data:i}),o.length>0?{projections:o}:{}),e.assembleGroup([].concat((0,cn.Z)(l),(0,cn.Z)(e.assembleSelectionTopLevelSignals([]))))),a?{config:a}:{}),r?{usermeta:r}:{})}var Iye=function(e){(0,Ng.Z)(n,e);var t=(0,Tg.Z)(n);function n(){return(0,op.Z)(this,n),t.apply(this,arguments)}return(0,up.Z)(n,[{key:"mapUnit",value:function(e,t){var n=t.config;if(e.encoding){var r=e.encoding,a=e.transform,i=Tce(r,n),o=i.bins,u=i.timeUnits,s=i.aggregate,c=i.groupby,l=i.encoding,f=[].concat((0,cn.Z)(a||[]),(0,cn.Z)(o),(0,cn.Z)(u),(0,cn.Z)(0===s.length?[]:[{aggregate:s,groupby:c}]));return Object.assign(Object.assign(Object.assign({},e),f.length>0?{transform:f}:{}),{encoding:l})}return e}}]),n}(jle),Dye=new Iye;function Fye(e,t){return Dye.map(e,{config:t})}var Mye="4.13.1";var Oye=function(e){var t=/schema\/([\w-]+)\/([\w\.\-]+)\.json$/g.exec(e).slice(1,3),n=(0,Cn.Z)(t,2);return{library:n[0],version:n[1]}},Rye="2.14.0",jye="#fff",Bye="#888",zye={background:"#333",view:{stroke:Bye},title:{color:jye,subtitleColor:jye},style:{"guide-label":{fill:jye},"guide-title":{fill:jye}},axis:{domainColor:jye,gridColor:Bye,tickColor:jye}},Zye="#4572a7",Lye={background:"#fff",arc:{fill:Zye},area:{fill:Zye},line:{stroke:Zye,strokeWidth:2},path:{stroke:Zye},rect:{fill:Zye},shape:{stroke:Zye},symbol:{fill:Zye,strokeWidth:1.5,size:50},axis:{bandPosition:.5,grid:!0,gridColor:"#000000",gridOpacity:1,gridWidth:.5,labelPadding:10,tickSize:5,tickWidth:.5},axisBand:{grid:!1,tickExtra:!0},legend:{labelBaseline:"middle",labelFontSize:11,symbolSize:50,symbolType:"square"},range:{category:["#4572a7","#aa4643","#8aa453","#71598e","#4598ae","#d98445","#94aace","#d09393","#b9cc98","#a99cbc"]}},Pye="#30a2da",Uye="#cbcbcb",Wye="#f0f0f0",Vye="#333",qye={arc:{fill:Pye},area:{fill:Pye},axis:{domainColor:Uye,grid:!0,gridColor:Uye,gridWidth:1,labelColor:"#999",labelFontSize:10,titleColor:"#333",tickColor:Uye,tickSize:10,titleFontSize:14,titlePadding:10,labelPadding:4},axisBand:{grid:!1},background:Wye,group:{fill:Wye},legend:{labelColor:Vye,labelFontSize:11,padding:1,symbolSize:30,symbolType:"square",titleColor:Vye,titleFontSize:14,titlePadding:10},line:{stroke:Pye,strokeWidth:2},path:{stroke:Pye,strokeWidth:.5},rect:{fill:Pye},range:{category:["#30a2da","#fc4f30","#e5ae38","#6d904f","#8b8b8b","#b96db8","#ff9e27","#56cc60","#52d2ca","#52689e","#545454","#9fe4f8"],diverging:["#cc0020","#e77866","#f6e7e1","#d6e8ed","#91bfd9","#1d78b5"],heatmap:["#d6e8ed","#cee0e5","#91bfd9","#549cc6","#1d78b5"]},point:{filled:!0,shape:"circle"},shape:{stroke:Pye},bar:{binSpacing:2,fill:Pye,stroke:null},title:{anchor:"start",fontSize:24,fontWeight:600,offset:20}},Gye="#000",Hye={group:{fill:"#e5e5e5"},arc:{fill:Gye},area:{fill:Gye},line:{stroke:Gye},path:{stroke:Gye},rect:{fill:Gye},shape:{stroke:Gye},symbol:{fill:Gye,size:40},axis:{domain:!1,grid:!0,gridColor:"#FFFFFF",gridOpacity:1,labelColor:"#7F7F7F",labelPadding:4,tickColor:"#7F7F7F",tickSize:5.67,titleFontSize:16,titleFontWeight:"normal"},legend:{labelBaseline:"middle",labelFontSize:11,symbolSize:40},range:{category:["#000000","#7F7F7F","#1A1A1A","#999999","#333333","#B0B0B0","#4D4D4D","#C9C9C9","#666666","#DCDCDC"]}},Xye="Benton Gothic, sans-serif",Kye="#82c6df",Yye="Benton Gothic Bold, sans-serif",$ye="normal",Qye={"category-6":["#ec8431","#829eb1","#c89d29","#3580b1","#adc839","#ab7fb4"],"fire-7":["#fbf2c7","#f9e39c","#f8d36e","#f4bb6a","#e68a4f","#d15a40","#ab4232"],"fireandice-6":["#e68a4f","#f4bb6a","#f9e39c","#dadfe2","#a6b7c6","#849eae"],"ice-7":["#edefee","#dadfe2","#c4ccd2","#a6b7c6","#849eae","#607785","#47525d"]},Jye={background:"#ffffff",title:{anchor:"start",color:"#000000",font:Yye,fontSize:22,fontWeight:"normal"},arc:{fill:Kye},area:{fill:Kye},line:{stroke:Kye,strokeWidth:2},path:{stroke:Kye},rect:{fill:Kye},shape:{stroke:Kye},symbol:{fill:Kye,size:30},axis:{labelFont:Xye,labelFontSize:11.5,labelFontWeight:"normal",titleFont:Yye,titleFontSize:13,titleFontWeight:$ye},axisX:{labelAngle:0,labelPadding:4,tickSize:3},axisY:{labelBaseline:"middle",maxExtent:45,minExtent:45,tickSize:2,titleAlign:"left",titleAngle:0,titleX:-45,titleY:-11},legend:{labelFont:Xye,labelFontSize:11.5,symbolType:"square",titleFont:Yye,titleFontSize:13,titleFontWeight:$ye},range:{category:Qye["category-6"],diverging:Qye["fireandice-6"],heatmap:Qye["fire-7"],ordinal:Qye["fire-7"],ramp:Qye["fire-7"]}},ebe="#ab5787",tbe="#979797",nbe={background:"#f9f9f9",arc:{fill:ebe},area:{fill:ebe},line:{stroke:ebe},path:{stroke:ebe},rect:{fill:ebe},shape:{stroke:ebe},symbol:{fill:ebe,size:30},axis:{domainColor:tbe,domainWidth:.5,gridWidth:.2,labelColor:tbe,tickColor:tbe,tickWidth:.2,titleColor:tbe},axisBand:{grid:!1},axisX:{grid:!0,tickSize:10},axisY:{domain:!1,grid:!0,tickSize:0},legend:{labelFontSize:11,padding:1,symbolSize:30,symbolType:"square"},range:{category:["#ab5787","#51b2e5","#703c5c","#168dd9","#d190b6","#00609f","#d365ba","#154866","#666666","#c4c4c4"]}},rbe="#3e5c69",abe={background:"#fff",arc:{fill:rbe},area:{fill:rbe},line:{stroke:rbe},path:{stroke:rbe},rect:{fill:rbe},shape:{stroke:rbe},symbol:{fill:rbe},axis:{domainWidth:.5,grid:!0,labelPadding:2,tickSize:5,tickWidth:.5,titleFontWeight:"normal"},axisBand:{grid:!1},axisX:{gridWidth:.2},axisY:{gridDash:[3],gridWidth:.4},legend:{labelFontSize:11,padding:1,symbolType:"square"},range:{category:["#3e5c69","#6793a6","#182429","#0570b0","#3690c0","#74a9cf","#a6bddb","#e2ddf2"]}},ibe="#1696d2",obe="#000000",ube="Lato",sbe="Lato",cbe={"main-colors":["#1696d2","#d2d2d2","#000000","#fdbf11","#ec008b","#55b748","#5c5859","#db2b27"],"shades-blue":["#CFE8F3","#A2D4EC","#73BFE2","#46ABDB","#1696D2","#12719E","#0A4C6A","#062635"],"shades-gray":["#F5F5F5","#ECECEC","#E3E3E3","#DCDBDB","#D2D2D2","#9D9D9D","#696969","#353535"],"shades-yellow":["#FFF2CF","#FCE39E","#FDD870","#FCCB41","#FDBF11","#E88E2D","#CA5800","#843215"],"shades-magenta":["#F5CBDF","#EB99C2","#E46AA7","#E54096","#EC008B","#AF1F6B","#761548","#351123"],"shades-green":["#DCEDD9","#BCDEB4","#98CF90","#78C26D","#55B748","#408941","#2C5C2D","#1A2E19"],"shades-black":["#D5D5D4","#ADABAC","#848081","#5C5859","#332D2F","#262223","#1A1717","#0E0C0D"],"shades-red":["#F8D5D4","#F1AAA9","#E9807D","#E25552","#DB2B27","#A4201D","#6E1614","#370B0A"],"one-group":["#1696d2","#000000"],"two-groups-cat-1":["#1696d2","#000000"],"two-groups-cat-2":["#1696d2","#fdbf11"],"two-groups-cat-3":["#1696d2","#db2b27"],"two-groups-seq":["#a2d4ec","#1696d2"],"three-groups-cat":["#1696d2","#fdbf11","#000000"],"three-groups-seq":["#a2d4ec","#1696d2","#0a4c6a"],"four-groups-cat-1":["#000000","#d2d2d2","#fdbf11","#1696d2"],"four-groups-cat-2":["#1696d2","#ec0008b","#fdbf11","#5c5859"],"four-groups-seq":["#cfe8f3","#73bf42","#1696d2","#0a4c6a"],"five-groups-cat-1":["#1696d2","#fdbf11","#d2d2d2","#ec008b","#000000"],"five-groups-cat-2":["#1696d2","#0a4c6a","#d2d2d2","#fdbf11","#332d2f"],"five-groups-seq":["#cfe8f3","#73bf42","#1696d2","#0a4c6a","#000000"],"six-groups-cat-1":["#1696d2","#ec008b","#fdbf11","#000000","#d2d2d2","#55b748"],"six-groups-cat-2":["#1696d2","#d2d2d2","#ec008b","#fdbf11","#332d2f","#0a4c6a"],"six-groups-seq":["#cfe8f3","#a2d4ec","#73bfe2","#46abdb","#1696d2","#12719e"],"diverging-colors":["#ca5800","#fdbf11","#fdd870","#fff2cf","#cfe8f3","#73bfe2","#1696d2","#0a4c6a"]},lbe={background:"#FFFFFF",title:{anchor:"start",fontSize:18,font:ube},axisX:{domain:!0,domainColor:obe,domainWidth:1,grid:!1,labelFontSize:12,labelFont:sbe,labelAngle:0,tickColor:obe,tickSize:5,titleFontSize:12,titlePadding:10,titleFont:ube},axisY:{domain:!1,domainWidth:1,grid:!0,gridColor:"#DEDDDD",gridWidth:1,labelFontSize:12,labelFont:sbe,labelPadding:8,ticks:!1,titleFontSize:12,titlePadding:10,titleFont:ube,titleAngle:0,titleY:-10,titleX:18},legend:{labelFontSize:12,labelFont:sbe,symbolSize:100,titleFontSize:12,titlePadding:10,titleFont:ube,orient:"right",offset:10},view:{stroke:"transparent"},range:{category:cbe["six-groups-cat-1"],diverging:cbe["diverging-colors"],heatmap:cbe["diverging-colors"],ordinal:cbe["six-groups-seq"],ramp:cbe["shades-blue"]},area:{fill:ibe},rect:{fill:ibe},line:{color:ibe,stroke:ibe,strokeWidth:5},trail:{color:ibe,stroke:ibe,strokeWidth:0,size:1},path:{stroke:ibe,strokeWidth:.5},point:{filled:!0},text:{font:"Lato",color:ibe,fontSize:11,align:"center",fontWeight:400,size:11},style:{bar:{fill:ibe,stroke:null}},arc:{fill:ibe},shape:{stroke:ibe},symbol:{fill:ibe,size:30}},fbe="#3366CC",dbe="#ccc",hbe="Arial, sans-serif",pbe={arc:{fill:fbe},area:{fill:fbe},path:{stroke:fbe},rect:{fill:fbe},shape:{stroke:fbe},symbol:{stroke:fbe},circle:{fill:fbe},background:"#fff",padding:{top:10,right:10,bottom:10,left:10},style:{"guide-label":{font:hbe,fontSize:12},"guide-title":{font:hbe,fontSize:12},"group-title":{font:hbe,fontSize:12}},title:{font:hbe,fontSize:14,fontWeight:"bold",dy:-3,anchor:"start"},axis:{gridColor:dbe,tickColor:dbe,domain:!1,grid:!0},range:{category:["#4285F4","#DB4437","#F4B400","#0F9D58","#AB47BC","#00ACC1","#FF7043","#9E9D24","#5C6BC0","#F06292","#00796B","#C2185B"],heatmap:["#c6dafc","#5e97f6","#2a56c6"]}},vbe=function(e){return e*(1/3+1)},mbe=vbe(9),gbe=vbe(10),ybe=vbe(12),bbe="Segoe UI",xbe="wf_standard-font, helvetica, arial, sans-serif",wbe="#252423",kbe="#605E5C",_be="transparent",Sbe="#118DFF",Cbe="#DEEFFF",Abe=[Cbe,Sbe],Ebe={view:{stroke:_be},background:_be,font:bbe,header:{titleFont:xbe,titleFontSize:ybe,titleColor:wbe,labelFont:bbe,labelFontSize:gbe,labelColor:kbe},axis:{ticks:!1,grid:!1,domain:!1,labelColor:kbe,labelFontSize:mbe,titleFont:xbe,titleColor:wbe,titleFontSize:ybe,titleFontWeight:"normal"},axisQuantitative:{tickCount:3,grid:!0,gridColor:"#C8C6C4",gridDash:[1,5],labelFlush:!1},axisBand:{tickExtra:!0},axisX:{labelPadding:5},axisY:{labelPadding:10},bar:{fill:Sbe},line:{stroke:Sbe,strokeWidth:3,strokeCap:"round",strokeJoin:"round"},text:{font:bbe,fontSize:mbe,fill:kbe},arc:{fill:Sbe},area:{fill:Sbe,line:!0,opacity:.6},path:{stroke:Sbe},rect:{fill:Sbe},point:{fill:Sbe,filled:!0,size:75},shape:{stroke:Sbe},symbol:{fill:Sbe,strokeWidth:1.5,size:50},legend:{titleFont:bbe,titleFontWeight:"bold",titleColor:kbe,labelFont:bbe,labelFontSize:gbe,labelColor:kbe,symbolType:"circle",symbolSize:75},range:{category:[Sbe,"#12239E","#E66C37","#6B007B","#E044A7","#744EC2","#D9B300","#D64550"],diverging:Abe,heatmap:Abe,ordinal:[Cbe,"#c7e4ff","#b0d9ff","#9aceff","#83c3ff","#6cb9ff","#55aeff","#3fa3ff","#2898ff",Sbe]}},Nbe='IBM Plex Sans,system-ui,-apple-system,BlinkMacSystemFont,".sfnstext-regular",sans-serif',Tbe=["#8a3ffc","#33b1ff","#007d79","#ff7eb6","#fa4d56","#fff1f1","#6fdc8c","#4589ff","#d12771","#d2a106","#08bdba","#bae6ff","#ba4e00","#d4bbff"],Ibe=["#6929c4","#1192e8","#005d5d","#9f1853","#fa4d56","#570408","#198038","#002d9c","#ee538b","#b28600","#009d9a","#012749","#8a3800","#a56eff"];function Dbe(e){var t=e.type,n="dark"===t?"#161616":"#ffffff",r="dark"===t?"#f4f4f4":"#161616",a="dark"===t?"#d4bbff":"#6929c4";return{background:e.background,arc:{fill:a},area:{fill:a},path:{stroke:a},rect:{fill:a},shape:{stroke:a},symbol:{stroke:a},circle:{fill:a},view:{fill:n,stroke:n},group:{fill:n},title:{color:r,anchor:"start",dy:-15,fontSize:16,font:Nbe,fontWeight:600},axis:{labelColor:r,labelFontSize:12,grid:!0,gridColor:"#525252",titleColor:r,labelAngle:0},style:{"guide-label":{font:Nbe,fill:r,fontWeight:400},"guide-title":{font:Nbe,fill:r,fontWeight:400}},range:{category:"dark"===t?Tbe:Ibe,diverging:["#750e13","#a2191f","#da1e28","#fa4d56","#ff8389","#ffb3b8","#ffd7d9","#fff1f1","#e5f6ff","#bae6ff","#82cfff","#33b1ff","#1192e8","#0072c3","#00539a","#003a6d"],heatmap:["#f6f2ff","#e8daff","#d4bbff","#be95ff","#a56eff","#8a3ffc","#6929c4","#491d8b","#31135e","#1c0f30"]}}}var Fbe=Dbe({type:"light",background:"#ffffff"}),Mbe=Dbe({type:"light",background:"#f4f4f4"}),Obe=Dbe({type:"dark",background:"#262626"}),Rbe=Dbe({type:"dark",background:"#161616"}),jbe=Rye,Bbe="vg-tooltip-element",zbe={offsetX:10,offsetY:10,id:Bbe,styleId:"vega-tooltip-style",theme:"light",disableDefaultStyle:!1,sanitize:function(e){return String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;")},maxDepth:2};function Zbe(e,t,n){if(_e(e))return"[".concat(e.map((function(e){return t(bt(e)?e:Lbe(e,n))})).join(", "),"]");if(Se(e)){var r="",a=e,i=a.title,o=a.image,u=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]])}return n}(a,["title","image"]);i&&(r+="<h2>".concat(t(i),"</h2>")),o&&(r+='<img src="'.concat(t(o),'">'));var s=Object.keys(u);if(s.length>0){r+="<table>";var c,l=(0,Rt.Z)(s);try{for(l.s();!(c=l.n()).done;){var f=c.value,d=u[f];void 0!==d&&(Se(d)&&(d=Lbe(d,n)),r+='<tr><td class="key">'.concat(t(f),':</td><td class="value">').concat(t(d),"</td></tr>"))}}catch(h){l.e(h)}finally{l.f()}r+="</table>"}return r||"{}"}return t(e)}function Lbe(e,t){return JSON.stringify(e,function(e){var t=[];return function(n,r){if("object"!==typeof r||null===r)return r;var a=t.indexOf(this)+1;return t.length=a,t.length>e?"[Object]":t.indexOf(r)>=0?"[Circular]":(t.push(r),r)}}(t))}var Pbe=function(){function e(t){(0,op.Z)(this,e),this.options=Object.assign(Object.assign({},zbe),t);var n=this.options.id;if(this.el=null,this.call=this.tooltipHandler.bind(this),!this.options.disableDefaultStyle&&!document.getElementById(this.options.styleId)){var r=document.createElement("style");r.setAttribute("id",this.options.styleId),r.innerHTML=function(e){if(!/^[A-Za-z]+[-:.\w]*$/.test(e))throw new Error("Invalid HTML ID");return"#vg-tooltip-element {\n  visibility: hidden;\n  padding: 8px;\n  position: fixed;\n  z-index: 1000;\n  font-family: sans-serif;\n  font-size: 11px;\n  border-radius: 3px;\n  box-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);\n  /* The default theme is the light theme. */\n  background-color: rgba(255, 255, 255, 0.95);\n  border: 1px solid #d9d9d9;\n  color: black; }\n  #vg-tooltip-element.visible {\n    visibility: visible; }\n  #vg-tooltip-element h2 {\n    margin-top: 0;\n    margin-bottom: 10px;\n    font-size: 13px; }\n  #vg-tooltip-element img {\n    max-width: 200px;\n    max-height: 200px; }\n  #vg-tooltip-element table {\n    border-spacing: 0; }\n    #vg-tooltip-element table tr {\n      border: none; }\n      #vg-tooltip-element table tr td {\n        overflow: hidden;\n        text-overflow: ellipsis;\n        padding-top: 2px;\n        padding-bottom: 2px; }\n        #vg-tooltip-element table tr td.key {\n          color: #808080;\n          max-width: 150px;\n          text-align: right;\n          padding-right: 4px; }\n        #vg-tooltip-element table tr td.value {\n          display: block;\n          max-width: 300px;\n          max-height: 7em;\n          text-align: left; }\n  #vg-tooltip-element.dark-theme {\n    background-color: rgba(32, 32, 32, 0.9);\n    border: 1px solid #f5f5f5;\n    color: white; }\n    #vg-tooltip-element.dark-theme td.key {\n      color: #bfbfbf; }\n".toString().replace(Bbe,e)}(n);var a=document.head;a.childNodes.length>0?a.insertBefore(r,a.childNodes[0]):a.appendChild(r)}}return(0,up.Z)(e,[{key:"tooltipHandler",value:function(e,t,n,r){if(this.el=document.getElementById(this.options.id),this.el||(this.el=document.createElement("div"),this.el.setAttribute("id",this.options.id),this.el.classList.add("vg-tooltip"),document.body.appendChild(this.el)),(null!=document.fullscreenElement?document.fullscreenElement:document.body).appendChild(this.el),null!=r&&""!==r){this.el.innerHTML=Zbe(r,this.options.sanitize,this.options.maxDepth),this.el.classList.add("visible","".concat(this.options.theme,"-theme"));var a=function(e,t,n,r){var a=e.clientX+n;a+t.width>window.innerWidth&&(a=+e.clientX-n-t.width);var i=e.clientY+r;return i+t.height>window.innerHeight&&(i=+e.clientY-r-t.height),{x:a,y:i}}(t,this.el.getBoundingClientRect(),this.options.offsetX,this.options.offsetY),i=a.x,o=a.y;this.el.setAttribute("style","top: ".concat(o,"px; left: ").concat(i,"px"))}else this.el.classList.remove("visible","".concat(this.options.theme,"-theme"))}}]),e}();function Ube(e,t,n,r){return new(n||(n=Promise))((function(a,i){function o(e){try{s(r.next(e))}catch(t){i(t)}}function u(e){try{s(r.throw(e))}catch(t){i(t)}}function s(e){e.done?a(e.value):function(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(o,u)}s((r=r.apply(e,t||[])).next())}))}function Wbe(e,t,n){var r=e.open(t),a=new URL(t).origin,i=40;e.addEventListener("message",(function t(n){n.source===r&&(i=0,e.removeEventListener("message",t,!1))}),!1),setTimeout((function e(){i<=0||(r.postMessage(n,a),setTimeout(e,250),i-=1)}),250)}var Vbe,qbe='.vega-embed {\n  position: relative;\n  display: inline-block;\n  box-sizing: border-box; }\n  .vega-embed.has-actions {\n    padding-right: 38px; }\n  .vega-embed details:not([open]) > :not(summary) {\n    display: none !important; }\n  .vega-embed summary {\n    list-style: none;\n    position: absolute;\n    top: 0;\n    right: 0;\n    padding: 6px;\n    z-index: 1000;\n    background: white;\n    box-shadow: 1px 1px 3px rgba(0, 0, 0, 0.1);\n    color: #1b1e23;\n    border: 1px solid #aaa;\n    border-radius: 999px;\n    opacity: 0.2;\n    transition: opacity 0.4s ease-in;\n    outline: none;\n    cursor: pointer;\n    line-height: 0px; }\n    .vega-embed summary::-webkit-details-marker {\n      display: none; }\n    .vega-embed summary:active {\n      box-shadow: #aaa 0px 0px 0px 1px inset; }\n    .vega-embed summary svg {\n      width: 14px;\n      height: 14px; }\n  .vega-embed details[open] summary {\n    opacity: 0.7; }\n  .vega-embed:hover summary,\n  .vega-embed:focus summary {\n    opacity: 1 !important;\n    transition: opacity 0.2s ease; }\n  .vega-embed .vega-actions {\n    position: absolute;\n    z-index: 1001;\n    top: 35px;\n    right: -9px;\n    display: flex;\n    flex-direction: column;\n    padding-bottom: 8px;\n    padding-top: 8px;\n    border-radius: 4px;\n    box-shadow: 0 2px 8px 0 rgba(0, 0, 0, 0.2);\n    border: 1px solid #d9d9d9;\n    background: white;\n    animation-duration: 0.15s;\n    animation-name: scale-in;\n    animation-timing-function: cubic-bezier(0.2, 0, 0.13, 1.5);\n    text-align: left; }\n    .vega-embed .vega-actions a {\n      padding: 8px 16px;\n      font-family: sans-serif;\n      font-size: 14px;\n      font-weight: 600;\n      white-space: nowrap;\n      color: #434a56;\n      text-decoration: none; }\n      .vega-embed .vega-actions a:hover {\n        background-color: #f7f7f9;\n        color: black; }\n    .vega-embed .vega-actions::before, .vega-embed .vega-actions::after {\n      content: "";\n      display: inline-block;\n      position: absolute; }\n    .vega-embed .vega-actions::before {\n      left: auto;\n      right: 14px;\n      top: -16px;\n      border: 8px solid #0000;\n      border-bottom-color: #d9d9d9; }\n    .vega-embed .vega-actions::after {\n      left: auto;\n      right: 15px;\n      top: -14px;\n      border: 7px solid #0000;\n      border-bottom-color: #fff; }\n  .vega-embed .chart-wrapper {\n    width: 100%;\n    height: 100%; }\n\n.vega-embed-wrapper {\n  max-width: 100%;\n  overflow: auto;\n  padding-right: 14px; }\n\n@keyframes scale-in {\n  from {\n    opacity: 0;\n    transform: scale(0.6); }\n  to {\n    opacity: 1;\n    transform: scale(1); } }\n';function Gbe(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];for(var a=0,i=n;a<i.length;a++){var o=i[a];Hbe(e,o)}return e}function Hbe(e,t){for(var n=0,r=Object.keys(t);n<r.length;n++){var a=r[n];Ee(e,a,t[a],!0)}}String.prototype.startsWith||(String.prototype.startsWith=function(e,t){return this.substr(!t||t<0?0:+t,e.length)===e});var Xbe=g,Kbe=y,Ybe="undefined"!==typeof window?window:void 0;void 0===Kbe&&(null===(Vbe=null===Ybe||void 0===Ybe?void 0:Ybe.vl)||void 0===Vbe?void 0:Vbe.compile)&&(Kbe=Ybe.vl);var $be={export:{svg:!0,png:!0},source:!0,compiled:!0,editor:!0},Qbe={CLICK_TO_VIEW_ACTIONS:"Click to view actions",COMPILED_ACTION:"View Compiled Vega",EDITOR_ACTION:"Open in Vega Editor",PNG_ACTION:"Save as PNG",SOURCE_ACTION:"View Source",SVG_ACTION:"Save as SVG"},Jbe={vega:"Vega","vega-lite":"Vega-Lite"},exe={vega:Xbe.version,"vega-lite":Kbe?Kbe.version:"not available"},txe={vega:function(e){return e},"vega-lite":function(e,t){return Kbe.compile(e,{config:t}).spec}},nxe='\n<svg viewBox="0 0 16 16" fill="currentColor" stroke="none" stroke-width="1" stroke-linecap="round" stroke-linejoin="round">\n  <circle r="2" cy="8" cx="2"></circle>\n  <circle r="2" cy="8" cx="8"></circle>\n  <circle r="2" cy="8" cx="14"></circle>\n</svg>',rxe="chart-wrapper";function axe(e){return"function"===typeof e}function ixe(e,t,n,r){var a="<html><head>".concat(t,'</head><body><pre><code class="json">'),i="</code></pre>".concat(n,"</body></html>"),o=window.open("");o.document.write(a+e+i),o.document.title="".concat(Jbe[r]," JSON Source")}function oxe(e,t){var n;if(e.$schema){var r=Oye(e.$schema);t&&t!==r.library&&console.warn("The given visualization spec is written in ".concat(Jbe[r.library],", but mode argument sets ").concat(null!==(n=Jbe[t])&&void 0!==n?n:t,"."));var a=r.library;return(0,ee.satisfies)(exe[a],"^".concat(r.version.slice(1)))||console.warn("The input spec uses ".concat(Jbe[a]," ").concat(r.version,", but the current version of ").concat(Jbe[a]," is v").concat(exe[a],".")),a}return"mark"in e||"encoding"in e||"layer"in e||"hconcat"in e||"vconcat"in e||"facet"in e||"repeat"in e?"vega-lite":"marks"in e||"signals"in e||"scales"in e||"axes"in e?"vega":null!==t&&void 0!==t?t:"vega"}function uxe(e){return(t=e)&&"load"in t?e:Xbe.loader(e);var t}function sxe(e){var t;return null!==(t=e.usermeta&&e.usermeta.embedOptions)&&void 0!==t?t:{}}function cxe(e,t){var n;return Ube(this,void 0,void 0,w().mark((function r(){var a,i;return w().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(!bt(e.config)){r.next=8;break}return r.t1=JSON,r.next=4,t.load(e.config);case 4:r.t2=r.sent,r.t0=r.t1.parse.call(r.t1,r.t2),r.next=9;break;case 8:r.t0=null!==(n=e.config)&&void 0!==n?n:{};case 9:if(a=r.t0,!bt(e.patch)){r.next=18;break}return r.t4=JSON,r.next=14,t.load(e.patch);case 14:r.t5=r.sent,r.t3=r.t4.parse.call(r.t4,r.t5),r.next=19;break;case 18:r.t3=e.patch;case 19:return i=r.t3,r.abrupt("return",Object.assign(Object.assign(Object.assign({},e),i?{patch:i}:{}),a?{config:a}:{}));case 21:case"end":return r.stop()}}),r)})))}function lxe(e){var t,n=e.getRootNode?e.getRootNode():document;return n instanceof ShadowRoot?{root:n,rootContainer:n}:{root:document,rootContainer:null!==(t=document.head)&&void 0!==t?t:document.body}}function fxe(e,t){var n,r,a,i,o,u,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},c=arguments.length>3?arguments[3]:void 0;return Ube(this,void 0,void 0,w().mark((function l(){var f,d,h,p,v,m,g,y,x,k,_,S,C,A,E,N,T,I,D,F,M,O,R,j,B,z,L,P,U,W,V,q,G,H,X,K,Y,$,Q;return w().wrap((function(l){for(;;)switch(l.prev=l.next){case 0:if(Q=function(){L&&document.removeEventListener("click",L),M.finalize()},f=s.theme?Ae(b[s.theme],null!==(n=s.config)&&void 0!==n?n:{}):s.config,d=pt(s.actions)?s.actions:Gbe({},$be,null!==(r=s.actions)&&void 0!==r?r:{}),h=Object.assign(Object.assign({},Qbe),s.i18n),p=null!==(a=s.renderer)&&void 0!==a?a:"canvas",v=null!==(i=s.logLevel)&&void 0!==i?i:Xbe.Warn,m=null!==(o=s.downloadFileName)&&void 0!==o?o:"visualization",g="string"===typeof e?document.querySelector(e):e){l.next=10;break}throw new Error("".concat(e," does not exist"));case 10:return!1!==s.defaultStyle&&(y="vega-embed-style",x=lxe(g),k=x.root,_=x.rootContainer,k.getElementById(y)||((S=document.createElement("style")).id=y,S.innerText=void 0===s.defaultStyle||!0===s.defaultStyle?qbe.toString():s.defaultStyle,_.appendChild(S))),C=oxe(t,s.mode),A=txe[C](t,f),"vega-lite"===C&&A.$schema&&(E=Oye(A.$schema),(0,ee.satisfies)(exe.vega,"^".concat(E.version.slice(1)))||console.warn("The compiled spec uses Vega ".concat(E.version,", but current version is v").concat(exe.vega,"."))),g.classList.add("vega-embed"),d&&g.classList.add("has-actions"),g.innerHTML="",N=g,d&&((T=document.createElement("div")).classList.add(rxe),g.appendChild(T),N=T),(I=s.patch)&&(A=I instanceof Function?I(A):Z(A,I,!0,!1).newDocument),s.formatLocale&&Xbe.formatLocale(s.formatLocale),s.timeFormatLocale&&Xbe.timeFormatLocale(s.timeFormatLocale),D=s.ast,F=Xbe.parse(A,"vega-lite"===C?{}:f,{ast:D}),M=new(s.viewClass||Xbe.View)(F,Object.assign({loader:c,logLevel:v,renderer:p},D?{expr:Xbe.expressionInterpreter}:{})),!1!==s.tooltip&&(O=axe(s.tooltip)?s.tooltip:new Pbe(!0===s.tooltip?{}:s.tooltip).call,M.tooltip(O)),void 0===(R=s.hover)&&(R="vega"===C),R&&(B=(j="boolean"===typeof R?{}:R).hoverSet,z=j.updateSet,M.hover(B,z)),s&&(null!=s.width&&M.width(s.width),null!=s.height&&M.height(s.height),null!=s.padding&&M.padding(s.padding)),l.next=33,M.initialize(N,s.bind).runAsync();case 33:if(!1!==d){if(P=g,!1!==s.defaultStyle&&((U=document.createElement("details")).title=h.CLICK_TO_VIEW_ACTIONS,g.append(U),P=U,(W=document.createElement("summary")).innerHTML=nxe,U.append(W),L=function(e){U.contains(e.target)||U.removeAttribute("open")},document.addEventListener("click",L)),V=document.createElement("div"),P.append(V),V.classList.add("vega-actions"),!0===d||!1!==d.export)for(q=function(){var e=H[G];if(!0===d||!0===d.export||d.export[e]){var t=h["".concat(e.toUpperCase(),"_ACTION")],n=document.createElement("a");n.text=t,n.href="#",n.target="_blank",n.download="".concat(m,".").concat(e),n.addEventListener("mousedown",(function(t){return Ube(this,void 0,void 0,w().mark((function n(){var r;return w().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return t.preventDefault(),n.next=3,M.toImageURL(e,s.scaleFactor);case 3:r=n.sent,this.href=r;case 5:case"end":return n.stop()}}),n,this)})))})),V.append(n)}},G=0,H=["svg","png"];G<H.length;G++)q();!0!==d&&!1===d.source||((X=document.createElement("a")).text=h.SOURCE_ACTION,X.href="#",X.addEventListener("click",(function(e){var n,r;ixe(J()(t),null!==(n=s.sourceHeader)&&void 0!==n?n:"",null!==(r=s.sourceFooter)&&void 0!==r?r:"",C),e.preventDefault()})),V.append(X)),"vega-lite"!==C||!0!==d&&!1===d.compiled||((K=document.createElement("a")).text=h.COMPILED_ACTION,K.href="#",K.addEventListener("click",(function(e){var t,n;ixe(J()(A),null!==(t=s.sourceHeader)&&void 0!==t?t:"",null!==(n=s.sourceFooter)&&void 0!==n?n:"","vega"),e.preventDefault()})),V.append(K)),!0!==d&&!1===d.editor||(Y=null!==(u=s.editorUrl)&&void 0!==u?u:"https://vega.github.io/editor/",($=document.createElement("a")).text=h.EDITOR_ACTION,$.href="#",$.addEventListener("click",(function(e){Wbe(window,Y,{config:f,mode:C,renderer:p,spec:J()(t)}),e.preventDefault()})),V.append($))}return l.abrupt("return",{view:M,spec:t,vgSpec:A,finalize:Q});case 35:case"end":return l.stop()}}),l)})))}var dxe=function(e,t){var n,r,a,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return Ube(this,void 0,void 0,w().mark((function o(){var u,s,c,l,f,d;return w().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:if(!bt(t)){o.next=9;break}return s=uxe(i.loader),o.t0=JSON,o.next=5,s.load(t);case 5:o.t1=o.sent,u=o.t0.parse.call(o.t0,o.t1),o.next=10;break;case 9:u=t;case 10:return c=sxe(u).loader,s&&!c||(s=uxe(null!==(n=i.loader)&&void 0!==n?n:c)),o.next=14,cxe(sxe(u),s);case 14:return l=o.sent,o.next=17,cxe(i,s);case 17:return f=o.sent,d=Object.assign(Object.assign({},Gbe(f,l)),{config:Ae(null!==(r=f.config)&&void 0!==r?r:{},null!==(a=l.config)&&void 0!==a?a:{})}),o.next=21,fxe(e,u,d,s);case 21:return o.abrupt("return",o.sent);case 22:case"end":return o.stop()}}),o)})))}},7799:function(e,t,n){"use strict";var r=n(6690).default,a=n(9728).default,i=n(400),o=Symbol("max"),u=Symbol("length"),s=Symbol("lengthCalculator"),c=Symbol("allowStale"),l=Symbol("maxAge"),f=Symbol("dispose"),d=Symbol("noDisposeOnSet"),h=Symbol("lruList"),p=Symbol("cache"),v=Symbol("updateAgeOnGet"),m=function(){return 1},g=function(){function e(t){if(r(this,e),"number"===typeof t&&(t={max:t}),t||(t={}),t.max&&("number"!==typeof t.max||t.max<0))throw new TypeError("max must be a non-negative number");this[o]=t.max||1/0;var n=t.length||m;if(this[s]="function"!==typeof n?m:n,this[c]=t.stale||!1,t.maxAge&&"number"!==typeof t.maxAge)throw new TypeError("maxAge must be a number");this[l]=t.maxAge||0,this[f]=t.dispose,this[d]=t.noDisposeOnSet||!1,this[v]=t.updateAgeOnGet||!1,this.reset()}return a(e,[{key:"max",get:function(){return this[o]},set:function(e){if("number"!==typeof e||e<0)throw new TypeError("max must be a non-negative number");this[o]=e||1/0,x(this)}},{key:"allowStale",get:function(){return this[c]},set:function(e){this[c]=!!e}},{key:"maxAge",get:function(){return this[l]},set:function(e){if("number"!==typeof e)throw new TypeError("maxAge must be a non-negative number");this[l]=e,x(this)}},{key:"lengthCalculator",get:function(){return this[s]},set:function(e){var t=this;"function"!==typeof e&&(e=m),e!==this[s]&&(this[s]=e,this[u]=0,this[h].forEach((function(e){e.length=t[s](e.value,e.key),t[u]+=e.length}))),x(this)}},{key:"length",get:function(){return this[u]}},{key:"itemCount",get:function(){return this[h].length}},{key:"rforEach",value:function(e,t){t=t||this;for(var n=this[h].tail;null!==n;){var r=n.prev;_(this,e,n,t),n=r}}},{key:"forEach",value:function(e,t){t=t||this;for(var n=this[h].head;null!==n;){var r=n.next;_(this,e,n,t),n=r}}},{key:"keys",value:function(){return this[h].toArray().map((function(e){return e.key}))}},{key:"values",value:function(){return this[h].toArray().map((function(e){return e.value}))}},{key:"reset",value:function(){var e=this;this[f]&&this[h]&&this[h].length&&this[h].forEach((function(t){return e[f](t.key,t.value)})),this[p]=new Map,this[h]=new i,this[u]=0}},{key:"dump",value:function(){var e=this;return this[h].map((function(t){return!b(e,t)&&{k:t.key,v:t.value,e:t.now+(t.maxAge||0)}})).toArray().filter((function(e){return e}))}},{key:"dumpLru",value:function(){return this[h]}},{key:"set",value:function(e,t,n){if((n=n||this[l])&&"number"!==typeof n)throw new TypeError("maxAge must be a number");var r=n?Date.now():0,a=this[s](t,e);if(this[p].has(e)){if(a>this[o])return w(this,this[p].get(e)),!1;var i=this[p].get(e).value;return this[f]&&(this[d]||this[f](e,i.value)),i.now=r,i.maxAge=n,i.value=t,this[u]+=a-i.length,i.length=a,this.get(e),x(this),!0}var c=new k(e,t,a,r,n);return c.length>this[o]?(this[f]&&this[f](e,t),!1):(this[u]+=c.length,this[h].unshift(c),this[p].set(e,this[h].head),x(this),!0)}},{key:"has",value:function(e){if(!this[p].has(e))return!1;var t=this[p].get(e).value;return!b(this,t)}},{key:"get",value:function(e){return y(this,e,!0)}},{key:"peek",value:function(e){return y(this,e,!1)}},{key:"pop",value:function(){var e=this[h].tail;return e?(w(this,e),e.value):null}},{key:"del",value:function(e){w(this,this[p].get(e))}},{key:"load",value:function(e){this.reset();for(var t=Date.now(),n=e.length-1;n>=0;n--){var r=e[n],a=r.e||0;if(0===a)this.set(r.k,r.v);else{var i=a-t;i>0&&this.set(r.k,r.v,i)}}}},{key:"prune",value:function(){var e=this;this[p].forEach((function(t,n){return y(e,n,!1)}))}}]),e}(),y=function(e,t,n){var r=e[p].get(t);if(r){var a=r.value;if(b(e,a)){if(w(e,r),!e[c])return}else n&&(e[v]&&(r.value.now=Date.now()),e[h].unshiftNode(r));return a.value}},b=function(e,t){if(!t||!t.maxAge&&!e[l])return!1;var n=Date.now()-t.now;return t.maxAge?n>t.maxAge:e[l]&&n>e[l]},x=function(e){if(e[u]>e[o])for(var t=e[h].tail;e[u]>e[o]&&null!==t;){var n=t.prev;w(e,t),t=n}},w=function(e,t){if(t){var n=t.value;e[f]&&e[f](n.key,n.value),e[u]-=n.length,e[p].delete(n.key),e[h].removeNode(t)}},k=a((function e(t,n,a,i,o){r(this,e),this.key=t,this.value=n,this.length=a,this.now=i,this.maxAge=o||0})),_=function(e,t,n,r){var a=n.value;b(e,a)&&(w(e,n),e[c]||(a=void 0)),a&&t.call(r,a.value,a.key,e)};e.exports=g},3042:function(e,t,n){var r=n(6690).default,a=n(9728).default,i=Symbol("SemVer ANY"),o=function(){"use strict";function e(t,n){if(r(this,e),n=u(n),t instanceof e){if(t.loose===!!n.loose)return t;t=t.value}d("comparator",t,n),this.options=n,this.loose=!!n.loose,this.parse(t),this.semver===i?this.value="":this.value=this.operator+this.semver.version,d("comp",this)}return a(e,[{key:"parse",value:function(e){var t=this.options.loose?c[l.COMPARATORLOOSE]:c[l.COMPARATOR],n=e.match(t);if(!n)throw new TypeError("Invalid comparator: ".concat(e));this.operator=void 0!==n[1]?n[1]:"","="===this.operator&&(this.operator=""),n[2]?this.semver=new h(n[2],this.options.loose):this.semver=i}},{key:"toString",value:function(){return this.value}},{key:"test",value:function(e){if(d("Comparator.test",e,this.options.loose),this.semver===i||e===i)return!0;if("string"===typeof e)try{e=new h(e,this.options)}catch(t){return!1}return f(e,this.operator,this.semver,this.options)}},{key:"intersects",value:function(t,n){if(!(t instanceof e))throw new TypeError("a Comparator is required");if(n&&"object"===typeof n||(n={loose:!!n,includePrerelease:!1}),""===this.operator)return""===this.value||new p(t.value,n).test(this.value);if(""===t.operator)return""===t.value||new p(this.value,n).test(t.semver);var r=(">="===this.operator||">"===this.operator)&&(">="===t.operator||">"===t.operator),a=("<="===this.operator||"<"===this.operator)&&("<="===t.operator||"<"===t.operator),i=this.semver.version===t.semver.version,o=(">="===this.operator||"<="===this.operator)&&(">="===t.operator||"<="===t.operator),u=f(this.semver,"<",t.semver,n)&&(">="===this.operator||">"===this.operator)&&("<="===t.operator||"<"===t.operator),s=f(this.semver,">",t.semver,n)&&("<="===this.operator||"<"===this.operator)&&(">="===t.operator||">"===t.operator);return r||a||i&&o||u||s}}],[{key:"ANY",get:function(){return i}}]),e}();e.exports=o;var u=n(7826),s=n(9601),c=s.re,l=s.t,f=n(2956),d=n(5290),h=n(6028),p=n(7291)},7291:function(e,t,n){var r=n(861).default,a=n(4704).default,i=n(6690).default,o=n(9728).default,u=function(){"use strict";function e(t,n){var r=this;if(i(this,e),n=c(n),t instanceof e)return t.loose===!!n.loose&&t.includePrerelease===!!n.includePrerelease?t:new e(t.raw,n);if(t instanceof l)return this.raw=t.value,this.set=[[t]],this.format(),this;if(this.options=n,this.loose=!!n.loose,this.includePrerelease=!!n.includePrerelease,this.raw=t,this.set=t.split("||").map((function(e){return r.parseRange(e.trim())})).filter((function(e){return e.length})),!this.set.length)throw new TypeError("Invalid SemVer Range: ".concat(t));if(this.set.length>1){var o=this.set[0];if(this.set=this.set.filter((function(e){return!b(e[0])})),0===this.set.length)this.set=[o];else if(this.set.length>1){var u,s=a(this.set);try{for(s.s();!(u=s.n()).done;){var f=u.value;if(1===f.length&&x(f[0])){this.set=[f];break}}}catch(d){s.e(d)}finally{s.f()}}}this.format()}return o(e,[{key:"format",value:function(){return this.range=this.set.map((function(e){return e.join(" ").trim()})).join("||").trim(),this.range}},{key:"toString",value:function(){return this.range}},{key:"parseRange",value:function(e){var t=this;e=e.trim();var n=Object.keys(this.options).join(","),i="parseRange:".concat(n,":").concat(e),o=s.get(i);if(o)return o;var u=this.options.loose,c=u?p[v.HYPHENRANGELOOSE]:p[v.HYPHENRANGE];e=e.replace(c,F(this.options.includePrerelease)),f("hyphen replace",e),e=e.replace(p[v.COMPARATORTRIM],m),f("comparator trim",e);var d=(e=(e=(e=e.replace(p[v.TILDETRIM],g)).replace(p[v.CARETTRIM],y)).split(/\s+/).join(" ")).split(" ").map((function(e){return k(e,t.options)})).join(" ").split(/\s+/).map((function(e){return D(e,t.options)}));u&&(d=d.filter((function(e){return f("loose invalid filter",e,t.options),!!e.match(p[v.COMPARATORLOOSE])}))),f("range list",d);var h,x=new Map,w=d.map((function(e){return new l(e,t.options)})),_=a(w);try{for(_.s();!(h=_.n()).done;){var S=h.value;if(b(S))return[S];x.set(S.value,S)}}catch(A){_.e(A)}finally{_.f()}x.size>1&&x.has("")&&x.delete("");var C=r(x.values());return s.set(i,C),C}},{key:"intersects",value:function(t,n){if(!(t instanceof e))throw new TypeError("a Range is required");return this.set.some((function(e){return w(e,n)&&t.set.some((function(t){return w(t,n)&&e.every((function(e){return t.every((function(t){return e.intersects(t,n)}))}))}))}))}},{key:"test",value:function(e){if(!e)return!1;if("string"===typeof e)try{e=new d(e,this.options)}catch(n){return!1}for(var t=0;t<this.set.length;t++)if(M(this.set[t],e,this.options))return!0;return!1}}]),e}();e.exports=u;var s=new(n(7799))({max:1e3}),c=n(7826),l=n(3042),f=n(5290),d=n(6028),h=n(9601),p=h.re,v=h.t,m=h.comparatorTrimReplace,g=h.tildeTrimReplace,y=h.caretTrimReplace,b=function(e){return"<0.0.0-0"===e.value},x=function(e){return""===e.value},w=function(e,t){for(var n=!0,r=e.slice(),a=r.pop();n&&r.length;)n=r.every((function(e){return a.intersects(e,t)})),a=r.pop();return n},k=function(e,t){return f("comp",e,t),e=A(e,t),f("caret",e),e=S(e,t),f("tildes",e),e=N(e,t),f("xrange",e),e=I(e,t),f("stars",e),e},_=function(e){return!e||"x"===e.toLowerCase()||"*"===e},S=function(e,t){return e.trim().split(/\s+/).map((function(e){return C(e,t)})).join(" ")},C=function(e,t){var n=t.loose?p[v.TILDELOOSE]:p[v.TILDE];return e.replace(n,(function(t,n,r,a,i){var o;return f("tilde",e,t,n,r,a,i),_(n)?o="":_(r)?o=">=".concat(n,".0.0 <").concat(+n+1,".0.0-0"):_(a)?o=">=".concat(n,".").concat(r,".0 <").concat(n,".").concat(+r+1,".0-0"):i?(f("replaceTilde pr",i),o=">=".concat(n,".").concat(r,".").concat(a,"-").concat(i," <").concat(n,".").concat(+r+1,".0-0")):o=">=".concat(n,".").concat(r,".").concat(a," <").concat(n,".").concat(+r+1,".0-0"),f("tilde return",o),o}))},A=function(e,t){return e.trim().split(/\s+/).map((function(e){return E(e,t)})).join(" ")},E=function(e,t){f("caret",e,t);var n=t.loose?p[v.CARETLOOSE]:p[v.CARET],r=t.includePrerelease?"-0":"";return e.replace(n,(function(t,n,a,i,o){var u;return f("caret",e,t,n,a,i,o),_(n)?u="":_(a)?u=">=".concat(n,".0.0").concat(r," <").concat(+n+1,".0.0-0"):_(i)?u="0"===n?">=".concat(n,".").concat(a,".0").concat(r," <").concat(n,".").concat(+a+1,".0-0"):">=".concat(n,".").concat(a,".0").concat(r," <").concat(+n+1,".0.0-0"):o?(f("replaceCaret pr",o),u="0"===n?"0"===a?">=".concat(n,".").concat(a,".").concat(i,"-").concat(o," <").concat(n,".").concat(a,".").concat(+i+1,"-0"):">=".concat(n,".").concat(a,".").concat(i,"-").concat(o," <").concat(n,".").concat(+a+1,".0-0"):">=".concat(n,".").concat(a,".").concat(i,"-").concat(o," <").concat(+n+1,".0.0-0")):(f("no pr"),u="0"===n?"0"===a?">=".concat(n,".").concat(a,".").concat(i).concat(r," <").concat(n,".").concat(a,".").concat(+i+1,"-0"):">=".concat(n,".").concat(a,".").concat(i).concat(r," <").concat(n,".").concat(+a+1,".0-0"):">=".concat(n,".").concat(a,".").concat(i," <").concat(+n+1,".0.0-0")),f("caret return",u),u}))},N=function(e,t){return f("replaceXRanges",e,t),e.split(/\s+/).map((function(e){return T(e,t)})).join(" ")},T=function(e,t){e=e.trim();var n=t.loose?p[v.XRANGELOOSE]:p[v.XRANGE];return e.replace(n,(function(n,r,a,i,o,u){f("xRange",e,n,r,a,i,o,u);var s=_(a),c=s||_(i),l=c||_(o),d=l;return"="===r&&d&&(r=""),u=t.includePrerelease?"-0":"",s?n=">"===r||"<"===r?"<0.0.0-0":"*":r&&d?(c&&(i=0),o=0,">"===r?(r=">=",c?(a=+a+1,i=0,o=0):(i=+i+1,o=0)):"<="===r&&(r="<",c?a=+a+1:i=+i+1),"<"===r&&(u="-0"),n="".concat(r+a,".").concat(i,".").concat(o).concat(u)):c?n=">=".concat(a,".0.0").concat(u," <").concat(+a+1,".0.0-0"):l&&(n=">=".concat(a,".").concat(i,".0").concat(u," <").concat(a,".").concat(+i+1,".0-0")),f("xRange return",n),n}))},I=function(e,t){return f("replaceStars",e,t),e.trim().replace(p[v.STAR],"")},D=function(e,t){return f("replaceGTE0",e,t),e.trim().replace(p[t.includePrerelease?v.GTE0PRE:v.GTE0],"")},F=function(e){return function(t,n,r,a,i,o,u,s,c,l,f,d,h){return n=_(r)?"":_(a)?">=".concat(r,".0.0").concat(e?"-0":""):_(i)?">=".concat(r,".").concat(a,".0").concat(e?"-0":""):o?">=".concat(n):">=".concat(n).concat(e?"-0":""),s=_(c)?"":_(l)?"<".concat(+c+1,".0.0-0"):_(f)?"<".concat(c,".").concat(+l+1,".0-0"):d?"<=".concat(c,".").concat(l,".").concat(f,"-").concat(d):e?"<".concat(c,".").concat(l,".").concat(+f+1,"-0"):"<=".concat(s),"".concat(n," ").concat(s).trim()}},M=function(e,t,n){for(var r=0;r<e.length;r++)if(!e[r].test(t))return!1;if(t.prerelease.length&&!n.includePrerelease){for(var a=0;a<e.length;a++)if(f(e[a].semver),e[a].semver!==l.ANY&&e[a].semver.prerelease.length>0){var i=e[a].semver;if(i.major===t.major&&i.minor===t.minor&&i.patch===t.patch)return!0}return!1}return!0}},6028:function(e,t,n){var r=n(6690).default,a=n(9728).default,i=n(5290),o=n(6871),u=o.MAX_LENGTH,s=o.MAX_SAFE_INTEGER,c=n(9601),l=c.re,f=c.t,d=n(7826),h=n(8237).compareIdentifiers,p=function(){"use strict";function e(t,n){if(r(this,e),n=d(n),t instanceof e){if(t.loose===!!n.loose&&t.includePrerelease===!!n.includePrerelease)return t;t=t.version}else if("string"!==typeof t)throw new TypeError("Invalid Version: ".concat(t));if(t.length>u)throw new TypeError("version is longer than ".concat(u," characters"));i("SemVer",t,n),this.options=n,this.loose=!!n.loose,this.includePrerelease=!!n.includePrerelease;var a=t.trim().match(n.loose?l[f.LOOSE]:l[f.FULL]);if(!a)throw new TypeError("Invalid Version: ".concat(t));if(this.raw=t,this.major=+a[1],this.minor=+a[2],this.patch=+a[3],this.major>s||this.major<0)throw new TypeError("Invalid major version");if(this.minor>s||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>s||this.patch<0)throw new TypeError("Invalid patch version");a[4]?this.prerelease=a[4].split(".").map((function(e){if(/^[0-9]+$/.test(e)){var t=+e;if(t>=0&&t<s)return t}return e})):this.prerelease=[],this.build=a[5]?a[5].split("."):[],this.format()}return a(e,[{key:"format",value:function(){return this.version="".concat(this.major,".").concat(this.minor,".").concat(this.patch),this.prerelease.length&&(this.version+="-".concat(this.prerelease.join("."))),this.version}},{key:"toString",value:function(){return this.version}},{key:"compare",value:function(t){if(i("SemVer.compare",this.version,this.options,t),!(t instanceof e)){if("string"===typeof t&&t===this.version)return 0;t=new e(t,this.options)}return t.version===this.version?0:this.compareMain(t)||this.comparePre(t)}},{key:"compareMain",value:function(t){return t instanceof e||(t=new e(t,this.options)),h(this.major,t.major)||h(this.minor,t.minor)||h(this.patch,t.patch)}},{key:"comparePre",value:function(t){if(t instanceof e||(t=new e(t,this.options)),this.prerelease.length&&!t.prerelease.length)return-1;if(!this.prerelease.length&&t.prerelease.length)return 1;if(!this.prerelease.length&&!t.prerelease.length)return 0;var n=0;do{var r=this.prerelease[n],a=t.prerelease[n];if(i("prerelease compare",n,r,a),void 0===r&&void 0===a)return 0;if(void 0===a)return 1;if(void 0===r)return-1;if(r!==a)return h(r,a)}while(++n)}},{key:"compareBuild",value:function(t){t instanceof e||(t=new e(t,this.options));var n=0;do{var r=this.build[n],a=t.build[n];if(i("prerelease compare",n,r,a),void 0===r&&void 0===a)return 0;if(void 0===a)return 1;if(void 0===r)return-1;if(r!==a)return h(r,a)}while(++n)}},{key:"inc",value:function(e,t){switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t),this.inc("pre",t);break;case"prerelease":0===this.prerelease.length&&this.inc("patch",t),this.inc("pre",t);break;case"major":0===this.minor&&0===this.patch&&0!==this.prerelease.length||this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":0===this.patch&&0!==this.prerelease.length||this.minor++,this.patch=0,this.prerelease=[];break;case"patch":0===this.prerelease.length&&this.patch++,this.prerelease=[];break;case"pre":if(0===this.prerelease.length)this.prerelease=[0];else{for(var n=this.prerelease.length;--n>=0;)"number"===typeof this.prerelease[n]&&(this.prerelease[n]++,n=-2);-1===n&&this.prerelease.push(0)}t&&(0===h(this.prerelease[0],t)?isNaN(this.prerelease[1])&&(this.prerelease=[t,0]):this.prerelease=[t,0]);break;default:throw new Error("invalid increment argument: ".concat(e))}return this.format(),this.raw=this.version,this}}]),e}();e.exports=p},6252:function(e,t,n){var r=n(1783);e.exports=function(e,t){var n=r(e.trim().replace(/^[=v]+/,""),t);return n?n.version:null}},2956:function(e,t,n){var r=n(2380),a=n(906),i=n(5863),o=n(1168),u=n(3602),s=n(3870);e.exports=function(e,t,n,c){switch(t){case"===":return"object"===typeof e&&(e=e.version),"object"===typeof n&&(n=n.version),e===n;case"!==":return"object"===typeof e&&(e=e.version),"object"===typeof n&&(n=n.version),e!==n;case"":case"=":case"==":return r(e,n,c);case"!=":return a(e,n,c);case">":return i(e,n,c);case">=":return o(e,n,c);case"<":return u(e,n,c);case"<=":return s(e,n,c);default:throw new TypeError("Invalid operator: ".concat(t))}}},1633:function(e,t,n){var r=n(6028),a=n(1783),i=n(9601),o=i.re,u=i.t;e.exports=function(e,t){if(e instanceof r)return e;if("number"===typeof e&&(e=String(e)),"string"!==typeof e)return null;var n=null;if((t=t||{}).rtl){for(var i;(i=o[u.COERCERTL].exec(e))&&(!n||n.index+n[0].length!==e.length);)n&&i.index+i[0].length===n.index+n[0].length||(n=i),o[u.COERCERTL].lastIndex=i.index+i[1].length+i[2].length;o[u.COERCERTL].lastIndex=-1}else n=e.match(o[u.COERCE]);return null===n?null:a("".concat(n[2],".").concat(n[3]||"0",".").concat(n[4]||"0"),t)}},9274:function(e,t,n){var r=n(6028);e.exports=function(e,t,n){var a=new r(e,n),i=new r(t,n);return a.compare(i)||a.compareBuild(i)}},242:function(e,t,n){var r=n(6268);e.exports=function(e,t){return r(e,t,!0)}},6268:function(e,t,n){var r=n(6028);e.exports=function(e,t,n){return new r(e,n).compare(new r(t,n))}},9653:function(e,t,n){var r=n(1783),a=n(2380);e.exports=function(e,t){if(a(e,t))return null;var n=r(e),i=r(t),o=n.prerelease.length||i.prerelease.length,u=o?"pre":"",s=o?"prerelease":"";for(var c in n)if(("major"===c||"minor"===c||"patch"===c)&&n[c]!==i[c])return u+c;return s}},2380:function(e,t,n){var r=n(6268);e.exports=function(e,t,n){return 0===r(e,t,n)}},5863:function(e,t,n){var r=n(6268);e.exports=function(e,t,n){return r(e,t,n)>0}},1168:function(e,t,n){var r=n(6268);e.exports=function(e,t,n){return r(e,t,n)>=0}},5304:function(e,t,n){var r=n(6028);e.exports=function(e,t,n,a){"string"===typeof n&&(a=n,n=void 0);try{return new r(e instanceof r?e.version:e,n).inc(t,a).version}catch(i){return null}}},3602:function(e,t,n){var r=n(6268);e.exports=function(e,t,n){return r(e,t,n)<0}},3870:function(e,t,n){var r=n(6268);e.exports=function(e,t,n){return r(e,t,n)<=0}},3010:function(e,t,n){var r=n(6028);e.exports=function(e,t){return new r(e,t).major}},6333:function(e,t,n){var r=n(6028);e.exports=function(e,t){return new r(e,t).minor}},906:function(e,t,n){var r=n(6268);e.exports=function(e,t,n){return 0!==r(e,t,n)}},1783:function(e,t,n){var r=n(6871).MAX_LENGTH,a=n(9601),i=a.re,o=a.t,u=n(6028),s=n(7826);e.exports=function(e,t){if(t=s(t),e instanceof u)return e;if("string"!==typeof e)return null;if(e.length>r)return null;if(!(t.loose?i[o.LOOSE]:i[o.FULL]).test(e))return null;try{return new u(e,t)}catch(n){return null}}},4998:function(e,t,n){var r=n(6028);e.exports=function(e,t){return new r(e,t).patch}},7720:function(e,t,n){var r=n(1783);e.exports=function(e,t){var n=r(e,t);return n&&n.prerelease.length?n.prerelease:null}},9121:function(e,t,n){var r=n(6268);e.exports=function(e,t,n){return r(t,e,n)}},3079:function(e,t,n){var r=n(9274);e.exports=function(e,t){return e.sort((function(e,n){return r(n,e,t)}))}},5337:function(e,t,n){var r=n(7291);e.exports=function(e,t,n){try{t=new r(t,n)}catch(a){return!1}return t.test(e)}},5100:function(e,t,n){var r=n(9274);e.exports=function(e,t){return e.sort((function(e,n){return r(e,n,t)}))}},9591:function(e,t,n){var r=n(1783);e.exports=function(e,t){var n=r(e,t);return n?n.version:null}},6487:function(e,t,n){var r=n(9601);e.exports={re:r.re,src:r.src,tokens:r.t,SEMVER_SPEC_VERSION:n(6871).SEMVER_SPEC_VERSION,SemVer:n(6028),compareIdentifiers:n(8237).compareIdentifiers,rcompareIdentifiers:n(8237).rcompareIdentifiers,parse:n(1783),valid:n(9591),clean:n(6252),inc:n(5304),diff:n(9653),major:n(3010),minor:n(6333),patch:n(4998),prerelease:n(7720),compare:n(6268),rcompare:n(9121),compareLoose:n(242),compareBuild:n(9274),sort:n(5100),rsort:n(3079),gt:n(5863),lt:n(3602),eq:n(2380),neq:n(906),gte:n(1168),lte:n(3870),cmp:n(2956),coerce:n(1633),Comparator:n(3042),Range:n(7291),satisfies:n(5337),toComparators:n(1176),maxSatisfying:n(1753),minSatisfying:n(9779),minVersion:n(5784),validRange:n(3568),outside:n(320),gtr:n(6330),ltr:n(5126),intersects:n(7142),simplifyRange:n(3741),subset:n(306)}},6871:function(e){var t=Number.MAX_SAFE_INTEGER||9007199254740991;e.exports={SEMVER_SPEC_VERSION:"2.0.0",MAX_LENGTH:256,MAX_SAFE_INTEGER:t,MAX_SAFE_COMPONENT_LENGTH:16}},5290:function(e){var t="object"===typeof process&&{NODE_ENV:"production",PUBLIC_URL:"/blog",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.NODE_DEBUG&&/\bsemver\b/i.test({NODE_ENV:"production",PUBLIC_URL:"/blog",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.NODE_DEBUG)?function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return(e=console).error.apply(e,["SEMVER"].concat(n))}:function(){};e.exports=t},8237:function(e){var t=/^[0-9]+$/,n=function(e,n){var r=t.test(e),a=t.test(n);return r&&a&&(e=+e,n=+n),e===n?0:r&&!a?-1:a&&!r?1:e<n?-1:1};e.exports={compareIdentifiers:n,rcompareIdentifiers:function(e,t){return n(t,e)}}},7826:function(e){var t=["includePrerelease","loose","rtl"];e.exports=function(e){return e?"object"!==typeof e?{loose:!0}:t.filter((function(t){return e[t]})).reduce((function(e,t){return e[t]=!0,e}),{}):{}}},9601:function(e,t,n){var r=n(6871).MAX_SAFE_COMPONENT_LENGTH,a=n(5290),i=(t=e.exports={}).re=[],o=t.src=[],u=t.t={},s=0,c=function(e,t,n){var r=s++;a(e,r,t),u[e]=r,o[r]=t,i[r]=new RegExp(t,n?"g":void 0)};c("NUMERICIDENTIFIER","0|[1-9]\\d*"),c("NUMERICIDENTIFIERLOOSE","[0-9]+"),c("NONNUMERICIDENTIFIER","\\d*[a-zA-Z-][a-zA-Z0-9-]*"),c("MAINVERSION","(".concat(o[u.NUMERICIDENTIFIER],")\\.")+"(".concat(o[u.NUMERICIDENTIFIER],")\\.")+"(".concat(o[u.NUMERICIDENTIFIER],")")),c("MAINVERSIONLOOSE","(".concat(o[u.NUMERICIDENTIFIERLOOSE],")\\.")+"(".concat(o[u.NUMERICIDENTIFIERLOOSE],")\\.")+"(".concat(o[u.NUMERICIDENTIFIERLOOSE],")")),c("PRERELEASEIDENTIFIER","(?:".concat(o[u.NUMERICIDENTIFIER],"|").concat(o[u.NONNUMERICIDENTIFIER],")")),c("PRERELEASEIDENTIFIERLOOSE","(?:".concat(o[u.NUMERICIDENTIFIERLOOSE],"|").concat(o[u.NONNUMERICIDENTIFIER],")")),c("PRERELEASE","(?:-(".concat(o[u.PRERELEASEIDENTIFIER],"(?:\\.").concat(o[u.PRERELEASEIDENTIFIER],")*))")),c("PRERELEASELOOSE","(?:-?(".concat(o[u.PRERELEASEIDENTIFIERLOOSE],"(?:\\.").concat(o[u.PRERELEASEIDENTIFIERLOOSE],")*))")),c("BUILDIDENTIFIER","[0-9A-Za-z-]+"),c("BUILD","(?:\\+(".concat(o[u.BUILDIDENTIFIER],"(?:\\.").concat(o[u.BUILDIDENTIFIER],")*))")),c("FULLPLAIN","v?".concat(o[u.MAINVERSION]).concat(o[u.PRERELEASE],"?").concat(o[u.BUILD],"?")),c("FULL","^".concat(o[u.FULLPLAIN],"$")),c("LOOSEPLAIN","[v=\\s]*".concat(o[u.MAINVERSIONLOOSE]).concat(o[u.PRERELEASELOOSE],"?").concat(o[u.BUILD],"?")),c("LOOSE","^".concat(o[u.LOOSEPLAIN],"$")),c("GTLT","((?:<|>)?=?)"),c("XRANGEIDENTIFIERLOOSE","".concat(o[u.NUMERICIDENTIFIERLOOSE],"|x|X|\\*")),c("XRANGEIDENTIFIER","".concat(o[u.NUMERICIDENTIFIER],"|x|X|\\*")),c("XRANGEPLAIN","[v=\\s]*(".concat(o[u.XRANGEIDENTIFIER],")")+"(?:\\.(".concat(o[u.XRANGEIDENTIFIER],")")+"(?:\\.(".concat(o[u.XRANGEIDENTIFIER],")")+"(?:".concat(o[u.PRERELEASE],")?").concat(o[u.BUILD],"?")+")?)?"),c("XRANGEPLAINLOOSE","[v=\\s]*(".concat(o[u.XRANGEIDENTIFIERLOOSE],")")+"(?:\\.(".concat(o[u.XRANGEIDENTIFIERLOOSE],")")+"(?:\\.(".concat(o[u.XRANGEIDENTIFIERLOOSE],")")+"(?:".concat(o[u.PRERELEASELOOSE],")?").concat(o[u.BUILD],"?")+")?)?"),c("XRANGE","^".concat(o[u.GTLT],"\\s*").concat(o[u.XRANGEPLAIN],"$")),c("XRANGELOOSE","^".concat(o[u.GTLT],"\\s*").concat(o[u.XRANGEPLAINLOOSE],"$")),c("COERCE","".concat("(^|[^\\d])(\\d{1,").concat(r,"})")+"(?:\\.(\\d{1,".concat(r,"}))?")+"(?:\\.(\\d{1,".concat(r,"}))?")+"(?:$|[^\\d])"),c("COERCERTL",o[u.COERCE],!0),c("LONETILDE","(?:~>?)"),c("TILDETRIM","(\\s*)".concat(o[u.LONETILDE],"\\s+"),!0),t.tildeTrimReplace="$1~",c("TILDE","^".concat(o[u.LONETILDE]).concat(o[u.XRANGEPLAIN],"$")),c("TILDELOOSE","^".concat(o[u.LONETILDE]).concat(o[u.XRANGEPLAINLOOSE],"$")),c("LONECARET","(?:\\^)"),c("CARETTRIM","(\\s*)".concat(o[u.LONECARET],"\\s+"),!0),t.caretTrimReplace="$1^",c("CARET","^".concat(o[u.LONECARET]).concat(o[u.XRANGEPLAIN],"$")),c("CARETLOOSE","^".concat(o[u.LONECARET]).concat(o[u.XRANGEPLAINLOOSE],"$")),c("COMPARATORLOOSE","^".concat(o[u.GTLT],"\\s*(").concat(o[u.LOOSEPLAIN],")$|^$")),c("COMPARATOR","^".concat(o[u.GTLT],"\\s*(").concat(o[u.FULLPLAIN],")$|^$")),c("COMPARATORTRIM","(\\s*)".concat(o[u.GTLT],"\\s*(").concat(o[u.LOOSEPLAIN],"|").concat(o[u.XRANGEPLAIN],")"),!0),t.comparatorTrimReplace="$1$2$3",c("HYPHENRANGE","^\\s*(".concat(o[u.XRANGEPLAIN],")")+"\\s+-\\s+"+"(".concat(o[u.XRANGEPLAIN],")")+"\\s*$"),c("HYPHENRANGELOOSE","^\\s*(".concat(o[u.XRANGEPLAINLOOSE],")")+"\\s+-\\s+"+"(".concat(o[u.XRANGEPLAINLOOSE],")")+"\\s*$"),c("STAR","(<|>)?=?\\s*\\*"),c("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$"),c("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")},6330:function(e,t,n){var r=n(320);e.exports=function(e,t,n){return r(e,t,">",n)}},7142:function(e,t,n){var r=n(7291);e.exports=function(e,t,n){return e=new r(e,n),t=new r(t,n),e.intersects(t)}},5126:function(e,t,n){var r=n(320);e.exports=function(e,t,n){return r(e,t,"<",n)}},1753:function(e,t,n){var r=n(6028),a=n(7291);e.exports=function(e,t,n){var i=null,o=null,u=null;try{u=new a(t,n)}catch(s){return null}return e.forEach((function(e){u.test(e)&&(i&&-1!==o.compare(e)||(o=new r(i=e,n)))})),i}},9779:function(e,t,n){var r=n(6028),a=n(7291);e.exports=function(e,t,n){var i=null,o=null,u=null;try{u=new a(t,n)}catch(s){return null}return e.forEach((function(e){u.test(e)&&(i&&1!==o.compare(e)||(o=new r(i=e,n)))})),i}},5784:function(e,t,n){var r=n(6028),a=n(7291),i=n(5863);e.exports=function(e,t){e=new a(e,t);var n=new r("0.0.0");if(e.test(n))return n;if(n=new r("0.0.0-0"),e.test(n))return n;n=null;for(var o=function(t){var a=e.set[t],o=null;a.forEach((function(e){var t=new r(e.semver.version);switch(e.operator){case">":0===t.prerelease.length?t.patch++:t.prerelease.push(0),t.raw=t.format();case"":case">=":o&&!i(t,o)||(o=t);break;case"<":case"<=":break;default:throw new Error("Unexpected operation: ".concat(e.operator))}})),!o||n&&!i(n,o)||(n=o)},u=0;u<e.set.length;++u)o(u);return n&&e.test(n)?n:null}},320:function(e,t,n){var r=n(6028),a=n(3042),i=a.ANY,o=n(7291),u=n(5337),s=n(5863),c=n(3602),l=n(3870),f=n(1168);e.exports=function(e,t,n,d){var h,p,v,m,g;switch(e=new r(e,d),t=new o(t,d),n){case">":h=s,p=l,v=c,m=">",g=">=";break;case"<":h=c,p=f,v=s,m="<",g="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(u(e,t,d))return!1;for(var y=function(n){var r=t.set[n],o=null,u=null;return r.forEach((function(e){e.semver===i&&(e=new a(">=0.0.0")),o=o||e,u=u||e,h(e.semver,o.semver,d)?o=e:v(e.semver,u.semver,d)&&(u=e)})),o.operator===m||o.operator===g?{v:!1}:u.operator&&u.operator!==m||!p(e,u.semver)?u.operator===g&&v(e,u.semver)?{v:!1}:void 0:{v:!1}},b=0;b<t.set.length;++b){var x=y(b);if("object"===typeof x)return x.v}return!0}},3741:function(e,t,n){var r=n(7424).default,a=n(4704).default,i=n(5337),o=n(6268);e.exports=function(e,t,n){var u,s=[],c=null,l=null,f=e.sort((function(e,t){return o(e,t,n)})),d=a(f);try{for(d.s();!(u=d.n()).done;){var h=u.value;i(h,t,n)?(l=h,c||(c=h)):(l&&s.push([c,l]),l=null,c=null)}}catch(k){d.e(k)}finally{d.f()}c&&s.push([c,null]);for(var p=[],v=0,m=s;v<m.length;v++){var g=r(m[v],2),y=g[0],b=g[1];y===b?p.push(y):b||y!==f[0]?b?y===f[0]?p.push("<=".concat(b)):p.push("".concat(y," - ").concat(b)):p.push(">=".concat(y)):p.push("*")}var x=p.join(" || "),w="string"===typeof t.raw?t.raw:String(t);return x.length<w.length?x:t}},306:function(e,t,n){var r=n(4704).default,a=n(7291),i=n(3042),o=i.ANY,u=n(5337),s=n(6268),c=function(e,t,n){if(e===t)return!0;if(1===e.length&&e[0].semver===o){if(1===t.length&&t[0].semver===o)return!0;e=n.includePrerelease?[new i(">=0.0.0-0")]:[new i(">=0.0.0")]}if(1===t.length&&t[0].semver===o){if(n.includePrerelease)return!0;t=[new i(">=0.0.0")]}var a,c,d,h,p=new Set,v=r(e);try{for(v.s();!(d=v.n()).done;){var m=d.value;">"===m.operator||">="===m.operator?a=l(a,m,n):"<"===m.operator||"<="===m.operator?c=f(c,m,n):p.add(m.semver)}}catch(F){v.e(F)}finally{v.f()}if(p.size>1)return null;if(a&&c){if((h=s(a.semver,c.semver,n))>0)return null;if(0===h&&(">="!==a.operator||"<="!==c.operator))return null}var g,y,b,x,w,k=r(p);try{for(k.s();!(g=k.n()).done;){var _=g.value;if(a&&!u(_,String(a),n))return null;if(c&&!u(_,String(c),n))return null;var S,C=r(t);try{for(C.s();!(S=C.n()).done;){var A=S.value;if(!u(_,String(A),n))return!1}}catch(F){C.e(F)}finally{C.f()}return!0}}catch(F){k.e(F)}finally{k.f()}var E=!(!c||n.includePrerelease||!c.semver.prerelease.length)&&c.semver,N=!(!a||n.includePrerelease||!a.semver.prerelease.length)&&a.semver;E&&1===E.prerelease.length&&"<"===c.operator&&0===E.prerelease[0]&&(E=!1);var T,I=r(t);try{for(I.s();!(T=I.n()).done;){var D=T.value;if(w=w||">"===D.operator||">="===D.operator,x=x||"<"===D.operator||"<="===D.operator,a)if(N&&D.semver.prerelease&&D.semver.prerelease.length&&D.semver.major===N.major&&D.semver.minor===N.minor&&D.semver.patch===N.patch&&(N=!1),">"===D.operator||">="===D.operator){if((y=l(a,D,n))===D&&y!==a)return!1}else if(">="===a.operator&&!u(a.semver,String(D),n))return!1;if(c)if(E&&D.semver.prerelease&&D.semver.prerelease.length&&D.semver.major===E.major&&D.semver.minor===E.minor&&D.semver.patch===E.patch&&(E=!1),"<"===D.operator||"<="===D.operator){if((b=f(c,D,n))===D&&b!==c)return!1}else if("<="===c.operator&&!u(c.semver,String(D),n))return!1;if(!D.operator&&(c||a)&&0!==h)return!1}}catch(F){I.e(F)}finally{I.f()}return!(a&&x&&!c&&0!==h)&&(!(c&&w&&!a&&0!==h)&&(!N&&!E))},l=function(e,t,n){if(!e)return t;var r=s(e.semver,t.semver,n);return r>0?e:r<0||">"===t.operator&&">="===e.operator?t:e},f=function(e,t,n){if(!e)return t;var r=s(e.semver,t.semver,n);return r<0?e:r>0||"<"===t.operator&&"<="===e.operator?t:e};e.exports=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(e===t)return!0;e=new a(e,n),t=new a(t,n);var i,o=!1,u=r(e.set);try{e:for(u.s();!(i=u.n()).done;){var s,l=i.value,f=r(t.set);try{for(f.s();!(s=f.n()).done;){var d=s.value,h=c(l,d,n);if(o=o||null!==h,h)continue e}}catch(p){f.e(p)}finally{f.f()}if(o)return!1}}catch(p){u.e(p)}finally{u.f()}return!0}},1176:function(e,t,n){var r=n(7291);e.exports=function(e,t){return new r(e,t).set.map((function(e){return e.map((function(e){return e.value})).join(" ").trim().split(" ")}))}},3568:function(e,t,n){var r=n(7291);e.exports=function(e,t){try{return new r(e,t).range||"*"}catch(n){return null}}},2391:function(e){"use strict";var t=function(){};e.exports=t},4175:function(e,t,n){"use strict";var r=n(4687);e.exports=function(e){e.prototype[Symbol.iterator]=r.mark((function e(){var t;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this.head;case 1:if(!t){e.next=7;break}return e.next=4,t.value;case 4:t=t.next,e.next=1;break;case 7:case"end":return e.stop()}}),e,this)}))}},400:function(e,t,n){"use strict";function r(e){var t=this;if(t instanceof r||(t=new r),t.tail=null,t.head=null,t.length=0,e&&"function"===typeof e.forEach)e.forEach((function(e){t.push(e)}));else if(arguments.length>0)for(var n=0,a=arguments.length;n<a;n++)t.push(arguments[n]);return t}function a(e,t,n){var r=t===e.head?new u(n,null,t,e):new u(n,t,t.next,e);return null===r.next&&(e.tail=r),null===r.prev&&(e.head=r),e.length++,r}function i(e,t){e.tail=new u(t,e.tail,null,e),e.head||(e.head=e.tail),e.length++}function o(e,t){e.head=new u(t,null,e.head,e),e.tail||(e.tail=e.head),e.length++}function u(e,t,n,r){if(!(this instanceof u))return new u(e,t,n,r);this.list=r,this.value=e,t?(t.next=this,this.prev=t):this.prev=null,n?(n.prev=this,this.next=n):this.next=null}e.exports=r,r.Node=u,r.create=r,r.prototype.removeNode=function(e){if(e.list!==this)throw new Error("removing node which does not belong to this list");var t=e.next,n=e.prev;return t&&(t.prev=n),n&&(n.next=t),e===this.head&&(this.head=t),e===this.tail&&(this.tail=n),e.list.length--,e.next=null,e.prev=null,e.list=null,t},r.prototype.unshiftNode=function(e){if(e!==this.head){e.list&&e.list.removeNode(e);var t=this.head;e.list=this,e.next=t,t&&(t.prev=e),this.head=e,this.tail||(this.tail=e),this.length++}},r.prototype.pushNode=function(e){if(e!==this.tail){e.list&&e.list.removeNode(e);var t=this.tail;e.list=this,e.prev=t,t&&(t.next=e),this.tail=e,this.head||(this.head=e),this.length++}},r.prototype.push=function(){for(var e=0,t=arguments.length;e<t;e++)i(this,arguments[e]);return this.length},r.prototype.unshift=function(){for(var e=0,t=arguments.length;e<t;e++)o(this,arguments[e]);return this.length},r.prototype.pop=function(){if(this.tail){var e=this.tail.value;return this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,e}},r.prototype.shift=function(){if(this.head){var e=this.head.value;return this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,e}},r.prototype.forEach=function(e,t){t=t||this;for(var n=this.head,r=0;null!==n;r++)e.call(t,n.value,r,this),n=n.next},r.prototype.forEachReverse=function(e,t){t=t||this;for(var n=this.tail,r=this.length-1;null!==n;r--)e.call(t,n.value,r,this),n=n.prev},r.prototype.get=function(e){for(var t=0,n=this.head;null!==n&&t<e;t++)n=n.next;if(t===e&&null!==n)return n.value},r.prototype.getReverse=function(e){for(var t=0,n=this.tail;null!==n&&t<e;t++)n=n.prev;if(t===e&&null!==n)return n.value},r.prototype.map=function(e,t){t=t||this;for(var n=new r,a=this.head;null!==a;)n.push(e.call(t,a.value,this)),a=a.next;return n},r.prototype.mapReverse=function(e,t){t=t||this;for(var n=new r,a=this.tail;null!==a;)n.push(e.call(t,a.value,this)),a=a.prev;return n},r.prototype.reduce=function(e,t){var n,r=this.head;if(arguments.length>1)n=t;else{if(!this.head)throw new TypeError("Reduce of empty list with no initial value");r=this.head.next,n=this.head.value}for(var a=0;null!==r;a++)n=e(n,r.value,a),r=r.next;return n},r.prototype.reduceReverse=function(e,t){var n,r=this.tail;if(arguments.length>1)n=t;else{if(!this.tail)throw new TypeError("Reduce of empty list with no initial value");r=this.tail.prev,n=this.tail.value}for(var a=this.length-1;null!==r;a--)n=e(n,r.value,a),r=r.prev;return n},r.prototype.toArray=function(){for(var e=new Array(this.length),t=0,n=this.head;null!==n;t++)e[t]=n.value,n=n.next;return e},r.prototype.toArrayReverse=function(){for(var e=new Array(this.length),t=0,n=this.tail;null!==n;t++)e[t]=n.value,n=n.prev;return e},r.prototype.slice=function(e,t){(t=t||this.length)<0&&(t+=this.length),(e=e||0)<0&&(e+=this.length);var n=new r;if(t<e||t<0)return n;e<0&&(e=0),t>this.length&&(t=this.length);for(var a=0,i=this.head;null!==i&&a<e;a++)i=i.next;for(;null!==i&&a<t;a++,i=i.next)n.push(i.value);return n},r.prototype.sliceReverse=function(e,t){(t=t||this.length)<0&&(t+=this.length),(e=e||0)<0&&(e+=this.length);var n=new r;if(t<e||t<0)return n;e<0&&(e=0),t>this.length&&(t=this.length);for(var a=this.length,i=this.tail;null!==i&&a>t;a--)i=i.prev;for(;null!==i&&a>e;a--,i=i.prev)n.push(i.value);return n},r.prototype.splice=function(e,t){e>this.length&&(e=this.length-1),e<0&&(e=this.length+e);for(var n=0,r=this.head;null!==r&&n<e;n++)r=r.next;var i=[];for(n=0;r&&n<t;n++)i.push(r.value),r=this.removeNode(r);null===r&&(r=this.tail),r!==this.head&&r!==this.tail&&(r=r.prev);for(n=0;n<(arguments.length<=2?0:arguments.length-2);n++)r=a(this,r,n+2<2||arguments.length<=n+2?void 0:arguments[n+2]);return i},r.prototype.reverse=function(){for(var e=this.head,t=this.tail,n=e;null!==n;n=n.prev){var r=n.prev;n.prev=n.next,n.next=r}return this.head=t,this.tail=e,this};try{n(4175)(r)}catch(s){}},5410:function(){},8628:function(){},1601:function(){},7792:function(){},4977:function(){},5042:function(){},3897:function(e){e.exports=function(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r},e.exports.__esModule=!0,e.exports.default=e.exports},5372:function(e){e.exports=function(e){if(Array.isArray(e))return e},e.exports.__esModule=!0,e.exports.default=e.exports},3405:function(e,t,n){var r=n(3897);e.exports=function(e){if(Array.isArray(e))return r(e)},e.exports.__esModule=!0,e.exports.default=e.exports},6115:function(e){e.exports=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e},e.exports.__esModule=!0,e.exports.default=e.exports},6690:function(e){e.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},e.exports.__esModule=!0,e.exports.default=e.exports},9728:function(e,t,n){var r=n(4062);function a(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,r(a.key),a)}}e.exports=function(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e},e.exports.__esModule=!0,e.exports.default=e.exports},4704:function(e,t,n){var r=n(6116);e.exports=function(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=r(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var a=0,i=function(){};return{s:i,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,u=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return u=e.done,e},e:function(e){s=!0,o=e},f:function(){try{u||null==n.return||n.return()}finally{if(s)throw o}}}},e.exports.__esModule=!0,e.exports.default=e.exports},6389:function(e,t,n){var r=n(3808),a=n(9617),i=n(4993);e.exports=function(e){var t=a();return function(){var n,a=r(e);if(t){var o=r(this).constructor;n=Reflect.construct(a,arguments,o)}else n=a.apply(this,arguments);return i(this,n)}},e.exports.__esModule=!0,e.exports.default=e.exports},8416:function(e,t,n){var r=n(4062);e.exports=function(e,t,n){return(t=r(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e},e.exports.__esModule=!0,e.exports.default=e.exports},3808:function(e){function t(n){return e.exports=t=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},e.exports.__esModule=!0,e.exports.default=e.exports,t(n)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports},1655:function(e,t,n){var r=n(6015);e.exports=function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&r(e,t)},e.exports.__esModule=!0,e.exports.default=e.exports},9617:function(e){function t(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(n){}return(e.exports=t=function(){return!!n},e.exports.__esModule=!0,e.exports.default=e.exports)()}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports},3049:function(e){e.exports=function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)},e.exports.__esModule=!0,e.exports.default=e.exports},8872:function(e){e.exports=function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,i,o,u=[],s=!0,c=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=i.call(n)).done)&&(u.push(r.value),u.length!==t);s=!0);}catch(e){c=!0,a=e}finally{try{if(!s&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(c)throw a}}return u}},e.exports.__esModule=!0,e.exports.default=e.exports},2218:function(e){e.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},e.exports.__esModule=!0,e.exports.default=e.exports},2281:function(e){e.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},e.exports.__esModule=!0,e.exports.default=e.exports},4993:function(e,t,n){var r=n(8698).default,a=n(6115);e.exports=function(e,t){if(t&&("object"===r(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return a(e)},e.exports.__esModule=!0,e.exports.default=e.exports},7061:function(e,t,n){var r=n(8698).default;function a(){"use strict";e.exports=a=function(){return n},e.exports.__esModule=!0,e.exports.default=e.exports;var t,n={},i=Object.prototype,o=i.hasOwnProperty,u=Object.defineProperty||function(e,t,n){e[t]=n.value},s="function"==typeof Symbol?Symbol:{},c=s.iterator||"@@iterator",l=s.asyncIterator||"@@asyncIterator",f=s.toStringTag||"@@toStringTag";function d(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{d({},"")}catch(t){d=function(e,t,n){return e[t]=n}}function h(e,t,n,r){var a=t&&t.prototype instanceof b?t:b,i=Object.create(a.prototype),o=new F(r||[]);return u(i,"_invoke",{value:N(e,n,o)}),i}function p(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}n.wrap=h;var v="suspendedStart",m="executing",g="completed",y={};function b(){}function x(){}function w(){}var k={};d(k,c,(function(){return this}));var _=Object.getPrototypeOf,S=_&&_(_(M([])));S&&S!==i&&o.call(S,c)&&(k=S);var C=w.prototype=b.prototype=Object.create(k);function A(e){["next","throw","return"].forEach((function(t){d(e,t,(function(e){return this._invoke(t,e)}))}))}function E(e,t){function n(a,i,u,s){var c=p(e[a],e,i);if("throw"!==c.type){var l=c.arg,f=l.value;return f&&"object"==r(f)&&o.call(f,"__await")?t.resolve(f.__await).then((function(e){n("next",e,u,s)}),(function(e){n("throw",e,u,s)})):t.resolve(f).then((function(e){l.value=e,u(l)}),(function(e){return n("throw",e,u,s)}))}s(c.arg)}var a;u(this,"_invoke",{value:function(e,r){function i(){return new t((function(t,a){n(e,r,t,a)}))}return a=a?a.then(i,i):i()}})}function N(e,n,r){var a=v;return function(i,o){if(a===m)throw new Error("Generator is already running");if(a===g){if("throw"===i)throw o;return{value:t,done:!0}}for(r.method=i,r.arg=o;;){var u=r.delegate;if(u){var s=T(u,r);if(s){if(s===y)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(a===v)throw a=g,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);a=m;var c=p(e,n,r);if("normal"===c.type){if(a=r.done?g:"suspendedYield",c.arg===y)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(a=g,r.method="throw",r.arg=c.arg)}}}function T(e,n){var r=n.method,a=e.iterator[r];if(a===t)return n.delegate=null,"throw"===r&&e.iterator.return&&(n.method="return",n.arg=t,T(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),y;var i=p(a,e.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,y;var o=i.arg;return o?o.done?(n[e.resultName]=o.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,y):o:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,y)}function I(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function D(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function F(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(I,this),this.reset(!0)}function M(e){if(e||""===e){var n=e[c];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var a=-1,i=function n(){for(;++a<e.length;)if(o.call(e,a))return n.value=e[a],n.done=!1,n;return n.value=t,n.done=!0,n};return i.next=i}}throw new TypeError(r(e)+" is not iterable")}return x.prototype=w,u(C,"constructor",{value:w,configurable:!0}),u(w,"constructor",{value:x,configurable:!0}),x.displayName=d(w,f,"GeneratorFunction"),n.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===x||"GeneratorFunction"===(t.displayName||t.name))},n.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,w):(e.__proto__=w,d(e,f,"GeneratorFunction")),e.prototype=Object.create(C),e},n.awrap=function(e){return{__await:e}},A(E.prototype),d(E.prototype,l,(function(){return this})),n.AsyncIterator=E,n.async=function(e,t,r,a,i){void 0===i&&(i=Promise);var o=new E(h(e,t,r,a),i);return n.isGeneratorFunction(t)?o:o.next().then((function(e){return e.done?e.value:o.next()}))},A(C),d(C,f,"Generator"),d(C,c,(function(){return this})),d(C,"toString",(function(){return"[object Generator]"})),n.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},n.values=M,F.prototype={constructor:F,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(D),!e)for(var n in this)"t"===n.charAt(0)&&o.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function r(r,a){return u.type="throw",u.arg=e,n.next=r,a&&(n.method="next",n.arg=t),!!a}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],u=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var s=o.call(i,"catchLoc"),c=o.call(i,"finallyLoc");if(s&&c){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&o.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var a=r;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=e,i.arg=t,a?(this.method="next",this.next=a.finallyLoc,y):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),y},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),D(n),y}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var a=r.arg;D(n)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:M(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),y}},n}e.exports=a,e.exports.__esModule=!0,e.exports.default=e.exports},6015:function(e){function t(n,r){return e.exports=t=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},e.exports.__esModule=!0,e.exports.default=e.exports,t(n,r)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports},7424:function(e,t,n){var r=n(5372),a=n(8872),i=n(6116),o=n(2218);e.exports=function(e,t){return r(e)||a(e,t)||i(e,t)||o()},e.exports.__esModule=!0,e.exports.default=e.exports},861:function(e,t,n){var r=n(3405),a=n(3049),i=n(6116),o=n(2281);e.exports=function(e){return r(e)||a(e)||i(e)||o()},e.exports.__esModule=!0,e.exports.default=e.exports},5036:function(e,t,n){var r=n(8698).default;e.exports=function(e,t){if("object"!=r(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var a=n.call(e,t||"default");if("object"!=r(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)},e.exports.__esModule=!0,e.exports.default=e.exports},4062:function(e,t,n){var r=n(8698).default,a=n(5036);e.exports=function(e){var t=a(e,"string");return"symbol"==r(t)?t:String(t)},e.exports.__esModule=!0,e.exports.default=e.exports},8698:function(e){function t(n){return e.exports=t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.__esModule=!0,e.exports.default=e.exports,t(n)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports},6116:function(e,t,n){var r=n(3897);e.exports=function(e,t){if(e){if("string"===typeof e)return r(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(e,t):void 0}},e.exports.__esModule=!0,e.exports.default=e.exports},4687:function(e,t,n){var r=n(7061)();e.exports=r;try{regeneratorRuntime=r}catch(a){"object"===typeof globalThis?globalThis.regeneratorRuntime=r:Function("r","regeneratorRuntime = r")(r)}},1418:function(e,t){var n;!function(){"use strict";var r={}.hasOwnProperty;function a(){for(var e="",t=0;t<arguments.length;t++){var n=arguments[t];n&&(e=o(e,i(n)))}return e}function i(e){if("string"===typeof e||"number"===typeof e)return e;if("object"!==typeof e)return"";if(Array.isArray(e))return a.apply(null,e);if(e.toString!==Object.prototype.toString&&!e.toString.toString().includes("[native code]"))return e.toString();var t="";for(var n in e)r.call(e,n)&&e[n]&&(t=o(t,n));return t}function o(e,t){return t?e?e+" "+t:e+t:e}e.exports?(a.default=a,e.exports=a):void 0===(n=function(){return a}.apply(t,[]))||(e.exports=n)}()},3333:function(e){"use strict";var t=/("(?:[^\\"]|\\.)*")|[:,]/g;e.exports=function(e,n){var r,a,i;return n=n||{},r=JSON.stringify([1],void 0,void 0===n.indent?2:n.indent).slice(2,-3),a=""===r?1/0:void 0===n.maxLength?80:n.maxLength,i=n.replacer,function e(n,o,u){var s,c,l,f,d,h,p,v,m,g,y,b;if(n&&"function"===typeof n.toJSON&&(n=n.toJSON()),void 0===(y=JSON.stringify(n,i)))return y;if(p=a-o.length-u,y.length<=p&&(m=y.replace(t,(function(e,t){return t||e+" "}))).length<=p)return m;if(null!=i&&(n=JSON.parse(y),i=void 0),"object"===typeof n&&null!==n){if(v=o+r,l=[],c=0,Array.isArray(n))for(g="[",s="]",p=n.length;c<p;c++)l.push(e(n[c],v,c===p-1?0:1)||"null");else for(g="{",s="}",p=(h=Object.keys(n)).length;c<p;c++)f=h[c],d=JSON.stringify(f)+": ",void 0!==(b=e(n[f],v,d.length+(c===p-1?0:1)))&&l.push(d+b);if(l.length>0)return[g,r+l.join(",\n"+v),s].join("\n"+o)}return y}(e,"",0)}},907:function(e,t,n){"use strict";function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}n.d(t,{Z:function(){return r}})},3878:function(e,t,n){"use strict";function r(e){if(Array.isArray(e))return e}n.d(t,{Z:function(){return r}})},7326:function(e,t,n){"use strict";function r(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}n.d(t,{Z:function(){return r}})},5861:function(e,t,n){"use strict";function r(e,t,n,r,a,i,o){try{var u=e[i](o),s=u.value}catch(c){return void n(c)}u.done?t(s):Promise.resolve(s).then(r,a)}function a(e){return function(){var t=this,n=arguments;return new Promise((function(a,i){var o=e.apply(t,n);function u(e){r(o,a,i,u,s,"next",e)}function s(e){r(o,a,i,u,s,"throw",e)}u(void 0)}))}}n.d(t,{Z:function(){return a}})},5671:function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}n.d(t,{Z:function(){return r}})},5647:function(e,t,n){"use strict";n.d(t,{Z:function(){return i}});var r=n(9611),a=n(8814);function i(e,t,n){if((0,a.Z)())return Reflect.construct.apply(null,arguments);var i=[null];i.push.apply(i,t);var o=new(e.bind.apply(e,i));return n&&(0,r.Z)(o,n.prototype),o}},3144:function(e,t,n){"use strict";n.d(t,{Z:function(){return i}});var r=n(9142);function a(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,(0,r.Z)(a.key),a)}}function i(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}},7762:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});var r=n(181);function a(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=(0,r.Z)(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var a=0,i=function(){};return{s:i,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,u=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return u=e.done,e},e:function(e){s=!0,o=e},f:function(){try{u||null==n.return||n.return()}finally{if(s)throw o}}}}},7277:function(e,t,n){"use strict";n.d(t,{Z:function(){return s}});var r=n(1120),a=n(8814),i=n(1002),o=n(7326);function u(e,t){if(t&&("object"===(0,i.Z)(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return(0,o.Z)(e)}function s(e){var t=(0,a.Z)();return function(){var n,a=(0,r.Z)(e);if(t){var i=(0,r.Z)(this).constructor;n=Reflect.construct(a,arguments,i)}else n=a.apply(this,arguments);return u(this,n)}}},4942:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});var r=n(9142);function a(e,t,n){return(t=(0,r.Z)(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}},1752:function(e,t,n){"use strict";n.d(t,{Z:function(){return i}});var r=n(1120);function a(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=(0,r.Z)(e)););return e}function i(){return i="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=a(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(arguments.length<3?e:n):i.value}},i.apply(this,arguments)}},1120:function(e,t,n){"use strict";function r(e){return r=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},r(e)}n.d(t,{Z:function(){return r}})},136:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});var r=n(9611);function a(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&(0,r.Z)(e,t)}},8814:function(e,t,n){"use strict";function r(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(r=function(){return!!e})()}n.d(t,{Z:function(){return r}})},9199:function(e,t,n){"use strict";function r(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}n.d(t,{Z:function(){return r}})},5267:function(e,t,n){"use strict";function r(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}n.d(t,{Z:function(){return r}})},9611:function(e,t,n){"use strict";function r(e,t){return r=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},r(e,t)}n.d(t,{Z:function(){return r}})},9439:function(e,t,n){"use strict";n.d(t,{Z:function(){return o}});var r=n(3878);var a=n(181),i=n(5267);function o(e,t){return(0,r.Z)(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,i,o,u=[],s=!0,c=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=i.call(n)).done)&&(u.push(r.value),u.length!==t);s=!0);}catch(e){c=!0,a=e}finally{try{if(!s&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(c)throw a}}return u}}(e,t)||(0,a.Z)(e,t)||(0,i.Z)()}},4506:function(e,t,n){"use strict";n.d(t,{Z:function(){return u}});var r=n(3878),a=n(9199),i=n(181),o=n(5267);function u(e){return(0,r.Z)(e)||(0,a.Z)(e)||(0,i.Z)(e)||(0,o.Z)()}},3433:function(e,t,n){"use strict";n.d(t,{Z:function(){return o}});var r=n(907);var a=n(9199),i=n(181);function o(e){return function(e){if(Array.isArray(e))return(0,r.Z)(e)}(e)||(0,a.Z)(e)||(0,i.Z)(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}},9142:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});var r=n(1002);function a(e){var t=function(e,t){if("object"!=(0,r.Z)(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var a=n.call(e,t||"default");if("object"!=(0,r.Z)(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==(0,r.Z)(t)?t:String(t)}},1002:function(e,t,n){"use strict";function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}n.d(t,{Z:function(){return r}})},181:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});var r=n(907);function a(e,t){if(e){if("string"===typeof e)return(0,r.Z)(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?(0,r.Z)(e,t):void 0}}},8664:function(e,t,n){"use strict";n.d(t,{Z:function(){return o}});var r=n(1120),a=n(9611);var i=n(5647);function o(e){var t="function"===typeof Map?new Map:void 0;return o=function(e){if(null===e||!function(e){try{return-1!==Function.toString.call(e).indexOf("[native code]")}catch(t){return"function"===typeof e}}(e))return e;if("function"!==typeof e)throw new TypeError("Super expression must either be null or a function");if("undefined"!==typeof t){if(t.has(e))return t.get(e);t.set(e,n)}function n(){return(0,i.Z)(e,arguments,(0,r.Z)(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),(0,a.Z)(n,e)},o(e)}},5010:function(e,t,n){"use strict";n.d(t,{B8:function(){return S},Il:function(){return a},J5:function(){return o},SU:function(){return _},Ss:function(){return C},Ym:function(){return M},ZP:function(){return x},xV:function(){return i}});var r=n(170);function a(){}var i=.7,o=1/i,u="\\s*([+-]?\\d+)\\s*",s="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",c="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",l=/^#([0-9a-f]{3,8})$/,f=new RegExp("^rgb\\(".concat(u,",").concat(u,",").concat(u,"\\)$")),d=new RegExp("^rgb\\(".concat(c,",").concat(c,",").concat(c,"\\)$")),h=new RegExp("^rgba\\(".concat(u,",").concat(u,",").concat(u,",").concat(s,"\\)$")),p=new RegExp("^rgba\\(".concat(c,",").concat(c,",").concat(c,",").concat(s,"\\)$")),v=new RegExp("^hsl\\(".concat(s,",").concat(c,",").concat(c,"\\)$")),m=new RegExp("^hsla\\(".concat(s,",").concat(c,",").concat(c,",").concat(s,"\\)$")),g={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function y(){return this.rgb().formatHex()}function b(){return this.rgb().formatRgb()}function x(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=l.exec(e))?(n=t[1].length,t=parseInt(t[1],16),6===n?w(t):3===n?new C(t>>8&15|t>>4&240,t>>4&15|240&t,(15&t)<<4|15&t,1):8===n?k(t>>24&255,t>>16&255,t>>8&255,(255&t)/255):4===n?k(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|240&t,((15&t)<<4|15&t)/255):null):(t=f.exec(e))?new C(t[1],t[2],t[3],1):(t=d.exec(e))?new C(255*t[1]/100,255*t[2]/100,255*t[3]/100,1):(t=h.exec(e))?k(t[1],t[2],t[3],t[4]):(t=p.exec(e))?k(255*t[1]/100,255*t[2]/100,255*t[3]/100,t[4]):(t=v.exec(e))?D(t[1],t[2]/100,t[3]/100,1):(t=m.exec(e))?D(t[1],t[2]/100,t[3]/100,t[4]):g.hasOwnProperty(e)?w(g[e]):"transparent"===e?new C(NaN,NaN,NaN,0):null}function w(e){return new C(e>>16&255,e>>8&255,255&e,1)}function k(e,t,n,r){return r<=0&&(e=t=n=NaN),new C(e,t,n,r)}function _(e){return e instanceof a||(e=x(e)),e?new C((e=e.rgb()).r,e.g,e.b,e.opacity):new C}function S(e,t,n,r){return 1===arguments.length?_(e):new C(e,t,n,null==r?1:r)}function C(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}function A(){return"#".concat(I(this.r)).concat(I(this.g)).concat(I(this.b))}function E(){var e=N(this.opacity);return"".concat(1===e?"rgb(":"rgba(").concat(T(this.r),", ").concat(T(this.g),", ").concat(T(this.b)).concat(1===e?")":", ".concat(e,")"))}function N(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function T(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function I(e){return((e=T(e))<16?"0":"")+e.toString(16)}function D(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new O(e,t,n,r)}function F(e){if(e instanceof O)return new O(e.h,e.s,e.l,e.opacity);if(e instanceof a||(e=x(e)),!e)return new O;if(e instanceof O)return e;var t=(e=e.rgb()).r/255,n=e.g/255,r=e.b/255,i=Math.min(t,n,r),o=Math.max(t,n,r),u=NaN,s=o-i,c=(o+i)/2;return s?(u=t===o?(n-r)/s+6*(n<r):n===o?(r-t)/s+2:(t-n)/s+4,s/=c<.5?o+i:2-o-i,u*=60):s=c>0&&c<1?0:u,new O(u,s,c,e.opacity)}function M(e,t,n,r){return 1===arguments.length?F(e):new O(e,t,n,null==r?1:r)}function O(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}function R(e){return(e=(e||0)%360)<0?e+360:e}function j(e){return Math.max(0,Math.min(1,e||0))}function B(e,t,n){return 255*(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)}(0,r.Z)(a,x,{copy:function(e){return Object.assign(new this.constructor,this,e)},displayable:function(){return this.rgb().displayable()},hex:y,formatHex:y,formatHex8:function(){return this.rgb().formatHex8()},formatHsl:function(){return F(this).formatHsl()},formatRgb:b,toString:b}),(0,r.Z)(C,S,(0,r.l)(a,{brighter:function(e){return e=null==e?o:Math.pow(o,e),new C(this.r*e,this.g*e,this.b*e,this.opacity)},darker:function(e){return e=null==e?i:Math.pow(i,e),new C(this.r*e,this.g*e,this.b*e,this.opacity)},rgb:function(){return this},clamp:function(){return new C(T(this.r),T(this.g),T(this.b),N(this.opacity))},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:A,formatHex:A,formatHex8:function(){return"#".concat(I(this.r)).concat(I(this.g)).concat(I(this.b)).concat(I(255*(isNaN(this.opacity)?1:this.opacity)))},formatRgb:E,toString:E})),(0,r.Z)(O,M,(0,r.l)(a,{brighter:function(e){return e=null==e?o:Math.pow(o,e),new O(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=null==e?i:Math.pow(i,e),new O(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=this.h%360+360*(this.h<0),t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,a=2*n-r;return new C(B(e>=240?e-240:e+120,a,r),B(e,a,r),B(e<120?e+240:e-120,a,r),this.opacity)},clamp:function(){return new O(R(this.h),j(this.s),j(this.l),N(this.opacity))},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var e=N(this.opacity);return"".concat(1===e?"hsl(":"hsla(").concat(R(this.h),", ").concat(100*j(this.s),"%, ").concat(100*j(this.l),"%").concat(1===e?")":", ".concat(e,")"))}}))},170:function(e,t,n){"use strict";function r(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function a(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}n.d(t,{Z:function(){return r},l:function(){return a}})},9646:function(e,t,n){"use strict";n.d(t,{M:function(){return o},Z:function(){return i}});var r=n(7114),a=n(1449);function i(e,t){return((0,a.v)(t)?a.Z:o)(e,t)}function o(e,t){var n,a=t?t.length:0,i=e?Math.min(a,e.length):0,o=new Array(i),u=new Array(a);for(n=0;n<i;++n)o[n]=(0,r.Z)(e[n],t[n]);for(;n<a;++n)u[n]=t[n];return function(e){for(n=0;n<i;++n)u[n]=o[n](e);return u}}},7208:function(e,t,n){"use strict";function r(e,t,n,r,a){var i=e*e,o=i*e;return((1-3*e+3*i-o)*t+(4-6*i+3*o)*n+(1+3*e+3*i-3*o)*r+o*a)/6}function a(e){var t=e.length-1;return function(n){var a=n<=0?n=0:n>=1?(n=1,t-1):Math.floor(n*t),i=e[a],o=e[a+1],u=a>0?e[a-1]:2*i-o,s=a<t-1?e[a+2]:2*o-i;return r((n-a/t)*t,u,i,o,s)}}n.d(t,{Z:function(){return a},t:function(){return r}})},5857:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});var r=n(7208);function a(e){var t=e.length;return function(n){var a=Math.floor(((n%=1)<0?++n:n)*t),i=e[(a+t-1)%t],o=e[a%t],u=e[(a+1)%t],s=e[(a+2)%t];return(0,r.t)((n-a/t)*t,i,o,u,s)}}},6343:function(e,t,n){"use strict";n.d(t,{ZP:function(){return u},wx:function(){return i},yi:function(){return o}});var r=n(1354);function a(e,t){return function(n){return e+n*t}}function i(e,t){var n=t-e;return n?a(e,n>180||n<-180?n-360*Math.round(n/360):n):(0,r.Z)(isNaN(e)?t:e)}function o(e){return 1===(e=+e)?u:function(t,n){return n-t?function(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}(t,n,e):(0,r.Z)(isNaN(t)?n:t)}}function u(e,t){var n=t-e;return n?a(e,n):(0,r.Z)(isNaN(e)?t:e)}},1354:function(e,t){"use strict";t.Z=function(e){return function(){return e}}},6720:function(e,t,n){"use strict";function r(e,t){var n=new Date;return e=+e,t=+t,function(r){return n.setTime(e*(1-r)+t*r),n}}n.d(t,{Z:function(){return r}})},2989:function(e,t,n){"use strict";n.r(t),n.d(t,{interpolate:function(){return r.Z},interpolateArray:function(){return a.Z},interpolateBasis:function(){return i.Z},interpolateBasisClosed:function(){return o.Z},interpolateCubehelix:function(){return ie},interpolateCubehelixLong:function(){return oe},interpolateDate:function(){return u.Z},interpolateDiscrete:function(){return s},interpolateHcl:function(){return q},interpolateHclLong:function(){return G},interpolateHsl:function(){return k},interpolateHslLong:function(){return _},interpolateHue:function(){return l},interpolateLab:function(){return W},interpolateNumber:function(){return f.Z},interpolateNumberArray:function(){return d.Z},interpolateObject:function(){return h.Z},interpolateRgb:function(){return b.ZP},interpolateRgbBasis:function(){return b.hD},interpolateRgbBasisClosed:function(){return b.YD},interpolateRound:function(){return p.Z},interpolateString:function(){return v.Z},interpolateTransformCss:function(){return m.Y},interpolateTransformSvg:function(){return m.w},interpolateZoom:function(){return y},piecewise:function(){return ue.Z},quantize:function(){return se}});var r=n(7114),a=n(9646),i=n(7208),o=n(5857),u=n(6720);function s(e){var t=e.length;return function(n){return e[Math.max(0,Math.min(t-1,Math.floor(n*t)))]}}var c=n(6343);function l(e,t){var n=(0,c.wx)(+e,+t);return function(e){var t=n(e);return t-360*Math.floor(t/360)}}var f=n(4837),d=n(1449),h=n(7069),p=n(3739),v=n(327),m=n(3375);function g(e){return((e=Math.exp(e))+1/e)/2}var y=function e(t,n,r){function a(e,a){var i,o,u=e[0],s=e[1],c=e[2],l=a[0],f=a[1],d=a[2],h=l-u,p=f-s,v=h*h+p*p;if(v<1e-12)o=Math.log(d/c)/t,i=function(e){return[u+e*h,s+e*p,c*Math.exp(t*e*o)]};else{var m=Math.sqrt(v),y=(d*d-c*c+r*v)/(2*c*n*m),b=(d*d-c*c-r*v)/(2*d*n*m),x=Math.log(Math.sqrt(y*y+1)-y),w=Math.log(Math.sqrt(b*b+1)-b);o=(w-x)/t,i=function(e){var r,a=e*o,i=g(x),l=c/(n*m)*(i*(r=t*a+x,((r=Math.exp(2*r))-1)/(r+1))-function(e){return((e=Math.exp(e))-1/e)/2}(x));return[u+l*h,s+l*p,c*i/g(t*a+x)]}}return i.duration=1e3*o*t/Math.SQRT2,i}return a.rho=function(t){var n=Math.max(.001,+t),r=n*n;return e(n,r,r*r)},a}(Math.SQRT2,2,4),b=n(5217),x=n(5010);function w(e){return function(t,n){var r=e((t=(0,x.Ym)(t)).h,(n=(0,x.Ym)(n)).h),a=(0,c.ZP)(t.s,n.s),i=(0,c.ZP)(t.l,n.l),o=(0,c.ZP)(t.opacity,n.opacity);return function(e){return t.h=r(e),t.s=a(e),t.l=i(e),t.opacity=o(e),t+""}}}var k=w(c.wx),_=w(c.ZP),S=n(170),C=Math.PI/180,A=180/Math.PI,E=.96422,N=.82521,T=4/29,I=6/29,D=3*I*I;function F(e){if(e instanceof O)return new O(e.l,e.a,e.b,e.opacity);if(e instanceof P)return U(e);e instanceof x.Ss||(e=(0,x.SU)(e));var t,n,r=z(e.r),a=z(e.g),i=z(e.b),o=R((.2225045*r+.7168786*a+.0606169*i)/1);return r===a&&a===i?t=n=o:(t=R((.4360747*r+.3850649*a+.1430804*i)/E),n=R((.0139322*r+.0971045*a+.7141733*i)/N)),new O(116*o-16,500*(t-o),200*(o-n),e.opacity)}function M(e,t,n,r){return 1===arguments.length?F(e):new O(e,t,n,null==r?1:r)}function O(e,t,n,r){this.l=+e,this.a=+t,this.b=+n,this.opacity=+r}function R(e){return e>.008856451679035631?Math.pow(e,1/3):e/D+T}function j(e){return e>I?e*e*e:D*(e-T)}function B(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function z(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function Z(e){if(e instanceof P)return new P(e.h,e.c,e.l,e.opacity);if(e instanceof O||(e=F(e)),0===e.a&&0===e.b)return new P(NaN,0<e.l&&e.l<100?0:NaN,e.l,e.opacity);var t=Math.atan2(e.b,e.a)*A;return new P(t<0?t+360:t,Math.sqrt(e.a*e.a+e.b*e.b),e.l,e.opacity)}function L(e,t,n,r){return 1===arguments.length?Z(e):new P(e,t,n,null==r?1:r)}function P(e,t,n,r){this.h=+e,this.c=+t,this.l=+n,this.opacity=+r}function U(e){if(isNaN(e.h))return new O(e.l,0,0,e.opacity);var t=e.h*C;return new O(e.l,Math.cos(t)*e.c,Math.sin(t)*e.c,e.opacity)}function W(e,t){var n=(0,c.ZP)((e=M(e)).l,(t=M(t)).l),r=(0,c.ZP)(e.a,t.a),a=(0,c.ZP)(e.b,t.b),i=(0,c.ZP)(e.opacity,t.opacity);return function(t){return e.l=n(t),e.a=r(t),e.b=a(t),e.opacity=i(t),e+""}}function V(e){return function(t,n){var r=e((t=L(t)).h,(n=L(n)).h),a=(0,c.ZP)(t.c,n.c),i=(0,c.ZP)(t.l,n.l),o=(0,c.ZP)(t.opacity,n.opacity);return function(e){return t.h=r(e),t.c=a(e),t.l=i(e),t.opacity=o(e),t+""}}}(0,S.Z)(O,M,(0,S.l)(x.Il,{brighter:function(e){return new O(this.l+18*(null==e?1:e),this.a,this.b,this.opacity)},darker:function(e){return new O(this.l-18*(null==e?1:e),this.a,this.b,this.opacity)},rgb:function(){var e=(this.l+16)/116,t=isNaN(this.a)?e:e+this.a/500,n=isNaN(this.b)?e:e-this.b/200;return t=E*j(t),e=1*j(e),n=N*j(n),new x.Ss(B(3.1338561*t-1.6168667*e-.4906146*n),B(-.9787684*t+1.9161415*e+.033454*n),B(.0719453*t-.2289914*e+1.4052427*n),this.opacity)}})),(0,S.Z)(P,L,(0,S.l)(x.Il,{brighter:function(e){return new P(this.h,this.c,this.l+18*(null==e?1:e),this.opacity)},darker:function(e){return new P(this.h,this.c,this.l-18*(null==e?1:e),this.opacity)},rgb:function(){return U(this).rgb()}}));var q=V(c.wx),G=V(c.ZP),H=-.14861,X=1.78277,K=-.29227,Y=-.90649,$=1.97294,Q=$*Y,J=$*X,ee=X*K-Y*H;function te(e){if(e instanceof re)return new re(e.h,e.s,e.l,e.opacity);e instanceof x.Ss||(e=(0,x.SU)(e));var t=e.r/255,n=e.g/255,r=e.b/255,a=(ee*r+Q*t-J*n)/(ee+Q-J),i=r-a,o=($*(n-a)-K*i)/Y,u=Math.sqrt(o*o+i*i)/($*a*(1-a)),s=u?Math.atan2(o,i)*A-120:NaN;return new re(s<0?s+360:s,u,a,e.opacity)}function ne(e,t,n,r){return 1===arguments.length?te(e):new re(e,t,n,null==r?1:r)}function re(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}function ae(e){return function t(n){function r(t,r){var a=e((t=ne(t)).h,(r=ne(r)).h),i=(0,c.ZP)(t.s,r.s),o=(0,c.ZP)(t.l,r.l),u=(0,c.ZP)(t.opacity,r.opacity);return function(e){return t.h=a(e),t.s=i(e),t.l=o(Math.pow(e,n)),t.opacity=u(e),t+""}}return n=+n,r.gamma=t,r}(1)}(0,S.Z)(re,ne,(0,S.l)(x.Il,{brighter:function(e){return e=null==e?x.J5:Math.pow(x.J5,e),new re(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=null==e?x.xV:Math.pow(x.xV,e),new re(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=isNaN(this.h)?0:(this.h+120)*C,t=+this.l,n=isNaN(this.s)?0:this.s*t*(1-t),r=Math.cos(e),a=Math.sin(e);return new x.Ss(255*(t+n*(H*r+X*a)),255*(t+n*(K*r+Y*a)),255*(t+n*($*r)),this.opacity)}}));var ie=ae(c.wx),oe=ae(c.ZP),ue=n(5188);function se(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e(r/(t-1));return n}},4837:function(e,t,n){"use strict";function r(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}n.d(t,{Z:function(){return r}})},1449:function(e,t,n){"use strict";function r(e,t){t||(t=[]);var n,r=e?Math.min(t.length,e.length):0,a=t.slice();return function(i){for(n=0;n<r;++n)a[n]=e[n]*(1-i)+t[n]*i;return a}}function a(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}n.d(t,{Z:function(){return r},v:function(){return a}})},7069:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});var r=n(7114);function a(e,t){var n,a={},i={};for(n in null!==e&&"object"===typeof e||(e={}),null!==t&&"object"===typeof t||(t={}),t)n in e?a[n]=(0,r.Z)(e[n],t[n]):i[n]=t[n];return function(e){for(n in a)i[n]=a[n](e);return i}}},5188:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});var r=n(7114);function a(e,t){void 0===t&&(t=e,e=r.Z);for(var n=0,a=t.length-1,i=t[0],o=new Array(a<0?0:a);n<a;)o[n]=e(i,i=t[++n]);return function(e){var t=Math.max(0,Math.min(a-1,Math.floor(e*=a)));return o[t](e-t)}}},5217:function(e,t,n){"use strict";n.d(t,{YD:function(){return c},hD:function(){return s}});var r=n(5010),a=n(7208),i=n(5857),o=n(6343);function u(e){return function(t){var n,a,i=t.length,o=new Array(i),u=new Array(i),s=new Array(i);for(n=0;n<i;++n)a=(0,r.B8)(t[n]),o[n]=a.r||0,u[n]=a.g||0,s[n]=a.b||0;return o=e(o),u=e(u),s=e(s),a.opacity=1,function(e){return a.r=o(e),a.g=u(e),a.b=s(e),a+""}}}t.ZP=function e(t){var n=(0,o.yi)(t);function a(e,t){var a=n((e=(0,r.B8)(e)).r,(t=(0,r.B8)(t)).r),i=n(e.g,t.g),u=n(e.b,t.b),s=(0,o.ZP)(e.opacity,t.opacity);return function(t){return e.r=a(t),e.g=i(t),e.b=u(t),e.opacity=s(t),e+""}}return a.gamma=e,a}(1);var s=u(a.Z),c=u(i.Z)},3739:function(e,t,n){"use strict";function r(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}}n.d(t,{Z:function(){return r}})},327:function(e,t,n){"use strict";n.d(t,{Z:function(){return o}});var r=n(4837),a=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,i=new RegExp(a.source,"g");function o(e,t){var n,o,u,s=a.lastIndex=i.lastIndex=0,c=-1,l=[],f=[];for(e+="",t+="";(n=a.exec(e))&&(o=i.exec(t));)(u=o.index)>s&&(u=t.slice(s,u),l[c]?l[c]+=u:l[++c]=u),(n=n[0])===(o=o[0])?l[c]?l[c]+=o:l[++c]=o:(l[++c]=null,f.push({i:c,x:(0,r.Z)(n,o)})),s=i.lastIndex;return s<t.length&&(u=t.slice(s),l[c]?l[c]+=u:l[++c]=u),l.length<2?f[0]?function(e){return function(t){return e(t)+""}}(f[0].x):function(e){return function(){return e}}(t):(t=f.length,function(e){for(var n,r=0;r<t;++r)l[(n=f[r]).i]=n.x(e);return l.join("")})}},3375:function(e,t,n){"use strict";n.d(t,{Y:function(){return c},w:function(){return l}});var r,a=n(4837),i=180/Math.PI,o={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function u(e,t,n,r,a,o){var u,s,c;return(u=Math.sqrt(e*e+t*t))&&(e/=u,t/=u),(c=e*n+t*r)&&(n-=e*c,r-=t*c),(s=Math.sqrt(n*n+r*r))&&(n/=s,r/=s,c/=s),e*r<t*n&&(e=-e,t=-t,c=-c,u=-u),{translateX:a,translateY:o,rotate:Math.atan2(t,e)*i,skewX:Math.atan(c)*i,scaleX:u,scaleY:s}}function s(e,t,n,r){function i(e){return e.length?e.pop()+" ":""}return function(o,u){var s=[],c=[];return o=e(o),u=e(u),function(e,r,i,o,u,s){if(e!==i||r!==o){var c=u.push("translate(",null,t,null,n);s.push({i:c-4,x:(0,a.Z)(e,i)},{i:c-2,x:(0,a.Z)(r,o)})}else(i||o)&&u.push("translate("+i+t+o+n)}(o.translateX,o.translateY,u.translateX,u.translateY,s,c),function(e,t,n,o){e!==t?(e-t>180?t+=360:t-e>180&&(e+=360),o.push({i:n.push(i(n)+"rotate(",null,r)-2,x:(0,a.Z)(e,t)})):t&&n.push(i(n)+"rotate("+t+r)}(o.rotate,u.rotate,s,c),function(e,t,n,o){e!==t?o.push({i:n.push(i(n)+"skewX(",null,r)-2,x:(0,a.Z)(e,t)}):t&&n.push(i(n)+"skewX("+t+r)}(o.skewX,u.skewX,s,c),function(e,t,n,r,o,u){if(e!==n||t!==r){var s=o.push(i(o)+"scale(",null,",",null,")");u.push({i:s-4,x:(0,a.Z)(e,n)},{i:s-2,x:(0,a.Z)(t,r)})}else 1===n&&1===r||o.push(i(o)+"scale("+n+","+r+")")}(o.scaleX,o.scaleY,u.scaleX,u.scaleY,s,c),o=u=null,function(e){for(var t,n=-1,r=c.length;++n<r;)s[(t=c[n]).i]=t.x(e);return s.join("")}}}var c=s((function(e){var t=new("function"===typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?o:u(t.a,t.b,t.c,t.d,t.e,t.f)}),"px, ","px)","deg)"),l=s((function(e){return null==e?o:(r||(r=document.createElementNS("http://www.w3.org/2000/svg","g")),r.setAttribute("transform",e),(e=r.transform.baseVal.consolidate())?u((e=e.matrix).a,e.b,e.c,e.d,e.e,e.f):o)}),", ",")",")")},7114:function(e,t,n){"use strict";n.d(t,{Z:function(){return d}});var r=n(5010),a=n(5217),i=n(9646),o=n(6720),u=n(4837),s=n(7069),c=n(327),l=n(1354),f=n(1449);function d(e,t){var n,d=typeof t;return null==t||"boolean"===d?(0,l.Z)(t):("number"===d?u.Z:"string"===d?(n=(0,r.ZP)(t))?(t=n,a.ZP):c.Z:t instanceof r.ZP?a.ZP:t instanceof Date?o.Z:(0,f.v)(t)?f.Z:Array.isArray(t)?i.M:"function"!==typeof t.valueOf&&"function"!==typeof t.toString||isNaN(t)?s.Z:u.Z)(e,t)}}},t={};function n(r){var a=t[r];if(void 0!==a)return a.exports;var i=t[r]={id:r,loaded:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.loaded=!0,i.exports}n.amdD=function(){throw new Error("define cannot be used indirect")},n.amdO={},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,{a:t}),t},function(){var e,t=Object.getPrototypeOf?function(e){return Object.getPrototypeOf(e)}:function(e){return e.__proto__};n.t=function(r,a){if(1&a&&(r=this(r)),8&a)return r;if("object"===typeof r&&r){if(4&a&&r.__esModule)return r;if(16&a&&"function"===typeof r.then)return r}var i=Object.create(null);n.r(i);var o={};e=e||[null,t({}),t([]),t(t)];for(var u=2&a&&r;"object"==typeof u&&!~e.indexOf(u);u=t(u))Object.getOwnPropertyNames(u).forEach((function(e){o[e]=function(){return r[e]}}));return o.default=function(){return r},n.d(i,o),i}}(),n.d=function(e,t){for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.nmd=function(e){return e.paths=[],e.children||(e.children=[]),e},n.p="/blog/",function(){"use strict";var e={};n.r(e),n.d(e,{json:function(){return nv}});var t={};n.r(t),n.d(t,{json:function(){return rv}});var r={};n.r(r),n.d(r,{json:function(){return av}});var a={};n.r(a),n.d(a,{json:function(){return iv}});var i={};n.r(i),n.d(i,{json:function(){return ov}});var o={};n.r(o),n.d(o,{json:function(){return uv}});var u={};n.r(u),n.d(u,{json:function(){return sv}});var s={};n.r(s),n.d(s,{json:function(){return cv}});var c={};n.r(c),n.d(c,{json:function(){return lv}});var l={};n.r(l),n.d(l,{json:function(){return fv}});var f={};n.r(f),n.d(f,{json:function(){return dv}});var d={};n.r(d),n.d(d,{json:function(){return hv}});var h={};n.r(h),n.d(h,{json:function(){return pv}});var p={};n.r(p),n.d(p,{json:function(){return vv}});var v={};n.r(v),n.d(v,{json:function(){return mv}});var m={};n.r(m),n.d(m,{json:function(){return gv}});var g={};n.r(g),n.d(g,{json:function(){return yv}});var y={};n.r(y),n.d(y,{json:function(){return bv}});var b={};n.r(b),n.d(b,{json:function(){return xv}});var x={};n.r(x),n.d(x,{OP_SCOPE_SUFFIX:function(){return Bv.zvA},abs:function(){return Bv.WnP},acos:function(){return Bv.Khb},acosh:function(){return Bv.__u},add:function(){return Bv.IHx},addN:function(){return Bv.QBD},all:function(){return Bv.$6P},any:function(){return Bv.YjB},argMax:function(){return Bv.NqF},argMin:function(){return Bv.vHJ},asin:function(){return Bv.ZRM},asinh:function(){return Bv.VfV},atan:function(){return Bv.z4N},atan2:function(){return Bv.fvJ},atanh:function(){return Bv.C80},avgPool:function(){return Bv.wS1},avgPool3d:function(){return Bv.uR5},basicLSTMCell:function(){return Bv.zEQ},batchNorm:function(){return Bv.tgs},batchNorm2d:function(){return Bv.Dxk},batchNorm3d:function(){return Bv.JY5},batchNorm4d:function(){return Bv.p3b},batchToSpaceND:function(){return Bv.E4h},bincount:function(){return Bv.yE8},bitwiseAnd:function(){return Bv.ycw},booleanMaskAsync:function(){return Bv.anm},broadcastArgs:function(){return Bv.XsQ},broadcastTo:function(){return Bv.UFq},buffer:function(){return Bv.f3b},cast:function(){return Bv.pju},ceil:function(){return Bv.mDi},clipByValue:function(){return Bv.iUl},clone:function(){return Bv.d9v},complex:function(){return Bv.PYB},concat:function(){return Bv.zoF},concat1d:function(){return Bv.gME},concat2d:function(){return Bv.Izb},concat3d:function(){return Bv.MNy},concat4d:function(){return Bv.ZaL},conv1d:function(){return Bv.PAt},conv2d:function(){return Bv.Tek},conv2dTranspose:function(){return Bv.bc},conv3d:function(){return Bv.pdZ},conv3dTranspose:function(){return Bv.$QV},cos:function(){return Bv.mCk},cosh:function(){return Bv.f9Y},cosineWindow:function(){return Bv.mew},cumprod:function(){return Bv.$Gn},cumsum:function(){return Bv.zbp},denseBincount:function(){return Bv.ppE},depthToSpace:function(){return Bv.nTT},depthwiseConv2d:function(){return Bv.B10},diag:function(){return Bv.Ka3},dilation2d:function(){return Bv.WmZ},div:function(){return Bv.hiC},divNoNan:function(){return Bv.NTj},dot:function(){return Bv.AKD},dropout:function(){return Bv.rvX},einsum:function(){return Bv.WYO},elu:function(){return Bv.pyx},enclosingPowerOfTwo:function(){return Bv.GRh},ensureShape:function(){return Bv.EDe},equal:function(){return Bv.DgJ},erf:function(){return Bv.qNN},euclideanNorm:function(){return Bv.d2q},exp:function(){return Bv.Qqt},expandDims:function(){return Bv.dt4},expm1:function(){return Bv.t$B},eye:function(){return Bv.iyy},fft:function(){return Bv.kp_},fill:function(){return Bv.hlL},floor:function(){return Bv.GWj},floorDiv:function(){return Bv.qPi},fused:function(){return Bv.imm},gather:function(){return Bv.Iqj},gatherND:function(){return Bv.dbB},greater:function(){return Bv.pjt},greaterEqual:function(){return Bv.brS},ifft:function(){return Bv.Sxn},imag:function(){return Bv.asL},image:function(){return Bv.BHj},inTopKAsync:function(){return Bv.V3u},irfft:function(){return Bv.wx0},isFinite:function(){return Bv.xVT},isInf:function(){return Bv.UWc},isNaN:function(){return Bv.i2d},leakyRelu:function(){return Bv.hi7},less:function(){return Bv.d9m},lessEqual:function(){return Bv.zN1},linalg:function(){return Bv.$r2},linspace:function(){return Bv.SX3},localResponseNormalization:function(){return Bv.G9k},log:function(){return Bv.cM7},log1p:function(){return Bv.Krr},logSigmoid:function(){return Bv.e_t},logSoftmax:function(){return Bv.CmS},logSumExp:function(){return Bv.l_t},logicalAnd:function(){return Bv.HvI},logicalNot:function(){return Bv.hJK},logicalOr:function(){return Bv.K5V},logicalXor:function(){return Bv.egP},losses:function(){return Bv.MB5},lowerBound:function(){return Bv.eab},matMul:function(){return Bv.OI3},max:function(){return Bv.Fp7},maxPool:function(){return Bv._sB},maxPool3d:function(){return Bv.YQQ},maxPoolWithArgmax:function(){return Bv.Ip$},maximum:function(){return Bv.gWQ},mean:function(){return Bv.J69},meshgrid:function(){return Bv.ry_},min:function(){return Bv.VV$},minimum:function(){return Bv.LTh},mirrorPad:function(){return Bv.VdP},mod:function(){return Bv.wQq},moments:function(){return Bv.Gi7},movingAverage:function(){return Bv.p_},mul:function(){return Bv.dC7},multiRNNCell:function(){return Bv.rq4},multinomial:function(){return Bv.SJ_},neg:function(){return Bv.W76},norm:function(){return Bv.KOy},notEqual:function(){return Bv.Quu},oneHot:function(){return Bv.lfX},ones:function(){return Bv.iUs},onesLike:function(){return Bv.JpU},op:function(){return Bv.op},outerProduct:function(){return Bv.N2O},pad:function(){return Bv.vku},pad1d:function(){return Bv.pNR},pad2d:function(){return Bv.koy},pad3d:function(){return Bv.t1L},pad4d:function(){return Bv.lGY},pool:function(){return Bv.d_R},pow:function(){return Bv.sQ3},prelu:function(){return Bv.AL3},print:function(){return Bv.S0v},prod:function(){return Bv.WVs},raggedGather:function(){return Bv.$gW},raggedRange:function(){return Bv.VT$},raggedTensorToTensor:function(){return Bv.N89},rand:function(){return Bv.TN_},randomGamma:function(){return Bv.wzB},randomNormal:function(){return Bv.nGf},randomStandardNormal:function(){return Bv.ruB},randomUniform:function(){return Bv.LGj},randomUniformInt:function(){return Bv.pe5},range:function(){return Bv.w6H},real:function(){return Bv.kwC},reciprocal:function(){return Bv.M25},relu:function(){return Bv.UYe},relu6:function(){return Bv.btT},reshape:function(){return Bv.XLQ},reverse:function(){return Bv.GYS},reverse1d:function(){return Bv.SDf},reverse2d:function(){return Bv.diP},reverse3d:function(){return Bv.sx7},reverse4d:function(){return Bv.mG2},rfft:function(){return Bv.QEs},round:function(){return Bv.NMM},rsqrt:function(){return Bv.bp0},scalar:function(){return Bv.iD$},scatterND:function(){return Bv.snQ},searchSorted:function(){return Bv.zcT},selu:function(){return Bv.U8D},separableConv2d:function(){return Bv.U_I},setdiff1dAsync:function(){return Bv.ODp},sigmoid:function(){return Bv.XD2},sign:function(){return Bv.Xxe},signal:function(){return Bv.tdS},sin:function(){return Bv.O$l},sinh:function(){return Bv.R_K},slice:function(){return Bv.tPi},slice1d:function(){return Bv.jZU},slice2d:function(){return Bv.SmN},slice3d:function(){return Bv.CnO},slice4d:function(){return Bv.p0P},softmax:function(){return Bv.XAC},softplus:function(){return Bv.Wvh},spaceToBatchND:function(){return Bv.fBT},sparse:function(){return Bv.rVs},sparseToDense:function(){return Bv.ers},spectral:function(){return Bv.uN7},split:function(){return Bv.Vl2},sqrt:function(){return Bv._b3},square:function(){return Bv.h62},squaredDifference:function(){return Bv.$i},squeeze:function(){return Bv.L9e},stack:function(){return Bv.knu},step:function(){return Bv.Nbs},stridedSlice:function(){return Bv.NXj},string:function(){return Bv.Z_8},sub:function(){return Bv.luU},sum:function(){return Bv.Smz},tan:function(){return Bv.ORZ},tanh:function(){return Bv.AEp},tensor:function(){return Bv.XeE},tensor1d:function(){return Bv.RRF},tensor2d:function(){return Bv.odF},tensor3d:function(){return Bv.wOQ},tensor4d:function(){return Bv.yXz},tensor5d:function(){return Bv.Bfx},tensor6d:function(){return Bv.xZs},tensorScatterUpdate:function(){return Bv.Pg0},tile:function(){return Bv.Gg6},topk:function(){return Bv.hg7},transpose:function(){return Bv.p4s},truncatedNormal:function(){return Bv.Xu6},unique:function(){return Bv.Two},unsortedSegmentSum:function(){return Bv.pUJ},unstack:function(){return Bv.HHK},upperBound:function(){return Bv.GaM},variable:function(){return Bv.VD$},where:function(){return Bv.arb},whereAsync:function(){return Bv.itS},zeros:function(){return Bv.lls},zerosLike:function(){return Bv.P84}});var w,k=n(2791),_=n.t(k,2),S=n(1250),C=n(9439),A=n(4687),E=n.n(A),N=n(4164),T=n.t(N,2),I=n(3433),D=n(5671),F=n(3144),M=n(136),O=n(7277),R=n(8664),j=n(4506),B=n(7762);function z(){return z=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},z.apply(this,arguments)}!function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"}(w||(w={}));var Z,L="popstate";function P(e,t){if(!1===e||null===e||"undefined"===typeof e)throw new Error(t)}function U(e,t){if(!e){"undefined"!==typeof console&&console.warn(t);try{throw new Error(t)}catch(n){}}}function W(e,t){return{usr:e.state,key:e.key,idx:t}}function V(e,t,n,r){return void 0===n&&(n=null),z({pathname:"string"===typeof e?e:e.pathname,search:"",hash:""},"string"===typeof t?G(t):t,{state:n,key:t&&t.key||r||Math.random().toString(36).substr(2,8)})}function q(e){var t=e.pathname,n=void 0===t?"/":t,r=e.search,a=void 0===r?"":r,i=e.hash,o=void 0===i?"":i;return a&&"?"!==a&&(n+="?"===a.charAt(0)?a:"?"+a),o&&"#"!==o&&(n+="#"===o.charAt(0)?o:"#"+o),n}function G(e){var t={};if(e){var n=e.indexOf("#");n>=0&&(t.hash=e.substr(n),e=e.substr(0,n));var r=e.indexOf("?");r>=0&&(t.search=e.substr(r),e=e.substr(0,r)),e&&(t.pathname=e)}return t}function H(e,t,n,r){void 0===r&&(r={});var a=r,i=a.window,o=void 0===i?document.defaultView:i,u=a.v5Compat,s=void 0!==u&&u,c=o.history,l=w.Pop,f=null,d=h();function h(){return(c.state||{idx:null}).idx}function p(){l=w.Pop;var e=h(),t=null==e?null:e-d;d=e,f&&f({action:l,location:m.location,delta:t})}function v(e){var t="null"!==o.location.origin?o.location.origin:o.location.href,n="string"===typeof e?e:q(e);return P(t,"No window.location.(origin|href) available to create URL for href: "+n),new URL(n,t)}null==d&&(d=0,c.replaceState(z({},c.state,{idx:d}),""));var m={get action(){return l},get location(){return e(o,c)},listen:function(e){if(f)throw new Error("A history only accepts one active listener");return o.addEventListener(L,p),f=e,function(){o.removeEventListener(L,p),f=null}},createHref:function(e){return t(o,e)},createURL:v,encodeLocation:function(e){var t=v(e);return{pathname:t.pathname,search:t.search,hash:t.hash}},push:function(e,t){l=w.Push;var r=V(m.location,e,t);n&&n(r,e);var a=W(r,d=h()+1),i=m.createHref(r);try{c.pushState(a,"",i)}catch(u){if(u instanceof DOMException&&"DataCloneError"===u.name)throw u;o.location.assign(i)}s&&f&&f({action:l,location:m.location,delta:1})},replace:function(e,t){l=w.Replace;var r=V(m.location,e,t);n&&n(r,e);var a=W(r,d=h()),i=m.createHref(r);c.replaceState(a,"",i),s&&f&&f({action:l,location:m.location,delta:0})},go:function(e){return c.go(e)}};return m}!function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"}(Z||(Z={}));new Set(["lazy","caseSensitive","path","id","index","children"]);function X(e,t,n){void 0===n&&(n="/");var r=re(("string"===typeof t?G(t):t).pathname||"/",n);if(null==r)return null;var a=K(e);!function(e){e.sort((function(e,t){return e.score!==t.score?t.score-e.score:function(e,t){var n=e.length===t.length&&e.slice(0,-1).every((function(e,n){return e===t[n]}));return n?e[e.length-1]-t[t.length-1]:0}(e.routesMeta.map((function(e){return e.childrenIndex})),t.routesMeta.map((function(e){return e.childrenIndex})))}))}(a);for(var i=null,o=0;null==i&&o<a.length;++o)i=ee(a[o],ne(r));return i}function K(e,t,n,r){void 0===t&&(t=[]),void 0===n&&(n=[]),void 0===r&&(r="");var a=function(e,a,i){var o={relativePath:void 0===i?e.path||"":i,caseSensitive:!0===e.caseSensitive,childrenIndex:a,route:e};o.relativePath.startsWith("/")&&(P(o.relativePath.startsWith(r),'Absolute route path "'+o.relativePath+'" nested under path "'+r+'" is not valid. An absolute child route path must start with the combined path of all its parent routes.'),o.relativePath=o.relativePath.slice(r.length));var u=se([r,o.relativePath]),s=n.concat(o);e.children&&e.children.length>0&&(P(!0!==e.index,'Index routes must not have child routes. Please remove all child routes from route path "'+u+'".'),K(e.children,t,s,u)),(null!=e.path||e.index)&&t.push({path:u,score:J(u,e.index),routesMeta:s})};return e.forEach((function(e,t){var n;if(""!==e.path&&null!=(n=e.path)&&n.includes("?")){var r,i=(0,B.Z)(Y(e.path));try{for(i.s();!(r=i.n()).done;){var o=r.value;a(e,t,o)}}catch(u){i.e(u)}finally{i.f()}}else a(e,t)})),t}function Y(e){var t=e.split("/");if(0===t.length)return[];var n=(0,j.Z)(t),r=n[0],a=n.slice(1),i=r.endsWith("?"),o=r.replace(/\?$/,"");if(0===a.length)return i?[o,""]:[o];var u=Y(a.join("/")),s=[];return s.push.apply(s,(0,I.Z)(u.map((function(e){return""===e?o:[o,e].join("/")})))),i&&s.push.apply(s,(0,I.Z)(u)),s.map((function(t){return e.startsWith("/")&&""===t?"/":t}))}var $=/^:[\w-]+$/,Q=function(e){return"*"===e};function J(e,t){var n=e.split("/"),r=n.length;return n.some(Q)&&(r+=-2),t&&(r+=2),n.filter((function(e){return!Q(e)})).reduce((function(e,t){return e+($.test(t)?3:""===t?1:10)}),r)}function ee(e,t){for(var n=e.routesMeta,r={},a="/",i=[],o=0;o<n.length;++o){var u=n[o],s=o===n.length-1,c="/"===a?t:t.slice(a.length)||"/",l=te({path:u.relativePath,caseSensitive:u.caseSensitive,end:s},c);if(!l)return null;Object.assign(r,l.params);var f=u.route;i.push({params:r,pathname:se([a,l.pathname]),pathnameBase:ce(se([a,l.pathnameBase])),route:f}),"/"!==l.pathnameBase&&(a=se([a,l.pathnameBase]))}return i}function te(e,t){"string"===typeof e&&(e={path:e,caseSensitive:!1,end:!0});var n=function(e,t,n){void 0===t&&(t=!1);void 0===n&&(n=!0);U("*"===e||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were "'+e.replace(/\*$/,"/*")+'" because the `*` character must always follow a `/` in the pattern. To get rid of this warning, please change the route path to "'+e.replace(/\*$/,"/*")+'".');var r=[],a="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(function(e,t,n){return r.push({paramName:t,isOptional:null!=n}),n?"/?([^\\/]+)?":"/([^\\/]+)"}));e.endsWith("*")?(r.push({paramName:"*"}),a+="*"===e||"/*"===e?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?a+="\\/*$":""!==e&&"/"!==e&&(a+="(?:(?=\\/|$))");return[new RegExp(a,t?void 0:"i"),r]}(e.path,e.caseSensitive,e.end),r=(0,C.Z)(n,2),a=r[0],i=r[1],o=t.match(a);if(!o)return null;var u=o[0],s=u.replace(/(.)\/+$/,"$1"),c=o.slice(1);return{params:i.reduce((function(e,t,n){var r=t.paramName,a=t.isOptional;if("*"===r){var i=c[n]||"";s=u.slice(0,u.length-i.length).replace(/(.)\/+$/,"$1")}var o=c[n];return e[r]=a&&!o?void 0:function(e,t){try{return decodeURIComponent(e)}catch(n){return U(!1,'The value for the URL param "'+t+'" will not be decoded because the string "'+e+'" is a malformed URL segment. This is probably due to a bad percent encoding ('+n+")."),e}}(o||"",r),e}),{}),pathname:u,pathnameBase:s,pattern:e}}function ne(e){try{return decodeURI(e)}catch(t){return U(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent encoding ('+t+")."),e}}function re(e,t){if("/"===t)return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;var n=t.endsWith("/")?t.length-1:t.length,r=e.charAt(n);return r&&"/"!==r?null:e.slice(n)||"/"}function ae(e,t,n,r){return"Cannot include a '"+e+"' character in a manually specified `to."+t+"` field ["+JSON.stringify(r)+"].  Please separate it out to the `to."+n+'` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.'}function ie(e){return e.filter((function(e,t){return 0===t||e.route.path&&e.route.path.length>0}))}function oe(e,t){var n=ie(e);return t?n.map((function(t,n){return n===e.length-1?t.pathname:t.pathnameBase})):n.map((function(e){return e.pathnameBase}))}function ue(e,t,n,r){var a;void 0===r&&(r=!1),"string"===typeof e?a=G(e):(P(!(a=z({},e)).pathname||!a.pathname.includes("?"),ae("?","pathname","search",a)),P(!a.pathname||!a.pathname.includes("#"),ae("#","pathname","hash",a)),P(!a.search||!a.search.includes("#"),ae("#","search","hash",a)));var i,o=""===e||""===a.pathname,u=o?"/":a.pathname;if(null==u)i=n;else{var s=t.length-1;if(!r&&u.startsWith("..")){for(var c=u.split("/");".."===c[0];)c.shift(),s-=1;a.pathname=c.join("/")}i=s>=0?t[s]:"/"}var l=function(e,t){void 0===t&&(t="/");var n="string"===typeof e?G(e):e,r=n.pathname,a=n.search,i=void 0===a?"":a,o=n.hash,u=void 0===o?"":o,s=r?r.startsWith("/")?r:function(e,t){var n=t.replace(/\/+$/,"").split("/");return e.split("/").forEach((function(e){".."===e?n.length>1&&n.pop():"."!==e&&n.push(e)})),n.length>1?n.join("/"):"/"}(r,t):t;return{pathname:s,search:le(i),hash:fe(u)}}(a,i),f=u&&"/"!==u&&u.endsWith("/"),d=(o||"."===u)&&n.endsWith("/");return l.pathname.endsWith("/")||!f&&!d||(l.pathname+="/"),l}var se=function(e){return e.join("/").replace(/\/\/+/g,"/")},ce=function(e){return e.replace(/\/+$/,"").replace(/^\/*/,"/")},le=function(e){return e&&"?"!==e?e.startsWith("?")?e:"?"+e:""},fe=function(e){return e&&"#"!==e?e.startsWith("#")?e:"#"+e:""},de=function(e){(0,M.Z)(n,e);var t=(0,O.Z)(n);function n(){return(0,D.Z)(this,n),t.apply(this,arguments)}return(0,F.Z)(n)}((0,R.Z)(Error));function he(e){return null!=e&&"number"===typeof e.status&&"string"===typeof e.statusText&&"boolean"===typeof e.internal&&"data"in e}var pe=["post","put","patch","delete"],ve=(new Set(pe),["get"].concat(pe));new Set(ve),new Set([301,302,303,307,308]),new Set([307,308]);Symbol("deferred");function me(){return me=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},me.apply(this,arguments)}var ge=k.createContext(null);var ye=k.createContext(null);var be=k.createContext(null);var xe=k.createContext(null);var we=k.createContext(null);var ke=k.createContext({outlet:null,matches:[],isDataRoute:!1});var _e=k.createContext(null);function Se(){return null!=k.useContext(we)}function Ce(){return Se()||P(!1),k.useContext(we).location}function Ae(e){k.useContext(xe).static||k.useLayoutEffect(e)}function Ee(){return k.useContext(ke).isDataRoute?function(){var e=Be(Re.UseNavigateStable).router,t=Ze(je.UseNavigateStable),n=k.useRef(!1);Ae((function(){n.current=!0}));var r=k.useCallback((function(r,a){void 0===a&&(a={}),n.current&&("number"===typeof r?e.navigate(r):e.navigate(r,me({fromRouteId:t},a)))}),[e,t]);return r}():function(){Se()||P(!1);var e=k.useContext(ge),t=k.useContext(xe),n=t.basename,r=t.future,a=t.navigator,i=k.useContext(ke).matches,o=Ce().pathname,u=JSON.stringify(oe(i,r.v7_relativeSplatPath)),s=k.useRef(!1);Ae((function(){s.current=!0}));var c=k.useCallback((function(t,r){if(void 0===r&&(r={}),s.current)if("number"!==typeof t){var i=ue(t,JSON.parse(u),o,"path"===r.relative);null==e&&"/"!==n&&(i.pathname="/"===i.pathname?n:se([n,i.pathname])),(r.replace?a.replace:a.push)(i,r.state,r)}else a.go(t)}),[n,a,u,o,e]);return c}()}function Ne(e,t){var n=(void 0===t?{}:t).relative,r=k.useContext(xe).future,a=k.useContext(ke).matches,i=Ce().pathname,o=JSON.stringify(oe(a,r.v7_relativeSplatPath));return k.useMemo((function(){return ue(e,JSON.parse(o),i,"path"===n)}),[e,o,i,n])}function Te(e,t,n,r){Se()||P(!1);var a,i=k.useContext(xe).navigator,o=k.useContext(ke).matches,u=o[o.length-1],s=u?u.params:{},c=(u&&u.pathname,u?u.pathnameBase:"/"),l=(u&&u.route,Ce());if(t){var f,d="string"===typeof t?G(t):t;"/"===c||(null==(f=d.pathname)?void 0:f.startsWith(c))||P(!1),a=d}else a=l;var h=a.pathname||"/",p=X(e,{pathname:"/"===c?h:h.slice(c.length)||"/"});var v=Oe(p&&p.map((function(e){return Object.assign({},e,{params:Object.assign({},s,e.params),pathname:se([c,i.encodeLocation?i.encodeLocation(e.pathname).pathname:e.pathname]),pathnameBase:"/"===e.pathnameBase?c:se([c,i.encodeLocation?i.encodeLocation(e.pathnameBase).pathname:e.pathnameBase])})})),o,n,r);return t&&v?k.createElement(we.Provider,{value:{location:me({pathname:"/",search:"",hash:"",state:null,key:"default"},a),navigationType:w.Pop}},v):v}function Ie(){var e=function(){var e,t=k.useContext(_e),n=ze(je.UseRouteError),r=Ze(je.UseRouteError);if(void 0!==t)return t;return null==(e=n.errors)?void 0:e[r]}(),t=he(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),n=e instanceof Error?e.stack:null,r="rgba(200,200,200, 0.5)",a={padding:"0.5rem",backgroundColor:r};return k.createElement(k.Fragment,null,k.createElement("h2",null,"Unexpected Application Error!"),k.createElement("h3",{style:{fontStyle:"italic"}},t),n?k.createElement("pre",{style:a},n):null,null)}var De=k.createElement(Ie,null),Fe=function(e){(0,M.Z)(n,e);var t=(0,O.Z)(n);function n(e){var r;return(0,D.Z)(this,n),(r=t.call(this,e)).state={location:e.location,revalidation:e.revalidation,error:e.error},r}return(0,F.Z)(n,[{key:"componentDidCatch",value:function(e,t){console.error("React Router caught the following error during render",e,t)}},{key:"render",value:function(){return void 0!==this.state.error?k.createElement(ke.Provider,{value:this.props.routeContext},k.createElement(_e.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}],[{key:"getDerivedStateFromError",value:function(e){return{error:e}}},{key:"getDerivedStateFromProps",value:function(e,t){return t.location!==e.location||"idle"!==t.revalidation&&"idle"===e.revalidation?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:void 0!==e.error?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}}]),n}(k.Component);function Me(e){var t=e.routeContext,n=e.match,r=e.children,a=k.useContext(ge);return a&&a.static&&a.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(a.staticContext._deepestRenderedBoundaryId=n.route.id),k.createElement(ke.Provider,{value:t},r)}function Oe(e,t,n,r){var a;if(void 0===t&&(t=[]),void 0===n&&(n=null),void 0===r&&(r=null),null==e){var i;if(null==(i=n)||!i.errors)return null;e=n.matches}var o=e,u=null==(a=n)?void 0:a.errors;if(null!=u){var s=o.findIndex((function(e){return e.route.id&&(null==u?void 0:u[e.route.id])}));s>=0||P(!1),o=o.slice(0,Math.min(o.length,s+1))}var c=!1,l=-1;if(n&&r&&r.v7_partialHydration)for(var f=0;f<o.length;f++){var d=o[f];if((d.route.HydrateFallback||d.route.hydrateFallbackElement)&&(l=f),d.route.id){var h=n,p=h.loaderData,v=h.errors,m=d.route.loader&&void 0===p[d.route.id]&&(!v||void 0===v[d.route.id]);if(d.route.lazy||m){c=!0,o=l>=0?o.slice(0,l+1):[o[0]];break}}}return o.reduceRight((function(e,r,a){var i,s,f=!1,d=null,h=null;n&&(i=u&&r.route.id?u[r.route.id]:void 0,d=r.route.errorElement||De,c&&(l<0&&0===a?(s="route-fallback",!1||Le[s]||(Le[s]=!0),f=!0,h=null):l===a&&(f=!0,h=r.route.hydrateFallbackElement||null)));var p=t.concat(o.slice(0,a+1)),v=function(){var t;return t=i?d:f?h:r.route.Component?k.createElement(r.route.Component,null):r.route.element?r.route.element:e,k.createElement(Me,{match:r,routeContext:{outlet:e,matches:p,isDataRoute:null!=n},children:t})};return n&&(r.route.ErrorBoundary||r.route.errorElement||0===a)?k.createElement(Fe,{location:n.location,revalidation:n.revalidation,component:d,error:i,children:v(),routeContext:{outlet:null,matches:p,isDataRoute:!0}}):v()}),null)}var Re=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(Re||{}),je=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(je||{});function Be(e){var t=k.useContext(ge);return t||P(!1),t}function ze(e){var t=k.useContext(ye);return t||P(!1),t}function Ze(e){var t=function(e){var t=k.useContext(ke);return t||P(!1),t}(),n=t.matches[t.matches.length-1];return n.route.id||P(!1),n.route.id}var Le={};_.startTransition;function Pe(e){P(!1)}function Ue(e){var t=e.basename,n=void 0===t?"/":t,r=e.children,a=void 0===r?null:r,i=e.location,o=e.navigationType,u=void 0===o?w.Pop:o,s=e.navigator,c=e.static,l=void 0!==c&&c,f=e.future;Se()&&P(!1);var d=n.replace(/^\/*/,"/"),h=k.useMemo((function(){return{basename:d,navigator:s,static:l,future:me({v7_relativeSplatPath:!1},f)}}),[d,f,s,l]);"string"===typeof i&&(i=G(i));var p=i,v=p.pathname,m=void 0===v?"/":v,g=p.search,y=void 0===g?"":g,b=p.hash,x=void 0===b?"":b,_=p.state,S=void 0===_?null:_,C=p.key,A=void 0===C?"default":C,E=k.useMemo((function(){var e=re(m,d);return null==e?null:{location:{pathname:e,search:y,hash:x,state:S,key:A},navigationType:u}}),[d,m,y,x,S,A,u]);return null==E?null:k.createElement(xe.Provider,{value:h},k.createElement(we.Provider,{children:a,value:E}))}function We(e){var t=e.children,n=e.location;return Te(Ge(t),n)}var Ve=function(e){return e[e.pending=0]="pending",e[e.success=1]="success",e[e.error=2]="error",e}(Ve||{}),qe=new Promise((function(){}));k.Component;function Ge(e,t){void 0===t&&(t=[]);var n=[];return k.Children.forEach(e,(function(e,r){if(k.isValidElement(e)){var a=[].concat((0,I.Z)(t),[r]);if(e.type!==k.Fragment){e.type!==Pe&&P(!1),e.props.index&&e.props.children&&P(!1);var i={id:e.props.id||a.join("-"),caseSensitive:e.props.caseSensitive,element:e.props.element,Component:e.props.Component,index:e.props.index,path:e.props.path,loader:e.props.loader,action:e.props.action,errorElement:e.props.errorElement,ErrorBoundary:e.props.ErrorBoundary,hasErrorBoundary:null!=e.props.ErrorBoundary||null!=e.props.errorElement,shouldRevalidate:e.props.shouldRevalidate,handle:e.props.handle,lazy:e.props.lazy};e.props.children&&(i.children=Ge(e.props.children,a)),n.push(i)}else n.push.apply(n,Ge(e.props.children,a))}})),n}function He(){return He=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},He.apply(this,arguments)}function Xe(e,t){if(null==e)return{};var n,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);var Ke=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","unstable_viewTransition"];new Map;var Ye=_.startTransition;T.flushSync,_.useId;function $e(e){var t=e.basename,n=e.children,r=e.future,a=e.window,i=k.useRef();null==i.current&&(i.current=function(e){return void 0===e&&(e={}),H((function(e,t){var n=e.location;return V("",{pathname:n.pathname,search:n.search,hash:n.hash},t.state&&t.state.usr||null,t.state&&t.state.key||"default")}),(function(e,t){return"string"===typeof t?t:q(t)}),null,e)}({window:a,v5Compat:!0}));var o=i.current,u=k.useState({action:o.action,location:o.location}),s=(0,C.Z)(u,2),c=s[0],l=s[1],f=(r||{}).v7_startTransition,d=k.useCallback((function(e){f&&Ye?Ye((function(){return l(e)})):l(e)}),[l,f]);return k.useLayoutEffect((function(){return o.listen(d)}),[o,d]),k.createElement(Ue,{basename:t,children:n,location:c.location,navigationType:c.action,navigator:o,future:r})}var Qe="undefined"!==typeof window&&"undefined"!==typeof window.document&&"undefined"!==typeof window.document.createElement,Je=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,et=k.forwardRef((function(e,t){var n,r=e.onClick,a=e.relative,i=e.reloadDocument,o=e.replace,u=e.state,s=e.target,c=e.to,l=e.preventScrollReset,f=e.unstable_viewTransition,d=Xe(e,Ke),h=k.useContext(xe).basename,p=!1;if("string"===typeof c&&Je.test(c)&&(n=c,Qe))try{var v=new URL(window.location.href),m=c.startsWith("//")?new URL(v.protocol+c):new URL(c),g=re(m.pathname,h);m.origin===v.origin&&null!=g?c=g+m.search+m.hash:p=!0}catch(x){}var y=function(e,t){var n=(void 0===t?{}:t).relative;Se()||P(!1);var r=k.useContext(xe),a=r.basename,i=r.navigator,o=Ne(e,{relative:n}),u=o.hash,s=o.pathname,c=o.search,l=s;return"/"!==a&&(l="/"===s?a:se([a,s])),i.createHref({pathname:l,search:c,hash:u})}(c,{relative:a}),b=function(e,t){var n=void 0===t?{}:t,r=n.target,a=n.replace,i=n.state,o=n.preventScrollReset,u=n.relative,s=n.unstable_viewTransition,c=Ee(),l=Ce(),f=Ne(e,{relative:u});return k.useCallback((function(t){if(function(e,t){return 0===e.button&&(!t||"_self"===t)&&!function(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}(e)}(t,r)){t.preventDefault();var n=void 0!==a?a:q(l)===q(f);c(e,{replace:n,state:i,preventScrollReset:o,relative:u,unstable_viewTransition:s})}}),[l,c,f,a,i,r,e,o,u,s])}(c,{replace:o,state:u,target:s,preventScrollReset:l,relative:a,unstable_viewTransition:f});return k.createElement("a",He({},d,{href:n||y,onClick:p||i?r:function(e){r&&r(e),e.defaultPrevented||b(e)},ref:t,target:s}))}));var tt,nt;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(tt||(tt={})),function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"}(nt||(nt={}));var rt=n(184);var at=function(){return(0,rt.jsxs)("div",{className:"container-sm",style:{maxWidth:1e3},children:[(0,rt.jsxs)("div",{className:"frame",children:[(0,rt.jsx)("h2",{className:"display-6",style:{marginTop:50,marginBottom:30},children:"Modules"}),(0,rt.jsxs)("div",{className:"container-sm",style:{justifyContent:"center",display:"flex",flexDirection:"column",gap:"15px"},children:[(0,rt.jsx)(et,{to:"multimodal",className:"link-offset-3 module-link",children:"Multimodal AI: Image-Text Matching"}),(0,rt.jsx)(et,{to:"unireps",className:"link-offset-3 module-link",children:"Universal Representations (UniReps)"}),(0,rt.jsxs)(et,{to:"explainability",className:"link-offset-3 module-link",children:["  ","Explainable Multimodal AI: From Black Box to Glass Box"]})]})]}),(0,rt.jsx)("hr",{style:{margin:0},className:"border border-2 "})]})},it=n(4942);function ot(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ut(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ot(Object(n),!0).forEach((function(t){(0,it.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ot(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function st(e,t){if(null==e)return{};var n,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}function ct(e,t){if(null==e)return{};var n,r,a=st(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var lt=n(1418),ft=n.n(lt),dt=n(2007),ht=n.n(dt),pt=["as","className","type","tooltip"],vt={type:ht().string,tooltip:ht().bool,as:ht().elementType},mt=k.forwardRef((function(e,t){var n=e.as,r=void 0===n?"div":n,a=e.className,i=e.type,o=void 0===i?"valid":i,u=e.tooltip,s=void 0!==u&&u,c=ct(e,pt);return(0,rt.jsx)(r,ut(ut({},c),{},{ref:t,className:ft()(a,"".concat(o,"-").concat(s?"tooltip":"feedback"))}))}));mt.displayName="Feedback",mt.propTypes=vt;var gt=mt,yt=k.createContext({}),bt=["xxl","xl","lg","md","sm","xs"],xt=k.createContext({prefixes:{},breakpoints:bt,minBreakpoint:"xs"});xt.Consumer,xt.Provider;function wt(e,t){var n=(0,k.useContext)(xt).prefixes;return e||n[t]||t}function kt(){return(0,k.useContext)(xt).breakpoints}function _t(){return(0,k.useContext)(xt).minBreakpoint}var St=["id","bsPrefix","className","type","isValid","isInvalid","as"],Ct=k.forwardRef((function(e,t){var n=e.id,r=e.bsPrefix,a=e.className,i=e.type,o=void 0===i?"checkbox":i,u=e.isValid,s=void 0!==u&&u,c=e.isInvalid,l=void 0!==c&&c,f=e.as,d=void 0===f?"input":f,h=ct(e,St),p=(0,k.useContext)(yt).controlId;return r=wt(r,"form-check-input"),(0,rt.jsx)(d,ut(ut({},h),{},{ref:t,type:o,id:n||p,className:ft()(a,r,s&&"is-valid",l&&"is-invalid")}))}));Ct.displayName="FormCheckInput";var At=Ct,Et=["bsPrefix","className","htmlFor"],Nt=k.forwardRef((function(e,t){var n=e.bsPrefix,r=e.className,a=e.htmlFor,i=ct(e,Et),o=(0,k.useContext)(yt).controlId;return n=wt(n,"form-check-label"),(0,rt.jsx)("label",ut(ut({},i),{},{ref:t,htmlFor:a||o,className:ft()(r,n)}))}));Nt.displayName="FormCheckLabel";var Tt=Nt;function It(e,t){var n=0;return k.Children.map(e,(function(e){return k.isValidElement(e)?t(e,n++):e}))}var Dt=["id","bsPrefix","bsSwitchPrefix","inline","reverse","disabled","isValid","isInvalid","feedbackTooltip","feedback","feedbackType","className","style","title","type","label","children","as"],Ft=k.forwardRef((function(e,t){var n=e.id,r=e.bsPrefix,a=e.bsSwitchPrefix,i=e.inline,o=void 0!==i&&i,u=e.reverse,s=void 0!==u&&u,c=e.disabled,l=void 0!==c&&c,f=e.isValid,d=void 0!==f&&f,h=e.isInvalid,p=void 0!==h&&h,v=e.feedbackTooltip,m=void 0!==v&&v,g=e.feedback,y=e.feedbackType,b=e.className,x=e.style,w=e.title,_=void 0===w?"":w,S=e.type,C=void 0===S?"checkbox":S,A=e.label,E=e.children,N=e.as,T=void 0===N?"input":N,I=ct(e,Dt);r=wt(r,"form-check"),a=wt(a,"form-switch");var D=(0,k.useContext)(yt).controlId,F=(0,k.useMemo)((function(){return{controlId:n||D}}),[D,n]),M=!E&&null!=A&&!1!==A||function(e,t){return k.Children.toArray(e).some((function(e){return k.isValidElement(e)&&e.type===t}))}(E,Tt),O=(0,rt.jsx)(At,ut(ut({},I),{},{type:"switch"===C?"checkbox":C,ref:t,isValid:d,isInvalid:p,disabled:l,as:T}));return(0,rt.jsx)(yt.Provider,{value:F,children:(0,rt.jsx)("div",{style:x,className:ft()(b,M&&r,o&&"".concat(r,"-inline"),s&&"".concat(r,"-reverse"),"switch"===C&&a),children:E||(0,rt.jsxs)(rt.Fragment,{children:[O,M&&(0,rt.jsx)(Tt,{title:_,children:A}),g&&(0,rt.jsx)(gt,{type:y,tooltip:m,children:g})]})})})}));Ft.displayName="FormCheck";var Mt=Object.assign(Ft,{Input:At,Label:Tt}),Ot=(n(2391),["bsPrefix","type","size","htmlSize","id","className","isValid","isInvalid","plaintext","readOnly","as"]),Rt=k.forwardRef((function(e,t){var n=e.bsPrefix,r=e.type,a=e.size,i=e.htmlSize,o=e.id,u=e.className,s=e.isValid,c=void 0!==s&&s,l=e.isInvalid,f=void 0!==l&&l,d=e.plaintext,h=e.readOnly,p=e.as,v=void 0===p?"input":p,m=ct(e,Ot),g=(0,k.useContext)(yt).controlId;return n=wt(n,"form-control"),(0,rt.jsx)(v,ut(ut({},m),{},{type:r,size:i,ref:t,readOnly:h,id:o||g,className:ft()(u,d?"".concat(n,"-plaintext"):n,a&&"".concat(n,"-").concat(a),"color"===r&&"".concat(n,"-color"),c&&"is-valid",f&&"is-invalid")}))}));Rt.displayName="FormControl";var jt=Object.assign(Rt,{Feedback:gt}),Bt=["className","bsPrefix","as"],zt=k.forwardRef((function(e,t){var n=e.className,r=e.bsPrefix,a=e.as,i=void 0===a?"div":a,o=ct(e,Bt);return r=wt(r,"form-floating"),(0,rt.jsx)(i,ut({ref:t,className:ft()(n,r)},o))}));zt.displayName="FormFloating";var Zt=zt,Lt=["controlId","as"],Pt=k.forwardRef((function(e,t){var n=e.controlId,r=e.as,a=void 0===r?"div":r,i=ct(e,Lt),o=(0,k.useMemo)((function(){return{controlId:n}}),[n]);return(0,rt.jsx)(yt.Provider,{value:o,children:(0,rt.jsx)(a,ut(ut({},i),{},{ref:t}))})}));Pt.displayName="FormGroup";var Ut=Pt,Wt=["as","bsPrefix","className"],Vt=["className"];var qt=k.forwardRef((function(e,t){var n=function(e){var t=e.as,n=e.bsPrefix,r=e.className,a=ct(e,Wt);n=wt(n,"col");var i=kt(),o=_t(),u=[],s=[];return i.forEach((function(e){var t,r,i,c=a[e];delete a[e],"object"===typeof c&&null!=c?(t=c.span,r=c.offset,i=c.order):t=c;var l=e!==o?"-".concat(e):"";t&&u.push(!0===t?"".concat(n).concat(l):"".concat(n).concat(l,"-").concat(t)),null!=i&&s.push("order".concat(l,"-").concat(i)),null!=r&&s.push("offset".concat(l,"-").concat(r))})),[ut(ut({},a),{},{className:ft().apply(void 0,[r].concat(u,s))}),{as:t,bsPrefix:n,spans:u}]}(e),r=(0,C.Z)(n,2),a=r[0],i=a.className,o=ct(a,Vt),u=r[1],s=u.as,c=void 0===s?"div":s,l=u.bsPrefix,f=u.spans;return(0,rt.jsx)(c,ut(ut({},o),{},{ref:t,className:ft()(i,!f.length&&l)}))}));qt.displayName="Col";var Gt=qt,Ht=["as","bsPrefix","column","visuallyHidden","className","htmlFor"],Xt=k.forwardRef((function(e,t){var n=e.as,r=void 0===n?"label":n,a=e.bsPrefix,i=e.column,o=void 0!==i&&i,u=e.visuallyHidden,s=void 0!==u&&u,c=e.className,l=e.htmlFor,f=ct(e,Ht),d=(0,k.useContext)(yt).controlId;a=wt(a,"form-label");var h="col-form-label";"string"===typeof o&&(h="".concat(h," ").concat(h,"-").concat(o));var p=ft()(c,a,s&&"visually-hidden",o&&h);return l=l||d,o?(0,rt.jsx)(Gt,ut({ref:t,as:"label",className:p,htmlFor:l},f)):(0,rt.jsx)(r,ut({ref:t,className:p,htmlFor:l},f))}));Xt.displayName="FormLabel";var Kt=Xt,Yt=["bsPrefix","className","id"],$t=k.forwardRef((function(e,t){var n=e.bsPrefix,r=e.className,a=e.id,i=ct(e,Yt),o=(0,k.useContext)(yt).controlId;return n=wt(n,"form-range"),(0,rt.jsx)("input",ut(ut({},i),{},{type:"range",ref:t,className:ft()(r,n),id:a||o}))}));$t.displayName="FormRange";var Qt=$t,Jt=["bsPrefix","size","htmlSize","className","isValid","isInvalid","id"],en=k.forwardRef((function(e,t){var n=e.bsPrefix,r=e.size,a=e.htmlSize,i=e.className,o=e.isValid,u=void 0!==o&&o,s=e.isInvalid,c=void 0!==s&&s,l=e.id,f=ct(e,Jt),d=(0,k.useContext)(yt).controlId;return n=wt(n,"form-select"),(0,rt.jsx)("select",ut(ut({},f),{},{size:a,ref:t,className:ft()(i,n,r&&"".concat(n,"-").concat(r),u&&"is-valid",c&&"is-invalid"),id:l||d}))}));en.displayName="FormSelect";var tn=en,nn=["bsPrefix","className","as","muted"],rn=k.forwardRef((function(e,t){var n=e.bsPrefix,r=e.className,a=e.as,i=void 0===a?"small":a,o=e.muted,u=ct(e,nn);return n=wt(n,"form-text"),(0,rt.jsx)(i,ut(ut({},u),{},{ref:t,className:ft()(r,n,o&&"text-muted")}))}));rn.displayName="FormText";var an=rn,on=k.forwardRef((function(e,t){return(0,rt.jsx)(Mt,ut(ut({},e),{},{ref:t,type:"switch"}))}));on.displayName="Switch";var un=Object.assign(on,{Input:Mt.Input,Label:Mt.Label}),sn=["bsPrefix","className","children","controlId","label"],cn=k.forwardRef((function(e,t){var n=e.bsPrefix,r=e.className,a=e.children,i=e.controlId,o=e.label,u=ct(e,sn);return n=wt(n,"form-floating"),(0,rt.jsxs)(Ut,ut(ut({ref:t,className:ft()(r,n),controlId:i},u),{},{children:[a,(0,rt.jsx)("label",{htmlFor:i,children:o})]}))}));cn.displayName="FloatingLabel";var ln=cn,fn=["className","validated","as"],dn={_ref:ht().any,validated:ht().bool,as:ht().elementType},hn=k.forwardRef((function(e,t){var n=e.className,r=e.validated,a=e.as,i=void 0===a?"form":a,o=ct(e,fn);return(0,rt.jsx)(i,ut(ut({},o),{},{ref:t,className:ft()(n,r&&"was-validated")}))}));hn.displayName="Form",hn.propTypes=dn;var pn=Object.assign(hn,{Group:Ut,Control:jt,Floating:Zt,Check:Mt,Switch:un,Label:Kt,Text:an,Range:Qt,Select:tn,FloatingLabel:ln});function vn(){return vn=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},vn.apply(this,arguments)}n(2176);function mn(e){return"default"+e.charAt(0).toUpperCase()+e.substr(1)}function gn(e){var t=function(e,t){if("object"!==typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===typeof t?t:String(t)}function yn(e,t){return Object.keys(t).reduce((function(n,r){var a,i=n,o=i[mn(r)],u=i[r],s=st(i,[mn(r),r].map(gn)),c=t[r],l=function(e,t,n){var r=(0,k.useRef)(void 0!==e),a=(0,k.useState)(t),i=a[0],o=a[1],u=void 0!==e,s=r.current;return r.current=u,!u&&s&&i!==t&&o(t),[u?e:i,(0,k.useCallback)((function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];n&&n.apply(void 0,[e].concat(r)),o(e)}),[n])]}(u,o,e[c]),f=l[0],d=l[1];return vn({},s,((a={})[r]=f,a[c]=d,a))}),e)}function bn(){var e=this.constructor.getDerivedStateFromProps(this.props,this.state);null!==e&&void 0!==e&&this.setState(e)}function xn(e){this.setState(function(t){var n=this.constructor.getDerivedStateFromProps(e,t);return null!==n&&void 0!==n?n:null}.bind(this))}function wn(e,t){try{var n=this.props,r=this.state;this.props=e,this.state=t,this.__reactInternalSnapshotFlag=!0,this.__reactInternalSnapshot=this.getSnapshotBeforeUpdate(n,r)}finally{this.props=n,this.state=r}}bn.__suppressDeprecationWarning=!0,xn.__suppressDeprecationWarning=!0,wn.__suppressDeprecationWarning=!0;function kn(e,t,n){var r=(0,k.useRef)(void 0!==e),a=(0,k.useState)(t),i=(0,C.Z)(a,2),o=i[0],u=i[1],s=void 0!==e,c=r.current;return r.current=s,!s&&c&&o!==t&&u(t),[s?e:o,(0,k.useCallback)((function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var a=t[0],i=t.slice(1),o=null==n?void 0:n.apply(void 0,[a].concat((0,I.Z)(i)));return u(a),o}),[n])]}var _n={prefix:String(Math.round(1e10*Math.random())),current:0},Sn=k.createContext(_n),Cn=k.createContext(!1);var An=Boolean("undefined"!==typeof window&&window.document&&window.document.createElement),En=new WeakMap;function Nn(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=(0,k.useContext)(Sn),n=(0,k.useRef)(null);if(null===n.current&&!e){var r,a,i=null===(a=k.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED)||void 0===a||null===(r=a.ReactCurrentOwner)||void 0===r?void 0:r.current;if(i){var o=En.get(i);null==o?En.set(i,{id:t.current,state:i.memoizedState}):i.memoizedState!==o.state&&(t.current=o.id,En.delete(i))}n.current=++t.current}return n.current}var Tn="function"===typeof k.useId?function(e){var t=k.useId(),n=(0,k.useState)("function"===typeof k.useSyncExternalStore?k.useSyncExternalStore(Fn,In,Dn):(0,k.useContext)(Cn)),r=(0,C.Z)(n,1)[0]?"react-aria":"react-aria".concat(_n.prefix);return e||"".concat(r,"-").concat(t)}:function(e){var t=(0,k.useContext)(Sn);t!==_n||An||console.warn("When server rendering, you must wrap your application in an <SSRProvider> to ensure consistent ids are generated between the client and server.");var n=Nn(!!e),r="react-aria".concat(t.prefix);return e||"".concat(r,"-").concat(n)};function In(){return!1}function Dn(){return!0}function Fn(e){return function(){}}var Mn=k.createContext(null),On=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return null!=e?String(e):t||null},Rn=k.createContext(null);var jn=function(e){var t=(0,k.useRef)(e);return(0,k.useEffect)((function(){t.current=e}),[e]),t};function Bn(e){var t=jn(e);return(0,k.useCallback)((function(){return t.current&&t.current.apply(t,arguments)}),[t])}var zn=function(e){return e&&"function"!==typeof e?function(t){e.current=t}:e};var Zn=function(e,t){return(0,k.useMemo)((function(){return function(e,t){var n=zn(e),r=zn(t);return function(e){n&&n(e),r&&r(e)}}(e,t)}),[e,t])};var Ln=function(e){var t=e.children,n=e.in,r=e.onExited,a=e.mountOnEnter,i=e.unmountOnExit,o=(0,k.useRef)(null),u=(0,k.useRef)(n),s=Bn(r);(0,k.useEffect)((function(){n?u.current=!0:s(o.current)}),[n,s]);var c=Zn(o,t.ref),l=(0,k.cloneElement)(t,{ref:c});return n?l:i||!u.current&&a?null:l},Pn=["active","eventKey","mountOnEnter","transition","unmountOnExit","role","onEnter","onEntering","onEntered","onExit","onExiting","onExited"],Un=["activeKey","getControlledId","getControllerId"],Wn=["as"];function Vn(e,t){if(null==e)return{};var n,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}function qn(e){var t=e.active,n=e.eventKey,r=e.mountOnEnter,a=e.transition,i=e.unmountOnExit,o=e.role,u=void 0===o?"tabpanel":o,s=e.onEnter,c=e.onEntering,l=e.onEntered,f=e.onExit,d=e.onExiting,h=e.onExited,p=Vn(e,Pn),v=(0,k.useContext)(Mn);if(!v)return[Object.assign({},p,{role:u}),{eventKey:n,isActive:t,mountOnEnter:r,transition:a,unmountOnExit:i,onEnter:s,onEntering:c,onEntered:l,onExit:f,onExiting:d,onExited:h}];var m=v.activeKey,g=v.getControlledId,y=v.getControllerId,b=Vn(v,Un),x=On(n);return[Object.assign({},p,{role:u,id:g(n),"aria-labelledby":y(n)}),{eventKey:n,isActive:null==t&&null!=x?On(m)===x:t,transition:a||b.transition,mountOnEnter:null!=r?r:b.mountOnEnter,unmountOnExit:null!=i?i:b.unmountOnExit,onEnter:s,onEntering:c,onEntered:l,onExit:f,onExiting:d,onExited:h}]}var Gn=k.forwardRef((function(e,t){var n=e.as,r=void 0===n?"div":n,a=qn(Vn(e,Wn)),i=(0,C.Z)(a,2),o=i[0],u=i[1],s=u.isActive,c=u.onEnter,l=u.onEntering,f=u.onEntered,d=u.onExit,h=u.onExiting,p=u.onExited,v=u.mountOnEnter,m=u.unmountOnExit,g=u.transition,y=void 0===g?Ln:g;return(0,rt.jsx)(Mn.Provider,{value:null,children:(0,rt.jsx)(Rn.Provider,{value:null,children:(0,rt.jsx)(y,{in:s,onEnter:c,onEntering:l,onEntered:f,onExit:d,onExiting:h,onExited:p,mountOnEnter:v,unmountOnExit:m,children:(0,rt.jsx)(r,Object.assign({},o,{ref:t,hidden:!s,"aria-hidden":!s}))})})})}));Gn.displayName="TabPanel";var Hn=function(e){var t=e.id,n=e.generateChildId,r=e.onSelect,a=e.activeKey,i=e.defaultActiveKey,o=e.transition,u=e.mountOnEnter,s=e.unmountOnExit,c=e.children,l=kn(a,i,r),f=(0,C.Z)(l,2),d=f[0],h=f[1],p=Tn(t),v=(0,k.useMemo)((function(){return n||function(e,t){return p?"".concat(p,"-").concat(t,"-").concat(e):null}}),[p,n]),m=(0,k.useMemo)((function(){return{onSelect:h,activeKey:d,transition:o,mountOnEnter:u||!1,unmountOnExit:s||!1,getControlledId:function(e){return v(e,"tabpane")},getControllerId:function(e){return v(e,"tab")}}}),[h,d,o,u,s,v]);return(0,rt.jsx)(Mn.Provider,{value:m,children:(0,rt.jsx)(Rn.Provider,{value:h||null,children:c})})};Hn.Panel=Gn;var Xn=Hn,Kn=(n(3573),Function.prototype.bind.call(Function.prototype.call,[].slice));var Yn=k.createContext(null);Yn.displayName="NavContext";var $n=Yn;function Qn(e){return"".concat("data-rr-ui-").concat(e)}var Jn=["as","disabled"];function er(e){var t=e.tagName,n=e.disabled,r=e.href,a=e.target,i=e.rel,o=e.role,u=e.onClick,s=e.tabIndex,c=void 0===s?0:s,l=e.type;t||(t=null!=r||null!=a||null!=i?"a":"button");var f={tagName:t};if("button"===t)return[{type:l||"button",disabled:n},f];var d=function(e){(n||"a"===t&&function(e){return!e||"#"===e.trim()}(r))&&e.preventDefault(),n?e.stopPropagation():null==u||u(e)};return"a"===t&&(r||(r="#"),n&&(r=void 0)),[{role:null!=o?o:"button",disabled:void 0,tabIndex:n?void 0:c,href:r,target:"a"===t?a:void 0,"aria-disabled":n||void 0,rel:"a"===t?i:void 0,onClick:d,onKeyDown:function(e){" "===e.key&&(e.preventDefault(),d(e))}},f]}var tr=k.forwardRef((function(e,t){var n=e.as,r=e.disabled,a=function(e,t){if(null==e)return{};var n,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,Jn),i=er(Object.assign({tagName:n,disabled:r},a)),o=(0,C.Z)(i,2),u=o[0],s=o[1].tagName;return(0,rt.jsx)(s,Object.assign({},a,u,{ref:t}))}));tr.displayName="Button";var nr=tr,rr=["as","active","eventKey"];function ar(e){var t=e.key,n=e.onClick,r=e.active,a=e.id,i=e.role,o=e.disabled,u=(0,k.useContext)(Rn),s=(0,k.useContext)($n),c=(0,k.useContext)(Mn),l=r,f={role:i};if(s){i||"tablist"!==s.role||(f.role="tab");var d=s.getControllerId(null!=t?t:null),h=s.getControlledId(null!=t?t:null);f[Qn("event-key")]=t,f.id=d||a,!(l=null==r&&null!=t?s.activeKey===t:r)&&(null!=c&&c.unmountOnExit||null!=c&&c.mountOnEnter)||(f["aria-controls"]=h)}return"tab"===f.role&&(f["aria-selected"]=l,l||(f.tabIndex=-1),o&&(f.tabIndex=-1,f["aria-disabled"]=!0)),f.onClick=Bn((function(e){o||(null==n||n(e),null!=t&&u&&!e.isPropagationStopped()&&u(t,e))})),[f,{isActive:l}]}var ir=k.forwardRef((function(e,t){var n=e.as,r=void 0===n?nr:n,a=e.active,i=e.eventKey,o=function(e,t){if(null==e)return{};var n,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,rr),u=ar(Object.assign({key:On(i,o.href),active:a},o)),s=(0,C.Z)(u,2),c=s[0],l=s[1];return c[Qn("active")]=l.isActive,(0,rt.jsx)(r,Object.assign({},o,c,{ref:t}))}));ir.displayName="NavItem";var or=ir,ur=["as","onSelect","activeKey","role","onKeyDown"];var sr=function(){},cr=Qn("event-key"),lr=k.forwardRef((function(e,t){var n,r,a=e.as,i=void 0===a?"div":a,o=e.onSelect,u=e.activeKey,s=e.role,c=e.onKeyDown,l=function(e,t){if(null==e)return{};var n,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,ur),f=function(){var e=(0,k.useReducer)((function(e){return!e}),!1);return(0,C.Z)(e,2)[1]}(),d=(0,k.useRef)(!1),h=(0,k.useContext)(Rn),p=(0,k.useContext)(Mn);p&&(s=s||"tablist",u=p.activeKey,n=p.getControlledId,r=p.getControllerId);var v=(0,k.useRef)(null),m=function(e){var t=v.current;if(!t)return null;var n=function(e,t){return Kn(e.querySelectorAll(t))}(t,"[".concat(cr,"]:not([aria-disabled=true])")),r=t.querySelector("[aria-selected=true]");if(!r||r!==document.activeElement)return null;var a=n.indexOf(r);if(-1===a)return null;var i=a+e;return i>=n.length&&(i=0),i<0&&(i=n.length-1),n[i]},g=function(e,t){null!=e&&(null==o||o(e,t),null==h||h(e,t))};(0,k.useEffect)((function(){if(v.current&&d.current){var e=v.current.querySelector("[".concat(cr,"][aria-selected=true]"));null==e||e.focus()}d.current=!1}));var y=Zn(t,v);return(0,rt.jsx)(Rn.Provider,{value:g,children:(0,rt.jsx)($n.Provider,{value:{role:s,activeKey:On(u),getControlledId:n||sr,getControllerId:r||sr},children:(0,rt.jsx)(i,Object.assign({},l,{onKeyDown:function(e){if(null==c||c(e),p){var t;switch(e.key){case"ArrowLeft":case"ArrowUp":t=m(-1);break;case"ArrowRight":case"ArrowDown":t=m(1);break;default:return}t&&(e.preventDefault(),g(t.dataset[function(e){return"".concat("rrUi").concat(e)}("EventKey")]||null,e),d.current=!0,f())}},ref:y,role:s}))})})}));lr.displayName="Nav";var fr=Object.assign(lr,{Item:or}),dr=k.createContext(null);dr.displayName="NavbarContext";var hr=dr,pr=k.createContext(null);pr.displayName="CardHeaderContext";var vr=pr,mr=["className","bsPrefix","as"],gr=k.forwardRef((function(e,t){var n=e.className,r=e.bsPrefix,a=e.as,i=void 0===a?"div":a,o=ct(e,mr);return r=wt(r,"nav-item"),(0,rt.jsx)(i,ut({ref:t,className:ft()(n,r)},o))}));gr.displayName="NavItem";var yr=gr;var br="undefined"!==typeof n.g&&n.g.navigator&&"ReactNative"===n.g.navigator.product;"undefined"!==typeof document||br?k.useLayoutEffect:k.useEffect,new WeakMap;var xr=["onKeyDown"];var wr=k.forwardRef((function(e,t){var n,r=e.onKeyDown,a=function(e,t){if(null==e)return{};var n,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,xr),i=er(Object.assign({tagName:"a"},a)),o=(0,C.Z)(i,1)[0],u=Bn((function(e){o.onKeyDown(e),null==r||r(e)}));return(n=a.href)&&"#"!==n.trim()&&"button"!==a.role?(0,rt.jsx)("a",Object.assign({ref:t},a,{onKeyDown:r})):(0,rt.jsx)("a",Object.assign({ref:t},a,o,{onKeyDown:u}))}));wr.displayName="Anchor";var kr=wr,_r=["bsPrefix","className","as","active","eventKey","disabled"],Sr=k.forwardRef((function(e,t){var n=e.bsPrefix,r=e.className,a=e.as,i=void 0===a?kr:a,o=e.active,u=e.eventKey,s=e.disabled,c=void 0!==s&&s,l=ct(e,_r);n=wt(n,"nav-link");var f=ar(ut({key:On(u,l.href),active:o,disabled:c},l)),d=(0,C.Z)(f,2),h=d[0],p=d[1];return(0,rt.jsx)(i,ut(ut(ut({},l),h),{},{ref:t,disabled:c,className:ft()(r,n,c&&"disabled",p.isActive&&"active")}))}));Sr.displayName="NavLink";var Cr=Sr,Ar=["as","bsPrefix","variant","fill","justify","navbar","navbarScroll","className","activeKey"],Er=k.forwardRef((function(e,t){var n,r,a,i=yn(e,{activeKey:"onSelect"}),o=i.as,u=void 0===o?"div":o,s=i.bsPrefix,c=i.variant,l=i.fill,f=void 0!==l&&l,d=i.justify,h=void 0!==d&&d,p=i.navbar,v=i.navbarScroll,m=i.className,g=i.activeKey,y=ct(i,Ar),b=wt(s,"nav"),x=!1,w=(0,k.useContext)(hr),_=(0,k.useContext)(vr);return w?(r=w.bsPrefix,x=null==p||p):_&&(a=_.cardHeaderBsPrefix),(0,rt.jsx)(fr,ut({as:u,ref:t,activeKey:g,className:ft()(m,(n={},(0,it.Z)(n,b,!x),(0,it.Z)(n,"".concat(r,"-nav"),x),(0,it.Z)(n,"".concat(r,"-nav-scroll"),x&&v),(0,it.Z)(n,"".concat(a,"-").concat(c),!!a),(0,it.Z)(n,"".concat(b,"-").concat(c),!!c),(0,it.Z)(n,"".concat(b,"-fill"),f),(0,it.Z)(n,"".concat(b,"-justified"),h),n))},y))}));Er.displayName="Nav";var Nr=Object.assign(Er,{Item:yr,Link:Cr}),Tr=["className","bsPrefix","as"],Ir=k.forwardRef((function(e,t){var n=e.className,r=e.bsPrefix,a=e.as,i=void 0===a?"div":a,o=ct(e,Tr);return r=wt(r,"tab-content"),(0,rt.jsx)(i,ut({ref:t,className:ft()(n,r)},o))}));Ir.displayName="TabContent";var Dr=Ir,Fr=n(9611);var Mr=!1,Or=k.createContext(null),Rr="unmounted",jr="exited",Br="entering",zr="entered",Zr="exiting",Lr=function(e){var t,n;function r(t,n){var r;r=e.call(this,t,n)||this;var a,i=n&&!n.isMounting?t.enter:t.appear;return r.appearStatus=null,t.in?i?(a=jr,r.appearStatus=Br):a=zr:a=t.unmountOnExit||t.mountOnEnter?Rr:jr,r.state={status:a},r.nextCallback=null,r}n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,(0,Fr.Z)(t,n),r.getDerivedStateFromProps=function(e,t){return e.in&&t.status===Rr?{status:jr}:null};var a=r.prototype;return a.componentDidMount=function(){this.updateStatus(!0,this.appearStatus)},a.componentDidUpdate=function(e){var t=null;if(e!==this.props){var n=this.state.status;this.props.in?n!==Br&&n!==zr&&(t=Br):n!==Br&&n!==zr||(t=Zr)}this.updateStatus(!1,t)},a.componentWillUnmount=function(){this.cancelNextCallback()},a.getTimeouts=function(){var e,t,n,r=this.props.timeout;return e=t=n=r,null!=r&&"number"!==typeof r&&(e=r.exit,t=r.enter,n=void 0!==r.appear?r.appear:t),{exit:e,enter:t,appear:n}},a.updateStatus=function(e,t){if(void 0===e&&(e=!1),null!==t)if(this.cancelNextCallback(),t===Br){if(this.props.unmountOnExit||this.props.mountOnEnter){var n=this.props.nodeRef?this.props.nodeRef.current:N.findDOMNode(this);n&&function(e){e.scrollTop}(n)}this.performEnter(e)}else this.performExit();else this.props.unmountOnExit&&this.state.status===jr&&this.setState({status:Rr})},a.performEnter=function(e){var t=this,n=this.props.enter,r=this.context?this.context.isMounting:e,a=this.props.nodeRef?[r]:[N.findDOMNode(this),r],i=a[0],o=a[1],u=this.getTimeouts(),s=r?u.appear:u.enter;!e&&!n||Mr?this.safeSetState({status:zr},(function(){t.props.onEntered(i)})):(this.props.onEnter(i,o),this.safeSetState({status:Br},(function(){t.props.onEntering(i,o),t.onTransitionEnd(s,(function(){t.safeSetState({status:zr},(function(){t.props.onEntered(i,o)}))}))})))},a.performExit=function(){var e=this,t=this.props.exit,n=this.getTimeouts(),r=this.props.nodeRef?void 0:N.findDOMNode(this);t&&!Mr?(this.props.onExit(r),this.safeSetState({status:Zr},(function(){e.props.onExiting(r),e.onTransitionEnd(n.exit,(function(){e.safeSetState({status:jr},(function(){e.props.onExited(r)}))}))}))):this.safeSetState({status:jr},(function(){e.props.onExited(r)}))},a.cancelNextCallback=function(){null!==this.nextCallback&&(this.nextCallback.cancel(),this.nextCallback=null)},a.safeSetState=function(e,t){t=this.setNextCallback(t),this.setState(e,t)},a.setNextCallback=function(e){var t=this,n=!0;return this.nextCallback=function(r){n&&(n=!1,t.nextCallback=null,e(r))},this.nextCallback.cancel=function(){n=!1},this.nextCallback},a.onTransitionEnd=function(e,t){this.setNextCallback(t);var n=this.props.nodeRef?this.props.nodeRef.current:N.findDOMNode(this),r=null==e&&!this.props.addEndListener;if(n&&!r){if(this.props.addEndListener){var a=this.props.nodeRef?[this.nextCallback]:[n,this.nextCallback],i=a[0],o=a[1];this.props.addEndListener(i,o)}null!=e&&setTimeout(this.nextCallback,e)}else setTimeout(this.nextCallback,0)},a.render=function(){var e=this.state.status;if(e===Rr)return null;var t=this.props,n=t.children,r=(t.in,t.mountOnEnter,t.unmountOnExit,t.appear,t.enter,t.exit,t.timeout,t.addEndListener,t.onEnter,t.onEntering,t.onEntered,t.onExit,t.onExiting,t.onExited,t.nodeRef,st(t,["children","in","mountOnEnter","unmountOnExit","appear","enter","exit","timeout","addEndListener","onEnter","onEntering","onEntered","onExit","onExiting","onExited","nodeRef"]));return k.createElement(Or.Provider,{value:null},"function"===typeof n?n(e,r):k.cloneElement(k.Children.only(n),r))},r}(k.Component);function Pr(){}Lr.contextType=Or,Lr.propTypes={},Lr.defaultProps={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1,enter:!0,exit:!0,onEnter:Pr,onEntering:Pr,onEntered:Pr,onExit:Pr,onExiting:Pr,onExited:Pr},Lr.UNMOUNTED=Rr,Lr.EXITED=jr,Lr.ENTERING=Br,Lr.ENTERED=zr,Lr.EXITING=Zr;var Ur=Lr;function Wr(e){var t=function(e){return e&&e.ownerDocument||document}(e);return t&&t.defaultView||window}var Vr=/([A-Z])/g;var qr=/^ms-/;function Gr(e){return function(e){return e.replace(Vr,"-$1").toLowerCase()}(e).replace(qr,"-ms-")}var Hr=/^((translate|rotate|scale)(X|Y|Z|3d)?|matrix(3d)?|perspective|skew(X|Y)?)$/i;var Xr=function(e,t){var n="",r="";if("string"===typeof t)return e.style.getPropertyValue(Gr(t))||function(e,t){return Wr(e).getComputedStyle(e,t)}(e).getPropertyValue(Gr(t));Object.keys(t).forEach((function(a){var i=t[a];i||0===i?!function(e){return!(!e||!Hr.test(e))}(a)?n+=Gr(a)+": "+i+";":r+=a+"("+i+") ":e.style.removeProperty(Gr(a))})),r&&(n+="transform: "+r+";"),e.style.cssText+=";"+n},Kr=!("undefined"===typeof window||!window.document||!window.document.createElement),Yr=!1,$r=!1;try{var Qr={get passive(){return Yr=!0},get once(){return $r=Yr=!0}};Kr&&(window.addEventListener("test",Qr,Qr),window.removeEventListener("test",Qr,!0))}catch(Xz){}var Jr=function(e,t,n,r){if(r&&"boolean"!==typeof r&&!$r){var a=r.once,i=r.capture,o=n;!$r&&a&&(o=n.__once||function e(r){this.removeEventListener(t,e,i),n.call(this,r)},n.__once=o),e.addEventListener(t,o,Yr?r:i)}e.addEventListener(t,n,r)};var ea=function(e,t,n,r){var a=r&&"boolean"!==typeof r?r.capture:r;e.removeEventListener(t,n,a),n.__once&&e.removeEventListener(t,n.__once,a)};var ta=function(e,t,n,r){return Jr(e,t,n,r),function(){ea(e,t,n,r)}};function na(e,t,n){void 0===n&&(n=5);var r=!1,a=setTimeout((function(){r||function(e,t,n,r){if(void 0===n&&(n=!1),void 0===r&&(r=!0),e){var a=document.createEvent("HTMLEvents");a.initEvent(t,n,r),e.dispatchEvent(a)}}(e,"transitionend",!0)}),t+n),i=ta(e,"transitionend",(function(){r=!0}),{once:!0});return function(){clearTimeout(a),i()}}function ra(e,t,n,r){null==n&&(n=function(e){var t=Xr(e,"transitionDuration")||"",n=-1===t.indexOf("ms")?1e3:1;return parseFloat(t)*n}(e)||0);var a=na(e,n,r),i=ta(e,"transitionend",t);return function(){a(),i()}}function aa(e,t){var n=Xr(e,t)||"",r=-1===n.indexOf("ms")?1e3:1;return parseFloat(n)*r}function ia(e,t){var n=aa(e,"transitionDuration"),r=aa(e,"transitionDelay"),a=ra(e,(function(n){n.target===e&&(a(),t(n))}),n+r)}var oa,ua=["onEnter","onEntering","onEntered","onExit","onExiting","onExited","addEndListener","children","childRef"],sa=k.forwardRef((function(e,t){var n=e.onEnter,r=e.onEntering,a=e.onEntered,i=e.onExit,o=e.onExiting,u=e.onExited,s=e.addEndListener,c=e.children,l=e.childRef,f=ct(e,ua),d=(0,k.useRef)(null),h=Zn(d,l),p=function(e){var t;h((t=e)&&"setState"in t?N.findDOMNode(t):null!=t?t:null)},v=function(e){return function(t){e&&d.current&&e(d.current,t)}},m=(0,k.useCallback)(v(n),[n]),g=(0,k.useCallback)(v(r),[r]),y=(0,k.useCallback)(v(a),[a]),b=(0,k.useCallback)(v(i),[i]),x=(0,k.useCallback)(v(o),[o]),w=(0,k.useCallback)(v(u),[u]),_=(0,k.useCallback)(v(s),[s]);return(0,rt.jsx)(Ur,ut(ut({ref:t},f),{},{onEnter:m,onEntered:y,onEntering:g,onExit:b,onExited:w,onExiting:x,addEndListener:_,nodeRef:d,children:"function"===typeof c?function(e,t){return c(e,ut(ut({},t),{},{ref:p}))}:k.cloneElement(c,{ref:p})}))})),ca=sa,la=["className","children","transitionClasses","onEnter"],fa=(oa={},(0,it.Z)(oa,Br,"show"),(0,it.Z)(oa,zr,"show"),oa),da=k.forwardRef((function(e,t){var n=e.className,r=e.children,a=e.transitionClasses,i=void 0===a?{}:a,o=e.onEnter,u=ut({in:!1,timeout:300,mountOnEnter:!1,unmountOnExit:!1,appear:!1},ct(e,la)),s=(0,k.useCallback)((function(e,t){!function(e){e.offsetHeight}(e),null==o||o(e,t)}),[o]);return(0,rt.jsx)(ca,ut(ut({ref:t,addEndListener:ia},u),{},{onEnter:s,childRef:r.ref,children:function(e,t){return k.cloneElement(r,ut(ut({},t),{},{className:ft()("fade",n,r.props.className,fa[e],i[e])}))}}))}));da.displayName="Fade";var ha=da;function pa(e){return"boolean"===typeof e?e?ha:Ln:e}var va=["bsPrefix","transition"],ma=["className","as"],ga=k.forwardRef((function(e,t){var n=e.bsPrefix,r=e.transition,a=qn(ut(ut({},ct(e,va)),{},{transition:pa(r)})),i=(0,C.Z)(a,2),o=i[0],u=o.className,s=o.as,c=void 0===s?"div":s,l=ct(o,ma),f=i[1],d=f.isActive,h=f.onEnter,p=f.onEntering,v=f.onEntered,m=f.onExit,g=f.onExiting,y=f.onExited,b=f.mountOnEnter,x=f.unmountOnExit,w=f.transition,k=void 0===w?ha:w,_=wt(n,"tab-pane");return(0,rt.jsx)(Mn.Provider,{value:null,children:(0,rt.jsx)(Rn.Provider,{value:null,children:(0,rt.jsx)(k,{in:d,onEnter:h,onEntering:p,onEntered:v,onExit:m,onExiting:g,onExited:y,mountOnEnter:b,unmountOnExit:x,children:(0,rt.jsx)(c,ut(ut({},l),{},{ref:t,className:ft()(u,_,d&&"active")}))})})})}));ga.displayName="TabPane";var ya=ga,ba=["id","onSelect","transition","mountOnEnter","unmountOnExit","variant","children","activeKey"];function xa(e){var t;return function(e,t){var n=0;k.Children.forEach(e,(function(e){k.isValidElement(e)&&t(e,n++)}))}(e,(function(e){null==t&&(t=e.props.eventKey)})),t}function wa(e){var t=e.props,n=t.title,r=t.eventKey,a=t.disabled,i=t.tabClassName,o=t.tabAttrs,u=t.id;return null==n?null:(0,rt.jsx)(yr,{as:"li",role:"presentation",children:(0,rt.jsx)(Cr,ut(ut({as:"button",type:"button",eventKey:r,disabled:a,id:u,className:i},o),{},{children:n}))})}var ka=function(e){var t=yn(e,{activeKey:"onSelect"}),n=t.id,r=t.onSelect,a=t.transition,i=t.mountOnEnter,o=void 0!==i&&i,u=t.unmountOnExit,s=void 0!==u&&u,c=t.variant,l=void 0===c?"tabs":c,f=t.children,d=t.activeKey,h=void 0===d?xa(f):d,p=ct(t,ba);return(0,rt.jsxs)(Xn,{id:n,activeKey:h,onSelect:r,transition:pa(a),mountOnEnter:o,unmountOnExit:s,children:[(0,rt.jsx)(Nr,ut(ut({},p),{},{role:"tablist",as:"ul",variant:l,children:It(f,wa)})),(0,rt.jsx)(Dr,{children:It(f,(function(e){var t=ut({},e.props);return delete t.title,delete t.disabled,delete t.tabClassName,delete t.tabAttrs,(0,rt.jsx)(ya,ut({},t))}))})]})};ka.displayName="Tabs";var _a=ka,Sa=["transition"],Ca=function(e){var t=e.transition,n=ct(e,Sa);return(0,rt.jsx)(Xn,ut(ut({},n),{},{transition:pa(t)}))};Ca.displayName="TabContainer";var Aa=Ca,Ea={eventKey:ht().oneOfType([ht().string,ht().number]),title:ht().node.isRequired,disabled:ht().bool,tabClassName:ht().string,tabAttrs:ht().object},Na=function(){throw new Error("ReactBootstrap: The `Tab` component is not meant to be rendered! It's an abstract component that is only valid as a direct Child of the `Tabs` Component. For custom tabs components use TabPane and TabsContainer directly")};Na.propTypes=Ea;var Ta=Object.assign(Na,{Container:Aa,Content:Dr,Pane:ya}),Ia=function(){var e=(0,I.Z)(Array(100).keys()),t=(0,k.useState)(""),n=(0,C.Z)(t,2),r=n[0],a=n[1];return(0,rt.jsxs)("div",{style:{marginBottom:50},children:[(0,rt.jsx)("h2",{className:"display-6",children:"Explore The Dataset!"}),(0,rt.jsxs)("div",{className:"container-sm",style:{marginTop:50,maxWidth:800},children:[(0,rt.jsxs)("figure",{className:"text-center",children:[(0,rt.jsx)("blockquote",{className:"blockquote",children:(0,rt.jsx)("p",{children:"AI brings educational technology to an inflection point. We can either increase disparities or shrink them, depending on what we do now"})}),(0,rt.jsx)("figcaption",{className:"blockquote-footer",children:"Dr. Russell Shilling"})]}),(0,rt.jsxs)("div",{style:{textAlign:"justify"},children:['The first step towards using AI for any task is to "',(0,rt.jsx)("a",{href:"http://karpathy.github.io/2019/04/25/recipe/",children:"become one with the data"}),'". Not only does a diverse training dataset help the model learn more discriminatory features that generalize better and more accurately to the ',(0,rt.jsx)("a",{href:"http://dx.doi.org/10.1109/ACCESS.2019.2917620",children:"diversity"}),' found in the real world, but it also addresses issues around racial equity and unfair bias ("',(0,rt.jsx)("a",{href:"https://www2.ed.gov/documents/ai-report/ai-report.pdf",children:"algorithmic bias"}),'"). Exploring the dataset\u2014the different categories, and human or machine-generated annotations\u2014is critical, especially when we use "off-the-shelf" models not trained by us. Detailing "A Human Rights Approach to AI", ',(0,rt.jsx)("a",{href:"https://www.unesco.org/en/artificial-intelligence",children:"UNESCO"})," advocates for ",(0,rt.jsx)("em",{children:"Right to Privacy and Data Protection"}),", ",(0,rt.jsx)("em",{children:"Transparency and Explainability"}),", and ",(0,rt.jsx)("em",{children:"Fairness and Non-Discrimination"}),", among others. One way in which privacy can be established is by blurring identifiable facial features prior to training, although a more robust-to-attacks solution would require addressing ",(0,rt.jsx)("a",{href:"http://dx.doi.org/10.1007/978-3-031-19772-7_19",children:"privacy in the camera hardware itself"}),".",(0,rt.jsx)("br",{}),(0,rt.jsx)("br",{}),"Below are 100 out of the 500 images (representative) from every category, taken from ",(0,rt.jsx)("a",{href:"https://image-net.org/static_files/papers/imagenet_cvpr09.pdf",children:"ImageNet"})," and ",(0,rt.jsx)("a",{href:"https://openaccess.thecvf.com/content_CVPR_2019/papers/Karras_A_Style-Based_Generator_Architecture_for_Generative_Adversarial_Networks_CVPR_2019_paper.pdf",children:"Flickr-Faces-HQ"}),":"]}),(0,rt.jsx)(pn.Check,{type:"switch",id:"blur-switch",label:""===r?"Blur Faces":"Un-Blur Faces",onClick:function(e){a(""===r?"_blurred":"")},style:{textAlign:"left",fontSize:"1.3rem",color:"#751ae3",margin:"20px 0 0 0"}}),(0,rt.jsx)(_a,{defaultActiveKey:"face",id:"dataset-tabs",className:"mb-3",style:{alignContent:"center",marginTop:30},children:[["Church","church"],[" Dog","dog"],["Face","face"],["Fish","fish"],["Parachute","parachute"]].map((function(t,n){return(0,rt.jsx)(Ta,{eventKey:t[1],title:t[0],children:(0,rt.jsx)("div",{children:e.map((function(e,n){return(0,rt.jsx)("img",{src:"images/"+t[1]+r+"/"+n+".jpeg",className:"img-fluid zoom",alt:t[0]+" image "+n,width:"50"},t[0]+"-image-"+n)}))})},"tab-"+(n+1))}))})]})]})},Da=n(5861),Fa=["as","bsPrefix","variant","size","active","disabled","className"],Ma=k.forwardRef((function(e,t){var n=e.as,r=e.bsPrefix,a=e.variant,i=void 0===a?"primary":a,o=e.size,u=e.active,s=void 0!==u&&u,c=e.disabled,l=void 0!==c&&c,f=e.className,d=ct(e,Fa),h=wt(r,"btn"),p=er(ut({tagName:n,disabled:l},d)),v=(0,C.Z)(p,2),m=v[0],g=v[1].tagName;return(0,rt.jsx)(g,ut(ut(ut({},m),d),{},{ref:t,disabled:l,className:ft()(f,h,s&&"active",i&&"".concat(h,"-").concat(i),o&&"".concat(h,"-").concat(o),d.href&&l&&"disabled")}))}));Ma.displayName="Button";var Oa=Ma,Ra=["bsPrefix","variant","animation","size","as","className"],ja=k.forwardRef((function(e,t){var n=e.bsPrefix,r=e.variant,a=e.animation,i=void 0===a?"border":a,o=e.size,u=e.as,s=void 0===u?"div":u,c=e.className,l=ct(e,Ra);n=wt(n,"spinner");var f="".concat(n,"-").concat(i);return(0,rt.jsx)(s,ut(ut({ref:t},l),{},{className:ft()(c,f,o&&"".concat(f,"-").concat(o),r&&"text-".concat(r))}))}));ja.displayName="Spinner";var Ba=ja,za=["bsPrefix","className","as"],Za=k.forwardRef((function(e,t){var n=e.bsPrefix,r=e.className,a=e.as,i=void 0===a?"div":a,o=ct(e,za),u=wt(n,"row"),s=kt(),c=_t(),l="".concat(u,"-cols"),f=[];return s.forEach((function(e){var t,n=o[e];delete o[e],t=null!=n&&"object"===typeof n?n.cols:n;var r=e!==c?"-".concat(e):"";null!=t&&f.push("".concat(l).concat(r,"-").concat(t))})),(0,rt.jsx)(i,ut(ut({ref:t},o),{},{className:ft().apply(void 0,[r,u].concat(f))}))}));Za.displayName="Row";var La=Za;function Pa(){return Pa=(0,Da.Z)(E().mark((function e(t){var n,r,a,i,o,u,s,c,l,f;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=document.getElementById("inconv").getContext("2d"),r=n.getImageData(0,0,200,200),a=function(){var e=(0,Da.Z)(E().mark((function e(t,n){var a;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=Math.max(0,Math.min(t,199)),n=Math.max(0,Math.min(n,199)),a=4*(200*n+t),e.abrupt("return",[r.data[a+0],r.data[a+1],r.data[a+2],r.data[a+3]]);case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),i=function(){var e=(0,Da.Z)(E().mark((function e(n,r){var i,o,u,s,c;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=[0,0,0,0],o=0;case 2:if(!(o<t.height)){e.next=18;break}u=0;case 4:if(!(u<t.width)){e.next=15;break}return s=t.weightArray[o][u],e.next=8,a(n+u-t.centerX,r+o-t.centerY);case 8:c=e.sent,i[0]+=c[0]*s,i[1]+=c[1]*s,i[2]+=c[2]*s;case 12:++u,e.next=4;break;case 15:++o,e.next=2;break;case 18:return i[3]=255,e.abrupt("return",i);case 20:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),o=document.getElementById("outconv").getContext("2d",{willReadFrequently:!0}),u=o.getImageData(0,0,200,200),s=0;case 7:if(!(s<200)){e.next=24;break}c=0;case 9:if(!(c<200)){e.next=21;break}return e.next=12,i(c,s);case 12:l=e.sent,f=4*(200*s+c),u.data[f+0]=Math.floor(l[0]),u.data[f+1]=Math.floor(l[1]),u.data[f+2]=Math.floor(l[2]),u.data[f+3]=Math.floor(l[3]);case 18:++c,e.next=9;break;case 21:++s,e.next=7;break;case 24:o.putImageData(u,0,0),document.getElementById("spnconv").style.display="none",document.getElementById("outconv").style.display="block";case 27:case"end":return e.stop()}}),e)}))),Pa.apply(this,arguments)}var Ua=(0,F.Z)((function e(t,n){(0,D.Z)(this,e),this.width=t,this.height=n,this.centerX=Math.floor(t/2),this.centerY=Math.floor(n/2),this.weightArray=[];for(var r=0;r<n;++r){this.weightArray.push([]);for(var a=0;a<t;++a)this.weightArray[r].push(0)}})),Wa=new Ua(3,3);Wa.weightArray[0]=[8,0,-8],Wa.weightArray[1]=[8,0,-8],Wa.weightArray[2]=[8,0,-8];var Va=new Ua(3,3);Va.weightArray[0]=[-2,-1,0],Va.weightArray[1]=[-1,1,1],Va.weightArray[2]=[0,1,2];var qa=new Ua(3,3);qa.weightArray[0]=[8,-4,-4],qa.weightArray[1]=[-4,8,-4],qa.weightArray[2]=[-4,-4,8];var Ga=new Ua(3,3);Ga.weightArray[0]=[-1,-1,-1],Ga.weightArray[1]=[-1,8,-1],Ga.weightArray[2]=[-1,-1,-1];var Ha=function(){var e=(0,k.useState)(void 0),t=(0,C.Z)(e,2),n=t[0],r=t[1],a=(0,k.useState)({a:0,b:0,c:0,d:0,e:0,f:0,g:0,h:0,i:0}),i=(0,C.Z)(a,2),o=i[0],u=i[1],s=(0,k.useState)(void 0),c=(0,C.Z)(s,2),l=c[0],f=c[1],d=function(){var e=(0,Da.Z)(E().mark((function e(t){var n;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(n=new Image).src="test.jpg",n.onload=function(){t.drawImage(n,0,0)};case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();(0,k.useEffect)((function(){var e=document.getElementById("inconv").getContext("2d",{willReadFrequently:!0});d(e)}),[]);var h=function(e){r(e)},p=function(e){var t=e.target,n=t.name,r=t.value;u(ut(ut({},o),{},(0,it.Z)({},n,r)))};(0,k.useEffect)((function(){var e;n&&(e="filter1"===n?Wa:"filter2"===n?Va:"filter3"===n?qa:"filter4"===n?Ga:l,document.getElementById("spnconv").style.display="inline-block",document.getElementById("outconv").style.display="none",setTimeout((function(){return function(e){return Pa.apply(this,arguments)}(e)}),1e3))}),[n,l]);var v=function(e,t){var n=e.weightArray;return(0,rt.jsx)("table",{onClick:function(){return h(t)},children:(0,rt.jsxs)("tbody",{children:[(0,rt.jsxs)("tr",{children:[(0,rt.jsx)("td",{children:n[0][0]}),(0,rt.jsx)("td",{children:n[0][1]}),(0,rt.jsx)("td",{children:n[0][2]})]}),(0,rt.jsxs)("tr",{children:[(0,rt.jsx)("td",{children:n[1][0]}),(0,rt.jsx)("td",{children:n[1][1]}),(0,rt.jsx)("td",{children:n[1][2]})]}),(0,rt.jsxs)("tr",{children:[(0,rt.jsx)("td",{children:n[2][0]}),(0,rt.jsx)("td",{children:n[2][1]}),(0,rt.jsx)("td",{children:n[2][2]})]})]})})};return(0,rt.jsxs)("div",{children:[(0,rt.jsxs)("div",{style:{textAlign:"justify",marginBottom:20},children:["A ",(0,rt.jsx)("a",{href:"https://d2l.ai/chapter_convolutional-neural-networks/conv-layer.html",children:"convolution"})," between an image and a filter is defined as the sliding of the filter over the image from left to right and top to bottom, with elementwise multiplication of the part of the image contained in the convolution window with the filter and summing up the resulting values to give a single scalar value.",(0,rt.jsx)("br",{}),(0,rt.jsx)("br",{}),"Click on the below ",(0,rt.jsx)("tt",{children:"3 x 3"})," filters to see what happens when they are convolved over the image:"]}),(0,rt.jsx)(Oa,{variant:"secondary",onClick:function(){return h("filter1")},children:v(Wa,"filter1")}),(0,rt.jsx)(Oa,{variant:"secondary",onClick:function(){return h("filter2")},children:v(Va,"filter2")}),(0,rt.jsx)(Oa,{variant:"secondary",onClick:function(){return h("filter3")},children:v(qa,"filter3")}),(0,rt.jsx)(Oa,{variant:"secondary",onClick:function(){return h("filter4")},children:v(Ga,"filter4")}),(0,rt.jsx)("br",{}),(0,rt.jsx)("br",{}),(0,rt.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",flexWrap:"wrap"},children:[(0,rt.jsx)("canvas",{id:"inconv",height:200,width:200,style:{margin:"0 20px 30px 20px"}}),(0,rt.jsx)("canvas",{id:"outconv",height:200,width:200,style:{display:"none",margin:"0 20px 30px 20px"}}),(0,rt.jsx)(Ba,{id:"spnconv",style:{display:"none"}}),(0,rt.jsxs)("div",{style:{textAlign:"justify",marginBottom:20},children:["Now here's a challenge... the first filter above represents a ",(0,rt.jsx)("em",{children:"vertical"})," edge detector (which can be verified from the vertical lines extracted from the image). Try to design a horizontal edge detector and check if the convolved image (shown above) matches your expectations!"]}),(0,rt.jsxs)(pn,{children:[(0,rt.jsxs)(La,{children:[(0,rt.jsx)(Gt,{children:(0,rt.jsx)(pn.Control,{type:"number",name:"a",value:o.a,onChange:p,min:-200,max:200})}),(0,rt.jsx)(Gt,{children:(0,rt.jsx)(pn.Control,{type:"number",name:"b",value:o.b,onChange:p,min:-200,max:200})}),(0,rt.jsx)(Gt,{children:(0,rt.jsx)(pn.Control,{type:"number",name:"c",value:o.c,onChange:p,min:-200,max:200})})]}),(0,rt.jsxs)(La,{children:[(0,rt.jsx)(Gt,{children:(0,rt.jsx)(pn.Control,{type:"number",name:"d",value:o.d,onChange:p,min:-200,max:200})}),(0,rt.jsx)(Gt,{children:(0,rt.jsx)(pn.Control,{type:"number",name:"e",value:o.e,onChange:p,min:-200,max:200})}),(0,rt.jsx)(Gt,{children:(0,rt.jsx)(pn.Control,{type:"number",name:"f",value:o.f,onChange:p,min:-200,max:200})})]}),(0,rt.jsxs)(La,{children:[(0,rt.jsx)(Gt,{children:(0,rt.jsx)(pn.Control,{type:"number",name:"g",value:o.g,onChange:p,min:-200,max:200})}),(0,rt.jsx)(Gt,{children:(0,rt.jsx)(pn.Control,{type:"number",name:"h",value:o.h,onChange:p,min:-200,max:200})}),(0,rt.jsx)(Gt,{children:(0,rt.jsx)(pn.Control,{type:"number",name:"i",value:o.i,onChange:p,min:-200,max:200})})]}),(0,rt.jsx)(Oa,{variant:"primary",type:"submit",style:{marginTop:20},onClick:function(e){e.preventDefault();var t=new Ua(3,3);t.weightArray[0]=[o.a,o.b,o.c],t.weightArray[1]=[o.d,o.e,o.f],t.weightArray[2]=[o.g,o.h,o.i],f(t),r("custom")},children:"Convolve!"})]})]})]})};function Xa(){return Xa=(0,Da.Z)(E().mark((function e(t){var n,r,a,i,o;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(n=document.getElementById("inrelu").getContext("2d"),r=n.getImageData(0,0,200,200),a=document.getElementById("outrelu").getContext("2d",{willReadFrequently:!0}),i=a.getImageData(0,0,200,200),o=0;o<16e4;++o)r.data[o]<t?i.data[o]=t:i.data[o]=r.data[o];a.putImageData(i,0,0),document.getElementById("spnrelu").style.display="none",document.getElementById("outrelu").style.display="block";case 8:case"end":return e.stop()}}),e)}))),Xa.apply(this,arguments)}var Ka=function(){var e=(0,k.useState)(0),t=(0,C.Z)(e,2),n=t[0],r=t[1],a=function(){var e=(0,Da.Z)(E().mark((function e(t){var n;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(n=new Image).src="test.jpg",n.onload=function(){t.drawImage(n,0,0)};case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();(0,k.useEffect)((function(){var e=document.getElementById("inrelu").getContext("2d",{willReadFrequently:!0});a(e)}),[]);return(0,rt.jsxs)("div",{children:[(0,rt.jsxs)("div",{style:{textAlign:"justify"},children:["Rectified Linear Unit (ReLU) is a nonlinear activation function that allows neural networks to model nonlinear relationships between variables in the dataset. Rectifiers are also biologically-plausible because they introduce sparsity in activations, similar to ",(0,rt.jsx)("a",{href:"https://proceedings.mlr.press/v15/glorot11a.html",children:"sparse neuronal coding"})," observed in the brain.",(0,rt.jsx)("br",{}),(0,rt.jsx)("br",{}),"For any input ",(0,rt.jsx)("tt",{children:"x"}),", ",(0,rt.jsx)("tt",{children:"ReLU(x) = max(0, x)"}),(0,rt.jsx)("br",{}),(0,rt.jsx)("br",{}),"To see this in action, choose a threshold ",(0,rt.jsx)("tt",{children:"T"})," between 0 and 255. All pixels lesser than ",(0,rt.jsx)("tt",{children:"T"})," will be clipped to equal ",(0,rt.jsx)("tt",{children:"T"}),", effectively preventing the model from learning anything useful from them. This is implemented through the expression: ",(0,rt.jsx)("tt",{children:"pixel = ReLU(pixel - T) + T"}),"."]}),(0,rt.jsxs)(pn,{style:{display:"flex",justifyContent:"center"},children:[(0,rt.jsx)(pn.Control,{type:"number",name:"N",value:n,onChange:function(e){r(e.target.value)},min:0,max:255,style:{width:100,margin:20}}),(0,rt.jsx)(Oa,{variant:"primary",type:"submit",onClick:function(e){e.preventDefault(),document.getElementById("spnrelu").style.display="inline-block",document.getElementById("outrelu").style.display="none",setTimeout((function(){return function(e){return Xa.apply(this,arguments)}(n)}),1e3)},style:{margin:20},children:"ReLU!"})]}),(0,rt.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",flexWrap:"wrap"},children:[(0,rt.jsx)("canvas",{id:"inrelu",height:200,width:200,style:{margin:"0 20px 30px 20px"}}),(0,rt.jsx)("canvas",{id:"outrelu",height:200,width:200,style:{display:"none",margin:"0 20px 30px 20px"}}),(0,rt.jsx)(Ba,{id:"spnrelu",style:{display:"none"}})]})]})},Ya=["bsPrefix","size","vertical","className","role","as"],$a=k.forwardRef((function(e,t){var n=e.bsPrefix,r=e.size,a=e.vertical,i=void 0!==a&&a,o=e.className,u=e.role,s=void 0===u?"group":u,c=e.as,l=void 0===c?"div":c,f=ct(e,Ya),d=wt(n,"btn-group"),h=d;return i&&(h="".concat(d,"-vertical")),(0,rt.jsx)(l,ut(ut({},f),{},{ref:t,role:s,className:ft()(o,h,r&&"".concat(d,"-").concat(r))}))}));$a.displayName="ButtonGroup";var Qa=$a;function Ja(){return Ja=(0,Da.Z)(E().mark((function e(t){var n,r,a,i,o,u,s,c,l,f,d;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=document.getElementById("inpool").getContext("2d"),r=n.getImageData(0,0,200,200),a=function(){var e=(0,Da.Z)(E().mark((function e(t,n,r,a,i){return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("max"!==t){e.next=4;break}return e.abrupt("return",Math.max(n,r,a,i));case 4:if("min"!==t){e.next=8;break}return e.abrupt("return",Math.min(n,r,a,i));case 8:return e.abrupt("return",(n+r+a+i)/4);case 9:case"end":return e.stop()}}),e)})));return function(t,n,r,a,i){return e.apply(this,arguments)}}(),i=document.getElementById("outpool").getContext("2d",{willReadFrequently:!0}),o=i.getImageData(0,0,100,100),u=0;case 6:if(!(u<200)){e.next=25;break}s=0;case 8:if(!(s<200)){e.next=22;break}return l=2*(100*u+s),f=(c=4*(200*u+s))+800,e.next=14,a(t,r.data[c+1],r.data[c+5],r.data[f+1],r.data[f+5]);case 14:d=e.sent,o.data[l+0]=Math.floor(d),o.data[l+1]=Math.floor(d),o.data[l+2]=Math.floor(d),o.data[l+3]=255;case 19:s+=2,e.next=8;break;case 22:u+=2,e.next=6;break;case 25:i.putImageData(o,0,0),document.getElementById("spnpool").style.display="none",document.getElementById("outpool").style.display="block";case 28:case"end":return e.stop()}}),e)}))),Ja.apply(this,arguments)}var ei=function(){(0,k.useEffect)((function(){!function(){for(var e=document.getElementById("inpool").getContext("2d",{willReadFrequently:!0}),t=e.getImageData(0,0,200,200),n=0,r=0;r<16e4;r+=4)t.data[r]=n,t.data[r+1]=n,t.data[r+2]=n,t.data[r+3]=255,n=r%800===0?0===n?0:255:0===n?255:0;e.putImageData(t,0,0)}()}),[]);var e=function(e){document.getElementById("spnpool").style.display="inline-block",document.getElementById("outpool").style.display="none",setTimeout((function(){return function(e){return Ja.apply(this,arguments)}(e)}),1e3)};return(0,rt.jsxs)("div",{children:[(0,rt.jsxs)("div",{style:{textAlign:"justify",marginBottom:20},children:[(0,rt.jsx)("a",{href:"https://d2l.ai/chapter_convolutional-neural-networks/pooling.html",children:"Pooling"})," is a way in which information from an input is gradually aggregated so that convolutional layers downstream can learn a more global representation. It is equivalent to spatially downsampling the input, and can be thought of as allowing the model to learn low-level features such as edges in the earlier layers, and more high-level features like eyes, faces, hands, etc. in the later layers.",(0,rt.jsx)("br",{}),(0,rt.jsx)("br",{}),"Max pooling, Min Pooling, and Average Pooling compute the ",(0,rt.jsx)("tt",{children:"maximum"}),", ",(0,rt.jsx)("tt",{children:"minimum"}),", and ",(0,rt.jsx)("tt",{children:"average"})," over some pre-defined window as a way of aggregation. See how these work below! (Windows are ",(0,rt.jsx)("tt",{children:"2 x 2"})," in size). The image below is checkered; it has an alternating black (0) and white (255) pixel pattern. Why do the following results make sense? Hint: Think about what value you get after applying each of the below pooling operations to the ",(0,rt.jsx)("tt",{children:"2 x 2"})," square window [[255, 0], [0, 255]]."]}),(0,rt.jsxs)(Qa,{children:[(0,rt.jsx)(Oa,{variant:"secondary",onClick:function(){return e("max")},children:"Max Pooling"}),(0,rt.jsx)(Oa,{variant:"secondary",onClick:function(){return e("min")},children:"Min Pooling"}),(0,rt.jsx)(Oa,{variant:"secondary",onClick:function(){return e("avg")},children:"Average Pooling"})]}),(0,rt.jsx)("br",{}),(0,rt.jsx)("br",{}),(0,rt.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",flexWrap:"wrap"},children:[(0,rt.jsx)("canvas",{id:"inpool",height:200,width:200,style:{margin:"0 20px 30px 20px"}}),(0,rt.jsx)("canvas",{id:"outpool",height:100,width:100,style:{display:"none",margin:"0 20px 30px 20px",padding:"auto"}}),(0,rt.jsx)(Ba,{id:"spnpool",style:{display:"none"}})]})]})},ti=function(){return(0,rt.jsxs)("div",{style:{marginBottom:50},children:[(0,rt.jsx)("h2",{className:"display-6",children:"Inside the Model!"}),(0,rt.jsxs)("div",{className:"container-sm",style:{marginTop:50,maxWidth:800},children:[(0,rt.jsxs)("div",{style:{textAlign:"justify"},children:['AI Literacy necessitates understanding of how models work "under-the-hood" so we can critically examine and address areas of issues and needs for improvement, and question the model\'s interaction with people, society, and the environment.',(0,rt.jsx)("br",{}),(0,rt.jsx)("br",{}),"Go through the following tabs to learn about convolutions, non-linearities, and pooling that are used by CNNs:",(0,rt.jsx)("br",{})]}),(0,rt.jsxs)(_a,{defaultActiveKey:"convolution",id:"dataset-tabs",className:"mb-3",style:{alignContent:"center",marginTop:20},children:[(0,rt.jsx)(Ta,{eventKey:"convolution",title:"Convolution",children:(0,rt.jsx)(Ha,{})},"tab-0"),(0,rt.jsx)(Ta,{eventKey:"relu",title:"ReLU",children:(0,rt.jsx)(Ka,{})},"tab-1"),(0,rt.jsx)(Ta,{eventKey:"maxpool",title:"Pooling",children:(0,rt.jsx)(ei,{})},"tab-2")]})]})]})},ni=["bsPrefix","className","fluid","rounded","roundedCircle","thumbnail"],ri=(ht().string,ht().bool,ht().bool,ht().bool,ht().bool,k.forwardRef((function(e,t){var n=e.bsPrefix,r=e.className,a=e.fluid,i=void 0!==a&&a,o=e.rounded,u=void 0!==o&&o,s=e.roundedCircle,c=void 0!==s&&s,l=e.thumbnail,f=void 0!==l&&l,d=ct(e,ni);return n=wt(n,"img"),(0,rt.jsx)("img",ut(ut({ref:t},d),{},{className:ft()(r,i&&"".concat(n,"-fluid"),u&&"rounded",c&&"rounded-circle",f&&"".concat(n,"-thumbnail"))}))})));ri.displayName="Image";var ai=ri,ii=n(3613),oi=n(2145),ui=n(9118),si=n(651),ci=n(4031),li={kernelName:oi.SYM,inputsToSave:["x"],gradFunc:function(e,t){var n=(0,C.Z)(t,1)[0];return{x:function(){return(0,si.d)(e,(0,ci.N)((0,ui.p)(n,"float32"),-1))}}}},fi=n(5750),di=n(4362),hi=n(7067),pi=n(6902),vi=n(7391),mi=n(4774),gi={kernelName:oi.VGw,inputsToSave:["x"],gradFunc:function(e,t){var n=(0,C.Z)(t,1)[0];return{x:function(){var t=(0,vi.h)((0,ui.p)(n,"float32")),r=(0,pi._)((0,mi.l)((0,hi.i)(1),t));return(0,di.W)((0,fi.h)(e,r))}}}},yi={kernelName:oi.SpW,inputsToSave:["x"],gradFunc:function(e,t){var n=(0,C.Z)(t,1)[0];return{x:function(){var t=(0,pi._)((0,mi.l)((0,vi.h)((0,ui.p)(n,"float32")),1));return(0,fi.h)(e,t)}}}},bi=n(5774),xi=n(5561),wi=n(227),ki={kernelName:oi.mm_,inputsToSave:["a","b"],gradFunc:function(e,t){var n=(0,C.Z)(t,2),r=n[0],a=n[1],i=bi.assertAndGetBroadcastShape(r.shape,a.shape);return{a:function(){var t=e,n=bi.getReductionAxes(r.shape,i);return n.length>0&&(t=(0,wi.S)(t,n)),(0,xi.X)(t,r.shape)},b:function(){var t=e,n=bi.getReductionAxes(a.shape,i);return n.length>0&&(t=(0,wi.S)(t,n)),(0,xi.X)(t,a.shape)}}}},_i={kernelName:oi.Xze,saveAllInputs:!0,gradFunc:function(e,t){var n={};return t.forEach((function(t,r){n[r]=function(){return e.clone()}})),n}},Si=n(7293),Ci={kernelName:oi.sJF,inputsToSave:["x"],gradFunc:function(e,t){var n=(0,C.Z)(t,1)[0];return{x:function(){return(0,Si.P)(n)}}}},Ai={kernelName:oi.aJk,inputsToSave:["x"],gradFunc:function(e,t){var n=(0,C.Z)(t,1)[0];return{x:function(){return(0,Si.P)(n)}}}},Ei={kernelName:oi.M2y,inputsToSave:["x"],gradFunc:function(e,t){var n=(0,C.Z)(t,1)[0];return{x:function(){return(0,fi.h)(e,(0,pi._)((0,mi.l)((0,hi.i)(1),(0,vi.h)((0,ui.p)(n,"float32")))))}}}},Ni=n(3312),Ti={kernelName:oi.qw7,inputsToSave:["x"],gradFunc:function(e,t){var n=(0,C.Z)(t,1)[0];return{x:function(){var t=(0,pi._)((0,Ni.I)((0,hi.i)(1),(0,vi.h)((0,ui.p)(n,"float32"))));return(0,fi.h)(e,t)}}}},Ii={kernelName:oi.QCc,inputsToSave:["a","b"],gradFunc:function(e,t){var n=(0,C.Z)(t,2),r=n[0],a=n[1],i=(0,bi.assertAndGetBroadcastShape)(r.shape,a.shape);return{a:function(){var t=(0,Ni.I)((0,vi.h)(r),(0,vi.h)(a)),n=(0,si.d)(e,(0,fi.h)(a,t)),o=(0,bi.getReductionAxes)(r.shape,i);return o.length>0&&(n=(0,wi.S)(n,o)),(0,xi.X)(n,r.shape)},b:function(){var t=(0,Ni.I)((0,vi.h)(r),(0,vi.h)(a)),n=(0,di.W)((0,si.d)(e,(0,fi.h)(r,t))),o=(0,bi.getReductionAxes)(a.shape,i);return o.length>0&&(n=(0,wi.S)(n,o)),(0,xi.X)(n,a.shape)}}}},Di={kernelName:oi.jMg,inputsToSave:["x"],gradFunc:function(e,t){var n=(0,C.Z)(t,1)[0];return{x:function(){return(0,fi.h)(e,(0,Ni.I)((0,vi.h)((0,ui.p)(n,"float32")),1))}}}},Fi={kernelName:oi.Oyi,inputsToSave:["x"],gradFunc:function(e,t){var n=(0,C.Z)(t,1)[0];return{x:function(){return(0,fi.h)(e,(0,mi.l)((0,hi.i)(1),(0,vi.h)((0,ui.p)(n,"float32"))))}}}},Mi=n(318),Oi=n(8354),Ri=n(6147),ji=n(9151),Bi=n(8640);var zi=(0,Bi.op)({avgPool3dGrad_:function(e,t,n,r,a,i){var o=(0,Oi._1)(e,"dy","avgPool3dGrad"),u=(0,Oi._1)(t,"input","avgPool3dGrad"),s=o,c=u,l=!1;4===u.rank&&(l=!0,s=(0,xi.X)(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]]),c=(0,xi.X)(u,[1,u.shape[0],u.shape[1],u.shape[2],u.shape[3]])),Ri.hu(5===s.rank,(function(){return"Error in avgPool3dGrad: dy must be rank 5 but got rank "+"".concat(s.rank,".")})),Ri.hu(5===c.rank,(function(){return"Error in avgPool3dGrad: input must be rank 5 but got rank "+"".concat(c.rank,".")})),(0,ji.m)("avgPool3dGrad",a,i);var f={dy:s,input:c},d={filterSize:n,strides:r,pad:a,dimRoundingMode:i},h=Mi.BV.runKernel(oi.IMb,f,d);return l?(0,xi.X)(h,[h.shape[1],h.shape[2],h.shape[3],h.shape[4]]):h}}),Zi={kernelName:oi._k9,inputsToSave:["x"],gradFunc:function(e,t,n){var r=(0,C.Z)(t,1)[0],a=n.filterSize,i=n.strides,o=n.pad,u=n.dimRoundingMode;return{x:function(){return zi(e,r,a,i,o,u)}}}};var Li=(0,Bi.op)({avgPoolGrad_:function(e,t,n,r,a){var i=(0,Oi._1)(e,"dy","avgPoolGrad"),o=(0,Oi._1)(t,"input","avgPoolGrad");Ri.hu(o.rank===i.rank,(function(){return"Rank of input (".concat(o.rank,") does not match rank of dy (").concat(i.rank,")")}));var u=o,s=i,c=!1;3===o.rank&&(c=!0,u=(0,xi.X)(o,[1,o.shape[0],o.shape[1],o.shape[2]]),s=(0,xi.X)(i,[1,i.shape[0],i.shape[1],i.shape[2]])),Ri.hu(4===s.rank,(function(){return"Error in avgPoolGrad: dy must be rank 4 but got rank "+"".concat(s.rank,".")})),Ri.hu(4===u.rank,(function(){return"Error in avgPoolGrad: input must be rank 4 but got rank "+"".concat(u.rank,".")}));var l={dy:s,input:u},f={filterSize:n,strides:r,pad:a},d=Mi.BV.runKernel(oi.ROF,l,f);return c?(0,xi.X)(d,[d.shape[1],d.shape[2],d.shape[3]]):d}}),Pi={kernelName:oi.JhU,inputsToSave:["x"],gradFunc:function(e,t,n){var r=(0,C.Z)(t,1)[0],a=n.filterSize,i=n.strides,o=n.pad;return{x:function(){return Li(e,r,a,i,o)}}}},Ui=n(7221),Wi={kernelName:oi.XLW,inputsToSave:["a","b"],gradFunc:function(e,t,n){var r=(0,C.Z)(t,2),a=r[0],i=r[1],o=n.transposeA,u=n.transposeB;return o||u?!o&&u?{a:function(){return(0,Ui.O)(e,i,!1,!1)},b:function(){return(0,Ui.O)(e,a,!0,!1)}}:o&&!u?{a:function(){return(0,Ui.O)(i,e,!1,!0)},b:function(){return(0,Ui.O)(a,e,!1,!1)}}:{a:function(){return(0,Ui.O)(i,e,!0,!0)},b:function(){return(0,Ui.O)(e,a,!0,!0)}}:{a:function(){return(0,Ui.O)(e,i,!1,!0)},b:function(){return(0,Ui.O)(a,e,!0,!1)}}}},Vi=n(5696),qi={kernelName:oi.zws,gradFunc:function(e,t,n){var r=n.blockShape,a=n.crops;return{x:function(){return(0,Vi.f)(e,r,a)}}}},Gi={kernelName:oi.Ly9,gradFunc:function(e,t,n){for(var r=n,a=r.inputShape,i=r.shape,o=Array.from(i),u=a.length-1;u>=0;u--)if(a[u]===i[u])o[u]=1;else if(1!==a[u])throw new Error("broadcastTo(): [".concat(a,"] cannot be broadcast to [").concat(i,"]."));for(var s=[],c=0;c<o.length;c++)o[c]>1&&s.push(c);return{x:function(){return(0,wi.S)(e,s,!0)}}}},Hi={kernelName:oi.RFZ,gradFunc:function(e){return{x:function(){return e.clone()}}}},Xi={kernelName:oi.gJX,gradFunc:function(e){return{x:function(){return(0,Si.P)(e)}}}},Ki=n(8327),Yi=n(2642),$i=n(2177),Qi=n(329),Ji={kernelName:oi.xnO,inputsToSave:["x"],gradFunc:function(e,t,n){var r=(0,C.Z)(t,1)[0],a=n.clipValueMin,i=n.clipValueMax;return{x:function(){return(0,Qi.a)((0,$i.H)((0,Ki.b)(r,a),(0,Yi.z)(r,i)),e,(0,Si.P)(e))}}}},eo={kernelName:oi.yj2,inputsToSave:["x"],gradFunc:li.gradFunc},to=n(2588),no={kernelName:oi.Eh3,saveAllInputs:!0,gradFunc:function(e,t,n){var r=t.map((function(e){return e.shape})),a=n.axis,i=(0,Ri.EC)(a,t[0].shape)[0],o=r.map((function(e){return e[i]}));return(0,to.V)(e,o,i).map((function(e){return function(){return e}}))}},ro=n(8744),ao=n(1045),io={kernelName:oi.mhS,inputsToSave:["x","filter"],gradFunc:function(e,t,n){var r=(0,C.Z)(t,2),a=r[0],i=r[1],o=n.dilations,u=n.strides,s=n.pad,c=n.dataFormat;return Ri.hu(ji.I0(o),(function(){return"Error in gradient of conv2D: dilation rates greater than 1 "+"are not yet supported in gradients. Got dilations '".concat(o,"'")})),{x:function(){return(0,ao._)(a.shape,e,i,u,s,c)},filter:function(){return(0,ro.p)(a,e,i.shape,u,s,c)}}}},oo=n(3457),uo={kernelName:oi.wm,inputsToSave:["dy","filter"],gradFunc:function(e,t,n){var r=(0,C.Z)(t,2),a=r[0],i=r[1],o=n.strides,u=n.pad,s=n.dataFormat,c=n.dimRoundingMode;return{dy:function(){return(0,oo.T)(e,i,o,u,s,1,c)},filter:function(){return(0,ro.p)(e,a,i.shape,o,u,s,c)}}}};var so=(0,Bi.op)({conv3DBackpropFilter_:function(e,t,n,r,a){var i=e;4===e.rank&&(i=(0,xi.X)(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]]));var o=t;4===o.rank&&(o=(0,xi.X)(t,[1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]])),Ri.hu(5===i.rank,(function(){return"Error in conv3dDerFilter: input must be rank 5, but got shape "+"".concat(i.shape,".")})),Ri.hu(5===o.rank,(function(){return"Error in conv3dDerFilter: dy must be rank 5, but got shape "+"".concat(o.shape,".")})),Ri.hu(5===n.length,(function(){return"Error in conv3dDerFilter: filterShape must be length 5, but got "+"".concat(n,".")})),Ri.hu(i.shape[4]===n[3],(function(){return"Error in conv3dDerFilter: depth of input ".concat(i.shape[4],") must ")+"match input depth in filter (".concat(n[3],".")})),Ri.hu(o.shape[4]===n[4],(function(){return"Error in conv3dDerFilter: depth of dy (".concat(o.shape[4],") must ")+"match output depth for filter (".concat(n[4],").")}));var u={x:i,dy:o},s={strides:r,pad:a,filterShape:n};return Mi.BV.runKernel(oi.o2y,u,s)}}),co=n(1873),lo={kernelName:oi.x12,inputsToSave:["x","filter"],gradFunc:function(e,t,n){var r=n.dilations,a=n.strides,i=n.pad;Ri.hu((0,ji.I0)(r),(function(){return"Error in gradient of conv3D: dilation rates greater than 1 are "+"not yet supported in gradients. Got dilations '".concat(r,"'")}));var o=(0,C.Z)(t,2),u=o[0],s=o[1];return{x:function(){return(0,co._)(u.shape,e,s,a,i)},filter:function(){return so(u,e,s.shape,a,i)}}}},fo=n(7254),ho={kernelName:oi.mc4,inputsToSave:["x"],gradFunc:function(e,t){var n=(0,C.Z)(t,1)[0];return{x:function(){return(0,si.d)((0,di.W)((0,fo.O)((0,ui.p)(n,"float32"))),e)}}}},po=n(7657),vo={kernelName:oi.TR1,inputsToSave:["x"],gradFunc:function(e,t){var n=(0,C.Z)(t,1)[0];return{x:function(){return(0,si.d)((0,po.R)((0,ui.p)(n,"float32")),e)}}}},mo=n(8473),go=n(8862),yo=n(1240),bo={kernelName:oi.iHb,inputsToSave:["x"],gradFunc:function(e,t,n){var r=(0,C.Z)(t,1)[0],a=n.axis,i=n.exclusive,o=n.reverse;return{x:function(){var t=(0,mo.Q3)([a],r.rank),n=(0,go.z)(e,a,i,!o);return null!=t&&(n=(0,yo.p)(n,t)),n}}}},xo=n(288),wo=n(6939),ko={kernelName:oi.cie,inputsToSave:["x","filter"],gradFunc:function(e,t,n){var r=n.dilations,a=n.strides,i=n.pad,o=n.dimRoundingMode,u=null==r?[1,1]:r;Ri.hu(ji.I0(u),(function(){return"Error in gradient of depthwiseConv2dNative: dilation rates greater than 1 are not yet supported. Got dilations "+"'".concat(u,"'")}));var s=(0,C.Z)(t,2),c=s[0],l=s[1];return Ri.hu(4===c.rank,(function(){return"Error in gradient of depthwiseConv2dNative: input must be "+"rank 4, but got rank ".concat(c.rank,".")})),Ri.hu(4===l.rank,(function(){return"Error in gradient of depthwiseConv2dNative: filter must be "+"rank 4, but got rank ".concat(l.rank,".")})),Ri.hu(c.shape[3]===l.shape[2],(function(){return"Error in gradient of depthwiseConv2d: number of input "+"channels (".concat(c.shape[3],") must match the inChannels dimension ")+"in filter ".concat(l.shape[2],".")})),Ri.hu(ji.jT(a,u),(function(){return"Error in gradient of depthwiseConv2d: Either strides or "+"dilations must be  1. Got strides ".concat(a," and dilations ")+"'".concat(u,"'.")})),ji.m("depthwiseConv2d",i,o),{x:function(){return(0,wo.v)(c.shape,e,l,a,i,u,o)},filter:function(){return(0,xo.z)(c,e,l.shape,a,i,u,o)}}}},_o={kernelName:oi.p4S,inputsToSave:["x","filter"],gradFunc:function(e,t,n){var r=(0,C.Z)(t,2),a=r[0],i=r[1],o={x:a,filter:i,dy:e},u={x:a,filter:i,dy:e};return{x:function(){return Mi.BV.runKernel(oi.ekb,o,n)},filter:function(){return Mi.BV.runKernel(oi.Vn9,u,n)}}}},So={kernelName:oi.SX0,outputsToSave:[!0],gradFunc:function(e,t){var n={dy:e,y:(0,C.Z)(t,1)[0]};return{x:function(){return Mi.BV.runKernel(oi.HEU,n)}}}},Co=n(411),Ao={kernelName:oi.Omj,inputsToSave:["x"],gradFunc:function(e,t){var n=(0,C.Z)(t,1)[0],r=(0,si.d)((0,Co.Q)((0,di.W)((0,vi.h)(n))),2/Math.sqrt(Math.PI));return{x:function(){return(0,si.d)(e,r)}}}},Eo={kernelName:oi.NEP,outputsToSave:[!0],gradFunc:function(e,t){var n=(0,C.Z)(t,1)[0];return{x:function(){return(0,si.d)(e,n)}}}},No={kernelName:oi.YFo,inputsToSave:["input"],gradFunc:function(e,t){var n=(0,C.Z)(t,1)[0];return{input:function(){return(0,xi.X)(e,n.shape)}}}},To={kernelName:oi.Y0y,inputsToSave:["x"],gradFunc:function(e,t){var n=(0,C.Z)(t,1)[0];return{x:function(){return(0,si.d)(e,(0,Co.Q)(n))}}}},Io={kernelName:oi.OR,gradFunc:function(e){return{x:function(){return(0,Si.P)(e)}}}},Do={kernelName:oi.jeX,inputsToSave:["a","b"],gradFunc:function(e,t){var n=(0,C.Z)(t,2),r=n[0],a=n[1],i=(0,bi.assertAndGetBroadcastShape)(r.shape,a.shape);return{a:function(){var t=(0,fi.h)(e,(0,ui.p)(a,"float32")),n=(0,bi.getReductionAxes)(r.shape,i);return n.length>0?(0,xi.X)((0,wi.S)(t,n),r.shape):t},b:function(){var t=(0,si.d)(e,(0,ui.p)(r,"float32")),n=(0,bi.getReductionAxes)(a.shape,i);n.length>0&&(t=(0,xi.X)((0,wi.S)(t,n),a.shape));var o=(0,vi.h)(a);return(0,di.W)((0,fi.h)(t,(0,ui.p)(o,"float32")))}}}},Fo=n(5115),Mo=n(2343),Oo={kernelName:oi.sHE,inputsToSave:["x","mean","variance","scale"],gradFunc:function(e,t,n){var r=n.varianceEpsilon,a=(0,C.Z)(t,4),i=a[0],o=a[1],u=a[2],s=a[3],c=null==s?(0,hi.i)(1):s,l=(0,bi.getReductionAxes)(o.shape,i.shape),f=[];if(1===o.rank){for(var d=0;d<i.shape.length-1;++d)f.push(i.shape[d]);f.push(1)}var h=(0,mi.l)(i,o),p=(0,si.d)(e,c),v=(0,Fo.b)((0,Ni.I)(u,(0,hi.i)(r))),m=(0,si.d)((0,si.d)((0,si.d)(v,v),v),(0,hi.i)(-.5));return{x:function(){return 1===o.rank?(0,xi.X)((0,si.d)((0,si.d)(e,(0,Mo.G)((0,xi.X)(v,[1,1,1,o.shape[0]]),f)),c),i.shape):(0,xi.X)((0,si.d)((0,si.d)(e,v),c),i.shape)},mean:function(){var e=(0,si.d)((0,si.d)(v,(0,hi.i)(-1)),p);return 1===o.rank&&(e=(0,wi.S)(e,l)),(0,xi.X)(e,o.shape)},variance:function(){var e=(0,si.d)((0,si.d)(m,h),p);return 1===o.rank&&(e=(0,wi.S)(e,l)),(0,xi.X)(e,o.shape)},scale:function(){var t=(0,si.d)(h,v),n=(0,si.d)(e,t);return 1===o.rank&&(n=(0,wi.S)(n,l)),(0,xi.X)(n,o.shape)},offset:function(){var t=e;return 1===o.rank&&(t=(0,wi.S)(t,l)),(0,xi.X)(t,o.shape)}}}},Ro=n(8306),jo=n(6918),Bo={kernelName:oi.qi_,inputsToSave:["x","indices"],gradFunc:function(e,t,n){var r=(0,C.Z)(t,2),a=r[0],i=r[1],o=n.axis,u=n.batchDims,s=(0,Ri.EC)(o,a.shape)[0],c=function(e,t,n){return function(){var r=e.shape,a=t.size,i=r.slice(0,s),u=i.length,c=r.slice(o,r.length).slice(1),l=c.length,f=zo(0,u),d=zo(u+1,u+1+l),h=Zo([i,[a],c]),p=(0,xi.X)(n,h),v=(0,xi.X)(t,[a]),m=Zo([[u],f,d]),g=(0,yo.p)(p,m),y=(0,jo.p)(g,v,e.shape[s]),b=(0,mo.LJ)(m);return y=(0,yo.p)(y,b)}};if(1===u){var l=a.shape[0],f=a.split(l,0);return{x:function(){var t=(0,Ro.k)(f.map((function(t,n){return c(t,i.slice(n,1),e.slice(n,1))()})));return t.reshape(a.shape)},indices:function(){return i}}}return{x:c(a,i,e),indices:function(){return i}}}};function zo(e,t){for(var n=[],r=e;r<t;++r)n.push(r);return n}function Zo(e){for(var t=[],n=0;n<e.length;++n)for(var r=0;r<e[n].length;++r)t.push(e[n][r]);return t}var Lo={kernelName:oi.Acj,inputsToSave:["a","b"],gradFunc:function(e,t){var n=(0,C.Z)(t,2),r=n[0],a=n[1];return{a:function(){return(0,Si.P)(r)},b:function(){return(0,Si.P)(a)}}}},Po={kernelName:oi.iJz,gradFunc:function(e){return{x:function(){return(0,ui.p)(e,"float32")}}}},Uo={kernelName:oi.avt,gradFunc:function(e){return{x:function(){return(0,Si.P)(e)}}}},Wo={kernelName:oi.iWB,gradFunc:function(e){return{x:function(){return(0,Si.P)(e)}}}},Vo={kernelName:oi.r7n,gradFunc:function(e){return{x:function(){return(0,Si.P)(e)}}}},qo=n(5014),Go={kernelName:oi.J$2,inputsToSave:["x"],gradFunc:function(e,t,n){var r=(0,C.Z)(t,1)[0],a=n.alpha,i=(0,qo.p)(r,0);return{x:function(){return(0,Qi.a)(i,e,(0,si.d)(e,a))}}}},Ho={kernelName:oi.kU,inputsToSave:["x"],gradFunc:function(e,t){var n=(0,C.Z)(t,1)[0];return{x:function(){return(0,fi.h)(e,(0,Ni.I)(n,1))}}}},Xo={kernelName:oi.ZbH,inputsToSave:["x"],gradFunc:function(e,t){var n=(0,C.Z)(t,1)[0];return{x:function(){return(0,fi.h)(e,(0,ui.p)(n,"float32"))}}}},Ko={kernelName:oi.qCd,inputsToSave:[],outputsToSave:[!0],gradFunc:function(e,t,n){var r=(0,C.Z)(t,1)[0],a=n.axis;return{logits:function(){var t=(0,Co.Q)(r);return(0,mi.l)(e,(0,si.d)((0,wi.S)(e,a,!0),t))}}}};var Yo=(0,Bi.op)({localResponseNormalizationBackprop_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:5,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:.5,u={x:e,y:t,dy:n},s={depthRadius:r,bias:a,alpha:i,beta:o};return Mi.BV.runKernel(oi.Hhh,u,s)}}),$o={kernelName:oi.eZ0,inputsToSave:["x"],outputsToSave:[!0],gradFunc:function(e,t,n){var r=(0,C.Z)(t,2),a=r[0],i=r[1],o=n.depthRadius,u=n.bias,s=n.alpha,c=n.beta;return{x:function(){return Yo(a,i,e,o,u,s,c)}}}},Qo=n(3254);function Jo(e,t,n,r){return t.rank<n.rank&&(t=(0,xi.X)(t,mo.rv(t.shape,r))),e.rank<n.rank&&(e=(0,xi.X)(e,mo.rv(e.shape,r))),{x:function(){return(0,si.d)(e,(0,ui.p)((0,Qo.D)(n,t),e.dtype))}}}var eu={kernelName:oi.YoZ,inputsToSave:["x"],outputsToSave:[!0],gradFunc:function(e,t,n){var r=n.reductionIndices,a=t[0],i=Jo(e,t[1],a,Ri.EC(r,a.shape));return{x:function(){return i.x()}}}},tu=n(4920),nu={kernelName:oi.BMI,inputsToSave:["a","b"],gradFunc:function(e,t){var n=(0,C.Z)(t,2),r=n[0],a=n[1];return{a:function(){return(0,si.d)(e,(0,ui.p)((0,Ki.b)(r,a),"float32"))},b:function(){return(0,si.d)(e,(0,ui.p)((0,tu.d)(r,a),"float32"))}}}};var ru=(0,Bi.op)({maxPool3dGrad_:function(e,t,n,r,a,i,o){var u=(0,Oi._1)(e,"dy","maxPool3dGrad"),s=(0,Oi._1)(t,"input","maxPool3dGrad"),c=(0,Oi._1)(n,"output","maxPool3dGrad"),l=u,f=s,d=c,h=!1;4===s.rank&&(h=!0,l=(0,xi.X)(u,[1,u.shape[0],u.shape[1],u.shape[2],u.shape[3]]),f=(0,xi.X)(s,[1,s.shape[0],s.shape[1],s.shape[2],s.shape[3]]),d=(0,xi.X)(c,[1,c.shape[0],c.shape[1],c.shape[2],c.shape[3]])),Ri.hu(5===l.rank,(function(){return"Error in maxPool3dGrad: dy must be rank 5 but got rank "+"".concat(l.rank,".")})),Ri.hu(5===f.rank,(function(){return"Error in maxPool3dGrad: input must be rank 5 but got rank "+"".concat(f.rank,".")})),Ri.hu(5===d.rank,(function(){return"Error in maxPool3dGrad: output must be rank 5 but got rank "+"".concat(d.rank,".")})),(0,ji.m)("maxPool3dGrad",i,o);var p={dy:l,input:f,output:d},v={filterSize:r,strides:a,pad:i,dimRoundingMode:o},m=Mi.BV.runKernel(oi.OU7,p,v);return h?(0,xi.X)(m,[m.shape[1],m.shape[2],m.shape[3],m.shape[4]]):m}}),au={kernelName:oi.OAf,inputsToSave:["x"],outputsToSave:[!0],gradFunc:function(e,t,n){var r=(0,C.Z)(t,2),a=r[0],i=r[1],o=n.filterSize,u=n.strides,s=n.pad,c=n.dimRoundingMode;return{x:function(){return ru(e,a,i,o,u,s,c)}}}};var iu=(0,Bi.op)({maxPoolGrad_:function(e,t,n,r,a,i,o){var u=(0,Oi._1)(e,"dy","maxPoolGrad"),s=(0,Oi._1)(t,"input","maxPoolGrad"),c=(0,Oi._1)(n,"output","maxPoolGrad");Ri.hu(s.rank===u.rank,(function(){return"Rank of input (".concat(s.rank,") does not match rank of dy ")+"(".concat(u.rank,")")})),Ri.hu(4===u.rank,(function(){return"Error in maxPoolGrad: dy must be rank 4 but got rank "+"".concat(u.rank,".")})),Ri.hu(4===s.rank,(function(){return"Error in maxPoolGrad: input must be rank 4 but got rank "+"".concat(s.rank,".")})),ji.m("maxPoolGrad",i,o);var l={dy:u,input:s,output:c},f={filterSize:r,strides:a,pad:i,dimRoundingMode:o};return Mi.BV.runKernel(oi.OV7,l,f)}}),ou={kernelName:oi.mTV,inputsToSave:["x"],outputsToSave:[!0],gradFunc:function(e,t,n){var r=(0,C.Z)(t,2),a=r[0],i=r[1],o=n.filterSize,u=n.strides,s=n.pad;return{x:function(){return iu(e,a,i,o,u,s)}}}},uu=n(6100),su={kernelName:oi.q2K,inputsToSave:["x"],gradFunc:function(e,t,n){var r=(0,C.Z)(t,1)[0],a=n.axis,i=Ri.EC(a,r.shape),o=(0,mo.kz)(r.shape,i)[1],u=Ri.NA(o);return{x:function(){var t=r.shape.slice();i.forEach((function(e){t[e]=1}));var n=(0,xi.X)(e,t);return(0,fi.h)((0,si.d)(n,(0,uu.i)(r.shape,"float32")),u)}}}},cu={kernelName:oi.c17,inputsToSave:["x"],outputsToSave:[!0],gradFunc:function(e,t,n){var r=n.axis,a=(0,C.Z)(t,2),i=a[0],o=Jo(e,a[1],i,Ri.EC(r,i.shape));return{x:function(){return o.x()}}}},lu={kernelName:oi.q8u,inputsToSave:["a","b"],gradFunc:function(e,t){var n=(0,C.Z)(t,2),r=n[0],a=n[1];return{a:function(){return(0,si.d)(e,(0,ui.p)((0,Yi.z)(r,a),"float32"))},b:function(){return(0,si.d)(e,(0,ui.p)((0,qo.p)(r,a),"float32"))}}}},fu=n(9238),du={kernelName:oi.jQs,inputsToSave:["x"],gradFunc:function(e,t,n){var r=t[0],a=n.paddings.map((function(e){return e[0]}));return{x:function(){return(0,fu.t)(e,a,r.shape)}}}},hu=n(2628),pu={kernelName:oi.Vbg,inputsToSave:["a","b"],gradFunc:function(e,t){var n=(0,C.Z)(t,2),r=n[0],a=n[1],i=(0,bi.assertAndGetBroadcastShape)(r.shape,a.shape);return{a:function(){var t=(0,bi.getReductionAxes)(r.shape,i);return t.length>0?(0,xi.X)((0,wi.S)(e,t),r.shape):e},b:function(){var t=(0,si.d)(e,(0,di.W)((0,hu.G)((0,fi.h)(r,a)))),n=(0,bi.getReductionAxes)(a.shape,i);return n.length>0?(0,xi.X)((0,wi.S)(t,n),a.shape):t}}}},vu={kernelName:oi.wYn,inputsToSave:["a","b"],gradFunc:function(e,t){var n=(0,C.Z)(t,2),r=n[0],a=n[1],i=(0,bi.assertAndGetBroadcastShape)(r.shape,a.shape);return{a:function(){var t=(0,si.d)(e,(0,ui.p)(a,"float32")),n=(0,bi.getReductionAxes)(r.shape,i);return n.length>0?(0,xi.X)((0,wi.S)(t,n),r.shape):t},b:function(){var t=(0,si.d)(e,(0,ui.p)(r,"float32")),n=(0,bi.getReductionAxes)(a.shape,i);return n.length>0?(0,xi.X)((0,wi.S)(t,n),a.shape):t}}}},mu={kernelName:oi.kuV,gradFunc:function(e){return{x:function(){return(0,di.W)(e)}}}},gu=n(7742),yu={kernelName:oi.we_,inputsToSave:["indices"],gradFunc:function(e,t){var n=t[0];return{indices:function(){return(0,gu.l)(n.shape,"float32")}}}},bu={kernelName:oi.qWM,gradFunc:function(e){return{x:function(){return(0,Si.P)(e)}}}},xu=n(4566),wu={kernelName:oi.QiL,saveAllInputs:!0,gradFunc:function(e,t,n){var r=n.axis;return(0,xu.H)(e,r).map((function(e){return function(){return e}}))}},ku={kernelName:oi.lyA,inputsToSave:["x"],gradFunc:function(e,t,n){var r=t[0],a=n.paddings.map((function(e){return e[0]}));return{x:function(){return(0,fu.t)(e,a,r.shape)}}}},_u=n(378),Su=n(4334),Cu={kernelName:oi.pe_,inputsToSave:["a","b"],outputsToSave:[!0],gradFunc:function(e,t){var n=(0,C.Z)(t,3),r=n[0],a=n[1],i=n[2],o=r,u=a,s=bi.assertAndGetBroadcastShape(o.shape,u.shape);return{a:function(){var t=(0,ui.p)(u,"float32"),n=(0,si.d)(e,(0,si.d)(t,(0,Su.s)(o,(0,mi.l)(t,(0,hi.i)(1))))),r=bi.getReductionAxes(o.shape,s);return r.length>0&&(n=(0,wi.S)(n,r)),(0,xi.X)(n,o.shape)},b:function(){var t=(0,qo.p)(o,0),n=(0,Qi.a)(t,(0,_u.c)(o),(0,Si.P)(o)),r=(0,si.d)(e,(0,si.d)(i,n)),a=bi.getReductionAxes(u.shape,s);return a.length>0&&(r=(0,wi.S)(r,a)),(0,xi.X)(r,u.shape)}}}},Au={kernelName:oi.o0g,inputsToSave:["x","alpha"],gradFunc:function(e,t){var n=(0,C.Z)(t,2),r=n[0],a=n[1],i=(0,qo.p)(r,0);return{x:function(){return(0,Qi.a)(i,e,(0,si.d)(e,a))},alpha:function(){var t=(0,Qi.a)(i,(0,Si.P)(e),(0,si.d)(e,r)),n=(0,bi.getReductionAxes)(a.shape,e.shape);return n.length>0&&(t=(0,wi.S)(t,n)),(0,xi.X)(t,a.shape)}}}},Eu=n(9457);function Nu(e,t,n){var r=e.shape.length,a=r-n.length,i=mo.Q3(n,r),o=e;null!=i&&(o=(0,yo.p)(e,i));var u=o.shape.slice(),s=u.splice(r-n.length,n.length).reduce((function(e,t){return e*t}),1);u.push(s);var c=function(e,t,n){var r=e.shape.slice();r[n]=1;var a=(0,xi.X)(t,r),i=(0,Eu.$)(e,n,!0,!1),o=(0,Eu.$)(e,n,!0,!0),u=(0,si.d)(i,o);return(0,si.d)(a,u)}(o.reshape(u),t,a);if(c=c.reshape(o.shape),null!=i){var l=mo.LJ(i);c=(0,yo.p)(c,l)}return c}var Tu={kernelName:oi.DlI,inputsToSave:["x"],gradFunc:function(e,t,n){var r=(0,C.Z)(t,1)[0],a=n.axis,i=[];return i=void 0===a||null===a?r.shape.map((function(e,t){return t})):"number"===typeof a?[a]:a,{x:function(){return Nu(r,e,i)}}}},Iu={kernelName:oi.oHH,inputsToSave:["a","b"],gradFunc:function(e,t){var n=(0,C.Z)(t,2),r=n[0],a=n[1],i=bi.assertAndGetBroadcastShape(r.shape,a.shape);return{a:function(){var t=(0,fi.h)(e,(0,ui.p)(a,"float32")),n=bi.getReductionAxes(r.shape,i);return n.length>0?(0,xi.X)((0,wi.S)(t,n),r.shape):t},b:function(){var t=(0,si.d)(e,(0,ui.p)(r,"float32")),n=bi.getReductionAxes(a.shape,i);n.length>0&&(t=(0,xi.X)((0,wi.S)(t,n),a.shape));var o=(0,vi.h)(a);return(0,di.W)((0,fi.h)(t,(0,ui.p)(o,"float32")))}}}},Du={kernelName:oi.$HU,inputsToSave:["x"],gradFunc:function(e,t){var n=(0,C.Z)(t,1)[0];return{x:function(){return(0,fi.h)(e,(0,di.W)((0,vi.h)(n)))}}}},Fu={kernelName:oi.SbG,inputsToSave:["x"],gradFunc:function(e,t){var n=(0,C.Z)(t,1)[0],r=(0,si.d)((0,Yi.z)(n,6),(0,ci.N)(n));return{x:function(){return(0,si.d)(e,(0,ui.p)(r,"float32"))}}}},Mu={kernelName:oi.qkr,inputsToSave:["x"],gradFunc:function(e,t){var n=(0,C.Z)(t,1)[0];return{x:function(){return(0,si.d)(e,(0,ui.p)((0,ci.N)(n),"float32"))}}}},Ou={kernelName:oi.HZH,inputsToSave:["x"],gradFunc:function(e,t){var n=(0,C.Z)(t,1)[0];return{x:function(){return(0,xi.X)(e,n.shape)}}}},Ru={kernelName:oi._Yw,inputsToSave:["images"],gradFunc:function(e,t,n){var r={dy:e,images:(0,C.Z)(t,1)[0]};return{images:function(){return Mi.BV.runKernel(oi.zbQ,r,n)}}}},ju={kernelName:oi.dpD,inputsToSave:["images"],gradFunc:function(e,t,n){var r={dy:e,images:(0,C.Z)(t,1)[0]};return{images:function(){return Mi.BV.runKernel(oi.Hmb,r,n)}}}},Bu=n(4933),zu={kernelName:oi.mKl,gradFunc:function(e,t,n){var r=n.dims,a=(0,Ri.EC)(r,e.shape);return{x:function(){return(0,Bu.G)(e,a)}}}},Zu={kernelName:oi.e07,gradFunc:function(e){return{x:function(){return(0,Si.P)(e)}}}},Lu={kernelName:oi.bV0,inputsToSave:["x"],gradFunc:function(e,t){var n=(0,C.Z)(t,1)[0];return{x:function(){return(0,di.W)((0,fi.h)(e,(0,si.d)((0,Su.s)(n,1.5),2)))}}}},Pu=n(875),Uu={kernelName:oi.PhF,inputsToSave:["condition"],gradFunc:function(e,t){var n=(0,C.Z)(t,1)[0];return{condition:function(){return(0,ui.p)((0,Si.P)(n),"float32")},t:function(){return(0,si.d)(e,(0,ui.p)(n,e.dtype))},e:function(){return(0,si.d)(e,(0,ui.p)((0,Pu.h)(n),e.dtype))}}}},Wu=n(349),Vu={kernelName:oi.oFR,inputsToSave:["x"],gradFunc:function(e,t){var n=(0,C.Z)(t,1)[0];return{x:function(){var t=(0,qo.p)(n,(0,hi.i)(0)),r=(0,hi.i)(Wu.y),a=(0,hi.i)(Wu.$),i=(0,si.d)(e,a),o=(0,si.d)((0,si.d)(e,r),(0,Co.Q)((0,ui.p)(n,"float32")));return(0,Qi.a)(t,i,o)}}}},qu={kernelName:oi.a5O,outputsToSave:[!0],gradFunc:function(e,t){var n=(0,C.Z)(t,1)[0];return{x:function(){return(0,si.d)(e,(0,si.d)(n,(0,mi.l)((0,hi.i)(1),n)))}}}},Gu={kernelName:oi.i5y,gradFunc:function(e){return{x:function(){return(0,Si.P)(e)}}}},Hu=n(1227),Xu={kernelName:oi.RQH,inputsToSave:["x"],gradFunc:function(e,t){var n=(0,C.Z)(t,1)[0];return{x:function(){return(0,si.d)((0,Hu.m)((0,ui.p)(n,"float32")),e)}}}},Ku=n(6679),Yu={kernelName:oi.wYB,inputsToSave:["x"],gradFunc:function(e,t){var n=(0,C.Z)(t,1)[0];return{x:function(){return(0,si.d)((0,Ku.f)((0,ui.p)(n,"float32")),e)}}}},$u=n(1970),Qu=n(2875),Ju={kernelName:oi.p2w,inputsToSave:["x"],gradFunc:function(e,t,n){for(var r=(0,C.Z)(t,1)[0],a=n.begin,i=n.size,o=r.shape,u=(0,Qu.parseSliceParams)(r,a,i),s=(0,C.Z)(u,2),c=s[0],l=s[1],f=[],d=0;d<e.rank;d++)f.push([c[d],o[d]-c[d]-l[d]]);return{x:function(){return(0,$u.v)(e,f)}}}},es={kernelName:oi.Gcp,outputsToSave:[!0],gradFunc:function(e,t,n){var r=(0,C.Z)(t,1)[0],a=n.dim,i=(0,si.d)(e,r);return{logits:function(){return(0,mi.l)(i,(0,si.d)((0,wi.S)(i,[a],true),r))}}}},ts=n(7643),ns={kernelName:oi.MRv,inputsToSave:["x"],gradFunc:function(e,t){var n=(0,C.Z)(t,1)[0];return{x:function(){return(0,si.d)(e,(0,ts.X)(n))}}}},rs=n(6994),as={kernelName:oi.TQc,gradFunc:function(e,t,n){var r=n.blockShape,a=n.paddings;return{x:function(){return(0,rs.E)(e,r,a)}}}},is=n(4836),os={kernelName:oi.L8s,gradFunc:function(e,t,n){var r=n.axis;return{x:function(){return(0,is.z)(e,r)}}}},us={kernelName:oi.FKq,inputsToSave:["x"],gradFunc:function(e,t){var n=(0,C.Z)(t,1)[0];return{x:function(){return(0,fi.h)(e,(0,si.d)((0,pi._)((0,ui.p)(n,"float32")),2))}}}},ss={kernelName:oi.bK0,inputsToSave:["x"],gradFunc:function(e,t){var n=(0,C.Z)(t,1)[0];return{x:function(){return(0,si.d)(e,(0,si.d)((0,ui.p)(n,"float32"),2))}}}},cs={kernelName:oi._tC,inputsToSave:["a","b"],gradFunc:function(e,t){var n=(0,C.Z)(t,2),r=n[0],a=n[1],i=(0,hi.i)(2);return{a:function(){return(0,si.d)(e,(0,si.d)(i,(0,mi.l)(r,a)))},b:function(){return(0,si.d)(e,(0,si.d)(i,(0,mi.l)(a,r)))}}}},ls={kernelName:oi.h8e,gradFunc:function(e){return{x:function(){return(0,Si.P)(e)}}}},fs={kernelName:oi.Tr8,inputsToSave:["a","b"],gradFunc:function(e,t){var n=(0,C.Z)(t,2),r=n[0],a=n[1],i=bi.assertAndGetBroadcastShape(r.shape,a.shape);return{a:function(){var t=e,n=bi.getReductionAxes(r.shape,i);return n.length>0&&(t=(0,wi.S)(t,n)),(0,xi.X)(t,r.shape)},b:function(){var t=e,n=bi.getReductionAxes(a.shape,i);return n.length>0&&(t=(0,wi.S)(t,n)),(0,xi.X)((0,di.W)(t),a.shape)}}}},ds={kernelName:oi.GBy,inputsToSave:["x"],gradFunc:function(e,t,n){var r=(0,C.Z)(t,1)[0],a=r.shape.slice(),i=n.axis;(0,Ri.EC)(i,r.shape).forEach((function(e){a[e]=1}));var o=(0,xi.X)(e,a),u=(0,si.d)(o,(0,uu.i)(r.shape,"float32"));return{x:function(){return u}}}},hs={kernelName:oi.sEM,inputsToSave:["x"],gradFunc:function(e,t){var n=(0,C.Z)(t,1)[0];return{x:function(){return(0,fi.h)(e,(0,vi.h)((0,Hu.m)(n)))}}}},ps={kernelName:oi.MIZ,outputsToSave:[!0],gradFunc:function(e,t){var n=(0,C.Z)(t,1)[0];return{x:function(){return(0,si.d)((0,mi.l)((0,hi.i)(1),(0,vi.h)(n)),e)}}}},vs={kernelName:oi.n9L,inputsToSave:["x"],gradFunc:function(e,t,n){var r=(0,C.Z)(t,1)[0],a=n.reps;return{x:function(){var t=(0,Si.P)(r);if(1===r.rank)for(var n=0;n<a[0];++n)t=(0,Ni.I)(t,(0,fu.t)(e,[n*r.shape[0]],[r.shape[0]]));else if(2===r.rank)for(var i=0;i<a[0];++i)for(var o=0;o<a[1];++o)t=(0,Ni.I)(t,(0,fu.t)(e,[i*r.shape[0],o*r.shape[1]],[r.shape[0],r.shape[1]]));else if(3===r.rank)for(var u=0;u<a[0];++u)for(var s=0;s<a[1];++s)for(var c=0;c<a[2];++c)t=(0,Ni.I)(t,(0,fu.t)(e,[u*r.shape[0],s*r.shape[1],c*r.shape[2]],[r.shape[0],r.shape[1],r.shape[2]]));else{if(4!==r.rank)throw new Error("Gradient for tile operation is not implemented for rank-"+"".concat(r.rank," tensors yet."));for(var l=0;l<a[0];++l)for(var f=0;f<a[1];++f)for(var d=0;d<a[2];++d)for(var h=0;h<a[3];++h)t=(0,Ni.I)(t,(0,fu.t)(e,[l*r.shape[0],f*r.shape[1],d*r.shape[2],h*r.shape[3]],[r.shape[0],r.shape[1],r.shape[2],r.shape[3]]))}return t}}}},ms={kernelName:oi.G3Y,gradFunc:function(e,t,n){var r=n.perm,a=mo.LJ(r);return{x:function(){return(0,yo.p)(e,a)}}}},gs={kernelName:oi.ToN,gradFunc:function(e,t,n){var r=n.axis;return{value:function(){return(0,Ro.k)(e,r)}}}},ys=n(2975),bs=n(9498),xs=n(705),ws={kernelName:oi.Qvg,inputsToSave:["segmentIds"],gradFunc:function(e,t){var n=(0,C.Z)(t,1)[0];return{x:function(){return function(e,t){for(var n=(0,xs.g)(t,(0,Si.P)(t)),r=(0,bs.I)(e,n),a=(0,Ki.b)(t,(0,hi.i)(0,"int32")),i=r.rank-a.rank,o=0;o<i;++o)a=(0,ys.d)(a,o+1);a=(0,$i.H)(a,(0,uu.i)(r.shape,"bool"));var u=(0,Si.P)(r);return(0,Qi.a)(a,r,u)}(e,n)}}}};for(var ks={kernelName:oi.RuY,gradFunc:function(e){return{x:function(){return(0,Si.P)(e)}}}},_s=n(8864),Ss=0,Cs=[li,gi,yi,ki,_i,Ci,Ai,Ei,Ti,Ii,Di,Fi,Zi,Pi,Wi,qi,Gi,Hi,Xi,Ji,eo,no,uo,io,lo,ho,vo,bo,ko,_o,Iu,So,Ao,Eo,No,To,Do,Io,Oo,Bo,Lo,Po,Uo,Wo,Vo,Go,Ho,Xo,Ko,$o,eu,eu,nu,au,ou,su,cu,lu,du,pu,vu,mu,yu,bu,wu,ku,ku,Cu,Au,Tu,Du,Fu,Mu,Ou,Ru,ju,zu,Zu,Lu,Uu,Vu,qu,Gu,Xu,Yu,Ju,es,ns,as,as,os,os,us,cs,ss,ls,fs,ds,hs,ps,vs,ms,gs,ws,ks];Ss<Cs.length;Ss++){var As=Cs[Ss];(0,_s.Li)(As)}n(4672);var Es=n(7326),Ns=function(e){(0,M.Z)(n,e);var t=(0,O.Z)(n);function n(e){var r;return(0,D.Z)(this,n),r=t.call(this,e),Object.setPrototypeOf((0,Es.Z)(r),n.prototype),r}return(0,F.Z)(n)}((0,R.Z)(Error)),Ts=function(e){(0,M.Z)(n,e);var t=(0,O.Z)(n);function n(e){var r;return(0,D.Z)(this,n),r=t.call(this,e),Object.setPrototypeOf((0,Es.Z)(r),n.prototype),r}return(0,F.Z)(n)}((0,R.Z)(Error)),Is=function(e){(0,M.Z)(n,e);var t=(0,O.Z)(n);function n(e){var r;return(0,D.Z)(this,n),r=t.call(this,e),Object.setPrototypeOf((0,Es.Z)(r),n.prototype),r}return(0,F.Z)(n)}((0,R.Z)(Error)),Ds=function(e){(0,M.Z)(n,e);var t=(0,O.Z)(n);function n(e){var r;return(0,D.Z)(this,n),r=t.call(this,e),Object.setPrototypeOf((0,Es.Z)(r),n.prototype),r}return(0,F.Z)(n)}((0,R.Z)(Error)),Fs=function(e){(0,M.Z)(n,e);var t=(0,O.Z)(n);function n(e){var r;return(0,D.Z)(this,n),r=t.call(this,e),Object.setPrototypeOf((0,Es.Z)(r),n.prototype),r}return(0,F.Z)(n)}((0,R.Z)(Error)),Ms=(Error,function(){function e(t){(0,D.Z)(this,e),this.maxEntries=t||100,this.cache=new Map}return(0,F.Z)(e,[{key:"get",value:function(e){var t;return this.cache.has(e)&&(t=this.cache.get(e),this.cache.delete(e),this.cache.set(e,t)),t}},{key:"put",value:function(e,t){if(this.cache.has(e))this.cache.delete(e);else if(this.cache.size>=this.maxEntries){var n=this.cache.keys().next().value;this.cache.delete(n)}this.cache.set(e,t)}},{key:"getMaxEntries",value:function(){return this.maxEntries}},{key:"setMaxEntries",value:function(e){if(e<0)throw new Error("The maxEntries of LRU caches must be at least 0, but got ".concat(e,"."));if(this.maxEntries>e)for(var t=0;t<this.maxEntries-e;t++){var n=this.cache.keys().next().value;this.cache.delete(n)}this.maxEntries=e}}]),e}());function Os(e,t){if(Array.isArray(e)){for(var n=[],r=0;r<t;r++)n=n.concat(e);return n}var a=new Array(t);return a.fill(e),a}function Rs(e,t){if(!e)throw new Fs(t)}function js(e,t){var n,r=0,a=(0,B.Z)(e);try{for(a.s();!(n=a.n()).done;){n.value===t&&r++}}catch(i){a.e(i)}finally{a.f()}return r}function Bs(e){return 1===e.length?e[0]:e}function zs(e){return Array.isArray(e)?e:[e]}function Zs(e){var t=e.replace(/(.)([A-Z][a-z0-9]+)/g,"$1_$2").replace(/([a-z])([A-Z])/g,"$1_$2").toLowerCase();return"_"!==t[0]?t:"private"+t}function Ls(e){return e.length<=1||-1===e.indexOf("_")?e:e.replace(/[_]+(\w|$)/g,(function(e,t){return t.toUpperCase()}))}var Ps={};function Us(e){if(null===e||void 0===e)return null;var t={};return t.className=e.getClassName(),t.config=e.getConfig(),t}function Ws(e){if(null!=e&&"object"===typeof e)if(Array.isArray(e))e.forEach((function(e){return Ws(e)}));else for(var t=0,n=Object.keys(e);t<n.length;t++){var r=n[t],a=e[r];null!=a&&"object"===typeof a&&(Array.isArray(a)||"ndarray"!==a.type||"number"!==typeof a.value?Ws(a):e[r]=a.value)}}function Vs(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"object",a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if("string"===typeof e){var i,o=e;if(o in n)i=n[o];else if(o in Ps)i=Ps[o];else if(null==(i=t[o]))throw new Is("Unknown ".concat(r,": ").concat(e,". ")+"This may be due to one of the following reasons:\n"+"1. The ".concat(r," is defined in Python, in which ")+"case it needs to be ported to TensorFlow.js or your JavaScript code.\n"+"2. The custom ".concat(r," is defined in JavaScript, ")+"but is not registered properly with tf.serialization.registerClass().");return i}var u=e;if(null==u.className||null==u.config)throw new Is("".concat(r,": Improper config format: ")+"".concat(JSON.stringify(u),".\n")+"'className' and 'config' must set.");var s,c,l=u.className;if(l in n){var f=(0,C.Z)(n[l],2);s=f[0],c=f[1]}else if(l in Ps){var d=(0,C.Z)(Ps.className,2);s=d[0],c=d[1]}else if(l in t){var h=(0,C.Z)(t[l],2);s=h[0],c=h[1]}if(null==s)throw new Is("Unknown ".concat(r,": ").concat(l,". ")+"This may be due to one of the following reasons:\n"+"1. The ".concat(r," is defined in Python, in which ")+"case it needs to be ported to TensorFlow.js or your JavaScript code.\n"+"2. The custom ".concat(r," is defined in JavaScript, ")+"but is not registered properly with tf.serialization.registerClass().");if(null!=c){for(var p={},v=0,m=Object.keys(Ps);v<m.length;v++){var g=m[v];p[g]=Ps[g]}for(var y=0,b=Object.keys(n);y<b.length;y++){var x=b[y];p[x]=n[x]}var w=u.config;w.customObjects=p;for(var k=Object.assign({},Ps),_=0,S=Object.keys(n);_<S.length;_++){var A=S[_];Ps[A]=n[A]}Ws(u.config);var E=c(s,u.config,n,a);return Ps=Object.assign({},k),E}for(var N=Object.assign({},Ps),T=0,I=Object.keys(n);T<I.length;T++){var D=I[T];Ps[D]=n[D]}var F=new s(u.config);return Ps=Object.assign({},N),F}function qs(e,t){return-1*function(e,t){return e<t?-1:e>t?1:0}(e,t)}function Gs(e){if(null==e)return e;var t,n=[],r=(0,B.Z)(e);try{for(r.s();!(t=r.n()).done;){var a=t.value;-1===n.indexOf(a)&&n.push(a)}}catch(i){r.e(i)}finally{r.f()}return n}function Hs(e){if(null==e)throw new Is("Invalid value in obj: ".concat(JSON.stringify(e)));for(var t in e)if(e.hasOwnProperty(t))return!1;return!0}function Xs(e,t,n){if(null!=n&&e.indexOf(n)<0)throw new Is("".concat(n," is not a valid ").concat(t,".  Valid values are ").concat(e," or null/undefined."))}function Ks(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1/0;return Rs(n>=0),Rs(r>=n),Array.isArray(e)&&e.length>=n&&e.length<=r&&e.every((function(e){return typeof e===t}))}function Ys(e,t){Array.isArray(e)?(ii.util.assert(e.length>0,(function(){return"".concat(t," is unexpectedly an empty array.")})),e.forEach((function(e,n){return Ys(e,"element ".concat(n+1," of ").concat(t))}))):ii.util.assert(Number.isInteger(e)&&e>0,(function(){return"Expected ".concat(t," to be a positive integer, but got ")+"".concat($s(e),".")}))}function $s(e){return null===e?"null":Array.isArray(e)?"["+e.map((function(e){return $s(e)})).join(",")+"]":"string"===typeof e?'"'.concat(e,'"'):"".concat(e)}function Qs(e){return"relu"===e?"relu":"linear"===e?"linear":"elu"===e?"elu":null}var Js=0;function ec(){return Js++}var tc={};function nc(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return e in tc||(tc[e]=0),tc[e]+=1,e+tc[e].toString()}var rc=["channelsFirst","channelsLast"],ac=["nearest","bilinear"],ic=["valid","same","causal"],oc=["max","avg"],uc=["sum","mul","concat","ave"],sc=new Map;function cc(e){Xs(rc,"DataFormat",e)}function lc(e){Xs(ic,"PaddingMode",e)}function fc(e){Xs(oc,"PoolMode",e)}var dc=[];function hc(e,t){dc.push(e);try{var n=t();return dc.pop(),n}catch(Xz){throw dc.pop(),Xz}}function pc(e){if(!yc(e))throw new Error("Not a valid tensor name: '"+e+"'");return(0===dc.length?"":dc.join("/")+"/")+e}function vc(e){if(!yc(e))throw new Error("Not a valid tensor name: '"+e+"'");sc.has(e)||sc.set(e,0);var t=sc.get(e);if(sc.set(e,sc.get(e)+1),t>0){var n="".concat(e,"_").concat(t);return sc.set(n,1),n}return e}var mc,gc=new RegExp(/^[A-Za-z0-9][-A-Za-z0-9\._\/]*$/);function yc(e){return!!e.match(gc)}function bc(e,t,n){null==t&&(t=0),null==n&&(n=e.length);for(var r=1,a=t;a<n;++a)r*=e[a];return r}function xc(e){if(0===e.length)return Number.NaN;for(var t=Number.POSITIVE_INFINITY,n=0;n<e.length;n++){var r=e[n];r<t&&(t=r)}return t}function wc(e){if(0===e.length)return Number.NaN;for(var t=Number.NEGATIVE_INFINITY,n=0;n<e.length;n++){var r=e[n];r>t&&(t=r)}return t}function kc(e,t){if(t<e)throw new Is("end (".concat(t,") < begin (").concat(e,") is forbidden."));for(var n=[],r=e;r<t;++r)n.push(r);return n}function _c(){return null==mc&&(mc=(0,ii.backend)().epsilon()),mc}function Sc(e,t){return ii.cast(e,t)}function Cc(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,n=e.shape.slice();return t<0&&(t=n.length+t+1),n.splice(t,0,1),ii.reshape(e,n)}function Ac(e){var t=[bc(e.shape)];return ii.reshape(e,t)}function Ec(e,t,n){return(0,ii.tidy)((function(){switch(e.rank){case 1:return ii.slice1d(e,t,n);case 2:return ii.slice2d(e,[t,0],[n,e.shape[1]]);case 3:return ii.slice3d(e,[t,0,0],[n,e.shape[1],e.shape[2]]);case 4:return ii.slice4d(e,[t,0,0,0],[n,e.shape[1],e.shape[2],e.shape[3]]);case 5:return ii.slice(e,[t,0,0,0,0],[n,e.shape[1],e.shape[2],e.shape[3],e.shape[4]]);case 6:return ii.slice(e,[t,0,0,0,0,0],[n,e.shape[1],e.shape[2],e.shape[3],e.shape[4],e.shape[5]]);default:throw new Is("sliceAlongFirstAxis() received an unsupported tensor rank: "+"".concat(e.rank))}}))}function Nc(e,t,n){return(0,ii.tidy)((function(){switch(e.rank){case 1:return ii.slice1d(e,t,n);case 2:return ii.slice2d(e,[0,t],[e.shape[0],n]);case 3:return ii.slice3d(e,[0,0,t],[e.shape[0],e.shape[1],n]);case 4:return ii.slice4d(e,[0,0,0,t],[e.shape[0],e.shape[1],e.shape[2],n]);default:throw new Is("sliceAlongLastAxis() received an unsupported tensor rank: "+"".concat(e.rank))}}))}function Tc(e,t,n,r){return(0,ii.tidy)((function(){switch(e.rank){case 1:return ii.slice1d(e,t,n);case 2:switch(r){case 1:return Ec(e,t,n);case 2:return Nc(e,t,n);default:throw new Is("The axis is not within the rank of the tensor "+"".concat(r))}case 3:switch(r){case 1:return Ec(e,t,n);case 2:return ii.slice3d(e,[0,t,0],[e.shape[0],n,e.shape[2]]);case 3:return Nc(e,t,n);default:throw new Is("The axis is not within the rank of the tensor "+"".concat(r))}case 4:switch(r){case 1:return Ec(e,t,n);case 2:return ii.slice4d(e,[0,t,0,0],[e.shape[0],n,e.shape[2],e.shape[3]]);case 3:return ii.slice4d(e,[0,0,t,0],[e.shape[0],e.shape[1],n,e.shape[3]]);case 4:return Nc(e,t,n);default:throw new Is("The axis is not within the rank of the tensor "+"".concat(r))}default:throw new Is("sliceAlongLastAxis() received an unsupported tensor rank: "+"".concat(e.rank))}}))}function Ic(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;return n<0&&(n=0!==(t=e[0].rank)?t:0),n===e[0].rank&&(n=-1),ii.concat(e,n)}function Dc(e,t){switch(e.rank){case 1:return ii.concat1d([e,t]);case 2:return ii.concat2d([e,t],0);case 3:return ii.concat3d([e,t],0);case 4:return ii.concat4d([e,t],0);default:throw new Is("concatAlongFirstAxis() received an unsupported "+"tensor rank: ".concat(e.rank))}}function Fc(e,t){if(Array.isArray(t)||(t=[t]),e.rank!==t.length)throw new Is("The length of input n (".concat(t.length,") does not match ")+"the number of dimensions in input x (".concat(e.rank,")"));return ii.tile(e,t)}function Mc(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3?arguments[3]:void 0,a=arguments.length>4?arguments[4]:void 0;return ii.randomNormal(e,t,n,r,a)}function Oc(e,t,n,r){if(e.rank<2||t.rank<2)throw new Ds("dot requires both inputs to be rank >= 2"+" but got x shape = ".concat(e.shape," and y shape = ").concat(t.shape));if(t.rank>=3&&e.shape.slice(-1)[0]!==t.shape.slice(-2)[0])throw new Ds("If rank y >= 3, then the second last dim"+" of y must equal the last dim of x but got x shape = ".concat(e.shape," and ")+" y shape = ".concat(t.shape));if(2===e.rank&&2===t.rank){return ii.fused.matMul({a:e,b:t,transposeA:!1,transposeB:!1,bias:r?Bc(e.rank,r,"channelsLast"):null,activation:n})}var a=e.shape.slice(),i=a.pop();e=ii.reshape(e,[-1,i]);var o=t.shape.slice(),u=o.pop(),s=o.pop(),c=[].concat((0,I.Z)(o),[u]),l=Array.from({length:t.rank},(function(e,n){return 0===n?t.rank-2:n<=t.rank-2?n-1:n}));t=ii.reshape(ii.transpose(t,l),[s,-1]);var f=[].concat((0,I.Z)(a),(0,I.Z)(c));return ii.reshape(ii.fused.matMul({a:e,b:t,transposeA:!1,transposeB:!1,bias:r?Bc(e.rank,r,"channelsLast"):null,activation:n}),f)}function Rc(e,t,n){return(0,ii.tidy)((function(){return t=Array.isArray(t)?(0,ii.tensor1d)(t,"int32"):ii.cast(t,"int32"),ii.gather(e,t,n)}))}function jc(e){return ii.mul(e,e)}function Bc(e,t,n){var r=t.shape;if(1!==t.rank&&t.rank!==e)throw new Is("Unexpected bias dimensions: ".concat(t.rank)+"; expected it to be 1 or ".concat(e));if(5===e){if("channelsFirst"===n)return 1===r.length?ii.reshape(t,[1,r[0],1,1,1]):ii.reshape(t,[1,r[3],r[0],r[1],r[2]]);if("channelsLast"===n)return 1===r.length?ii.reshape(t,[1,1,1,1,r[0]]):ii.reshape(t,[1].concat(r))}else if(4===e){if("channelsFirst"===n)return 1===r.length?ii.reshape(t,[1,r[0],1,1]):ii.reshape(t,[1,r[2],r[0],r[1]]);if("channelsLast"===n)return 1===r.length?ii.reshape(t,[1,1,1,r[0]]):ii.reshape(t,[1].concat(r))}else if(3===e){if("channelsFirst"===n)return 1===r.length?ii.reshape(t,[1,r[0],1]):ii.reshape(t,[1,r[1],r[0]]);if("channelsLast"===n)return 1===r.length?ii.reshape(t,[1,1,r[0]]):ii.reshape(t,[1].concat(r))}else if(e<3)return t;throw new Is("Unsupported input rank by biasAdd: ".concat(t.rank))}function zc(e,t,n){return(0,ii.tidy)((function(){return null==n&&(n="channelsLast"),cc(n),ii.add(e,Bc(e.rank,t,n))}))}function Zc(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(1!==t)throw new Ds("Support for alpha values other than 1 (".concat(t,") is not implemented ")+"yet.");return ii.elu(e)}function Lc(e,t,n,r){return(0,ii.tidy)((function(){return ii.dropout(e,t,n,r)}))}function Pc(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return n?e():t()}var Uc=["fanIn","fanOut","fanAvg"],Wc=["normal","uniform","truncatedNormal"];var Vc=function(e){(0,M.Z)(n,e);var t=(0,O.Z)(n);function n(){return(0,D.Z)(this,n),t.apply(this,arguments)}return(0,F.Z)(n,[{key:"fromConfigUsesCustomObjects",value:function(){return!1}},{key:"getConfig",value:function(){return{}}}]),n}(ii.serialization.Serializable),qc=function(e){(0,M.Z)(n,e);var t=(0,O.Z)(n);function n(){return(0,D.Z)(this,n),t.apply(this,arguments)}return(0,F.Z)(n,[{key:"apply",value:function(e,t){return(0,ii.zeros)(e,t)}}]),n}(Vc);qc.className="Zeros",ii.serialization.registerClass(qc);var Gc=function(e){(0,M.Z)(n,e);var t=(0,O.Z)(n);function n(){return(0,D.Z)(this,n),t.apply(this,arguments)}return(0,F.Z)(n,[{key:"apply",value:function(e,t){return(0,ii.ones)(e,t)}}]),n}(Vc);Gc.className="Ones",ii.serialization.registerClass(Gc);var Hc=function(e){(0,M.Z)(n,e);var t=(0,O.Z)(n);function n(e){var r;if((0,D.Z)(this,n),r=t.call(this),"object"!==typeof e)throw new Is("Expected argument of type ConstantConfig but got ".concat(e));if(void 0===e.value)throw new Is("config must have value set but got ".concat(e));return r.value=e.value,r}return(0,F.Z)(n,[{key:"apply",value:function(e,t){var n=this;return(0,ii.tidy)((function(){return(0,ii.mul)((0,ii.scalar)(n.value),(0,ii.ones)(e,t))}))}},{key:"getConfig",value:function(){return{value:this.value}}}]),n}(Vc);Hc.className="Constant",ii.serialization.registerClass(Hc);var Xc=function(e){(0,M.Z)(n,e);var t=(0,O.Z)(n);function n(e){var r;return(0,D.Z)(this,n),(r=t.call(this)).DEFAULT_MINVAL=-.05,r.DEFAULT_MAXVAL=.05,r.minval=e.minval||r.DEFAULT_MINVAL,r.maxval=e.maxval||r.DEFAULT_MAXVAL,r.seed=e.seed,r}return(0,F.Z)(n,[{key:"apply",value:function(e,t){return(0,ii.randomUniform)(e,this.minval,this.maxval,t,this.seed)}},{key:"getConfig",value:function(){return{minval:this.minval,maxval:this.maxval,seed:this.seed}}}]),n}(Vc);Xc.className="RandomUniform",ii.serialization.registerClass(Xc);var Kc=function(e){(0,M.Z)(n,e);var t=(0,O.Z)(n);function n(e){var r;return(0,D.Z)(this,n),(r=t.call(this)).DEFAULT_MEAN=0,r.DEFAULT_STDDEV=.05,r.mean=e.mean||r.DEFAULT_MEAN,r.stddev=e.stddev||r.DEFAULT_STDDEV,r.seed=e.seed,r}return(0,F.Z)(n,[{key:"apply",value:function(e,t){if("float32"!==(t=t||"float32")&&"int32"!==t)throw new Ds("randomNormal does not support dType ".concat(t,"."));return Mc(e,this.mean,this.stddev,t,this.seed)}},{key:"getConfig",value:function(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}]),n}(Vc);Kc.className="RandomNormal",ii.serialization.registerClass(Kc);var Yc=function(e){(0,M.Z)(n,e);var t=(0,O.Z)(n);function n(e){var r;return(0,D.Z)(this,n),(r=t.call(this)).DEFAULT_MEAN=0,r.DEFAULT_STDDEV=.05,r.mean=e.mean||r.DEFAULT_MEAN,r.stddev=e.stddev||r.DEFAULT_STDDEV,r.seed=e.seed,r}return(0,F.Z)(n,[{key:"apply",value:function(e,t){if("float32"!==(t=t||"float32")&&"int32"!==t)throw new Ds("truncatedNormal does not support dType ".concat(t,"."));return(0,ii.truncatedNormal)(e,this.mean,this.stddev,t,this.seed)}},{key:"getConfig",value:function(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}]),n}(Vc);Yc.className="TruncatedNormal",ii.serialization.registerClass(Yc);var $c=function(e){(0,M.Z)(n,e);var t=(0,O.Z)(n);function n(e){var r;return(0,D.Z)(this,n),(r=t.call(this)).gain=null!=e.gain?e.gain:1,r}return(0,F.Z)(n,[{key:"apply",value:function(e,t){var n=this;return(0,ii.tidy)((function(){if(2!==e.length||e[0]!==e[1])throw new Is("Identity matrix initializer can only be used for 2D square matrices.");return(0,ii.mul)(n.gain,(0,ii.eye)(e[0]))}))}},{key:"getConfig",value:function(){return{gain:this.gain}}}]),n}(Vc);$c.className="Identity",ii.serialization.registerClass($c);var Qc=function(e){(0,M.Z)(n,e);var t=(0,O.Z)(n);function n(e){var r,a;if((0,D.Z)(this,n),r=t.call(this),e.scale<0)throw new Is("scale must be a positive float. Got: ".concat(e.scale));return r.scale=null==e.scale?1:e.scale,r.mode=null==e.mode?"fanIn":e.mode,a=r.mode,Xs(Uc,"FanMode",a),r.distribution=null==e.distribution?"normal":e.distribution,function(e){Xs(Wc,"Distribution",e)}(r.distribution),r.seed=e.seed,r}return(0,F.Z)(n,[{key:"apply",value:function(e,t){var n=function(e){var t,n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"channelsLast";if(cc(r),2===e.length)t=e[0],n=e[1];else if(-1!==[3,4,5].indexOf(e.length)){if("channelsFirst"===r){var a=bc(e,2);t=e[1]*a,n=e[0]*a}else if("channelsLast"===r){var i=bc(e,0,e.length-2);t=e[e.length-2]*i,n=e[e.length-1]*i}}else{var o=bc(e);t=Math.sqrt(o),n=Math.sqrt(o)}return[t,n]}(e),r=n[0],a=n[1],i=this.scale;if("fanIn"===this.mode?i/=Math.max(1,r):"fanOut"===this.mode?i/=Math.max(1,a):i/=Math.max(1,(r+a)/2),"normal"===this.distribution){var o=Math.sqrt(i);if("float32"!==(t=t||"float32")&&"int32"!==t)throw new Ds("".concat(this.getClassName()," does not support dType ").concat(t,"."));return(0,ii.truncatedNormal)(e,0,o,t,this.seed)}var u=Math.sqrt(3*i);return(0,ii.randomUniform)(e,-u,u,t,this.seed)}},{key:"getConfig",value:function(){return{scale:this.scale,mode:this.mode,distribution:this.distribution,seed:this.seed}}}]),n}(Vc);Qc.className="VarianceScaling",ii.serialization.registerClass(Qc);var Jc=function(e){(0,M.Z)(n,e);var t=(0,O.Z)(n);function n(e){return(0,D.Z)(this,n),t.call(this,{scale:1,mode:"fanAvg",distribution:"uniform",seed:null==e?null:e.seed})}return(0,F.Z)(n,[{key:"getClassName",value:function(){return Qc.className}}]),n}(Qc);Jc.className="GlorotUniform",ii.serialization.registerClass(Jc);var el=function(e){(0,M.Z)(n,e);var t=(0,O.Z)(n);function n(e){return(0,D.Z)(this,n),t.call(this,{scale:1,mode:"fanAvg",distribution:"normal",seed:null==e?null:e.seed})}return(0,F.Z)(n,[{key:"getClassName",value:function(){return Qc.className}}]),n}(Qc);el.className="GlorotNormal",ii.serialization.registerClass(el);var tl=function(e){(0,M.Z)(n,e);var t=(0,O.Z)(n);function n(e){return(0,D.Z)(this,n),t.call(this,{scale:2,mode:"fanIn",distribution:"normal",seed:null==e?null:e.seed})}return(0,F.Z)(n,[{key:"getClassName",value:function(){return Qc.className}}]),n}(Qc);tl.className="HeNormal",ii.serialization.registerClass(tl);var nl=function(e){(0,M.Z)(n,e);var t=(0,O.Z)(n);function n(e){return(0,D.Z)(this,n),t.call(this,{scale:2,mode:"fanIn",distribution:"uniform",seed:null==e?null:e.seed})}return(0,F.Z)(n,[{key:"getClassName",value:function(){return Qc.className}}]),n}(Qc);nl.className="HeUniform",ii.serialization.registerClass(nl);var rl=function(e){(0,M.Z)(n,e);var t=(0,O.Z)(n);function n(e){return(0,D.Z)(this,n),t.call(this,{scale:1,mode:"fanIn",distribution:"normal",seed:null==e?null:e.seed})}return(0,F.Z)(n,[{key:"getClassName",value:function(){return Qc.className}}]),n}(Qc);rl.className="LeCunNormal",ii.serialization.registerClass(rl);var al=function(e){(0,M.Z)(n,e);var t=(0,O.Z)(n);function n(e){return(0,D.Z)(this,n),t.call(this,{scale:1,mode:"fanIn",distribution:"uniform",seed:null==e?null:e.seed})}return(0,F.Z)(n,[{key:"getClassName",value:function(){return Qc.className}}]),n}(Qc);al.className="LeCunUniform",ii.serialization.registerClass(al);var il=function(e){(0,M.Z)(n,e);var t=(0,O.Z)(n);function n(e){var r;return(0,D.Z)(this,n),(r=t.call(this)).DEFAULT_GAIN=1,r.ELEMENTS_WARN_SLOW=2e3,r.gain=null==e.gain?r.DEFAULT_GAIN:e.gain,r.seed=e.seed,r}return(0,F.Z)(n,[{key:"apply",value:function(e,t){var n=this;return(0,ii.tidy)((function(){if(e.length<2)throw new Ds("Shape must be at least 2D.");if("int32"!==t&&"float32"!==t&&void 0!==t)throw new TypeError("Unsupported data type ".concat(t,"."));var r=ii.util.sizeFromShape(e.slice(0,-1)),a=e[e.length-1],i=r*a;i>n.ELEMENTS_WARN_SLOW&&console.warn("Orthogonal initializer is being called on a matrix with more "+"than ".concat(n.ELEMENTS_WARN_SLOW," (").concat(i,") elements: ")+"Slowness may result.");var o=Mc([Math.max(a,r),Math.min(a,r)],0,1,t,n.seed),u=ii.linalg.qr(o,!1),s=u[0],c=u[1].flatten().stridedSlice([0],[Math.min(a,r)*Math.min(a,r)],[Math.min(a,r)+1]);return s=(0,ii.mul)(s,c.sign()),r<a&&(s=s.transpose()),(0,ii.mul)((0,ii.scalar)(n.gain),s.reshape(e))}))}},{key:"getConfig",value:function(){return{gain:this.gain,seed:this.seed}}}]),n}(Vc);il.className="Orthogonal",ii.serialization.registerClass(il);var ol={constant:"Constant",glorotNormal:"GlorotNormal",glorotUniform:"GlorotUniform",heNormal:"HeNormal",heUniform:"HeUniform",identity:"Identity",leCunNormal:"LeCunNormal",leCunUniform:"LeCunUniform",ones:"Ones",orthogonal:"Orthogonal",randomNormal:"RandomNormal",randomUniform:"RandomUniform",truncatedNormal:"TruncatedNormal",varianceScaling:"VarianceScaling",zeros:"Zeros"};function ul(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Vs(e,ii.serialization.SerializationMap.getMap().classNameMap,t,"initializer")}function sl(e){return Us(e)}function cl(e){if("string"===typeof e){var t=e in ol?ol[e]:e;if("GlorotNormal"===t)return new el;if("GlorotUniform"===t)return new Jc;if("HeNormal"===t)return new tl;if("HeUniform"===t)return new nl;if("LeCunNormal"===t)return new rl;if("LeCunUniform"===t)return new al;var n={};return n.className=t,n.config={},ul(n)}return e instanceof Vc?e:ul(e)}function ll(e){return Array.isArray(e)&&Array.isArray(e[0])}function fl(e){return 0===e.length?[]:Array.isArray(e[0])?e:[e]}function dl(e){var t;if(Array.isArray(e)){if(1!==e.length)throw new Is("Expected Tensor length to be 1; got ".concat(e.length));t=e[0]}else t=e;return t}function hl(e){if(Array.isArray(e)&&Array.isArray(e[0])){if(1===e.length)return e[0];throw new Is("Expected exactly 1 Shape; got ".concat(e.length))}return e}function pl(e){var t,n=0,r=(0,B.Z)(e);try{for(r.s();!(t=r.n()).done;){var a=t.value;0===a.shape.length?n+=1:n+=a.shape.reduce((function(e,t){return e*t}))}}catch(i){r.e(i)}finally{r.f()}return n}var vl="Variable",ml=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"float32",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:vl,a=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;(0,D.Z)(this,e),this.dtype=null==n?"float32":n,this.shape=t.shape,this.id=ec(),r=null==r?vl:r,this.originalName=pc(r),this.name=vc(this.originalName),this.trainable_=a,this.constraint=i,this.val=ii.variable(t,this.trainable_,this.name,this.dtype)}return(0,F.Z)(e,[{key:"read",value:function(){return this.assertNotDisposed(),this.val}},{key:"write",value:function(e){return this.assertNotDisposed(),function(e,t){if(e.shape.toString()!==t.shape.toString())throw new Error("Shape mismatch: "+JSON.stringify(e.shape)+" vs. "+JSON.stringify(t.shape))}(this.val,e),this.val.id!==e.id&&(this.val.assign(e),null!=this.constraint&&this.val.assign(this.constraint.apply(this.val))),this}},{key:"dispose",value:function(){this.assertNotDisposed(),this.val.dispose()}},{key:"assertNotDisposed",value:function(){if(this.val.isDisposed)throw new Error("LayersVariable ".concat(this.name," is already disposed."))}},{key:"trainable",get:function(){return this.trainable_},set:function(e){this.trainable_=e,this.val.trainable=e}}]),e}();function gl(e){return e.map((function(e){return e.read()}))}function yl(e){e.forEach((function(e){e[0].write(e[1])}))}var bl=(0,F.Z)((function e(t){(0,D.Z)(this,e),this.dtype=t.dtype,this.shape=t.shape,null!=t.shape?this.ndim=t.shape.length:this.ndim=t.ndim,this.maxNDim=t.maxNDim,this.minNDim=t.minNDim,this.axes=t.axes||{}})),xl=(0,F.Z)((function e(t,n,r,a,i,o,u){(0,D.Z)(this,e),this.dtype=t,this.shape=n,this.sourceLayer=r,this.inputs=a,this.callArgs=i,this.outputTensorIndex=u,this.id=ec(),null!=o&&(this.originalName=pc(o),this.name=vc(this.originalName)),this.rank=n.length})),wl=0,kl=function(){function e(t,n){(0,D.Z)(this,e),this.callArgs=n,this.id=wl++,this.outboundLayer=t.outboundLayer,this.inboundLayers=t.inboundLayers,this.nodeIndices=t.nodeIndices,this.tensorIndices=t.tensorIndices,this.inputTensors=t.inputTensors,this.outputTensors=t.outputTensors,this.inputMasks=t.inputMasks,this.outputMasks=t.outputMasks,this.inputShapes=t.inputShapes,this.outputShapes=t.outputShapes;var r,a=(0,B.Z)(t.inboundLayers);try{for(a.s();!(r=a.n()).done;){var i=r.value;null!=i&&i.outboundNodes.push(this)}}catch(o){a.e(o)}finally{a.f()}t.outboundLayer.inboundNodes.push(this)}return(0,F.Z)(e,[{key:"getConfig",value:function(){var e,t=[],n=(0,B.Z)(this.inboundLayers);try{for(n.s();!(e=n.n()).done;){var r=e.value;null!=r?t.push(r.name):t.push(null)}}catch(a){n.e(a)}finally{n.f()}return{outboundLayer:this.outboundLayer?this.outboundLayer.name:null,inboundLayers:t,nodeIndices:this.nodeIndices,tensorIndices:this.tensorIndices}}}]),e}(),_l=0,Sl=function(e){(0,M.Z)(n,e);var t=(0,O.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,D.Z)(this,n),(e=t.call(this))._callHook=null,e._addedWeightNames=[],e._stateful=!1,e.id=_l++,e.activityRegularizer=null,e.inputSpec=null,e.supportsMasking=!1,e._trainableWeights=[],e._nonTrainableWeights=[],e._losses=[],e._updates=[],e._built=!1,e.inboundNodes=[],e.outboundNodes=[];var a=r.name;if(!a){var i=e.getClassName();a=Zs(i)+"_"+nc(i)}if(e.name=a,e.trainable_=null==r.trainable||r.trainable,null!=r.inputShape||null!=r.batchInputShape){var o;if(null!=r.batchInputShape)o=r.batchInputShape;else if(null!=r.inputShape){var u=null;null!=r.batchSize&&(u=r.batchSize),o=[u].concat(r.inputShape)}e.batchInputShape=o;var s=r.dtype;null==s&&(s=r.inputDType),null==s&&(s="float32"),e.dtype=s}return null!=r.weights?e.initialWeights=r.weights:e.initialWeights=null,e._refCount=null,e.fastWeightInitDuringBuild=!1,e}return(0,F.Z)(n,[{key:"getNodeAtIndex",value:function(e,t){if(0===this.inboundNodes.length)throw new Ts("The layer has never been called "+"and thus has no defined ".concat(t,"."));if(this.inboundNodes.length<=e)throw new Is("Asked to get ".concat(t," at node ").concat(e,", ")+"but the layer has only ".concat(this.inboundNodes.length," inbound nodes."));return this.inboundNodes[e]}},{key:"getInputAt",value:function(e){return Bs(this.getNodeAtIndex(e,"input").inputTensors)}},{key:"getOutputAt",value:function(e){return Bs(this.getNodeAtIndex(e,"output").outputTensors)}},{key:"input",get:function(){if(this.inboundNodes.length>1)throw new Ns("Layer ".concat(this.name)+' has multiple inbound nodes, hence the notion of "layer input" is ill-defined. Use `getInputAt(nodeIndex)` instead.');if(0===this.inboundNodes.length)throw new Ns("Layer ".concat(this.name)+" is not connected, no input to return.");return Bs(this.getNodeAtIndex(0,"input").inputTensors)}},{key:"output",get:function(){if(0===this.inboundNodes.length)throw new Ns("Layer ".concat(this.name)+" has no inbound nodes.");if(this.inboundNodes.length>1)throw new Ns("Layer ".concat(this.name)+' has multiple inbound nodes, hence the notion of "layer output" is ill-defined. Use `getOutputAt(nodeIndex)` instead.');return Bs(this.getNodeAtIndex(0,"output").outputTensors)}},{key:"losses",get:function(){return this._losses}},{key:"calculateLosses",value:function(){return this.losses.map((function(e){return e()}))}},{key:"updates",get:function(){return this._updates}},{key:"built",get:function(){return this._built},set:function(e){this._built=e}},{key:"trainable",get:function(){return this.trainable_},set:function(e){this._trainableWeights.forEach((function(t){return t.trainable=e})),this.trainable_=e}},{key:"trainableWeights",get:function(){return this.trainable_?this._trainableWeights.filter((function(e){return e.trainable})):[]},set:function(e){this._trainableWeights=e}},{key:"nonTrainableWeights",get:function(){return this.trainable?this._trainableWeights.filter((function(e){return!e.trainable})).concat(this._nonTrainableWeights):this._trainableWeights.concat(this._nonTrainableWeights)},set:function(e){this._nonTrainableWeights=e}},{key:"weights",get:function(){return this.trainableWeights.concat(this.nonTrainableWeights)}},{key:"stateful",get:function(){return this._stateful}},{key:"resetStates",value:function(){if(!this.stateful)throw new Error("Cannot call the resetStates() method of a non-stateful Layer object.")}},{key:"assertInputCompatibility",value:function(e){var t=zs(e);if(null!=this.inputSpec&&0!==this.inputSpec.length){var n=zs(this.inputSpec);if(t.length!==n.length)throw new Is("Layer ".concat(this.name," expects ").concat(n.length," inputs, ")+"but it received ".concat(t.length," input tensors. ")+"Input received: ".concat(e));for(var r=0;r<t.length;r++){var a=t[r],i=n[r];if(null!=i){var o=a.rank;if(null!=i.ndim&&o!==i.ndim)throw new Is("Input ".concat(r," is incompatible with layer ").concat(this.name,": ")+"expected ndim=".concat(i.ndim,", found ndim=").concat(o));if(null!=i.maxNDim&&o>i.maxNDim)throw new Is("Input ".concat(r," is incompatible with layer ").concat(this.name)+": expected max_ndim=".concat(i.maxNDim,", found ndim=").concat(o));if(null!=i.minNDim&&o<i.minNDim)throw new Is("Input ".concat(r," is incompatible with layer ").concat(this.name)+": expected min_ndim=".concat(i.minNDim,", found ndim=").concat(o,"."));if(null!=i.dtype&&a.dtype!==i.dtype)throw new Is("Input ".concat(r," is incompatible with layer ").concat(this.name," ")+": expected dtype=".concat(i.dtype,", found dtype=").concat(a.dtype,"."));if(i.axes){var u=a.shape;for(var s in i.axes){var c=Number(s),l=i.axes[s],f=c>=0?u[c]:u[u.length+c];if(null!=l&&-1===[l,null].indexOf(f))throw new Is("Input ".concat(r," is incompatible with layer ")+"".concat(this.name,": expected axis ").concat(c," of input shape to ")+"have value ".concat(l," but got shape ").concat(u,"."))}}if(null!=i.shape)for(var d=0;d<i.shape.length;++d){var h=i.shape[d],p=a.shape[d];if(null!=h&&null!=p&&h!==p)throw new Is("Input ".concat(r," is incompatible with layer ")+"".concat(this.name,": expected shape=").concat(i.shape,", ")+"found shape=".concat(a.shape,"."))}}}}}},{key:"call",value:function(e,t){return e}},{key:"invokeCallHook",value:function(e,t){null!=this._callHook&&this._callHook(e,t)}},{key:"setCallHook",value:function(e){this._callHook=e}},{key:"clearCallHook",value:function(){this._callHook=null}},{key:"apply",value:function(e,t){var n=this;t=t||{},this.assertNotDisposed();var r=zs(e),a=function(e){var t,n=!0,r=(0,B.Z)(zs(e));try{for(r.s();!(t=r.n()).done;){if(!(t.value instanceof xl)){n=!1;break}}}catch(a){r.e(a)}finally{r.f()}return n}(e),i=function(e){var t,n=!0,r=(0,B.Z)(zs(e));try{for(r.s();!(t=r.n()).done;){if(t.value instanceof xl){n=!1;break}}}catch(a){r.e(a)}finally{r.f()}return n}(e);if(a===i)throw new Is("Arguments to apply() must be all SymbolicTensors or all Tensors");return hc(this.name,(function(){if(!n.built){n.assertInputCompatibility(e);var a,o=[],u=(0,B.Z)(zs(e));try{for(u.s();!(a=u.n()).done;){var s=a.value;o.push(s.shape)}}catch(b){u.e(b)}finally{u.f()}n.build(Bs(o)),n.built=!0,n.initialWeights&&n.setWeights(n.initialWeights),null===n._refCount&&i&&(n._refCount=1)}if(n.assertInputCompatibility(e),i){var c=n.call(e,t);n.supportsMasking&&n.setMaskMetadata(e,c);var l,f=zs(c),d=[],h=(0,B.Z)(f);try{for(h.s();!(l=h.n()).done;){var p=l.value;-1!==r.indexOf(p)&&(p=p.clone()),d.push(p)}}catch(b){h.e(b)}finally{h.f()}if(c=Bs(d),null!=n.activityRegularizer)throw new Ds("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return c}var v,m=function(e){e=zs(e);var t,n=[],r=(0,B.Z)(e);try{for(r.s();!(t=r.n()).done;){var a=t.value;n.push(a.shape)}}catch(b){r.e(b)}finally{r.f()}return Bs(n)}(e),g=n.computeOutputShape(m),y="float32";if(n.warnOnIncompatibleInputShape(Array.isArray(e)?m[0]:m),v=null!=g&&g.length>0&&Array.isArray(g[0])?g.map((function(r,a){return new xl(y,r,n,zs(e),t,n.name,a)})):new xl(y,g,n,zs(e),t,n.name),n.addInboundNode(e,v,null,null,m,g,t),n._refCount++,null!=n.activityRegularizer)throw new Ds("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return v}))}},{key:"warnOnIncompatibleInputShape",value:function(e){if(null!=this.batchInputShape)if(e.length!==this.batchInputShape.length)console.warn("The rank of the input tensor provided (shape: "+"".concat(JSON.stringify(e),") does not match that of the ")+"batchInputShape (".concat(JSON.stringify(this.batchInputShape),") ")+"of the layer ".concat(this.name));else{var t=!1;this.batchInputShape.forEach((function(n,r){null!=n&&null!=e[r]&&e[r]!==n&&(t=!0)})),t&&console.warn("The shape of the input tensor "+"(".concat(JSON.stringify(e),") does not ")+"match the expectation of layer ".concat(this.name,": ")+"".concat(JSON.stringify(this.batchInputShape)))}}},{key:"outputShape",get:function(){if(null==this.inboundNodes||0===this.inboundNodes.length)throw new Ns("The layer ".concat(this.name," has never been called and thus has no ")+"defined output shape.");var e,t=[],n=(0,B.Z)(this.inboundNodes);try{for(n.s();!(e=n.n()).done;){var r=e.value,a=JSON.stringify(r.outputShapes);-1===t.indexOf(a)&&t.push(a)}}catch(o){n.e(o)}finally{n.f()}if(1===t.length){var i=this.inboundNodes[0].outputShapes;return Array.isArray(i)&&Array.isArray(i[0])&&1===i.length?i[0]:i}throw new Ns("The layer ".concat(this.name," has multiple inbound nodes with different ")+'output shapes. Hence the notion of "output shape" is ill-defined for the layer.')}},{key:"countParams",value:function(){if(!this.built)throw new Ts("You tried to call countParams() on ".concat(this.name,", ")+"but the layer is not built yet. Build it first by calling build(batchInputShape).");return pl(this.weights)}},{key:"build",value:function(e){this.built=!0}},{key:"getWeights",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return gl(e?this.trainableWeights:this.weights)}},{key:"setWeights",value:function(e){var t=this;(0,ii.tidy)((function(){var n=t.weights;if(n.length!==e.length)throw new Is('You called setWeights(weights) on layer "'.concat(t.name,'" ')+"with a weight list of length ".concat(e.length,", ")+"but the layer was expecting ".concat(n.length," weights. ")+"Provided weights: ".concat(e,"..."));if(0!==n.length){for(var r=[],a=gl(n),i=0;i<a.length;++i){var o=a[i],u=n[i],s=e[i];if(!ii.util.arraysEqual(o.shape,s.shape))throw new Is("Layer weight shape ".concat(o.shape," ")+"not compatible with provided weight shape ".concat(s.shape));r.push([u,s])}yl(r)}}))}},{key:"addWeight",value:function(e,t,n,r,a,i,o,u){if(-1!==this._addedWeightNames.indexOf(e))throw new Is("Duplicate weight name ".concat(e," for layer ").concat(this.name));this._addedWeightNames.push(e),null==n&&(n="float32"),this.fastWeightInitDuringBuild&&(r=null!=u?u():cl("zeros"));var s=r.apply(t,n),c=new ml(s,n,e,i,o);return s.dispose(),null!=a&&this.addLoss((function(){return a.apply(c.read())})),null==i&&(i=!0),i?this._trainableWeights.push(c):this._nonTrainableWeights.push(c),c}},{key:"setFastWeightInitDuringBuild",value:function(e){this.fastWeightInitDuringBuild=e}},{key:"addLoss",value:function(e){var t;null==e||Array.isArray(e)&&0===e.length||(e=zs(e),void 0!==this._losses&&null!==this._losses&&(t=this.losses).push.apply(t,(0,I.Z)(e)))}},{key:"computeOutputShape",value:function(e){return e}},{key:"computeMask",value:function(e,t){var n=this;if(!this.supportsMasking){if(null!=t){if(!Array.isArray(t))throw new TypeError("Layer ".concat(this.name," does not support masking, ")+"but was passed an inputMask.");t.forEach((function(e){if(null!=e)throw new TypeError("Layer ".concat(n.name," does not support masking, ")+"but was passed an inputMask.")}))}return null}return t}},{key:"setMaskMetadata",value:function(e,t,n){if(this.supportsMasking){var r=this.computeMask(e,n),a=zs(t),i=zs(r);if(a.length!==i.length)throw new Error("".concat(this.name," outputs ").concat(a.length," tensors ")+"but ".concat(a.length," masks for those tensors"));for(var o=0;o<a.length;o++)a[o].kerasMask=i[o]}}},{key:"addInboundNode",value:function(e,t,n,r,a,i){var o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,u=zs(e);t=zs(t),n=zs(n),r=zs(r),a=fl(a),i=fl(i);var s,c=[],l=[],f=[],d=(0,B.Z)(u);try{for(d.s();!(s=d.n()).done;){var h=s.value;c.push(h.sourceLayer),l.push(h.nodeIndex),f.push(h.tensorIndex)}}catch(v){d.e(v)}finally{d.f()}new kl({outboundLayer:this,inboundLayers:c,nodeIndices:l,tensorIndices:f,inputTensors:u,outputTensors:t,inputMasks:n,outputMasks:r,inputShapes:a,outputShapes:i},o);for(var p=0;p<t.length;p++)t[p].sourceLayer=this,t[p].nodeIndex=this.inboundNodes.length-1,t[p].tensorIndex=p}},{key:"getConfig",value:function(){var e={name:this.name,trainable:this.trainable};return null!=this.batchInputShape&&(e.batchInputShape=this.batchInputShape),null!=this.dtype&&(e.dtype=this.dtype),e}},{key:"disposeWeights",value:function(){return this.weights.forEach((function(e){return e.dispose()})),this.weights.length}},{key:"assertNotDisposed",value:function(){if(0===this._refCount)throw new Error("Layer '".concat(this.name,"' is already disposed."))}},{key:"dispose",value:function(){if(!this.built)throw new Error("Cannot dispose Layer ".concat(this.name," because it has not been ")+"built yet.");if(null===this._refCount)throw new Error("Cannot dispose Layer ".concat(this.name," because it has not been used ")+"yet.");this.assertNotDisposed();var e=0;return 0===--this._refCount&&(e=this.disposeWeights()),{refCountAfterDispose:this._refCount,numDisposedVariables:e}}}],[{key:"nodeKey",value:function(e,t){return e.name+"_ib-"+t.toString()}}]),n}(ii.serialization.Serializable);function Cl(e,t,n){if((null==t||null!=n&&n>0)&&(t=e.sourceLayer,n=e.nodeIndex),0===t.inboundNodes.length)return[e];var r=t.inboundNodes[n];if(0===r.inboundLayers.length)return r.inputTensors;for(var a=[],i=0;i<r.inboundLayers.length;i++){var o,u=Cl(r.inputTensors[i],r.inboundLayers[i],r.nodeIndices[i]),s=(0,B.Z)(u);try{for(s.s();!(o=s.n()).done;){var c=o.value;-1===a.indexOf(c)&&a.push(c)}}catch(l){s.e(l)}finally{s.f()}}return a}var Al=function(e){(0,M.Z)(n,e);var t=(0,O.Z)(n);function n(e){var r;if((0,D.Z)(this,n),r=t.call(this,{dtype:e.dtype,name:null!=e.name?e.name:nc("input").toString()}),null==e.batchSize&&(e.batchSize=null),null==e.sparse&&(e.sparse=!1),r.trainable=!1,r.built=!0,r.sparse=e.sparse,null!=e.inputShape&&null!=e.batchInputShape)throw new Is("Only provide the inputShape OR batchInputShape argument to inputLayer, not both at the same time.");var a=e.batchInputShape;if(null==a){if(null==e.inputShape)throw new Is("An InputLayer should be passed either a `batchInputShape` or an `inputShape`.");a=[e.batchSize].concat(e.inputShape)}else if(null!=e.batchSize)throw new Is("Cannot specify batchSize if batchInputShape is specified when creating an InputLayer.");var i=e.dtype||"float32";r.batchInputShape=a,r.dtype=i,r.inputSpec=[{shape:a}];var o=new xl(r.dtype,r.batchInputShape,(0,Es.Z)(r),[],{},r.name);return o.nodeIndex=0,o.tensorIndex=0,new kl({outboundLayer:(0,Es.Z)(r),inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:[o],outputTensors:[o],inputMasks:[null],outputMasks:[null],inputShapes:[a],outputShapes:[a]}),r}return(0,F.Z)(n,[{key:"apply",value:function(e,t){throw new Is("Cannot pass any input to an "+"InputLayer's apply() method. InputLayer name: ".concat(this.name))}},{key:"dispose",value:function(){return{refCountAfterDispose:this._refCount,numDisposedVariables:0}}},{key:"getConfig",value:function(){return{batchInputShape:this.batchInputShape,dtype:this.dtype,sparse:this.sparse,name:this.name}}}]),n}(Sl);function El(e){if(null==e.batchShape&&null==e.shape)throw new Error("Please provide to Input either a `shape` or a `batchShape` argument. Note that `shape` does not include the batch dimension.");if(null!=e.batchShape&&null!=e.shape)throw new Is("Please provide either a `shape` or `batchShape` argument to Input, but not both.");var t=e.batchShape;null!=e.shape&&null==t&&(t=[null].concat(e.shape));var n=e.dtype;return null==n&&(n="float32"),new Al({batchInputShape:t,name:e.name,dtype:n,sparse:e.sparse}).inboundNodes[0].outputTensors[0]}Al.className="InputLayer",ii.serialization.registerClass(Al);var Nl=function(){function e(t){if((0,D.Z)(this,e),this.id2Value={},this.id2Mask={},this.name2Id={},t instanceof e)for(var n in t.id2Value)this.id2Value[n]=t.id2Value[n],n in t.id2Mask&&(this.id2Mask[n]=t.id2Mask[n]);else{if(null==t)return;var r,a=(0,B.Z)(t);try{for(a.s();!(r=a.n()).done;){var i=r.value;this.add(i.key,i.value)}}catch(o){a.e(o)}finally{a.f()}}}return(0,F.Z)(e,[{key:"add",value:function(e,t,n){if(null!=this.id2Value[e.id])throw new Is("Duplicate key: name=".concat(e.name,", id=").concat(e.id));return this.id2Value[e.id]=function(e,t){if(null==e.dtype||e.dtype===t.dtype)return t;try{return(0,ii.cast)(t,e.dtype)}catch(n){throw new Is("The dtype of the feed (".concat(t.dtype,") can not be cast to the dtype ")+"of the key '".concat(e.name,"' (").concat(e.dtype,")."))}}(e,t),this.name2Id[e.name]=e.id,null!=n&&(this.id2Mask[e.id]=n),this}},{key:"addFeed",value:function(e){this.add(e.key,e.value)}},{key:"hasKey",value:function(e){return null!=this.id2Value[e.id]}},{key:"names",value:function(){return Object.keys(this.name2Id)}},{key:"getValue",value:function(e){if(e instanceof xl){if(null==this.id2Value[e.id])throw new Is("Nonexistent key: ".concat(e.name));return this.id2Value[e.id]}var t=this.name2Id[e];if(null==t)throw new Is("Feed dict has no SymbolicTensor name: ".concat(e));return this.id2Value[t]}},{key:"getMask",value:function(e){if(e instanceof xl){if(null==this.id2Value[e.id])throw new Is("Nonexistent key: ".concat(e.name));return this.id2Mask[e.id]}var t=this.name2Id[e];if(null==t)throw new Is("Feed dict has no SymbolicTensor name: ".concat(e));return this.id2Mask[t]}},{key:"disposeMasks",value:function(){null!=this.id2Mask&&(0,ii.dispose)(this.id2Mask)}}]),e}(),Tl=new Ms,Il=new Ms;function Dl(e,t,n,r){var a,i=null!=n&&n.training,o=Array.isArray(e),u=o?e:[e],s=u.map((function(e){return e.name})),c=[],l=t.names(),f=(0,B.Z)(s);try{for(f.s();!(a=f.n()).done;){var d=a.value;-1!==l.indexOf(d)?c.push(t.getValue(d)):c.push(null)}}catch(z){f.e(z)}finally{f.f()}null!=r&&(r.maxNumTensors=-1/0,r.minNumTensors=1/0);var h,p=s.join(",")+"|"+t.names().sort().join(","),v=Tl.get(p);if(null==v){var m=function(e,t){ii.util.assert(null!=e&&e.length>0,(function(){return"Expected at least one fetch, got none"}));var n=[],r={};if(1===e.length){var a=Ml(e[0],t);n=a.sorted,r=a.recipientMap}else{var i,o=new Set,u=(0,B.Z)(e);try{for(u.s();!(i=u.n()).done;){var s,c=Ml(i.value,t),l=c.sorted,f=c.recipientMap,d=(0,B.Z)(l);try{for(d.s();!(s=d.n()).done;){var h=s.value;o.has(h.name)||(n.push(h),o.add(h.name))}}catch(z){d.e(z)}finally{d.f()}var p=function(e){null==r[e]&&(r[e]=new Set),f[e].forEach((function(t){return r[e].add(t)}))};for(var v in f)p(v)}}catch(z){u.e(z)}finally{u.f()}}return{sorted:n,recipientCounts:Fl(r)}}(u,t);v=m.sorted,h=m.recipientCounts,Tl.put(p,v),Il.put(p,h)}h={},i||Object.assign(h,Il.get(p));for(var g=new Nl(t),y=0;y<v.length;++y){if(null!=r){var b=(0,ii.memory)().numTensors;b>r.maxNumTensors&&(r.maxNumTensors=b),b<r.minNumTensors&&(r.minNumTensors=b)}var x=v[y],w=x.sourceLayer;if(!(w instanceof Al)){var k,_=[],S=[],C=[],A=!1,E=(0,B.Z)(x.inputs);try{for(E.s();!(k=E.n()).done;){var N=k.value,T=g.getValue(N),I=g.getMask(N);_.push(T),S.push(I),null!=I&&(A=!0),i||(h[N.name]--,0!==h[N.name]||t.hasKey(N)||-1!==s.indexOf(N.name)||T.isDisposed||!0===N.sourceLayer.stateful||C.push(T))}}catch(z){E.e(z)}finally{E.f()}A&&((n=n||{}).mask=S[0]);var D=zs(w.apply(_,n)),F=null;w.supportsMasking&&(F=w.computeMask(_,S));for(var M=Ol(x),O=Array.isArray(M)?M:[M],R=0;R<O.length;++R){g.hasKey(O[R])||g.add(O[R],D[R],Array.isArray(F)?F[0]:F);var j=s.indexOf(O[R].name);-1!==j&&(c[j]=D[R])}i||(0,ii.dispose)(C)}}return g.disposeMasks(),o?c:c[0]}function Fl(e){var t={};for(var n in e)t[n]=e[n].size;return t}function Ml(e,t){var n,r=new Set,a=[],i={},o=(0,B.Z)(t.names());try{for(o.s();!(n=o.n()).done;){var u=n.value;r.add(u)}}catch(v){o.e(v)}finally{o.f()}var s=[],c=[];for(s.push(e);s.length>0;){var l=s[s.length-1];if(r.has(l.name))s.pop();else{var f=c[c.length-1]===s.length-1;if(0===l.inputs.length||f)s.pop(),a.push(l),r.add(l.name),f&&c.pop();else{c.push(s.length-1);var d,h=(0,B.Z)(l.inputs);try{for(h.s();!(d=h.n()).done;){var p=d.value;null==i[p.name]&&(i[p.name]=new Set),i[p.name].add(l.name),r.has(p.name)||s.push(p)}}catch(v){h.e(v)}finally{h.f()}}}}return{sorted:a,recipientMap:i}}function Ol(e){var t;if(1===e.sourceLayer.inboundNodes.length)t=e.sourceLayer.output;else{for(var n=null,r=0;r<e.sourceLayer.inboundNodes.length;++r){var a,i=(0,B.Z)(e.sourceLayer.inboundNodes[r].outputTensors);try{for(i.s();!(a=i.n()).done;){if(a.value.id===e.id){n=r;break}}}catch(o){i.e(o)}finally{i.f()}}t=e.sourceLayer.getOutputAt(n)}return t}function Rl(e,t){return(0,ii.tidy)((function(){return ii.sqrt(ii.sum(ii.mul(e,e),t,!0))}))}(0,ii.env)().registerFlag("TOPOLOGICAL_SORT_CACHE_MAX_ENTRIES",(function(){return 100}),(function(e){null!=Tl&&Tl.setMaxEntries(e),null!=Il&&Il.setMaxEntries(e)}));var jl=function(e){(0,M.Z)(n,e);var t=(0,O.Z)(n);function n(){return(0,D.Z)(this,n),t.apply(this,arguments)}return(0,F.Z)(n,[{key:"getConfig",value:function(){return{}}}]),n}(ii.serialization.Serializable),Bl=function(e){(0,M.Z)(n,e);var t=(0,O.Z)(n);function n(e){var r;return(0,D.Z)(this,n),(r=t.call(this)).defaultMaxValue=2,r.defaultAxis=0,r.maxValue=null!=e.maxValue?e.maxValue:r.defaultMaxValue,r.axis=null!=e.axis?e.axis:r.defaultAxis,r}return(0,F.Z)(n,[{key:"apply",value:function(e){var t=this;return(0,ii.tidy)((function(){var n=Rl(e,t.axis),r=ii.clipByValue(n,0,t.maxValue);return ii.mul(e,ii.div(r,ii.add(_c(),n)))}))}},{key:"getConfig",value:function(){return{maxValue:this.maxValue,axis:this.axis}}}]),n}(jl);Bl.className="MaxNorm",ii.serialization.registerClass(Bl);var zl=function(e){(0,M.Z)(n,e);var t=(0,O.Z)(n);function n(e){var r;return(0,D.Z)(this,n),(r=t.call(this)).defaultAxis=0,r.axis=null!=e.axis?e.axis:r.defaultAxis,r}return(0,F.Z)(n,[{key:"apply",value:function(e){var t=this;return(0,ii.tidy)((function(){return ii.div(e,ii.add(_c(),Rl(e,t.axis)))}))}},{key:"getConfig",value:function(){return{axis:this.axis}}}]),n}(jl);zl.className="UnitNorm",ii.serialization.registerClass(zl);var Zl=function(e){(0,M.Z)(n,e);var t=(0,O.Z)(n);function n(){return(0,D.Z)(this,n),t.apply(this,arguments)}return(0,F.Z)(n,[{key:"apply",value:function(e){return ii.relu(e)}}]),n}(jl);Zl.className="NonNeg",ii.serialization.registerClass(Zl);var Ll=function(e){(0,M.Z)(n,e);var t=(0,O.Z)(n);function n(e){var r;return(0,D.Z)(this,n),(r=t.call(this)).defaultMinValue=0,r.defaultMaxValue=1,r.defaultRate=1,r.defaultAxis=0,r.minValue=null!=e.minValue?e.minValue:r.defaultMinValue,r.maxValue=null!=e.maxValue?e.maxValue:r.defaultMaxValue,r.rate=null!=e.rate?e.rate:r.defaultRate,r.axis=null!=e.axis?e.axis:r.defaultAxis,r}return(0,F.Z)(n,[{key:"apply",value:function(e){var t=this;return(0,ii.tidy)((function(){var n=Rl(e,t.axis),r=ii.add(ii.mul(t.rate,ii.clipByValue(n,t.minValue,t.maxValue)),ii.mul(1-t.rate,n));return ii.mul(e,ii.div(r,ii.add(_c(),n)))}))}},{key:"getConfig",value:function(){return{minValue:this.minValue,maxValue:this.maxValue,rate:this.rate,axis:this.axis}}}]),n}(jl);Ll.className="MinMaxNorm",ii.serialization.registerClass(Ll);var Pl,Ul={maxNorm:"MaxNorm",minMaxNorm:"MinMaxNorm",nonNeg:"NonNeg",unitNorm:"UnitNorm"};function Wl(e){return Us(e)}function Vl(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Vs(e,ii.serialization.SerializationMap.getMap().classNameMap,t,"constraint")}function ql(e){return null==e?null:"string"===typeof e?Vl({className:e in Ul?Ul[e]:e,config:{}}):e instanceof jl?e:Vl(e)}function Gl(e){return Hl.apply(this,arguments)}function Hl(){return Hl=(0,Da.Z)(E().mark((function e(t){var n,r,a,i,o,u,s,c;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=t){e.next=2;break}return e.abrupt("return");case 2:for(i in n=[],r=[],a=[],t)"number"!==typeof(o=t[i])&&(u=o,n.push(u.data()),r.push(i),a.push(u));if(!(n.length>0)){e.next=12;break}return e.next=9,Promise.all(n);case 9:for(s=e.sent,c=0;c<s.length;++c)t[r[c]]=s[c][0];(0,ii.dispose)(a);case 12:case"end":return e.stop()}}),e)}))),Hl.apply(this,arguments)}function Xl(e){if(null!=e)for(var t in e){var n=e[t];"number"!==typeof n&&n.dispose()}}!function(e){e[e.SILENT=0]="SILENT",e[e.VERBOSE=1]="VERBOSE"}(Pl||(Pl={}));var Kl=function(){function e(){(0,D.Z)(this,e),this.validationData=null}return(0,F.Z)(e,[{key:"setParams",value:function(e){this.params=e}},{key:"onEpochBegin",value:function(){var e=(0,Da.Z)(E().mark((function e(t,n){return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"onEpochEnd",value:function(){var e=(0,Da.Z)(E().mark((function e(t,n){return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"onBatchBegin",value:function(){var e=(0,Da.Z)(E().mark((function e(t,n){return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"onBatchEnd",value:function(){var e=(0,Da.Z)(E().mark((function e(t,n){return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"onTrainBegin",value:function(){var e=(0,Da.Z)(E().mark((function e(t){return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"onTrainEnd",value:function(){var e=(0,Da.Z)(E().mark((function e(t){return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"setModel",value:function(e){}}]),e}(),Yl=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;(0,D.Z)(this,e),null==t&&(t=[]),this.callbacks=t,this.queueLength=n}return(0,F.Z)(e,[{key:"append",value:function(e){this.callbacks.push(e)}},{key:"setParams",value:function(e){var t,n=(0,B.Z)(this.callbacks);try{for(n.s();!(t=n.n()).done;){t.value.setParams(e)}}catch(r){n.e(r)}finally{n.f()}}},{key:"setModel",value:function(e){var t,n=(0,B.Z)(this.callbacks);try{for(n.s();!(t=n.n()).done;){t.value.setModel(e)}}catch(r){n.e(r)}finally{n.f()}}},{key:"onEpochBegin",value:function(){var e=(0,Da.Z)(E().mark((function e(t,n){var r,a,i;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:null==n&&(n={}),r=(0,B.Z)(this.callbacks),e.prev=2,r.s();case 4:if((a=r.n()).done){e.next=10;break}return i=a.value,e.next=8,i.onEpochBegin(t,n);case 8:e.next=4;break;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(2),r.e(e.t0);case 15:return e.prev=15,r.f(),e.finish(15);case 18:case"end":return e.stop()}}),e,this,[[2,12,15,18]])})));return function(t,n){return e.apply(this,arguments)}}()},{key:"onEpochEnd",value:function(){var e=(0,Da.Z)(E().mark((function e(t,n){var r,a,i;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:null==n&&(n={}),r=(0,B.Z)(this.callbacks),e.prev=2,r.s();case 4:if((a=r.n()).done){e.next=10;break}return i=a.value,e.next=8,i.onEpochEnd(t,n);case 8:e.next=4;break;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(2),r.e(e.t0);case 15:return e.prev=15,r.f(),e.finish(15);case 18:case"end":return e.stop()}}),e,this,[[2,12,15,18]])})));return function(t,n){return e.apply(this,arguments)}}()},{key:"onBatchBegin",value:function(){var e=(0,Da.Z)(E().mark((function e(t,n){var r,a,i;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:null==n&&(n={}),r=(0,B.Z)(this.callbacks),e.prev=2,r.s();case 4:if((a=r.n()).done){e.next=10;break}return i=a.value,e.next=8,i.onBatchBegin(t,n);case 8:e.next=4;break;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(2),r.e(e.t0);case 15:return e.prev=15,r.f(),e.finish(15);case 18:case"end":return e.stop()}}),e,this,[[2,12,15,18]])})));return function(t,n){return e.apply(this,arguments)}}()},{key:"onBatchEnd",value:function(){var e=(0,Da.Z)(E().mark((function e(t,n){var r,a,i;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:null==n&&(n={}),r=(0,B.Z)(this.callbacks),e.prev=2,r.s();case 4:if((a=r.n()).done){e.next=10;break}return i=a.value,e.next=8,i.onBatchEnd(t,n);case 8:e.next=4;break;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(2),r.e(e.t0);case 15:return e.prev=15,r.f(),e.finish(15);case 18:case"end":return e.stop()}}),e,this,[[2,12,15,18]])})));return function(t,n){return e.apply(this,arguments)}}()},{key:"onTrainBegin",value:function(){var e=(0,Da.Z)(E().mark((function e(t){var n,r,a;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:null==t&&(t={}),n=(0,B.Z)(this.callbacks),e.prev=2,n.s();case 4:if((r=n.n()).done){e.next=10;break}return a=r.value,e.next=8,a.onTrainBegin(t);case 8:e.next=4;break;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(2),n.e(e.t0);case 15:return e.prev=15,n.f(),e.finish(15);case 18:case"end":return e.stop()}}),e,this,[[2,12,15,18]])})));return function(t){return e.apply(this,arguments)}}()},{key:"onTrainEnd",value:function(){var e=(0,Da.Z)(E().mark((function e(t){var n,r,a;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:null==t&&(t={}),n=(0,B.Z)(this.callbacks),e.prev=2,n.s();case 4:if((r=n.n()).done){e.next=10;break}return a=r.value,e.next=8,a.onTrainEnd(t);case 8:e.next=4;break;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(2),n.e(e.t0);case 15:return e.prev=15,n.f(),e.finish(15);case 18:case"end":return e.stop()}}),e,this,[[2,12,15,18]])})));return function(t){return e.apply(this,arguments)}}()}]),e}(),$l=function(e){(0,M.Z)(n,e);var t=(0,O.Z)(n);function n(){return(0,D.Z)(this,n),t.call(this)}return(0,F.Z)(n,[{key:"onEpochBegin",value:function(){var e=(0,Da.Z)(E().mark((function e(t){return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.seen=0,this.totals={};case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"onBatchEnd",value:function(){var e=(0,Da.Z)(E().mark((function e(t,n){var r,a,i,o=this;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(i in null==n&&(n={}),r=null==n.size?0:n.size,this.seen+=r,a=function(e){var t=n[e];if("number"===typeof t)o.totals.hasOwnProperty(e)||(o.totals[e]=0),o.totals[e]=o.totals[e]+t*r;else{var a;e in o.totals?a=o.totals[e]:o.totals[e]=0;var i=(0,ii.tidy)((function(){return(0,ii.add)(o.totals[e],(0,ii.mul)(t,r))}));o.totals[e]=i,null!=a&&a.dispose()}},n)a(i);case 5:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"onEpochEnd",value:function(){var e=(0,Da.Z)(E().mark((function e(t,n){var r,a,i,o=this;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==n){e.next=19;break}r=(0,B.Z)(this.params.metrics),e.prev=2,i=function(){var e=a.value;if(null==o.totals[e])return"continue";"number"===typeof o.totals[e]?n[e]=o.totals[e]/o.seen:(0,ii.tidy)((function(){var t=(0,ii.mul)((0,ii.div)(1,o.seen),o.totals[e]);n[e]=t,o.totals[e].dispose(),(0,ii.keep)(n[e])}))},r.s();case 5:if((a=r.n()).done){e.next=11;break}if("continue"!==i()){e.next=9;break}return e.abrupt("continue",9);case 9:e.next=5;break;case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(2),r.e(e.t0);case 16:return e.prev=16,r.f(),e.finish(16);case 19:case"end":return e.stop()}}),e,this,[[2,13,16,19]])})));return function(t,n){return e.apply(this,arguments)}}()}]),n}(Kl),Ql=function(e){(0,M.Z)(n,e);var t=(0,O.Z)(n);function n(){return(0,D.Z)(this,n),t.apply(this,arguments)}return(0,F.Z)(n,[{key:"onTrainBegin",value:function(){var e=(0,Da.Z)(E().mark((function e(t){return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.epoch=[],this.history={};case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"onEpochEnd",value:function(){var e=(0,Da.Z)(E().mark((function e(t,n){var r;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(r in null==n&&(n={}),this.epoch.push(t),n)null==this.history[r]&&(this.history[r]=[]),this.history[r].push(n[r]);case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"syncData",value:function(){var e=(0,Da.Z)(E().mark((function e(){var t,n,r,a,i,o,u,s,c;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(a in t=[],n=[],r=[],this.history)for(i=this.history[a],o=0;o<i.length;++o)"number"!==typeof i[o]&&(u=i[o],t.push(u.data()),n.push(a),r.push(o));return e.next=6,Promise.all(t);case 6:for(s=e.sent,c=0;c<s.length;++c)this.history[n[c]][r[c]].dispose(),this.history[n[c]][r[c]]=s[c][0];case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(Kl),Jl=function(e){(0,M.Z)(n,e);var t=(0,O.Z)(n);function n(e,r){var a;if((0,D.Z)(this,n),(a=t.call(this)).currentEpoch=0,a.nowFunc=e.nowFunc,a.nextFrameFunc=e.nextFrameFunc||ii.nextFrame,a.yieldEvery=r||"auto","auto"===a.yieldEvery&&(a.yieldEvery=125),"never"===a.yieldEvery&&null!=e.onYield)throw new Error("yieldEvery is `never` but you provided an `onYield` callback. Either change `yieldEvery` or remove the callback");return ii.util.isNumber(a.yieldEvery)&&(a.maybeWait=function(e,t,n){var r,a=null!=n?n():ii.util.now();return function(){var i=null!=n?n():ii.util.now();return i-a<t?r:(a=i,r=e.apply(void 0,arguments))}}(a.maybeWait.bind((0,Es.Z)(a)),a.yieldEvery,a.nowFunc)),a.trainBegin=e.onTrainBegin,a.trainEnd=e.onTrainEnd,a.epochBegin=e.onEpochBegin,a.epochEnd=e.onEpochEnd,a.batchBegin=e.onBatchBegin,a.batchEnd=e.onBatchEnd,a.yield=e.onYield,a}return(0,F.Z)(n,[{key:"maybeWait",value:function(){var e=(0,Da.Z)(E().mark((function e(t,n,r){var a;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=[],null==this.yield){e.next=5;break}return e.next=4,Gl(r);case 4:a.push(this.yield(t,n,r));case 5:return a.push(this.nextFrameFunc()),e.next=8,Promise.all(a);case 8:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"onEpochBegin",value:function(){var e=(0,Da.Z)(E().mark((function e(t,n){return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.currentEpoch=t,null==this.epochBegin){e.next=6;break}return e.next=4,Gl(n);case 4:return e.next=6,this.epochBegin(t,n);case 6:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"onEpochEnd",value:function(){var e=(0,Da.Z)(E().mark((function e(t,n){var r;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=[],null==this.epochEnd){e.next=5;break}return e.next=4,Gl(n);case 4:r.push(this.epochEnd(t,n));case 5:return"epoch"===this.yieldEvery&&r.push(this.nextFrameFunc()),e.next=8,Promise.all(r);case 8:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"onBatchBegin",value:function(){var e=(0,Da.Z)(E().mark((function e(t,n){return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==this.batchBegin){e.next=5;break}return e.next=3,Gl(n);case 3:return e.next=5,this.batchBegin(t,n);case 5:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"onBatchEnd",value:function(){var e=(0,Da.Z)(E().mark((function e(t,n){var r;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=[],null==this.batchEnd){e.next=5;break}return e.next=4,Gl(n);case 4:r.push(this.batchEnd(t,n));case 5:return"batch"===this.yieldEvery?r.push(this.nextFrameFunc()):ii.util.isNumber(this.yieldEvery)&&r.push(this.maybeWait(this.currentEpoch,t,n)),e.next=8,Promise.all(r);case 8:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"onTrainBegin",value:function(){var e=(0,Da.Z)(E().mark((function e(t){return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==this.trainBegin){e.next=5;break}return e.next=3,Gl(t);case 3:return e.next=5,this.trainBegin(t);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"onTrainEnd",value:function(){var e=(0,Da.Z)(E().mark((function e(t){return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==this.trainEnd){e.next=5;break}return e.next=3,Gl(t);case 3:return e.next=5,this.trainEnd(t);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),n}(Kl);function ef(e,t){return null==e&&(e={}),e instanceof Kl?[e]:Array.isArray(e)&&e[0]instanceof Kl?e:zs(e).map((function(e){return new Jl(e,t)}))}var tf=function(){function e(){(0,D.Z)(this,e)}return(0,F.Z)(e,null,[{key:"registerCallbackConstructor",value:function(t,n){ii.util.assert(t>=0&&Number.isInteger(t),(function(){return"Verbosity level is expected to be an integer >= 0, "+"but got ".concat(t)})),e.checkForDuplicate(n),null==e.constructors[t]&&(e.constructors[t]=[]),e.constructors[t].push(n)}},{key:"checkForDuplicate",value:function(t){for(var n in e.constructors){e.constructors[+n].forEach((function(e){if(e===t)throw new Is("Duplicate callback constructor.")}))}}},{key:"clear",value:function(){e.constructors={}}},{key:"createCallbacks",value:function(t){var n=[];for(var r in e.constructors){var a=+r;t>=a&&n.push.apply(n,(0,I.Z)(e.constructors[a]))}return n.map((function(e){return new e}))}}]),e}();function nf(e,t,n,r,a,i,o,u,s){var c=new Ql,l=[new $l].concat((0,I.Z)(tf.createCallbacks(t)));null!=e&&l.push.apply(l,(0,I.Z)(e)),l.push(c);var f=new Yl(l);return f.setParams({epochs:n,initialEpoch:r,samples:a,steps:i,batchSize:o,verbose:t,doValidation:u,metrics:s}),{callbackList:f,history:c}}tf.constructors={};var rf=n(1752),af=n(1120);function of(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return Vs(e,ii.serialization.SerializationMap.getMap().classNameMap,t,"layer",n)}function uf(e,t){return(0,ii.tidy)((function(){"float32"!==e.dtype&&(e=ii.cast(e,"float32"));var n=ii.sum(jc(e),t,!0),r=ii.fill(n.shape,_c()),a=ii.sqrt(ii.maximum(n,r));return ii.div(e,a)}))}function sf(e,t){return(0,ii.tidy)((function(){return ii.mean(jc(ii.sub(t,e)),-1)}))}function cf(e,t){return(0,ii.tidy)((function(){return ii.mean(ii.abs(ii.sub(t,e)),-1)}))}function lf(e,t){return(0,ii.tidy)((function(){var n=ii.sub(e,t),r=ii.clipByValue(ii.abs(e),_c(),Number.MAX_VALUE),a=ii.abs(ii.div(n,r));return ii.mul(100,ii.mean(a,-1))}))}function ff(e,t){return(0,ii.tidy)((function(){var n=ii.clipByValue(t,_c(),Number.MAX_VALUE),r=ii.log(ii.add(1,n)),a=ii.clipByValue(e,_c(),Number.MAX_VALUE),i=ii.log(ii.add(1,a));return ii.mean(jc(ii.sub(r,i)),-1)}))}function df(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return(0,ii.tidy)((function(){if(n)t=ii.softmax(t);else{var r=ii.sum(t,t.shape.length-1,!0);t=ii.div(t,r)}return t=ii.clipByValue(t,_c(),1-_c()),ii.neg(ii.sum(ii.mul(ii.cast(e,"float32"),ii.log(t)),t.shape.length-1))}))}function hf(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return(0,ii.tidy)((function(){var r=ii.cast(ii.floor(Ac(e)),"int32"),a=(t=ii.clipByValue(t,_c(),1-_c())).shape;return df(ii.reshape(ii.oneHot(r,a[a.length-1]),a),t,n)}))}function pf(e,t){return(0,ii.tidy)((function(){var n;return n=ii.clipByValue(t,_c(),1-_c()),n=ii.log(ii.div(n,ii.sub(1,n))),ii.mean(function(e,t){if(!ii.util.arraysEqual(e.shape,t.shape))throw new Is("logits and labels must have the same shape, but got shapes "+"".concat(JSON.stringify(e.shape)," and ").concat(JSON.stringify(t.shape)));return(0,ii.tidy)((function(){var n=ii.relu(t),r=ii.neg(ii.abs(t));return ii.add(ii.sub(n,ii.mul(t,e)),ii.log1p(ii.exp(r)))}))}(e,n),-1)}))}function vf(e,t){return(0,ii.tidy)((function(){var n=ii.clipByValue(e,_c(),1),r=ii.clipByValue(t,_c(),1);return ii.sum(ii.mul(e,ii.log(ii.div(n,r))),-1)}))}function mf(e,t){return(0,ii.tidy)((function(){var n=uf(e,-1),r=uf(t,-1),a=ii.mul(n,r);return ii.neg(ii.sum(a,-1))}))}var gf={meanSquaredError:sf,meanAbsoluteError:cf,meanAbsolutePercentageError:lf,meanSquaredLogarithmicError:ff,squaredHinge:function(e,t){return(0,ii.tidy)((function(){var n=ii.maximum(0,ii.sub(1,ii.mul(e,t)));return ii.mean(jc(n),-1)}))},hinge:function(e,t){return(0,ii.tidy)((function(){var n=ii.maximum(0,ii.sub(1,ii.mul(e,t)));return ii.mean(n,-1)}))},categoricalHinge:function(e,t){return(0,ii.tidy)((function(){var n=ii.sum(ii.mul(e,t),-1),r=ii.max(ii.mul(ii.sub(1,e),t),-1);return ii.maximum(0,ii.add(1,ii.sub(r,n)))}))},logcosh:function(e,t){return(0,ii.tidy)((function(){var n=Math.log(2),r=ii.sub(t,e),a=ii.sub(ii.add(r,ii.softplus(ii.mul(-2,r))),n);return ii.mean(a,-1)}))},categoricalCrossentropy:df,sparseCategoricalCrossentropy:hf,binaryCrossentropy:pf,kullbackLeiblerDivergence:vf,poisson:function(e,t){return(0,ii.tidy)((function(){var n=ii.log(ii.add(_c(),t));return ii.mean(ii.sub(t,ii.mul(e,n)),-1)}))},cosineProximity:mf};function yf(e){if("string"===typeof e){if(e in gf)return gf[e];var t="Unknown loss ".concat(e);throw e.toLowerCase().includes("softmaxcrossentropy")&&(t="Unknown loss ".concat(e,". ")+'Use "categoricalCrossentropy" as the string name for tf.losses.softmaxCrossEntropy'),new Is(t)}return e}function bf(e,t){return(0,ii.tidy)((function(){var n=ii.mul(.5,ii.onesLike(t)),r=Sc(ii.greater(t,n),e.dtype);return ii.mean(ii.equal(e,r),-1)}))}function xf(e,t){return(0,ii.tidy)((function(){return Sc(ii.equal(ii.argMax(e,-1),ii.argMax(t,-1)),"float32")}))}function wf(e,t){return(0,ii.tidy)((function(){return ii.cast(ii.sum(ii.logicalAnd(ii.equal(e,1),ii.equal(t,1))),"float32")}))}function kf(e,t){return pf(e,t)}function _f(e,t){return e.rank===t.rank&&(e=ii.squeeze(e,[e.rank-1])),(t=ii.argMax(t,-1)).dtype!==e.dtype&&(t=ii.cast(t,e.dtype)),ii.cast(ii.equal(e,t),"float32")}var Sf=df,Cf=hf,Af={binaryAccuracy:bf,categoricalAccuracy:xf,precision:function(e,t){return(0,ii.tidy)((function(){var n=wf(e,t),r=function(e,t){return(0,ii.tidy)((function(){return ii.cast(ii.sum(ii.logicalAnd(ii.equal(e,0),ii.equal(t,1))),"float32")}))}(e,t),a=ii.add(n,r);return ii.cast(ii.where(ii.greater(a,0),ii.div(n,a),0),"float32")}))},categoricalCrossentropy:Sf,sparseCategoricalCrossentropy:Cf,mse:sf,MSE:sf,mae:cf,MAE:cf,mape:lf,MAPE:lf,cosine:mf};function Ef(e){if("string"===typeof e&&e in Af)return Af[e];if("string"!==typeof e&&null!=e)return e;throw new Is("Unknown metric ".concat(e))}function Nf(e){if(Rs(null!==e,"Unknown LossOrMetricFn ".concat(e)),"string"===typeof e)return e;for(var t,n=0,r=Object.keys(gf);n<r.length;n++){var a=r[n];if(gf[a]===e){t=a;break}}if(void 0!==t)return t;for(var i=0,o=Object.keys(Af);i<o.length;i++){var u=o[i];if(Af[u]===e){t=u;break}}return void 0!==t?t:e.name}var Tf=1048576;function If(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(null==e||"object"!==typeof e||Object.getPrototypeOf(e)!==Object.prototype||!Df(e))throw new Error("User-defined metadata is expected to be a JSON object, but is not.");if(n){var r=JSON.stringify(e);r.length>Tf&&console.warn('User-defined metadata of model "'.concat(t,'" is too large in ')+"size (length=".concat(r.length," when serialized). It is not ")+"recommended to store such large objects in user-defined metadata. Please make sure its serialized length is <= "+"".concat(Tf,"."))}}function Df(e){if(null===e)return!0;if("object"===typeof e){if(Object.getPrototypeOf(e)===Object.prototype){for(var t=0,n=Object.keys(e);t<n.length;t++){var r=n[t];if("string"!==typeof r)return!1;if(!Df(e[r]))return!1}return!0}if(Array.isArray(e)){var a,i=(0,B.Z)(e);try{for(i.s();!(a=i.n()).done;){if(!Df(a.value))return!1}}catch(u){i.e(u)}finally{i.f()}return!0}return!1}var o=typeof e;return"string"===o||"number"===o||"boolean"===o}function Ff(e,t,n){var r,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:console.log,i=Of(e),o=["Layer (type)","Input Shape","Output shape","Param #"];if(i?(t=t||90,n=n||[.32,.61,.89,1]):(t=t||115,n=n||[.24,.48,.7,.8,1]),n[n.length-1]<=1&&(n=n.map((function(e){return Math.floor(t*e)}))),!i)for(var u in o.push("Receives inputs"),r=[],e.nodesByDepth){var s;(s=r).push.apply(s,(0,I.Z)(e.nodesByDepth[u]))}a("_".repeat(t)),Rf(o,n,a),a("=".repeat(t));for(var c=e.layers,l=0;l<c.length;++l)i?jf(c[l],n,a):Bf(c[l],n,r,a),a((l===c.length-1?"=":"_").repeat(t));e.checkTrainableWeightsConsistency();var f=Mf(e),d=pl(e.nonTrainableWeights);a("Total params: ".concat(f+d)),a("Trainable params: ".concat(f)),a("Non-trainable params: ".concat(d)),a("_".repeat(t))}function Mf(e){return null!=e.collectedTrainableWeights?pl(e.collectedTrainableWeights):pl(e.trainableWeights)}function Of(e){var t=!0,n=[],r=[];for(var a in e.nodesByDepth)n.push(e.nodesByDepth[a]);for(var i=0,o=n;i<o.length;i++){var u=o[i];if(u.length>1||1===u.length&&u[0].inboundLayers.length>1){t=!1;break}r.push.apply(r,(0,I.Z)(u))}if(t){var s,c=(0,B.Z)(e.layers);try{for(c.s();!(s=c.n()).done;){var l,f=s.value,d=!1,h=(0,B.Z)(f.inboundNodes);try{for(h.s();!(l=h.n()).done;){var p=l.value;if(-1!==r.indexOf(p)){if(d){t=!1;break}d=!0}}}catch(v){h.e(v)}finally{h.f()}if(!t)break}}catch(v){c.e(v)}finally{c.f()}}return t}function Rf(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:console.log,r="",a=0;a<e.length;++a)a>0&&(r=r.slice(0,r.length-1)+" "),r=(r+=e[a]).slice(0,t[a]),r+=" ".repeat(t[a]-r.length);n(r)}function jf(e,t,n){var r,a;try{a=e.inboundNodes.map((function(e){return JSON.stringify(e.inputShapes)})).join(",")}catch(u){a="multiple"}try{r=JSON.stringify(e.outputShape)}catch(u){r="multiple"}var i=e.name,o=e.getClassName();Rf(["".concat(i," (").concat(o,")"),a,r,e.countParams().toString()],t,n)}function Bf(e,t,n,r){var a,i;try{i=e.inboundNodes.map((function(e){return JSON.stringify(e.inputShapes)})).join(",")}catch(y){i="multiple"}try{a=JSON.stringify(e.outputShape)}catch(y){a="multiple"}var o,u=[],s=(0,B.Z)(e.inboundNodes);try{for(s.s();!(o=s.n()).done;){var c=o.value;if(!(null!=n&&n.length>0&&-1===n.indexOf(c)))for(var l=0;l<c.inboundLayers.length;++l){var f=c.inboundLayers[l].name,d=c.nodeIndices[l],h=c.tensorIndices[l];u.push("".concat(f,"[").concat(d,"][").concat(h,"]"))}}}catch(y){s.e(y)}finally{s.f()}var p=e.name,v=e.getClassName(),m=0===u.length?"":u[0];Rf(["".concat(p," (").concat(v,")"),i,a,e.countParams().toString(),m],t,r);for(var g=1;g<u.length;++g)Rf(["","","","",u[g]],t,r)}function zf(e,t,n){return("inboundNodes"===e||"outputLayers"===e||"inputLayers"===e)&&0===t&&"string"===typeof n}function Zf(e,t){if(null===e)return null;if("string"===typeof e)return Ls(e);if("number"===typeof e||"boolean"===typeof e)return e;if(e instanceof Array){for(var n=[],r=e.length,a=0;a<r;++a){var i=e[a];zf(t,a,i)?n.push(i):n.push(Zf(i,t))}return n}for(var o={},u=0,s=Object.keys(e);u<s.length;u++){var c=s[u],l=e[c];if("name"===c&&"string"===typeof l)o[c]=l;else{var f=Ls(c);o[f]=Zf(l,f)}}return o}function Lf(e,t){if(null===e||void 0===e)return null;if("string"===typeof e)return Zs(e);if("number"===typeof e||"boolean"===typeof e)return e;if(e instanceof Array){for(var n=[],r=e.length,a=0;a<r;++a){var i=e[a];zf(t,a,i)?n.push(i):n.push(Lf(i,t))}return n}for(var o={},u=0,s=Object.keys(e);u<s.length;u++){var c=s[u],l=e[c],f=Zs(c);o[f]="name"!==c&&"className"!==c||"string"!==typeof l?Lf(l,c):l}return o}var Pf="4.17.0",Uf=function(e){var t=Object.keys(e);if(0===t.length)return!1;var n=t[0].split("/");return!isNaN(parseInt(n[n.length-1],10))},Wf=function(e){(0,M.Z)(n,e);var t=(0,O.Z)(n);function n(e){var r;if((0,D.Z)(this,n),(r=t.call(this,{})).containerNodes=new Set,r.name=e.name,null==r.name){var a=r.getClassName().toLowerCase();r.name=nc(a)}if(r.supportsMasking=!1,r.trainable_=!0,Array.isArray(e.inputs)?r.inputs=e.inputs.slice():r.inputs=[e.inputs],Array.isArray(e.outputs)?r.outputs=e.outputs.slice():r.outputs=[e.outputs],Gs(r.inputs).length!==r.inputs.length)throw new Is("The list of inputs passed to the model is redundant. All inputs should only appear once. Found: "+"".concat(r.inputs.map((function(e){return e.name}))));Gs(r.outputs).length!==r.outputs.length&&console.warn("The list of outputs passed to the model is redundant. All outputs should only appear once. Found: "+"".concat(r.outputs.map((function(e){return e.name})))),r.inputLayers=[],r.inputLayersNodeIndices=[],r.inputLayersTensorIndices=[],r.outputLayers=[],r.outputLayersNodeIndices=[],r.outputLayersTensorIndices=[],r.layers=[],r.internalContainerRefs=[];var i,o=(0,B.Z)(r.outputs);try{for(o.s();!(i=o.n()).done;){var u=i.value,s=u.sourceLayer,c=u.nodeIndex,l=u.tensorIndex;r.outputLayers.push(s),r.outputLayersNodeIndices.push(c),r.outputLayersTensorIndices.push(l)}}catch(Se){o.e(Se)}finally{o.f()}var f,d=(0,B.Z)(r.inputs);try{for(d.s();!(f=d.n()).done;){var h=f.value,p=h.sourceLayer,v=h.nodeIndex,m=h.tensorIndex;Rs(0===v,"input layer has >1 nodes"),Rs(0===m,"input layer has >1 tensors"),r.inputLayers.push(p),r.inputLayersNodeIndices.push(v),r.inputLayersTensorIndices.push(m)}}catch(Se){d.e(Se)}finally{d.f()}r.inputNames=[],r.outputNames=[],r.feedInputShapes=[],r.feedInputNames=[],r.feedOutputNames=[];for(var g=0;g<r.inputLayers.length;g++){var y=r.inputLayers[g];if(!(y instanceof Al))throw new TypeError("Input layers to a LayersModel must be InputLayer objects. "+"Received inputs: ".concat(e.inputs,". ")+"Input ".concat(g," (0-based) originates ")+"from layer type ".concat(y.getClassName(),"."));r.inputNames.push(y.name),r.feedInputShapes.push(y.batchInputShape),r.feedInputNames.push(y.name)}var b,x=(0,B.Z)(r.outputLayers);try{for(x.s();!(b=x.n()).done;){var w=b.value;r.outputNames.push(w.name)}}catch(Se){x.e(Se)}finally{x.f()}r.internalInputShapes=r.inputs.map((function(e){return e.shape})),r.internalOutputShapes=r.outputs.map((function(e){return e.shape}));var k,_={},S={},C={},A={},E={},N=[],T=function e(t,a,i,o,u,s){null!=o&&null!=u&&null!=s||(o=t.sourceLayer,u=t.nodeIndex,s=t.tensorIndex);var c=o.inboundNodes[u];if(-1!==i.indexOf(c))throw new Ts("The tensor ".concat(t.name,' at layer "').concat(o.name,'" ')+"is part of a cycle.");if(-1===a.indexOf(c)){r.containerNodes.add(n.nodeKey(o,u)),o.id in E||(E[o.id]=Object.keys(E).length),-1===i.indexOf(c)&&i.push(c);for(var l=c.inboundLayers.length,f=0;f<l;f++){e(c.inputTensors[f],a,i,c.inboundLayers[f],c.nodeIndices[f],c.tensorIndices[f])}for(a.push(c);i.indexOf(c)>=0;)i.splice(i.indexOf(c),1);N.push(c)}},I=[],F=[],M=(0,B.Z)(r.outputs);try{for(M.s();!(k=M.n()).done;){T(k.value,I,F)}}catch(Se){M.e(Se)}finally{M.f()}var O,R=N.slice().reverse(),j=(0,B.Z)(R);try{for(j.s();!(O=j.n()).done;){var z=O.value;S[z.id]=z,z.id in _||(_[z.id]=0);var Z=_[z.id],L=null==C[z.outboundLayer.id]?0:C[z.outboundLayer.id];Z=Math.max(Z,L),C[z.outboundLayer.id]=Z,A[z.outboundLayer.id]=z.outboundLayer,_[z.id]=Z;for(var P=0;P<z.inboundLayers.length;P++){var U=z.inboundLayers[P],W=z.nodeIndices[P],V=U.inboundNodes[W],q=null==_[V.id]?0:_[V.id];_[V.id]=Math.max(Z+1,q),S[V.id]=V}}}catch(Se){j.e(Se)}finally{j.f()}var G={};for(var H in _){var X=_[H];X in G||(G[X]=[]),G[X].push(S[H])}var K={};for(var Y in C){var $=C[Y];$ in K||(K[$]=[]),K[$].push(A[Y])}var Q=Object.keys(K).map((function(e){return parseInt(e,10)})).sort(qs);r.layers=[];var J,ee=(0,B.Z)(Q);try{for(ee.s();!(J=ee.n()).done;){var te=K[J.value];te.sort((function(e,t){var n=E[e.id],r=E[t.id];return n<r?-1:n>r?1:0}));var ne,re=(0,B.Z)(te);try{for(re.s();!(ne=re.n()).done;){var ae=ne.value;ae instanceof n&&r.internalContainerRefs.push(ae),r.layers.push(ae)}}catch(Se){re.e(Se)}finally{re.f()}}}catch(Se){ee.e(Se)}finally{ee.f()}r.layersByDepth=K,Q=Object.keys(G).map((function(e){return parseInt(e,10)})).sort(qs);var ie,oe=r.inputs.slice(),ue=[],se=(0,B.Z)(Q);try{for(se.s();!(ie=se.n()).done;){var ce,le=ie.value,fe=(0,B.Z)(G[le]);try{for(fe.s();!(ce=fe.n()).done;){var de=ce.value,he=de.outboundLayer;if(null!=he){var pe,ve=(0,B.Z)(de.inputTensors);try{for(ve.s();!(pe=ve.n()).done;){var me=pe.value;if(-1===oe.indexOf(me))throw new Ts("Graph disconnected: cannot obtain value for tensor ".concat(me)+' at layer "'.concat(he.name,'". ')+"The following previous layers were accessed without "+"issue: ".concat(ue))}}catch(Se){ve.e(Se)}finally{ve.f()}var ge,ye=(0,B.Z)(de.outputTensors);try{for(ye.s();!(ge=ye.n()).done;){var be=ge.value;oe.push(be)}}catch(Se){ye.e(Se)}finally{ye.f()}ue.push(he.name)}}}catch(Se){fe.e(Se)}finally{fe.f()}}}catch(Se){se.e(Se)}finally{se.f()}r.nodesByDepth=G;var xe,we=r.layers.map((function(e){return e.name})),ke=(0,B.Z)(we);try{var _e=function(){var e=xe.value,t=we.filter((function(t){return t===e})).length;if(1!==t)throw new Ts('The name "'.concat(e,'" is used ').concat(t," times ")+"in the model. All layer names should be unique. Layer names: "+JSON.stringify(we))};for(ke.s();!(xe=ke.n()).done;)_e()}catch(Se){ke.e(Se)}finally{ke.f()}return r.outboundNodes=[],r.inboundNodes=[],new kl({outboundLayer:(0,Es.Z)(r),inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:r.inputs,outputTensors:r.outputs,inputMasks:r.inputs.map((function(e){return null})),outputMasks:r.outputs.map((function(e){return null})),inputShapes:r.inputs.map((function(e){return e.shape})),outputShapes:r.outputs.map((function(e){return e.shape}))}),r.built=!0,r._refCount=1,r}return(0,F.Z)(n,[{key:"assertNotDisposed",value:function(){if(0===this._refCount)throw new Error("Container '".concat(this.name,"' is already disposed."))}},{key:"dispose",value:function(){this.assertNotDisposed();var e={refCountAfterDispose:null,numDisposedVariables:0};if(0===--this._refCount){var t,n=(0,B.Z)(this.layers);try{for(n.s();!(t=n.n()).done;){var r=t.value;e.numDisposedVariables+=r.dispose().numDisposedVariables}}catch(u){n.e(u)}finally{n.f()}var a,i=(0,B.Z)(this.internalContainerRefs);try{for(i.s();!(a=i.n()).done;){var o=a.value;e.numDisposedVariables+=o.dispose().numDisposedVariables}}catch(u){i.e(u)}finally{i.f()}}return e.refCountAfterDispose=this._refCount,e}},{key:"trainable",get:function(){return this.trainable_},set:function(e){this.layers.forEach((function(t){t._trainableWeights.forEach((function(t){return t.trainable=e}))})),this.trainable_=e}},{key:"trainableWeights",get:function(){if(this._trainableWeights.length>0)throw new Is("Container instance unexpectedly contains _trainableWeights.The trainable weights of a Container are a union of the trainable weights of its consituent Layers. Its own _trainableWeights must remain an empty Array.");if(!this.trainable)return[];var e,t=[],n=(0,B.Z)(this.layers);try{for(n.s();!(e=n.n()).done;){var r=e.value;t=t.concat(r.trainableWeights)}}catch(a){n.e(a)}finally{n.f()}return t}},{key:"nonTrainableWeights",get:function(){var e,t=[],n=(0,B.Z)(this.layers);try{for(n.s();!(e=n.n()).done;){var r=e.value;t.push.apply(t,(0,I.Z)(r.nonTrainableWeights))}}catch(s){n.e(s)}finally{n.f()}if(!this.trainable){var a,i=[],o=(0,B.Z)(this.layers);try{for(o.s();!(a=o.n()).done;){var u=a.value;i.push.apply(i,(0,I.Z)(u.trainableWeights))}}catch(s){o.e(s)}finally{o.f()}return i.concat(t)}return t}},{key:"weights",get:function(){return this.trainableWeights.concat(this.nonTrainableWeights)}},{key:"loadWeights",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n={},r=0,a=Uf(e);a&&this.parseWeights(e);var i,o=(0,B.Z)(this.layers);try{for(o.s();!(i=o.n()).done;){var u,s=i.value,c=(0,B.Z)(s.weights.entries());try{for(c.s();!(u=c.n()).done;){var l=(0,C.Z)(u.value,2),f=l[0],d=l[1],h=a?"".concat(d.name.split("/").slice(0,-1).join("/")+"/").concat(f):d.originalName;if(null!=n[h])throw new Is("Duplicate weight name: ".concat(h));n[h]=d,r++}}catch(w){c.e(w)}finally{c.f()}}}catch(w){o.e(w)}finally{o.f()}var p=[];for(var v in e){var m=v;if(null==n[v]){var g=v.split("/"),y=g.slice(0,-2).concat([g[g.length-1]]);m=y.join("/")}if(null!=n[m])p.push([n[m],e[v]]);else if(t)throw new Is("Provided weight data has no target variable: ".concat(v));delete n[m]}if(t){var b=[];for(var x in n)b.push(x);if(b.length>0)throw new Is("".concat(b.length," of ").concat(r," weights are not set: ")+"".concat(b))}yl(p)}},{key:"parseWeights",value:function(e){var t=function(t){var n=t.split("/"),r=["vars","layer_checkpoint_dependencies"],a=n.map((function(e){return e.startsWith("_")?e.slice(1):e})).filter((function(e){return!r.includes(e)})).join("/");a!==t&&(e[a]=e[t],delete e[t])};for(var n in Object.keys(e))t(n)}},{key:"updatedConfig",value:function(){var e=this.getConfig(),t={};return t.className=this.getClassName(),t.config=e,t.kerasVersion="tfjs-layers ".concat(Pf),t.backend="TensorFlow.js",t}},{key:"toJSON",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=Lf(this.updatedConfig());return t?JSON.stringify(n):n}},{key:"call",value:function(e,t){var n=this;return(0,ii.tidy)((function(){e=zs(e);for(var r=new Nl,a=0;a<n.inputs.length;++a)r.add(n.inputs[a],e[a]);return Dl(n.outputs,r,t)}))}},{key:"computeMask",value:function(e,t){var n=this;return(0,ii.tidy)((function(){var r;return e=zs(e),r=null==t?Os(null,e.length):zs(t),n.runInternalGraph(e,r)[1]}))}},{key:"computeOutputShape",value:function(e){var t=fl(e);if(t.length!==this.inputLayers.length)throw new Is("Invalid inputShape argument ".concat(e,": ")+"model has ".concat(this.inputLayers.length," tensor inputs."));for(var n={},r=0;r<t.length;r++){var a=this.inputLayers[r],i=t[r];n[a.name+"_0_0"]=i}var o=Object.keys(this.nodesByDepth).map((function(e){return parseInt(e,10)})).sort(qs);if(o.length>1){var u,s=(0,B.Z)(o);try{for(s.s();!(u=s.n()).done;){var c,l=u.value,f=this.nodesByDepth[l],d=(0,B.Z)(f);try{for(d.s();!(c=d.n()).done;){var h=c.value,p=h.outboundLayer;if(-1===this.inputLayers.map((function(e){return e.id})).indexOf(p.id)){for(var v=[],m=0;m<h.inboundLayers.length;m++){var g=h.inboundLayers[m],y=h.nodeIndices[m],b=h.tensorIndices[m],x=n["".concat(g.name,"_").concat(y,"_").concat(b)];v.push(x)}for(var w=fl(p.computeOutputShape(Bs(v))),k=p.inboundNodes.indexOf(h),_=0;_<w.length;_++){n["".concat(p.name,"_").concat(k,"_").concat(_)]=w[_]}}}}catch(M){d.e(M)}finally{d.f()}}}catch(M){s.e(M)}finally{s.f()}}for(var S=[],C=[],A=0;A<this.outputLayers.length;A++){var E=this.outputLayers[A],N=this.outputLayersNodeIndices[A],T=this.outputLayersTensorIndices[A],I="".concat(E.name,"_").concat(N,"_").concat(T);C.push(I)}for(var D=0;D<C.length;D++){var F=C[D];Rs(F in n),S.push(n[F])}return Bs(S)}},{key:"runInternalGraph",value:function(e,t){null==t&&(t=Os(null,e.length));for(var n={},r=0;r<this.inputs.length;++r){var a=this.inputs[r],i=e[r],o=t[r];n[a.id]=[i,o]}var u,s=Object.keys(this.nodesByDepth).map((function(e){return parseInt(e,10)})).sort(qs),c=(0,B.Z)(s);try{for(c.s();!(u=c.n()).done;){var l,f=u.value,d=this.nodesByDepth[f],h=(0,B.Z)(d);try{for(h.s();!(l=h.n()).done;){var p,v=l.value,m=v.outboundLayer,g=v.inputTensors,y=v.outputTensors,b=new Array,x=(0,B.Z)(g);try{for(x.s();!(p=x.n()).done;){var w=p.value;w.id in n&&b.push(n[w.id])}}catch(q){x.e(q)}finally{x.f()}if(b.length===g.length){var k={},_=void 0,S=void 0,A=void 0,E=void 0;if(null!=v.callArgs&&(k=v.callArgs),1===b.length){var N=(0,C.Z)(b[0],2),T=N[0],I=N[1];null==k.mask&&(k.mask=I),A=zs(m.call(T,k)),E=zs(m.computeMask(T,I)),_=[T],S=[I]}else _=b.map((function(e){return e[0]})),S=b.map((function(e){return e[1]})),null==k.mask&&(k.mask=S),A=zs(m.call(_,k)),E=zs(m.computeMask(_,S));if(m.activityRegularizer)throw new Ds("LayersModel invocation with concrete Tensor value(s) in the presence of activity regularizer(s) is not supported yet.");for(var D=0;D<y.length;++D){var F=y[D],M=A[D],O=E[D];n[F.id]=[M,O]}}}}catch(q){h.e(q)}finally{h.f()}}}catch(q){c.e(q)}finally{c.f()}var R,j=[],z=[],Z=[],L=(0,B.Z)(this.outputs);try{for(L.s();!(R=L.n()).done;){var P=R.value;Rs(P.id in n,"Could not compute output ".concat(P.name," : ").concat(P.id));var U=(0,C.Z)(n[P.id],2),W=U[0],V=U[1];Z.push(W.shape),j.push(W),z.push(V)}}catch(q){L.e(q)}finally{L.f()}return[j,z,Z]}},{key:"buildNodeConversionMap",value:function(e){var t,r,a={},i=(0,B.Z)(this.layers);try{for(i.s();!(r=i.n()).done;){var o=r.value;t=o instanceof n?1:0;for(var u=0;u<o.inboundNodes.length;u++){var s=n.nodeKey(o,u);this.containerNodes.has(s)&&(a[s]=t,t+=1)}}}catch(c){i.e(c)}finally{i.f()}return a}},{key:"getLayer",value:function(e,t){if(null!=t)return this.findLayer(t);if(null==e)throw new Is("Provide either a layer name or layer index");if("number"===typeof e)return this.findLayer(e);var n,r=(0,B.Z)(this.layers);try{for(r.s();!(n=r.n()).done;){var a=n.value;if(a.name===e)return a}}catch(i){r.e(i)}finally{r.f()}throw new Is("No such layer: ".concat(e))}},{key:"findLayer",value:function(e){if(this.layers.length<=e)throw new Is("Was asked to retrieve layer at index ".concat(e,", but model only ")+"has ".concat(this.layers.length," layer(s)."));return this.layers[e]}},{key:"calculateLosses",value:function(){var e=this;return(0,ii.tidy)((function(){var t,r=[],a=(0,B.Z)(e.layers);try{for(a.s();!(t=a.n()).done;)for(var i=t.value,o=0;o<i.inboundNodes.length;++o){var u=n.nodeKey(i,o);e.containerNodes.has(u)&&r.push.apply(r,(0,I.Z)(i.calculateLosses()))}}catch(s){a.e(s)}finally{a.f()}return r}))}},{key:"getConfig",value:function(){var e,t={name:this.name},r=this.buildNodeConversionMap(this.layers),a=[],i=(0,B.Z)(this.layers);try{for(i.s();!(e=i.n()).done;){for(var o=e.value,u=o.getClassName(),s=o.getConfig(),c=[],l=0;l<o.inboundNodes.length;l++){var f=o.inboundNodes[l],d=n.nodeKey(o,l),h={};if(this.containerNodes.has(d)){if(f.callArgs)try{JSON.stringify(f.callArgs),h=f.callArgs}catch(R){console.warn("Layer ".concat(o.name," was passed ")+"non-serializable keyword arguments: "+"".concat(f.callArgs,". They will not be included ")+"in the serialized model (and thus will be missing at deserialization time)."),h={}}if(f.inboundLayers.length>0){for(var p=[],v=0;v<f.inboundLayers.length;v++){var m=f.inboundLayers[v],g=f.nodeIndices[v],y=f.tensorIndices[v],b=r[n.nodeKey(m,g)];null==b&&(b=0),p.push([m.name,b,y,h])}c.push(p)}}}var x={};x.name=o.name,x.className=u,x.config=s,x.inboundNodes=c,a.push(x)}}catch(R){i.e(R)}finally{i.f()}t.layers=a;for(var w=[],k=0;k<this.inputLayers.length;k++){var _=this.inputLayers[k],S=this.inputLayersNodeIndices[k],C=n.nodeKey(_,S);if(this.containerNodes.has(C)){var A=r[C];null!==A&&void 0!==A||(A=0);var E=this.inputLayersTensorIndices[k];w.push([_.name,A,E])}}t.inputLayers=w;for(var N=[],T=0;T<this.outputLayers.length;T++){var I=this.outputLayers[T],D=this.outputLayersNodeIndices[T],F=n.nodeKey(I,D);if(this.containerNodes.has(F)){var M=r[F];null!==M&&void 0!==M||(M=0);var O=this.outputLayersTensorIndices[T];N.push([I.name,M,O])}}return t.outputLayers=N,t}},{key:"stateful",get:function(){if(this._stateful)throw new Is("Container instance unexpectedly has _stateful = true. The statefulness of a Container is determined by the Layers it contains. Its _stateful property must remain the default false.");var e,t=(0,B.Z)(this.layers);try{for(t.s();!(e=t.n()).done;){if(e.value.stateful)return!0}}catch(n){t.e(n)}finally{t.f()}return!1}},{key:"resetStates",value:function(){var e=this;(0,ii.tidy)((function(){e.layers.forEach((function(e){e.stateful&&e.resetStates()}))}))}}],[{key:"fromConfig",value:function(e,t){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r={},a={};function i(e,t){e.name in a?a[e.name].push(t):a[e.name]=[t]}function o(e,t){var n,a,o=[],u=(0,B.Z)(t);try{for(u.s();!(a=u.n()).done;){var s=a.value,c=s[0],l=s[1],f=s[2];if(n=null==s[3]?{}:s[3],!(c in r))return void i(e,t);var d=r[c];if(d.inboundNodes.length<=l)return void i(e,t);var h=d.inboundNodes[l];o.push(h.outputTensors[f])}}catch(p){u.e(p)}finally{u.f()}o.length>0&&e.apply(Bs(o),n)}function u(e){var a=e.name,o=of(e,null!=t.customObjects?t.customObjects:{});o.setFastWeightInitDuringBuild(n),r[a]=o,e.inboundNodes.forEach((function(e){if(!(e instanceof Array))throw new Is("Corrupted configuration, expected array for nodeData: ".concat(e));i(o,e)}))}var s,c=t.name,l=t.layers,f=(0,B.Z)(l);try{for(f.s();!(s=f.n()).done;){var d=s.value;u(d)}}catch(U){f.e(U)}finally{f.f()}for(;!Hs(a);){var h,p=(0,B.Z)(l);try{for(p.s();!(h=p.n()).done;){var v=h.value,m=r[v.name];if(m.name in a){var g=a[m.name];delete a[m.name];var y,b=(0,B.Z)(g);try{for(b.s();!(y=b.n()).done;){var x=y.value;o(m,x)}}catch(U){b.e(U)}finally{b.f()}}}}catch(U){p.e(U)}finally{p.f()}}var w,k=[],_=[],S=t.inputLayers,C=(0,B.Z)(S);try{for(C.s();!(w=C.n()).done;){var A=w.value,E=A[0],N=A[1],T=A[2];Rs(E in r);var I=r[E],D=I.inboundNodes[N].outputTensors;k.push(D[T])}}catch(U){C.e(U)}finally{C.f()}var F,M=t.outputLayers,O=(0,B.Z)(M);try{for(O.s();!(F=O.n()).done;){var R=F.value,j=R[0],z=R[1],Z=R[2];Rs(j in r);var L=r[j],P=L.inboundNodes[z].outputTensors;_.push(P[Z])}}catch(U){O.e(U)}finally{O.f()}return new e({inputs:k,outputs:_,name:c})}}]),n}(Sl);function Vf(e,t,n){var r=t.length;if(null==e||Array.isArray(e)&&0===e.length)return t.map((function(e){return null}));if(1===r)return Array.isArray(e)&&1===e.length?e:"object"===typeof e&&t[0]in e?[e[t[0]]]:[e];if(Array.isArray(e)){if(e.length!==r)throw new Error("Provided ".concat(n," is an array of ").concat(e.length," ")+"element(s), but the model has ".concat(r," outputs. ")+"Make sure a set of weights is provided for each model output.");return e}if("object"===typeof e&&Object.keys(e).length>0&&"object"===typeof e[Object.keys(e)[0]]){var a=[];return t.forEach((function(t){t in e?a.push(e[t]):a.push(null)})),a}throw new Error("The model has multiple (".concat(r,") outputs, ")+"so ".concat(n," must be either an array with ")+"".concat(r," elements or an object with ").concat(t," keys. ")+"Provided ".concat(n," not understood: ").concat(JSON.stringify(e)))}function qf(e,t){return Vf(e,t,"classWeight")}function Gf(e,t,n,r){return Hf.apply(this,arguments)}function Hf(){return Hf=(0,Da.Z)(E().mark((function e(t,n,r,a){var i,o,u;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==n&&null==a){e.next=2;break}throw new Error("Support sampleWeight is not implemented yet");case 2:if(null==r){e.next=15;break}return i=(0,ii.tidy)((function(){if(1===t.shape.length)return(0,ii.clone)(t);if(2===t.shape.length){if(t.shape[1]>1){return(0,ii.argMax)(t,1)}if(1===t.shape[1])return(0,ii.reshape)(t,[t.shape[0]]);throw new Error("Encountered unexpected last-dimension size (".concat(t.shape[1],") ")+"during handling of class weights. The size is expected to be >= 1.")}throw new Error("Unexpected rank of target (y) tensor (".concat(t.rank,") during ")+"handling of class weights. The rank is expected to be 1 or 2.")})),e.t0=Array,e.next=7,i.data();case 7:return e.t1=e.sent,o=e.t0.from.call(e.t0,e.t1),(0,ii.dispose)(i),u=[],o.forEach((function(e){if(null==r[e])throw new Error("classWeight must contain all classes in the training data. "+"The class ".concat(e," exists in the data but not in ")+"classWeight");u.push(r[e])})),e.abrupt("return",(0,ii.tensor1d)(u,"float32"));case 15:return e.abrupt("return",null);case 16:case"end":return e.stop()}}),e)}))),Hf.apply(this,arguments)}function Xf(e,t){return(0,ii.mul)(e,t)}function Kf(e,t){var n,r,a=t;n=a.xs,r=a.ys,ii.util.assert(null!=n&&null!=r,(function(){return"A Dataset iterator for fitDataset() is expected to generate objects of the form `{xs: xVal, ys: yVal}`, where the two values may be `tf.Tensor`, an array of Tensors, or a map of string to Tensor.  The provided Dataset instead generates "+"".concat(t)}));var i=Yf("input",e.inputNames,n),o=Yf("output",e.outputNames,r),u=i[0].shape[0];ii.util.assert(i.length===e.inputs.length,(function(){return"LayersModel has ".concat(e.inputs.length," inputs, but the dataset ")+"provides ".concat(i.length," inputs.  (Expected input keys: ")+"".concat(JSON.stringify(e.inputNames),")")})),ii.util.assert(o.length===e.outputs.length,(function(){return"LayersModel has ".concat(e.outputs.length," outputs, but the dataset ")+"provides ".concat(o.length," outputs.  (Expected output keys: ")+"".concat(JSON.stringify(e.outputNames),")")}));for(var s=function(t){ii.util.assert(i[t].shape[0]===u,(function(){return"Batch size mismatch: input "+"".concat(e.inputNames[t]," has ").concat(i[t].shape[0],"; ")+"expected  ".concat(u," based on input ").concat(e.inputNames[0],".")}))},c=0;c<i.length;c++)s(c);for(var l=function(t){ii.util.assert(o[t].shape[0]===u,(function(){return"Batch size mismatch: output "+"".concat(e.outputNames[t]," has ").concat(o[t].shape[0],"; ")+"expected  ".concat(u," based on input ").concat(e.inputNames[0],".")}))},f=0;f<o.length;f++)l(f);return{xs:i,ys:o}}function Yf(e,t,n){if(n instanceof ii.Tensor)return[n];if(Array.isArray(n))return ii.util.assert(n.length===t.length,(function(){return"Received an array of ".concat(n.length," Tensors, but expected ").concat(t.length," to match the ").concat(e," keys ").concat(t,".")})),n;var r,a=[],i=(0,B.Z)(t);try{for(i.s();!(r=i.n()).done;){var o=r.value;if(null==n[o])throw new Is("The feature data generated by the dataset lacks the required "+"".concat(e," key '").concat(o,"'."));a.push(n[o])}}catch(u){i.e(u)}finally{i.f()}return a}function $f(e){if(3===e.length)throw new Ds("Validation with sample weights is not implemented yet.");return{xs:e[0],ys:e[1]}}function Qf(e,t,n){return Jf.apply(this,arguments)}function Jf(){return Jf=(0,Da.Z)(E().mark((function e(t,n,r){var a,i,o,u,s,c,l,f,d,h,p,v,m,g,y,b,x,w,k,_,S,C,A,N,T,I,D,F,M,O,R,j,B;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=null!=r.batchesPerEpoch,ii.util.assert(null!=t.optimizer,(function(){return"You must compile a model before training/testing. Use LayersModel.compile(modelCompileConfig)."})),ii.util.assert(null!=r,(function(){return"For fitDataset(), the 2nd argument (config) is required, but it is not provided in this call."})),ii.util.assert(null!=r.epochs&&r.epochs>0&&Number.isInteger(r.epochs),(function(){return"For fitDataset(), config.epochs is expected to be a positive "+"integer, but got ".concat(r.epochs)})),ii.util.assert(!a||r.batchesPerEpoch>0&&Number.isInteger(r.batchesPerEpoch),(function(){return"For fitDataset(), config.batchesPerEpoch is expected to be a "+"positive integer if specified, but got ".concat(r.batchesPerEpoch)})),ii.util.assert(null==r.validationSplit,(function(){return"`validationSplit` is not supported by `fitDataset()`. Use validationData instead."})),!t.isTraining){e.next=8;break}throw new Error("Cannot start training because another fit() call is ongoing.");case 8:return t.isTraining=!0,e.prev=9,(i=null!=r.validationData)&&(td(r.validationData)?ii.util.assert(null==r.validationBatches||r.validationBatches>0&&Number.isInteger(r.validationBatches),(function(){return"For fitDataset() with dataset-based validation, config.validationBatches is expected not to be provided, or to be a positive integer, "+"but got ".concat(r.validationBatches)})):(s=$f(r.validationData),o=s.xs,u=s.ys)),c=t.makeTrainFunction(),l=t.getDedupedMetricsNames(),f=i?l.slice().concat(l.map((function(e){return"val_"+e}))):l.slice(),d=ef(r.callbacks,r.yieldEvery),h=null==r.verbose?1:r.verbose,p=nf(d,h,r.epochs,null,null,ed(n,r),null,i,f),v=p.callbackList,m=p.history,v.setModel(t),t.history=m,e.next=22,v.onTrainBegin();case 22:return t.stopTraining_=!1,g=null==r.initialEpoch?0:r.initialEpoch,e.next=26,n.iterator();case 26:y=e.sent;case 27:if(!(g<r.epochs)){e.next=98;break}return b={},e.next=31,v.onEpochBegin(g);case 31:if(x=0,w=0,a){e.next=37;break}return e.next=36,n.iterator();case 36:y=e.sent;case 37:if(a&&!(x<r.batchesPerEpoch)){e.next=91;break}return e.next=40,y.next();case 40:if(k=e.sent,!a||!k.done){e.next=44;break}return console.warn("You provided `batchesPerEpoch` as "+"".concat(r.batchesPerEpoch,", ")+"but your dataset iterator ran out of data after "+"".concat(x," batches; ")+"interrupting training. Make sure that your dataset can generate at least `batchesPerEpoch * epochs` batches (in this case, "+"".concat(r.batchesPerEpoch*r.epochs," batches). ")+"You may need to use the repeat() function when building your dataset."),e.abrupt("break",91);case 44:if(null==k.value){e.next=73;break}return _=Kf(t,k.value),S=_.xs,C=_.ys,(A={}).batch=w,A.size=S[0].shape[0],e.next=51,v.onBatchBegin(w,A);case 51:if(N=[],null==r.classWeight){e.next=64;break}T=qf(r.classWeight,t.outputNames),I=0;case 55:if(!(I<T.length)){e.next=64;break}return e.t0=N,e.next=59,Gf(C[I],null,T[I]);case 59:e.t1=e.sent,e.t0.push.call(e.t0,e.t1);case 61:++I,e.next=55;break;case 64:for(D=S.concat(C).concat(N),F=c(D),ii.dispose(D),M=0;M<l.length;++M)O=l[M],R=F[M],A[O]=R,ii.keep(R);return e.next=70,v.onBatchEnd(w,A);case 70:Xl(A),w++,x++;case 73:if(!(a?x>=r.batchesPerEpoch:k.done)){e.next=87;break}if(!i){e.next=86;break}if(j=void 0,!td(r.validationData)){e.next=84;break}return e.t2=zs,e.next=80,t.evaluateDataset(r.validationData,{batches:r.validationBatches});case 80:e.t3=e.sent,j=(0,e.t2)(e.t3),e.next=85;break;case 84:j=zs(t.evaluate(o,u,{batchSize:null==r.validationBatchSize?32:r.validationBatchSize,verbose:0}));case 85:for(B=0;B<t.metricsNames.length;++B)b["val_".concat(t.metricsNames[B])]=j[B];case 86:return e.abrupt("break",91);case 87:if(!t.stopTraining_){e.next=89;break}return e.abrupt("break",91);case 89:e.next=37;break;case 91:return e.next=93,v.onEpochEnd(g,b);case 93:if(g++,!t.stopTraining_){e.next=96;break}return e.abrupt("break",98);case 96:e.next=27;break;case 98:return e.next=100,v.onTrainEnd();case 100:return e.next=102,t.history.syncData();case 102:return e.abrupt("return",t.history);case 103:return e.prev=103,t.isTraining=!1,e.finish(103);case 106:case"end":return e.stop()}}),e,null,[[9,,103,106]])}))),Jf.apply(this,arguments)}function ed(e,t){var n=null;return null!=t.batchesPerEpoch?n=t.batchesPerEpoch:Number.isFinite(e.size)&&(n=e.size),n}function td(e){return"function"===typeof e.iterator}function nd(e){return"function"===typeof e.next}function rd(e,t,n){return ad.apply(this,arguments)}function ad(){return(ad=(0,Da.Z)(E().mark((function e(t,n,r){var a,i,o,u,s,c,l,f,d;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=null!=(r=r||{}).batches,i=t.testFunction,o=[],!(r.verbose>0)){e.next=6;break}throw new Ds("Verbose mode is not implemented yet.");case 6:if(ii.util.assert(!a||r.batches>0&&Number.isInteger(r.batches),(function(){return"Test loop expects `batches` to be a positive integer, but "+"received ".concat(JSON.stringify(r.batches))})),!nd(n)){e.next=11;break}e.t0=n,e.next=14;break;case 11:return e.next=13,n.iterator();case 13:e.t0=e.sent;case 14:u=e.t0,s=0,c=0,l=E().mark((function e(){var n;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u.next();case 2:if(n=e.sent,o=ii.tidy((function(){return n.value&&function(){var e=Kf(t,n.value),r=e.xs,a=e.ys,u=r.concat(a),l=ii.tidy((function(){return i(u)}));if(ii.dispose(u),0===c)for(var f=0;f<l.length;++f)o.push((0,ii.scalar)(0));for(var d=u[0].shape[0],h=function(e){var t=l[e],n=o[e];o[e]=ii.tidy((function(){return ii.add(o[e],ii.mul(d,t))})),c>0&&ii.dispose(n)},p=0;p<l.length;++p)h(p);ii.dispose(l),s+=d,++c}(),o})),!n.done){e.next=7;break}return a&&console.warn("Your dataset iterator ran out of data during evaluateDataset(). Interrupting evalution. Make sure that your dataset can generate at least `batches` "+"batches (in this case, ".concat(r.batches," batches). ")+"You may need to use the repeat() function when building your dataset."),e.abrupt("return","break");case 7:case"end":return e.stop()}}),e)}));case 18:if(a&&!(c<r.batches)){e.next=25;break}return e.delegateYield(l(),"t1",20);case 20:if("break"!==e.t1){e.next=23;break}return e.abrupt("break",25);case 23:e.next=18;break;case 25:for(f=0;f<o.length;++f)d=o[f],o[f]=ii.div(o[f],s),ii.dispose(d);return e.abrupt("return",Bs(o));case 27:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function id(e){ii.util.assert(e>0&&Number.isInteger(e),(function(){return"batchSize is required to be a positive integer, but got ".concat(e)}))}function od(e,t,n){return null==e?[null]:Array.isArray(e)?e.map((function(e){return Ec(e,t,n-t)})):Ec(e,t,n-t)}function ud(e,t){return ii.tidy((function(){return null==e?null:Array.isArray(e)?e.map((function(e){return ud(e,t)})):Rc(e,"int32"===t.dtype?t:ii.cast(t,"int32"))}))}function sd(e,t){for(var n=[],r=0,a=null;r<e;)(a=r+t)>=e&&(a=e),n.push([r,a]),r=a;return n}function cd(e){var t=[];e instanceof ii.Tensor&&(e=[e]);for(var n=0;n<e.length;++n){var r=e[n];if(1===r.rank)t.push(Cc(r,1));else{if(0===r.rank)throw new Error("Expected tensor to be at least 1D, but received a 0D tensor (scalar).");t.push(r)}}return t}function ld(e,t){if(null!=e){var n=[];if(t instanceof ii.Tensor)n.push(t.id);else if(Array.isArray(t))t.forEach((function(e){return n.push(e.id)}));else if(null!=t)for(var r in t){var a=t[r];n.push(a.id)}var i=[];if(e instanceof ii.Tensor)-1===n.indexOf(e.id)&&i.push(e);else if(Array.isArray(e))e.forEach((function(e){-1===n.indexOf(e.id)&&i.push(e)}));else if(null!=e)for(var o in e){var u=e[o];-1===n.indexOf(u.id)&&i.push(u)}i.forEach((function(e){e.isDisposed||e.dispose()}))}}function fd(e){return Array.isArray(e)}function dd(e){return!function(e){return e instanceof ii.Tensor}(e)&&!fd(e)}function hd(e,t,n){var r,a=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"";if(null==t||0===t.length){if(null!=e){var o=!1;if(fd(e)&&e.length>0)o=!0;else if(dd(e)){for(var u in e)if(e.hasOwnProperty(u)){o=!0;break}}else o=!0;if(o)throw new Is("Error when checking model ".concat(i," expected no data, ")+"but got ".concat(e))}return[]}if(null==e)return t.map((function(e){return null}));if(dd(e)){r=[];var s,c=(0,B.Z)(t);try{for(c.s();!(s=c.n()).done;){var l=s.value;if(null==e[l])throw new Is('No data provided for "'.concat(l,'". Need data for each key in: ')+"".concat(t));r.push(e[l])}}catch(m){c.e(m)}finally{c.f()}}else if(fd(e)){if(e.length!==t.length)throw new Is("Error when checking model ".concat(i,": the Array of ")+"Tensors that you are passing to your model is not the size the "+"model expected. Expected to see ".concat(t.length," Tensor(s), but ")+"instead got the following list of Tensor(s): ".concat(e));r=e}else{if(t.length>1)throw new Is("The model ".concat(i," expects ").concat(t.length," Tensor(s), ")+"but only received one Tensor. Found: Tensor with shape ".concat(e.shape));r=[e]}if(r=cd(r),null!=n)for(var f=0;f<t.length;++f)if(null!=n[f]){var d=r[f];if(d.shape.length!==n[f].length)throw new Is("Error when checking ".concat(i,": expected ").concat(t[f]," ")+"to have ".concat(n[f].length," dimension(s). but got array with ")+"shape ".concat(d.shape));for(var h=0;h<n[f].length;++h)if(0!==h||a){var p=d.shape[h],v=n[f][h];if(null!=v&&v>=0&&p!==v)throw new Is("".concat(i," expected a batch of elements where each ")+"example has shape [".concat(n[f].slice(1,n[f].length),"] ")+"(i.e.,tensor shape [*,".concat(n[f].slice(1,n[f].length),"])")+" but the ".concat(i," received an input with ").concat(d.shape[0])+" examples, each with shape [".concat(d.shape.slice(1,d.shape.length),"]")+" (tensor shape [".concat(d.shape,"])"))}}return r}function pd(e,t,n){var r=Gs(e.map((function(e){return e.shape[0]})));r.sort();var a=Gs(t.map((function(e){return e.shape[0]})));if(a.sort(),r.length>1)throw new Is("All input Tensors (x) should have the same number of samples. Got array shapes: "+"".concat(JSON.stringify(e.map((function(e){return e.shape})))));if(a.length>1)throw new Is("All target Tensors (y) should have the same number of samples. Got array shapes: "+"".concat(JSON.stringify(t.map((function(e){return e.shape})))));if(r.length>0&&a.length>0&&!ii.util.arraysEqual(r,a))throw new Is("Input Tensors should have the same number of samples as target "+"Tensors. Found ".concat(r[0]," input sample(s) and ").concat(a[0]," target ")+"sample(s).")}function vd(e,t,n){for(var r=[sf,pf,df],a=0;a<e.length;++a){var i=e[a],o=t[a],u=n[a];if(null!=o){if(o===df&&1===i.shape[i.shape.length-1])throw new Is("You are passing a target array of shape ".concat(i.shape," while using ")+"a loss 'categorical_crossentropy'. 'categorical_crossentropy'expects targets to be binary matrices (1s and 0s) of shape [samples, classes].");if(-1!==r.indexOf(o))for(var s=i.shape.slice(1),c=u.slice(1),l=0;l<s.length;++l){var f=s[l],d=c[l];if(null!=d&&f!==d)throw new Is("A target Tensor with shape ".concat(i.shape," was passed for an ")+"output of shape ".concat(u,", while using a loss function that ")+"expects targets to have the same shape as the output.")}}}}function md(e,t,n){var r,a=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"";if(Array.isArray(e)){if(e.length!==t.length)throw new Is("Error when checking model ".concat(i,": the Array of ")+"Tensors that you are passing to your model is not the size the "+"the model expected. Expected to see ".concat(t.length," Tensor(s),")+" but instead got ".concat(e.length," Tensors(s)."));r=e}else{if(t.length>1)throw new Is("The model expects ".concat(t.length," ").concat(i," Tensors, ")+"but only received one Tensor. Found: array with shape "+"".concat(JSON.stringify(e.shape),"."));r=[e]}if(null!=n)for(var o=0;o<t.length;++o)if(null!=n[o]){var u=r[o];if(u.shape.length!==n[o].length)throw new Is("Error when checking ".concat(i,": expected ").concat(t[o]," ")+"to have ".concat(n[o].length," dimension(s), but got array with ")+"shape ".concat(JSON.stringify(u.shape)));for(var s=0;s<n[o].length;++s)if(0!==s||a){var c=u.shape[s],l=n[o][s];if(null!=l&&l!==c)throw new Is("Error when checking ".concat(i,": expected ")+"".concat(t[o]," to have shape ").concat(JSON.stringify(n[o])," but ")+"got array with shape ".concat(JSON.stringify(u.shape),"."))}}}var gd=function(e){(0,M.Z)(n,e);var t=(0,O.Z)(n);function n(e){var r;return(0,D.Z)(this,n),(r=t.call(this,e)).isTraining=!1,r}return(0,F.Z)(n,[{key:"summary",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:console.log;if(!this.built)throw new Is("This model has never been called, thus its weights have not been created yet. So no summary can be displayed. Build the model first (e.g., by calling it on some test data).");Ff(this,e,t,n)}},{key:"compile",value:function(e){var t=this;if(null==e.loss&&(e.loss=[]),this.loss=e.loss,"string"===typeof e.optimizer)this.optimizer_=function(e){var t={Adagrad:function(){return ii.train.adagrad(.01)},Adadelta:function(){return ii.train.adadelta(1,.95,_c())},Adam:function(){return ii.train.adam(.001,.9,.999,_c())},Adamax:function(){return ii.train.adamax(.002,.9,.999,_c(),0)},RMSProp:function(){return ii.train.rmsprop(.001,.9,0,_c())},SGD:function(){return ii.train.sgd(.01)}};if(t.adagrad=t.Adagrad,t.adadelta=t.Adadelta,t.adam=t.Adam,t.adamax=t.Adamax,t.rmsprop=t.RMSProp,t.sgd=t.SGD,e in t)return t[e]();throw new Is("Unknown Optimizer ".concat(e))}(e.optimizer),this.isOptimizerOwned=!0;else{if(!(e.optimizer instanceof ii.Optimizer))throw new Is("User-defined optimizer must be an instance of tf.Optimizer.");this.optimizer_=e.optimizer,this.isOptimizerOwned=!1}var n=[];if(Array.isArray(e.loss)||"string"===typeof e.loss||"function"===typeof e.loss)if(Array.isArray(e.loss)){if(e.loss.length!==this.outputs.length)throw new Is("When passing an Array as loss, it should have one entry per "+"model output. The model has ".concat(this.outputs.length," output(s), ")+"but you passed loss=".concat(e.loss,"."));var r=e.loss;n=r.map((function(e){return yf(e)}))}else{var a=yf(e.loss);this.outputs.forEach((function(e){n.push(a)}))}else{for(var i in e.loss=e.loss,e.loss)if(-1===this.outputNames.indexOf(i))throw new Is('Unknown entry in loss dictionary: "'.concat(i,'". ')+"Only expected the following keys: ".concat(this.outputNames));var o,u=(0,B.Z)(this.outputNames);try{for(u.s();!(o=u.n()).done;){var s=o.value;null==e.loss[s]&&console.warn('Output "'.concat(s,'" is missing from loss dictionary. We assume ')+"this was done on purpose, and we will not be expecting data "+"to be passed to ".concat(s," during training")),n.push(yf(e.loss[s]))}}catch(v){u.e(v)}finally{u.f()}}this.lossFunctions=n,this.feedOutputNames=[],this.feedOutputShapes=[],this.feedLossFns=[];for(var c=0;c<this.outputs.length;++c){var l=this.internalOutputShapes[c],f=this.outputNames[c];this.feedOutputNames.push(f),this.feedOutputShapes.push(l),this.feedLossFns.push(this.lossFunctions[c])}var d=[];this.metrics=e.metrics,this.metricsNames=["loss"],this.metricsTensors=[],hc("loss",(function(){for(var e=0;e<t.outputs.length;++e)if(-1===d.indexOf(e)){var n=t.lossFunctions[e];t.outputs.length>1&&(t.metricsTensors.push([n,e]),t.metricsNames.push(t.outputNames[e]+"_loss"))}}));var h=function(e,t){if(null==e||Array.isArray(e)&&0===e.length)return t.map((function(e){return[]}));var n;if("string"===typeof e||"function"===typeof e)n=[e];else{if(!Array.isArray(e)&&"object"!==typeof e)throw new TypeError("Type of metrics argument not understood. Expected an string,"+"function, Array, or Object, found: ".concat(e));n=e}if(Array.isArray(n))return t.map((function(e){return n}));var r,a=[],i=(0,B.Z)(t);try{for(i.s();!(r=i.n()).done;){var o=r.value,u=n.hasOwnProperty(o)?n[o]:[];Array.isArray(u)||(u=[u]),a.push(u)}}catch(v){i.e(v)}finally{i.f()}return a}(e.metrics,this.outputNames),p=function(e,n,r){t.outputNames.length>1&&(n=t.outputNames[e]+"_"+n),t.metricsNames.push(n),t.metricsTensors.push([r,e])};hc("metric",(function(){for(var e=function(e){if(-1!==d.indexOf(e))return"continue";!function(n){var r,a,i,o,u=(0,B.Z)(n);try{for(u.s();!(o=u.n()).done;){var s=o.value;if("string"===typeof s&&-1!==["accuracy","acc","crossentropy","ce"].indexOf(s)){var c=t.internalOutputShapes[e];1===c[c.length-1]||t.lossFunctions[e]===pf?-1!==["accuracy","acc"].indexOf(s)?a=bf:-1!==["crossentropy","ce"].indexOf(s)&&(a=kf):t.lossFunctions[e]===hf?-1!==["accuracy","acc"].indexOf(s)?a=_f:-1!==["crossentropy","ce"].indexOf(s)&&(a=Cf):-1!==["accuracy","acc"].indexOf(s)?a=xf:-1!==["crossentropy","ce"].indexOf(s)&&(a=Sf);var l=void 0;-1!==["accuracy","acc"].indexOf(s)?l="acc":-1!==["crossentropy","ce"].indexOf(s)&&(l="ce"),i=a,r=""+l}else{var f=Ef(s);i=f,r=""+Nf(s)}var d=void 0;hc(r,(function(){d=i})),p(e,r,d)}}catch(v){u.e(v)}finally{u.f()}}(h[e])},n=0;n<t.outputs.length;++n)e(n)})),this.collectedTrainableWeights=this.trainableWeights}},{key:"checkTrainableWeightsConsistency",value:function(){null!=this.collectedTrainableWeights&&this.trainableWeights.length!==this.collectedTrainableWeights.length&&console.warn("Discrepancy between trainableweights and collected trainable weights. Did you set `model.trainable` without calling `model.compile()` afterwards?")}},{key:"evaluate",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=null==n.batchSize?32:n.batchSize;id(r);var a=!0,i=this.standardizeUserDataXY(e,t,a,r);try{var o=i[0].concat(i[1]);this.makeTestFunction();var u=this.testFunction,s=this.testLoop(u,o,r,n.verbose,n.steps);return Bs(s)}finally{ld(i[0],e),ld(i[1],t)}}},{key:"evaluateDataset",value:function(){var e=(0,Da.Z)(E().mark((function e(t,n){return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.makeTestFunction(),e.abrupt("return",rd(this,t,n));case 2:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"checkNumSamples",value:function(e,t,n){var r,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"steps";if(null!=n){if(r=null,null!=t)throw new Is("If ".concat(a," is set, batchSize must be null or undefined.")+"Got batchSize = ".concat(t))}else{if(null==e)throw new Is("Either the input data should have a defined shape, or "+"".concat(a," shoud be specified."));r=Array.isArray(e)?e[0].shape[0]:e.shape[0]}return r}},{key:"execute",value:function(e,t){if(Array.isArray(t)&&0===t.length)throw new Is("`outputs` is an empty Array, which is not allowed.");var n=Array.isArray(t),r=n?t:[t],a=this.retrieveSymbolicTensors(r),i=new Nl;if(e instanceof ii.Tensor&&(e=[e]),Array.isArray(e)){if(e.length!==this.inputs.length)throw new Is("The number of inputs provided (".concat(e.length,") ")+"does not match the number of inputs of this model "+"(".concat(this.inputs.length,")."));for(var o=0;o<this.inputs.length;++o)i.add(this.inputs[o],e[o])}else{var u,s=(0,B.Z)(this.inputs);try{for(s.s();!(u=s.n()).done;){var c=u.value,l=e[c.name];if(null==l)throw new Is("No value is provided for the model's input ".concat(c.name));i.add(c,l)}}catch(d){s.e(d)}finally{s.f()}}var f=Dl(a,i);return n?f:f[0]}},{key:"retrieveSymbolicTensors",value:function(e){var t,n=Os(null,e.length),r=e.length,a=(0,B.Z)(this.layers);try{for(a.s();!(t=a.n()).done;){for(var i=t.value,o=Array.isArray(i.output)?i.output:[i.output],u=o.map((function(e){return e.name})),s=0;s<e.length;++s){var c=u.indexOf(e[s]);if(-1!==c&&(n[s]=o[c],r--),0===r)break}if(0===r)break}}catch(f){a.e(f)}finally{a.f()}if(r>0){var l=[];throw n.forEach((function(t,n){null==t&&l.push(e[n])})),new Is("Cannot find SymbolicTensors for output name(s): "+"".concat(JSON.stringify(l)))}return n}},{key:"predictLoop",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:32,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return ii.tidy((function(){var a=t.checkNumSamples(e);if(r)throw new Ds("Verbose predictLoop() is not implemented yet.");for(var i=sd(a,n),o=t.outputs.map((function(e){return[]})),u=function(n){ii.tidy((function(){var r=i[n][0],a=i[n][1],o=od(e,r,a),u=[];if(Array.isArray(o))for(var s=0;s<o.length;++s)u.push({key:t.inputs[s],value:o[s]});else u.push({key:t.inputs[0],value:o});var c=new Nl(u);return Dl(t.outputs,c)})).forEach((function(e,t){return o[t].push(e)}))},s=0;s<i.length;++s)u(s);return Bs(o.map((function(e){return ii.concat(e,0)})))}))}},{key:"predict",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=cd(e);md(n,this.inputNames,this.feedInputShapes,!1);try{var r=null==t.batchSize?32:t.batchSize;return id(r),this.predictLoop(n,r)}finally{ld(n,e)}}},{key:"predictOnBatch",value:function(e){md(e,this.inputNames,this.feedInputShapes,!0);var t=(Array.isArray(e)?e[0]:e).shape[0];return this.predictLoop(e,t)}},{key:"standardizeUserDataXY",value:function(e,t){var n=arguments.length>3?arguments[3]:void 0;if(null==this.optimizer_)throw new Ts("You must compile a model before training/testing. Use LayersModel.compile(modelCompileArgs).");for(var r=[],a=0;a<this.feedOutputShapes.length;++a){var i=this.feedOutputShapes[a],o=this.feedLossFns[a];o===hf?r.push(i.slice(0,i.length-1).concat([1])):r.push(i)}if(pd(e=hd(e,this.feedInputNames,this.feedInputShapes,!1,"input"),t=hd(t,this.feedOutputNames,r,!1,"target")),vd(t,this.feedLossFns,this.feedOutputShapes),this.stateful&&null!=n&&n>0&&e[0].shape[0]%n!==0)throw new Is("In a stateful network, you should only pass inputs with a number of samples that is divisible by the batch size "+"".concat(n,". Found: ").concat(e[0].shape[0]," sample(s)."));return[e,t]}},{key:"standardizeUserData",value:function(){var e=(0,Da.Z)(E().mark((function e(t,n,r,a){var i,o,u,s,c,l,f,d,h,p=arguments;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=!(p.length>4&&void 0!==p[4])||p[4],o=p.length>5?p[5]:void 0,u=this.standardizeUserDataXY(t,n,i,o),s=(0,C.Z)(u,2),c=s[0],l=s[1],null==r){e.next=5;break}throw new Error("sample weight is not supported yet.");case 5:if(f=null,null==a){e.next=19;break}d=qf(a,this.outputNames),f=[],h=0;case 10:if(!(h<d.length)){e.next=19;break}return e.t0=f,e.next=14,Gf(l[h],null,d[h]);case 14:e.t1=e.sent,e.t0.push.call(e.t0,e.t1);case 16:++h,e.next=10;break;case 19:return e.abrupt("return",[c,l,f]);case 20:case"end":return e.stop()}}),e,this)})));return function(t,n,r,a){return e.apply(this,arguments)}}()},{key:"testLoop",value:function(e,t,n){var r=this,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=arguments.length>4?arguments[4]:void 0;return ii.tidy((function(){var o=r.checkNumSamples(t,n,i,"steps"),u=[];if(a>0)throw new Ds("Verbose mode is not implemented yet.");if(null!=i)throw new Ds("steps mode in testLoop() is not implemented yet");for(var s=sd(o,n),c=(0,ii.tensor1d)(kc(0,o)),l=0;l<s.length;++l){var f=s[l][0],d=s[l][1],h=Ec(c,f,d-f),p=ud(t,h),v=e(p);if(0===l)for(var m=0;m<v.length;++m)u.push((0,ii.scalar)(0));for(var g=0;g<v.length;++g){var y=v[g];u[g]=ii.add(u[g],ii.mul(d-f,y))}}for(var b=0;b<u.length;++b)u[b]=ii.div(u[b],o);return u}))}},{key:"getDedupedMetricsNames",value:function(){for(var e=this.metricsNames,t=[],n=0;n<e.length;++n){var r=e[n],a=r;if(js(e,r)>1){var i=js(e.slice(0,n),r);a+="_".concat(i)}t.push(a)}return t}},{key:"makeTrainFunction",value:function(){var e=this;return function(t){var n=[],r=t.slice(0,e.inputs.length),a=t.slice(e.inputs.length,e.inputs.length+e.outputs.length),i=t.slice(e.inputs.length+e.outputs.length,e.inputs.length+2*e.outputs.length),o=[],u=e.collectedTrainableWeights.map((function(e){return e.read()}));return[e.optimizer_.minimize((function(){for(var t=[],u=0;u<e.inputs.length;++u)t.push({key:e.inputs[u],value:r[u]});for(var s,c=new Nl(t),l=Dl(e.outputs,c,{training:!0}),f=0;f<e.lossFunctions.length;++f){var d=(0,e.lossFunctions[f])(a[f],l[f]);null!=i[f]&&(d=Xf(d,i[f]));var h=ii.mean(d);n.push(h),s=0===f?d:ii.add(s,d)}for(var p=0;p<e.metricsTensors.length;++p){var v=void 0;if(e.outputs.length>1&&p<e.outputs.length)v=n[p];else{var m=e.metricsTensors[p][0],g=e.metricsTensors[p][1];v=ii.mean(m(a[g],l[g]))}ii.keep(v),o.push(v)}return s=ii.mean(s),e.calculateLosses().forEach((function(e){s=ii.add(s,e)})),s}),!0,u)].concat(o)}}},{key:"makeTestFunction",value:function(){var e=this;this.testFunction=function(t){return ii.tidy((function(){for(var n,r=[],a=t.slice(0,e.inputs.length),i=t.slice(e.inputs.length,e.inputs.length+e.outputs.length),o=[],u=0;u<e.inputs.length;++u)o.push({key:e.inputs[u],value:a[u]});for(var s=new Nl(o),c=Dl(e.outputs,s),l=0;l<e.lossFunctions.length;++l){var f=e.lossFunctions[l],d=ii.mean(f(i[l],c[l]));n=0===l?d:ii.add(n,d),r.push(n)}for(var h=0;h<e.metricsTensors.length;++h){var p=e.metricsTensors[h][0],v=e.metricsTensors[h][1],m=ii.mean(p(i[v],c[v]));r.push(m)}return r}))}}},{key:"fit",value:function(){var e=(0,Da.Z)(E().mark((function e(t,n){var r,a,i,o,u,s,c,l,f,d,h,p,v,m,g,y,b,x,w,k,_,S,C,A,N,T,I=arguments;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=I.length>2&&void 0!==I[2]?I[2]:{},!this.isTraining){e.next=3;break}throw new Error("Cannot start training because another fit() call is ongoing.");case 3:return this.isTraining=!0,e.prev=4,id(h=null==r.batchSize?32:r.batchSize),p=!1,e.next=10,this.standardizeUserData(t,n,r.sampleWeight,r.classWeight,p,h);case 10:if(v=e.sent,a=v[0],i=v[1],d=v[2],m=!1,!(null!=r.validationData&&r.validationData.length>0)){e.next=36;break}if(m=!0,2!==r.validationData.length){e.next=22;break}s=r.validationData[0],c=r.validationData[1],e.next=27;break;case 22:if(3!==r.validationData.length){e.next=26;break}throw new Ds("validationData including sample weights is not supported yet.");case 26:throw new Is("When passing validation data, it must contain 2 (valX, valY) or 3 (valX, valY, valSampleWeight) items; "+"".concat(r.validationData," is invalid."));case 27:return y=!0,e.next=30,this.standardizeUserData(s,c,null,null,y,h);case 30:b=e.sent,l=b[0],f=b[1],g=l.concat(f),e.next=37;break;case 36:null!=r.validationSplit&&r.validationSplit>0&&r.validationSplit<1?(m=!0,x=Math.floor(a[0].shape[0]*(1-r.validationSplit)),w=a[0].shape[0],l=od(a,x,w),o=a,a=od(a,0,x),f=od(i,x,w),u=i,i=od(i,0,x),g=l.concat(f)):null!=r.validationSteps&&(m=!0);case 37:return k=a.concat(i).concat(d),this.checkTrainableWeightsConsistency(),_=this.makeTrainFunction(),S=this.getDedupedMetricsNames(),m?(this.makeTestFunction(),C=this.testFunction,A=S.slice().concat(S.map((function(e){return"val_"+e})))):(C=null,g=[],A=S.slice()),N=ef(r.callbacks,r.yieldEvery),e.next=45,this.fitLoop(_,k,S,h,r.epochs,r.verbose,N,C,g,r.shuffle,A,r.initialEpoch,null,null);case 45:return T=e.sent,e.abrupt("return",T);case 47:return e.prev=47,this.isTraining=!1,ld(a,t),ld(i,n),ld(o,t),ld(u,n),ld(l,s),ld(f,c),null!=d&&ii.dispose(d),e.finish(47);case 57:case"end":return e.stop()}}),e,this,[[4,,47,57]])})));return function(t,n){return e.apply(this,arguments)}}()},{key:"fitLoop",value:function(){var e=(0,Da.Z)(E().mark((function e(t,n,r,a,i,o,u,s,c,l,f,d,h,p){var v,m,g,y,b,x,w,k,_=this;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==a&&(a=32),null==i&&(i=1),null==l&&(l=!0),null==d&&(d=0),v=!1,null!=s&&null!=c&&(v=!0),null==p){e.next=10;break}if(v=!0,null!=h){e.next=10;break}throw new Is("Can only use `validationSteps` when doing step-wise training, i.e., `stepsPerEpoch` must be set.");case 10:return null!=(m=this.checkNumSamples(n,a,h,"steps_per_epoch"))&&(g=kc(0,m)),null==o&&(o=1),y=nf(u,o,i,d,m,h,a,v,f),b=y.callbackList,x=y.history,b.setModel(this),this.history=x,e.next=18,b.onTrainBegin();case 18:this.stopTraining_=!1,w=E().mark((function e(i){var o;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b.onEpochBegin(i);case 2:if(o={},null==h){e.next=7;break}throw new Ds("stepsPerEpoch mode is not implemented yet.");case 7:return e.delegateYield(E().mark((function e(){var i,u,f,d;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("batch"!==l){e.next=4;break}throw new Ds("batch shuffling is not implemneted yet");case 4:l&&ii.util.shuffle(g);case 5:i=(0,ii.tensor1d)(g),u=sd(m,a),f=E().mark((function e(l){var f;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return f={},e.next=3,b.onBatchBegin(l,f);case 3:return ii.tidy((function(){var e=u[l][0],d=u[l][1],h=Ec(i,e,d-e);f.batch=l,f.size=d-e;for(var p=ud(n,h),m=t(p),g=0;g<r.length;++g){var y=r[g],b=m[g];f[y]=b,ii.keep(b)}if(l===u.length-1&&v)for(var x=_.testLoop(s,c,a),w=0;w<r.length;++w){var k=r[w],S=x[w];ii.keep(S),o["val_"+k]=S}})),e.next=6,b.onBatchEnd(l,f);case 6:if(Xl(f),!_.stopTraining_){e.next=9;break}return e.abrupt("return","break");case 9:case"end":return e.stop()}}),e)})),d=0;case 9:if(!(d<u.length)){e.next=17;break}return e.delegateYield(f(d),"t0",11);case 11:if("break"!==e.t0){e.next=14;break}return e.abrupt("break",17);case 14:++d,e.next=9;break;case 17:i.dispose();case 18:case"end":return e.stop()}}),e)}))(),"t0",8);case 8:return e.next=10,b.onEpochEnd(i,o);case 10:if(!_.stopTraining_){e.next=12;break}return e.abrupt("return","break");case 12:case"end":return e.stop()}}),e)})),k=d;case 21:if(!(k<i)){e.next=29;break}return e.delegateYield(w(k),"t0",23);case 23:if("break"!==e.t0){e.next=26;break}return e.abrupt("break",29);case 26:++k,e.next=21;break;case 29:return e.next=31,b.onTrainEnd();case 31:return e.next=33,this.history.syncData();case 33:return e.abrupt("return",this.history);case 34:case"end":return e.stop()}}),e,this)})));return function(t,n,r,a,i,o,u,s,c,l,f,d,h,p){return e.apply(this,arguments)}}()},{key:"fitDataset",value:function(){var e=(0,Da.Z)(E().mark((function e(t,n){return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Qf(this,t,n));case 1:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"trainOnBatch",value:function(){var e=(0,Da.Z)(E().mark((function e(t,n){var r,a,i,o,u,s,c,l,f,d;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.standardizeUserData(t,n);case 2:r=e.sent,a=r[0],i=r[1],o=this.makeTrainFunction(),u=o(a.concat(i)),s=[],c=(0,B.Z)(u),e.prev=9,c.s();case 11:if((l=c.n()).done){e.next=19;break}return f=l.value,e.next=15,f.data();case 15:d=e.sent,s.push(d[0]);case 17:e.next=11;break;case 19:e.next=24;break;case 21:e.prev=21,e.t0=e.catch(9),c.e(e.t0);case 24:return e.prev=24,c.f(),e.finish(24);case 27:return ii.dispose(u),ld(r[0],t),ld(r[1],n),e.abrupt("return",Bs(s));case 31:case"end":return e.stop()}}),e,this,[[9,21,24,27]])})));return function(t,n){return e.apply(this,arguments)}}()},{key:"getNamedWeights",value:function(e){for(var t=[],n=null!=e&&e.trainableOnly,r=n?this.trainableWeights:this.weights,a=this.getWeights(n),i=0;i<r.length;++i)n&&!r[i].trainable||t.push({name:r[i].originalName,tensor:a[i]});return t}},{key:"stopTraining",get:function(){return this.stopTraining_},set:function(e){this.stopTraining_=e}},{key:"optimizer",get:function(){return this.optimizer_},set:function(e){this.optimizer_!==e&&(this.optimizer_=e,this.isOptimizerOwned=!1)}},{key:"dispose",value:function(){var e=(0,rf.Z)((0,af.Z)(n.prototype),"dispose",this).call(this);if(0===e.refCountAfterDispose&&null!=this.optimizer&&this.isOptimizerOwned){var t=ii.memory().numTensors;this.optimizer_.dispose(),e.numDisposedVariables+=t-ii.memory().numTensors}return e}},{key:"getLossIdentifiers",value:function(){var e;if("string"===typeof this.loss)e=Zs(this.loss);else if(Array.isArray(this.loss)){var t,n=(0,B.Z)(this.loss);try{for(n.s();!(t=n.n()).done;){if("string"!==typeof t.value)throw new Error("Serialization of non-string loss is not supported.")}}catch(s){n.e(s)}finally{n.f()}e=this.loss.map((function(e){return Zs(e)}))}else{var r=Object.keys(this.loss);e={};for(var a=this.loss,i=0,o=r;i<o.length;i++){var u=o[i];if("string"!==typeof a[u])throw new Error("Serialization of non-string loss is not supported.");e[u]=Zs(a[u])}}return e}},{key:"getMetricIdentifiers",value:function(){if("string"===typeof this.metrics||"function"===typeof this.metrics)return[Zs(Nf(this.metrics))];if(Array.isArray(this.metrics))return this.metrics.map((function(e){return Zs(Nf(e))}));var e={};for(var t in this.metrics)e[t]=Zs(Nf(this.metrics[t]));return e}},{key:"getTrainingConfig",value:function(){return{loss:this.getLossIdentifiers(),metrics:this.getMetricIdentifiers(),optimizer_config:{class_name:this.optimizer.getClassName(),config:this.optimizer.getConfig()}}}},{key:"loadTrainingConfig",value:function(e){if(null!=e.weighted_metrics)throw new Error("Loading weight_metrics is not supported yet.");if(null!=e.loss_weights)throw new Error("Loading loss_weights is not supported yet.");if(null!=e.sample_weight_mode)throw new Error("Loading sample_weight_mode is not supported yet.");var t,n,r=of(Zf(e.optimizer_config));if("string"===typeof e.loss)t=Ls(e.loss);else if(Array.isArray(e.loss))t=e.loss.map((function(e){return Ls(e)}));else if(null!=e.loss)for(var a in t={},e.loss)t[a]=Ls(e.loss[a]);if(Array.isArray(e.metrics))n=e.metrics.map((function(e){return Ls(e)}));else if(null!=e.metrics)for(var i in n={},e.metrics)n[i]=Ls(e.metrics[i]);this.compile({loss:t,metrics:n,optimizer:r})}},{key:"save",value:function(){var e=(0,Da.Z)(E().mark((function e(t,n){var r,a,i,o,u,s,c,l,f;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!==typeof t){e.next=9;break}if(0!==(r=ii.io.getSaveHandlers(t)).length){e.next=6;break}throw new Is("Cannot find any save handlers for URL '".concat(t,"'"));case 6:if(!(r.length>1)){e.next=8;break}throw new Is("Found more than one (".concat(r.length,") save handlers for ")+"URL '".concat(t,"'"));case 8:t=r[0];case 9:if(null!=t.save){e.next=11;break}throw new Is("LayersModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");case 11:return e.next=13,ii.io.encodeWeights(this.getNamedWeights(n));case 13:if(a=e.sent,!1,null,i=this.toJSON(null,false),o={modelTopology:i,format:"layers-model",generatedBy:"TensorFlow.js tfjs-layers v".concat(Pf),convertedBy:null},!(null!=n&&n.includeOptimizer)||null==this.optimizer){e.next=34;break}return o.trainingConfig=this.getTrainingConfig(),s="optimizer",e.t0=ii.io,e.next=25,this.optimizer.getWeights();case 25:return e.t1=e.sent,e.t2=s,e.next=29,e.t0.encodeWeights.call(e.t0,e.t1,e.t2);case 29:c=e.sent,l=c.data,f=c.specs,(u=a.specs).push.apply(u,(0,I.Z)(f)),a.data=ii.io.concatenateArrayBuffers([a.data,l]);case 34:return null!=this.userDefinedMetadata&&(!0,If(this.userDefinedMetadata,this.name,true),o.userDefinedMetadata=this.userDefinedMetadata),o.weightData=a.data,o.weightSpecs=a.specs,e.abrupt("return",t.save(o));case 38:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"setUserDefinedMetadata",value:function(e){If(e,this.name),this.userDefinedMetadata=e}},{key:"getUserDefinedMetadata",value:function(){return this.userDefinedMetadata}}]),n}(Wf);gd.className="Model",ii.serialization.registerClass(gd);var yd=function(e){(0,M.Z)(n,e);var t=(0,O.Z)(n);function n(){return(0,D.Z)(this,n),t.apply(this,arguments)}return(0,F.Z)(n)}(gd);yd.className="Functional",ii.serialization.registerClass(yd);var bd=function(e){(0,M.Z)(n,e);var t=(0,O.Z)(n);function n(e){var r;if((0,D.Z)(this,n),e=e||{},(r=t.call(this,{inputs:[],outputs:[]})).trainable=!0,r.built=!1,r.name=null!=e.name?e.name:nc("sequential_"),null!=e.layers){var a,i=(0,B.Z)(e.layers);try{for(i.s();!(a=i.n()).done;){var o=a.value;r.add(o)}}catch(u){i.e(u)}finally{i.f()}}return r}return(0,F.Z)(n,[{key:"checkShape",value:function(e){if(e.inboundNodes[0].outputTensors[0].shape.some((function(e){return e<0})))throw new Is("Negative dimension size caused by adding layer "+"".concat(e.name," with input shape [")+"".concat(e.inboundNodes[0].inputTensors[0].shape,"]"))}},{key:"add",value:function(e){var t,r=e instanceof n||e instanceof gd;if(r){if(1!==(t=e).outputs.length)throw new Is("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");if(1!==t.inputs.length)throw new Is("All layers in a Sequential model should have a single input tensor. For multi-input layers, use the functional API.")}if(0===this.outputs.length){if(0===e.inboundNodes.length){if(null==e.batchInputShape)throw new Is("The first layer in a Sequential model must get an `inputShape` or `batchInputShape` argument.");var a=El({batchShape:e.batchInputShape,dtype:e.dtype,name:e.name+"_input"});e.apply(a)}if(r)this.outputs=t.outputs,this.inputs=t.inputs;else{if(1!==e.inboundNodes.length)throw new Is("A layer added to a Sequential model must not already be "+"connected somewhere else. LayersModel received layer ".concat(e.name," ")+"which has ".concat(e.inboundNodes.length," pre-existing inbound ")+"connections.");if(1!==e.inboundNodes[0].outputTensors.length)throw new Is("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(e),this.outputs=[e.inboundNodes[0].outputTensors[0]],this.inputs=Cl(this.outputs[0])}this.inboundNodes=[],new kl({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:Os(null,this.inputs.length),outputMasks:[null],inputShapes:this.inputs.map((function(e){return e.shape})),outputShapes:this.outputs[0].shape})}else{var i=e.apply(this.outputs[0]);if(Array.isArray(i))throw new TypeError("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(e),this.outputs=[i],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}this.layers.push(e),this.built=!1}},{key:"pop",value:function(){if(0===this.layers.length)throw new TypeError("There are no layers in the model.");if(this.layers.pop(),0===this.layers.length)this.outputs=[],this.inboundNodes=[],this.outboundNodes=[];else{var e=this.layers.length-1;this.layers[e].outboundNodes=[],this.outputs=[this.layers[e].output],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}}},{key:"call",value:function(e,t){return null==this.model&&this.build(),this.model.call(e,t)}},{key:"build",value:function(e){if(hl(e),0===this.inputs.length||0===this.outputs.length)throw new TypeError("Sequential model cannot be built: model is empty. Add some layers first.");this.model=new gd({inputs:this.inputs,outputs:this.outputs[0],name:this.name+"_model"}),this.model.trainable=this.trainable,this.supportsMasking=this.model.supportsMasking,this.inputLayers=this.model.inputLayers,this.inputLayersNodeIndices=this.model.inputLayersNodeIndices,this.inputLayersTensorIndices=this.model.inputLayersTensorIndices,this.outputLayers=this.model.outputLayers,this.outputLayersNodeIndices=this.model.outputLayersNodeIndices,this.outputLayersTensorIndices=this.model.outputLayersTensorIndices,this.nodesByDepth=this.model.nodesByDepth,this.containerNodes=this.model.containerNodes,this.outputNames=this.model.outputNames,this.inputNames=this.model.inputNames,this.built=!0}},{key:"countParams",value:function(){return this.built||this.build(),(0,rf.Z)((0,af.Z)(n.prototype),"countParams",this).call(this)}},{key:"summary",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:console.log;this.built||this.build(),(0,rf.Z)((0,af.Z)(n.prototype),"summary",this).call(this,e,t,r)}},{key:"setWeights",value:function(e){null==this.model&&this.build(),this.model.setWeights(e)}},{key:"evaluate",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!this.built)throw new Ts("The model needs to be compiled before being used.");return this.model.evaluate(e,t,n)}},{key:"evaluateDataset",value:function(){var e=(0,Da.Z)(E().mark((function e(t,n){return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.built){e.next=2;break}throw new Ts("The model needs to be compiled before being used.");case 2:return e.abrupt("return",this.model.evaluateDataset(t,n));case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"predict",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return null==this.model&&this.build(),this.model.predict(e,t)}},{key:"predictOnBatch",value:function(e){return null==this.model&&this.build(),this.model.predictOnBatch(e)}},{key:"compile",value:function(e){this.build(),this.model.compile(e),this.optimizer_=this.model.optimizer,this.isOptimizerOwned=this.model.isOptimizerOwned,this.loss=this.model.loss,this.metrics=this.model.metrics,this.metricsTensors=this.model.metricsTensors,this.metricsNames=this.model.metricsNames}},{key:"optimizer",get:function(){return null==this.model?void 0:this.model.optimizer},set:function(e){this.model.optimizer=e}},{key:"fit",value:function(){var e=(0,Da.Z)(E().mark((function e(t,n){var r,a=arguments;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=a.length>2&&void 0!==a[2]?a[2]:{},this.built){e.next=3;break}throw new Ts("The model needs to be compiled before being used.");case 3:return e.abrupt("return",this.model.fit(t,n,r));case 4:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"fitDataset",value:function(){var e=(0,Da.Z)(E().mark((function e(t,n){return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.built){e.next=2;break}throw new Ts("The model needs to be compiled before being used.");case 2:return e.abrupt("return",this.model.fitDataset(t,n));case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"trainOnBatch",value:function(){var e=(0,Da.Z)(E().mark((function e(t,n){return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.model.trainOnBatch(t,n));case 1:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"stopTraining",get:function(){if(null==this.model)throw new Is("Cannot get the stopTraining property of a sequential model before it is compiled.");return this.model.stopTraining},set:function(e){if(null==this.model)throw new Is("Cannot set the stopTraining property of a sequential model before it is compiled.");this.model.stopTraining=e}},{key:"getConfig",value:function(){var e,t=[],n=(0,B.Z)(this.layers);try{for(n.s();!(e=n.n()).done;){var r=e.value,a={};a.className=r.getClassName(),a.config=r.getConfig(),t.push(a)}}catch(i){n.e(i)}finally{n.f()}return{name:this.name,layers:t}}}],[{key:"fromConfig",value:function(e,t){var r,a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i={};if(t instanceof Array){if(null==t[0].className||"Merge"===t[0].className)throw new Is("Legacy serialization format not supported yet.");r=t}else ii.util.assert(null!=t.layers,(function(){return"When the config data for a Sequential model is not an Array, it must be an Object that contains the 'layers' field."})),r=t.layers,delete t.layers,i=t;var o=new e(i);if(!(o instanceof n))throw new Ds("Sequential.fromConfig called on non-Sequential input: ".concat(o));var u,s=(0,B.Z)(r);try{for(s.s();!(u=s.n()).done;){var c=u.value,l=void 0,f=of(c,l,a);a&&f.setFastWeightInitDuringBuild(!0),o.add(f)}}catch(d){s.e(d)}finally{s.f()}return o}}]),n}(gd);function xd(e){return new bd(e)}bd.className="Sequential",ii.serialization.registerClass(bd);var wd=function(e){(0,M.Z)(n,e);var t=(0,O.Z)(n);function n(){return(0,D.Z)(this,n),t.apply(this,arguments)}return(0,F.Z)(n,[{key:"getConfig",value:function(){return{}}}]),n}(ii.serialization.Serializable),kd=function(e){(0,M.Z)(n,e);var t=(0,O.Z)(n);function n(){return(0,D.Z)(this,n),t.apply(this,arguments)}return(0,F.Z)(n,[{key:"apply",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return Zc(e,t)}}]),n}(wd);kd.className="elu",ii.serialization.registerClass(kd);var _d=function(e){(0,M.Z)(n,e);var t=(0,O.Z)(n);function n(){return(0,D.Z)(this,n),t.apply(this,arguments)}return(0,F.Z)(n,[{key:"apply",value:function(e){return ii.selu(e)}}]),n}(wd);_d.className="selu",ii.serialization.registerClass(_d);var Sd=function(e){(0,M.Z)(n,e);var t=(0,O.Z)(n);function n(){return(0,D.Z)(this,n),t.apply(this,arguments)}return(0,F.Z)(n,[{key:"apply",value:function(e){return ii.relu(e)}}]),n}(wd);Sd.className="relu",ii.serialization.registerClass(Sd);var Cd=function(e){(0,M.Z)(n,e);var t=(0,O.Z)(n);function n(){return(0,D.Z)(this,n),t.apply(this,arguments)}return(0,F.Z)(n,[{key:"apply",value:function(e){return(0,ii.tidy)((function(){return ii.minimum(6,ii.relu(e))}))}}]),n}(wd);Cd.className="relu6",ii.serialization.registerClass(Cd);var Ad=function(e){(0,M.Z)(n,e);var t=(0,O.Z)(n);function n(){return(0,D.Z)(this,n),t.apply(this,arguments)}return(0,F.Z)(n,[{key:"apply",value:function(e){return e}}]),n}(wd);Ad.className="linear",ii.serialization.registerClass(Ad);var Ed=function(e){(0,M.Z)(n,e);var t=(0,O.Z)(n);function n(){return(0,D.Z)(this,n),t.apply(this,arguments)}return(0,F.Z)(n,[{key:"apply",value:function(e){return ii.sigmoid(e)}}]),n}(wd);Ed.className="sigmoid",ii.serialization.registerClass(Ed);var Nd=function(e){(0,M.Z)(n,e);var t=(0,O.Z)(n);function n(){return(0,D.Z)(this,n),t.apply(this,arguments)}return(0,F.Z)(n,[{key:"apply",value:function(e){return function(e){return(0,ii.tidy)((function(){var t=ii.add(.5,ii.mul(.2,e));return ii.clipByValue(t,0,1)}))}(e)}}]),n}(wd);Nd.className="hardSigmoid",ii.serialization.registerClass(Nd);var Td=function(e){(0,M.Z)(n,e);var t=(0,O.Z)(n);function n(){return(0,D.Z)(this,n),t.apply(this,arguments)}return(0,F.Z)(n,[{key:"apply",value:function(e){return ii.softplus(e)}}]),n}(wd);Td.className="softplus",ii.serialization.registerClass(Td);var Id=function(e){(0,M.Z)(n,e);var t=(0,O.Z)(n);function n(){return(0,D.Z)(this,n),t.apply(this,arguments)}return(0,F.Z)(n,[{key:"apply",value:function(e){return function(e){return(0,ii.tidy)((function(){return ii.div(e,ii.add(ii.abs(e),1))}))}(e)}}]),n}(wd);Id.className="softsign",ii.serialization.registerClass(Id);var Dd=function(e){(0,M.Z)(n,e);var t=(0,O.Z)(n);function n(){return(0,D.Z)(this,n),t.apply(this,arguments)}return(0,F.Z)(n,[{key:"apply",value:function(e){return ii.tanh(e)}}]),n}(wd);Dd.className="tanh",ii.serialization.registerClass(Dd);var Fd=function(e){(0,M.Z)(n,e);var t=(0,O.Z)(n);function n(){return(0,D.Z)(this,n),t.apply(this,arguments)}return(0,F.Z)(n,[{key:"apply",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;return ii.softmax(e,t)}}]),n}(wd);Fd.className="softmax",ii.serialization.registerClass(Fd);var Md=function(e){(0,M.Z)(n,e);var t=(0,O.Z)(n);function n(){return(0,D.Z)(this,n),t.apply(this,arguments)}return(0,F.Z)(n,[{key:"apply",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;return ii.logSoftmax(e,t)}}]),n}(wd);Md.className="logSoftmax",ii.serialization.registerClass(Md);var Od=function(e){(0,M.Z)(n,e);var t=(0,O.Z)(n);function n(){return(0,D.Z)(this,n),t.apply(this,arguments)}return(0,F.Z)(n,[{key:"apply",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return(0,ii.tidy)((function(){return ii.mul(ii.sigmoid(ii.mul(e,t)),e)}))}}]),n}(wd);Od.className="swish",ii.serialization.registerClass(Od);var Rd=function(e){(0,M.Z)(n,e);var t=(0,O.Z)(n);function n(){return(0,D.Z)(this,n),t.apply(this,arguments)}return(0,F.Z)(n,[{key:"apply",value:function(e){return(0,ii.tidy)((function(){return ii.mul(e,ii.tanh(ii.softplus(e)))}))}}]),n}(wd);function jd(e){return e.getClassName()}function Bd(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Vs(e,ii.serialization.SerializationMap.getMap().classNameMap,t,"activation")}function zd(e){if(null==e){var t={className:"linear",config:{}};return Bd(t)}if("string"===typeof e){var n={};return n.className=e,n.config={},Bd(n)}return e instanceof wd?e:Bd(e)}function Zd(e){if(null!=e&&"object"!==typeof e)throw new Error("Argument to L1L2 regularizer's constructor is expected to be an "+"object, but received: ".concat(e))}Rd.className="mish",ii.serialization.registerClass(Rd);var Ld=function(e){(0,M.Z)(n,e);var t=(0,O.Z)(n);function n(){return(0,D.Z)(this,n),t.apply(this,arguments)}return(0,F.Z)(n)}(ii.serialization.Serializable),Pd=function(e){(0,M.Z)(n,e);var t=(0,O.Z)(n);function n(e){var r;return(0,D.Z)(this,n),r=t.call(this),Zd(e),r.l1=null==e||null==e.l1?.01:e.l1,r.l2=null==e||null==e.l2?.01:e.l2,r.hasL1=0!==r.l1,r.hasL2=0!==r.l2,r}return(0,F.Z)(n,[{key:"apply",value:function(e){var t=this;return(0,ii.tidy)((function(){var n=(0,ii.zeros)([1]);return t.hasL1&&(n=(0,ii.add)(n,(0,ii.sum)(ii.mul(t.l1,(0,ii.abs)(e))))),t.hasL2&&(n=(0,ii.add)(n,(0,ii.sum)(ii.mul(t.l2,jc(e))))),ii.reshape(n,[])}))}},{key:"getConfig",value:function(){return{l1:this.l1,l2:this.l2}}}],[{key:"fromConfig",value:function(e,t){return new e({l1:t.l1,l2:t.l2})}}]),n}(Ld);Pd.className="L1L2",ii.serialization.registerClass(Pd);var Ud={l1l2:"L1L2"};function Wd(e){return Us(e)}function Vd(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Vs(e,ii.serialization.SerializationMap.getMap().classNameMap,t,"regularizer")}function qd(e){return null==e?null:"string"===typeof e?Vd({className:e in Ud?Ud[e]:e,config:{}}):e instanceof Ld?e:Vd(e)}var Gd=function(e){(0,M.Z)(n,e);var t=(0,O.Z)(n);function n(e){var r;return(0,D.Z)(this,n),(r=t.call(this,null==e?{}:e)).supportsMasking=!0,null!=e&&(r.maxValue=e.maxValue),r}return(0,F.Z)(n,[{key:"call",value:function(e,t){e=dl(e);var n=(0,ii.relu)(e);return null!=this.maxValue&&(n=(0,ii.clipByValue)(n,0,this.maxValue)),n}},{key:"computeOutputShape",value:function(e){return e}},{key:"getConfig",value:function(){var e={maxValue:this.maxValue},t=(0,rf.Z)((0,af.Z)(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(Sl);Gd.className="ReLU",ii.serialization.registerClass(Gd);var Hd=function(e){(0,M.Z)(n,e);var t=(0,O.Z)(n);function n(e){var r;return(0,D.Z)(this,n),(r=t.call(this,null==e?{}:e)).DEFAULT_ALPHA=.3,null==e&&(e={}),r.alpha=null==e.alpha?r.DEFAULT_ALPHA:e.alpha,r}return(0,F.Z)(n,[{key:"call",value:function(e,t){var n=dl(e);return(0,ii.leakyRelu)(n,this.alpha)}},{key:"computeOutputShape",value:function(e){return e}},{key:"getConfig",value:function(){var e={alpha:this.alpha},t=(0,rf.Z)((0,af.Z)(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(Sl);Hd.className="LeakyReLU",ii.serialization.registerClass(Hd);var Xd=function(e){(0,M.Z)(n,e);var t=(0,O.Z)(n);function n(e){var r;if((0,D.Z)(this,n),(r=t.call(this,null==e?{}:e)).DEFAULT_ALPHA_INITIALIZER="zeros",null==e&&(e={}),r.supportsMasking=!0,r.alphaInitializer=cl(e.alphaInitializer||r.DEFAULT_ALPHA_INITIALIZER),r.alphaRegularizer=qd(e.alphaRegularizer),r.alphaConstraint=ql(e.alphaConstraint),null==e.sharedAxes)r.sharedAxes=null;else if(Array.isArray(e.sharedAxes))r.sharedAxes=e.sharedAxes;else{if("number"!==typeof e.sharedAxes)throw new Is("Expected sharedAxes to be a number or an array of numbers, "+"but got ".concat(e.sharedAxes));r.sharedAxes=[e.sharedAxes]}return r}return(0,F.Z)(n,[{key:"build",value:function(e){var t=(e=hl(e)).slice(1);if(null!=this.sharedAxes){var n,r=(0,B.Z)(this.sharedAxes);try{for(r.s();!(n=r.n()).done;){t[n.value-1]=1}}catch(o){r.e(o)}finally{r.f()}}this.alpha=this.addWeight("alpha",t,"float32",this.alphaInitializer,this.alphaRegularizer,!0,this.alphaConstraint);var a={};if(null!=this.sharedAxes)for(var i=1;i<e.length;++i)a[i]=e[i];this.inputSpec=[new bl({ndim:e.length,axes:a})],this.built=!0}},{key:"call",value:function(e,t){return e=dl(e),(0,ii.prelu)(e,this.alpha.read())}},{key:"getConfig",value:function(){var e={alphaInitializer:sl(this.alphaInitializer),alphaRegularizer:Wd(this.alphaRegularizer),alphaConstraint:Wl(this.alphaConstraint),sharedAxes:this.sharedAxes},t=(0,rf.Z)((0,af.Z)(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(Sl);Xd.className="PReLU",ii.serialization.registerClass(Xd);var Kd=function(e){(0,M.Z)(n,e);var t=(0,O.Z)(n);function n(e){var r;if((0,D.Z)(this,n),(r=t.call(this,null==e?{}:e)).DEFAULT_ALPHA=1,null==e&&(e={}),null!=e.alpha&&e.alpha!==r.DEFAULT_ALPHA)throw new Ds("Non-default alpha value (".concat(e.alpha,") is not supported by the ")+"ELU layer yet.");return r.alpha=null==e.alpha?r.DEFAULT_ALPHA:e.alpha,r}return(0,F.Z)(n,[{key:"call",value:function(e,t){var n=dl(e);return(0,ii.elu)(n)}},{key:"computeOutputShape",value:function(e){return e}},{key:"getConfig",value:function(){var e={alpha:this.alpha},t=(0,rf.Z)((0,af.Z)(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(Sl);Kd.className="ELU",ii.serialization.registerClass(Kd);var Yd=function(e){(0,M.Z)(n,e);var t=(0,O.Z)(n);function n(e){var r;return(0,D.Z)(this,n),(r=t.call(this,null==e?{}:e)).DEFAULT_THETA=1,null==e&&(e={}),r.theta=null==e.theta?r.DEFAULT_THETA:e.theta,r}return(0,F.Z)(n,[{key:"call",value:function(e,t){var n=dl(e);return(0,ii.mul)(n,(0,ii.cast)((0,ii.greater)(n,this.theta),"float32"))}},{key:"computeOutputShape",value:function(e){return e}},{key:"getConfig",value:function(){var e={theta:this.theta},t=(0,rf.Z)((0,af.Z)(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(Sl);Yd.className="ThresholdedReLU",ii.serialization.registerClass(Yd);var $d=function(e){(0,M.Z)(n,e);var t=(0,O.Z)(n);function n(e){var r;return(0,D.Z)(this,n),(r=t.call(this,null==e?{}:e)).DEFAULT_AXIS=1,null==e&&(e={}),r.softmax=(new Fd).apply,r.axis=null==e.axis?r.DEFAULT_AXIS:e.axis,r}return(0,F.Z)(n,[{key:"call",value:function(e,t){var n=this;return(0,ii.tidy)((function(){var r=dl(e),a=t.mask;if(null!=a){var i=(0,ii.mul)((0,ii.sub)((0,ii.ones)(r.shape),(0,ii.cast)(a,r.dtype)),(0,ii.scalar)(-1e9));r=(0,ii.add)(r,i)}return n.axis instanceof Array?n.axis.length>1?(0,ii.exp)((0,ii.sub)(r,(0,ii.logSumExp)(r,n.axis,!0))):n.softmax(r,n.axis[0]):n.softmax(r,n.axis)}))}},{key:"computeOutputShape",value:function(e){return e}},{key:"getConfig",value:function(){var e={axis:this.axis},t=(0,rf.Z)((0,af.Z)(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(Sl);function Qd(e,t,n){if("number"===typeof e)return Os(e,t);if(e.length!==t)throw new Is("The ".concat(n," argument must be an integer or tuple of ").concat(t," integers.")+" Received: ".concat(e.length," elements."));for(var r=0;r<t;++r){var a=e[r];if((i=a)!==parseInt(i.toString(),10))throw new Is("The ".concat(n," argument must be an integer or tuple of ").concat(t)+" integers. Received: ".concat(JSON.stringify(e)," including a")+" non-integer number ".concat(a))}return e;var i}function Jd(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1;if(null==e)return e;var i,o=t+(t-1)*(a-1);return i="same"===n?e:e-o+1,Math.floor((i+r-1)/r)}function eh(e,t,n,r){if(null==e)return null;if("valid"===r)e=e*t+wc([n-t,0]);else{if("same"!==r)throw new Is("Unsupport padding mode: ".concat(r,"."));e*=t}return e}function th(e,t){return(0,ii.tidy)((function(){return cc(t),"channelsFirst"===t?ii.transpose(e,[0,2,3,1]):e}))}function nh(e,t){return(0,ii.tidy)((function(){return cc(t),"channelsFirst"===t?ii.transpose(e,[0,2,3,4,1]):e}))}function rh(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"valid",i=arguments.length>5?arguments[5]:void 0,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1;return(0,ii.tidy)((function(){if(null==i&&(i="channelsLast"),cc(i),3!==e.shape.length)throw new Is("The input of a conv1dWithBias operation should be 3, but is "+"".concat(e.shape.length," instead."));if(3!==t.shape.length)throw new Is("The kernel for a conv1dWithBias operation should be 3, but is "+"".concat(t.shape.length," instead"));if(null!=n&&1!==n.shape.length)throw new Is("The bias for a conv1dWithBias operation should be 1, but is "+"".concat(t.shape.length," instead"));if("channelsFirst"===i&&(e=ii.transpose(e,[0,2,1])),"causal"===a)throw new Ds("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");var u=ii.conv1d(e,t,r,"same"===a?"same":"valid","NWC",o);return null!=n&&(u=zc(u,n)),u}))}function ah(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[1,1],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"valid",i=arguments.length>5?arguments[5]:void 0,o=arguments.length>6?arguments[6]:void 0,u=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;return(0,ii.tidy)((function(){if(null==i&&(i="channelsLast"),cc(i),3!==e.rank&&4!==e.rank)throw new Is("conv2dWithBiasActivation expects input to be of rank 3 or 4, "+"but received ".concat(e.rank,"."));if(3!==t.rank&&4!==t.rank)throw new Is("conv2dWithBiasActivation expects kernel to be of rank 3 or 4, "+"but received ".concat(e.rank,"."));var s=th(e,i);if("causal"===a)throw new Ds("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");return s=ii.fused.conv2d({x:s,filter:t,strides:r,pad:"same"===a?"same":"valid",dilations:o,dataFormat:"NHWC",bias:n,activation:u}),"channelsFirst"===i&&(s=ii.transpose(s,[0,3,1,2])),s}))}function ih(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[1,1,1],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"valid",i=arguments.length>5?arguments[5]:void 0,o=arguments.length>6?arguments[6]:void 0;return(0,ii.tidy)((function(){if(null==i&&(i="channelsLast"),cc(i),4!==e.rank&&5!==e.rank)throw new Is("conv3dWithBias expects input to be of rank 4 or 5, but received "+"".concat(e.rank,"."));if(4!==t.rank&&5!==t.rank)throw new Is("conv3dWithBias expects kernel to be of rank 4 or 5, but received "+"".concat(e.rank,"."));var u=nh(e,i);if("causal"===a)throw new Ds("The support for CAUSAL padding mode in conv3dWithBias is not implemented yet.");return u=ii.conv3d(u,t,r,"same"===a?"same":"valid","NDHWC",o),null!=n&&(u=zc(u,n)),"channelsFirst"===i&&(u=ii.transpose(u,[0,4,1,2,3])),u}))}$d.className="Softmax",ii.serialization.registerClass($d);var oh=function(e){(0,M.Z)(n,e);var t=(0,O.Z)(n);function n(e,r){var a;if((0,D.Z)(this,n),(a=t.call(this,r)).bias=null,a.DEFAULT_KERNEL_INITIALIZER="glorotNormal",a.DEFAULT_BIAS_INITIALIZER="zeros",n.verifyArgs(r),a.rank=e,Ys(a.rank,"rank"),1!==a.rank&&2!==a.rank&&3!==a.rank)throw new Ds("Convolution layer for rank other than 1, 2, or 3 (".concat(a.rank,") is ")+"not implemented yet.");if(a.kernelSize=Qd(r.kernelSize,e,"kernelSize"),a.strides=Qd(null==r.strides?1:r.strides,e,"strides"),a.padding=null==r.padding?"valid":r.padding,lc(a.padding),a.dataFormat=null==r.dataFormat?"channelsLast":r.dataFormat,cc(a.dataFormat),a.activation=zd(r.activation),a.useBias=null==r.useBias||r.useBias,a.biasInitializer=cl(r.biasInitializer||a.DEFAULT_BIAS_INITIALIZER),a.biasConstraint=ql(r.biasConstraint),a.biasRegularizer=qd(r.biasRegularizer),a.activityRegularizer=qd(r.activityRegularizer),a.dilationRate=Qd(null==r.dilationRate?1:r.dilationRate,e,"dilationRate"),1===a.rank&&Array.isArray(a.dilationRate)&&1!==a.dilationRate.length)throw new Is("dilationRate must be a number or an array of a single number for 1D convolution, but received "+"".concat(JSON.stringify(a.dilationRate)));if(2===a.rank){if("number"===typeof a.dilationRate)a.dilationRate=[a.dilationRate,a.dilationRate];else if(2!==a.dilationRate.length)throw new Is("dilationRate must be a number or array of two numbers for 2D "+"convolution, but received ".concat(JSON.stringify(a.dilationRate)))}else if(3===a.rank)if("number"===typeof a.dilationRate)a.dilationRate=[a.dilationRate,a.dilationRate,a.dilationRate];else if(3!==a.dilationRate.length)throw new Is("dilationRate must be a number or array of three numbers for 3D "+"convolution, but received ".concat(JSON.stringify(a.dilationRate)));return a}return(0,F.Z)(n,[{key:"getConfig",value:function(){var e={kernelSize:this.kernelSize,strides:this.strides,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,activation:jd(this.activation),useBias:this.useBias,biasInitializer:sl(this.biasInitializer),biasRegularizer:Wd(this.biasRegularizer),activityRegularizer:Wd(this.activityRegularizer),biasConstraint:Wl(this.biasConstraint)},t=(0,rf.Z)((0,af.Z)(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}],[{key:"verifyArgs",value:function(e){if(Rs("kernelSize"in e,"required key 'kernelSize' not in config"),"number"!==typeof e.kernelSize&&!Ks(e.kernelSize,"number",1,3))throw new Is("BaseConv expects config.kernelSize to be number or number[] with "+"length 1, 2, or 3, but received ".concat(JSON.stringify(e.kernelSize),"."))}}]),n}(Sl),uh=function(e){(0,M.Z)(n,e);var t=(0,O.Z)(n);function n(e,r){var a;return(0,D.Z)(this,n),(a=t.call(this,e,r)).kernel=null,n.verifyArgs(r),a.filters=r.filters,Ys(a.filters,"filters"),a.kernelInitializer=cl(r.kernelInitializer||a.DEFAULT_KERNEL_INITIALIZER),a.kernelConstraint=ql(r.kernelConstraint),a.kernelRegularizer=qd(r.kernelRegularizer),a}return(0,F.Z)(n,[{key:"build",value:function(e){e=hl(e);var t="channelsFirst"===this.dataFormat?1:e.length-1;if(null==e[t])throw new Is("The channel dimension of the input should be defined. "+"Found ".concat(e[t]));var n=e[t],r=this.kernelSize.concat([n,this.filters]);this.kernel=this.addWeight("kernel",r,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[{ndim:this.rank+2,axes:(0,it.Z)({},t,n)}],this.built=!0}},{key:"call",value:function(e,t){var n=this;return(0,ii.tidy)((function(){var t;e=dl(e);var r=null==n.bias?null:n.bias.read(),a=Qs(n.activation.getClassName());if(null!=a&&2===n.rank)t=ah(e,n.kernel.read(),r,n.strides,n.padding,n.dataFormat,n.dilationRate,a);else{if(1===n.rank)t=rh(e,n.kernel.read(),r,n.strides[0],n.padding,n.dataFormat,n.dilationRate[0]);else if(2===n.rank)t=ah(e,n.kernel.read(),r,n.strides,n.padding,n.dataFormat,n.dilationRate);else{if(3!==n.rank)throw new Ds("convolutions greater than 3D are not implemented yet.");t=ih(e,n.kernel.read(),r,n.strides,n.padding,n.dataFormat,n.dilationRate)}null!=n.activation&&(t=n.activation.apply(t))}return t}))}},{key:"computeOutputShape",value:function(e){e=hl(e);for(var t=[],n="channelsLast"===this.dataFormat?e.slice(1,e.length-1):e.slice(2),r=0;r<n.length;++r){var a=Jd(n[r],this.kernelSize[r],this.padding,this.strides[r],"number"===typeof this.dilationRate?this.dilationRate:this.dilationRate[r]);t.push(a)}var i=[e[0]];return"channelsLast"===this.dataFormat?(i=i.concat(t)).push(this.filters):(i.push(this.filters),i=i.concat(t)),i}},{key:"getConfig",value:function(){var e={filters:this.filters,kernelInitializer:sl(this.kernelInitializer),kernelRegularizer:Wd(this.kernelRegularizer),kernelConstraint:Wl(this.kernelConstraint)},t=(0,rf.Z)((0,af.Z)(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}],[{key:"verifyArgs",value:function(e){if(!("filters"in e)||"number"!==typeof e.filters||e.filters<1)throw new Is("Convolution layer expected config.filters to be a 'number' > 0 "+"but got ".concat(JSON.stringify(e.filters)))}}]),n}(oh),sh=function(e){(0,M.Z)(n,e);var t=(0,O.Z)(n);function n(e){var r;return(0,D.Z)(this,n),r=t.call(this,2,e),n.verifyArgs(e),r}return(0,F.Z)(n,[{key:"getConfig",value:function(){var e=(0,rf.Z)((0,af.Z)(n.prototype),"getConfig",this).call(this);return delete e.rank,e}}],[{key:"verifyArgs",value:function(e){if("number"!==typeof e.kernelSize&&!Ks(e.kernelSize,"number",1,2))throw new Is("Conv2D expects config.kernelSize to be number or number[] with "+"length 1 or 2, but received ".concat(JSON.stringify(e.kernelSize),"."))}}]),n}(uh);sh.className="Conv2D",ii.serialization.registerClass(sh);var ch=function(e){(0,M.Z)(n,e);var t=(0,O.Z)(n);function n(e){var r;return(0,D.Z)(this,n),r=t.call(this,3,e),n.verifyArgs(e),r}return(0,F.Z)(n,[{key:"getConfig",value:function(){var e=(0,rf.Z)((0,af.Z)(n.prototype),"getConfig",this).call(this);return delete e.rank,e}}],[{key:"verifyArgs",value:function(e){if("number"!==typeof e.kernelSize&&(!Array.isArray(e.kernelSize)||1!==e.kernelSize.length&&3!==e.kernelSize.length))throw new Is("Conv3D expects config.kernelSize to be number or"+" [number, number, number], but received ".concat(JSON.stringify(e.kernelSize),"."))}}]),n}(uh);ch.className="Conv3D",ii.serialization.registerClass(ch);var lh=function(e){(0,M.Z)(n,e);var t=(0,O.Z)(n);function n(e){var r;if((0,D.Z)(this,n),(r=t.call(this,e)).inputSpec=[new bl({ndim:4})],"same"!==r.padding&&"valid"!==r.padding)throw new Is("Conv2DTranspose currently supports only padding modes 'same' "+"and 'valid', but received padding mode ".concat(r.padding));return r}return(0,F.Z)(n,[{key:"build",value:function(e){if(4!==(e=hl(e)).length)throw new Is("Input should have rank 4; Received input shape: "+JSON.stringify(e));var t="channelsFirst"===this.dataFormat?1:e.length-1;if(null==e[t])throw new Is("The channel dimension of the inputs should be defined. Found `None`.");var n=e[t],r=this.kernelSize.concat([this.filters,n]);this.kernel=this.addWeight("kernel",r,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new bl({ndim:4,axes:(0,it.Z)({},t,n)})],this.built=!0}},{key:"call",value:function(e,t){var n=this;return ii.tidy((function(){var t=dl(e);if(4!==t.shape.length)throw new Is("Conv2DTranspose.call() expects input tensor to be rank-4, but "+"received a tensor of rank-".concat(t.shape.length));var r,a,i=t.shape,o=i[0];"channelsFirst"===n.dataFormat?(r=2,a=3):(r=1,a=2);var u=i[r],s=i[a],c=n.kernelSize[0],l=n.kernelSize[1],f=n.strides[0],d=n.strides[1],h=[o,eh(u,f,c,n.padding),eh(s,d,l,n.padding),n.filters];"channelsLast"!==n.dataFormat&&(t=ii.transpose(t,[0,2,3,1]));var p=ii.conv2dTranspose(t,n.kernel.read(),h,n.strides,n.padding);return"channelsLast"!==n.dataFormat&&(p=ii.transpose(p,[0,3,1,2])),null!=n.bias&&(p=zc(p,n.bias.read(),n.dataFormat)),null!=n.activation&&(p=n.activation.apply(p)),p}))}},{key:"computeOutputShape",value:function(e){var t,n,r,a=(e=hl(e)).slice();"channelsFirst"===this.dataFormat?(t=1,n=2,r=3):(t=3,n=1,r=2);var i=this.kernelSize[0],o=this.kernelSize[1],u=this.strides[0],s=this.strides[1];return a[t]=this.filters,a[n]=eh(a[n],u,i,this.padding),a[r]=eh(a[r],s,o,this.padding),a}},{key:"getConfig",value:function(){var e=(0,rf.Z)((0,af.Z)(n.prototype),"getConfig",this).call(this);return delete e.dilationRate,e}}]),n}(sh);lh.className="Conv2DTranspose",ii.serialization.registerClass(lh);var fh=function(e){(0,M.Z)(n,e);var t=(0,O.Z)(n);function n(e){var r;if((0,D.Z)(this,n),(r=t.call(this,e)).inputSpec=[new bl({ndim:5})],"same"!==r.padding&&"valid"!==r.padding)throw new Is("Conv3DTranspose currently supports only padding modes 'same' "+"and 'valid', but received padding mode ".concat(r.padding));return r}return(0,F.Z)(n,[{key:"build",value:function(e){if(5!==(e=hl(e)).length)throw new Is("Input should have rank 5; Received input shape: "+JSON.stringify(e));var t="channelsFirst"===this.dataFormat?1:e.length-1;if(null==e[t])throw new Is("The channel dimension of the inputs should be defined. Found `None`.");var n=e[t],r=this.kernelSize.concat([this.filters,n]);this.kernel=this.addWeight("kernel",r,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new bl({ndim:5,axes:(0,it.Z)({},t,n)})],this.built=!0}},{key:"call",value:function(e,t){var n=this;return ii.tidy((function(){var t=dl(e);if(5!==t.shape.length)throw new Is("Conv3DTranspose.call() expects input tensor to be rank-4, but "+"received a tensor of rank-".concat(t.shape.length));var r,a,i,o=t.shape,u=o[0];"channelsFirst"===n.dataFormat?(i=2,r=3,a=4):(i=1,r=2,a=3);var s=o[i],c=o[r],l=o[a],f=n.kernelSize[0],d=n.kernelSize[1],h=n.kernelSize[2],p=n.strides[0],v=n.strides[1],m=n.strides[2],g=[u,eh(s,p,f,n.padding),eh(c,v,d,n.padding),eh(l,m,h,n.padding),n.filters];"channelsLast"!==n.dataFormat&&(t=ii.transpose(t,[0,2,3,4,1]));var y=ii.conv3dTranspose(t,n.kernel.read(),g,n.strides,n.padding);return"channelsLast"!==n.dataFormat&&(y=ii.transpose(y,[0,4,1,2,3])),null!==n.bias&&(y=zc(y,n.bias.read(),n.dataFormat)),null!==n.activation&&(y=n.activation.apply(y)),y}))}},{key:"computeOutputShape",value:function(e){var t,n,r,a,i=(e=hl(e)).slice();"channelsFirst"===this.dataFormat?(t=1,n=2,r=3,a=4):(t=4,n=1,r=2,a=3);var o=this.kernelSize[0],u=this.kernelSize[1],s=this.kernelSize[2],c=this.strides[0],l=this.strides[1],f=this.strides[2];return i[t]=this.filters,i[n]=eh(i[n],c,o,this.padding),i[r]=eh(i[r],l,u,this.padding),i[a]=eh(i[a],f,s,this.padding),i}},{key:"getConfig",value:function(){var e=(0,rf.Z)((0,af.Z)(n.prototype),"getConfig",this).call(this);return delete e.dilationRate,e}}]),n}(ch);fh.className="Conv3DTranspose",ii.serialization.registerClass(fh);var dh=function(e){(0,M.Z)(n,e);var t=(0,O.Z)(n);function n(e,r){var a;if((0,D.Z)(this,n),(a=t.call(this,e,r)).DEFAULT_DEPTHWISE_INITIALIZER="glorotUniform",a.DEFAULT_POINTWISE_INITIALIZER="glorotUniform",a.depthwiseKernel=null,a.pointwiseKernel=null,null==r.filters)throw new Is("The `filters` configuration field is required by SeparableConv, but is unspecified.");if(null!=r.kernelInitializer||null!=r.kernelRegularizer||null!=r.kernelConstraint)throw new Is("Fields kernelInitializer, kernelRegularizer and kernelConstraint are invalid for SeparableConv2D. Use depthwiseInitializer, depthwiseRegularizer, depthwiseConstraint, pointwiseInitializer, pointwiseRegularizer and pointwiseConstraint instead.");if(null!=r.padding&&"same"!==r.padding&&"valid"!==r.padding)throw new Is("SeparableConv".concat(a.rank,"D supports only padding modes: ")+"'same' and 'valid', but received ".concat(JSON.stringify(r.padding)));return a.depthMultiplier=null==r.depthMultiplier?1:r.depthMultiplier,a.depthwiseInitializer=cl(r.depthwiseInitializer||a.DEFAULT_DEPTHWISE_INITIALIZER),a.depthwiseRegularizer=qd(r.depthwiseRegularizer),a.depthwiseConstraint=ql(r.depthwiseConstraint),a.pointwiseInitializer=cl(r.depthwiseInitializer||a.DEFAULT_POINTWISE_INITIALIZER),a.pointwiseRegularizer=qd(r.pointwiseRegularizer),a.pointwiseConstraint=ql(r.pointwiseConstraint),a}return(0,F.Z)(n,[{key:"build",value:function(e){if((e=hl(e)).length<this.rank+2)throw new Is("Inputs to SeparableConv".concat(this.rank,"D should have rank ")+"".concat(this.rank+2,", but received input shape: ")+"".concat(JSON.stringify(e)));var t="channelsFirst"===this.dataFormat?1:e.length-1;if(null==e[t]||e[t]<0)throw new Is("The channel dimension of the inputs should be defined, "+"but found ".concat(JSON.stringify(e[t])));for(var n=e[t],r=this.kernelSize.concat([n,this.depthMultiplier]),a=[],i=0;i<this.rank;++i)a.push(1);a.push(n*this.depthMultiplier,this.filters);var o=!0;this.depthwiseKernel=this.addWeight("depthwise_kernel",r,"float32",this.depthwiseInitializer,this.depthwiseRegularizer,o,this.depthwiseConstraint),this.pointwiseKernel=this.addWeight("pointwise_kernel",a,"float32",this.pointwiseInitializer,this.pointwiseRegularizer,o,this.pointwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,o,this.biasConstraint):this.bias=null,this.inputSpec=[new bl({ndim:this.rank+2,axes:(0,it.Z)({},t,n)})],this.built=!0}},{key:"call",value:function(e,t){var n=this;return(0,ii.tidy)((function(){var t;if(e=dl(e),1===n.rank)throw new Ds("1D separable convolution is not implemented yet.");return 2===n.rank&&("channelsFirst"===n.dataFormat&&(e=ii.transpose(e,[0,2,3,1])),t=ii.separableConv2d(e,n.depthwiseKernel.read(),n.pointwiseKernel.read(),n.strides,n.padding,n.dilationRate,"NHWC")),n.useBias&&(t=zc(t,n.bias.read(),n.dataFormat)),null!=n.activation&&(t=n.activation.apply(t)),"channelsFirst"===n.dataFormat&&(t=ii.transpose(t,[0,3,1,2])),t}))}},{key:"getConfig",value:function(){var e=(0,rf.Z)((0,af.Z)(n.prototype),"getConfig",this).call(this);return delete e.rank,delete e.kernelInitializer,delete e.kernelRegularizer,delete e.kernelConstraint,e.depthwiseInitializer=sl(this.depthwiseInitializer),e.pointwiseInitializer=sl(this.pointwiseInitializer),e.depthwiseRegularizer=Wd(this.depthwiseRegularizer),e.pointwiseRegularizer=Wd(this.pointwiseRegularizer),e.depthwiseConstraint=Wl(this.depthwiseConstraint),e.pointwiseConstraint=Wl(this.pointwiseConstraint),e}}]),n}(uh);dh.className="SeparableConv";var hh=function(e){(0,M.Z)(n,e);var t=(0,O.Z)(n);function n(e){return(0,D.Z)(this,n),t.call(this,2,e)}return(0,F.Z)(n)}(dh);hh.className="SeparableConv2D",ii.serialization.registerClass(hh);var ph=function(e){(0,M.Z)(n,e);var t=(0,O.Z)(n);function n(e){var r;return(0,D.Z)(this,n),r=t.call(this,1,e),n.verifyArgs(e),r.inputSpec=[{ndim:3}],r}return(0,F.Z)(n,[{key:"getConfig",value:function(){var e=(0,rf.Z)((0,af.Z)(n.prototype),"getConfig",this).call(this);return delete e.rank,delete e.dataFormat,e}}],[{key:"verifyArgs",value:function(e){if("number"!==typeof e.kernelSize&&!Ks(e.kernelSize,"number",1,1))throw new Is("Conv1D expects config.kernelSize to be number or number[] with "+"length 1, but received ".concat(JSON.stringify(e.kernelSize),"."))}}]),n}(uh);ph.className="Conv1D",ii.serialization.registerClass(ph);var vh=function(e){(0,M.Z)(n,e);var t=(0,O.Z)(n);function n(e){var r;return(0,D.Z)(this,n),r=t.call(this,e),"number"===typeof e.cropping?r.cropping=[[e.cropping,e.cropping],[e.cropping,e.cropping]]:"number"===typeof e.cropping[0]?r.cropping=[[e.cropping[0],e.cropping[0]],[e.cropping[1],e.cropping[1]]]:r.cropping=e.cropping,r.dataFormat=void 0===e.dataFormat?"channelsLast":e.dataFormat,r.inputSpec=[{ndim:4}],r}return(0,F.Z)(n,[{key:"computeOutputShape",value:function(e){return"channelsFirst"===this.dataFormat?[e[0],e[1],e[2]-this.cropping[0][0]-this.cropping[0][1],e[3]-this.cropping[1][0]-this.cropping[1][1]]:[e[0],e[1]-this.cropping[0][0]-this.cropping[0][1],e[2]-this.cropping[1][0]-this.cropping[1][1],e[3]]}},{key:"call",value:function(e,t){var n=this;return(0,ii.tidy)((function(){if(e=dl(e),"channelsLast"===n.dataFormat){var t=Tc(e,n.cropping[0][0],e.shape[1]-n.cropping[0][0]-n.cropping[0][1],2);return Tc(t,n.cropping[1][0],e.shape[2]-n.cropping[1][1]-n.cropping[1][0],3)}var r=Tc(e,n.cropping[0][0],e.shape[2]-n.cropping[0][0]-n.cropping[0][1],3);return Tc(r,n.cropping[1][0],e.shape[3]-n.cropping[1][1]-n.cropping[1][0],4)}))}},{key:"getConfig",value:function(){var e={cropping:this.cropping,dataFormat:this.dataFormat},t=(0,rf.Z)((0,af.Z)(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(Sl);vh.className="Cropping2D",ii.serialization.registerClass(vh);var mh=function(e){(0,M.Z)(n,e);var t=(0,O.Z)(n);function n(e){var r,a;return(0,D.Z)(this,n),(r=t.call(this,e)).DEFAULT_SIZE=[2,2],r.inputSpec=[{ndim:4}],r.size=null==e.size?r.DEFAULT_SIZE:e.size,r.dataFormat=null==e.dataFormat?"channelsLast":e.dataFormat,cc(r.dataFormat),r.interpolation=null==e.interpolation?"nearest":e.interpolation,a=r.interpolation,Xs(ac,"InterpolationFormat",a),r}return(0,F.Z)(n,[{key:"computeOutputShape",value:function(e){if("channelsFirst"===this.dataFormat){var t=null==e[2]?null:this.size[0]*e[2],n=null==e[3]?null:this.size[1]*e[3];return[e[0],e[1],t,n]}var r=null==e[1]?null:this.size[0]*e[1],a=null==e[2]?null:this.size[1]*e[2];return[e[0],r,a,e[3]]}},{key:"call",value:function(e,t){var n=this;return ii.tidy((function(){var t=dl(e),r=t.shape;if("channelsFirst"===n.dataFormat){t=ii.transpose(t,[0,2,3,1]);var a=n.size[0]*r[2],i=n.size[1]*r[3],o="nearest"===n.interpolation?ii.image.resizeNearestNeighbor(t,[a,i]):ii.image.resizeBilinear(t,[a,i]);return ii.transpose(o,[0,3,1,2])}var u=n.size[0]*r[1],s=n.size[1]*r[2];return"nearest"===n.interpolation?ii.image.resizeNearestNeighbor(t,[u,s]):ii.image.resizeBilinear(t,[u,s])}))}},{key:"getConfig",value:function(){var e={size:this.size,dataFormat:this.dataFormat,interpolation:this.interpolation},t=(0,rf.Z)((0,af.Z)(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(Sl);mh.className="UpSampling2D",ii.serialization.registerClass(mh);var gh=function(e){(0,M.Z)(n,e);var t=(0,O.Z)(n);function n(e){var r;return(0,D.Z)(this,n),(r=t.call(this,2,e)).depthwiseKernel=null,r.depthMultiplier=null==e.depthMultiplier?1:e.depthMultiplier,r.depthwiseInitializer=cl(e.depthwiseInitializer||r.DEFAULT_KERNEL_INITIALIZER),r.depthwiseConstraint=ql(e.depthwiseConstraint),r.depthwiseRegularizer=qd(e.depthwiseRegularizer),r}return(0,F.Z)(n,[{key:"build",value:function(e){if((e=hl(e)).length<4)throw new Is("Inputs to DepthwiseConv2D should have rank 4. "+"Received input shape: ".concat(JSON.stringify(e),"."));var t="channelsFirst"===this.dataFormat?1:3;if(null==e[t]||e[t]<0)throw new Is("The channel dimension of the inputs to DepthwiseConv2D should "+"be defined, but is not (".concat(e[t],")."));var n=e[t],r=[this.kernelSize[0],this.kernelSize[1],n,this.depthMultiplier];this.depthwiseKernel=this.addWeight("depthwise_kernel",r,null,this.depthwiseInitializer,this.depthwiseRegularizer,!0,this.depthwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[n*this.depthMultiplier],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}},{key:"call",value:function(e,t){var n=this;return(0,ii.tidy)((function(){var t=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[1,1],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"valid",a=arguments.length>4?arguments[4]:void 0,i=arguments.length>5?arguments[5]:void 0;return(0,ii.tidy)((function(){null==a&&(a="channelsLast"),cc(a);var o=th(e,a);if(4!==e.rank)throw new Is("Input for depthwiseConv2d is required to be 4-D, but is instead "+"".concat(e.rank,"-D"));if(4!==t.rank)throw new Is("depthwiseKernel is required to be 4-D, but is instead "+"".concat(t.rank,"-D"));return o=ii.depthwiseConv2d(o,t,n,"same"===r?"same":"valid","NHWC",i),"channelsFirst"===a&&(o=ii.transpose(o,[0,3,1,2])),o}))}(e=dl(e),n.depthwiseKernel.read(),n.strides,n.padding,n.dataFormat,null);return n.useBias&&(t=zc(t,n.bias.read(),n.dataFormat)),null!=n.activation&&(t=n.activation.apply(t)),t}))}},{key:"computeOutputShape",value:function(e){e=hl(e);var t="channelsFirst"===this.dataFormat?e[2]:e[1],n="channelsFirst"===this.dataFormat?e[3]:e[2],r="channelsFirst"===this.dataFormat?e[1]*this.depthMultiplier:e[3]*this.depthMultiplier,a=Jd(t,this.kernelSize[0],this.padding,this.strides[0]),i=Jd(n,this.kernelSize[1],this.padding,this.strides[1]);return"channelsFirst"===this.dataFormat?[e[0],r,a,i]:[e[0],a,i,r]}},{key:"getConfig",value:function(){var e=(0,rf.Z)((0,af.Z)(n.prototype),"getConfig",this).call(this);return e.depthMultiplier=this.depthMultiplier,e.depthwiseInitializer=sl(this.depthwiseInitializer),e.depthwiseRegularizer=Wd(this.depthwiseRegularizer),e.depthwiseConstraint=Wl(this.depthwiseRegularizer),e}}]),n}(oh);function yh(e,t,n,r){if(Array.isArray(e)){if(null!=t||null!=n)throw new Is("When inputs is an array, neither initialState or constants should be provided");null!=r&&(n=e.slice(e.length-r,e.length),e=e.slice(0,e.length-r)),e.length>1&&(t=e.slice(1,e.length)),e=e[0]}function a(e){return null==e||Array.isArray(e)?e:[e]}return{inputs:e,initialState:t=a(t),constants:n=a(n)}}function bh(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=arguments.length>4?arguments[4]:void 0,i=arguments.length>5?arguments[5]:void 0,o=arguments.length>6&&void 0!==arguments[6]&&arguments[6],u=arguments.length>7&&void 0!==arguments[7]&&arguments[7];return ii.tidy((function(){var s=t.shape.length;if(s<3)throw new Is("Input should be at least 3D, but is ".concat(s,"D."));var c=[1,0].concat(kc(2,s));if(t=ii.transpose(t,c),null!=i)throw new Ds("The rnn() functoin of the deeplearn.js backend does not support constants yet.");o&&console.warn("Backend rnn(): the unroll = true option is not applicable to the imperative deeplearn.js backend."),null!=a&&((a=ii.cast(ii.cast(a,"bool"),"float32")).rank===s-1&&(a=ii.expandDims(a,-1)),a=ii.transpose(a,c)),r&&(t=ii.reverse(t,0),null!=a&&(a=ii.reverse(a,0)));var l,f,d=[],h=n,p=t.shape[0],v=ii.unstack(t);null!=a&&(f=ii.unstack(a));for(var m,g=function(t){var n=v[t],r=ii.tidy((function(){return e(n,h)}));if(null==a)l=r[0],h=r[1];else{var i=ii.tidy((function(){var e=f[t],n=ii.sub(ii.onesLike(e),e);return{output:ii.add(ii.mul(r[0],e),ii.mul(h[0],n)),newStates:h.map((function(t,a){return ii.add(ii.mul(r[1][a],e),ii.mul(t,n))}))}}));l=i.output,h=i.newStates}u&&d.push(l)},y=0;y<p;++y)g(y);if(u){m=ii.stack(d,1)}return[l,m,h]}))}gh.className="DepthwiseConv2D",ii.serialization.registerClass(gh);var xh=function(e){(0,M.Z)(n,e);var t=(0,O.Z)(n);function n(e){var r,a;if((0,D.Z)(this,n),r=t.call(this,e),null==e.cell)throw new Is("cell property is missing for the constructor of RNN.");if(null==(a=Array.isArray(e.cell)?new Nh({cells:e.cell}):e.cell).stateSize)throw new Is("The RNN cell should have an attribute `stateSize` (tuple of integers, one integer per RNN state).");return r.cell=a,r.returnSequences=null!=e.returnSequences&&e.returnSequences,r.returnState=null!=e.returnState&&e.returnState,r.goBackwards=null!=e.goBackwards&&e.goBackwards,r._stateful=null!=e.stateful&&e.stateful,r.unroll=null!=e.unroll&&e.unroll,r.supportsMasking=!0,r.inputSpec=[new bl({ndim:3})],r.stateSpec=null,r.states_=null,r.numConstants=null,r.keptStates=[],r}return(0,F.Z)(n,[{key:"getStates",value:function(){return null==this.states_?kc(0,Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1).map((function(e){return null})):this.states_}},{key:"setStates",value:function(e){this.states_=e}},{key:"computeOutputShape",value:function(e){ll(e)&&(e=e[0]);var t=this.cell.stateSize;Array.isArray(t)||(t=[t]);var n,r=t[0];if(n=this.returnSequences?[e[0],e[1],r]:[e[0],r],this.returnState){var a,i=[],o=(0,B.Z)(t);try{for(o.s();!(a=o.n()).done;){var u=a.value;i.push([e[0],u])}}catch(s){o.e(s)}finally{o.f()}return[n].concat(i)}return n}},{key:"computeMask",value:function(e,t){var n=this;return ii.tidy((function(){Array.isArray(t)&&(t=t[0]);var e=n.returnSequences?t:null;if(n.returnState){var r=n.states.map((function(e){return null}));return[e].concat(r)}return e}))}},{key:"states",get:function(){if(null==this.states_){for(var e=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1,t=[],n=0;n<e;++n)t.push(null);return t}return this.states_},set:function(e){this.states_=e}},{key:"build",value:function(e){if(null!=this.numConstants)throw new Ds("Constants support is not implemented in RNN yet.");ll(e)&&(e=e[0]);var t=this.stateful?e[0]:null,n=e.slice(2);this.inputSpec[0]=new bl({shape:[t,null].concat((0,I.Z)(n))});var r,a=[e[0]].concat(e.slice(2));if(this.cell.build(a),r=Array.isArray(this.cell.stateSize)?this.cell.stateSize:[this.cell.stateSize],null!=this.stateSpec){if(!ii.util.arraysEqual(this.stateSpec.map((function(e){return e.shape[e.shape.length-1]})),r))throw new Is("An initialState was passed that is not compatible with "+"cell.stateSize. Received stateSpec=".concat(this.stateSpec,"; ")+"However cell.stateSize is ".concat(this.cell.stateSize))}else this.stateSpec=r.map((function(e){return new bl({shape:[null,e]})}));this.stateful&&this.resetStates()}},{key:"resetStates",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];(0,ii.tidy)((function(){if(!t.stateful)throw new Ns("Cannot call resetStates() on an RNN Layer that is not stateful.");var r=t.inputSpec[0].shape[0];if(null==r)throw new Is("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(null==t.states_)Array.isArray(t.cell.stateSize)?t.states_=t.cell.stateSize.map((function(e){return ii.zeros([r,e])})):t.states_=[ii.zeros([r,t.cell.stateSize])];else if(null==e)ii.dispose(t.states_),null!=t.keptStates&&(ii.dispose(t.keptStates),t.keptStates=[]),Array.isArray(t.cell.stateSize)?t.states_=t.cell.stateSize.map((function(e){return ii.zeros([r,e])})):t.states_[0]=ii.zeros([r,t.cell.stateSize]);else{if(Array.isArray(e)||(e=[e]),e.length!==t.states_.length)throw new Is("Layer ".concat(t.name," expects ").concat(t.states_.length," state(s), ")+"but it received ".concat(e.length," state value(s). Input ")+"received: ".concat(e));!0===n?t.keptStates.push(t.states_.slice()):ii.dispose(t.states_);for(var a=0;a<t.states_.length;++a){var i=e[a],o=Array.isArray(t.cell.stateSize)?t.cell.stateSize[a]:t.cell.stateSize,u=[r,o];if(!ii.util.arraysEqual(i.shape,u))throw new Is("State ".concat(a," is incompatible with layer ").concat(t.name,": ")+"expected shape=".concat(u,", received shape=").concat(i.shape));t.states_[a]=i}}t.states_=t.states_.map((function(e){return ii.keep(e.clone())}))}))}},{key:"apply",value:function(e,t){var r=null==t?null:t.initialState,a=null==t?null:t.constants;null==t&&(t={});var i=yh(e,r,a,this.numConstants);e=i.inputs,r=i.initialState,a=i.constants;var o=[],u=[];if(null!=r){t.initialState=r,o=o.concat(r),this.stateSpec=[];var s,c=(0,B.Z)(r);try{for(c.s();!(s=c.n()).done;){var l=s.value;this.stateSpec.push(new bl({shape:l.shape}))}}catch(v){c.e(v)}finally{c.f()}u=u.concat(this.stateSpec)}if(null!=a&&(t.constants=a,o=o.concat(a),this.numConstants=a.length),o[0]instanceof xl){var f=[e].concat(o),d=this.inputSpec.concat(u),h=this.inputSpec;this.inputSpec=d;var p=(0,rf.Z)((0,af.Z)(n.prototype),"apply",this).call(this,f,t);return this.inputSpec=h,p}return(0,rf.Z)((0,af.Z)(n.prototype),"apply",this).call(this,e,t)}},{key:"call",value:function(e,t){var n=this;return(0,ii.tidy)((function(){var r=null==t?null:t.mask,a=null==t?null:t.training,i=null==t?null:t.initialState;e=dl(e),null==i&&(i=n.stateful?n.states_:n.getInitialState(e));var o=Array.isArray(n.cell.stateSize)?n.cell.stateSize.length:1;if(i.length!==o)throw new Is("RNN Layer has ".concat(o," state(s) but was passed ")+"".concat(i.length," initial state(s)."));n.unroll&&console.warn("Ignoring unroll = true for RNN layer, due to imperative backend.");var u={training:a},s=bh((function(e,t){var r=n.cell.call([e].concat(t),u);return[r[0],r.slice(1)]}),e,i,n.goBackwards,r,null,n.unroll,n.returnSequences),c=s[0],l=s[1],f=s[2];n.stateful&&n.resetStates(f,a);var d=n.returnSequences?l:c;return n.returnState?[d].concat(f):d}))}},{key:"getInitialState",value:function(e){var t=this;return(0,ii.tidy)((function(){var n=ii.zeros(e.shape);return n=Cc(n=ii.sum(n,[1,2])),Array.isArray(t.cell.stateSize)?t.cell.stateSize.map((function(e){return e>1?Fc(n,[1,e]):n})):t.cell.stateSize>1?[Fc(n,[1,t.cell.stateSize])]:[n]}))}},{key:"trainableWeights",get:function(){return this.trainable?this.cell.trainableWeights:[]}},{key:"nonTrainableWeights",get:function(){return this.trainable?this.cell.nonTrainableWeights:this.cell.weights}},{key:"setFastWeightInitDuringBuild",value:function(e){(0,rf.Z)((0,af.Z)(n.prototype),"setFastWeightInitDuringBuild",this).call(this,e),null!=this.cell&&this.cell.setFastWeightInitDuringBuild(e)}},{key:"getConfig",value:function(){var e=(0,rf.Z)((0,af.Z)(n.prototype),"getConfig",this).call(this),t={returnSequences:this.returnSequences,returnState:this.returnState,goBackwards:this.goBackwards,stateful:this.stateful,unroll:this.unroll};null!=this.numConstants&&(t.numConstants=this.numConstants);var r=this.cell.getConfig();return this.getClassName()===n.className&&(t.cell={className:this.cell.getClassName(),config:r}),Object.assign(Object.assign(Object.assign({},r),e),t)}}],[{key:"fromConfig",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=t.cell,a=of(r,n);return new e(Object.assign(t,{cell:a}))}}]),n}(Sl);xh.className="RNN",ii.serialization.registerClass(xh);var wh=function(e){(0,M.Z)(n,e);var t=(0,O.Z)(n);function n(){return(0,D.Z)(this,n),t.apply(this,arguments)}return(0,F.Z)(n)}(Sl),kh=function(e){(0,M.Z)(n,e);var t=(0,O.Z)(n);function n(e){var r;return(0,D.Z)(this,n),(r=t.call(this,e)).DEFAULT_ACTIVATION="tanh",r.DEFAULT_KERNEL_INITIALIZER="glorotNormal",r.DEFAULT_RECURRENT_INITIALIZER="orthogonal",r.DEFAULT_BIAS_INITIALIZER="zeros",r.units=e.units,Ys(r.units,"units"),r.activation=zd(null==e.activation?r.DEFAULT_ACTIVATION:e.activation),r.useBias=null==e.useBias||e.useBias,r.kernelInitializer=cl(e.kernelInitializer||r.DEFAULT_KERNEL_INITIALIZER),r.recurrentInitializer=cl(e.recurrentInitializer||r.DEFAULT_RECURRENT_INITIALIZER),r.biasInitializer=cl(e.biasInitializer||r.DEFAULT_BIAS_INITIALIZER),r.kernelRegularizer=qd(e.kernelRegularizer),r.recurrentRegularizer=qd(e.recurrentRegularizer),r.biasRegularizer=qd(e.biasRegularizer),r.kernelConstraint=ql(e.kernelConstraint),r.recurrentConstraint=ql(e.recurrentConstraint),r.biasConstraint=ql(e.biasConstraint),r.dropout=xc([1,wc([0,null==e.dropout?0:e.dropout])]),r.recurrentDropout=xc([1,wc([0,null==e.recurrentDropout?0:e.recurrentDropout])]),r.dropoutFunc=e.dropoutFunc,r.stateSize=r.units,r.dropoutMask=null,r.recurrentDropoutMask=null,r}return(0,F.Z)(n,[{key:"build",value:function(e){e=hl(e),this.kernel=this.addWeight("kernel",[e[e.length-1],this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}},{key:"call",value:function(e,t){var n=this;return(0,ii.tidy)((function(){if(2!==e.length)throw new Is("SimpleRNNCell expects 2 input Tensors, got ".concat(e.length,"."));var r=e[1];e=e[0];var a,i=null!=t.training&&t.training;0<n.dropout&&n.dropout<1&&null==n.dropoutMask&&(n.dropoutMask=Th({ones:function(){return ii.onesLike(e)},rate:n.dropout,training:i,dropoutFunc:n.dropoutFunc})),0<n.recurrentDropout&&n.recurrentDropout<1&&null==n.recurrentDropoutMask&&(n.recurrentDropoutMask=Th({ones:function(){return ii.onesLike(r)},rate:n.recurrentDropout,training:i,dropoutFunc:n.dropoutFunc}));var o=n.dropoutMask,u=n.recurrentDropoutMask;a=Oc(null!=o?ii.mul(e,o):e,n.kernel.read()),null!=n.bias&&(a=zc(a,n.bias.read())),null!=u&&(r=ii.mul(r,u));var s=ii.add(a,Oc(r,n.recurrentKernel.read()));return null!=n.activation&&(s=n.activation.apply(s)),[s,s]}))}},{key:"getConfig",value:function(){var e=(0,rf.Z)((0,af.Z)(n.prototype),"getConfig",this).call(this),t={units:this.units,activation:jd(this.activation),useBias:this.useBias,kernelInitializer:sl(this.kernelInitializer),recurrentInitializer:sl(this.recurrentInitializer),biasInitializer:sl(this.biasInitializer),kernelRegularizer:Wd(this.kernelRegularizer),recurrentRegularizer:Wd(this.recurrentRegularizer),biasRegularizer:Wd(this.biasRegularizer),activityRegularizer:Wd(this.activityRegularizer),kernelConstraint:Wl(this.kernelConstraint),recurrentConstraint:Wl(this.recurrentConstraint),biasConstraint:Wl(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout};return Object.assign(Object.assign({},e),t)}}]),n}(wh);kh.className="SimpleRNNCell",ii.serialization.registerClass(kh);var _h=function(e){(0,M.Z)(n,e);var t=(0,O.Z)(n);function n(e){return(0,D.Z)(this,n),e.cell=new kh(e),t.call(this,e)}return(0,F.Z)(n,[{key:"call",value:function(e,t){var r=this;return(0,ii.tidy)((function(){null!=r.cell.dropoutMask&&(ii.dispose(r.cell.dropoutMask),r.cell.dropoutMask=null),null!=r.cell.recurrentDropoutMask&&(ii.dispose(r.cell.recurrentDropoutMask),r.cell.recurrentDropoutMask=null);var a=null==t?null:t.mask,i=null==t?null:t.training,o=null==t?null:t.initialState;return(0,rf.Z)((0,af.Z)(n.prototype),"call",r).call(r,e,{mask:a,training:i,initialState:o})}))}}],[{key:"fromConfig",value:function(e,t){return new e(t)}}]),n}(xh);_h.className="SimpleRNN",ii.serialization.registerClass(_h);var Sh=function(e){(0,M.Z)(n,e);var t=(0,O.Z)(n);function n(e){var r;if((0,D.Z)(this,n),(r=t.call(this,e)).DEFAULT_ACTIVATION="tanh",r.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",r.DEFAULT_KERNEL_INITIALIZER="glorotNormal",r.DEFAULT_RECURRENT_INITIALIZER="orthogonal",r.DEFAULT_BIAS_INITIALIZER="zeros",e.resetAfter)throw new Is("GRUCell does not support reset_after parameter set to true.");return r.units=e.units,Ys(r.units,"units"),r.activation=zd(void 0===e.activation?r.DEFAULT_ACTIVATION:e.activation),r.recurrentActivation=zd(void 0===e.recurrentActivation?r.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),r.useBias=null==e.useBias||e.useBias,r.kernelInitializer=cl(e.kernelInitializer||r.DEFAULT_KERNEL_INITIALIZER),r.recurrentInitializer=cl(e.recurrentInitializer||r.DEFAULT_RECURRENT_INITIALIZER),r.biasInitializer=cl(e.biasInitializer||r.DEFAULT_BIAS_INITIALIZER),r.kernelRegularizer=qd(e.kernelRegularizer),r.recurrentRegularizer=qd(e.recurrentRegularizer),r.biasRegularizer=qd(e.biasRegularizer),r.kernelConstraint=ql(e.kernelConstraint),r.recurrentConstraint=ql(e.recurrentConstraint),r.biasConstraint=ql(e.biasConstraint),r.dropout=xc([1,wc([0,null==e.dropout?0:e.dropout])]),r.recurrentDropout=xc([1,wc([0,null==e.recurrentDropout?0:e.recurrentDropout])]),r.dropoutFunc=e.dropoutFunc,r.implementation=e.implementation,r.stateSize=r.units,r.dropoutMask=null,r.recurrentDropoutMask=null,r}return(0,F.Z)(n,[{key:"build",value:function(e){var t=(e=hl(e))[e.length-1];this.kernel=this.addWeight("kernel",[t,3*this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,3*this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[3*this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}},{key:"call",value:function(e,t){var n=this;return(0,ii.tidy)((function(){if(2!==e.length)throw new Is("GRUCell expects 2 input Tensors (inputs, h, c), got "+"".concat(e.length,"."));var r=null!=t.training&&t.training,a=e[1];e=e[0],0<n.dropout&&n.dropout<1&&null==n.dropoutMask&&(n.dropoutMask=Th({ones:function(){return ii.onesLike(e)},rate:n.dropout,training:r,count:3,dropoutFunc:n.dropoutFunc})),0<n.recurrentDropout&&n.recurrentDropout<1&&null==n.recurrentDropoutMask&&(n.recurrentDropoutMask=Th({ones:function(){return ii.onesLike(a)},rate:n.recurrentDropout,training:r,count:3,dropoutFunc:n.dropoutFunc}));var i,o,u,s=n.dropoutMask,c=n.recurrentDropoutMask;0<n.dropout&&n.dropout<1&&(e=ii.mul(e,s[0]));var l=Oc(e,n.kernel.read());n.useBias&&(l=zc(l,n.bias.read())),0<n.recurrentDropout&&n.recurrentDropout<1&&(a=ii.mul(a,c[0]));var f=n.recurrentKernel.read(),d=ii.split(f,[2*n.units,n.units],f.rank-1),h=(0,C.Z)(d,2),p=h[0],v=h[1],m=Oc(a,p),g=ii.split(l,3,l.rank-1),y=(0,C.Z)(g,3),b=y[0],x=y[1],w=y[2],k=ii.split(m,2,m.rank-1),_=(0,C.Z)(k,2),S=_[0],A=_[1];i=n.recurrentActivation.apply(ii.add(b,S)),o=n.recurrentActivation.apply(ii.add(x,A));var E=Oc(ii.mul(o,a),v);u=n.activation.apply(ii.add(w,E));var N=ii.add(ii.mul(i,a),ii.mul(ii.add(1,ii.neg(i)),u));return[N,N]}))}},{key:"getConfig",value:function(){var e=(0,rf.Z)((0,af.Z)(n.prototype),"getConfig",this).call(this),t={units:this.units,activation:jd(this.activation),recurrentActivation:jd(this.recurrentActivation),useBias:this.useBias,kernelInitializer:sl(this.kernelInitializer),recurrentInitializer:sl(this.recurrentInitializer),biasInitializer:sl(this.biasInitializer),kernelRegularizer:Wd(this.kernelRegularizer),recurrentRegularizer:Wd(this.recurrentRegularizer),biasRegularizer:Wd(this.biasRegularizer),activityRegularizer:Wd(this.activityRegularizer),kernelConstraint:Wl(this.kernelConstraint),recurrentConstraint:Wl(this.recurrentConstraint),biasConstraint:Wl(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation,resetAfter:!1};return Object.assign(Object.assign({},e),t)}}]),n}(wh);Sh.className="GRUCell",ii.serialization.registerClass(Sh);var Ch=function(e){(0,M.Z)(n,e);var t=(0,O.Z)(n);function n(e){return(0,D.Z)(this,n),0===e.implementation&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new Sh(e),t.call(this,e)}return(0,F.Z)(n,[{key:"call",value:function(e,t){var r=this;return(0,ii.tidy)((function(){null!=r.cell.dropoutMask&&(ii.dispose(r.cell.dropoutMask),r.cell.dropoutMask=null),null!=r.cell.recurrentDropoutMask&&(ii.dispose(r.cell.recurrentDropoutMask),r.cell.recurrentDropoutMask=null);var a=null==t?null:t.mask,i=null==t?null:t.training,o=null==t?null:t.initialState;return(0,rf.Z)((0,af.Z)(n.prototype),"call",r).call(r,e,{mask:a,training:i,initialState:o})}))}}],[{key:"fromConfig",value:function(e,t){return 0===t.implmentation&&(t.implementation=1),new e(t)}}]),n}(xh);Ch.className="GRU",ii.serialization.registerClass(Ch);var Ah=function(e){(0,M.Z)(n,e);var t=(0,O.Z)(n);function n(e){var r;return(0,D.Z)(this,n),(r=t.call(this,e)).DEFAULT_ACTIVATION="tanh",r.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",r.DEFAULT_KERNEL_INITIALIZER="glorotNormal",r.DEFAULT_RECURRENT_INITIALIZER="orthogonal",r.DEFAULT_BIAS_INITIALIZER="zeros",r.units=e.units,Ys(r.units,"units"),r.activation=zd(void 0===e.activation?r.DEFAULT_ACTIVATION:e.activation),r.recurrentActivation=zd(void 0===e.recurrentActivation?r.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),r.useBias=null==e.useBias||e.useBias,r.kernelInitializer=cl(e.kernelInitializer||r.DEFAULT_KERNEL_INITIALIZER),r.recurrentInitializer=cl(e.recurrentInitializer||r.DEFAULT_RECURRENT_INITIALIZER),r.biasInitializer=cl(e.biasInitializer||r.DEFAULT_BIAS_INITIALIZER),r.unitForgetBias=e.unitForgetBias,r.kernelRegularizer=qd(e.kernelRegularizer),r.recurrentRegularizer=qd(e.recurrentRegularizer),r.biasRegularizer=qd(e.biasRegularizer),r.kernelConstraint=ql(e.kernelConstraint),r.recurrentConstraint=ql(e.recurrentConstraint),r.biasConstraint=ql(e.biasConstraint),r.dropout=xc([1,wc([0,null==e.dropout?0:e.dropout])]),r.recurrentDropout=xc([1,wc([0,null==e.recurrentDropout?0:e.recurrentDropout])]),r.dropoutFunc=e.dropoutFunc,r.implementation=e.implementation,r.stateSize=[r.units,r.units],r.dropoutMask=null,r.recurrentDropoutMask=null,r}return(0,F.Z)(n,[{key:"build",value:function(e){var t,n,r=(e=hl(e))[e.length-1];if(this.kernel=this.addWeight("kernel",[r,4*this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,4*this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias){if(this.unitForgetBias){var a=this.biasInitializer,i=this.units;n=new(t=function(e){(0,M.Z)(n,e);var t=(0,O.Z)(n);function n(){return(0,D.Z)(this,n),t.apply(this,arguments)}return(0,F.Z)(n,[{key:"apply",value:function(e,t){var n=a.apply([i]),r=(new Gc).apply([i]),o=a.apply([2*i]);return Dc(Dc(n,r),o)}}]),n}(Vc),t.className="CustomInit",t)}else n=this.biasInitializer;this.bias=this.addWeight("bias",[4*this.units],null,n,this.biasRegularizer,!0,this.biasConstraint)}else this.bias=null;this.built=!0}},{key:"call",value:function(e,t){var n=this;return(0,ii.tidy)((function(){var r=null!=t.training&&t.training;if(3!==e.length)throw new Is("LSTMCell expects 3 input Tensors (inputs, h, c), got "+"".concat(e.length,"."));var a=e[1],i=e[2];e=e[0],0<n.dropout&&n.dropout<1&&null==n.dropoutMask&&(n.dropoutMask=Th({ones:function(){return ii.onesLike(e)},rate:n.dropout,training:r,count:4,dropoutFunc:n.dropoutFunc})),0<n.recurrentDropout&&n.recurrentDropout<1&&null==n.recurrentDropoutMask&&(n.recurrentDropoutMask=Th({ones:function(){return ii.onesLike(a)},rate:n.recurrentDropout,training:r,count:4,dropoutFunc:n.dropoutFunc}));var o,u,s,c,l=n.dropoutMask,f=n.recurrentDropoutMask;0<n.dropout&&n.dropout<1&&(e=ii.mul(e,l[0]));var d=Oc(e,n.kernel.read());0<n.recurrentDropout&&n.recurrentDropout<1&&(a=ii.mul(a,f[0])),d=ii.add(d,Oc(a,n.recurrentKernel.read())),n.useBias&&(d=zc(d,n.bias.read()));var h=ii.split(d,4,d.rank-1),p=(0,C.Z)(h,4),v=p[0],m=p[1],g=p[2],y=p[3];o=n.recurrentActivation.apply(v),u=n.recurrentActivation.apply(m),s=ii.add(ii.mul(u,i),ii.mul(o,n.activation.apply(g))),c=n.recurrentActivation.apply(y);var b=ii.mul(c,n.activation.apply(s));return[b,b,s]}))}},{key:"getConfig",value:function(){var e=(0,rf.Z)((0,af.Z)(n.prototype),"getConfig",this).call(this),t={units:this.units,activation:jd(this.activation),recurrentActivation:jd(this.recurrentActivation),useBias:this.useBias,kernelInitializer:sl(this.kernelInitializer),recurrentInitializer:sl(this.recurrentInitializer),biasInitializer:sl(this.biasInitializer),unitForgetBias:this.unitForgetBias,kernelRegularizer:Wd(this.kernelRegularizer),recurrentRegularizer:Wd(this.recurrentRegularizer),biasRegularizer:Wd(this.biasRegularizer),activityRegularizer:Wd(this.activityRegularizer),kernelConstraint:Wl(this.kernelConstraint),recurrentConstraint:Wl(this.recurrentConstraint),biasConstraint:Wl(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation};return Object.assign(Object.assign({},e),t)}}]),n}(wh);Ah.className="LSTMCell",ii.serialization.registerClass(Ah);var Eh=function(e){(0,M.Z)(n,e);var t=(0,O.Z)(n);function n(e){return(0,D.Z)(this,n),0===e.implementation&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new Ah(e),t.call(this,e)}return(0,F.Z)(n,[{key:"call",value:function(e,t){var r=this;return(0,ii.tidy)((function(){null!=r.cell.dropoutMask&&(ii.dispose(r.cell.dropoutMask),r.cell.dropoutMask=null),null!=r.cell.recurrentDropoutMask&&(ii.dispose(r.cell.recurrentDropoutMask),r.cell.recurrentDropoutMask=null);var a=null==t?null:t.mask,i=null==t?null:t.training,o=null==t?null:t.initialState;return(0,rf.Z)((0,af.Z)(n.prototype),"call",r).call(r,e,{mask:a,training:i,initialState:o})}))}}],[{key:"fromConfig",value:function(e,t){return 0===t.implmentation&&(t.implementation=1),new e(t)}}]),n}(xh);Eh.className="LSTM",ii.serialization.registerClass(Eh);var Nh=function(e){(0,M.Z)(n,e);var t=(0,O.Z)(n);function n(e){var r;return(0,D.Z)(this,n),(r=t.call(this,e)).cells=e.cells,r}return(0,F.Z)(n,[{key:"stateSize",get:function(){var e,t=[],n=(0,B.Z)(this.cells.slice().reverse());try{for(n.s();!(e=n.n()).done;){var r=e.value;Array.isArray(r.stateSize)?t.push.apply(t,(0,I.Z)(r.stateSize)):t.push(r.stateSize)}}catch(a){n.e(a)}finally{n.f()}return t}},{key:"call",value:function(e,t){var n=this;return(0,ii.tidy)((function(){var r,a=e.slice(1),i=[],o=(0,B.Z)(n.cells.slice().reverse());try{for(o.s();!(r=o.n()).done;){var u=r.value;Array.isArray(u.stateSize)?i.push(a.splice(0,u.stateSize.length)):i.push(a.splice(0,1))}}catch(m){o.e(m)}finally{o.f()}i.reverse();for(var s,c=[],l=0;l<n.cells.length;++l){var f=n.cells[l];a=i[l],s=0===l?[e[0]].concat(a):[s[0]].concat(a),s=f.call(s,t),c.push(s.slice(1))}a=[];var d,h=(0,B.Z)(c.slice().reverse());try{for(h.s();!(d=h.n()).done;){var p,v=d.value;(p=a).push.apply(p,(0,I.Z)(v))}}catch(m){h.e(m)}finally{h.f()}return[s[0]].concat(a)}))}},{key:"build",value:function(e){var t;ll(e)&&(e=e[0]),this.cells.forEach((function(n,r){hc("RNNCell_".concat(r),(function(){n.build(e),t=Array.isArray(n.stateSize)?n.stateSize[0]:n.stateSize,e=[e[0],t]}))})),this.built=!0}},{key:"getConfig",value:function(){var e=(0,rf.Z)((0,af.Z)(n.prototype),"getConfig",this).call(this),t={cells:this.cells.map((function(e){return{className:e.getClassName(),config:e.getConfig()}}))};return Object.assign(Object.assign({},e),t)}},{key:"trainableWeights",get:function(){if(!this.trainable)return[];var e,t=[],n=(0,B.Z)(this.cells);try{for(n.s();!(e=n.n()).done;){var r=e.value;t.push.apply(t,(0,I.Z)(r.trainableWeights))}}catch(a){n.e(a)}finally{n.f()}return t}},{key:"nonTrainableWeights",get:function(){var e,t=[],n=(0,B.Z)(this.cells);try{for(n.s();!(e=n.n()).done;){var r=e.value;t.push.apply(t,(0,I.Z)(r.nonTrainableWeights))}}catch(s){n.e(s)}finally{n.f()}if(!this.trainable){var a,i=[],o=(0,B.Z)(this.cells);try{for(o.s();!(a=o.n()).done;){var u=a.value;i.push.apply(i,(0,I.Z)(u.trainableWeights))}}catch(s){o.e(s)}finally{o.f()}return i.concat(t)}return t}},{key:"getWeights",value:function(){var e,t=[],n=(0,B.Z)(this.cells);try{for(n.s();!(e=n.n()).done;){var r=e.value;t.push.apply(t,(0,I.Z)(r.weights))}}catch(a){n.e(a)}finally{n.f()}return gl(t)}},{key:"setWeights",value:function(e){var t,n=[],r=(0,B.Z)(this.cells);try{for(r.s();!(t=r.n()).done;)for(var a=t.value,i=a.weights.length,o=e.splice(i),u=0;u<a.weights.length;++u)n.push([a.weights[u],o[u]])}catch(s){r.e(s)}finally{r.f()}yl(n)}}],[{key:"fromConfig",value:function(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=[],i=(0,B.Z)(t.cells);try{for(i.s();!(n=i.n()).done;){var o=n.value;a.push(of(o,r))}}catch(u){i.e(u)}finally{i.f()}return new e({cells:a})}}]),n}(wh);function Th(e){var t=e.ones,n=e.rate,r=e.training,a=void 0!==r&&r,i=e.count,o=void 0===i?1:i,u=e.dropoutFunc,s=function(){return null!=u?u(t(),n):Lc(t(),n)},c=function(){return Pc(s,t,a)};return!o||o<=1?ii.keep(c().clone()):Array(o).fill(void 0).map(c).map((function(e){return ii.keep(e.clone())}))}Nh.className="StackedRNNCells",ii.serialization.registerClass(Nh);var Ih=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]])}return n},Dh=function(e){(0,M.Z)(n,e);var t=(0,O.Z)(n);function n(e){var r;if((0,D.Z)(this,n),e.unroll)throw new Ds("Unrolling is not possible with convolutional RNNs.");if(Array.isArray(e.cell))throw new Ds("It is not possible at the moment to stack convolutional cells.");return(r=t.call(this,e)).inputSpec=[new bl({ndim:5})],r}return(0,F.Z)(n,[{key:"call",value:function(e,t){var r=this;return ii.tidy((function(){if(null!=r.cell.dropoutMask&&(ii.dispose(r.cell.dropoutMask),r.cell.dropoutMask=null),null!=r.cell.recurrentDropoutMask&&(ii.dispose(r.cell.recurrentDropoutMask),r.cell.recurrentDropoutMask=null),t&&t.constants)throw new Is("ConvRNN2D cell does not support constants");var a=null==t?null:t.mask,i=null==t?null:t.training,o=null==t?null:t.initialState;return(0,rf.Z)((0,af.Z)(n.prototype),"call",r).call(r,e,{mask:a,training:i,initialState:o})}))}},{key:"computeOutputShape",value:function(e){var t=this.computeSingleOutputShape(e);return this.returnSequences||(t=[t[0]].concat((0,I.Z)(t.slice(2)))),this.returnState&&(t=[t].concat((0,I.Z)(Array(2).fill([e[0]].concat((0,I.Z)(t.slice(-3))))))),t}},{key:"getInitialState",value:function(e){var t=this;return ii.tidy((function(){var n=t.cell.stateSize,r=e.shape,a=t.computeSingleOutputShape(r),i=[a[0]].concat((0,I.Z)(a.slice(2))),o=ii.zeros(i);return Array.isArray(n)?Array(n.length).fill(o):[o]}))}},{key:"resetStates",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];ii.tidy((function(){if(!t.stateful)throw new Ns("Cannot call resetStates() on an RNN Layer that is not stateful.");var r=t.inputSpec[0].shape,a=t.computeSingleOutputShape(r),i=[a[0]].concat((0,I.Z)(a.slice(2)));if(null==r[0])throw new Is("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(null==t.getStates())Array.isArray(t.cell.stateSize)?t.states_=t.cell.stateSize.map((function(){return ii.zeros(i)})):t.states_=[ii.zeros(i)];else if(null==e)ii.dispose(t.states_),null!=t.keptStates&&(ii.dispose(t.keptStates),t.keptStates=[]),Array.isArray(t.cell.stateSize)?t.states_=t.cell.stateSize.map((function(){return ii.zeros(i)})):t.states_[0]=ii.zeros(i);else{if(Array.isArray(e)||(e=[e]),e.length!==t.states_.length)throw new Is("Layer ".concat(t.name," expects ").concat(t.states_.length," state(s), ")+"but it received ".concat(e.length," state value(s). Input ")+"received: ".concat(e));n?t.keptStates.push(t.states_.slice()):ii.dispose(t.states_);for(var o=0;o<t.states_.length;++o){var u=e[o],s=i;if(!ii.util.arraysEqual(u.shape,s))throw new Is("State ".concat(o," is incompatible with layer ").concat(t.name,": ")+"expected shape=".concat(s,", received shape=").concat(u.shape));t.states_[o]=u}}t.states_=t.states_.map((function(e){return ii.keep(e.clone())}))}))}},{key:"computeSingleOutputShape",value:function(e){var t=this.cell,n=t.dataFormat,r=t.filters,a=t.kernelSize,i=t.padding,o=t.strides,u=t.dilationRate,s="channelsFirst"===n,c=e[s?3:2],l=e[s?4:3],f=Jd(c,a[0],i,o[0],u[0]),d=Jd(l,a[1],i,o[1],u[1]);return[].concat((0,I.Z)(e.slice(0,2)),(0,I.Z)(s?[r,f,d]:[f,d,r]))}}]),n}(xh);Dh.className="ConvRNN2D";var Fh=function(e){(0,M.Z)(n,e);var t=(0,O.Z)(n);function n(e){var r;(0,D.Z)(this,n);var a=e.filters,i=e.kernelSize,o=e.strides,u=e.padding,s=e.dataFormat,c=e.dilationRate;return(r=t.call(this,Object.assign(Object.assign({},e),{units:a}))).filters=a,Ys(r.filters,"filters"),r.kernelSize=Qd(i,2,"kernelSize"),r.kernelSize.forEach((function(e){return Ys(e,"kernelSize")})),r.strides=Qd(o||1,2,"strides"),r.strides.forEach((function(e){return Ys(e,"strides")})),r.padding=u||"valid",lc(r.padding),r.dataFormat=s||"channelsLast",cc(r.dataFormat),r.dilationRate=Qd(c||1,2,"dilationRate"),r.dilationRate.forEach((function(e){return Ys(e,"dilationRate")})),r}return(0,F.Z)(n,[{key:"build",value:function(e){var t;e=hl(e);var n="channelsFirst"===this.dataFormat?1:e.length-1;if(null==e[n])throw new Is("The channel dimension of the input should be defined. "+"Found ".concat(e[n]));var r=e[n],a=this.kernelSize.concat([r,4*this.filters]);this.kernel=this.addWeight("kernel",a,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint);var i=this.kernelSize.concat([this.filters,4*this.filters]);if(this.recurrentKernel=this.addWeight("recurrent_kernel",i,null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias){var o;if(this.unitForgetBias){var u=this.biasInitializer,s=this.filters;o=new(t=function(e){(0,M.Z)(n,e);var t=(0,O.Z)(n);function n(){return(0,D.Z)(this,n),t.apply(this,arguments)}return(0,F.Z)(n,[{key:"apply",value:function(e,t){return Ic([u.apply([s]),ii.ones([s]),u.apply([2*s])])}}]),n}(Vc),t.className="CustomInit",t)}else o=this.biasInitializer;this.bias=this.addWeight("bias",[4*this.filters],null,o,this.biasRegularizer,!0,this.biasConstraint)}this.built=!0}},{key:"call",value:function(e,t){var n=this;return ii.tidy((function(){if(3!==e.length)throw new Is("ConvLSTM2DCell expects 3 input Tensors (inputs, h, c), got "+"".concat(e.length,"."));var r=t.training||!1,a=e[0],i=e[1],o=e[2];0<n.dropout&&n.dropout<1&&null==n.dropoutMask&&(n.dropoutMask=Th({ones:function(){return ii.onesLike(a)},rate:n.dropout,training:r,count:4,dropoutFunc:n.dropoutFunc}));var u=n.dropoutMask,s=function(e,t,n){return t&&t[n]?ii.mul(t[n],e):e},c=s(a,u,0),l=s(a,u,1),f=s(a,u,2),d=s(a,u,3);0<n.recurrentDropout&&n.recurrentDropout<1&&null==n.recurrentDropoutMask&&(n.recurrentDropoutMask=Th({ones:function(){return ii.onesLike(i)},rate:n.recurrentDropout,training:r,count:4,dropoutFunc:n.dropoutFunc}));var h=n.recurrentDropoutMask,p=s(i,h,0),v=s(i,h,1),m=s(i,h,2),g=s(i,h,3),y=ii.split(n.kernel.read(),4,3),b=(0,C.Z)(y,4),x=b[0],w=b[1],k=b[2],_=b[3],S=n.useBias?ii.split(n.bias.read(),4):[null,null,null,null],A=(0,C.Z)(S,4),E=A[0],N=A[1],T=A[2],I=A[3];c=n.inputConv(c,x,E,n.padding),l=n.inputConv(l,w,N,n.padding),f=n.inputConv(f,k,T,n.padding),d=n.inputConv(d,_,I,n.padding);var D=ii.split(n.recurrentKernel.read(),4,3),F=(0,C.Z)(D,4),M=F[0],O=F[1],R=F[2],j=F[3];p=n.recurrentConv(p,M),v=n.recurrentConv(v,O),m=n.recurrentConv(m,R),g=n.recurrentConv(g,j);var B=n.recurrentActivation.apply(ii.add(c,p)),z=n.recurrentActivation.apply(ii.add(l,v)),Z=ii.add(ii.mul(z,o),ii.mul(B,n.activation.apply(ii.add(f,m)))),L=ii.mul(n.recurrentActivation.apply(ii.add(d,g)),n.activation.apply(Z));return[L,L,Z]}))}},{key:"getConfig",value:function(){var e=(0,rf.Z)((0,af.Z)(n.prototype),"getConfig",this).call(this),t=(e.units,Ih(e,["units"])),r={filters:this.filters,kernelSize:this.kernelSize,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,strides:this.strides};return Object.assign(Object.assign({},t),r)}},{key:"inputConv",value:function(e,t,n,r){var a=ii.conv2d(e,t,this.strides,r||"valid","channelsFirst"===this.dataFormat?"NCHW":"NHWC",this.dilationRate);return n?zc(a,n,this.dataFormat):a}},{key:"recurrentConv",value:function(e,t){return ii.conv2d(e,t,1,"same","channelsFirst"===this.dataFormat?"NCHW":"NHWC")}}]),n}(Ah);Fh.className="ConvLSTM2DCell",ii.serialization.registerClass(Fh);var Mh=function(e){(0,M.Z)(n,e);var t=(0,O.Z)(n);function n(e){(0,D.Z)(this,n);var r=new Fh(e);return t.call(this,Object.assign(Object.assign({},e),{cell:r}))}return(0,F.Z)(n,null,[{key:"fromConfig",value:function(e,t){return new e(t)}}]),n}(Dh);Mh.className="ConvLSTM2D",ii.serialization.registerClass(Mh);var Oh=function(e){(0,M.Z)(n,e);var t=(0,O.Z)(n);function n(e){var r;return(0,D.Z)(this,n),(r=t.call(this,e)).rate=Math.max(Math.min(e.rate,1),0),r.noiseShape=e.noiseShape,r.seed=e.seed,r.supportsMasking=!0,r}return(0,F.Z)(n,[{key:"getNoiseShape",value:function(e){if(null==this.noiseShape)return this.noiseShape;for(var t=e.shape,n=[],r=0;r<this.noiseShape.length;++r)n.push(null==this.noiseShape[r]?t[r]:this.noiseShape[r]);return n}},{key:"call",value:function(e,t){var n=this;return(0,ii.tidy)((function(){n.invokeCallHook(e,t);var r=dl(e);if(0<n.rate&&n.rate<1){var a=null!=t.training&&t.training,i=n.getNoiseShape(r);return Pc((function(){return Lc(r,n.rate,i,n.seed)}),(function(){return r}),a)}return e}))}},{key:"getConfig",value:function(){var e={rate:this.rate,noiseShape:this.noiseShape,seed:this.seed},t=(0,rf.Z)((0,af.Z)(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}},{key:"dispose",value:function(){return(0,rf.Z)((0,af.Z)(n.prototype),"dispose",this).call(this)}}]),n}(Sl);Oh.className="Dropout",ii.serialization.registerClass(Oh);var Rh=function(e){(0,M.Z)(n,e);var t=(0,O.Z)(n);function n(e){var r;return(0,D.Z)(this,n),(r=t.call(this,e)).inputSpec=[{ndim:3}],r}return(0,F.Z)(n,[{key:"getNoiseShape",value:function(e){var t=e.shape;return[t[0],1,t[2]]}}]),n}(Oh);Rh.className="SpatialDropout1D",ii.serialization.registerClass(Rh);var jh=function(e){(0,M.Z)(n,e);var t=(0,O.Z)(n);function n(e){var r;if((0,D.Z)(this,n),(r=t.call(this,e)).activation=null,r.useBias=!0,r.kernel=null,r.bias=null,r.DEFAULT_KERNEL_INITIALIZER="glorotNormal",r.DEFAULT_BIAS_INITIALIZER="zeros",null==e.batchInputShape&&null==e.inputShape&&null!=e.inputDim){var a=null;null!=e.batchSize&&(a=e.batchSize),r.batchInputShape=[a,e.inputDim]}return r.units=e.units,Ys(r.units,"units"),r.activation=zd(e.activation),null!=e.useBias&&(r.useBias=e.useBias),r.kernelInitializer=cl(e.kernelInitializer||r.DEFAULT_KERNEL_INITIALIZER),r.biasInitializer=cl(e.biasInitializer||r.DEFAULT_BIAS_INITIALIZER),r.kernelConstraint=ql(e.kernelConstraint),r.biasConstraint=ql(e.biasConstraint),r.kernelRegularizer=qd(e.kernelRegularizer),r.biasRegularizer=qd(e.biasRegularizer),r.activityRegularizer=qd(e.activityRegularizer),r.supportsMasking=!0,r.inputSpec=[{minNDim:2}],r}return(0,F.Z)(n,[{key:"build",value:function(e){var t=(e=hl(e))[e.length-1];null==this.kernel&&(this.kernel=this.addWeight("kernel",[t,this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint))),this.inputSpec=[{minNDim:2,axes:(0,it.Z)({},-1,t)}],this.built=!0}},{key:"computeOutputShape",value:function(e){var t=(e=hl(e)).slice();return t[t.length-1]=this.units,t}},{key:"call",value:function(e,t){var n=this;return(0,ii.tidy)((function(){n.invokeCallHook(e,t);var r,a=dl(e),i=Qs(n.activation.getClassName());return null!=i?r=Oc(a,n.kernel.read(),i,n.bias?n.bias.read():null):(r=Oc(a,n.kernel.read()),null!=n.bias&&(r=zc(r,n.bias.read())),null!=n.activation&&(r=n.activation.apply(r))),r}))}},{key:"getConfig",value:function(){var e={units:this.units,activation:jd(this.activation),useBias:this.useBias,kernelInitializer:sl(this.kernelInitializer),biasInitializer:sl(this.biasInitializer),kernelRegularizer:Wd(this.kernelRegularizer),biasRegularizer:Wd(this.biasRegularizer),activityRegularizer:Wd(this.activityRegularizer),kernelConstraint:Wl(this.kernelConstraint),biasConstraint:Wl(this.biasConstraint)},t=(0,rf.Z)((0,af.Z)(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(Sl);jh.className="Dense",ii.serialization.registerClass(jh);var Bh=function(e){(0,M.Z)(n,e);var t=(0,O.Z)(n);function n(e){var r;return(0,D.Z)(this,n),e=e||{},(r=t.call(this,e)).inputSpec=[{minNDim:3}],r.dataFormat=e.dataFormat,r}return(0,F.Z)(n,[{key:"computeOutputShape",value:function(e){e=hl(e);var t,n=(0,B.Z)(e.slice(1));try{for(n.s();!(t=n.n()).done;){if(null==t.value)throw new Is('The shape of the input to "Flatten" is not fully defined '+"(got ".concat(e.slice(1),"). Make sure to pass a complete ")+'"input_shape" or "batch_input_shape" argument to the first layer in your model.')}}catch(r){n.e(r)}finally{n.f()}return[e[0],bc(e,1)]}},{key:"call",value:function(e,t){var n=this;return(0,ii.tidy)((function(){n.invokeCallHook(e,t);var r=dl(e);if("channelsFirst"===n.dataFormat&&r.rank>1){for(var a=[0],i=2;i<r.rank;++i)a.push(i);a.push(1),r=(0,ii.transpose)(r,a)}return function(e){if(e.rank<=1)throw new Is("batchFlatten requires a minimum rank of 2. Got rank: ".concat(e.rank,"."));var t=[e.shape[0],bc(e.shape,1)];return ii.reshape(e,t)}(r)}))}},{key:"getConfig",value:function(){var e={};null!=this.dataFormat&&(e.dataFormat=this.dataFormat);var t=(0,rf.Z)((0,af.Z)(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(Sl);Bh.className="Flatten",ii.serialization.registerClass(Bh);var zh=function(e){(0,M.Z)(n,e);var t=(0,O.Z)(n);function n(e){var r;return(0,D.Z)(this,n),(r=t.call(this,e)).supportsMasking=!0,r.activation=zd(e.activation),r}return(0,F.Z)(n,[{key:"call",value:function(e,t){var n=this;return(0,ii.tidy)((function(){n.invokeCallHook(e,t);var r=dl(e);return n.activation.apply(r)}))}},{key:"getConfig",value:function(){var e={activation:jd(this.activation)},t=(0,rf.Z)((0,af.Z)(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(Sl);zh.className="Activation",ii.serialization.registerClass(zh);var Zh=function(e){(0,M.Z)(n,e);var t=(0,O.Z)(n);function n(e){var r;return(0,D.Z)(this,n),(r=t.call(this,e)).n=e.n,r.inputSpec=[{ndim:2}],r}return(0,F.Z)(n,[{key:"computeOutputShape",value:function(e){return[e[0],this.n,e[1]]}},{key:"call",value:function(e,t){var n=this;return(0,ii.tidy)((function(){return e=dl(e),t=e,r=n.n,(0,ii.tidy)((function(){if(2!==t.shape.length)throw new Is("repeat() expects a rank-2 tensor, but received a "+"rank-".concat(t.shape.length," tensor."));return Fc(Cc(t,1),[1,r,1])}));var t,r}))}},{key:"getConfig",value:function(){var e={n:this.n},t=(0,rf.Z)((0,af.Z)(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(Sl);Zh.className="RepeatVector",ii.serialization.registerClass(Zh);var Lh=function(e){(0,M.Z)(n,e);var t=(0,O.Z)(n);function n(e){var r;(0,D.Z)(this,n),(r=t.call(this,e)).targetShape=e.targetShape;for(var a=0;a<r.targetShape.length;++a)r.isUnknown(r.targetShape[a])&&(r.targetShape[a]=null);return r}return(0,F.Z)(n,[{key:"isUnknown",value:function(e){return e<0||null==e}},{key:"fixUnknownDimension",value:function(e,t){for(var n="Total size of new array must be unchanged.",r=t.slice(),a=1,i=null,o=0;o<r.length;++o){var u=r[o];if(this.isUnknown(u)){if(null!==i)throw new Is("Can only specifiy one unknown dimension.");i=o}else a*=u}var s=bc(e);if(null!==i){if(0===a||s%a!==0)throw new Is(n);r[i]=s/a}else if(s!==a)throw new Is(n);return r}},{key:"computeOutputShape",value:function(e){for(var t=!1,n=0;n<e.length;++n)if(this.isUnknown(e[n])){t=!0;break}return t?e.slice(0,1).concat(this.targetShape):e.slice(0,1).concat(this.fixUnknownDimension(e.slice(1),this.targetShape))}},{key:"call",value:function(e,t){var n=this;return(0,ii.tidy)((function(){n.invokeCallHook(e,t);var r=dl(e),a=r.shape,i=a.slice(0,1).concat(n.fixUnknownDimension(a.slice(1),n.targetShape));return(0,ii.reshape)(r,i)}))}},{key:"getConfig",value:function(){var e={targetShape:this.targetShape},t=(0,rf.Z)((0,af.Z)(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(Sl);Lh.className="Reshape",ii.serialization.registerClass(Lh);var Ph=function(e){(0,M.Z)(n,e);var t=(0,O.Z)(n);function n(e){var r;if((0,D.Z)(this,n),r=t.call(this,e),null==e.dims)throw new Error("Required configuration field `dims` is missing during Permute constructor call.");if(!Array.isArray(e.dims))throw new Error("Permute constructor requires `dims` to be an Array, but received "+"".concat(e.dims," instead."));var a=kc(1,e.dims.length+1);if(!ii.util.arraysEqual(e.dims.slice().sort(),a))throw new Error("Invalid permutation `dims`: "+JSON.stringify(e.dims)+" `dims` must contain consecutive integers starting from 1.");return r.dims=e.dims,r.dimsIncludingBatch=[0].concat(r.dims),r.inputSpec=[new bl({ndim:r.dims.length+1})],r}return(0,F.Z)(n,[{key:"computeOutputShape",value:function(e){var t=(e=hl(e)).slice();return this.dims.forEach((function(n,r){t[r+1]=e[n]})),t}},{key:"call",value:function(e,t){return(0,ii.transpose)(dl(e),this.dimsIncludingBatch)}},{key:"getConfig",value:function(){var e={dims:this.dims},t=(0,rf.Z)((0,af.Z)(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(Sl);Ph.className="Permute",ii.serialization.registerClass(Ph);var Uh=function(e){(0,M.Z)(n,e);var t=(0,O.Z)(n);function n(e){var r;return(0,D.Z)(this,n),(r=t.call(this,null==e?{}:e)).supportsMasking=!0,r.maskValue=null!=e?null==e.maskValue?0:e.maskValue:0,r}return(0,F.Z)(n,[{key:"computeOutputShape",value:function(e){return e}},{key:"getConfig",value:function(){var e=(0,rf.Z)((0,af.Z)(n.prototype),"getConfig",this).call(this),t={maskValue:this.maskValue};return Object.assign(t,e),t}},{key:"computeMask",value:function(e,t){var n=dl(e);return(0,ii.any)((0,ii.notEqual)(n,this.maskValue),-1)}},{key:"call",value:function(e,t){var n=this;return(0,ii.tidy)((function(){n.invokeCallHook(e,t);var r=dl(e),a=(0,ii.any)((0,ii.notEqual)(r,n.maskValue),-1,!0);return(0,ii.mul)(r,(0,ii.cast)(a,r.dtype))}))}}]),n}(Sl);Uh.className="Masking",ii.serialization.registerClass(Uh);var Wh=function(e){(0,M.Z)(n,e);var t=(0,O.Z)(n);function n(e){var r;if((0,D.Z)(this,n),(r=t.call(this,e)).embeddings=null,r.DEFAULT_EMBEDDINGS_INITIALIZER="randomUniform",null==e.batchInputShape&&null==e.inputShape){var a=null;null!=e.batchSize&&(a=e.batchSize),null==e.inputLength?r.batchInputShape=[a,null]:r.batchInputShape=[a].concat(zs(e.inputLength))}return r.inputDim=e.inputDim,Ys(r.inputDim,"inputDim"),r.outputDim=e.outputDim,Ys(r.outputDim,"outputDim"),r.embeddingsInitializer=cl(e.embeddingsInitializer||r.DEFAULT_EMBEDDINGS_INITIALIZER),r.embeddingsRegularizer=qd(e.embeddingsRegularizer),r.activityRegularizer=qd(e.activityRegularizer),r.embeddingsConstraint=ql(e.embeddingsConstraint),r.maskZero=e.maskZero,r.supportsMasking=e.maskZero,r.inputLength=e.inputLength,r}return(0,F.Z)(n,[{key:"build",value:function(e){this.embeddings=this.addWeight("embeddings",[this.inputDim,this.outputDim],this.dtype,this.embeddingsInitializer,this.embeddingsRegularizer,!0,this.embeddingsConstraint),this.built=!0}},{key:"warnOnIncompatibleInputShape",value:function(e){}},{key:"computeMask",value:function(e,t){var n=this;return(0,ii.tidy)((function(){return n.maskZero?(e=dl(e),(0,ii.notEqual)(e,(0,ii.zerosLike)(e))):null}))}},{key:"computeOutputShape",value:function(e){if(e=hl(e),null==this.inputLength)return[].concat((0,I.Z)(e),[this.outputDim]);var t=zs(this.inputLength);if(t.length!==e.length-1)throw new Is('"inputLength" is '.concat(this.inputLength,", but received ")+"input shape has shape ".concat(e));for(var n=0,r=0;r<t.length;++r){var a=t[r],i=e[r+1];if(null!=a&&null!=i&&a!==i)throw new Is('"inputLength" is '.concat(this.inputLength,", but received ")+"input shape has shape ".concat(e));null==a&&(t[n]=i),n++}return[e[0]].concat((0,I.Z)(t),[this.outputDim])}},{key:"call",value:function(e,t){var n=this;return(0,ii.tidy)((function(){n.invokeCallHook(e,t);var r=dl(e);"int32"!==r.dtype&&(r=Sc(r,"int32"));var a=Rc(n.embeddings.read(),(0,ii.reshape)(r,[r.size]));return(0,ii.reshape)(a,hl(n.computeOutputShape(r.shape)))}))}},{key:"getConfig",value:function(){var e={inputDim:this.inputDim,outputDim:this.outputDim,embeddingsInitializer:sl(this.embeddingsInitializer),embeddingsRegularizer:Wd(this.embeddingsRegularizer),activityRegularizer:Wd(this.activityRegularizer),embeddingsConstraint:Wl(this.embeddingsConstraint),maskZero:this.maskZero,inputLength:this.inputLength},t=(0,rf.Z)((0,af.Z)(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(Sl);Wh.className="Embedding",ii.serialization.registerClass(Wh);var Vh=function(e){(0,M.Z)(n,e);var t=(0,O.Z)(n);function n(e){var r;return(0,D.Z)(this,n),(r=t.call(this,e||{})).supportsMasking=!0,r}return(0,F.Z)(n,[{key:"mergeFunction",value:function(e){throw new Ds}},{key:"computeElementwiseOpOutputShape",value:function(e,t){if(null==e||null==t)return null;if(e.length<t.length)return this.computeElementwiseOpOutputShape(t,e);if(0===t.length)return e;for(var n=e.slice(0,e.length-t.length),r=0;r<t.length;++r){var a=e[e.length-t.length+r],i=t[r];if(null==a||null==i||a<0||i<0)n.push(null);else if(1===a)n.push(i);else if(1===i)n.push(a);else{if(a!==i)throw new Is("Operands could not be broadcast together with shapes "+JSON.stringify(e)+" "+JSON.stringify(t));n.push(a)}}return n}},{key:"build",value:function(e){if(Array.isArray(e)&&!Array.isArray(e[0])&&(e=[hl(e)]),e.length<2)throw new Is("A merge layer should be called on an Array of at least 2 inputs."+" Got ".concat(e.length," input(s)."));var t,n=[],r=(0,B.Z)(e);try{for(r.s();!(t=r.n()).done;){var a=t.value;null!=a&&null!==a[0]&&n.push(a[0])}}catch(c){r.e(c)}finally{r.f()}if((n=Gs(n)).length>1)throw new Is("Can not merge tensors with different batch sizes. "+"Got tensors with shapes: ".concat(JSON.stringify(e),"."));for(var i=null==e[0]?null:e[0].slice(1),o=1;o<e.length;++o){var u=null==e[o]?null:e[o].slice(1);i=this.computeElementwiseOpOutputShape(i,u)}var s=e.map((function(e){return e.length}));-1===e.indexOf(null)&&1===Gs(s).length?this.reshapeRequired=!1:this.reshapeRequired=!0}},{key:"call",value:function(e,t){var n=this;return(0,ii.tidy)((function(){if(n.reshapeRequired){var t=[],r=e.map((function(e){return e.rank}));if(-1===r.indexOf(null)){var a,i=wc(r),o=(0,B.Z)(e);try{for(o.s();!(a=o.n()).done;){for(var u=a.value,s=u.rank,c=0;c<i-s;++c)u=Cc(u,1);t.push(u)}}catch(A){o.e(A)}finally{o.f()}return n.mergeFunction(t)}var l,f=!1,d=(0,B.Z)(e);try{for(d.s();!(l=d.n()).done;){var h=l.value,p=h.rank;if(null==p){var v=h.shape,m=v[0],g=v.slice(1).concat([m]),y=ii.reshape(h,[m].concat(bc(v.slice(1))));y=ii.transpose(y,[1,0]),y=ii.reshape(y,g),t.push(y),f=!0}else if(p>1){var b=kc(1,p).concat([0]);t.push(ii.transpose(h,b)),f=!0}else t.push(h)}}catch(A){d.e(A)}finally{d.f()}var x=n.mergeFunction(t),w=x.rank;if(f)if(null==w){var k=x.shape,_=k[k.length-1],S=[_].concat(k.slice(0,k.length-1));x=ii.reshape(ii.transpose(ii.reshape(x,[-1,_]),[1,0]),S)}else if(w>1){var C=[w-1].concat(kc(0,w-1));x=ii.transpose(x,C)}return x}return n.mergeFunction(e)}))}},{key:"computeOutputShape",value:function(e){var t;t=null==e[0]?null:e[0].slice(1);for(var n=1;n<e.length;++n){var r=null==e[n]?null:e[n].slice(1);t=this.computeElementwiseOpOutputShape(t,r)}var a,i=[],o=(0,B.Z)(e);try{for(o.s();!(a=o.n()).done;){var u=a.value;null!=u&&null!==u[0]&&i.push(u[0])}}catch(s){o.e(s)}finally{o.f()}return t=1===(i=Gs(i)).length?i.concat(t):[null].concat(t)}},{key:"computeMask",value:function(e,t){return ii.tidy((function(){if(null==t)return null;if(!Array.isArray(t))throw new Is("`mask` should be an Array");if(!Array.isArray(e))throw new Is("`inputs` should be an Array");if(t.length!==e.length)throw new Is("The Array 'inputs' and 'mask' are expected to have the same length, but have different lengths "+"(".concat(e.length," vs ").concat(t.length,")"));if(t.every((function(e){return null==e})))return null;for(var n=(t=t.map((function(e){return null==e?e:ii.expandDims(e,0)})))[0],r=1;r<t.length-1;++r)n=ii.logicalAnd(n,t[r]);return n}))}}]),n}(Sl),qh=function(e){(0,M.Z)(n,e);var t=(0,O.Z)(n);function n(e){return(0,D.Z)(this,n),t.call(this,e)}return(0,F.Z)(n,[{key:"mergeFunction",value:function(e){return(0,ii.tidy)((function(){for(var t=e[0].clone(),n=1;n<e.length;++n)t=ii.add(t,e[n]);return t}))}}]),n}(Vh);qh.className="Add",ii.serialization.registerClass(qh);var Gh=function(e){(0,M.Z)(n,e);var t=(0,O.Z)(n);function n(e){return(0,D.Z)(this,n),t.call(this,e)}return(0,F.Z)(n,[{key:"mergeFunction",value:function(e){return(0,ii.tidy)((function(){for(var t=e[0].clone(),n=1;n<e.length;++n)t=ii.mul(t,e[n]);return t}))}}]),n}(Vh);Gh.className="Multiply",ii.serialization.registerClass(Gh);var Hh=function(e){(0,M.Z)(n,e);var t=(0,O.Z)(n);function n(e){return(0,D.Z)(this,n),t.call(this,e)}return(0,F.Z)(n,[{key:"mergeFunction",value:function(e){return(0,ii.tidy)((function(){for(var t=e[0].clone(),n=1;n<e.length;++n)t=ii.add(t,e[n]);return ii.mul(1/e.length,t)}))}}]),n}(Vh);Hh.className="Average",ii.serialization.registerClass(Hh);var Xh=function(e){(0,M.Z)(n,e);var t=(0,O.Z)(n);function n(e){return(0,D.Z)(this,n),t.call(this,e)}return(0,F.Z)(n,[{key:"mergeFunction",value:function(e){return(0,ii.tidy)((function(){for(var t=e[0],n=1;n<e.length;++n)t=ii.maximum(t,e[n]);return t}))}}]),n}(Vh);Xh.className="Maximum",ii.serialization.registerClass(Xh);var Kh=function(e){(0,M.Z)(n,e);var t=(0,O.Z)(n);function n(e){return(0,D.Z)(this,n),t.call(this,e)}return(0,F.Z)(n,[{key:"mergeFunction",value:function(e){return(0,ii.tidy)((function(){for(var t=e[0],n=1;n<e.length;++n)t=ii.minimum(t,e[n]);return t}))}}]),n}(Vh);Kh.className="Minimum",ii.serialization.registerClass(Kh);var Yh=function(e){(0,M.Z)(n,e);var t=(0,O.Z)(n);function n(e){var r;return(0,D.Z)(this,n),(r=t.call(this,e)).DEFAULT_AXIS=-1,null==e&&(e={}),r.axis=null==e.axis?r.DEFAULT_AXIS:e.axis,r.supportsMasking=!0,r.reshapeRequired=!1,r}return(0,F.Z)(n,[{key:"build",value:function(e){if(!Array.isArray(e)||!Array.isArray(e[0])||1===e.length)throw new Is("A `Concatenate` layer should be called on a list of at least 2 inputs");var t,n=!0,r=(0,B.Z)(e);try{for(r.s();!(t=r.n()).done;){if(null!=t.value){n=!1;break}}}catch(f){r.e(f)}finally{r.f()}if(!n){for(var a=[],i=0;i<e.length;++i){var o=e[i].slice();o.splice(this.axis,1);var u,s=!1,c=(0,B.Z)(a);try{for(c.s();!(u=c.n()).done;){var l=u.value;if(ii.util.arraysEqual(l,o)){s=!0;break}}}catch(f){c.e(f)}finally{c.f()}s||a.push(o)}if(a.length>1)throw new Is("A `Concatenate` layer requires inputs with matching shapes except for the concat axis. Got input shapes: "+JSON.stringify(e))}}},{key:"mergeFunction",value:function(e){var t=this;return(0,ii.tidy)((function(){return Ic(e,t.axis)}))}},{key:"computeOutputShape",value:function(e){if(!Array.isArray(e)||!Array.isArray(e[0]))throw new Is("A `Concatenate` layer should be called on a list of inputs.");var t,n=e,r=n[0].slice(),a=this.axis<0?r.length+this.axis:this.axis,i=(0,B.Z)(n.slice(1));try{for(i.s();!(t=i.n()).done;){var o=t.value;if(null==r[a]||null==o[a]){r[a]=null;break}r[a]+=o[a]}}catch(u){i.e(u)}finally{i.f()}return r}},{key:"computeMask",value:function(e,t){var n=this;if(null==t)return null;if(!Array.isArray(t))throw new Is("`mask` should be an array for Concatenate");if(!Array.isArray(e))throw new Is("`inputs` should be an array for Concatenate");if(t.length!==e.length)throw new Is("Mismatch in the length of mask (".concat(t.length,") ")+"and the legnth of inputs (".concat(e.length,")"));return ii.tidy((function(){var r=!0;if(t.forEach((function(e){null==e||(r=!1)})),r)return null;for(var a=[],i=0;i<e.length;++i)null==t[i]?a.push(ii.cast(ii.onesLike(e[i]),"bool")):t[i].rank<e[i].rank?a.push(ii.expandDims(t[i],-1)):a.push(t[i]);var o=ii.concat(a,n.axis);return ii.all(o,-1,!1)}))}},{key:"getConfig",value:function(){var e={axis:this.axis},t=(0,rf.Z)((0,af.Z)(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(Vh);function $h(e,t){for(;e<0;)e+=t;return e}Yh.className="Concatenate",ii.serialization.registerClass(Yh);var Qh=function(e){(0,M.Z)(n,e);var t=(0,O.Z)(n);function n(e){var r;return(0,D.Z)(this,n),(r=t.call(this,e)).axes=e.axes,r.normalize=null!=e.normalize&&e.normalize,r.supportsMasking=!0,r.reshapeRequired=!1,r}return(0,F.Z)(n,[{key:"build",value:function(e){ii.util.assert(Array.isArray(e)&&2===e.length&&Array.isArray(e[0])&&Array.isArray(e[1]),(function(){return"A `Dot` layer should be called on a list of exactly 2 inputs."}));var t=e[0],n=e[1];if(t.length>3||n.length>3)throw new Ds("Dot layer does not support tensors of 4D or higher rank yet.");var r=this.interpretAxes(t,n);if(t[r[0]]!==n[r[1]])throw new Is("Dimension incompatibility: "+"".concat(t[r[0]]," !== ").concat(n[r[1]]))}},{key:"mergeFunction",value:function(e){if(2!==e.length)throw new Is("A `Dot` layer must be called on exactly 2 inputs, "+"but received ".concat(e.length," input(s)."));var t,n=e[0],r=e[1];return t=Array.isArray(this.axes)?this.axes.map((function(t,n){return $h(t,e[n].shape.length)})):[$h(this.axes,n.shape.length),$h(this.axes,r.shape.length)],this.normalize&&(n=uf(n,t[0]),r=uf(r,t[1])),function(e,t,n){if(e.shape.length>3||t.shape.length>3)throw new Ds("batchDot is not implemented for tensors of 4D or higher rank yet");if(ii.util.assert(e.shape.length>=2,(function(){return"batchDot requires the rank of x to be >= 2, "+"but got ".concat(e.shape.length)})),ii.util.assert(e.shape.length>=2,(function(){return"batchDot requires the rank of y to be >= 2, "+"but got ".concat(t.shape.length)})),"number"===typeof n&&(n=[n,n]),"complex64"===e.dtype||"complex64"===t.dtype)throw new Ds("batchDot is not implemented for complex64-type Tensors yet.");var r=e.shape.length,a=t.shape.length;null==n&&(n=[r-1,a-2]);var i=n;return ii.tidy((function(){var n,o;if(r>a){n=r-a;for(var u=[],s=0;s<n;++s)u.push(1);t=ii.reshape(t,t.shape.concat(u))}else if(a>r){n=a-r;for(var c=[],l=0;l<n;++l)c.push(1);e=ii.reshape(e,e.shape.concat(c))}else n=0;if(2===e.shape.length&&2===t.shape.length)o=i[0]===i[1]?ii.sum(ii.mul(e,t),i[0]):ii.sum(ii.mul(ii.transpose(e,[1,0]),t),i[1]);else{var f=i[0]!==e.shape.length-1,d=i[1]===t.shape.length-1;o=ii.matMul(e,t,f,d)}if(n>0){for(var h,p=[],v=h=r>a?r+a-3:r-1;v<h+n;++v)p.push(v);o=ii.squeeze(o,p)}return 1===o.shape.length&&(o=ii.expandDims(o,1)),o}))}(n,r,t)}},{key:"interpretAxes",value:function(e,t){return Array.isArray(this.axes)?this.axes:[$h(this.axes,e.length),$h(this.axes,t.length)]}},{key:"computeOutputShape",value:function(e){ii.util.assert(Array.isArray(e)&&2===e.length&&Array.isArray(e[0])&&Array.isArray(e[1]),(function(){return"A `Dot` layer should be called on a list of exactly 2 inputs."}));var t=e[0].slice(),n=e[1].slice();if(t.length>3||n.length>3)throw new Ds("Dot layer does not support tensors of 4D or higher rank yet.");var r=this.interpretAxes(t,n);t.splice(r[0],1),n.splice(r[1],1),n.splice(0,1);var a=t.concat(n);return 1===a.length&&a.push(1),a}},{key:"computeMask",value:function(e,t){return null}},{key:"getConfig",value:function(){var e={axes:this.axes,normalize:this.normalize},t=(0,rf.Z)((0,af.Z)(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(Vh);Qh.className="Dot",ii.serialization.registerClass(Qh);var Jh=function(e){(0,M.Z)(n,e);var t=(0,O.Z)(n);function n(e){var r;return(0,D.Z)(this,n),(r=t.call(this,e)).supportsMasking=!0,r.stddev=e.stddev,r}return(0,F.Z)(n,[{key:"computeOutputShape",value:function(e){return e}},{key:"getConfig",value:function(){var e=(0,rf.Z)((0,af.Z)(n.prototype),"getConfig",this).call(this),t={stddev:this.stddev};return Object.assign(t,e),t}},{key:"call",value:function(e,t){var n=this;return(0,ii.tidy)((function(){n.invokeCallHook(e,t);var r=dl(e);return Pc((function(){return(0,ii.add)(Mc(r.shape,0,n.stddev),r)}),(function(){return r}),t.training||!1)}))}}]),n}(Sl);Jh.className="GaussianNoise",ii.serialization.registerClass(Jh);var ep=function(e){(0,M.Z)(n,e);var t=(0,O.Z)(n);function n(e){var r;return(0,D.Z)(this,n),(r=t.call(this,e)).supportsMasking=!0,r.rate=e.rate,r}return(0,F.Z)(n,[{key:"computeOutputShape",value:function(e){return e}},{key:"getConfig",value:function(){var e=(0,rf.Z)((0,af.Z)(n.prototype),"getConfig",this).call(this),t={rate:this.rate};return Object.assign(t,e),t}},{key:"call",value:function(e,t){var n=this;return(0,ii.tidy)((function(){n.invokeCallHook(e,t);var r=dl(e);if(n.rate>0&&n.rate<1){return Pc((function(){var e=Math.sqrt(n.rate/(1-n.rate));return(0,ii.mul)(r,Mc(r.shape,1,e))}),(function(){return r}),t.training||!1)}return r}))}}]),n}(Sl);ep.className="GaussianDropout",ii.serialization.registerClass(ep);var tp=function(e){(0,M.Z)(n,e);var t=(0,O.Z)(n);function n(e){var r;return(0,D.Z)(this,n),(r=t.call(this,e)).supportsMasking=!0,r.rate=e.rate,r.noiseShape=e.noiseShape,r}return(0,F.Z)(n,[{key:"_getNoiseShape",value:function(e){return this.noiseShape||dl(e).shape}},{key:"computeOutputShape",value:function(e){return e}},{key:"getConfig",value:function(){var e=(0,rf.Z)((0,af.Z)(n.prototype),"getConfig",this).call(this),t={rate:this.rate};return Object.assign(t,e),t}},{key:"call",value:function(e,t){var n=this;return(0,ii.tidy)((function(){if(n.rate<1&&n.rate>0){var r=n._getNoiseShape(e);return Pc((function(){var t=dl(e),a=-1.7580993408473766,i=(0,ii.greaterEqual)((0,ii.randomUniform)(r),n.rate);i=Sc(i,"float32");var o=Math.pow((1-n.rate)*(1+n.rate*Math.pow(a,2)),-.5),u=-o*a*n.rate,s=(0,ii.add)((0,ii.mul)(t,i),(0,ii.mul)((0,ii.add)(i,-1),a));return(0,ii.add)((0,ii.mul)(s,o),u)}),(function(){return dl(e)}),t.training||!1)}return e}))}}]),n}(Sl);function np(e,t,n,r,a){var i,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:.001;if(2===e.rank)i=ii.batchNorm2d(e,t,n,r,a,o);else if(3===e.rank)i=ii.batchNorm3d(e,t,n,r,a,o);else{if(4!==e.rank)throw new Ds("batchNormalization is not implemented for array of rank ".concat(e.rank," ")+"yet");i=ii.batchNorm4d(e,t,n,r,a,o)}return i}function rp(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.001;return(0,ii.tidy)((function(){var i=ii.moments(e,r),o=i.mean,u=i.variance;return[np(e,o,u,n,t,a),o,u]}))}function ap(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.001;return(0,ii.tidy)((function(){var i,o=ii.moments(e,r),u=o.mean,s=o.variance,c=[],l=(0,B.Z)(kc(0,e.rank));try{for(l.s();!(i=l.n()).done;){var f=i.value;-1!==r.indexOf(f)?c.push(1):c.push(e.shape[f])}}catch(m){l.e(m)}finally{l.f()}var d=(0,ii.reshape)(u,c),h=(0,ii.reshape)(s,c),p=null==t?null:(0,ii.reshape)(t,c),v=null==n?null:(0,ii.reshape)(n,c);return[np(e,d,h,v,p,a),u,s]}))}tp.className="AlphaDropout",ii.serialization.registerClass(tp);var ip=function(e){(0,M.Z)(n,e);var t=(0,O.Z)(n);function n(e){var r;return(0,D.Z)(this,n),null==e&&(e={}),(r=t.call(this,e)).supportsMasking=!0,r.axis=null==e.axis?-1:e.axis,r.momentum=null==e.momentum?.99:e.momentum,r.epsilon=null==e.epsilon?.001:e.epsilon,r.center=null==e.center||e.center,r.scale=null==e.scale||e.scale,r.betaInitializer=cl(e.betaInitializer||"zeros"),r.gammaInitializer=cl(e.gammaInitializer||"ones"),r.movingMeanInitializer=cl(e.movingMeanInitializer||"zeros"),r.movingVarianceInitializer=cl(e.movingVarianceInitializer||"ones"),r.betaConstraint=ql(e.betaConstraint),r.gammaConstraint=ql(e.gammaConstraint),r.betaRegularizer=qd(e.betaRegularizer),r.gammaRegularizer=qd(e.gammaRegularizer),r}return(0,F.Z)(n,[{key:"build",value:function(e){e=hl(e);var t=this.axis>=0?this.axis:this.axis+e.length,n=e[t];if(null==n)throw new Is("Axis ".concat(t," of input tensor should have a defined dimension but ")+"the layer received an input with shape "+"".concat(JSON.stringify(e),"."));this.inputSpec=[new bl({ndim:e.length,axes:(0,it.Z)({},t,n)})];var r=[n];this.scale&&(this.gamma=this.addWeight("gamma",r,null,this.gammaInitializer,this.gammaRegularizer,!0,this.gammaConstraint)),this.center&&(this.beta=this.addWeight("beta",r,null,this.betaInitializer,this.betaRegularizer,!0,this.betaConstraint)),this.movingMean=this.addWeight("moving_mean",r,null,this.movingMeanInitializer,null,!1),this.movingVariance=this.addWeight("moving_variance",r,null,this.movingVarianceInitializer,null,!1),this.built=!0}},{key:"call",value:function(e,t){var n=this;return(0,ii.tidy)((function(){var r=null!=t.training&&t.training,a=dl(e),i=a.shape,o=i.length,u=kc(0,o),s=n.axis>=0?n.axis:n.axis+o;u.splice(s,1);var c=Os(1,o);c[s]=i[s];var l=u.slice();l.sort();var f=!ii.util.arraysEqual(l,kc(0,o).slice(0,o-1));if(!r)return function(){if(f){var e=(0,ii.reshape)(n.movingMean.read(),c),t=(0,ii.reshape)(n.movingVariance.read(),c),r=n.center?(0,ii.reshape)(n.beta.read(),c):null,i=n.scale?(0,ii.reshape)(n.gamma.read(),c):null;return np(a,e,t,r,i,n.epsilon)}return np(a,n.movingMean.read(),n.movingVariance.read(),null==n.beta?null:n.beta.read(),null==n.gamma?null:n.gamma.read(),n.epsilon)}();var d=function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.001;return ii.util.arraysEqual(r.slice().sort(),kc(0,e.rank-1))?rp(e,t,n,r,a):ap(e,t,n,r,a)}(a,n.gamma.read(),n.beta.read(),u,n.epsilon),h=(0,C.Z)(d,3),p=h[0],v=h[1],m=h[2],g=function(e,t,n){ii.tidy((function(){var r=1-n,a=e.read(),i=ii.mul(ii.sub(a,t),r);e.write(ii.sub(a,i))}))};return g(n.movingMean,v,n.momentum),g(n.movingVariance,m,n.momentum),p}))}},{key:"getConfig",value:function(){var e={axis:this.axis,momentum:this.momentum,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:sl(this.betaInitializer),gammaInitializer:sl(this.gammaInitializer),movingMeanInitializer:sl(this.movingMeanInitializer),movingVarianceInitializer:sl(this.movingVarianceInitializer),betaRegularizer:Wd(this.betaRegularizer),gammaRegularizer:Wd(this.gammaRegularizer),betaConstraint:Wl(this.betaConstraint),gammaConstraint:Wl(this.gammaConstraint)},t=(0,rf.Z)((0,af.Z)(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(Sl);ip.className="BatchNormalization",ii.serialization.registerClass(ip);var op=function(e){(0,M.Z)(n,e);var t=(0,O.Z)(n);function n(e){var r;if((0,D.Z)(this,n),null==e&&(e={}),(r=t.call(this,e)).axis=null==e.axis?-1:e.axis,"number"===typeof r.axis){if(!Number.isInteger(r.axis))throw new Error("Expected axis to be an integer, but received ".concat(r.axis))}else{if(!Array.isArray(r.axis))throw new Error("Expected axis to be an integer or an array of integers, "+"but received ".concat(JSON.stringify(r.axis)));var a,i=(0,B.Z)(r.axis);try{for(i.s();!(a=i.n()).done;){var o=a.value;if(!Number.isInteger(o))throw new Error("Expected axis to be an array of integers, "+"but received ".concat(JSON.stringify(r.axis)))}}catch(u){i.e(u)}finally{i.f()}}return r.epsilon=null==e.epsilon?.001:e.epsilon,r.center=null==e.center||e.center,r.scale=null==e.scale||e.scale,r.betaInitializer=cl(e.betaInitializer||"zeros"),r.gammaInitializer=cl(e.gammaInitializer||"ones"),r.betaRegularizer=qd(e.betaRegularizer),r.gammaRegularizer=qd(e.gammaRegularizer),r.supportsMasking=!0,r}return(0,F.Z)(n,[{key:"build",value:function(e){var t=(e=hl(e)).length;"number"===typeof this.axis&&(this.axis=[this.axis]);for(var n=0;n<this.axis.length;++n)this.axis[n]<0&&(this.axis[n]+=t);var r,a=(0,B.Z)(this.axis);try{for(a.s();!(r=a.n()).done;){var i=r.value;if(i<0||i>=t)throw new Error("Invalid axis: ".concat(i))}}catch(u){a.e(u)}finally{a.f()}if(this.axis.length!==Gs(this.axis).length)throw new Error("Found duplicate axes in: ".concat(this.axis));var o=this.axis.map((function(t){return e[t]}));this.scale?this.gamma=this.addWeight("gamma",o,"float32",this.gammaInitializer,this.gammaRegularizer,true):this.gamma=null,this.center?this.beta=this.addWeight("beta",o,"float32",this.betaInitializer,this.betaRegularizer,true):this.beta=null,this.built=!0}},{key:"call",value:function(e,t){var n=this,r=dl(e),a=r.shape,i=a.length;return(0,ii.tidy)((function(){var e,t=(0,ii.moments)(r,n.axis,!0),o=t.mean,u=t.variance,s=Os(1,i),c=(0,B.Z)(n.axis);try{for(c.s();!(e=c.n()).done;){var l=e.value;s[l]=a[l]}}catch(g){c.e(g)}finally{c.f()}for(var f=function(e){return null!=e&&e.shape.length!==i?ii.reshape(e,s):e},d=n.scale?f(n.gamma.read()):null,h=n.center?f(n.beta.read()):null,p=[],v=[],m=0;m<i;++m)-1!==n.axis.indexOf(m)?(p.push(a[m]),v.push(1)):(p.push(1),v.push(a[m]));return o=ii.tile(o,p),u=ii.tile(u,p),null!=d&&(d=ii.tile(d,v)),null!=h&&(h=ii.tile(h,v)),np(r,o,u,h,d,n.epsilon)}))}},{key:"getConfig",value:function(){var e={axis:this.axis,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:sl(this.betaInitializer),gammaInitializer:sl(this.gammaInitializer),betaRegularizer:Wd(this.betaRegularizer),gammaRegularizer:Wd(this.gammaRegularizer)},t=(0,rf.Z)((0,af.Z)(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(Sl);op.className="LayerNormalization",ii.serialization.registerClass(op);var up=function(e){(0,M.Z)(n,e);var t=(0,O.Z)(n);function n(e){var r;if((0,D.Z)(this,n),null==e&&(e={}),(r=t.call(this,e)).dataFormat=null==e.dataFormat?"channelsLast":e.dataFormat,null==e.padding)r.padding=[[1,1],[1,1]];else if("number"===typeof e.padding)r.padding=[[e.padding,e.padding],[e.padding,e.padding]];else{if(e.padding=e.padding,2!==e.padding.length)throw new Is("ZeroPadding2D expects padding to be a length-2 array, but "+"received a length-".concat(e.padding.length," array."));var a,i;if("number"===typeof e.padding[0])a=[e.padding[0],e.padding[0]],i=[e.padding[1],e.padding[1]];else{if(e.padding=e.padding,2!==e.padding[0].length)throw new Is("ZeroPadding2D expects height padding to be a length-2 array, "+"but received a length-".concat(e.padding[0].length," array."));if(a=e.padding[0],2!==e.padding[1].length)throw new Is("ZeroPadding2D expects width padding to be a length-2 array, "+"but received a length-".concat(e.padding[1].length," array."));i=e.padding[1]}r.padding=[a,i]}return r.inputSpec=[new bl({ndim:4})],r}return(0,F.Z)(n,[{key:"computeOutputShape",value:function(e){var t,n;return e=hl(e),"channelsFirst"===this.dataFormat?(t=null!=e[2]&&e[2]>=0?e[2]+this.padding[0][0]+this.padding[0][1]:null,n=null!=e[3]&&e[3]>=0?e[3]+this.padding[1][0]+this.padding[1][1]:null,[e[0],e[1],t,n]):(t=null!=e[1]&&e[1]>=0?e[1]+this.padding[0][0]+this.padding[0][1]:null,n=null!=e[2]&&e[2]>=0?e[2]+this.padding[1][0]+this.padding[1][1]:null,[e[0],t,n,e[3]])}},{key:"call",value:function(e,t){var n=this;return(0,ii.tidy)((function(){return t=dl(e),r=n.padding,a=n.dataFormat,(0,ii.tidy)((function(){if(4!==t.rank)throw new Is("temporalPadding expects input tensor to be 4-D, but received a "+"".concat(t.rank,"-D tensor."));if(null==r&&(r=[[1,1],[1,1]]),2!==r.length||2!==r[0].length||2!==r[1].length)throw new Is("spatial2dPadding expects `padding` to be an Array of two Arrays, each of which is an Array of two integers.");if(null==a&&(a="channelsLast"),"channelsLast"!==a&&"channelsFirst"!==a)throw new Is("Unknown data format: ".concat(a,". ")+"Supported data formats are 'channelsLast' and 'channelsFirst.");var e;return e="channelsFirst"===a?[[0,0],[0,0],r[0],r[1]]:[[0,0],r[0],r[1],[0,0]],ii.pad(t,e)}));var t,r,a}))}},{key:"getConfig",value:function(){var e={padding:this.padding,dataFormat:this.dataFormat},t=(0,rf.Z)((0,af.Z)(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(Sl);function sp(e,t,n,r,a,i){return(0,ii.tidy)((function(){var o;cc(a),fc(i),lc(r),null==n&&(n=[1,1]),null==r&&(r="valid"),null==a&&(a="channelsLast"),null==i&&(i="max"),e=th(e,a);var u="same"===r?"same":"valid";return o="max"===i?ii.maxPool(e,t,n,u):ii.avgPool(e,t,n,u),"channelsFirst"===a&&(o=ii.transpose(o,[0,3,1,2])),o}))}function cp(e,t,n,r,a,i){return(0,ii.tidy)((function(){var o;cc(a),fc(i),lc(r),null==n&&(n=[1,1,1]),null==r&&(r="valid"),null==a&&(a="channelsLast"),null==i&&(i="max"),e=nh(e,a);var u="same"===r?"same":"valid";return o="max"===i?ii.maxPool3d(e,t,n,u):ii.avgPool3d(e,t,n,u),"channelsFirst"===a&&(o=ii.transpose(o,[0,4,1,2,3])),o}))}up.className="ZeroPadding2D",ii.serialization.registerClass(up);var lp=function(e){(0,M.Z)(n,e);var t=(0,O.Z)(n);function n(e){var r;if((0,D.Z)(this,n),null==e.poolSize&&(e.poolSize=2),r=t.call(this,e),"number"===typeof e.poolSize)r.poolSize=[e.poolSize];else{if(!Array.isArray(e.poolSize)||1!==e.poolSize.length||"number"!==typeof e.poolSize[0])throw new Is("poolSize for 1D convolutional layer must be a number or an Array of a single number, but received "+"".concat(JSON.stringify(e.poolSize)));r.poolSize=e.poolSize}if(Ys(r.poolSize,"poolSize"),null==e.strides)r.strides=r.poolSize;else if("number"===typeof e.strides)r.strides=[e.strides];else{if(!Array.isArray(e.strides)||1!==e.strides.length||"number"!==typeof e.strides[0])throw new Is("strides for 1D convolutional layer must be a number or an Array of a single number, but received "+"".concat(JSON.stringify(e.strides)));r.strides=e.strides}return Ys(r.strides,"strides"),r.padding=null==e.padding?"valid":e.padding,lc(r.padding),r.inputSpec=[new bl({ndim:3})],r}return(0,F.Z)(n,[{key:"computeOutputShape",value:function(e){var t=Jd((e=hl(e))[1],this.poolSize[0],this.padding,this.strides[0]);return[e[0],t,e[2]]}},{key:"call",value:function(e,t){var n=this;return(0,ii.tidy)((function(){n.invokeCallHook(e,t),e=Cc(dl(e),2);var r=n.poolingFunction(dl(e),[n.poolSize[0],1],[n.strides[0],1],n.padding,"channelsLast");return ii.squeeze(r,[2])}))}},{key:"getConfig",value:function(){var e={poolSize:this.poolSize,padding:this.padding,strides:this.strides},t=(0,rf.Z)((0,af.Z)(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(Sl),fp=function(e){(0,M.Z)(n,e);var t=(0,O.Z)(n);function n(e){return(0,D.Z)(this,n),t.call(this,e)}return(0,F.Z)(n,[{key:"poolingFunction",value:function(e,t,n,r,a){return cc(a),lc(r),sp(e,t,n,r,a,"max")}}]),n}(lp);fp.className="MaxPooling1D",ii.serialization.registerClass(fp);var dp=function(e){(0,M.Z)(n,e);var t=(0,O.Z)(n);function n(e){return(0,D.Z)(this,n),t.call(this,e)}return(0,F.Z)(n,[{key:"poolingFunction",value:function(e,t,n,r,a){return cc(a),lc(r),sp(e,t,n,r,a,"avg")}}]),n}(lp);dp.className="AveragePooling1D",ii.serialization.registerClass(dp);var hp=function(e){(0,M.Z)(n,e);var t=(0,O.Z)(n);function n(e){var r;if((0,D.Z)(this,n),null==e.poolSize&&(e.poolSize=[2,2]),(r=t.call(this,e)).poolSize=Array.isArray(e.poolSize)?e.poolSize:[e.poolSize,e.poolSize],null==e.strides)r.strides=r.poolSize;else if(Array.isArray(e.strides)){if(2!==e.strides.length)throw new Is("If the strides property of a 2D pooling layer is an Array, it is expected to have a length of 2, but received length "+"".concat(e.strides.length,"."));r.strides=e.strides}else r.strides=[e.strides,e.strides];return Ys(r.poolSize,"poolSize"),Ys(r.strides,"strides"),r.padding=null==e.padding?"valid":e.padding,r.dataFormat=null==e.dataFormat?"channelsLast":e.dataFormat,cc(r.dataFormat),lc(r.padding),r.inputSpec=[new bl({ndim:4})],r}return(0,F.Z)(n,[{key:"computeOutputShape",value:function(e){e=hl(e);var t="channelsFirst"===this.dataFormat?e[2]:e[1],n="channelsFirst"===this.dataFormat?e[3]:e[2];return t=Jd(t,this.poolSize[0],this.padding,this.strides[0]),n=Jd(n,this.poolSize[1],this.padding,this.strides[1]),"channelsFirst"===this.dataFormat?[e[0],e[1],t,n]:[e[0],t,n,e[3]]}},{key:"call",value:function(e,t){var n=this;return(0,ii.tidy)((function(){return n.invokeCallHook(e,t),n.poolingFunction(dl(e),n.poolSize,n.strides,n.padding,n.dataFormat)}))}},{key:"getConfig",value:function(){var e={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},t=(0,rf.Z)((0,af.Z)(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(Sl),pp=function(e){(0,M.Z)(n,e);var t=(0,O.Z)(n);function n(e){return(0,D.Z)(this,n),t.call(this,e)}return(0,F.Z)(n,[{key:"poolingFunction",value:function(e,t,n,r,a){return cc(a),lc(r),sp(e,t,n,r,a,"max")}}]),n}(hp);pp.className="MaxPooling2D",ii.serialization.registerClass(pp);var vp=function(e){(0,M.Z)(n,e);var t=(0,O.Z)(n);function n(e){return(0,D.Z)(this,n),t.call(this,e)}return(0,F.Z)(n,[{key:"poolingFunction",value:function(e,t,n,r,a){return cc(a),lc(r),sp(e,t,n,r,a,"avg")}}]),n}(hp);vp.className="AveragePooling2D",ii.serialization.registerClass(vp);var mp=function(e){(0,M.Z)(n,e);var t=(0,O.Z)(n);function n(e){var r;if((0,D.Z)(this,n),null==e.poolSize&&(e.poolSize=[2,2,2]),(r=t.call(this,e)).poolSize=Array.isArray(e.poolSize)?e.poolSize:[e.poolSize,e.poolSize,e.poolSize],null==e.strides)r.strides=r.poolSize;else if(Array.isArray(e.strides)){if(3!==e.strides.length)throw new Is("If the strides property of a 3D pooling layer is an Array, it is expected to have a length of 3, but received length "+"".concat(e.strides.length,"."));r.strides=e.strides}else r.strides=[e.strides,e.strides,e.strides];return Ys(r.poolSize,"poolSize"),Ys(r.strides,"strides"),r.padding=null==e.padding?"valid":e.padding,r.dataFormat=null==e.dataFormat?"channelsLast":e.dataFormat,cc(r.dataFormat),lc(r.padding),r.inputSpec=[new bl({ndim:5})],r}return(0,F.Z)(n,[{key:"computeOutputShape",value:function(e){e=hl(e);var t="channelsFirst"===this.dataFormat?e[2]:e[1],n="channelsFirst"===this.dataFormat?e[3]:e[2],r="channelsFirst"===this.dataFormat?e[4]:e[3];return t=Jd(t,this.poolSize[0],this.padding,this.strides[0]),n=Jd(n,this.poolSize[1],this.padding,this.strides[1]),r=Jd(r,this.poolSize[2],this.padding,this.strides[2]),"channelsFirst"===this.dataFormat?[e[0],e[1],t,n,r]:[e[0],t,n,r,e[4]]}},{key:"call",value:function(e,t){var n=this;return(0,ii.tidy)((function(){return n.invokeCallHook(e,t),n.poolingFunction(dl(e),n.poolSize,n.strides,n.padding,n.dataFormat)}))}},{key:"getConfig",value:function(){var e={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},t=(0,rf.Z)((0,af.Z)(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(Sl),gp=function(e){(0,M.Z)(n,e);var t=(0,O.Z)(n);function n(e){return(0,D.Z)(this,n),t.call(this,e)}return(0,F.Z)(n,[{key:"poolingFunction",value:function(e,t,n,r,a){return cc(a),lc(r),cp(e,t,n,r,a,"max")}}]),n}(mp);gp.className="MaxPooling3D",ii.serialization.registerClass(gp);var yp=function(e){(0,M.Z)(n,e);var t=(0,O.Z)(n);function n(e){return(0,D.Z)(this,n),t.call(this,e)}return(0,F.Z)(n,[{key:"poolingFunction",value:function(e,t,n,r,a){return cc(a),lc(r),cp(e,t,n,r,a,"avg")}}]),n}(mp);yp.className="AveragePooling3D",ii.serialization.registerClass(yp);var bp=function(e){(0,M.Z)(n,e);var t=(0,O.Z)(n);function n(e){var r;return(0,D.Z)(this,n),(r=t.call(this,e)).inputSpec=[new bl({ndim:3})],r}return(0,F.Z)(n,[{key:"computeOutputShape",value:function(e){return[e[0],e[2]]}},{key:"call",value:function(e,t){throw new Ds}}]),n}(Sl),xp=function(e){(0,M.Z)(n,e);var t=(0,O.Z)(n);function n(e){return(0,D.Z)(this,n),t.call(this,e||{})}return(0,F.Z)(n,[{key:"call",value:function(e,t){return(0,ii.tidy)((function(){var t=dl(e);return ii.mean(t,1)}))}}]),n}(bp);xp.className="GlobalAveragePooling1D",ii.serialization.registerClass(xp);var wp=function(e){(0,M.Z)(n,e);var t=(0,O.Z)(n);function n(e){return(0,D.Z)(this,n),t.call(this,e||{})}return(0,F.Z)(n,[{key:"call",value:function(e,t){return(0,ii.tidy)((function(){var t=dl(e);return ii.max(t,1)}))}}]),n}(bp);wp.className="GlobalMaxPooling1D",ii.serialization.registerClass(wp);var kp=function(e){(0,M.Z)(n,e);var t=(0,O.Z)(n);function n(e){var r;return(0,D.Z)(this,n),(r=t.call(this,e)).dataFormat=null==e.dataFormat?"channelsLast":e.dataFormat,cc(r.dataFormat),r.inputSpec=[new bl({ndim:4})],r}return(0,F.Z)(n,[{key:"computeOutputShape",value:function(e){return"channelsLast"===this.dataFormat?[e[0],e[3]]:[e[0],e[1]]}},{key:"call",value:function(e,t){throw new Ds}},{key:"getConfig",value:function(){var e={dataFormat:this.dataFormat},t=(0,rf.Z)((0,af.Z)(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(Sl),_p=function(e){(0,M.Z)(n,e);var t=(0,O.Z)(n);function n(){return(0,D.Z)(this,n),t.apply(this,arguments)}return(0,F.Z)(n,[{key:"call",value:function(e,t){var n=this;return(0,ii.tidy)((function(){var t=dl(e);return"channelsLast"===n.dataFormat?ii.mean(t,[1,2]):ii.mean(t,[2,3])}))}}]),n}(kp);_p.className="GlobalAveragePooling2D",ii.serialization.registerClass(_p);var Sp=function(e){(0,M.Z)(n,e);var t=(0,O.Z)(n);function n(){return(0,D.Z)(this,n),t.apply(this,arguments)}return(0,F.Z)(n,[{key:"call",value:function(e,t){var n=this;return(0,ii.tidy)((function(){var t=dl(e);return"channelsLast"===n.dataFormat?ii.max(t,[1,2]):ii.max(t,[2,3])}))}}]),n}(kp);Sp.className="GlobalMaxPooling2D",ii.serialization.registerClass(Sp);var Cp=function(e){(0,M.Z)(n,e);var t=(0,O.Z)(n);function n(e){var r;return(0,D.Z)(this,n),(r=t.call(this,e)).layer=e.layer,r}return(0,F.Z)(n,[{key:"build",value:function(e){this.built=!0}},{key:"trainable",get:function(){return null!=this.layer&&this.layer.trainable},set:function(e){null!=this.layer&&(this.layer.trainable=e)}},{key:"trainableWeights",get:function(){return this.layer.trainableWeights}},{key:"nonTrainableWeights",get:function(){return this.layer.nonTrainableWeights}},{key:"updates",get:function(){return this.layer._updates}},{key:"losses",get:function(){return this.layer.losses}},{key:"getWeights",value:function(){return this.layer.getWeights()}},{key:"setWeights",value:function(e){this.layer.setWeights(e)}},{key:"getConfig",value:function(){var e={layer:{className:this.layer.getClassName(),config:this.layer.getConfig()}},t=(0,rf.Z)((0,af.Z)(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}},{key:"setFastWeightInitDuringBuild",value:function(e){(0,rf.Z)((0,af.Z)(n.prototype),"setFastWeightInitDuringBuild",this).call(this,e),null!=this.layer&&this.layer.setFastWeightInitDuringBuild(e)}}],[{key:"fromConfig",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=t.layer,a=of(r,n);delete t.layer;var i={layer:a};return Object.assign(i,t),new e(i)}}]),n}(Sl),Ap=function(e){(0,M.Z)(n,e);var t=(0,O.Z)(n);function n(e){var r;return(0,D.Z)(this,n),(r=t.call(this,e)).supportsMasking=!0,r}return(0,F.Z)(n,[{key:"build",value:function(e){if((e=hl(e)).length<3)throw new Is("TimeDistributed layer expects an input shape >= 3D, but received "+"input shape ".concat(JSON.stringify(e)));this.inputSpec=[{shape:e}];var t=[e[0]].concat(e.slice(2));this.layer.built||(this.layer.build(t),this.layer.built=!0),(0,rf.Z)((0,af.Z)(n.prototype),"build",this).call(this,e)}},{key:"computeOutputShape",value:function(e){var t=[(e=hl(e))[0]].concat(e.slice(2)),n=this.layer.computeOutputShape(t),r=e[1];return[n[0],r].concat(n.slice(1))}},{key:"call",value:function(e,t){var n=this;return(0,ii.tidy)((function(){return bh((function(e,r){return[dl(n.layer.call(e,t)),[]]}),e=dl(e),[],!1,null,null,!1,!0)[1]}))}}]),n}(Cp);Ap.className="TimeDistributed",ii.serialization.registerClass(Ap);var Ep=function(e){(0,M.Z)(n,e);var t=(0,O.Z)(n);function n(e){var r;(0,D.Z)(this,n),r=t.call(this,e);var a=e.layer.getConfig(),i={};i.className=e.layer.getClassName(),i.config=a,r.forwardLayer=of(i),a.goBackwards=!0!==a.goBackwards;var o,u={};if(u.className=e.layer.getClassName(),u.config=a,r.backwardLayer=of(u),r.forwardLayer.name="forward_"+r.forwardLayer.name,r.backwardLayer.name="backward_"+r.backwardLayer.name,r.mergeMode=void 0===e.mergeMode?"concat":e.mergeMode,o=r.mergeMode,Xs(uc,"BidirectionalMergeMode",o),e.weights)throw new Ds("weights support is not implemented for Bidirectional layer yet.");return r._stateful=e.layer.stateful,r.returnSequences=e.layer.returnSequences,r.returnState=e.layer.returnState,r.supportsMasking=!0,r._trainable=!0,r.inputSpec=e.layer.inputSpec,r.numConstants=null,r}return(0,F.Z)(n,[{key:"trainable",get:function(){return this._trainable},set:function(e){this._trainable=e,null!=this.forwardLayer&&(this.forwardLayer.trainable=e),null!=this.backwardLayer&&(this.backwardLayer.trainable=e)}},{key:"getWeights",value:function(){return this.forwardLayer.getWeights().concat(this.backwardLayer.getWeights())}},{key:"setWeights",value:function(e){var t=e.length,n=Math.floor(t/2);this.forwardLayer.setWeights(e.slice(0,n)),this.backwardLayer.setWeights(e.slice(n))}},{key:"computeOutputShape",value:function(e){var t,n,r,a=this.forwardLayer.computeOutputShape(e);return Array.isArray(a)&&Array.isArray(a[0])||(a=[a]),this.returnState?(r=a.slice(1),t=a[0]):t=a[0],"concat"===this.mergeMode?(t[t.length-1]*=2,n=[t]):n=null==this.mergeMode?[t,t.slice()]:[t],this.returnState?null==this.mergeMode?n.concat(r).concat(r.slice()):[t].concat(r).concat(r.slice()):Bs(n)}},{key:"apply",value:function(e,t){var r=null==t?null:t.initialState,a=null==t?null:t.constants;null==t&&(t={});var i=yh(e,r,a,this.numConstants);if(e=i.inputs,r=i.initialState,a=i.constants,Array.isArray(e)&&(r=e.slice(1),e=e[0]),(null==r||0===r.length)&&null==a)return(0,rf.Z)((0,af.Z)(n.prototype),"apply",this).call(this,e,t);var o=[],u=[];if(null!=r){var s=r.length;if(s%2>0)throw new Is("When passing `initialState` to a Bidrectional RNN, the state should be an Array containing the states of the underlying RNNs.");t.initialState=r,o.push.apply(o,(0,I.Z)(r));var c=r.map((function(e){return new bl({shape:e.shape})}));this.forwardLayer.stateSpec=c.slice(0,s/2),this.backwardLayer.stateSpec=c.slice(s/2),u.push.apply(u,(0,I.Z)(c))}if(null!=a)throw new Ds("Support for constants in Bidirectional layers is not implemented yet.");for(var l=o[0]instanceof xl,f=0,d=o;f<d.length;f++){if(d[f]instanceof xl!==l)throw new Is("The initial state of a Bidirectional layer cannot be specified as a mix of symbolic and non-symbolic tensors")}if(l){var h=[e].concat(o),p=this.inputSpec.concat(u),v=this.inputSpec;this.inputSpec=p;var m=(0,rf.Z)((0,af.Z)(n.prototype),"apply",this).call(this,h,t);return this.inputSpec=v,m}return(0,rf.Z)((0,af.Z)(n.prototype),"apply",this).call(this,e,t)}},{key:"call",value:function(e,t){var n=this;return(0,ii.tidy)((function(){var r,a,i,o,u=t.initialState;if(null==u)r=n.forwardLayer.call(e,t),a=n.backwardLayer.call(e,t);else{var s=u.slice(0,u.length/2),c=u.slice(u.length/2);r=n.forwardLayer.call(e,Object.assign(t,{initialState:s})),a=n.backwardLayer.call(e,Object.assign(t,{initialState:c}))}return n.returnState&&(Array.isArray(r)&&(i=r.slice(1).concat(a.slice(1))),r=r[0],a=a[0]),n.returnSequences&&(a=ii.reverse(a,1)),"concat"===n.mergeMode?o=Ic([r,a]):"sum"===n.mergeMode?o=ii.add(r,a):"ave"===n.mergeMode?o=ii.mul(.5,ii.add(r,a)):"mul"===n.mergeMode?o=ii.mul(r,a):null==n.mergeMode&&(o=[r,a]),n.returnState?null==n.mergeMode?o.concat(i):[o].concat(i):o}))}},{key:"resetStates",value:function(e){this.forwardLayer.resetStates(),this.backwardLayer.resetStates()}},{key:"build",value:function(e){var t=this;hc(this.forwardLayer.name,(function(){t.forwardLayer.build(e)})),hc(this.backwardLayer.name,(function(){t.backwardLayer.build(e)})),this.built=!0}},{key:"computeMask",value:function(e,t){var n;if(Array.isArray(t)&&(t=t[0]),n=this.returnSequences?null==this.mergeMode?[t,t]:t:null==this.mergeMode?[null,null]:null,this.returnState){var r=this.forwardLayer.states.map((function(e){return null}));return Array.isArray(n)?n.concat(r).concat(r):[n].concat(r).concat(r)}return n}},{key:"trainableWeights",get:function(){return this.forwardLayer.trainableWeights.concat(this.backwardLayer.trainableWeights)}},{key:"nonTrainableWeights",get:function(){return this.forwardLayer.nonTrainableWeights.concat(this.backwardLayer.nonTrainableWeights)}},{key:"setFastWeightInitDuringBuild",value:function(e){(0,rf.Z)((0,af.Z)(n.prototype),"setFastWeightInitDuringBuild",this).call(this,e),null!=this.forwardLayer&&this.forwardLayer.setFastWeightInitDuringBuild(e),null!=this.backwardLayer&&this.backwardLayer.setFastWeightInitDuringBuild(e)}},{key:"getConfig",value:function(){var e={mergeMode:this.mergeMode},t=(0,rf.Z)((0,af.Z)(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}],[{key:"fromConfig",value:function(e,t){var n=of(t.layer);if(delete t.layer,null!=t.numConstants)throw new Ds("Deserialization of a Bidirectional layer with numConstants present is not supported yet.");var r=t;return r.layer=n,new e(r)}}]),n}(Cp);Ep.className="Bidirectional",ii.serialization.registerClass(Ep);var Np=function(e){(0,M.Z)(n,e);var t=(0,O.Z)(n);function n(e){var r;return(0,D.Z)(this,n),(r=t.call(this,e)).scale=e.scale,e.offset?r.offset=e.offset:r.offset=0,r}return(0,F.Z)(n,[{key:"getConfig",value:function(){var e={scale:this.scale,offset:this.offset},t=(0,rf.Z)((0,af.Z)(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}},{key:"call",value:function(e,t){var n=this;return(0,ii.tidy)((function(){return"float32"!==(e=dl(e)).dtype&&(e=Sc(e,"float32")),(0,ii.add)((0,ii.mul)(e,n.scale),n.offset)}))}}]),n}(Sl);Np.className="Rescaling",ii.serialization.registerClass(Np);var Tp=ii.image.resizeBilinear,Ip=ii.image.cropAndResize,Dp=function(e){(0,M.Z)(n,e);var t=(0,O.Z)(n);function n(e){var r;return(0,D.Z)(this,n),(r=t.call(this,e)).height=e.height,r.width=e.width,r}return(0,F.Z)(n,[{key:"centerCrop",value:function(e,t,n,r,a,i,o,u){return(0,ii.tidy)((function(){var s,c=!1,l=[t/i,n/o,(r+t)/i,(a+n)/o],f=[];3===e.rank?(c=!0,s=(0,ii.stack)([e])):s=e;for(var d=0;d<s.shape[0];d++)f.push(l);var h=(0,ii.tensor)(f,[f.length,4]),p=(0,ii.range)(0,f.length,1,"int32"),v=Ip(s,h,p,[r,a],"nearest");return Sc(c?dl((0,ii.unstack)(v)):v,u)}))}},{key:"upsize",value:function(e,t,n,r){return(0,ii.tidy)((function(){return Sc(Tp(e,[t,n]),r)}))}},{key:"call",value:function(e,t){var n=this;return(0,ii.tidy)((function(){var t=dl(e),r=t.dtype,a=t.shape,i=a[a.length-3],o=a[a.length-2],u=0;i!==n.height&&(u=Math.floor((i-n.height)/2));var s=0;return o!==n.width&&0===(s=Math.floor((o-n.width)/2))&&(s=1),u>=0&&s>=0?n.centerCrop(t,u,s,n.height,n.width,i,o,r):n.upsize(e,n.height,n.width,r)}))}},{key:"getConfig",value:function(){var e={height:this.height,width:this.width},t=(0,rf.Z)((0,af.Z)(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}},{key:"computeOutputShape",value:function(e){var t=(e=hl(e)).length-3,n=e.length-2;return e[t]=this.height,e[n]=this.width,e}}]),n}(Sl);Dp.className="CenterCrop",ii.serialization.registerClass(Dp);var Fp=function(e){(0,M.Z)(n,e);var t=(0,O.Z)(n);function n(e){var r;return(0,D.Z)(this,n),(r=t.call(this,e)).numTokens=e.numTokens,e.outputMode?r.outputMode=e.outputMode:r.outputMode="multiHot",r}return(0,F.Z)(n,[{key:"getConfig",value:function(){var e={numTokens:this.numTokens,outputMode:this.outputMode},t=(0,rf.Z)((0,af.Z)(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}},{key:"computeOutputShape",value:function(e){return null==(e=hl(e))?[this.numTokens]:"oneHot"===this.outputMode&&1!==e[e.length-1]?(e.push(this.numTokens),e):(e[e.length-1]=this.numTokens,e)}},{key:"call",value:function(e,t){var n=this;return(0,ii.tidy)((function(){var r;if("int32"!==(e=dl(e)).dtype&&(e=Sc(e,"int32")),"undefined"!==typeof t.countWeights){if("count"!==n.outputMode)throw new Is("countWeights is not used when outputMode !== count.\n              Received countWeights=".concat(t.countWeights));r=dl(t.countWeights)}var a=(0,ii.max)(e),i=(0,ii.min)(e),o=(0,ii.greater)(n.numTokens,a).bufferSync().get(0),u=(0,ii.greaterEqual)(i,0).bufferSync().get(0);if(!o||!u)throw new Is("Input values must be between 0 < values <="+" numTokens with numTokens=".concat(n.numTokens));return function(e,t,n,r){var a=dl(e);if("int32"!==a.dtype&&(a=Sc(a,"int32")),"int"===t)return a;var i=a.shape;if(0===a.rank&&(a=(0,ii.expandDims)(a,-1)),"oneHot"===t&&1!==a.shape[a.shape.length-1]&&(a=(0,ii.expandDims)(a,-1)),a.rank>2)throw new Is("When outputMode is not int, maximum output rank is 2"+" Received outputMode ".concat(t," and input shape ").concat(i)+" which would result in output rank ".concat(a.rank,"."));var o,u=["multiHot","oneHot"].includes(t),s=a;if(o="undefined"!==typeof r&&"count"===t?(0,ii.denseBincount)(s,r,n,u):(0,ii.denseBincount)(s,[],n,u),"tfIdf"!==t)return o;if(r)return(0,ii.mul)(o,r);throw new Is("When outputMode is 'tfIdf', weights must be provided.")}(e,n.outputMode,n.numTokens,r)}))}}]),n}(Sl);Fp.className="CategoryEncoding",ii.serialization.registerClass(Fp);var Mp=new Set(["bilinear","nearest"]),Op=function(e){(0,M.Z)(n,e);var t=(0,O.Z)(n);function n(e){var r;if((0,D.Z)(this,n),(r=t.call(this,e)).height=e.height,r.width=e.width,e.interpolation){if(!Mp.has(e.interpolation))throw new Is("Invalid interpolation parameter: ".concat(e.interpolation," is not implemented"));r.interpolation=e.interpolation}else r.interpolation="bilinear";return r.cropToAspectRatio=Boolean(e.cropToAspectRatio),r}return(0,F.Z)(n,[{key:"computeOutputShape",value:function(e){var t=(e=hl(e))[2];return[this.height,this.width,t]}},{key:"getConfig",value:function(){var e={height:this.height,width:this.width,interpolation:this.interpolation,cropToAspectRatio:this.cropToAspectRatio},t=(0,rf.Z)((0,af.Z)(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}},{key:"call",value:function(e,t){var n=this;return(0,ii.tidy)((function(){var t=[n.height,n.width];if("bilinear"===n.interpolation)return ii.image.resizeBilinear(e,t,!n.cropToAspectRatio);if("nearest"===n.interpolation)return ii.image.resizeNearestNeighbor(e,t,!n.cropToAspectRatio);throw new Error("Interpolation is ".concat(n.interpolation," but only ").concat((0,I.Z)(Mp)," are supported"))}))}}]),n}(Sl);Op.className="Resizing",ii.serialization.registerClass(Op);var Rp=function(){function e(t){(0,D.Z)(this,e),this.seed=t}return(0,F.Z)(e,[{key:"next",value:function(){if(void 0!==this.seed)return this.seed++}}]),e}();Rp.className="RandomSeed";var jp=function(e){(0,M.Z)(n,e);var t=(0,O.Z)(n);function n(e){var r;return(0,D.Z)(this,n),(r=t.call(this,e)).randomGenerator=new Rp(e.seed),r}return(0,F.Z)(n,[{key:"getConfig",value:function(){var e={seed:this.randomGenerator.seed},t=(0,rf.Z)((0,af.Z)(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(Sl);jp.className="BaseRandomLayer";var Bp=new Set(["bilinear","nearest"]),zp=function(e){(0,M.Z)(n,e);var t=(0,O.Z)(n);function n(e){var r;(0,D.Z)(this,n),r=t.call(this,e);var a=e.factor,i=e.interpolation,o=void 0===i?"bilinear":i;if(r.factor=a,Array.isArray(r.factor)&&2===r.factor.length)r.widthLower=r.factor[0],r.widthUpper=r.factor[1];else{if(Array.isArray(r.factor)||!(r.factor>0))throw new Is("Invalid factor: ".concat(r.factor,". Must be positive number or tuple of 2 numbers"));r.widthLower=-r.factor,r.widthUpper=r.factor}if(r.widthLower<-1||r.widthUpper<-1)throw new Is("factor must have values larger than -1. Got: ".concat(r.factor));if(r.widthUpper<r.widthLower)throw new Is("factor cannot have upper bound less than lower bound.\n        Got upper bound: ".concat(r.widthUpper,".\n        Got lower bound: ").concat(r.widthLower,"\n      "));if(o){if(!Bp.has(o))throw new Is("Invalid interpolation parameter: ".concat(o," is not implemented"));r.interpolation=o}return r}return(0,F.Z)(n,[{key:"getConfig",value:function(){var e={factor:this.factor,interpolation:this.interpolation},t=(0,rf.Z)((0,af.Z)(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}},{key:"computeOutputShape",value:function(e){var t=(e=hl(e))[2];return[this.imgHeight,-1,t]}},{key:"call",value:function(e,t){var n=this;return(0,ii.tidy)((function(){var t=dl(e);n.imgHeight=t.shape[t.shape.length-3];var r=t.shape[t.shape.length-2];n.widthFactor=(0,ii.randomUniform)([1],1+n.widthLower,1+n.widthUpper,"float32",n.randomGenerator.next());var a=n.widthFactor.dataSync()[0]*r;a=Math.round(a);var i=[n.imgHeight,a];switch(n.interpolation){case"bilinear":return ii.image.resizeBilinear(e,i);case"nearest":return ii.image.resizeNearestNeighbor(e,i);default:throw new Error("Interpolation is ".concat(n.interpolation,"\n          but only ").concat((0,I.Z)(Bp)," are supported"))}}))}}]),n}(jp);function Zp(e){return new sh(e)}function Lp(e){return new jh(e)}function Pp(e){return new Oh(e)}function Up(e){return new Bh(e)}function Wp(e){return new pp(e)}zp.className="RandomWidth",ii.serialization.registerClass(zp);var Vp,qp;(0,ii.env)().registerFlag("KEEP_INTERMEDIATE_TENSORS",(function(){return!1}),(function(e){e&&console.warn("Keep intermediate tensors is ON. This will print the values of all intermediate tensors during model inference. Not all models support this mode. For details, check e2e/benchmarks/ model_config.js. This significantly impacts performance.")})),function(e){e[e.DT_INVALID=0]="DT_INVALID",e[e.DT_FLOAT=1]="DT_FLOAT",e[e.DT_DOUBLE=2]="DT_DOUBLE",e[e.DT_INT32=3]="DT_INT32",e[e.DT_UINT8=4]="DT_UINT8",e[e.DT_INT16=5]="DT_INT16",e[e.DT_INT8=6]="DT_INT8",e[e.DT_STRING=7]="DT_STRING",e[e.DT_COMPLEX64=8]="DT_COMPLEX64",e[e.DT_INT64=9]="DT_INT64",e[e.DT_BOOL=10]="DT_BOOL",e[e.DT_QINT8=11]="DT_QINT8",e[e.DT_QUINT8=12]="DT_QUINT8",e[e.DT_QINT32=13]="DT_QINT32",e[e.DT_BFLOAT16=14]="DT_BFLOAT16",e[e.DT_QINT16=15]="DT_QINT16",e[e.DT_QUINT16=16]="DT_QUINT16",e[e.DT_UINT16=17]="DT_UINT16",e[e.DT_COMPLEX128=18]="DT_COMPLEX128",e[e.DT_HALF=19]="DT_HALF",e[e.DT_RESOURCE=20]="DT_RESOURCE",e[e.DT_VARIANT=21]="DT_VARIANT",e[e.DT_UINT32=22]="DT_UINT32",e[e.DT_UINT64=23]="DT_UINT64",e[e.DT_FLOAT_REF=101]="DT_FLOAT_REF",e[e.DT_DOUBLE_REF=102]="DT_DOUBLE_REF",e[e.DT_INT32_REF=103]="DT_INT32_REF",e[e.DT_UINT8_REF=104]="DT_UINT8_REF",e[e.DT_INT16_REF=105]="DT_INT16_REF",e[e.DT_INT8_REF=106]="DT_INT8_REF",e[e.DT_STRING_REF=107]="DT_STRING_REF",e[e.DT_COMPLEX64_REF=108]="DT_COMPLEX64_REF",e[e.DT_INT64_REF=109]="DT_INT64_REF",e[e.DT_BOOL_REF=110]="DT_BOOL_REF",e[e.DT_QINT8_REF=111]="DT_QINT8_REF",e[e.DT_QUINT8_REF=112]="DT_QUINT8_REF",e[e.DT_QINT32_REF=113]="DT_QINT32_REF",e[e.DT_BFLOAT16_REF=114]="DT_BFLOAT16_REF",e[e.DT_QINT16_REF=115]="DT_QINT16_REF",e[e.DT_QUINT16_REF=116]="DT_QUINT16_REF",e[e.DT_UINT16_REF=117]="DT_UINT16_REF",e[e.DT_COMPLEX128_REF=118]="DT_COMPLEX128_REF",e[e.DT_HALF_REF=119]="DT_HALF_REF",e[e.DT_RESOURCE_REF=120]="DT_RESOURCE_REF",e[e.DT_VARIANT_REF=121]="DT_VARIANT_REF",e[e.DT_UINT32_REF=122]="DT_UINT32_REF",e[e.DT_UINT64_REF=123]="DT_UINT64_REF"}(Vp||(Vp={})),function(e){!function(e){e[e.LEGACY=0]="LEGACY",e[e.V1=1]="V1",e[e.V2=2]="V2"}(e.CheckpointFormatVersion||(e.CheckpointFormatVersion={}))}(qp||(qp={}));var Gp={};function Hp(e){return Gp[e]}function Xp(e,t,n,r,a){var i=t.inputParams[e];if(i&&void 0!==i.inputIndexStart){var o=i.inputIndexStart,u=0===i.inputIndexEnd?void 0:void 0===i.inputIndexEnd?o+1:i.inputIndexEnd,s=o<0?t.inputNames.length+o:o;if("tensor"===i.type)return Kp(t.inputNames[s],n,r,a);if("tensors"===i.type){var c=t.inputs.slice(o,u);return t.inputNames.slice(o,u).filter((function(e,t){var n;return"NoOp"!==(null===(n=c[t])||void 0===n?void 0:n.op)})).map((function(e){return Kp(e,n,r,a)}))}var l=Kp(t.inputNames[s],n,r,a),f=l.dataSync();return"number"===i.type?f[0]:ii.util.toNestedArray(l.shape,f)}var d=t.attrParams[e];return d&&d.value}function Kp(e,t,n,r){var a=Jp(e,n),i=(0,C.Z)(a,2),o=i[0],u=i[1];if(null!=r){var s=r.getHashTableHandleByName(o);if(null!=s)return s}var c=n.currentContextIds.find((function(e){return!!t[Qp(o,e)]}));return void 0!==c?t[Qp(o,c)][u]:void 0}function Yp(e,t,n){return t[Qp(e,n.currentContextId)]}function $p(e,t){var n=Jp(e,t),r=(0,C.Z)(n,3),a=r[0],i=r[1],o=r[2];return[Qp(a,t&&t.currentContextId),i,o]}function Qp(e,t){return t?"".concat(e,"-").concat(t):e}function Jp(e,t){if(""===e)return["",0,void 0];var n=null!=t&&null!=t.parseNodeNameCache;if(n){var r=t.parseNodeNameCache.get(e);if(null!=r)return r}var a,i=e.split(":");if(1===i.length)a=[e,0,void 0];else{var o=i[0],u=3===i.length?i[1]:void 0;a=[o,Number(i[i.length-1]),u]}return n&&t.parseNodeNameCache.set(e,a),a}function ev(e,t,n){var r=Xp("pad",e,t,n);if("explicit"===r){r=Xp("explicitPaddings",e,t,n);for(var a=[[0,0],[0,0],[0,0],[0,0]],i=0;i<4;i++)a[i][0]=r[2*i],a[i][1]=r[2*i+1];return a}return r}function tv(e){return e.kept?e:(0,ii.clone)(e)}var nv=[{tfOpName:"Add",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddV2",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddN",category:"arithmetic",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"BiasAdd",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"Sub",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"RealDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Div",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"DivNoNan",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mul",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Maximum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Minimum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Pow",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SquaredDifference",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorMod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],rv=[{tfOpName:"Abs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan2",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ceil",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ClipByValue",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"clipValueMin",type:"number"},{start:2,name:"clipValueMax",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Complex",category:"basic_math",inputs:[{start:0,name:"real",type:"tensor"},{start:1,name:"imag",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ComplexAbs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Elu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Exp",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Floor",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Imag",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Neg",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Real",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Prelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"alpha",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu6",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Selu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sigmoid",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Rsqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Square",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sign",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Round",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Expm1",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log1p",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Reciprocal",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Softplus",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Erf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LeakyRelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"alpha",name:"alpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsNan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsFinite",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsInf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],av=[{tfOpName:"EmptyTensorList",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"maxNumElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"LoopCond",category:"control",inputs:[{start:0,name:"pred",type:"tensor"}]},{tfOpName:"Switch",category:"control",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"pred",type:"tensor"}]},{tfOpName:"Merge",category:"control",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"Enter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"frame_name",name:"frameName",type:"string"},{tfName:"is_constant",name:"isConstant",type:"bool"}]},{tfOpName:"Exit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NextIteration",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayV3",category:"control",inputs:[{start:0,name:"size",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"dynamic_size",name:"dynamicSize",type:"bool"},{tfName:"clear_after_read",name:"clearAfterRead",type:"bool"},{tfName:"identical_element_shapes",name:"identicalElementShapes",type:"bool"},{tfName:"tensor_array_name",name:"name",type:"string"}]},{tfOpName:"TensorArrayWriteV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayReadV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayGatherV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"}]},{tfOpName:"TensorArrayScatterV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArrayConcatV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape_except0",name:"elementShapeExcept0",type:"shape",notSupported:!0}]},{tfOpName:"TensorArraySplitV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"tensor",type:"tensor"},{start:2,name:"lengths",type:"number[]"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArraySizeV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}]},{tfOpName:"TensorArrayCloseV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"}]},{tfOpName:"StatelessIf",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"If",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"StatelessWhile",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"While",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"TensorListScatter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListScatterV2",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"},{start:3,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGather",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListSetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListReserve",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListFromTensor",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListStack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"},{tfName:"num_elements",name:"numElements",type:"dtype"}]},{tfOpName:"TensorListSplit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"},{start:2,name:"lengths",type:"number[]"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListConcat",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}],attrs:[{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListConcatV2",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}],attrs:[{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPopBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPushBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListLength",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}]},{tfOpName:"TensorListResize",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"size",type:"number"}]}],iv=[{tfOpName:"AvgPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[],notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPoolWithArgmax",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"include_batch_in_index",name:"includeBatchInIndex",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AvgPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Conv1D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"stride",name:"stride",type:"number"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NWC"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"dilation",name:"dilation",type:"number",defaultValue:1}]},{tfOpName:"Conv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"useCudnnOnGpu",name:"useCudnnOnGpu",type:"bool"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"_FusedConv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"use_cudnn_on_gpu",name:"useCudnnOnGpu",type:"bool",defaultValue:!0},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"leakyrelu_alpha",name:"leakyreluAlpha",type:"number",defaultValue:.2}]},{tfOpName:"Conv2DBackpropInput",category:"convolution",inputs:[{start:2,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:0,name:"outputShape",type:"number[]"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]",notSupported:!0}]},{tfOpName:"DepthwiseConv2d",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"DepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"FusedDepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]}]},{tfOpName:"Conv3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"Dilation2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"rates",name:"dilations",type:"number[]"},{tfName:"padding",name:"pad",type:"string"}]}],ov=[{tfOpName:"Fill",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"},{start:1,name:"value",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"LinSpace",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"num",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"OneHot",category:"creation",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"depth",type:"number"},{start:2,name:"onValue",type:"number",defaultValue:1},{start:3,name:"offValue",type:"number",defaultValue:0}],attrs:[{tfName:"axis",name:"axis",type:"number",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Ones",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"OnesLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"RandomStandardNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"RandomUniform",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number",defaultValue:0},{tfName:"maxval",name:"maxval",type:"number",defaultValue:1},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"RandomUniformInt",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number"},{tfName:"maxval",name:"maxval",type:"number"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Range",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"step",type:"number",defaultValue:0}],attrs:[{tfName:"Tidx",name:"dtype",type:"dtype"}]},{tfOpName:"TruncatedNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"means",name:"mean",type:"number",defaultValue:0},{tfName:"stddev",name:"stdDev",type:"number",defaultValue:1},{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Zeros",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"ZerosLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Multinomial",category:"creation",inputs:[{start:0,name:"logits",type:"tensor"},{start:1,name:"numSamples",type:"number"}],attrs:[{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number"},{tfName:"T",name:"dtype",type:"dtype"},{tfName:"output_dtype",name:"output_dtype",type:"dtype"}]}],uv=[{tfOpName:"NonMaxSuppressionV2",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV3",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV4",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"T_threshold",name:"threshold",type:"dtype",notSupported:!0},{tfName:"pad_to_max_output_size",name:"padToMaxOutputSize",type:"bool"}]},{tfOpName:"NonMaxSuppressionV5",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"},{start:5,name:"softNmsSigma",type:"number"}]},{tfOpName:"Where",category:"dynamic",inputs:[{start:0,name:"condition",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ListDiff",category:"dynamic",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],sv=[{tfOpName:"LowerBound",category:"evaluation",inputs:[{start:0,name:"sortedSequence",type:"tensor"},{start:1,name:"values",type:"tensor"}]},{tfOpName:"TopKV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"k",type:"number"}],attrs:[{tfName:"sorted",name:"sorted",type:"bool"}]},{tfOpName:"UpperBound",category:"evaluation",inputs:[{start:0,name:"sortedSequence",type:"tensor"},{start:1,name:"values",type:"tensor"}]},{tfOpName:"Unique",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"UniqueV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]}],cv=[{tfOpName:"PlaceholderWithDefault",category:"graph",inputs:[{start:0,name:"default",type:"tensor"}],attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Placeholder",category:"graph",attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Const",category:"graph"},{tfOpName:"Identity",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IdentityN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Snapshot",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Rank",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Size",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Shape",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"ShapeN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Print",category:"graph",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"data",type:"tensors"}],attrs:[{tfName:"message",name:"message",type:"string"},{tfName:"first_n",name:"firstN",type:"number",notSupported:!0},{tfName:"summarize",name:"summarize",type:"number",defaultValue:3}]},{tfOpName:"NoOp",category:"graph",inputs:[]},{tfOpName:"StopGradient",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"FakeQuantWithMinMaxVars",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"min",name:"min",type:"number"},{tfName:"max",name:"max",type:"number"}]}],lv=[{tfOpName:"HashTable",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"HashTableV2",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"LookupTableImport",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableImportV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFind",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFindV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableSize",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"}]},{tfOpName:"LookupTableSizeV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"}]},{tfOpName:"InitializeTable",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}]},{tfOpName:"InitializeTableV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}]}],fv=[{tfOpName:"ResizeBilinear",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ResizeNearestNeighbor",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"CropAndResize",category:"image",inputs:[{start:0,name:"image",type:"tensor"},{start:1,name:"boxes",type:"tensor"},{start:2,name:"boxInd",type:"tensor"},{start:3,name:"cropSize",type:"number[]"}],attrs:[{tfName:"method",name:"method",type:"string"},{tfName:"extrapolation_value",name:"extrapolationValue",type:"number"}]},{tfOpName:"ImageProjectiveTransformV3",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"transforms",type:"tensor"},{start:2,name:"outputShape",type:"number[]"},{start:3,name:"fillValue",type:"number"}],attrs:[{tfName:"interpolation",name:"interpolation",type:"string"},{tfName:"fill_mode",name:"fillMode",type:"string"}]}],dv=[{tfOpName:"Equal",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NotEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Greater",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"GreaterEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Less",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LessEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalAnd",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalNot",category:"logical",inputs:[{start:0,name:"a",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalOr",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Select",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SelectV2",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BitwiseAnd",category:"logical",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}]}],hv=[{tfOpName:"_FusedMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"leakyrelu_alpha",name:"leakyreluAlpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMulV2",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Transpose",category:"matrices",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"perm",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Einsum",category:"matrices",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"equation",name:"equation",type:"string"},{tfName:"N",name:"n",type:"number",defaultValue:2},{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"MatrixBandPart",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"numLower",type:"tensor"},{start:1,name:"numUpper",type:"tensor"}]}],pv=[{tfOpName:"EuclideanNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool",defaultValue:!1}]},{tfOpName:"FusedBatchNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV2",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV3",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"LRN",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"depth_radius",name:"radius",type:"number",defaultValue:5},{tfName:"bias",name:"bias",type:"number",defaultValue:1},{tfName:"alpha",name:"alpha",type:"number",defaultValue:1},{tfName:"beta",name:"beta",type:"number",defaultValue:.5}]},{tfOpName:"Softmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"LogSoftmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]}],vv=[{tfOpName:"Bincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}]},{tfOpName:"DenseBincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}],attrs:[{tfName:"binary_output",name:"binaryOutput",type:"bool"}]},{tfOpName:"Max",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Mean",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Min",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Sum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"All",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Any",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"ArgMax",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"ArgMin",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"Prod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cumprod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}],attrs:[{tfName:"exclusive",name:"exclusive",type:"bool"},{tfName:"reverse",name:"reverse",type:"bool"}]},{tfOpName:"Cumsum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}],attrs:[{tfName:"exclusive",name:"exclusive",type:"bool"},{tfName:"reverse",name:"reverse",type:"bool"}]}],mv=[{tfOpName:"ConcatV2",category:"slice_join",inputs:[{start:0,end:-1,name:"tensors",type:"tensors"},{start:-1,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"Concat",category:"slice_join",inputs:[{start:1,end:0,name:"tensors",type:"tensors"},{start:0,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"GatherV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"axis",type:"number",defaultValue:0}],attrs:[{tfName:"batch_dims",name:"batchDims",type:"number",defaultValue:0}]},{tfOpName:"Gather",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",notSupported:!0}]},{tfOpName:"Reverse",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"dims",type:"bool[]"}]},{tfOpName:"ReverseV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}]},{tfOpName:"Slice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"size",type:"number[]"}]},{tfOpName:"StridedSlice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"end",type:"number[]"},{start:3,name:"strides",type:"number[]"}],attrs:[{tfName:"begin_mask",name:"beginMask",type:"number",defaultValue:0},{tfName:"end_mask",name:"endMask",type:"number",defaultValue:0},{tfName:"new_axis_mask",name:"newAxisMask",type:"number",defaultValue:0},{tfName:"ellipsis_mask",name:"ellipsisMask",type:"number",defaultValue:0},{tfName:"shrink_axis_mask",name:"shrinkAxisMask",type:"number",defaultValue:0}]},{tfOpName:"Pack",category:"slice_join",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0}]},{tfOpName:"Unpack",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0},{tfName:"num",name:"num",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Tile",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"reps",type:"number[]"}]},{tfOpName:"Split",category:"slice_join",inputs:[{start:0,name:"axis",type:"number",defaultValue:0},{start:1,name:"x",type:"tensor"}],attrs:[{tfName:"num_split",name:"numOrSizeSplits",type:"number",defaultValue:1}]},{tfOpName:"SplitV",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"numOrSizeSplits",type:"number[]"},{start:2,name:"axis",type:"number",defaultValue:0}]},{tfOpName:"ScatterNd",category:"slice_join",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"shape",type:"number[]"}]},{tfOpName:"GatherNd",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}]},{tfOpName:"SparseToDense",category:"slice_join",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!1,notSupported:!0}]},{tfOpName:"TensorScatterUpdate",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"values",type:"tensor"}]}],gv=[{tfOpName:"SparseFillEmptyRows",category:"sparse",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"denseShape",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}]},{tfOpName:"SparseReshape",category:"sparse",inputs:[{start:0,name:"inputIndices",type:"tensor"},{start:1,name:"inputShape",type:"tensor"},{start:2,name:"newShape",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SparseSegmentMean",category:"sparse",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"segmentIds",type:"tensor"}]},{tfOpName:"SparseSegmentSum",category:"sparse",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"segmentIds",type:"tensor"}]}],yv=[{tfOpName:"FFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"RFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]},{tfOpName:"IRFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]}],bv=[{tfOpName:"StaticRegexReplace",category:"string",inputs:[{start:0,name:"input",type:"tensor"}],attrs:[{tfName:"pattern",name:"pattern",type:"string"},{tfName:"rewrite",name:"rewrite",type:"string"},{tfName:"replace_global",name:"replaceGlobal",type:"bool"}]},{tfOpName:"StringNGrams",category:"string",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"dataSplits",type:"tensor"}],attrs:[{tfName:"separator",name:"separator",type:"string"},{tfName:"ngram_widths",name:"nGramWidths",type:"number[]"},{tfName:"left_pad",name:"leftPad",type:"string"},{tfName:"right_pad",name:"rightPad",type:"string"},{tfName:"pad_width",name:"padWidth",type:"number"},{tfName:"preserve_short_sequences",name:"preserveShortSequences",type:"bool"}],outputs:["ngrams","ngrams_splits"]},{tfOpName:"StringSplit",category:"string",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"delimiter",type:"tensor"}],attrs:[{tfName:"skip_empty",name:"skipEmpty",type:"bool"}],outputs:["indices","values","shape"]},{tfOpName:"StringToHashBucketFast",category:"string",inputs:[{start:0,name:"input",type:"tensor"}],attrs:[{tfName:"num_buckets",name:"numBuckets",type:"number"}]}],xv=[{tfOpName:"Cast",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"SrcT",name:"sdtype",type:"dtype",notSupported:!0},{tfName:"DstT",name:"dtype",type:"dtype"}]},{tfOpName:"ExpandDims",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"MirrorPad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"mode",name:"mode",type:"string"}]},{tfOpName:"Pad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"constant_value",name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"PadV2",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"},{start:2,name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"Reshape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"EnsureShape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"Squeeze",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"axis",tfDeprecatedName:"squeeze_dims",name:"axis",type:"number[]"}]},{tfOpName:"SpaceToBatchND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"paddings",type:"number[]"}]},{tfOpName:"BatchToSpaceND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"crops",type:"number[]"}]},{tfOpName:"DepthToSpace",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"block_size",name:"blockSize",type:"number"},{tfName:"data_format",name:"dataFormat",type:"string"}]},{tfOpName:"BroadcastTo",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}],attrs:[]},{tfOpName:"BroadcastArgs",category:"transformation",inputs:[{start:0,name:"s0",type:"tensor"},{start:1,name:"s1",type:"tensor"}],attrs:[]}],wv=function(){function n(){var x;(0,D.Z)(this,n);var w=[e,t,r,a,i,o,u,s,c,l,f,d,h,p,v,m,g,y,b],k=(x=[]).concat.apply(x,(0,I.Z)(w.map((function(e){return e.json}))));this.opMappers=k.reduce((function(e,t){return e[t.tfOpName]=t,e}),{})}return(0,F.Z)(n,[{key:"transformGraph",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=e.node,a=[],i=[],o=[],u=r.reduce((function(e,n){return e[n.name]=t.mapNode(n),n.op.startsWith("Placeholder")?a.push(e[n.name]):"Const"===n.op?i.push(e[n.name]):null!=n.input&&0!==n.input.length||o.push(e[n.name]),e}),{}),s=[],c=[],l={},f={};null!=n&&(l=this.mapSignatureEntries(n.inputs),f=this.mapSignatureEntries(n.outputs));var d=Object.keys(u);d.forEach((function(e){var t=u[e];t.inputNames.forEach((function(e,n){var r=$p(e),a=(0,C.Z)(r,3),i=a[0],o=a[2],s=u[i];if(null!=s.outputs){var c=s.outputs.indexOf(o);if(-1!==c){var l="".concat(i,":").concat(c);t.inputNames[n]=l}}t.inputs.push(s),s.children.push(t)}))})),0===Object.keys(f).length?d.forEach((function(e){var t=u[e];0===t.children.length&&c.push(t)})):Object.keys(f).forEach((function(e){var t=$p(e),n=(0,C.Z)(t,1)[0],r=u[n];null!=r&&(r.signatureKey=f[e],c.push(r))})),Object.keys(l).length>0?Object.keys(l).forEach((function(e){var t=$p(e),n=(0,C.Z)(t,1)[0],r=u[n];r&&(r.signatureKey=l[e],s.push(r))})):s=a;var h={};null!=e.library&&null!=e.library.function&&(h=e.library.function.reduce((function(e,n){return e[n.signature.name]=t.mapFunction(n),e}),{}));var p={nodes:u,inputs:s,outputs:c,weights:i,placeholders:a,signature:n,functions:h};return o.length>0&&(p.initNodes=o),p}},{key:"mapSignatureEntries",value:function(e){return Object.keys(e||{}).reduce((function(t,n){return t[e[n].name]=n,t}),{})}},{key:"mapNode",value:function(e){var t=Hp(e.op)||this.opMappers[e.op]||{};null==e.attr&&(e.attr={});var n={name:e.name,op:e.op,category:t.category,inputNames:(e.input||[]).map((function(e){return e.startsWith("^")?e.slice(1):e})),inputs:[],children:[],inputParams:{},attrParams:{},rawAttrs:e.attr,outputs:t.outputs};return null!=t.inputs&&(n.inputParams=t.inputs.reduce((function(e,t){return e[t.name]={type:t.type,inputIndexStart:t.start,inputIndexEnd:t.end},e}),{})),null!=t.attrs&&(n.attrParams=t.attrs.reduce((function(t,n){var r=n.type,a=void 0;switch(n.type){case"string":void 0===(a=_v(e.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(a=_v(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"string[]":void 0===(a=Mv(e.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(a=Mv(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"number":void 0===(a=Cv(e.attr,n.tfName,n.defaultValue||0))&&n.tfDeprecatedName&&(a=Cv(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"number[]":void 0===(a=Fv(e.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(a=Fv(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"bool":void 0===(a=Sv(e.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(a=Sv(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"bool[]":void 0===(a=Rv(e.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(a=Rv(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"shape":void 0===(a=Dv(e.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(a=Dv(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"shape[]":void 0===(a=Ov(e.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(a=Ov(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"dtype":void 0===(a=Nv(e.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(a=Nv(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"dtype[]":void 0===(a=Tv(e.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(a=Tv(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"func":void 0===(a=Ev(e.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(a=Ev(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"tensor":case"tensors":break;default:throw new Error("Unsupported param type: ".concat(n.type," for op: ").concat(e.op))}return t[n.name]={value:a,type:r},t}),{})),n}},{key:"mapFunction",value:function(e){var t=this,n=e.nodeDef,r=[],a={};null!=n&&(a=n.reduce((function(e,n){return e[n.name]=t.mapNode(n),"Const"===n.op&&r.push(e[n.name]),e}),{}));var i=[],o=[];e.signature.inputArg.forEach((function(e){var t=$p(e.name),n=(0,C.Z)(t,1)[0],r={name:n,op:"Placeholder",inputs:[],inputNames:[],category:"graph",inputParams:{},attrParams:{dtype:{value:Av(e.type),type:"dtype"}},children:[]};r.signatureKey=e.name,i.push(r),a[n]=r})),Object.keys(a).forEach((function(e){var t=a[e];t.inputNames.forEach((function(e,n){var r=$p(e),i=(0,C.Z)(r,3),o=i[0],u=i[2],s=a[o];if(null!=s.outputs){var c=s.outputs.indexOf(u);if(-1!==c){var l="".concat(o,":").concat(c);t.inputNames[n]=l}}t.inputs.push(s),s.children.push(t)}))}));var u=e.ret;e.signature.outputArg.forEach((function(e){var t=$p(u[e.name]),n=(0,C.Z)(t,2),r=n[0],i=n[1],s=a[r];null!=s&&(s.defaultOutput=i,o.push(s))}));var s=this.mapArgsToSignature(e);return{nodes:a,inputs:i,outputs:o,weights:r,placeholders:[],signature:s}}},{key:"mapArgsToSignature",value:function(e){var t=this;return{methodName:e.signature.name,inputs:e.signature.inputArg.reduce((function(e,n){return e[n.name]=t.mapArgToTensorInfo(n),e}),{}),outputs:e.signature.outputArg.reduce((function(n,r){return n[r.name]=t.mapArgToTensorInfo(r,e.ret),n}),{})}}},{key:"mapArgToTensorInfo",value:function(e,t){var n=e.name;return null!=t&&(n=t[n]),{name:n,dtype:e.type}}}],[{key:"Instance",get:function(){return this._instance||(this._instance=new this)}}]),n}();function kv(e,t){var n=Array.isArray(e)?String.fromCharCode.apply(null,e):function(e){var t=(0,ii.env)().global;if("undefined"!==typeof t.atob)return t.atob(e);if("undefined"!==typeof Buffer)return new Buffer(e,"base64").toString();throw new Error("Unable to decode base64 in this environment. Missing built-in atob() or Buffer()")}(e);return t?n:n.toLowerCase()}function _v(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=e[t];return null!=a?kv(a.s,r):n}function Sv(e,t,n){var r=e[t];return r?r.b:n}function Cv(e,t,n){var r=e[t]||{},a=null!=r.i?r.i:null!=r.f?r.f:n;return"number"===typeof a?a:parseInt(a,10)}function Av(e){switch("string"===typeof e&&(e=Vp[e]),e){case Vp.DT_FLOAT:case Vp.DT_HALF:return"float32";case Vp.DT_INT32:case Vp.DT_INT64:case Vp.DT_INT8:case Vp.DT_UINT8:return"int32";case Vp.DT_BOOL:return"bool";case Vp.DT_DOUBLE:return"float32";case Vp.DT_STRING:return"string";case Vp.DT_COMPLEX64:case Vp.DT_COMPLEX128:return"complex64";default:return null}}function Ev(e,t,n){var r=e[t];return r&&r.func?r.func.name:n}function Nv(e,t,n){var r=e[t];return r&&r.type?Av(r.type):n}function Tv(e,t,n){var r=e[t];return r&&r.list&&r.list.type?r.list.type.map((function(e){return Av(e)})):n}function Iv(e){if(!e.unknownRank)return null!=e.dim?e.dim.map((function(e){return"number"===typeof e.size?e.size:parseInt(e.size,10)})):[]}function Dv(e,t,n){var r=e[t];return r&&r.shape?Iv(r.shape):n}function Fv(e,t,n){var r=e[t];return r?((r.list.f&&r.list.f.length?r.list.f:r.list.i)||[]).map((function(e){return"number"===typeof e?e:parseInt(e,10)})):n}function Mv(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=e[t];return a&&a.list&&a.list.s?a.list.s.map((function(e){return kv(e,r)})):n}function Ov(e,t,n){var r=e[t];return r&&r.list&&r.list.shape?r.list.shape.map((function(e){return Iv(e)})):n}function Rv(e,t,n){var r=e[t];return r&&r.list&&r.list.b?r.list.b:n}var jv=function(){function e(t,n,r){var a=this;(0,D.Z)(this,e),this.node=t,this.tensorMap=n,this.context=r,this.inputs=[],this.attrs={},this.inputs=t.inputNames.map((function(e){return a.getInput(e)})),null!=t.rawAttrs&&(this.attrs=Object.keys(t.rawAttrs).reduce((function(e,t){return e[t]=a.getAttr(t),e}),{}))}return(0,F.Z)(e,[{key:"getInput",value:function(e){return Kp(e,this.tensorMap,this.context)}},{key:"getAttr",value:function(e,t){var n=this.node.rawAttrs[e];if(null!=n.tensor)return Kp(e,this.tensorMap,this.context);if(null!=n.i||null!=n.f)return Cv(this.node.rawAttrs,e,t);if(null!=n.s)return _v(this.node.rawAttrs,e,t);if(null!=n.b)return Sv(this.node.rawAttrs,e,t);if(null!=n.shape)return Dv(this.node.rawAttrs,e,t);if(null!=n.type)return Nv(this.node.rawAttrs,e,t);if(null!=n.list){if(null!=n.list.i||null!=n.list.f)return Fv(this.node.rawAttrs,e,t);if(null!=n.list.s)return Mv(this.node.rawAttrs,e,t);if(null!=n.list.shape)return Ov(this.node.rawAttrs,e,t);if(null!=n.list.b)return Rv(this.node.rawAttrs,e,t);if(null!=n.list.type)return Tv(this.node.rawAttrs,e,t)}return t}}]),e}(),Bv=n(9503),zv=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:x;switch(e.op){case"BiasAdd":case"AddV2":case"Add":return[r.add(Xp("a",e,t,n),Xp("b",e,t,n))];case"AddN":return[r.addN(Xp("tensors",e,t,n))];case"FloorMod":case"Mod":return[r.mod(Xp("a",e,t,n),Xp("b",e,t,n))];case"Mul":return[r.mul(Xp("a",e,t,n),Xp("b",e,t,n))];case"RealDiv":case"Div":return[r.div(Xp("a",e,t,n),Xp("b",e,t,n))];case"DivNoNan":return[r.divNoNan(Xp("a",e,t,n),Xp("b",e,t,n))];case"FloorDiv":return[r.floorDiv(Xp("a",e,t,n),Xp("b",e,t,n))];case"Sub":return[r.sub(Xp("a",e,t,n),Xp("b",e,t,n))];case"Minimum":return[r.minimum(Xp("a",e,t,n),Xp("b",e,t,n))];case"Maximum":return[r.maximum(Xp("a",e,t,n),Xp("b",e,t,n))];case"Pow":return[r.pow(Xp("a",e,t,n),Xp("b",e,t,n))];case"SquaredDifference":return[r.squaredDifference(Xp("a",e,t,n),Xp("b",e,t,n))];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}},Zv=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:x;switch(e.op){case"Abs":case"ComplexAbs":return[r.abs(Xp("x",e,t,n))];case"Acos":return[r.acos(Xp("x",e,t,n))];case"Acosh":return[r.acosh(Xp("x",e,t,n))];case"Asin":return[r.asin(Xp("x",e,t,n))];case"Asinh":return[r.asinh(Xp("x",e,t,n))];case"Atan":return[r.atan(Xp("x",e,t,n))];case"Atan2":return[r.atan2(Xp("x",e,t,n),Xp("y",e,t,n))];case"Atanh":return[r.atanh(Xp("x",e,t,n))];case"Ceil":return[r.ceil(Xp("x",e,t,n))];case"Complex":return[r.complex(Xp("real",e,t,n),Xp("imag",e,t,n))];case"Cos":return[r.cos(Xp("x",e,t,n))];case"Cosh":return[r.cosh(Xp("x",e,t,n))];case"Elu":return[r.elu(Xp("x",e,t,n))];case"Erf":return[r.erf(Xp("x",e,t,n))];case"Exp":return[r.exp(Xp("x",e,t,n))];case"Expm1":return[r.expm1(Xp("x",e,t,n))];case"Floor":return[r.floor(Xp("x",e,t,n))];case"Log":return[r.log(Xp("x",e,t,n))];case"Log1p":return[r.log1p(Xp("x",e,t,n))];case"Imag":return[r.imag(Xp("x",e,t,n))];case"Neg":return[r.neg(Xp("x",e,t,n))];case"Reciprocal":return[r.reciprocal(Xp("x",e,t,n))];case"Real":return[r.real(Xp("x",e,t,n))];case"Relu":return[r.relu(Xp("x",e,t,n))];case"Round":return[r.round(Xp("x",e,t,n))];case"Selu":return[r.selu(Xp("x",e,t,n))];case"Sigmoid":return[r.sigmoid(Xp("x",e,t,n))];case"Sin":return[r.sin(Xp("x",e,t,n))];case"Sign":return[r.sign(Xp("x",e,t,n))];case"Sinh":return[r.sinh(Xp("x",e,t,n))];case"Softplus":return[r.softplus(Xp("x",e,t,n))];case"Sqrt":return[r.sqrt(Xp("x",e,t,n))];case"Square":return[r.square(Xp("x",e,t,n))];case"Tanh":return[r.tanh(Xp("x",e,t,n))];case"Tan":return[r.tan(Xp("x",e,t,n))];case"ClipByValue":return[r.clipByValue(Xp("x",e,t,n),Xp("clipValueMin",e,t,n),Xp("clipValueMax",e,t,n))];case"Relu6":return[r.relu6(Xp("x",e,t,n))];case"Rsqrt":return[r.rsqrt(Kp(e.inputNames[0],t,n))];case"LeakyRelu":return[r.leakyRelu(Xp("x",e,t,n),Xp("alpha",e,t,n))];case"Prelu":return[r.prelu(Xp("x",e,t,n),Xp("alpha",e,t,n))];case"IsNan":return[r.isNaN(Kp(e.inputNames[0],t,n))];case"IsInf":return[r.isInf(Kp(e.inputNames[0],t,n))];case"IsFinite":return[r.isFinite(Kp(e.inputNames[0],t,n))];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}};function Lv(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";if("number"!==typeof e&&"number"!==typeof t){ii.util.assert(e.length===t.length,(function(){return n+" Shapes ".concat(e," and ").concat(t," must match")}));for(var r=0;r<e.length;r++){var a=e[r],i=t[r];ii.util.assert(a<0||i<0||a===i,(function(){return n+" Shapes ".concat(e," and ").concat(t," must match")}))}}}function Pv(e){return"number"!==typeof e&&!e.some((function(e){return e<0}))}function Uv(e,t,n){var r=Wv(e,n),a=!Pv(r);if(a&&0===t.length)throw new Error("Tried to calculate elements of an empty list"+" with non-fully-defined elementShape: ".concat(r));if(a&&t.forEach((function(e){r=Wv(e.shape,r)})),!Pv(r))throw new Error("Non-fully-defined elementShape: ".concat(r));return r}function Wv(e,t){if("number"===typeof e)return t;if("number"===typeof t)return e;if(e.length!==t.length)throw new Error("Incompatible ranks during merge: ".concat(e," vs. ").concat(t));for(var n=[],r=0;r<e.length;++r){var a=e[r],i=t[r];if(a>=0&&i>=0&&a!==i)throw new Error("Incompatible shape during merge: ".concat(e," vs. ").concat(t));n[r]=a>=0?a:i}return n}var Vv=function(){function e(t,n,r,a,i,o,u){(0,D.Z)(this,e),this.name=t,this.dtype=n,this.maxSize=r,this.elementShape=a,this.identicalElementShapes=i,this.dynamicSize=o,this.clearAfterRead=u,this.tensors=[],this.closed_=!1,this.idTensor=(0,ii.scalar)(0),(0,ii.keep)(this.idTensor)}return(0,F.Z)(e,[{key:"id",get:function(){return this.idTensor.id}},{key:"closed",get:function(){return this.closed_}},{key:"clearAndClose",value:function(e){this.tensors.forEach((function(t){null!=e&&e.has(t.tensor.id)||t.tensor.dispose()})),this.tensors=[],this.closed_=!0,this.idTensor.dispose()}},{key:"size",value:function(){return this.tensors.length}},{key:"read",value:function(e){if(this.closed_)throw new Error("TensorArray ".concat(this.name," has already been closed."));if(e<0||e>=this.size())throw new Error("Tried to read from index ".concat(e,", but array size is: ").concat(this.size()));var t=this.tensors[e];if(t.cleared)throw new Error("TensorArray ".concat(this.name,": Could not read index ").concat(e," twice because it was cleared after a previous read ")+"(perhaps try setting clear_after_read = false?).");return this.clearAfterRead&&(t.cleared=!0),t.read=!0,t.tensor}},{key:"readMany",value:function(e){var t=this;return e.map((function(e){return t.read(e)}))}},{key:"write",value:function(e,t){if(this.closed_)throw new Error("TensorArray ".concat(this.name," has already been closed."));if(e<0||!this.dynamicSize&&e>=this.maxSize)throw new Error("Tried to write to index ".concat(e,", but array is not resizeable and size is: ").concat(this.maxSize));var n=this.tensors[e]||{};if(t.dtype!==this.dtype)throw new Error("TensorArray ".concat(this.name,": Could not write to TensorArray index ").concat(e,",\n          because the value dtype is ").concat(t.dtype,", but TensorArray dtype is ").concat(this.dtype,"."));if(0!==this.size()||null!=this.elementShape&&0!==this.elementShape.length||(this.elementShape=t.shape),Lv(this.elementShape,t.shape,"TensorArray ".concat(this.name,": Could not write to TensorArray index ").concat(e,".")),n.read)throw new Error("TensorArray ".concat(this.name,": Could not write to TensorArray index ").concat(e,", because it has already been read."));if(n.written)throw new Error("TensorArray ".concat(this.name,": Could not write to TensorArray index ").concat(e,", because it has already been written."));n.tensor=t,(0,ii.keep)(t),n.written=!0,this.tensors[e]=n}},{key:"writeMany",value:function(e,t){var n=this;if(e.length!==t.length)throw new Error("TensorArray ".concat(this.name,": could not write multiple tensors,")+"because the index size: ".concat(e.length," is not the same as tensors size: ").concat(t.length,"."));e.forEach((function(e,r){return n.write(e,t[r])}))}},{key:"gather",value:function(e,t){if(t&&t!==this.dtype)throw new Error("TensorArray dtype is ".concat(this.dtype," but gather requested dtype ").concat(t));if(e)e=e.slice(0,this.size());else{e=[];for(var n=0;n<this.size();n++)e.push(n)}if(0===e.length)return(0,ii.tensor)([],[0].concat(this.elementShape));var r=this.readMany(e);return Lv(this.elementShape,r[0].shape,"TensorArray shape mismatch: "),(0,ii.stack)(r,0)}},{key:"concat",value:function(e){if(e&&e!==this.dtype)throw new Error("TensorArray dtype is ".concat(this.dtype," but concat requested dtype ").concat(e));if(0===this.size())return(0,ii.tensor)([],[0].concat(this.elementShape));for(var t=[],n=0;n<this.size();n++)t.push(n);var r=this.readMany(t);return Lv(this.elementShape,r[0].shape,"TensorArray shape mismatch: tensor array shape (".concat(this.elementShape,") vs first tensor shape (").concat(r[0].shape,")")),(0,ii.concat)(r,0)}},{key:"scatter",value:function(e,t){if(t.dtype!==this.dtype)throw new Error("TensorArray dtype is ".concat(this.dtype," but tensor has dtype ").concat(t.dtype));if(e.length!==t.shape[0])throw new Error("Expected len(indices) == tensor.shape[0], but saw: ".concat(e.length," vs. ").concat(t.shape[0]));var n=Math.max.apply(Math,(0,I.Z)(e));if(!this.dynamicSize&&n>=this.maxSize)throw new Error("Max index must be < array size (".concat(n,"  vs. ").concat(this.maxSize,")"));this.writeMany(e,(0,ii.unstack)(t,0))}},{key:"split",value:function(e,t){var n=this;if(t.dtype!==this.dtype)throw new Error("TensorArray dtype is ".concat(this.dtype," but tensor has dtype ").concat(t.dtype));var r=0,a=e.map((function(e){return r+=e}));if(r!==t.shape[0])throw new Error("Expected sum of lengths to be equal to\n          tensor.shape[0], but sum of lengths is\n        ".concat(r,", and tensor's shape is: ").concat(t.shape));if(!this.dynamicSize&&e.length!==this.maxSize)throw new Error("TensorArray's size is not equal to the size of lengths (".concat(this.maxSize," vs. ").concat(e.length,"), ")+"and the TensorArray is not marked as dynamically resizeable");var i=0===r?0:t.size/r,o=[];(0,ii.tidy)((function(){t=(0,ii.reshape)(t,[1,r,i]);for(var u=0;u<e.length;++u){var s=[0,0===u?0:a[u-1],0],c=[1,e[u],i];o[u]=(0,ii.reshape)((0,ii.slice)(t,s,c),n.elementShape)}return o}));for(var u=[],s=0;s<e.length;s++)u[s]=s;this.writeMany(u,o)}}]),e}(),qv=function(){function e(t,n,r){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:-1;(0,D.Z)(this,e),this.tensors=t,this.elementShape=n,this.elementDtype=r,null!=t&&t.forEach((function(e){if(r!==e.dtype)throw new Error("Invalid data types; op elements ".concat(r,", but list elements ").concat(e.dtype));Lv(n,e.shape,"TensorList shape mismatch: "),(0,ii.keep)(e)})),this.idTensor=(0,ii.scalar)(0),this.maxNumElements=a,(0,ii.keep)(this.idTensor)}return(0,F.Z)(e,[{key:"id",get:function(){return this.idTensor.id}},{key:"copy",value:function(){return new e((0,I.Z)(this.tensors),this.elementShape,this.elementDtype)}},{key:"clearAndClose",value:function(e){this.tensors.forEach((function(t){null!=e&&e.has(t.id)||t.dispose()})),this.tensors.length=0,this.idTensor.dispose()}},{key:"size",value:function(){return this.tensors.length}},{key:"stack",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;if(t!==this.elementDtype)throw new Error("Invalid data types; op elements ".concat(t,", but list elements ").concat(this.elementDtype));if(-1!==r&&this.tensors.length!==r)throw new Error("Operation expected a list with ".concat(r," elements but got a list with ").concat(this.tensors.length," elements."));Lv(e,this.elementShape,"TensorList shape mismatch: ");var a=Uv(this.elementShape,this.tensors,e);return(0,ii.tidy)((function(){var e=n.tensors.map((function(e){return(0,ii.reshape)(e,a)}));return(0,ii.stack)(e,0)}))}},{key:"popBack",value:function(e,t){if(t!==this.elementDtype)throw new Error("Invalid data types; op elements ".concat(t,", but list elements ").concat(this.elementDtype));if(0===this.size())throw new Error("Trying to pop from an empty list.");var n=Uv(this.elementShape,this.tensors,e),r=this.tensors.pop();return r.kept=!1,Lv(r.shape,e,"TensorList shape mismatch: "),(0,ii.reshape)(r,n)}},{key:"pushBack",value:function(e){if(e.dtype!==this.elementDtype)throw new Error("Invalid data types; op elements ".concat(e.dtype,", but list elements ").concat(this.elementDtype));if(Lv(e.shape,this.elementShape,"TensorList shape mismatch: "),this.maxNumElements===this.size())throw new Error("Trying to push element into a full list.");(0,ii.keep)(e),this.tensors.push(e)}},{key:"resize",value:function(t){if(t<0)throw new Error("TensorListResize expects size to be non-negative. Got: ".concat(t));if(-1!==this.maxNumElements&&t>this.maxNumElements)throw new Error("TensorListResize input size ".concat(t," is greater maxNumElement ").concat(this.maxNumElements,"."));var n=new e([],this.elementShape,this.elementDtype,this.maxNumElements);n.tensors.length=t;for(var r=0;r<Math.min(this.tensors.length,t);++r)n.tensors[r]=this.tensors[r];return n}},{key:"getItem",value:function(e,t,n){if(n!==this.elementDtype)throw new Error("Invalid data types; op elements ".concat(n,", but list elements ").concat(this.elementDtype));if(e<0||e>this.tensors.length)throw new Error("Trying to access element ".concat(e," in a list with ").concat(this.tensors.length," elements."));if(null==this.tensors[e])throw new Error("element at index ".concat(e," is null."));Lv(this.tensors[e].shape,t,"TensorList shape mismatch: ");var r=Uv(this.elementShape,this.tensors,t);return(0,ii.reshape)(this.tensors[e],r)}},{key:"setItem",value:function(e,t){if(t.dtype!==this.elementDtype)throw new Error("Invalid data types; op elements ".concat(t.dtype,", but list elements ").concat(this.elementDtype));if(e<0||-1!==this.maxNumElements&&e>=this.maxNumElements)throw new Error("Trying to set element ".concat(e," in a list with max ").concat(this.maxNumElements," elements."));Lv(this.elementShape,t.shape,"TensorList shape mismatch: "),(0,ii.keep)(t),null!=this.tensors[e]&&(this.tensors[e].kept=!1),this.tensors[e]=t}},{key:"gather",value:function(e,t,n){var r=this;if(t!==this.elementDtype)throw new Error("Invalid data types; op elements ".concat(t,", but list elements ").concat(this.elementDtype));Lv(this.elementShape,n,"TensorList shape mismatch: "),e=e.slice(0,this.size());var a=Uv(this.elementShape,this.tensors,n);return 0===e.length?(0,ii.tensor)([],[0].concat(a)):(0,ii.tidy)((function(){var t=e.map((function(e){return(0,ii.reshape)(r.tensors[e],a)}));return(0,ii.stack)(t,0)}))}},{key:"concat",value:function(e,t){var n=this;if(e&&e!==this.elementDtype)throw new Error("TensorList dtype is ".concat(this.elementDtype," but concat requested dtype ").concat(e));Lv(this.elementShape,t,"TensorList shape mismatch: ");var r=Uv(this.elementShape,this.tensors,t);return 0===this.size()?(0,ii.tensor)([],[0].concat(r)):(0,ii.tidy)((function(){var e=n.tensors.map((function(e){return(0,ii.reshape)(e,r)}));return(0,ii.concat)(e,0)}))}}]),e}();function Gv(e,t,n){var r=e.dtype;if(e.shape.length<1)throw new Error("Tensor must be at least a vector, but saw shape: ".concat(e.shape));if(e.dtype!==n)throw new Error("Invalid data types; op elements ".concat(e.dtype,", but list elements ").concat(n));Lv(e.shape.slice(1),t,"TensorList shape mismatch: ");var a=(0,ii.unstack)(e);return new qv(a,t,r)}function Hv(e,t,n,r){return new qv([],e,t,r)}function Xv(e,t,n,r){if(t.length!==e.shape[0])throw new Error("Expected len(indices) == tensor.shape[0], but saw: ".concat(t.length," vs. ").concat(e.shape[0]));var a=Math.max.apply(Math,(0,I.Z)(t));if(null!=r&&-1!==r&&a>=r)throw new Error("Max index must be < array size (".concat(a,"  vs. ").concat(r,")"));var i=new qv([],n,e.dtype,r),o=(0,ii.unstack)(e,0);return t.forEach((function(e,t){i.setItem(e,o[t])})),i}function Kv(e,t,n){var r=0,a=t.map((function(e){return r+=e}));if(r!==e.shape[0])throw new Error("Expected sum of lengths to be equal to\n          tensor.shape[0], but sum of lengths is\n        ".concat(r,", and tensor's shape is: ").concat(e.shape));for(var i=Wv(e.shape.slice(1),n),o=0===r?0:e.size/r,u=(0,ii.tidy)((function(){var n=[];e=(0,ii.reshape)(e,[1,r,o]);for(var u=0;u<t.length;++u){var s=[0,0===u?0:a[u-1],0],c=[1,t[u],o];n[u]=(0,ii.reshape)((0,ii.slice)(e,s,c),i)}return e.dispose(),n})),s=new qv([],n,e.dtype,t.length),c=0;c<u.length;c++)s.setItem(c,u[c]);return s}var Yv=function(){var e=(0,Da.Z)(E().mark((function e(t,n,r){var a,i,o,u,s,c,l,f,d,h,p,v,m,g,y,b,x,w,k,_,S,C,A,N,T,I,D,F,M,O,R,j,B,z,Z,L,P,U,W,V,q,G,H,X,K,Y,$,Q,J,ee,te,ne,re,ae,ie,oe,ue,se,ce,le,fe,de,he,pe,ve,me,ge,ye,be,xe,we,ke,_e,Se,Ce,Ae,Ee,Ne,Te,Ie,De,Fe,Me,Oe,Re,je,Be,ze,Ze,Le,Pe,Ue,We,Ve,qe,Ge,He,Xe,Ke,Ye,$e,Qe,Je;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=t.op,e.next="If"===e.t0||"StatelessIf"===e.t0?3:"While"===e.t0||"StatelessWhile"===e.t0?15:"LoopCond"===e.t0?19:"Switch"===e.t0?21:"Merge"===e.t0?32:"Enter"===e.t0?37:"Exit"===e.t0?41:"NextIteration"===e.t0?44:"TensorArrayV3"===e.t0?47:"TensorArrayWriteV3"===e.t0?57:"TensorArrayReadV3"===e.t0?63:"TensorArrayGatherV3"===e.t0?67:"TensorArrayScatterV3"===e.t0?72:"TensorArrayConcatV3"===e.t0?78:"TensorArraySplitV3"===e.t0?82:"TensorArraySizeV3"===e.t0?88:"TensorArrayCloseV3"===e.t0?91:"TensorListSetItem"===e.t0?95:"TensorListGetItem"===e.t0?101:"TensorListScatterV2"===e.t0||"TensorListScatter"===e.t0?107:"TensorListReserve"===e.t0||"EmptyTensorList"===e.t0?114:"TensorListGather"===e.t0?122:"TensorListStack"===e.t0?128:"TensorListFromTensor"===e.t0?134:"TensorListConcat"===e.t0||"TensorListConcatV2"===e.t0?140:"TensorListPushBack"===e.t0?145:"TensorListPopBack"===e.t0?150:"TensorListSplit"===e.t0?155:"TensorListLength"===e.t0?161:"TensorListResize"===e.t0?164:170;break;case 3:return a=Xp("thenBranch",t,n,r),i=Xp("elseBranch",t,n,r),o=Xp("cond",t,n,r),u=Xp("args",t,n,r),e.next=9,o.data();case 9:if(!e.sent[0]){e.next=14;break}return e.abrupt("return",r.functionMap[a].executeFunctionAsync(u,r.tensorArrayMap,r.tensorListMap));case 14:return e.abrupt("return",r.functionMap[i].executeFunctionAsync(u,r.tensorArrayMap,r.tensorListMap));case 15:return e.delegateYield(E().mark((function e(){var a,i,o,u,s,c,l,f;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=Xp("body",t,n,r),i=Xp("cond",t,n,r),o=Xp("args",t,n,r),e.next=5,r.functionMap[i].executeFunctionAsync(o,r.tensorArrayMap,r.tensorListMap);case 5:return u=e.sent,s=o.map((function(e){return e.id})),e.next=9,u[0].data();case 9:c=e.sent,u.forEach((function(e){e.kept||-1!==s.indexOf(e.id)||e.dispose()})),l=o,f=E().mark((function e(){var t,n,o;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=l,e.next=3,r.functionMap[a].executeFunctionAsync(l,r.tensorArrayMap,r.tensorListMap);case 3:return l=e.sent,n=l.map((function(e){return e.id})),t.forEach((function(e){e.kept||-1!==s.indexOf(e.id)||-1!==n.indexOf(e.id)||e.dispose()})),e.next=8,r.functionMap[i].executeFunctionAsync(l,r.tensorArrayMap,r.tensorListMap);case 8:return o=e.sent,e.next=11,o[0].data();case 11:c=e.sent,o.forEach((function(e){e.kept||-1!==s.indexOf(e.id)||-1!==n.indexOf(e.id)||e.dispose()}));case 13:case"end":return e.stop()}}),e)}));case 13:if(!c[0]){e.next=17;break}return e.delegateYield(f(),"t0",15);case 15:e.next=13;break;case 17:return e.abrupt("return",{v:l});case 18:case"end":return e.stop()}}),e)}))(),"t1",16);case 16:if("object"!==typeof(s=e.t1)){e.next=19;break}return e.abrupt("return",s.v);case 19:return c=Xp("pred",t,n,r),e.abrupt("return",[tv(c)]);case 21:return l=Xp("pred",t,n,r),(f=Xp("data",t,n,r)).kept||(f=tv(f)),e.next=26,l.data();case 26:if(!e.sent[0]){e.next=30;break}e.t2=[void 0,f],e.next=31;break;case 30:e.t2=[f,void 0];case 31:return e.abrupt("return",e.t2);case 32:if(d=t.inputNames.find((function(e){return void 0!==Kp(e,n,r)})),!d){e.next=36;break}return h=Kp(d,n,r),e.abrupt("return",[tv(h)]);case 36:return e.abrupt("return",void 0);case 37:return p=Xp("frameName",t,n,r),v=Xp("tensor",t,n,r),r.enterFrame(p),e.abrupt("return",[tv(v)]);case 41:return m=Xp("tensor",t,n,r),r.exitFrame(),e.abrupt("return",[tv(m)]);case 44:return g=Xp("tensor",t,n,r),r.nextIteration(),e.abrupt("return",[tv(g)]);case 47:return y=Xp("size",t,n,r),b=Xp("dtype",t,n,r),x=Xp("elementShape",t,n,r),w=Xp("dynamicSize",t,n,r),k=Xp("clearAfterRead",t,n,r),_=Xp("identicalElementShapes",t,n,r),S=Xp("name",t,n,r),C=new Vv(S,b,y,x,_,w,k),r.addTensorArray(C),e.abrupt("return",[C.idTensor,(0,ii.scalar)(1)]);case 57:return A=Xp("tensorArrayId",t,n,r),N=Xp("index",t,n,r),T=Xp("tensor",t,n,r),(I=r.getTensorArray(A.id)).write(N,T),e.abrupt("return",[I.idTensor]);case 63:return D=Xp("tensorArrayId",t,n,r),F=Xp("index",t,n,r),M=r.getTensorArray(D.id),e.abrupt("return",[M.read(F)]);case 67:return O=Xp("tensorArrayId",t,n,r),R=Xp("indices",t,n,r),j=Xp("dtype",t,n,r),B=r.getTensorArray(O.id),e.abrupt("return",[B.gather(R,j)]);case 72:return z=Xp("tensorArrayId",t,n,r),Z=Xp("indices",t,n,r),L=Xp("tensor",t,n,r),(P=r.getTensorArray(z.id)).scatter(Z,L),e.abrupt("return",[P.idTensor]);case 78:return U=Xp("tensorArrayId",t,n,r),W=r.getTensorArray(U.id),V=Xp("dtype",t,n,r),e.abrupt("return",[W.concat(V)]);case 82:return q=Xp("tensorArrayId",t,n,r),G=Xp("tensor",t,n,r),H=Xp("lengths",t,n,r),(X=r.getTensorArray(q.id)).split(H,G),e.abrupt("return",[X.idTensor]);case 88:return K=Xp("tensorArrayId",t,n,r),Y=r.getTensorArray(K.id),e.abrupt("return",[(0,ii.scalar)(Y.size(),"int32")]);case 91:return $=Xp("tensorArrayId",t,n,r),(Q=r.getTensorArray($.id)).clearAndClose(),e.abrupt("return",[Q.idTensor]);case 95:return J=Xp("tensorListId",t,n,r),ee=Xp("index",t,n,r),te=Xp("tensor",t,n,r),(ne=r.getTensorList(J.id)).setItem(ee,te),e.abrupt("return",[ne.idTensor]);case 101:return re=Xp("tensorListId",t,n,r),ae=Xp("index",t,n,r),ie=Xp("elementShape",t,n,r),oe=Xp("elementDType",t,n,r),ue=r.getTensorList(re.id),e.abrupt("return",[ue.getItem(ae,ie,oe)]);case 107:return se=Xp("indices",t,n,r),ce=Xp("tensor",t,n,r),le=Xp("elementShape",t,n,r),fe=Xp("numElements",t,n,r),de=Xv(ce,se,le,fe),r.addTensorList(de),e.abrupt("return",[de.idTensor]);case 114:return he=Xp("elementShape",t,n,r),pe=Xp("elementDType",t,n,r),ve="TensorListReserve"===t.op?"numElements":"maxNumElements",me=Xp(ve,t,n,r),ge="TensorListReserve"===t.op?-1:me,ye=Hv(he,pe,0,ge),r.addTensorList(ye),e.abrupt("return",[ye.idTensor]);case 122:return be=Xp("tensorListId",t,n,r),xe=Xp("indices",t,n,r),we=Xp("elementShape",t,n,r),ke=Xp("elementDType",t,n,r),_e=r.getTensorList(be.id),e.abrupt("return",[_e.gather(xe,ke,we)]);case 128:return Se=Xp("tensorListId",t,n,r),Ce=Xp("elementShape",t,n,r),Ae=Xp("elementDType",t,n,r),Ee=Xp("numElements",t,n,r),Ne=r.getTensorList(Se.id),e.abrupt("return",[Ne.stack(Ce,Ae,Ee)]);case 134:return Te=Xp("tensor",t,n,r),Ie=Xp("elementShape",t,n,r),De=Xp("elementDType",t,n,r),Fe=Gv(Te,Ie,De),r.addTensorList(Fe),e.abrupt("return",[Fe.idTensor]);case 140:return Me=Xp("tensorListId",t,n,r),Oe=r.getTensorList(Me.id),Re=Xp("dtype",t,n,r),je=Xp("elementShape",t,n,r),e.abrupt("return",[Oe.concat(Re,je)]);case 145:return Be=Xp("tensorListId",t,n,r),ze=Xp("tensor",t,n,r),(Ze=r.getTensorList(Be.id)).pushBack(ze),e.abrupt("return",[Ze.idTensor]);case 150:return Le=Xp("tensorListId",t,n,r),Pe=Xp("elementShape",t,n,r),Ue=Xp("elementDType",t,n,r),We=r.getTensorList(Le.id),e.abrupt("return",[We.popBack(Pe,Ue)]);case 155:return Ve=Xp("tensor",t,n,r),qe=Xp("elementShape",t,n,r),Ge=Xp("lengths",t,n,r),He=Kv(Ve,Ge,qe),r.addTensorList(He),e.abrupt("return",[He.idTensor]);case 161:return Xe=Xp("tensorListId",t,n,r),Ke=r.getTensorList(Xe.id),e.abrupt("return",[(0,ii.scalar)(Ke.size(),"int32")]);case 164:return Ye=Xp("tensorListId",t,n,r),$e=Xp("size",t,n,r),Qe=r.getTensorList(Ye.id),Je=Qe.resize($e),r.addTensorList(Je),e.abrupt("return",[Je.idTensor]);case 170:throw TypeError("Node type ".concat(t.op," is not implemented"));case 171:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}();function $v(e,t,n){var r=Xp("fusedOps",e,t,n),a=(0,C.Z)(r,2),i=a[0],o=a[1],u="biasadd"===i,s=!u,c="prelu"===o,l="fusedbatchnorm"===i,f=Xp("numArgs",e,t,n);if(u){if(c&&2!==f)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!c&&u&&1!==f)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd must have one extra argument: bias.")}if(l)throw new Error("FusedConv2d and DepthwiseConv2d with FusedBatchNorm is not supported");var d=Xp("strides",e,t,n),h=ev(e,t,n),p=Xp("dataFormat",e,t,n).toUpperCase(),v=Xp("dilations",e,t,n),m=Xp("args",e,t,n),g=(0,C.Z)(m,2),y=g[0],b=g[1];return s&&(b=y,y=void 0),{stride:d,pad:h,dataFormat:p,dilations:v,biasArg:y,preluArg:b,activationFunc:o,leakyreluAlpha:Xp("leakyreluAlpha",e,t,n)}}var Qv=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:x;switch(e.op){case"Conv1D":var a=Xp("stride",e,t,n),i=Xp("pad",e,t,n),o=Xp("dataFormat",e,t,n).toUpperCase(),u=Xp("dilation",e,t,n);return[r.conv1d(Xp("x",e,t,n),Xp("filter",e,t,n),a,i,o,u)];case"Conv2D":var s=Xp("strides",e,t,n),c=ev(e,t,n),l=Xp("dataFormat",e,t,n).toUpperCase(),f=Xp("dilations",e,t,n);return[r.conv2d(Xp("x",e,t,n),Xp("filter",e,t,n),[s[1],s[2]],c,l,[f[1],f[2]])];case"_FusedConv2D":var d=$v(e,t,n),h=d.stride,p=d.pad,v=d.dataFormat,m=d.dilations,g=d.biasArg,y=d.preluArg,b=d.activationFunc,w=d.leakyreluAlpha;return[r.fused.conv2d({x:Xp("x",e,t,n),filter:Xp("filter",e,t,n),strides:[h[1],h[2]],pad:p,dataFormat:v,dilations:[m[1],m[2]],bias:g,activation:b,preluActivationWeights:y,leakyreluAlpha:w})];case"FusedDepthwiseConv2dNative":var k=$v(e,t,n),_=k.stride,S=k.pad,C=k.dataFormat,A=k.dilations,E=k.biasArg,N=k.preluArg,T=k.activationFunc,I=k.leakyreluAlpha;return[r.fused.depthwiseConv2d({x:Xp("x",e,t,n),filter:Xp("filter",e,t,n),strides:[_[1],_[2]],pad:S,dataFormat:C,dilations:[A[1],A[2]],bias:E,activation:T,preluActivationWeights:N,leakyreluAlpha:I})];case"Conv2DBackpropInput":case"Conv2dTranspose":var D=Xp("outputShape",e,t,n),F=Xp("strides",e,t,n),M=ev(e,t,n);return[r.conv2dTranspose(Xp("x",e,t,n),Xp("filter",e,t,n),D,[F[1],F[2]],M)];case"DepthwiseConv2dNative":case"DepthwiseConv2d":var O=Xp("strides",e,t,n),R=ev(e,t,n),j=Xp("dilations",e,t,n),B=Xp("dataFormat",e,t,n).toUpperCase();return[r.depthwiseConv2d(Xp("input",e,t,n),Xp("filter",e,t,n),[O[1],O[2]],R,B,[j[1],j[2]])];case"Conv3D":var z=Xp("strides",e,t,n),Z=Xp("pad",e,t,n),L=Xp("dataFormat",e,t,n).toUpperCase(),P=Xp("dilations",e,t,n);return[r.conv3d(Xp("x",e,t,n),Xp("filter",e,t,n),[z[1],z[2],z[3]],Z,L,[P[1],P[2],P[3]])];case"AvgPool":var U=Xp("strides",e,t,n),W=Xp("pad",e,t,n),V=Xp("kernelSize",e,t,n);return[r.avgPool(Xp("x",e,t,n),[V[1],V[2]],[U[1],U[2]],W)];case"MaxPool":var q=Xp("strides",e,t,n),G=Xp("pad",e,t,n),H=Xp("kernelSize",e,t,n);return[r.maxPool(Xp("x",e,t,n),[H[1],H[2]],[q[1],q[2]],G)];case"MaxPoolWithArgmax":var X=Xp("strides",e,t,n),K=Xp("pad",e,t,n),Y=Xp("kernelSize",e,t,n),$=Xp("includeBatchInIndex",e,t,n),Q=r.maxPoolWithArgmax(Xp("x",e,t,n),[Y[1],Y[2]],[X[1],X[2]],K,$),J=Q.result,ee=Q.indexes;return[J,ee];case"AvgPool3D":var te=Xp("strides",e,t,n),ne=Xp("pad",e,t,n),re=Xp("kernelSize",e,t,n);return[r.avgPool3d(Xp("x",e,t,n),[re[1],re[2],re[3]],[te[1],te[2],te[3]],ne)];case"MaxPool3D":var ae=Xp("strides",e,t,n),ie=Xp("pad",e,t,n),oe=Xp("kernelSize",e,t,n);return[r.maxPool3d(Xp("x",e,t,n),[oe[1],oe[2],oe[3]],[ae[1],ae[2],ae[3]],ie)];case"Dilation2D":var ue=Xp("strides",e,t,n),se=Xp("pad",e,t,n),ce=Xp("dilations",e,t,n),le=ue[1],fe=ue[2],de=ce[1],he=ce[2];return[r.dilation2d(Xp("x",e,t,n),Xp("filter",e,t,n),[le,fe],se,[de,he],"NHWC")];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}},Jv=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:x;switch(e.op){case"Fill":var a=Xp("shape",e,t,n),i=Xp("dtype",e,t,n),o=Xp("value",e,t,n);return[r.fill(a,o,i)];case"LinSpace":var u=Xp("start",e,t,n),s=Xp("stop",e,t,n),c=Xp("num",e,t,n);return[r.linspace(u,s,c)];case"Multinomial":var l=Xp("logits",e,t,n),f=Xp("numSamples",e,t,n),d=Xp("seed",e,t,n);return[r.multinomial(l,f,d)];case"OneHot":var h=Xp("indices",e,t,n),p=Xp("depth",e,t,n),v=Xp("onValue",e,t,n),m=Xp("offValue",e,t,n),g=Xp("dtype",e,t,n);return[r.oneHot(h,p,v,m,g)];case"Ones":return[r.ones(Xp("shape",e,t,n),Xp("dtype",e,t,n))];case"OnesLike":return[r.onesLike(Xp("x",e,t,n))];case"RandomStandardNormal":return[r.randomStandardNormal(Xp("shape",e,t,n),Xp("dtype",e,t,n),Xp("seed",e,t,n))];case"RandomUniform":return[r.randomUniform(Xp("shape",e,t,n),Xp("minval",e,t,n),Xp("maxval",e,t,n),Xp("dtype",e,t,n))];case"RandomUniformInt":return[r.randomUniformInt(Xp("shape",e,t,n),Xp("minval",e,t,n),Xp("maxval",e,t,n),Xp("seed",e,t,n))];case"Range":var y=Xp("start",e,t,n),b=Xp("stop",e,t,n),w=Xp("step",e,t,n);return[r.range(y,b,w,Xp("dtype",e,t,n))];case"TruncatedNormal":var k=Xp("shape",e,t,n),_=Xp("mean",e,t,n),S=Xp("stdDev",e,t,n),C=Xp("seed",e,t,n);return[r.truncatedNormal(k,_,S,Xp("dtype",e,t,n),C)];case"Zeros":return[r.zeros(Xp("shape",e,t,n),Xp("dtype",e,t,n))];case"ZerosLike":return[r.zerosLike(Xp("x",e,t,n))];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}};function em(e,t,n){return{boxes:Xp("boxes",e,t,n),scores:Xp("scores",e,t,n),maxOutputSize:Xp("maxOutputSize",e,t,n),iouThreshold:Xp("iouThreshold",e,t,n),scoreThreshold:Xp("scoreThreshold",e,t,n),softNmsSigma:Xp("softNmsSigma",e,t,n)}}var tm=function(){var e=(0,Da.Z)(E().mark((function e(t,n,r,a){var i,o,u,s,c,l,f,d,h,p,v,m,g,y,b,w,k,_,S,C,A,N,T,I,D,F=arguments;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=F.length>4&&void 0!==F[4]?F[4]:x,e.t0=t.op,e.next="NonMaxSuppressionV5"===e.t0?4:"NonMaxSuppressionV4"===e.t0?9:"NonMaxSuppressionV3"===e.t0||"NonMaxSuppressionV2"===e.t0?15:"Where"===e.t0?20:"ListDiff"===e.t0?27:28;break;case 4:return o=em(t,n,r),u=o.boxes,s=o.scores,c=o.maxOutputSize,l=o.iouThreshold,f=o.scoreThreshold,d=o.softNmsSigma,e.next=7,i.image.nonMaxSuppressionWithScoreAsync(u,s,c,l,f,d);case 7:return h=e.sent,e.abrupt("return",[h.selectedIndices,h.selectedScores]);case 9:return p=em(t,n,r),v=p.boxes,m=p.scores,g=p.maxOutputSize,y=p.iouThreshold,b=p.scoreThreshold,w=Xp("padToMaxOutputSize",t,n,r),e.next=13,i.image.nonMaxSuppressionPaddedAsync(v,m,g,y,b,w);case 13:return k=e.sent,e.abrupt("return",[k.selectedIndices,k.validOutputs]);case 15:return _=em(t,n,r),S=_.boxes,C=_.scores,A=_.maxOutputSize,N=_.iouThreshold,T=_.scoreThreshold,e.next=18,i.image.nonMaxSuppressionAsync(S,C,A,N,T);case 18:return e.t1=e.sent,e.abrupt("return",[e.t1]);case 20:return I=i.cast(Xp("condition",t,n,r),"bool"),e.next=23,i.whereAsync(I);case 23:return e.t2=e.sent,D=[e.t2],I.dispose(),e.abrupt("return",D);case 27:return e.abrupt("return",i.setdiff1dAsync(Xp("x",t,n,r),Xp("y",t,n,r)));case 28:throw TypeError("Node type ".concat(t.op," is not implemented"));case 29:case"end":return e.stop()}}),e)})));return function(t,n,r,a){return e.apply(this,arguments)}}(),nm=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:x;switch(e.op){case"LowerBound":var a=Xp("sortedSequence",e,t,n),i=Xp("values",e,t,n);return[r.lowerBound(a,i)];case"TopKV2":var o=Xp("x",e,t,n),u=Xp("k",e,t,n),s=Xp("sorted",e,t,n),c=r.topk(o,u,s);return[c.values,c.indices];case"UpperBound":var l=Xp("sortedSequence",e,t,n),f=Xp("values",e,t,n);return[r.upperBound(l,f)];case"Unique":var d=Xp("x",e,t,n),h=r.unique(d);return[h.values,h.indices];case"UniqueV2":var p=Xp("x",e,t,n),v=Xp("axis",e,t,n),m=r.unique(p,v);return[m.values,m.indices];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}},rm=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:x;switch(e.op){case"Const":return t[e.name];case"PlaceholderWithDefault":var a=Xp("default",e,t,n);return[Kp(e.name,t,n)||a];case"Placeholder":return[Kp(e.name,t,n)];case"Identity":case"StopGradient":case"FakeQuantWithMinMaxVars":var i=Xp("x",e,t,n);return[tv(i)];case"IdentityN":return Xp("x",e,t,n).map((function(e){return tv(e)}));case"Snapshot":var o=Xp("x",e,t,n);return[tv(o)];case"Shape":return[r.tensor1d(Xp("x",e,t,n).shape,"int32")];case"ShapeN":return Xp("x",e,t,n).map((function(e){return r.tensor1d(e.shape)}));case"Size":return[r.scalar(Xp("x",e,t,n).size,"int32")];case"Rank":return[r.scalar(Xp("x",e,t,n).rank,"int32")];case"NoOp":return[r.scalar(1)];case"Print":var u=Xp("x",e,t,n),s=Xp("data",e,t,n),c=Xp("message",e,t,n),l=Xp("summarize",e,t,n);console.warn("The graph has a tf.print() operation,usually used for debugging, which slows down performance."),console.log(c);for(var f=0;f<s.length;f++)console.log(Array.prototype.slice.call(s[f].dataSync()).slice(0,l));return[u];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}},am=function(){function e(t,n){(0,D.Z)(this,e),this.keyDType=t,this.valueDType=n,this.handle=(0,ii.scalar)(0),this.tensorMap=new Map,(0,ii.keep)(this.handle)}return(0,F.Z)(e,[{key:"id",get:function(){return this.handle.id}},{key:"clearAndClose",value:function(){this.tensorMap.forEach((function(e){return e.dispose()})),this.tensorMap.clear(),this.handle.dispose()}},{key:"size",value:function(){return this.tensorMap.size}},{key:"tensorSize",value:function(){return hi.i(this.size(),"int32")}},{key:"import",value:function(){var e=(0,Da.Z)(E().mark((function e(t,n){var r,a=this;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.checkKeyAndValueTensor(t,n),e.next=3,t.data();case 3:return r=e.sent,this.tensorMap.forEach((function(e){return e.dispose()})),this.tensorMap.clear(),e.abrupt("return",(0,ii.tidy)((function(){var e=(0,ii.unstack)(n),t=r.length,i=e.length;ii.util.assert(t===i,(function(){return"The number of elements doesn't match, keys has "+"".concat(t," elements, the values has ").concat(i," ")+"elements."}));for(var o=0;o<t;o++){var u=r[o],s=e[o];(0,ii.keep)(s),a.tensorMap.set(u,s)}return a.handle})));case 7:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"find",value:function(){var e=(0,Da.Z)(E().mark((function e(t,n){var r,a=this;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.checkKeyAndValueTensor(t,n),e.next=3,t.data();case 3:return r=e.sent,e.abrupt("return",(0,ii.tidy)((function(){for(var e=[],t=0;t<r.length;t++){var i=r[t],o=a.findWithDefault(i,n);e.push(o)}return(0,ii.stack)(e)})));case 5:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"findWithDefault",value:function(e,t){var n=this.tensorMap.get(e);return null!=n?n:t}},{key:"checkKeyAndValueTensor",value:function(e,t){if(e.dtype!==this.keyDType)throw new Error("Expect key dtype ".concat(this.keyDType,", but got ")+"".concat(e.dtype));if(t.dtype!==this.valueDType)throw new Error("Expect value dtype ".concat(this.valueDType,", but got ")+"".concat(t.dtype))}}]),e}(),im=function(){var e=(0,Da.Z)(E().mark((function e(t,n,r,a){var i,o,u,s,c,l,f,d,h,p,v,m,g,y;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=t.op,e.next="HashTable"===e.t0||"HashTableV2"===e.t0?3:"InitializeTable"===e.t0||"InitializeTableV2"===e.t0||"LookupTableImport"===e.t0||"LookupTableImportV2"===e.t0?13:"LookupTableFind"===e.t0||"LookupTableFindV2"===e.t0?21:"LookupTableSize"===e.t0||"LookupTableSizeV2"===e.t0?29:32;break;case 3:if(null==(i=a.getHashTableHandleByName(t.name))){e.next=8;break}return e.abrupt("return",[i]);case 8:return o=Xp("keyDType",t,n,r),u=Xp("valueDType",t,n,r),s=new am(o,u),a.addHashTable(t.name,s),e.abrupt("return",[s.handle]);case 13:return c=Xp("tableHandle",t,n,r,a),l=Xp("keys",t,n,r),f=Xp("values",t,n,r),d=a.getHashTableById(c.id),e.next=19,d.import(l,f);case 19:return e.t1=e.sent,e.abrupt("return",[e.t1]);case 21:return h=Xp("tableHandle",t,n,r,a),p=Xp("keys",t,n,r),v=Xp("defaultValue",t,n,r),m=a.getHashTableById(h.id),e.next=27,m.find(p,v);case 27:return e.t2=e.sent,e.abrupt("return",[e.t2]);case 29:return g=Xp("tableHandle",t,n,r,a),y=a.getHashTableById(g.id),e.abrupt("return",[y.tensorSize()]);case 32:throw TypeError("Node type ".concat(t.op," is not implemented"));case 33:case"end":return e.stop()}}),e)})));return function(t,n,r,a){return e.apply(this,arguments)}}(),om=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:x;switch(e.op){case"ResizeBilinear":var a=Xp("images",e,t,n),i=Xp("size",e,t,n),o=Xp("alignCorners",e,t,n),u=Xp("halfPixelCenters",e,t,n);return[r.image.resizeBilinear(a,[i[0],i[1]],o,u)];case"ResizeNearestNeighbor":var s=Xp("images",e,t,n),c=Xp("size",e,t,n),l=Xp("alignCorners",e,t,n),f=Xp("halfPixelCenters",e,t,n);return[r.image.resizeNearestNeighbor(s,[c[0],c[1]],l,f)];case"CropAndResize":var d=Xp("image",e,t,n),h=Xp("boxes",e,t,n),p=Xp("boxInd",e,t,n),v=Xp("cropSize",e,t,n),m=Xp("method",e,t,n),g=Xp("extrapolationValue",e,t,n);return[r.image.cropAndResize(d,h,p,v,m,g)];case"ImageProjectiveTransformV3":var y=Xp("images",e,t,n),b=Xp("transforms",e,t,n),w=Xp("outputShape",e,t,n),k=Xp("fillValue",e,t,n),_=Xp("interpolation",e,t,n),S=Xp("fillMode",e,t,n);return[r.image.transform(y,b,_.toLowerCase(),S.toLowerCase(),k,w)];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}},um=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:x;switch(e.op){case"Equal":return[r.equal(Xp("a",e,t,n),Xp("b",e,t,n))];case"NotEqual":return[r.notEqual(Xp("a",e,t,n),Xp("b",e,t,n))];case"Greater":return[r.greater(Xp("a",e,t,n),Xp("b",e,t,n))];case"GreaterEqual":return[r.greaterEqual(Xp("a",e,t,n),Xp("b",e,t,n))];case"Less":return[r.less(Xp("a",e,t,n),Xp("b",e,t,n))];case"LessEqual":return[r.lessEqual(Xp("a",e,t,n),Xp("b",e,t,n))];case"LogicalAnd":return[r.logicalAnd(Xp("a",e,t,n),Xp("b",e,t,n))];case"LogicalNot":return[r.logicalNot(Xp("a",e,t,n))];case"LogicalOr":return[r.logicalOr(Xp("a",e,t,n),Xp("b",e,t,n))];case"Select":case"SelectV2":return[r.where(Xp("condition",e,t,n),Xp("a",e,t,n),Xp("b",e,t,n))];case"BitwiseAnd":return[r.bitwiseAnd(Xp("a",e,t,n),Xp("b",e,t,n))];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}},sm=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:x;switch(e.op){case"BatchMatMul":case"BatchMatMulV2":case"MatMul":return[r.matMul(Xp("a",e,t,n),Xp("b",e,t,n),Xp("transposeA",e,t,n),Xp("transposeB",e,t,n))];case"Einsum":return[r.einsum.apply(r,[Xp("equation",e,t,n)].concat((0,I.Z)(Xp("tensors",e,t,n))))];case"Transpose":return[r.transpose(Xp("x",e,t,n),Xp("perm",e,t,n))];case"_FusedMatMul":var a=Xp("fusedOps",e,t,n),i=(0,C.Z)(a,2),o=i[0],u=i[1],s="biasadd"===o,c="prelu"===u,l=Xp("numArgs",e,t,n),f=Xp("leakyreluAlpha",e,t,n);if(s){if(c&&2!==l)throw new Error("Fused MatMul with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!c&&1!==l)throw new Error("Fused MatMul with BiasAdd must have one extra argument: bias.")}var d=Xp("args",e,t,n),h=(0,C.Z)(d,2),p=h[0],v=h[1];return[r.fused.matMul({a:Xp("a",e,t,n),b:Xp("b",e,t,n),transposeA:Xp("transposeA",e,t,n),transposeB:Xp("transposeB",e,t,n),bias:p,activation:u,preluActivationWeights:v,leakyreluAlpha:f})];case"MatrixBandPart":return[r.linalg.bandPart(Xp("a",e,t,n),Xp("numLower",e,t,n),Xp("numUpper",e,t,n))];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}},cm=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:x;switch(e.op){case"EuclideanNorm":return[r.euclideanNorm(Xp("x",e,t,n),Xp("axis",e,t,n),Xp("keepDims",e,t,n))];case"FusedBatchNorm":case"FusedBatchNormV2":case"FusedBatchNormV3":return[r.batchNorm(Xp("x",e,t,n),Xp("mean",e,t,n),Xp("variance",e,t,n),Xp("offset",e,t,n),Xp("scale",e,t,n),Xp("epsilon",e,t,n))];case"LRN":return[r.localResponseNormalization(Xp("x",e,t,n),Xp("radius",e,t,n),Xp("bias",e,t,n),Xp("alpha",e,t,n),Xp("beta",e,t,n))];case"Softmax":return[r.softmax(Xp("x",e,t,n))];case"LogSoftmax":return[r.logSoftmax(Xp("x",e,t,n))];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}},lm=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:x;switch(e.op){case"RaggedGather":var a=r.raggedGather(Xp("paramsNestedSplits",e,t,n),Xp("paramsDenseValues",e,t,n),Xp("indices",e,t,n),Xp("outputRaggedRank",e,t,n)),i=a.outputNestedSplits,o=a.outputDenseValues;return i.concat(o);case"RaggedRange":var u=r.raggedRange(Xp("starts",e,t,n),Xp("limits",e,t,n),Xp("splits",e,t,n)),s=u.rtNestedSplits,c=u.rtDenseValues;return[s,c];case"RaggedTensorToTensor":return[r.raggedTensorToTensor(Xp("shape",e,t,n),Xp("values",e,t,n),Xp("defaultValue",e,t,n),Xp("rowPartitionTensors",e,t,n),Xp("rowPartitionTypes",e,t,n))];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}},fm=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:x;switch(e.op){case"Max":var a=Xp("axis",e,t,n),i=Xp("keepDims",e,t,n);return[r.max(Xp("x",e,t,n),a,i)];case"Mean":var o=Xp("axis",e,t,n),u=Xp("keepDims",e,t,n);return[r.mean(Xp("x",e,t,n),o,u)];case"Min":var s=Xp("axis",e,t,n),c=Xp("keepDims",e,t,n);return[r.min(Xp("x",e,t,n),s,c)];case"Sum":var l=Xp("axis",e,t,n),f=Xp("keepDims",e,t,n);return[r.sum(Xp("x",e,t,n),l,f)];case"All":var d=Xp("axis",e,t,n),h=Xp("keepDims",e,t,n);return[r.all(Xp("x",e,t,n),d,h)];case"Any":var p=Xp("axis",e,t,n),v=Xp("keepDims",e,t,n);return[r.any(Xp("x",e,t,n),p,v)];case"ArgMax":var m=Xp("axis",e,t,n);return[r.argMax(Xp("x",e,t,n),m)];case"ArgMin":var g=Xp("axis",e,t,n);return[r.argMin(Xp("x",e,t,n),g)];case"Prod":var y=Xp("axis",e,t,n),b=Xp("keepDims",e,t,n);return[r.prod(Xp("x",e,t,n),y,b)];case"Cumprod":var w=Xp("axis",e,t,n),k=Xp("exclusive",e,t,n),_=Xp("reverse",e,t,n);return[r.cumprod(Xp("x",e,t,n),w,k,_)];case"Cumsum":var S=Xp("axis",e,t,n),C=Xp("exclusive",e,t,n),A=Xp("reverse",e,t,n);return[r.cumsum(Xp("x",e,t,n),S,C,A)];case"Bincount":var E=Xp("x",e,t,n),N=Xp("weights",e,t,n),T=Xp("size",e,t,n);return[r.bincount(E,N,T)];case"DenseBincount":var I=Xp("x",e,t,n),D=Xp("weights",e,t,n),F=Xp("size",e,t,n),M=Xp("binaryOutput",e,t,n);return[r.denseBincount(I,D,F,M)];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}},dm=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:x;switch(e.op){case"ConcatV2":case"Concat":var a=Xp("n",e,t,n),i=Xp("axis",e,t,n),o=Xp("tensors",e,t,n);return o=o.slice(0,a),[r.concat(o,i)];case"Gather":var u=Xp("x",e,t,n),s=Xp("indices",e,t,n);return[r.gather(u,r.cast(s,"int32"),0)];case"GatherV2":var c=Xp("axis",e,t,n),l=Xp("batchDims",e,t,n),f=Xp("x",e,t,n),d=Xp("indices",e,t,n);return[r.gather(f,r.cast(d,"int32"),c,l)];case"Reverse":for(var h=Xp("dims",e,t,n),p=[],v=0;v<h.length;v++)h[v]&&p.push(v);var m=Xp("x",e,t,n);return[r.reverse(m,p)];case"ReverseV2":var g=Xp("axis",e,t,n),y=Xp("x",e,t,n);return[r.reverse(y,g)];case"Slice":var b=Xp("begin",e,t,n),w=Xp("size",e,t,n);return[r.slice(Xp("x",e,t,n),b,w)];case"StridedSlice":var k=Xp("begin",e,t,n),_=Xp("end",e,t,n),S=Xp("strides",e,t,n),C=Xp("beginMask",e,t,n),A=Xp("endMask",e,t,n),E=Xp("ellipsisMask",e,t,n),N=Xp("newAxisMask",e,t,n),T=Xp("shrinkAxisMask",e,t,n),I=Xp("x",e,t,n);return[r.stridedSlice(I,k,_,S,C,A,E,N,T)];case"Pack":return(0,ii.tidy)((function(){var a=Xp("axis",e,t,n),i=Xp("tensors",e,t,n),o=i[0].shape,u=r.squeeze(i[0]).shape,s=i.map((function(e){var t=ii.util.arraysEqual(e.shape,o);if(!t&&!ii.util.arraysEqual(r.squeeze(e).shape,u))throw new Error("the input tensors shape does not match");return t?e:r.reshape(e,o)}));return[r.stack(s,a)]}));case"Unpack":var D=Xp("axis",e,t,n),F=Xp("tensor",e,t,n);return r.unstack(F,D);case"Tile":var M=Xp("reps",e,t,n);return[r.tile(Xp("x",e,t,n),M)];case"Split":case"SplitV":var O=Xp("axis",e,t,n),R=Xp("numOrSizeSplits",e,t,n),j=Xp("x",e,t,n);return r.split(j,R,O);case"ScatterNd":var B=Xp("indices",e,t,n),z=Xp("values",e,t,n),Z=Xp("shape",e,t,n);return[r.scatterND(B,z,Z)];case"GatherNd":var L=Xp("x",e,t,n),P=Xp("indices",e,t,n);return[r.gatherND(L,P)];case"SparseToDense":var U=Xp("sparseIndices",e,t,n),W=Xp("outputShape",e,t,n),V=Xp("sparseValues",e,t,n),q=Xp("defaultValue",e,t,n);return[r.sparseToDense(U,V,W,V.dtype===q.dtype?q:r.cast(q,V.dtype))];case"TensorScatterUpdate":var G=Xp("indices",e,t,n),H=Xp("values",e,t,n),X=Xp("tensor",e,t,n);return[r.tensorScatterUpdate(X,G,H)];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}},hm=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:x;switch(e.op){case"SparseFillEmptyRows":var a=r.sparse.sparseFillEmptyRows(Xp("indices",e,t,n),Xp("values",e,t,n),Xp("denseShape",e,t,n),Xp("defaultValue",e,t,n)),i=a.outputIndices,o=a.outputValues,u=a.emptyRowIndicator,s=a.reverseIndexMap;return[i,o,u,s];case"SparseReshape":var c=r.sparse.sparseReshape(Xp("inputIndices",e,t,n),Xp("inputShape",e,t,n),Xp("newShape",e,t,n)),l=c.outputIndices,f=c.outputShape;return[l,f];case"SparseSegmentMean":var d=r.sparse.sparseSegmentMean(Xp("data",e,t,n),Xp("indices",e,t,n),Xp("segmentIds",e,t,n));return[d];case"SparseSegmentSum":var h=r.sparse.sparseSegmentSum(Xp("data",e,t,n),Xp("indices",e,t,n),Xp("segmentIds",e,t,n));return[h];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}},pm=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:x;switch(e.op){case"FFT":return[r.fft(Xp("x",e,t,n))];case"IFFT":return[r.ifft(Xp("x",e,t,n))];case"RFFT":return[r.rfft(Xp("x",e,t,n))];case"IRFFT":return[r.irfft(Xp("x",e,t,n))];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}},vm=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:x;switch(e.op){case"StaticRegexReplace":return[r.string.staticRegexReplace(Xp("input",e,t,n),Xp("pattern",e,t,n),Xp("rewrite",e,t,n),Xp("replaceGlobal",e,t,n))];case"StringNGrams":var a=r.string.stringNGrams(Xp("data",e,t,n),Xp("dataSplits",e,t,n),Xp("separator",e,t,n),Xp("nGramWidths",e,t,n),Xp("leftPad",e,t,n),Xp("rightPad",e,t,n),Xp("padWidth",e,t,n),Xp("preserveShortSequences",e,t,n)),i=a.nGrams,o=a.nGramsSplits;return[i,o];case"StringSplit":var u=r.string.stringSplit(Xp("input",e,t,n),Xp("delimiter",e,t,n),Xp("skipEmpty",e,t,n)),s=u.indices,c=u.values,l=u.shape;return[s,c,l];case"StringToHashBucketFast":var f=r.string.stringToHashBucketFast(Xp("input",e,t,n),Xp("numBuckets",e,t,n));return[f];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}},mm=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:x;switch(e.op){case"Cast":return[r.cast(Xp("x",e,t,n),Xp("dtype",e,t,n))];case"ExpandDims":var a=Xp("axis",e,t,n);return[r.expandDims(Xp("x",e,t,n),a)];case"Squeeze":var i=Xp("axis",e,t,n);return[r.squeeze(Xp("x",e,t,n),i)];case"Reshape":return[r.reshape(Xp("x",e,t,n),Xp("shape",e,t,n))];case"EnsureShape":return[r.ensureShape(Xp("x",e,t,n),Xp("shape",e,t,n))];case"MirrorPad":return[r.mirrorPad(Xp("x",e,t,n),Xp("padding",e,t,n),Xp("mode",e,t,n))];case"PadV2":case"Pad":return[r.pad(Xp("x",e,t,n),Xp("padding",e,t,n),Xp("constantValue",e,t,n))];case"SpaceToBatchND":var o=Xp("blockShape",e,t,n),u=Xp("paddings",e,t,n);return[r.spaceToBatchND(Xp("x",e,t,n),o,u)];case"BatchToSpaceND":var s=Xp("blockShape",e,t,n),c=Xp("crops",e,t,n);return[r.batchToSpaceND(Xp("x",e,t,n),s,c)];case"DepthToSpace":var l=Xp("blockSize",e,t,n),f=Xp("dataFormat",e,t,n).toUpperCase();return[r.depthToSpace(Xp("x",e,t,n),l,f)];case"BroadcastTo":return[r.broadcastTo(Xp("x",e,t,n),Xp("shape",e,t,n))];case"BroadcastArgs":return[r.broadcastArgs(Xp("s0",e,t,n),Xp("s1",e,t,n))];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}};function gm(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:ii.tidy,i=function(e,t,n){switch(e.category){case"arithmetic":return a((function(){return zv(e,t,n)}));case"basic_math":return a((function(){return Zv(e,t,n)}));case"control":return Yv(e,t,n);case"convolution":return a((function(){return Qv(e,t,n)}));case"creation":return a((function(){return Jv(e,t,n)}));case"dynamic":return tm(e,t,n);case"evaluation":return a((function(){return nm(e,t,n)}));case"image":return a((function(){return om(e,t,n)}));case"graph":return a((function(){return rm(e,t,n)}));case"logical":return a((function(){return um(e,t,n)}));case"matrices":return a((function(){return sm(e,t,n)}));case"normalization":return a((function(){return cm(e,t,n)}));case"ragged":return a((function(){return lm(e,t,n)}));case"reduction":return a((function(){return fm(e,t,n)}));case"slice_join":return a((function(){return dm(e,t,n)}));case"sparse":return a((function(){return hm(e,t,n)}));case"spectral":return a((function(){return pm(e,t,n)}));case"string":return a((function(){return vm(e,t,n)}));case"transformation":return a((function(){return mm(e,t,n)}));case"hash_table":return im(e,t,n,r);case"custom":var i=Hp(e.op);if(i&&i.customExecutor)return i.customExecutor(new jv(e,t,n));throw TypeError("Custom op ".concat(e.op," is not registered."));default:throw TypeError("Unknown op '".concat(e.op,"'. File an issue at ")+"https://github.com/tensorflow/tfjs/issues so we can add it, or register a custom execution with tf.registerOp()")}}(e,t,n);return ii.util.isPromise(i)?i.then((function(e){return[].concat(e)})):[].concat(i)}var ym=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=arguments.length>4?arguments[4]:void 0;(0,D.Z)(this,e),this.weightMap=t,this.tensorArrayMap=n,this.tensorListMap=r,this.functionMap=a,this.parseNodeNameCache=i,this.rootContext={id:0,frameName:"",iterationId:0},this.contexts=[this.rootContext],this.lastId=0,this.generateCurrentContextIds()}return(0,F.Z)(e,[{key:"newFrame",value:function(e,t){return{id:e,frameName:t,iterationId:0}}},{key:"currentContext",get:function(){return this.contexts},set:function(e){this.contexts!==e&&(this.contexts=e,this.generateCurrentContextIds())}},{key:"currentContextId",get:function(){return this._currentContextIds[0]}},{key:"currentContextIds",get:function(){return this._currentContextIds}},{key:"generateCurrentContextIds",value:function(){for(var e=[],t=0;t<this.contexts.length-1;t++){var n=this.contexts.slice(0,this.contexts.length-t);e.push(this.contextIdforContexts(n))}e.push(""),this._currentContextIds=e}},{key:"contextIdforContexts",value:function(e){return e?e.map((function(e){return 0===e.id&&0===e.iterationId?"":"".concat(e.frameName,"-").concat(e.iterationId)})).join("/"):""}},{key:"enterFrame",value:function(e){this.contexts&&(this.lastId++,this.contexts=this.contexts.slice(),this.contexts.push(this.newFrame(this.lastId,e)),this._currentContextIds.unshift(this.contextIdforContexts(this.contexts)))}},{key:"exitFrame",value:function(){if(!(this.contexts&&this.contexts.length>1))throw new Error("Cannot exit frame, the context is empty");this.contexts=this.contexts.slice(),this.contexts.splice(-1),this.currentContextIds.shift()}},{key:"nextIteration",value:function(){if(!(this.contexts&&this.contexts.length>0))throw new Error("Cannot increase frame iteration, the context is empty");this.contexts=this.contexts.slice(),this.lastId++;var e=Object.assign({},this.contexts[this.contexts.length-1]);e.iterationId+=1,e.id=this.lastId,this.contexts.splice(-1,1,e),this._currentContextIds.splice(0,1,this.contextIdforContexts(this.contexts))}},{key:"getWeight",value:function(e){return this.weightMap[e]}},{key:"addTensorArray",value:function(e){this.tensorArrayMap[e.id]=e}},{key:"getTensorArray",value:function(e){return this.tensorArrayMap[e]}},{key:"addTensorList",value:function(e){this.tensorListMap[e.id]=e}},{key:"getTensorList",value:function(e){return this.tensorListMap[e]}},{key:"dispose",value:function(e){for(var t in this.tensorArrayMap)this.tensorArrayMap[t].clearAndClose(e);for(var n in this.tensorListMap)this.tensorListMap[n].clearAndClose(e)}}]),e}();function bm(e,t,n,r){var a=new Set,i=[],o=null,u=null,s=new Set,c=new Set(Object.keys(e).map((function(e){return Jp(e)[0]})));r=r||[];for(var l=new Set(r.map((function(e){return Jp(e.name)[0]}))),f=(0,I.Z)(t);f.length>0;){var d=f.pop();(Cm(d)||Am(d)||Em(d))&&null==o&&(u=(o=d).children.map((function(e){return e.name})).filter((function(e){return a.has(e)}))),a.add(d.name),null==n[d.name]&&(c.has(d.name)||l.has(d.name)||(0!==d.inputs.length?d.inputs.forEach((function(e){s.has(e.name)||(s.add(e.name),f.push(e))})):i.push(d.name)))}return{inputs:e,outputs:t,usedNodes:a,missingInputs:i,dynamicNode:o,syncInputs:u}}function xm(e,t){var n=t.usedNodes,r=t.inputs,a=Object.keys(r).map((function(e){return Jp(e)[0]})).map((function(t){return e.nodes[t]})),i=e.initNodes||[],o=function(e){return n.has("string"===typeof e?e:e.name)};function u(e){return(0,I.Z)(new Map(e.map((function(e){return[e.name,e]}))).values())}var s,c=u([].concat((0,I.Z)(a),(0,I.Z)(e.weights),(0,I.Z)(i))).filter(o),l=u([].concat((0,I.Z)(c),(0,I.Z)(Object.values(e.nodes)))).filter(o),f=new Map(l.map((function(e){return[e.name,e]}))),d={},h=(0,B.Z)(l);try{for(h.s();!(s=h.n()).done;){var p=s.value;d[p.name]=d[p.name]||0;var v,m=(0,B.Z)(p.children);try{for(m.s();!(v=m.n()).done;){var g=v.value;o(g)||(d[g.name]=Number.POSITIVE_INFINITY),d[g.name]=(d[g.name]||0)+1}}catch(E){m.e(E)}finally{m.f()}}}catch(E){h.e(E)}finally{h.f()}for(var y=Object.entries(d).filter((function(e){return 0===(0,C.Z)(e,2)[1]})).map((function(e){return(0,C.Z)(e,1)[0]})),b=(0,I.Z)(y);y.length>0;){var x,w=y.pop(),k=f.get(w),_=(0,B.Z)(k.children.filter(o));try{for(_.s();!(x=_.n()).done;){var S=x.value;0===--d[S.name]&&(b.push(S.name),y.push(S.name))}}catch(E){_.e(E)}finally{_.f()}}var A=function(e,t){var n=new Map(e.map((function(e){return[e.name,e]}))),r=t.map((function(e){return e.name})),a=new Set(r);for(;r.length>0;){var i,o=r.pop(),u=n.get(o),s=(0,B.Z)(u.children);try{for(s.s();!(i=s.n()).done;){var c=i.value;n.has(c.name)&&!a.has(c.name)&&(a.add(c.name),r.push(c.name))}}catch(E){s.e(E)}finally{s.f()}}var l=e.filter((function(e){return a.has(e.name)}));return l}(b.map((function(e){return f.get(e)})),c);return function(e,t){var n,r=new Map(e.map((function(e,t){return[e.name,t]}))),a=new Set(t.map((function(e){return e.name}))),i=function(e){return a.has("string"===typeof e?e:e.name)},o=new Set(e.map((function(e){return e.name}))),u=function(e){return o.has("string"===typeof e?e:e.name)},s=(0,B.Z)(e);try{for(s.s();!(n=s.n()).done;){var c,l=n.value,f=(0,B.Z)(l.children.filter(u));try{for(f.s();!(c=f.n()).done;){var d=c.value;if(!r.has(d.name))throw new wm("Child ".concat(d.name," of node ").concat(l.name," is unreachable."));if(r.get(l.name)>r.get(d.name))throw new wm("Node ".concat(l.name," is scheduled to run after its child ").concat(d.name,"."))}}catch(E){f.e(E)}finally{f.f()}if(!i(l)){var h,p=(0,B.Z)(l.inputs);try{for(p.s();!(h=p.n()).done;){var v=h.value;if(!r.has(v.name))throw new wm("Input ".concat(v.name," of node ").concat(l.name," is unreachable."));if(r.get(v.name)>r.get(l.name))throw new wm("Node ".concat(l.name," is scheduled to run before its input ").concat(v.name,"."))}}catch(E){p.e(E)}finally{p.f()}}}}catch(E){s.e(E)}finally{s.f()}}(A,c),A}var wm=function(e){(0,M.Z)(n,e);var t=(0,O.Z)(n);function n(e){return(0,D.Z)(this,n),t.call(this,"NodesExecutionOrderError: ".concat(e))}return(0,F.Z)(n)}((0,R.Z)(Error));var km=new Set(["Switch","Merge","Enter","Exit","NextIteration","StatelessIf","StatelessWhile","if","While"]),_m=new Set(["NonMaxSuppressionV2","NonMaxSuppressionV3","NonMaxSuppressionV5","Where"]),Sm=new Set(["HashTable","HashTableV2","LookupTableImport","LookupTableImportV2","LookupTableFind","LookupTableFindV2","LookupTableSize","LookupTableSizeV2"]);function Cm(e){return km.has(e.op)}function Am(e){return _m.has(e.op)}function Em(e){return Sm.has(e.op)}var Nm=function(){function e(t,n){var r=this;(0,D.Z)(this,e),this.graph=t,this.parent=n,this.compiledMap=new Map,this.parseNodeNameCache=new Map,this._weightMap={},this.SEPARATOR=",",this._functions={},this._functionExecutorMap={},this.keepIntermediateTensors=!1,this._outputs=t.outputs,this._inputs=t.inputs,this._initNodes=t.initNodes,this._signature=t.signature,this._functions=t.functions,null!=t.functions&&Object.keys(t.functions).forEach((function(n){r._functionExecutorMap[n]=new e(t.functions[n],r)}))}return(0,F.Z)(e,[{key:"weightIds",get:function(){return this.parent?this.parent.weightIds:this._weightIds}},{key:"functionExecutorMap",get:function(){return this.parent?this.parent.functionExecutorMap:this._functionExecutorMap}},{key:"weightMap",get:function(){return this.parent?this.parent.weightMap:this._weightMap},set:function(e){var t,n=Object.keys(e).map((function(t){return e[t].map((function(e){return e.id}))}));this._weightIds=(t=[]).concat.apply(t,(0,I.Z)(n)),this._weightMap=e}},{key:"resourceManager",set:function(e){this._resourceManager=e}},{key:"inputs",get:function(){return this._inputs.map((function(e){return{name:e.name,shape:e.attrParams.shape?e.attrParams.shape.value:void 0,dtype:e.attrParams.dtype?e.attrParams.dtype.value:void 0}}))}},{key:"outputs",get:function(){return this._outputs.map((function(e){return{name:e.name,shape:e.attrParams.shape?e.attrParams.shape.value:void 0,dtype:e.attrParams.dtype?e.attrParams.dtype.value:void 0}}))}},{key:"inputNodes",get:function(){return this._inputs.map((function(e){return e.signatureKey||e.name}))}},{key:"outputNodes",get:function(){return this._outputs.map((function(e){var t=e.signatureKey||e.name;return e.defaultOutput?"".concat(t,":").concat(e.defaultOutput):t}))}},{key:"functions",get:function(){var e=this;return Object.keys(this._functions).reduce((function(t,n){return t[n]=e._functions[n].signature,t}),{})}},{key:"getCompilationKey",value:function(e,t){var n=e.map((function(e){return e.name})).sort(),r=t.map((function(e){return e.name})).sort();return n.join(this.SEPARATOR)+"--"+r.join(this.SEPARATOR)}},{key:"compile",value:function(e,t){var n=bm(e,t,this.weightMap,this._initNodes),r=n.missingInputs,a=n.dynamicNode,i=n.syncInputs;if(null!=a)throw new Error("This execution contains the node '".concat(a.name,"', which has ")+"the dynamic op '".concat(a.op,"'. Please use ")+"model.executeAsync() instead. Alternatively, to avoid the "+"dynamic ops, specify the inputs [".concat(i,"]"));if(r.length>0){var o=t.map((function(e){return e.name})),u=Object.keys(e);throw new Error("Cannot compute the outputs [".concat(o,"] from the provided inputs ")+"[".concat(u,"]. Missing the following inputs: [").concat(r,"]"))}var s=xm(this.graph,n),c=function(e){for(var t=new Map(e.map((function(e,t){return[e.name,t]}))),n=Number.MAX_SAFE_INTEGER,r=e.map((function(e,t){return Cm(e)?n:t})),a=function(e){var n=r[t.get(e.name)];return null==n?-1:n},i=e.map((function(e,t){return e.children.map(a).reduce((function(e,t){return Math.max(e,t)}),r[t])})),o=new Map,u=0;u<e.length;++u){var s=i[u];if(s!==n){var c=e[u],l=e[s];o.has(l.name)||o.set(l.name,[]),o.get(l.name).push(c)}}return o}(s);return{orderedNodes:s,nodeLiveUntilMap:c}}},{key:"cloneAndKeepTensor",value:function(e){if(null==e)return null;var t=e.clone();return(0,ii.keep)(t),t}},{key:"cloneTensorList",value:function(e){var t=this;return e?e.map((function(e){return t.cloneAndKeepTensor(e)})):null}},{key:"cloneTensorMap",value:function(e){var t=this;return Object.fromEntries(Object.entries(e).map((function(e){var n=(0,C.Z)(e,2),r=n[0],a=n[1];return[r,t.cloneTensorList(a)]})))}},{key:"execute",value:function(e,t){var n=this;this.disposeIntermediateTensors(),e=this.mapInputs(e);var r=Object.keys(e).sort();this.checkInputs(e),this.checkInputShapeAndType(e),t=this.mapOutputs(t),this.checkOutputs(t);var a=r.map((function(e){return n.graph.nodes[Jp(e)[0]]})),i=t.map((function(e){return Jp(e)[0]})),o=new Set(i),u=i.map((function(e){return n.graph.nodes[e]}));0===u.length&&(u=this._outputs);var s=this.getCompilationKey(a,u),c=this.compiledMap.get(s);null==c&&(c=this.compile(e,u),this.compiledMap.set(s,c));try{this.keepIntermediateTensors=(0,ii.env)().getBool("KEEP_INTERMEDIATE_TENSORS")}catch(Xz){this.keepIntermediateTensors=!1,console.warn(Xz.message)}var l={},f={};return(0,ii.tidy)((function(){var r=new ym(n.weightMap,l,f,n.functionExecutorMap,n.parseNodeNameCache),a=Object.assign({},n.weightMap);n.keepIntermediateTensors&&(n.clonedTensorsMap=n.cloneTensorMap(n.weightMap)),Object.keys(e).forEach((function(t){var i=Jp(t,r),o=(0,C.Z)(i,2),u=o[0],s=[];s[o[1]]=e[t],a[u]=s,n.keepIntermediateTensors&&(n.clonedTensorsMap[u]=n.cloneTensorList(s))}));var i,u=n.getFrozenTensorIds(a),s=c,d=s.orderedNodes,h=s.nodeLiveUntilMap,p=(0,B.Z)(d);try{for(p.s();!(i=p.n()).done;){var v=i.value;if(!a[v.name]){var m=gm(v,a,r,n._resourceManager);if(ii.util.isPromise(m))throw new Error("The execution of the op '".concat(v.op,"' returned a promise. ")+"Please use model.executeAsync() instead.");a[v.name]=m,n.keepIntermediateTensors&&(n.clonedTensorsMap[v.name]=n.cloneTensorList(m)),n.checkTensorForDisposalWithNodeLiveUntilInfo(v,a,r,u,o,h.get(v.name))}}}catch(g){p.e(g)}finally{p.f()}return null==n.parent&&r.dispose(u),t.map((function(e){return Kp(e,a,r)}))}))}},{key:"getFrozenTensorIds",value:function(e){var t=[].concat.apply([],Object.keys(e).map((function(t){return e[t]})).map((function(e){return e.map((function(e){return e.id}))})));return new Set(t)}},{key:"checkTensorForDisposal",value:function(e,t,n,r,a,i,o){if(!Cm(t)&&!i.has(e)){var u,s=(0,B.Z)(n[e]);try{for(s.s();!(u=s.n()).done;){var c=u.value;null!=c&&(o[c.id]=(o[c.id]||0)+t.children.length)}}catch(y){s.e(y)}finally{s.f()}var l,f=(0,B.Z)(t.inputs);try{for(f.s();!(l=f.n()).done;){var d=l.value;if(!Cm(d)){var h=Yp(d.name,n,r);if(null!=h){var p,v=(0,B.Z)(h);try{for(v.s();!(p=v.n()).done;){var m=p.value;if(m&&!m.kept&&!a.has(m.id)){var g=o[m.id];1===g?(m.dispose(),delete o[m.id]):null!=g&&o[m.id]--}}}catch(y){v.e(y)}finally{v.f()}}}}}catch(y){f.e(y)}finally{f.f()}}}},{key:"checkTensorForDisposalWithNodeLiveUntilInfo",value:function(e,t,n,r,a,i){function o(e){return Cm(e)||a.has(e.name)}if(!Cm(e)&&null!=i){var u,s=(0,B.Z)(i);try{for(s.s();!(u=s.n()).done;){var c=u.value;if(!o(c)){var l,f=Yp(c.name,t,n),d=(0,B.Z)(f);try{for(d.s();!(l=d.n()).done;){var h=l.value;!h||h.kept||r.has(h.id)||h.dispose()}}catch(p){d.e(p)}finally{d.f()}}}}catch(p){s.e(p)}finally{s.f()}}}},{key:"executeAsync",value:function(){var e=(0,Da.Z)(E().mark((function e(t,n){return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._executeAsync(t,n));case 1:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"disposeIntermediateTensors",value:function(){this.clonedTensorsMap&&(Object.values(this.clonedTensorsMap).forEach((function(e){var t,n=(0,B.Z)(e);try{for(n.s();!(t=n.n()).done;){var r=t.value;r&&!r.isDisposed&&r.dispose()}}catch(a){n.e(a)}finally{n.f()}})),this.clonedTensorsMap=null)}},{key:"getIntermediateTensors",value:function(){return this.clonedTensorsMap}},{key:"_executeAsync",value:function(){var e=(0,Da.Z)(E().mark((function e(t,n){var r,a,i,o,u,s,c,l,f,d=arguments;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=d.length>2&&void 0!==d[2]&&d[2],a=d.length>3&&void 0!==d[3]?d[3]:{},i=d.length>4&&void 0!==d[4]?d[4]:{},this.disposeIntermediateTensors(),r||(t=this.mapInputs(t),this.checkInputs(t),this.checkInputShapeAndType(t),n=this.mapOutputs(n),this.checkOutputs(n));try{this.keepIntermediateTensors=(0,ii.env)().getBool("KEEP_INTERMEDIATE_TENSORS")}catch(Xz){this.keepIntermediateTensors=!1,console.warn(Xz.message)}return o=new ym(this.weightMap,a,i,this.functionExecutorMap,this.parseNodeNameCache),this.keepIntermediateTensors&&(this.clonedTensorsMap=this.cloneTensorMap(this.weightMap)),e.next=10,this.executeWithControlFlow(t,o,n,r);case 10:return u=e.sent,s=n.map((function(e){return Kp(e,u,o)})),c=s.map((function(e){return e.id})),l=Object.keys(t).map((function(e){return t[e].id})),f=new Set([].concat((0,I.Z)(c),(0,I.Z)(l),(0,I.Z)(this.weightIds))),Object.values(u).forEach((function(e){e.forEach((function(e){!e||e.isDisposed||f.has(e.id)||e.dispose()}))})),null==this.parent&&o.dispose(f),e.abrupt("return",s);case 18:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"executeFunctionAsync",value:function(){var e=(0,Da.Z)(E().mark((function e(t,n,r){var a,i=this;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.reduce((function(e,t,n){return e[i.inputs[n].name]=t,e}),{}),e.abrupt("return",this._executeAsync(a,this.outputNodes,!0,n,r));case 2:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"executeWithControlFlow",value:function(){var e=(0,Da.Z)(E().mark((function e(t,n,r,a){var i,o,u,s,c,l,f,d,h,p,v,m,g,y,b,x,w,k,_=this;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=Object.keys(t),o=i.map((function(e){return _.graph.nodes[Jp(e)[0]]})),u=r.map((function(e){return Jp(e)[0]})),s=new Set(u),0===(c=u.map((function(e){return _.graph.nodes[e]}))).length&&(c=this._outputs),l=bm(t,c,this.weightMap,this._initNodes),f=l.usedNodes,d=l.missingInputs,h=l.dynamicNode,p=l.syncInputs,v=[].concat((0,I.Z)(o),(0,I.Z)(this.graph.weights),(0,I.Z)(this._initNodes||[])).map((function(e){return{node:e,contexts:n.currentContext}})),m=Object.assign({},this.weightMap),Object.keys(t).forEach((function(e){var n=Jp(e),r=(0,C.Z)(n,2),a=r[0],i=[];i[r[1]]=t[e],m[a]=i})),g={},y=this.getFrozenTensorIds(m),b={};case 13:if(!(v.length>0)){e.next=19;break}return x=this.processStack(o,v,n,m,b,y,s,g,f),e.next=17,Promise.all(x);case 17:e.next=13;break;case 19:if(null!=h||a||console.warn("This model execution did not contain any nodes with control flow or dynamic output shapes. You can use model.execute() instead."),w=c.filter((function(e){return!Cm(e)&&!Kp(e.name,m,n)})).map((function(e){return e.name})),!(w.length>0)){e.next=25;break}throw k="",null!=h&&(k="Alternatively, to avoid the dynamic ops, use model.execute() "+"and specify the inputs [".concat(p,"]")),new Error("Cannot compute the outputs [".concat(w,"] from the provided ")+"inputs [".concat(i,"]. Consider providing the following inputs: ")+"[".concat(d,"]. ").concat(k));case 25:return e.abrupt("return",m);case 26:case"end":return e.stop()}}),e,this)})));return function(t,n,r,a){return e.apply(this,arguments)}}()},{key:"processStack",value:function(e,t,n,r,a,i,o,u,s){for(var c=this,l=[],f=function(){var e=t.pop();n.currentContext=e.contexts;var f="";if("Enter"===e.node.op&&Xp("isConstant",e.node,r,n)){var d=$p(e.node.name,n),h=(0,C.Z)(d,1);f=h[0]}if(null==r[e.node.name]){var p=gm(e.node,r,n,c._resourceManager);if(!f){var v=$p(e.node.name,n),m=(0,C.Z)(v,1);f=m[0]}var g=n.currentContext;ii.util.isPromise(p)?l.push(p.then((function(l){return r[f]=l,c.keepIntermediateTensors&&(c.clonedTensorsMap[f]=c.cloneTensorList(l)),n.currentContext=g,c.checkTensorForDisposal(f,e.node,r,n,i,o,u),c.processChildNodes(e.node,t,n,r,a,s),l}))):(r[f]=p,c.keepIntermediateTensors&&(c.clonedTensorsMap[f]=c.cloneTensorList(p)),c.checkTensorForDisposal(f,e.node,r,n,i,o,u),c.processChildNodes(e.node,t,n,r,a,s))}else c.processChildNodes(e.node,t,n,r,a,s)};t.length>0;)f();return l}},{key:"processChildNodes",value:function(e,t,n,r,a,i){e.children.forEach((function(e){var o=$p(e.name,n),u=(0,C.Z)(o,1)[0];!a[u]&&i.has(e.name)&&("Merge"===e.op?e.inputNames.some((function(e){return!!Kp(e,r,n)}))&&(a[u]=!0,t.push({contexts:n.currentContext,node:e})):e.inputNames.every((function(e){return!!Kp(e,r,n)}))&&(a[u]=!0,t.push({contexts:n.currentContext,node:e})))}))}},{key:"dispose",value:function(){var e=this;Object.keys(this.weightMap).forEach((function(t){return e.weightMap[t].forEach((function(e){return e.dispose()}))}))}},{key:"checkInputShapeAndType",value:function(e){var t=this;Object.keys(e).forEach((function(n){var r=e[n],a=Jp(n),i=(0,C.Z)(a,1)[0],o=t.graph.nodes[i];if(o.attrParams.shape&&o.attrParams.shape.value){var u=o.attrParams.shape.value,s=u.length===r.shape.length&&r.shape.every((function(e,t){return-1===u[t]||u[t]===e}));ii.util.assert(s,(function(){return"The shape of dict['".concat(o.name,"'] provided in ")+"model.execute(dict) must be [".concat(u,"], but was ")+"[".concat(r.shape,"]")}))}o.attrParams.dtype&&o.attrParams.dtype.value&&ii.util.assert(r.dtype===o.attrParams.dtype.value,(function(){return"The dtype of dict['".concat(o.name,"'] provided in ")+"model.execute(dict) must be "+"".concat(o.attrParams.dtype.value,", but was ").concat(r.dtype)}))}))}},{key:"mapInputs",value:function(e){var t,n,r={};for(var a in e){var i=null===(n=null===(t=this._signature)||void 0===t?void 0:t.inputs)||void 0===n?void 0:n[a];null!=i?r[i.name]=e[a]:r[a]=e[a]}return r}},{key:"checkInputs",value:function(e){var t=this,n=Object.keys(e).filter((function(e){var n=Jp(e),r=(0,C.Z)(n,1)[0];return null==t.graph.nodes[r]}));if(n.length>0)throw new Error("The dict provided in model.execute(dict) has "+"keys: [".concat(n,"] that are not part of graph"))}},{key:"mapOutputs",value:function(e){var t=this;return e.map((function(e){var n,r,a=null===(r=null===(n=t._signature)||void 0===n?void 0:n.outputs)||void 0===r?void 0:r[e];return null!=a?a.name:e}),{})}},{key:"checkOutputs",value:function(e){var t=this;e.forEach((function(e){var n=Jp(e),r=(0,C.Z)(n,1)[0];if(!t.graph.nodes[r])throw new Error("The output '".concat(e,"' is not found in the graph"))}))}}]),e}(),Tm=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,D.Z)(this,e),this.hashTableNameToHandle=t,this.hashTableMap=n}return(0,F.Z)(e,[{key:"addHashTable",value:function(e,t){this.hashTableNameToHandle[e]=t.handle,this.hashTableMap[t.id]=t}},{key:"getHashTableHandleByName",value:function(e){return this.hashTableNameToHandle[e]}},{key:"getHashTableById",value:function(e){return this.hashTableMap[e]}},{key:"dispose",value:function(){for(var e in this.hashTableMap)this.hashTableMap[e].clearAndClose(),delete this.hashTableMap[e];for(var t in this.hashTableNameToHandle)this.hashTableNameToHandle[t].dispose(),delete this.hashTableNameToHandle[t]}}]),e}(),Im=n(1434),Dm=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:ii.io;(0,D.Z)(this,e),this.modelUrl=t,this.loadOptions=n,this.version="n/a",this.io=r,null==n&&(this.loadOptions={}),this.resourceManager=new Tm}return(0,F.Z)(e,[{key:"modelVersion",get:function(){return this.version}},{key:"inputNodes",get:function(){return this.executor.inputNodes}},{key:"outputNodes",get:function(){return this.executor.outputNodes}},{key:"inputs",get:function(){return this.executor.inputs}},{key:"outputs",get:function(){return this.executor.outputs}},{key:"weights",get:function(){return this.executor.weightMap}},{key:"metadata",get:function(){return this.artifacts.userDefinedMetadata}},{key:"modelSignature",get:function(){return this.signature}},{key:"modelStructuredOutputKeys",get:function(){return this.structuredOutputKeys}},{key:"findIOHandler",value:function(){var e=this.modelUrl;if(null!=e.load)this.handler=e;else if(null!=this.loadOptions.requestInit)this.handler=this.io.browserHTTPRequest(e,this.loadOptions);else{var t=this.io.getLoadHandlers(e,this.loadOptions);if(0===t.length)t.push(this.io.browserHTTPRequest(e,this.loadOptions));else if(t.length>1)throw new Error("Found more than one (".concat(t.length,") load handlers for ")+"URL '".concat([e],"'"));this.handler=t[0]}}},{key:"load",value:function(){var e=this;if(this.findIOHandler(),null==this.handler.load)throw new Error("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");var t=this.handler.load();return ii.util.isPromise(t)?t.then((function(t){return null==t.getWeightStream?e.loadSync(t):e.loadStreaming(t)})):this.loadSync(t)}},{key:"loadSync",value:function(e){var t=this.io.decodeWeights(e.weightData,e.weightSpecs);return this.loadWithWeightMap(e,t)}},{key:"loadStreaming",value:function(){var e=(0,Da.Z)(E().mark((function e(t){var n;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=t.getWeightStream){e.next=2;break}throw new Error("Model artifacts missing streamWeights function");case 2:return e.next=4,(0,Im.r)(t.getWeightStream(),t.weightSpecs);case 4:return n=e.sent,e.abrupt("return",this.loadWithWeightMap(t,n));case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"loadWithWeightMap",value:function(e,t){this.artifacts=e;var n=this.artifacts.modelTopology,r=this.artifacts.signature;if(null!=this.artifacts.userDefinedMetadata){var a=this.artifacts.userDefinedMetadata;null!=a.signature&&(r=a.signature),null!=a.structuredOutputKeys&&(this.structuredOutputKeys=a.structuredOutputKeys)}if(this.signature=r,this.version="".concat(n.versions.producer,".").concat(n.versions.minConsumer),this.executor=new Nm(wv.Instance.transformGraph(n,this.signature)),this.executor.weightMap=this.convertTensorMapToTensorsMap(t),this.executor.resourceManager=this.resourceManager,null!=e.modelInitializer&&null!=e.modelInitializer.node){var i=wv.Instance.transformGraph(e.modelInitializer);this.initializer=new Nm(i),this.initializer.weightMap=this.executor.weightMap,this.initializer.resourceManager=this.resourceManager,this.initializerSignature=e.initializerSignature}return!0}},{key:"save",value:function(){var e=(0,Da.Z)(E().mark((function e(t,n){var r;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!==typeof t){e.next=9;break}if(0!==(r=this.io.getSaveHandlers(t)).length){e.next=6;break}throw new Error("Cannot find any save handlers for URL '".concat(t,"'"));case 6:if(!(r.length>1)){e.next=8;break}throw new Error("Found more than one (".concat(r.length,") save handlers for ")+"URL '".concat(t,"'"));case 8:t=r[0];case 9:if(null!=t.save){e.next=11;break}throw new Error("GraphModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");case 11:return e.abrupt("return",t.save(this.artifacts));case 12:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"addStructuredOutputNames",value:function(e){var t=this;if(this.structuredOutputKeys){var n=e instanceof ii.Tensor?[e]:e,r={};return n.forEach((function(e,n){return r[t.structuredOutputKeys[n]]=e})),r}return e}},{key:"predict",value:function(e,t){var n=this.execute(e,this.outputNodes);return this.addStructuredOutputNames(n)}},{key:"predictAsync",value:function(){var e=(0,Da.Z)(E().mark((function e(t,n){var r;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.executeAsync(t,this.outputNodes);case 2:return r=e.sent,e.abrupt("return",this.addStructuredOutputNames(r));case 4:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"normalizeInputs",value:function(e){var t,n=this;if(!(e instanceof ii.Tensor)&&!Array.isArray(e)){var r=null===(t=this.signature)||void 0===t?void 0:t.inputs;if(null!=r)for(var a in r){var i=r[a];null!=i.resourceId&&(e[a]=this.resourceIdToCapturedInput[i.resourceId])}return e}e=Array.isArray(e)?e:[e];var o=Object.keys(this.resourceIdToCapturedInput).length;if(e.length+o!==this.inputNodes.length)throw new Error("Input tensor count mismatch, the graph model has ".concat(this.inputNodes.length-o," non-resource placeholders, while there are ").concat(e.length," input tensors provided."));var u=0;return this.inputNodes.reduce((function(t,r){var a,i,o,s=null===(o=null===(i=null===(a=n.signature)||void 0===a?void 0:a.inputs)||void 0===i?void 0:i[r])||void 0===o?void 0:o.resourceId;return t[r]=null!=s?n.resourceIdToCapturedInput[s]:e[u++],t}),{})}},{key:"normalizeOutputs",value:function(e){return e=e||this.outputNodes,Array.isArray(e)?e:[e]}},{key:"executeInitializerGraph",value:function(){return null==this.initializer?[]:null==this.initializerSignature?this.initializer.execute({},[]):this.initializer.execute({},Object.keys(this.initializerSignature.outputs))}},{key:"executeInitializerGraphAsync",value:function(){var e=(0,Da.Z)(E().mark((function e(){return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=this.initializer){e.next=2;break}return e.abrupt("return",[]);case 2:if(null!=this.initializerSignature){e.next=6;break}return e.abrupt("return",this.initializer.executeAsync({},[]));case 6:return e.abrupt("return",this.initializer.executeAsync({},Object.keys(this.initializerSignature.outputs)));case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setResourceIdToCapturedInput",value:function(e){if(this.resourceIdToCapturedInput={},this.initializerSignature)for(var t=this.initializerSignature.outputs,n=Object.keys(t),r=0;r<n.length;r++){var a=t[n[r]];this.resourceIdToCapturedInput[a.resourceId]=e[r]}}},{key:"execute",value:function(e,t){null==this.resourceIdToCapturedInput&&this.setResourceIdToCapturedInput(this.executeInitializerGraph()),e=this.normalizeInputs(e),t=this.normalizeOutputs(t);var n=this.executor.execute(e,t);return n.length>1?n:n[0]}},{key:"executeAsync",value:function(){var e=(0,Da.Z)(E().mark((function e(t,n){var r;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=this.resourceIdToCapturedInput){e.next=6;break}return e.t0=this,e.next=4,this.executeInitializerGraphAsync();case 4:e.t1=e.sent,e.t0.setResourceIdToCapturedInput.call(e.t0,e.t1);case 6:return t=this.normalizeInputs(t),n=this.normalizeOutputs(n),e.next=10,this.executor.executeAsync(t,n);case 10:return r=e.sent,e.abrupt("return",r.length>1?r:r[0]);case 12:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"getIntermediateTensors",value:function(){return this.executor.getIntermediateTensors()}},{key:"disposeIntermediateTensors",value:function(){this.executor.disposeIntermediateTensors()}},{key:"convertTensorMapToTensorsMap",value:function(e){return Object.keys(e).reduce((function(t,n){return t[n]=[e[n]],t}),{})}},{key:"dispose",value:function(){this.executor.dispose(),this.initializer&&(this.initializer.dispose(),this.resourceIdToCapturedInput&&(0,ii.dispose)(this.resourceIdToCapturedInput)),this.resourceManager.dispose()}}]),e}();function Fm(e){return Mm.apply(this,arguments)}function Mm(){return Mm=(0,Da.Z)(E().mark((function e(t){var n,r,a,i=arguments;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=i.length>1&&void 0!==i[1]?i[1]:{},r=i.length>2&&void 0!==i[2]?i[2]:ii.io,null!=t){e.next=4;break}throw new Error("modelUrl in loadGraphModel() cannot be null. Please provide a url or an IOHandler that loads the model");case 4:return null==n&&(n={}),n.fromTFHub&&"string"===typeof t&&(t=Om(t)),a=new Dm(t,n,r),e.next=9,a.load();case 9:return e.abrupt("return",a);case 10:case"end":return e.stop()}}),e)}))),Mm.apply(this,arguments)}function Om(e){return e.endsWith("/")||(e+="/"),"".concat(e).concat("model.json").concat("?tfjs-format=file")}var Rm=n(6699);function jm(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Map,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new Set;if(null==e)return null;if("function"===typeof Blob&&e instanceof Blob)return e.slice();if(r.has(e))throw new Error("Circular references are not supported.");if(n.has(e))return n.get(e);var a=t(e);if(a.recurse&&null!==a.value)throw new Error("A deep map function may not return both a value and recurse=true.");if(a.recurse){if(Lm(e)){var i=Array.isArray(e)?[]:{};for(var o in r.add(e),e){var u=e[o],s=jm(u,t,n,r);i[o]=s}return r.delete(e),e.__proto__&&(i.__proto__=e.__proto__),i}throw new Error("Can't recurse into non-iterable type: ".concat(e))}return n.set(e,a.value),a.value}function Bm(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Zm;return zm(e,t)}function zm(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Set,r=e[0];if(n.has(r))throw new Error("Circular references are not supported.");var a=t(e);if(a.recurse&&null!==a.value)throw new Error("A deep zip function may not return both a value and recurse=true.");if(a.recurse){if(Lm(r)){var i=Array.isArray(r)?[]:{};n.add(r);var o=function(r){var a=zm(e.map((function(e){return e[r]})),t,n);i[r]=a};for(var u in r)o(u);return n.delete(r),i}throw new Error("Can't recurse into non-iterable type: ".concat(r))}return a.value}function Zm(e){return null===e?null:Lm(e[0])?{value:null,recurse:!0}:{value:e,recurse:!1}}function Lm(e){var t=!1;ii.env().get("IS_BROWSER")?t=e instanceof TextDecoder:t=e instanceof n(4977).StringDecoder;return null!=e&&!ArrayBuffer.isView(e)&&(Array.isArray(e)||"object"===typeof e&&!(e instanceof ii.Tensor)&&!(e instanceof Promise)&&!t)}function Pm(e){return function(e,t){return jm(e,t)}(e,Um)}function Um(e){return e instanceof ii.Tensor?{value:e.clone(),recurse:!1}:Lm(e)?{value:null,recurse:!0}:{value:e,recurse:!1}}var Wm=function(){function e(t){if((0,D.Z)(this,e),this.capacity=t,this.begin=0,this.end=0,null==t)throw new RangeError("Can't create a ring buffer of unknown capacity.");if(t<1)throw new RangeError("Can't create ring buffer of capacity < 1.");this.data=new Array(t),this.doubledCapacity=2*t}return(0,F.Z)(e,[{key:"wrap",value:function(e){for(;e<0;)e+=this.doubledCapacity;return e%this.doubledCapacity}},{key:"get",value:function(e){if(e<0)throw new RangeError("Can't get item at a negative index.");return this.data[e%this.capacity]}},{key:"set",value:function(e,t){if(e<0)throw new RangeError("Can't set item at a negative index.");this.data[e%this.capacity]=t}},{key:"length",value:function(){var e=this.end-this.begin;return e<0&&(e=this.doubledCapacity+e),e}},{key:"isFull",value:function(){return this.length()===this.capacity}},{key:"isEmpty",value:function(){return 0===this.length()}},{key:"push",value:function(e){if(this.isFull())throw new RangeError("Ring buffer is full.");this.set(this.end,e),this.end=this.wrap(this.end+1)}},{key:"pushAll",value:function(e){var t,n=(0,B.Z)(e);try{for(n.s();!(t=n.n()).done;){var r=t.value;this.push(r)}}catch(a){n.e(a)}finally{n.f()}}},{key:"pop",value:function(){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");this.end=this.wrap(this.end-1);var e=this.get(this.end);return this.set(this.end,void 0),e}},{key:"unshift",value:function(e){if(this.isFull())throw new RangeError("Ring buffer is full.");this.begin=this.wrap(this.begin-1),this.set(this.begin,e)}},{key:"shift",value:function(){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");var e=this.get(this.begin);return this.set(this.begin,void 0),this.begin=this.wrap(this.begin+1),e}},{key:"shuffleExcise",value:function(e){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");var t=this.wrap(this.begin+e),n=this.get(t);return this.set(t,this.pop()),n}}]),e}(),Vm=function(e){(0,M.Z)(n,e);var t=(0,O.Z)(n);function n(){return(0,D.Z)(this,n),t.call(this,n.INITIAL_CAPACITY)}return(0,F.Z)(n,[{key:"isFull",value:function(){return!1}},{key:"push",value:function(e){(0,rf.Z)((0,af.Z)(n.prototype),"isFull",this).call(this)&&this.expand(),(0,rf.Z)((0,af.Z)(n.prototype),"push",this).call(this,e)}},{key:"unshift",value:function(e){(0,rf.Z)((0,af.Z)(n.prototype),"isFull",this).call(this)&&this.expand(),(0,rf.Z)((0,af.Z)(n.prototype),"unshift",this).call(this,e)}},{key:"expand",value:function(){for(var e=2*this.capacity,t=new Array(e),n=this.length(),r=0;r<n;r++)t[r]=this.get(this.wrap(this.begin+r));this.data=t,this.capacity=e,this.doubledCapacity=2*this.capacity,this.begin=0,this.end=n}}]),n}(Wm);function qm(e){return new Ym(e)}function Gm(e,t){return new ug(e,t)}Vm.INITIAL_CAPACITY=32;var Hm,Xm=function(){function e(){(0,D.Z)(this,e)}return(0,F.Z)(e,[{key:"toArray",value:function(){var e=(0,Da.Z)(E().mark((function e(){var t,n;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=[],e.next=3,this.next();case 3:n=e.sent;case 4:if(n.done){e.next=11;break}return t.push(n.value),e.next=8,this.next();case 8:n=e.sent,e.next=4;break;case 11:return e.abrupt("return",t);case 12:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"toArrayForTest",value:function(){var e=(0,Da.Z)(E().mark((function e(){var t,n,r;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.prefetch(100),n=[],e.next=4,t.next();case 4:r=e.sent;case 5:if(r.done){e.next=12;break}return n.push(r.value),e.next=9,t.next();case 9:r=e.sent,e.next=5;break;case 12:return e.abrupt("return",n);case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"resolveFully",value:function(){var e=(0,Da.Z)(E().mark((function e(){var t;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.next();case 2:t=e.sent;case 3:if(t.done){e.next=9;break}return e.next=6,this.next();case 6:t=e.sent,e.next=3;break;case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"resolveWhile",value:function(){var e=(0,Da.Z)(E().mark((function e(t){var n,r;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.next();case 2:n=e.sent,r=t(n.value);case 4:if(n.done||!r){e.next=11;break}return e.next=7,this.next();case 7:n=e.sent,r=t(n.value),e.next=4;break;case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"handleErrors",value:function(e){return new rg(this,e)}},{key:"filter",value:function(e){return new tg(this,e)}},{key:"map",value:function(e){return new ng(this,e)}},{key:"mapAsync",value:function(e){return new ag(this,e)}},{key:"serialMapAsync",value:function(e){return new ag(this,e).serial()}},{key:"flatmap",value:function(e){return new og(this,e)}},{key:"forEachAsync",value:function(){var e=(0,Da.Z)(E().mark((function e(t){return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.map(t).resolveFully());case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"serialForEach",value:function(){var e=(0,Da.Z)(E().mark((function e(t){return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.serialMapAsync(t).resolveWhile((function(e){return!0===e})));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"rowMajorBatch",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return new eg(this,e,t)}},{key:"columnMajorBatch",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Zm,r=this.rowMajorBatch(e,t);return r.map((function(e){return Bm(e,n)}))}},{key:"concatenate",value:function(e,t){return new ug(new Km([this,e]),t)}},{key:"take",value:function(e){return e<0||null==e?this:new Jm(this,e)}},{key:"skip",value:function(e){return e<0||null==e?this:new Qm(this,e)}},{key:"prefetch",value:function(e){return new sg(this,e)}},{key:"shuffle",value:function(e,t){return new cg(this,e,t)}},{key:"serial",value:function(){return new $m(this)}}]),e}(),Km=function(e){(0,M.Z)(n,e);var t=(0,O.Z)(n);function n(e){var r;return(0,D.Z)(this,n),(r=t.call(this)).items=e,r.trav=0,r}return(0,F.Z)(n,[{key:"summary",value:function(){return"Array of ".concat(this.items.length," items")}},{key:"next",value:function(){var e=(0,Da.Z)(E().mark((function e(){var t;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.trav>=this.items.length)){e.next=2;break}return e.abrupt("return",{value:null,done:!0});case 2:return t=this.items[this.trav],this.trav++,e.abrupt("return",{value:Pm(t),done:!1});case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(Xm),Ym=function(e){(0,M.Z)(n,e);var t=(0,O.Z)(n);function n(e){var r;return(0,D.Z)(this,n),(r=t.call(this)).nextFn=e,r}return(0,F.Z)(n,[{key:"summary",value:function(){return"Function call"}},{key:"next",value:function(){var e=(0,Da.Z)(E().mark((function e(){return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.abrupt("return",this.nextFn());case 4:throw e.prev=4,e.t0=e.catch(0),e.t0.message="Error thrown while iterating through a dataset: ".concat(e.t0.message),e.t0;case 8:case"end":return e.stop()}}),e,this,[[0,4]])})));return function(){return e.apply(this,arguments)}}()}]),n}(Xm),$m=function(e){(0,M.Z)(n,e);var t=(0,O.Z)(n);function n(e){var r;return(0,D.Z)(this,n),(r=t.call(this)).upstream=e,r.lastRead=Promise.resolve({value:null,done:!1}),r}return(0,F.Z)(n,[{key:"summary",value:function(){return"".concat(this.upstream.summary()," -> Serial")}},{key:"next",value:function(){var e=(0,Da.Z)(E().mark((function e(){var t=this;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.lastRead=this.lastRead.then((function(){return t.serialNext()})),e.abrupt("return",this.lastRead);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"serialNext",value:function(){var e=(0,Da.Z)(E().mark((function e(){return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.upstream.next());case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(Xm),Qm=function(e){(0,M.Z)(n,e);var t=(0,O.Z)(n);function n(e,r){var a;return(0,D.Z)(this,n),(a=t.call(this)).upstream=e,a.maxCount=r,a.count=0,a.lastRead=Promise.resolve({value:null,done:!1}),a}return(0,F.Z)(n,[{key:"summary",value:function(){return"".concat(this.upstream.summary()," -> Skip")}},{key:"next",value:function(){var e=(0,Da.Z)(E().mark((function e(){var t=this;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.lastRead=this.lastRead.then((function(){return t.serialNext()})),e.abrupt("return",this.lastRead);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"serialNext",value:function(){var e=(0,Da.Z)(E().mark((function e(){var t;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.count++<this.maxCount)){e.next=9;break}return e.next=3,this.upstream.next();case 3:if(!(t=e.sent).done){e.next=6;break}return e.abrupt("return",t);case 6:ii.dispose(t.value),e.next=0;break;case 9:return e.abrupt("return",this.upstream.next());case 10:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(Xm),Jm=function(e){(0,M.Z)(n,e);var t=(0,O.Z)(n);function n(e,r){var a;return(0,D.Z)(this,n),(a=t.call(this)).upstream=e,a.maxCount=r,a.count=0,a}return(0,F.Z)(n,[{key:"summary",value:function(){return"".concat(this.upstream.summary()," -> Take")}},{key:"next",value:function(){var e=(0,Da.Z)(E().mark((function e(){return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.count++>=this.maxCount)){e.next=2;break}return e.abrupt("return",{value:null,done:!0});case 2:return e.abrupt("return",this.upstream.next());case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(Xm),eg=function(e){(0,M.Z)(n,e);var t=(0,O.Z)(n);function n(e,r){var a,i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return(0,D.Z)(this,n),(a=t.call(this)).upstream=e,a.batchSize=r,a.enableSmallLastBatch=i,a.lastRead=Promise.resolve({value:null,done:!1}),a}return(0,F.Z)(n,[{key:"summary",value:function(){return"".concat(this.upstream.summary()," -> RowMajorBatch")}},{key:"next",value:function(){var e=(0,Da.Z)(E().mark((function e(){var t=this;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.lastRead=this.lastRead.then((function(){return t.serialNext()})),e.abrupt("return",this.lastRead);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"serialNext",value:function(){var e=(0,Da.Z)(E().mark((function e(){var t,n;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=[];case 1:if(!(t.length<this.batchSize)){e.next=12;break}return e.next=4,this.upstream.next();case 4:if(!(n=e.sent).done){e.next=9;break}if(!(this.enableSmallLastBatch&&t.length>0)){e.next=8;break}return e.abrupt("return",{value:t,done:!1});case 8:return e.abrupt("return",{value:null,done:!0});case 9:t.push(n.value),e.next=1;break;case 12:return e.abrupt("return",{value:t,done:!1});case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(Xm),tg=function(e){(0,M.Z)(n,e);var t=(0,O.Z)(n);function n(e,r){var a;return(0,D.Z)(this,n),(a=t.call(this)).upstream=e,a.predicate=r,a.lastRead=Promise.resolve({value:null,done:!1}),a}return(0,F.Z)(n,[{key:"summary",value:function(){return"".concat(this.upstream.summary()," -> Filter")}},{key:"next",value:function(){var e=(0,Da.Z)(E().mark((function e(){var t=this;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.lastRead=this.lastRead.then((function(){return t.serialNext()})),e.abrupt("return",this.lastRead);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"serialNext",value:function(){var e=(0,Da.Z)(E().mark((function e(){var t;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=3,this.upstream.next();case 3:if(!(t=e.sent).done&&!this.predicate(t.value)){e.next=6;break}return e.abrupt("return",t);case 6:ii.dispose(t.value),e.next=0;break;case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(Xm),ng=function(e){(0,M.Z)(n,e);var t=(0,O.Z)(n);function n(e,r){var a;return(0,D.Z)(this,n),(a=t.call(this)).upstream=e,a.transform=r,a}return(0,F.Z)(n,[{key:"summary",value:function(){return"".concat(this.upstream.summary()," -> Map")}},{key:"next",value:function(){var e=(0,Da.Z)(E().mark((function e(){var t,n,r,a,i,o,u;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.upstream.next();case 2:if(!(t=e.sent).done){e.next=5;break}return e.abrupt("return",{value:null,done:!0});case 5:n=ii.tensor_util.getTensorsInContainer(t.value),r=this.transform(t.value),a=ii.tensor_util.getTensorsInContainer(r),i=(0,B.Z)(n);try{for(i.s();!(o=i.n()).done;)u=o.value,ii.tensor_util.isTensorInList(u,a)||u.dispose()}catch(s){i.e(s)}finally{i.f()}return e.abrupt("return",{value:r,done:!1});case 11:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(Xm),rg=function(e){(0,M.Z)(n,e);var t=(0,O.Z)(n);function n(e,r){var a;return(0,D.Z)(this,n),(a=t.call(this)).upstream=e,a.handler=r,a.count=0,a.lastRead=Promise.resolve({value:null,done:!1}),a}return(0,F.Z)(n,[{key:"summary",value:function(){return"".concat(this.upstream.summary()," -> handleErrors")}},{key:"next",value:function(){var e=(0,Da.Z)(E().mark((function e(){var t=this;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.lastRead=this.lastRead.then((function(){return t.serialNext()})),e.abrupt("return",this.lastRead);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"serialNext",value:function(){var e=(0,Da.Z)(E().mark((function e(){return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=1,e.next=4,this.upstream.next();case 4:return e.abrupt("return",e.sent);case 7:if(e.prev=7,e.t0=e.catch(1),this.handler(e.t0)){e.next=11;break}return e.abrupt("return",{value:null,done:!0});case 11:e.next=0;break;case 13:case"end":return e.stop()}}),e,this,[[1,7]])})));return function(){return e.apply(this,arguments)}}()}]),n}(Xm),ag=function(e){(0,M.Z)(n,e);var t=(0,O.Z)(n);function n(e,r){var a;return(0,D.Z)(this,n),(a=t.call(this)).upstream=e,a.transform=r,a}return(0,F.Z)(n,[{key:"summary",value:function(){return"".concat(this.upstream.summary()," -> AsyncMap")}},{key:"next",value:function(){var e=(0,Da.Z)(E().mark((function e(){var t,n,r,a,i,o,u;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.upstream.next();case 2:if(!(t=e.sent).done){e.next=5;break}return e.abrupt("return",{value:null,done:!0});case 5:return n=ii.tensor_util.getTensorsInContainer(t.value),e.next=8,this.transform(t.value);case 8:r=e.sent,a=ii.tensor_util.getTensorsInContainer(r),i=(0,B.Z)(n);try{for(i.s();!(o=i.n()).done;)u=o.value,ii.tensor_util.isTensorInList(u,a)||u.dispose()}catch(s){i.e(s)}finally{i.f()}return e.abrupt("return",{value:r,done:!1});case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(Xm),ig=function(e){(0,M.Z)(n,e);var t=(0,O.Z)(n);function n(){var e;return(0,D.Z)(this,n),(e=t.call(this)).outputQueue=new Vm,e.lastRead=Promise.resolve({value:null,done:!1}),e}return(0,F.Z)(n,[{key:"next",value:function(){var e=(0,Da.Z)(E().mark((function e(){var t=this;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.lastRead=this.lastRead.then((function(){return t.serialNext()})),e.abrupt("return",this.lastRead);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"serialNext",value:function(){var e=(0,Da.Z)(E().mark((function e(){return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==this.outputQueue.length()){e.next=7;break}return e.next=3,this.pump();case 3:if(e.sent){e.next=5;break}return e.abrupt("return",{value:null,done:!0});case 5:e.next=0;break;case 7:return e.abrupt("return",{value:this.outputQueue.shift(),done:!1});case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(Xm),og=function(e){(0,M.Z)(n,e);var t=(0,O.Z)(n);function n(e,r){var a;return(0,D.Z)(this,n),(a=t.call(this)).upstream=e,a.transform=r,a}return(0,F.Z)(n,[{key:"summary",value:function(){return"".concat(this.upstream.summary()," -> Flatmap")}},{key:"pump",value:function(){var e=(0,Da.Z)(E().mark((function e(){var t,n,r,a,i,o,u;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.upstream.next();case 2:if(!(t=e.sent).done){e.next=5;break}return e.abrupt("return",!1);case 5:n=ii.tensor_util.getTensorsInContainer(t.value),r=this.transform(t.value),a=ii.tensor_util.getTensorsInContainer(r),this.outputQueue.pushAll(r),i=(0,B.Z)(n);try{for(i.s();!(o=i.n()).done;)u=o.value,ii.tensor_util.isTensorInList(u,a)||u.dispose()}catch(s){i.e(s)}finally{i.f()}return e.abrupt("return",!0);case 12:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(ig),ug=function(e){(0,M.Z)(n,e);var t=(0,O.Z)(n);function n(e,r){var a;return(0,D.Z)(this,n),(a=t.call(this)).baseErrorHandler=r,a.lastRead=null,a.iterator=null,a.moreIterators=e,a}return(0,F.Z)(n,[{key:"summary",value:function(){return"".concat("TODO: fill in upstream of chained summaries"," -> Chained")}},{key:"next",value:function(){var e=(0,Da.Z)(E().mark((function e(){return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.lastRead=this.readFromChain(this.lastRead),e.abrupt("return",this.lastRead);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"readFromChain",value:function(){var e=(0,Da.Z)(E().mark((function e(t){var n,r;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t;case 2:if(null!=this.iterator){e.next=10;break}return e.next=5,this.moreIterators.next();case 5:if(!(n=e.sent).done){e.next=8;break}return e.abrupt("return",{value:null,done:!0});case 8:this.iterator=n.value,null!=this.baseErrorHandler&&(this.iterator=this.iterator.handleErrors(this.baseErrorHandler));case 10:return e.next=12,this.iterator.next();case 12:if(!(r=e.sent).done){e.next=16;break}return this.iterator=null,e.abrupt("return",this.readFromChain(t));case 16:return e.abrupt("return",r);case 17:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),n}(Xm);!function(e){e[e.FAIL=0]="FAIL",e[e.SHORTEST=1]="SHORTEST",e[e.LONGEST=2]="LONGEST"}(Hm||(Hm={}));var sg=function(e){(0,M.Z)(n,e);var t=(0,O.Z)(n);function n(e,r){var a;return(0,D.Z)(this,n),(a=t.call(this)).upstream=e,a.bufferSize=r,a.buffer=new Wm(r),a}return(0,F.Z)(n,[{key:"summary",value:function(){return"".concat(this.upstream.summary()," -> Prefetch")}},{key:"refill",value:function(){for(;!this.buffer.isFull();){var e=this.upstream.next();this.buffer.push(e)}}},{key:"next",value:function(){return this.refill(),this.buffer.shift()}}]),n}(Xm),cg=function(e){(0,M.Z)(n,e);var t=(0,O.Z)(n);function n(e,r,a){var i;return(0,D.Z)(this,n),(i=t.call(this,e,r)).upstream=e,i.windowSize=r,i.upstreamExhausted=!1,i.random=Rm.alea(a||ii.util.now().toString()),i.lastRead=Promise.resolve({value:null,done:!1}),i}return(0,F.Z)(n,[{key:"next",value:function(){var e=(0,Da.Z)(E().mark((function e(){var t=this;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.lastRead=this.lastRead.then((function(){return t.serialNext()})),e.abrupt("return",this.lastRead);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"randomInt",value:function(e){return Math.floor(this.random()*e)}},{key:"chooseIndex",value:function(){return this.randomInt(this.buffer.length())}},{key:"serialNext",value:function(){var e=(0,Da.Z)(E().mark((function e(){var t,n;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.upstreamExhausted||this.refill();case 1:if(this.buffer.isEmpty()){e.next=14;break}return t=this.chooseIndex(),e.next=5,this.buffer.shuffleExcise(t);case 5:if(!(n=e.sent).done){e.next=10;break}this.upstreamExhausted=!0,e.next=12;break;case 10:return this.refill(),e.abrupt("return",n);case 12:e.next=1;break;case 14:return e.abrupt("return",{value:null,done:!0});case 15:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(sg),lg=function(){function e(){(0,D.Z)(this,e),this.size=null}return(0,F.Z)(e,[{key:"batch",value:function(e){var t,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=this;return ii.util.assert(e>0,(function(){return"batchSize needs to be positive, but it is\n      ".concat(e)})),t=this.size===1/0||null==this.size?this.size:n?Math.ceil(this.size/e):Math.floor(this.size/e),fg((0,Da.Z)(E().mark((function t(){return E().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,r.iterator();case 2:return t.abrupt("return",t.sent.columnMajorBatch(e,n,dg));case 3:case"end":return t.stop()}}),t)}))),t)}},{key:"concatenate",value:function(e){var t,n=this;return t=this.size===1/0||e.size===1/0?1/0:null!=this.size&&null!=e.size?this.size+e.size:null,fg((0,Da.Z)(E().mark((function t(){return E().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.iterator();case 2:return t.t0=t.sent,t.next=5,e.iterator();case 5:return t.t1=t.sent,t.abrupt("return",t.t0.concatenate.call(t.t0,t.t1));case 7:case"end":return t.stop()}}),t)}))),t)}},{key:"filter",value:function(e){var t,n=this;return t=this.size===1/0?1/0:null,fg((0,Da.Z)(E().mark((function t(){return E().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.iterator();case 2:return t.abrupt("return",t.sent.filter((function(t){return ii.tidy((function(){return e(t)}))})));case 3:case"end":return t.stop()}}),t)}))),t)}},{key:"forEachAsync",value:function(){var e=(0,Da.Z)(E().mark((function e(t){return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.iterator();case 2:return e.abrupt("return",e.sent.forEachAsync(t));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"map",value:function(e){var t=this;return fg((0,Da.Z)(E().mark((function n(){return E().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.iterator();case 2:return n.abrupt("return",n.sent.map((function(t){return ii.tidy((function(){return e(t)}))})));case 3:case"end":return n.stop()}}),n)}))),this.size)}},{key:"mapAsync",value:function(e){var t=this;return fg((0,Da.Z)(E().mark((function n(){return E().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.iterator();case 2:return n.abrupt("return",n.sent.mapAsync(e));case 3:case"end":return n.stop()}}),n)}))),this.size)}},{key:"prefetch",value:function(e){if(null==e)throw new RangeError("`Dataset.prefetch()` requires bufferSize to be specified.");var t=this;return fg((0,Da.Z)(E().mark((function n(){return E().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.iterator();case 2:return n.abrupt("return",n.sent.prefetch(e));case 3:case"end":return n.stop()}}),n)}))),this.size)}},{key:"repeat",value:function(e){var t,n=this;return t=null!=this.size&&e>0?this.size*e:0===e?0:null!=this.size&&(void 0===e||e<0)?1/0:null,fg((0,Da.Z)(E().mark((function t(){var r;return E().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=qm((0,Da.Z)(E().mark((function e(){return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.iterator();case 2:return e.t0=e.sent,e.abrupt("return",{value:e.t0,done:!1});case 4:case"end":return e.stop()}}),e)})))),t.abrupt("return",Gm(r.take(e)));case 2:case"end":return t.stop()}}),t)}))),t)}},{key:"skip",value:function(e){var t,n=this;return t=null!=this.size&&e>=0&&this.size>=e?this.size-e:null!=this.size&&(this.size<e||void 0===e||e<0)?0:null,fg((0,Da.Z)(E().mark((function t(){return E().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.iterator();case 2:return t.abrupt("return",t.sent.skip(e));case 3:case"end":return t.stop()}}),t)}))),t)}},{key:"shuffle",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(null==e||e<0)throw null==this.size?new RangeError("`Dataset.shuffle()` requires bufferSize to be specified."):new RangeError("`Dataset.shuffle()` requires bufferSize to be specified.  If your data fits in main memory (for regular JS objects), and/or GPU memory (for `tf.Tensor`s), consider setting "+"bufferSize to the dataset size (".concat(this.size," elements)"));var r=this,a=Rm.alea(t||ii.util.now().toString());return fg((0,Da.Z)(E().mark((function t(){var i;return E().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=a.int32(),n&&(i+=a.int32()),t.next=4,r.iterator();case 4:return t.abrupt("return",t.sent.shuffle(e,i.toString()));case 5:case"end":return t.stop()}}),t)}))),this.size)}},{key:"take",value:function(e){var t,n=this;return t=null!=this.size&&this.size>e?e:null!=this.size&&this.size<=e?this.size:null,fg((0,Da.Z)(E().mark((function t(){return E().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.iterator();case 2:return t.abrupt("return",t.sent.take(e));case 3:case"end":return t.stop()}}),t)}))),t)}},{key:"toArray",value:function(){var e=(0,Da.Z)(E().mark((function e(){return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.size!==1/0){e.next=2;break}throw new Error("Can not convert infinite data stream to array.");case 2:return e.next=4,this.iterator();case 4:return e.abrupt("return",e.sent.toArray());case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"toArrayForTest",value:function(){var e=(0,Da.Z)(E().mark((function e(){return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.size!==1/0){e.next=2;break}throw new Error("Can not convert infinite data stream to array.");case 2:return e.next=4,this.iterator();case 4:return e.abrupt("return",e.sent.toArrayForTest());case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}();function fg(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return new(function(n){(0,M.Z)(a,n);var r=(0,O.Z)(a);function a(){var e;return(0,D.Z)(this,a),(e=r.apply(this,arguments)).size=t,e}return(0,F.Z)(a,[{key:"iterator",value:function(){var t=(0,Da.Z)(E().mark((function t(){return E().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e());case 1:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()}]),a}(lg))}function dg(e){return null===e?null:function(e){return null==e||null===(t=e)||"object"!==typeof t&&"function"!==typeof t||Array.isArray(e)||"object"===typeof e&&e instanceof ii.Tensor||ii.util.isTypedArray(e);var t}(e[0])?{value:function(e){if(0===e.length)throw new Error("Can't make a batch of zero elements.");return e[0]instanceof ii.Tensor?ii.stack(e):ii.tensor(e)}(e),recurse:!1}:{value:null,recurse:!0}}lg.MAX_BUFFER_SIZE=1e4;Symbol("out"),Symbol("field"),Symbol("quote"),Symbol("quoteafterquote"),Symbol("quoteinquote");function hg(e,t){Array.isArray(e)||(e=[e]),e.forEach((function(e){null!=e&&ii.util.assert("complex64"!==e.dtype,(function(){return"".concat(t," does not support complex64 tensors in the CPU backend.")}))}))}var pg=ii.kernel_impls.whereImpl,vg=function(e){(0,M.Z)(n,e);var t=(0,O.Z)(n);function n(){var e;return(0,D.Z)(this,n),(e=t.call(this)).blockSize=48,e.firstUse=!0,e.data=new ii.DataStorage((0,Es.Z)(e),(0,ii.engine)()),e}return(0,F.Z)(n,[{key:"nextDataId",value:function(){return n.nextDataId++}},{key:"write",value:function(e,t,n){this.firstUse&&(this.firstUse=!1,(0,ii.env)().get("IS_NODE")&&ii.backend_util.warn("\n============================\nHi, looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, visit https://github.com/tensorflow/tfjs-node for more details. \n============================"));var r={id:this.nextDataId()};return this.data.set(r,{values:e,dtype:n,refCount:1}),r}},{key:"makeTensorInfo",value:function(e,t,n){var r;if("string"===t&&null!=n&&n.length>0&&ii.util.isString(n[0])){var a=n.map((function(e){return ii.util.encodeString(e)}));r=this.write(a,e,t)}else r=this.write(n,e,t);return{dataId:r,shape:e,dtype:t}}},{key:"refCount",value:function(e){return this.data.has(e)?this.data.get(e).refCount:0}},{key:"incRef",value:function(e){this.data.get(e).refCount++}},{key:"decRef",value:function(e){this.data.has(e)&&this.data.get(e).refCount--}},{key:"move",value:function(e,t,n,r,a){this.data.set(e,{values:t,dtype:r,refCount:a})}},{key:"numDataIds",value:function(){return this.data.numDataIds()}},{key:"read",value:function(){var e=(0,Da.Z)(E().mark((function e(t){return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.readSync(t));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"readSync",value:function(e){var t=this.data.get(e),n=t.dtype,r=t.complexTensorInfos;if("complex64"===n){var a=this.readSync(r.real.dataId),i=this.readSync(r.imag.dataId);return ii.backend_util.mergeRealAndImagArrays(a,i)}return ii.util.convertBackendValuesAndArrayBuffer(this.data.get(e).values,n)}},{key:"bufferSync",value:function(e){var t=this.readSync(e.dataId);if("string"===e.dtype)try{var n=t.map((function(e){return ii.util.decodeString(e)}));return(0,ii.buffer)(e.shape,e.dtype,n)}catch(r){throw new Error("Failed to decode encoded string bytes into utf-8")}return(0,ii.buffer)(e.shape,e.dtype,t)}},{key:"makeOutput",value:function(e,t,n){return(0,ii.engine)().makeTensorFromTensorInfo(this.makeTensorInfo(t,n,e),this)}},{key:"disposeData",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this.data.has(e)){if(this.data.get(e).refCount--,!t&&this.data.get(e).refCount>0)return!1;var n=this.data.get(e),r=n.complexTensorInfos;null!=r&&(this.disposeData(r.real.dataId,!0),this.disposeData(r.imag.dataId,!0)),this.data.delete(e)}return!0}},{key:"disposeIntermediateTensorInfo",value:function(e){this.disposeData(e.dataId)}},{key:"time",value:function(){var e=(0,Da.Z)(E().mark((function e(t){var n,r;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=ii.util.now(),t(),r=ii.util.now()-n,e.abrupt("return",{kernelMs:r});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"memory",value:function(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}}},{key:"where",value:function(e){hg([e],"where");var t=this.readSync(e.dataId);return pg(e.shape,t)}},{key:"dispose",value:function(){}},{key:"floatPrecision",value:function(){return 32}},{key:"epsilon",value:function(){return(0,rf.Z)((0,af.Z)(n.prototype),"epsilon",this).call(this)}}]),n}(ii.KernelBackend);vg.nextDataId=0;function mg(e){return function(t,n,r){for(var a=ii.util.getArrayFromDType(n,t.length),i=0;i<t.length;++i)a[i]=e(t[i],r);return a}}function gg(e,t,n){return yg(e,mg(t),n)}function yg(e,t,n){return function(r){var a=r.inputs,i=r.attrs,o=r.backend,u=a.x;hg(u,e);var s,c=o,l=c.data.get(u.dataId).values;if("string"===u.dtype){if(!Array.isArray(l))throw new Error("String tensor's value was not an instance of Array");s=ii.backend_util.fromUint8ToStringArray(l)}else s=l;var f=n||u.dtype,d=t(s,f,i);return c.makeTensorInfo(u.shape,f,d)}}(0,ii.registerBackend)("cpu",(function(){return new vg}),1);var bg=gg(ii.Elu,(function(e){return e>=0?e:Math.exp(e)-1})),xg={kernelName:ii.Elu,backendName:"cpu",kernelFunc:bg};function wg(e){var t=e.inputs,n=e.backend,r=t.x;return n.incRef(r.dataId),{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}var kg={kernelName:ii.Identity,backendName:"cpu",kernelFunc:wg};function _g(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.alpha;hg([a],"leakyRelu");for(var o=ii.util.sizeFromShape(a.shape),u=n.data.get(a.dataId).values,s=ii.util.getTypedArrayFromDType("float32",o),c=0;c<u.length;c++)s[c]=u[c]<0?i*u[c]:u[c];return n.makeTensorInfo(a.shape,"float32",s)}var Sg={kernelName:ii.LeakyRelu,backendName:"cpu",kernelFunc:_g};function Cg(e){return function(t,n,r,a,i){var o=ii.backend_util.assertAndGetBroadcastShape(t,n),u=o.length,s=ii.util.computeStrides(o),c=ii.util.sizeFromShape(o),l=ii.util.getTypedArrayFromDType(i,c),f=t.length,d=n.length,h=ii.util.computeStrides(t),p=ii.util.computeStrides(n),v=ii.backend_util.getBroadcastDims(t,o),m=ii.backend_util.getBroadcastDims(n,o);if(v.length+m.length===0)for(var g=0;g<l.length;++g)l[g]=e(r[g%r.length],a[g%a.length]);else for(var y=function(t){var n=ii.util.indexToLoc(t,u,s),i=n.slice(-f);v.forEach((function(e){return i[e]=0}));var o=ii.util.locToIndex(i,f,h),c=n.slice(-d);m.forEach((function(e){return c[e]=0}));var g=ii.util.locToIndex(c,d,p);l[t]=e(r[o],a[g])},b=0;b<l.length;++b)y(b);return[l,o]}}var Ag=Cg((function(e,t){return e<0?t*e:e}));function Eg(e){var t=e.inputs,n=e.backend,r=t.x,a=t.alpha;hg([r,a],"prelu");var i=n.data.get(r.dataId).values,o=n.data.get(a.dataId).values,u=Ag(r.shape,a.shape,i,o,"float32"),s=(0,C.Z)(u,2),c=s[0],l=s[1];return n.makeTensorInfo(l,"float32",c)}var Ng={kernelName:ii.Prelu,backendName:"cpu",kernelFunc:Eg},Tg=gg(ii.Relu,(function(e){return Math.max(0,e)})),Ig={kernelName:ii.Relu,backendName:"cpu",kernelFunc:Tg},Dg=gg(ii.Relu6,(function(e){return Math.min(Math.max(0,e),6)})),Fg={kernelName:ii.Relu6,backendName:"cpu",kernelFunc:Dg},Mg=mg((function(e){return 1/(1+Math.exp(-e))})),Og=gg(ii.Sigmoid,(function(e){return 1/(1+Math.exp(-e))})),Rg={kernelName:ii.Sigmoid,backendName:"cpu",kernelFunc:Og};function jg(e,t,n,r,a){if("linear"===n)return wg({inputs:{x:t},backend:e});if("relu"===n)return Tg({inputs:{x:t},backend:e});if("elu"===n)return bg({inputs:{x:t},backend:e});if("relu6"===n)return Dg({inputs:{x:t},backend:e});if("prelu"===n)return Eg({inputs:{x:t,alpha:r},backend:e});if("leakyrelu"===n)return _g({inputs:{x:t},backend:e,attrs:{alpha:a}});if("sigmoid"===n)return Og({inputs:{x:t},backend:e});throw new Error("Activation ".concat(n," has not been implemented for the CPU backend."))}function Bg(e){var t=e.inputs,n=e.backend,r=t.real,a=t.imag,i=n.data.get(r.dataId).values,o=n.data.get(a.dataId).values,u=n.makeTensorInfo(r.shape,"complex64");return n.data.get(u.dataId).complexTensorInfos={real:n.makeTensorInfo(r.shape,"float32",i),imag:n.makeTensorInfo(a.shape,"float32",o)},u}var zg={kernelName:ii.Complex,backendName:"cpu",kernelFunc:Bg};function Zg(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"float32";if("complex64"===n){var r=Zg(e,t,"float32"),a=Zg(e,t,"float32");return Bg({inputs:{real:r,imag:a},backend:e})}var i=ii.util.makeZerosTypedArray(ii.util.sizeFromShape(t),n);return e.makeTensorInfo(t,n,i)}function Lg(e){var t=e.inputs,n=e.backend,r=t.input,a=n.data.get(r.dataId).complexTensorInfos.real,i=n.data.get(a.dataId).values;return n.makeTensorInfo(a.shape,a.dtype,i)}var Pg={kernelName:ii.Real,backendName:"cpu",kernelFunc:Lg};function Ug(e,t,n,r){if("int32"===r)return[t,"int32",Int32Array.from(e)];if("bool"===r){var a=ii.util.toTypedArray([0],n),i=Cg((function(e,t){return e!==t?1:0}))(t,[],e,a,"bool"),o=(0,C.Z)(i,2),u=o[0];return[o[1],"bool",u]}throw new Error("Error in Cast: failed to cast ".concat(n," to ").concat(r))}function Wg(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.dtype;if("complex64"===i){if("complex64"===a.dtype)return wg({inputs:{x:a},backend:n});var o=Zg(n,a.shape,a.dtype),u=Wg({inputs:{x:a},backend:n,attrs:{dtype:"float32"}}),s=Bg({inputs:{real:u,imag:o},backend:n});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(u),s}if("complex64"===a.dtype){var c=Lg({inputs:{input:a},backend:n}),l=Wg({inputs:{x:c},backend:n,attrs:{dtype:i}});return n.disposeIntermediateTensorInfo(c),l}if(!ii.util.hasEncodingLoss(a.dtype,i)){var f=wg({inputs:{x:a},backend:n});return{dataId:f.dataId,shape:f.shape,dtype:i}}var d=Ug(n.data.get(a.dataId).values,a.shape,a.dtype,i),h=(0,C.Z)(d,3),p=h[0],v=h[1],m=h[2];return n.makeTensorInfo(p,v,m)}var Vg={kernelName:ii.Cast,backendName:"cpu",kernelFunc:Wg};function qg(e,t,n,r){return null==n?function(n){var a=n.inputs,i=n.backend,o=a.a,u=a.b,s=i;hg([o,u],e);var c=s.data.get(o.dataId).values,l=s.data.get(u.dataId).values,f="string"===o.dtype?ii.backend_util.fromUint8ToStringArray(c):c,d="string"===o.dtype?ii.backend_util.fromUint8ToStringArray(l):l,h=r||o.dtype,p=t(o.shape,u.shape,f,d,h),v=(0,C.Z)(p,2),m=v[0],g=v[1];return s.makeTensorInfo(g,h,m)}:function(e){var a=e.inputs,i=e.backend,o=a.a,u=a.b,s=i;if("complex64"===o.dtype||"complex64"===u.dtype){var c=Wg({inputs:{x:o},backend:s,attrs:{dtype:"complex64"}}),l=s.data.get(c.dataId),f=l.complexTensorInfos.real,d=l.complexTensorInfos.imag,h=s.data.get(f.dataId).values,p=s.data.get(d.dataId).values,v=Wg({inputs:{x:u},backend:s,attrs:{dtype:"complex64"}}),m=s.data.get(v.dataId),g=m.complexTensorInfos.real,y=m.complexTensorInfos.imag,b=s.data.get(g.dataId).values,x=s.data.get(y.dataId).values,w=n(o.shape,u.shape,h,p,b,x),k=(0,C.Z)(w,3),_=k[0],S=k[1],A=k[2],E=s.makeTensorInfo(A,"float32",_),N=s.makeTensorInfo(A,"float32",S),T=Bg({inputs:{real:E,imag:N},backend:s});return s.disposeIntermediateTensorInfo(c),s.disposeIntermediateTensorInfo(v),s.disposeIntermediateTensorInfo(E),s.disposeIntermediateTensorInfo(N),T}var I=s.data.get(o.dataId).values,D=s.data.get(u.dataId).values,F=r||o.dtype,M=t(o.shape,u.shape,I,D,F),O=(0,C.Z)(M,2),R=O[0],j=O[1];return s.makeTensorInfo(j,F,R)}}function Gg(e){return function(t,n,r,a,i,o){var u=ii.backend_util.assertAndGetBroadcastShape(t,n),s=ii.util.sizeFromShape(u),c=u.length,l=ii.util.computeStrides(u),f=ii.util.getTypedArrayFromDType("float32",s),d=ii.util.getTypedArrayFromDType("float32",s),h=ii.backend_util.getBroadcastDims(t,u),p=ii.backend_util.getBroadcastDims(n,u),v=ii.backend_util.mergeRealAndImagArrays(r,a),m=ii.backend_util.mergeRealAndImagArrays(i,o),g=t.length,y=ii.util.computeStrides(t),b=n.length,x=ii.util.computeStrides(n);if(h.length+p.length===0)for(var w=0;w<f.length;w++){var k=w%v.length,_=w%m.length,S=e(v[2*k],v[2*k+1],m[2*_],m[2*_+1]);f[w]=S.real,d[w]=S.imag}else for(var C=function(t){var n=ii.util.indexToLoc(t,c,l),r=n.slice(-g);h.forEach((function(e){return r[e]=0}));var a=ii.util.locToIndex(r,g,y),i=n.slice(-b);p.forEach((function(e){return i[e]=0}));var o=ii.util.locToIndex(i,b,x),u=e(v[2*a],v[2*a+1],m[2*o],m[2*o+1]);f[t]=u.real,d[t]=u.imag},A=0;A<f.length;A++)C(A);return[f,d,u]}}var Hg=Cg((function(e,t){return e+t})),Xg=Gg((function(e,t,n,r){return{real:e+n,imag:t+r}})),Kg=qg(ii.Add,Hg,Xg),Yg={kernelName:ii.Add,backendName:"cpu",kernelFunc:Kg};function $g(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.shape,o=ii.util.sizeFromShape(a.shape),u=ii.util.inferFromImplicitShape(i,o),s=ii.util.sizeFromShape(u);ii.util.assert(o===s,(function(){return"The new shape (".concat(u,") has ").concat(s," elements and the old ")+"shape (".concat(a.shape,") has ").concat(o," elements. The new shape and old ")+"shape must have the same number of elements."})),n.incRef(a.dataId);var c=n.data.get(a.dataId);if(null!=c.complexTensorInfos){var l=c.complexTensorInfos.real,f=c.complexTensorInfos.imag;l.shape=u,f.shape=u}return{dataId:a.dataId,shape:u,dtype:a.dtype}}var Qg={kernelName:ii.Reshape,backendName:"cpu",kernelFunc:$g};function Jg(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.a,i=t.b,o=r.transposeA,u=r.transposeB;hg([a,i],"matMul");var s=a.shape.length,c=i.shape.length,l=o?a.shape[s-2]:a.shape[s-1],f=u?i.shape[c-1]:i.shape[c-2],d=o?a.shape[s-1]:a.shape[s-2],h=u?i.shape[c-2]:i.shape[c-1],p=a.shape.slice(0,-2),v=i.shape.slice(0,-2),m=ii.util.sizeFromShape(p),g=ii.util.sizeFromShape(v),y=ii.broadcast_util.assertAndGetBroadcastShape(a.shape.slice(0,-2),i.shape.slice(0,-2)).concat([d,h]);ii.util.assert(l===f,(function(){return"Error in matMul: inner shapes (".concat(l,") and (")+"".concat(f,") of Tensors with shapes ").concat(a.shape," and ")+"".concat(i.shape," and transposeA=").concat(o)+" and transposeB=".concat(u," must match.")}));for(var b=u?[g,h,f]:[g,f,h],x=$g({inputs:{x:a},backend:n,attrs:{shape:o?[m,l,d]:[m,d,l]}}),w=$g({inputs:{x:i},backend:n,attrs:{shape:b}}),k=o?x.shape[1]:x.shape[2],_=o?x.shape[2]:x.shape[1],S=u?w.shape[1]:w.shape[2],A=Math.max(m,g),E=n.data.get(x.dataId).values,N=n.data.get(w.dataId).values,T=ii.util.computeStrides(x.shape),I=ii.util.computeStrides(w.shape),D=o?[T[0],1,T[1]]:[T[0],T[1],1],F=(0,C.Z)(D,3),M=F[0],O=F[1],R=F[2],j=u?[1,I[1],I[0]]:[I[1],1,I[0]],B=(0,C.Z)(j,3),z=B[0],Z=B[1],L=B[2],P=_*S,U=(0,ii.buffer)([A,_,S],x.dtype),W=U.values,V=n.blockSize,q=0;q<A;q++)for(var G=q%m,H=q%g,X=0;X<_;X+=V)for(var K=Math.min(X+V,_),Y=0;Y<S;Y+=V)for(var $=Math.min(Y+V,S),Q=0;Q<k;Q+=V)for(var J=Math.min(Q+V,k),ee=X;ee<K;ee++)for(var te=Y;te<$;te++){for(var ne=0,re=Q;re<J;re++){ne+=E[G*M+ee*O+re*R]*N[re*z+te*Z+H*L]}W[q*P+(ee*S+te)]+=ne}return n.disposeIntermediateTensorInfo(x),n.disposeIntermediateTensorInfo(w),n.makeTensorInfo(y,U.dtype,U.values)}var ey={kernelName:ii.BatchMatMul,backendName:"cpu",kernelFunc:Jg};var ty={kernelName:ii._FusedMatMul,backendName:"cpu",kernelFunc:function(e){var t,n,r,a=e.inputs,i=e.backend,o=e.attrs,u=a.a,s=a.b,c=a.bias,l=a.preluActivationWeights,f=o.transposeA,d=o.transposeB,h=o.activation,p=o.leakyreluAlpha,v=[];t=Jg({inputs:{a:u,b:s},attrs:{transposeA:f,transposeB:d},backend:i}),c&&(n=Kg({inputs:{a:t,b:c},backend:i}),v.push(t),t=n),h&&(r=jg(i,t,h,l,p),v.push(t),t=r);for(var m=0,g=v;m<g.length;m++){var y=g[m];i.disposeIntermediateTensorInfo(y)}return t}};function ny(e){for(var t=new Float32Array(e.length),n=0;n<e.length;++n)t[n]=Math.abs(e[n]);return t}var ry={kernelName:ii.Abs,backendName:"cpu",kernelFunc:function(e){var t=e.inputs.x,n=e.backend;hg(t,"abs");var r=new Float32Array(ii.util.sizeFromShape(t.shape));return r=ny(n.data.get(t.dataId).values),n.makeOutput(r,t.shape,t.dtype)}},ay=gg(ii.Acos,(function(e){return Math.acos(e)})),iy={kernelName:ii.Acos,backendName:"cpu",kernelFunc:ay},oy=gg(ii.Acosh,(function(e){return Math.acosh(e)})),uy={kernelName:ii.Acosh,backendName:"cpu",kernelFunc:oy};var sy={kernelName:ii.AddN,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t;hg(t,"addN");for(var a=r.map((function(e){return n.data.get(e.dataId).values})),i=(0,ii.buffer)(r[0].shape,r[0].dtype),o=i.values,u=0;u<r.length;u++)for(var s=a[u],c=0;c<o.length;c++)o[c]+=s[c];return n.makeTensorInfo(i.shape,i.dtype,i.values)}};function cy(e,t,n,r,a){for(var i=t.length,o=ii.util.sizeFromShape(t),u=ii.util.computeStrides(t),s=ii.util.computeStrides(a),c=ii.util.getTypedArrayFromDType(n,ii.util.sizeFromShape(a)),l=0;l<o;++l){for(var f=ii.util.indexToLoc(l,i,u),d=new Array(f.length),h=0;h<d.length;h++)d[h]=f[r[h]];c[ii.util.locToIndex(d,i,s)]=e[l]}return c}function ly(e){var t=e.inputs,n=e.attrs,r=e.backend,a=t.x,i=n.perm;hg(a,"transpose");for(var o=a.shape.length,u=new Array(o),s=0;s<u.length;s++)u[s]=a.shape[i[s]];var c=cy(r.data.get(a.dataId).values,a.shape,a.dtype,i,u);return{dataId:r.write(c,u,a.dtype),shape:u,dtype:a.dtype}}var fy={kernelName:ii.Transpose,backendName:"cpu",kernelFunc:ly};var dy={kernelName:ii.All,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.axis,o=r.keepDims;hg(a,"all");var u=ii.util.parseAxisParam(i,a.shape),s=u,c=ii.backend_util.getAxesPermutation(s,a.shape.length),l=a;null!=c&&(l=ly({inputs:{x:a},backend:n,attrs:{perm:c}}),s=ii.backend_util.getInnerMostAxes(s.length,a.shape.length)),ii.backend_util.assertAxesAreInnerMostDims("all",s,l.shape.length);for(var f=ii.backend_util.computeOutAndReduceShapes(l.shape,s),d=(0,C.Z)(f,2),h=d[0],p=d[1],v=ii.util.sizeFromShape(p),m=ii.util.makeZerosTypedArray(ii.util.sizeFromShape(h),l.dtype),g=n.data.get(l.dataId).values,y=0;y<m.length;++y){for(var b=y*v,x=g[b],w=0;w<v;++w){var k=g[b+w];x=x&&k}m[y]=x}null!=c&&n.disposeIntermediateTensorInfo(l);var _=n.makeTensorInfo(h,l.dtype,m);if(o){var S=$g({inputs:{x:_},backend:n,attrs:{shape:ii.backend_util.expandShapeToKeepDim(h,u)}});return n.disposeIntermediateTensorInfo(_),S}return _}};var hy={kernelName:ii.Any,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.axis,o=r.keepDims;hg(a,"any");var u=ii.util.parseAxisParam(i,a.shape),s=u,c=ii.backend_util.getAxesPermutation(s,a.shape.length),l=a;null!=c&&(l=ly({inputs:{x:a},backend:n,attrs:{perm:c}}),s=ii.backend_util.getInnerMostAxes(s.length,a.shape.length)),ii.backend_util.assertAxesAreInnerMostDims("any",s,l.shape.length);for(var f=ii.backend_util.computeOutAndReduceShapes(l.shape,s),d=(0,C.Z)(f,2),h=d[0],p=d[1],v=ii.util.sizeFromShape(p),m=ii.util.makeZerosTypedArray(ii.util.sizeFromShape(h),l.dtype),g=n.data.get(l.dataId).values,y=0;y<m.length;++y){for(var b=y*v,x=g[b],w=0;w<v;++w){var k=g[b+w];x=x||k}m[y]=x}null!=c&&n.disposeIntermediateTensorInfo(l);var _=n.makeTensorInfo(h,l.dtype,m);if(o){var S=$g({inputs:{x:_},backend:n,attrs:{shape:ii.backend_util.expandShapeToKeepDim(h,u)}});return n.disposeIntermediateTensorInfo(_),S}return _}};var py={kernelName:ii.ArgMax,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.axis;hg(a,"argMax");var o=ii.util.parseAxisParam(i,a.shape),u=ii.backend_util.getAxesPermutation(o,a.shape.length),s=a,c=[];null!=u&&(s=ly({inputs:{x:a},backend:n,attrs:{perm:u}}),c.push(s),o=ii.backend_util.getInnerMostAxes(o.length,s.shape.length)),o=[o[0]],ii.backend_util.assertAxesAreInnerMostDims("argMax",o,s.shape.length);for(var l=ii.backend_util.computeOutAndReduceShapes(s.shape,o),f=(0,C.Z)(l,2),d=f[0],h=f[1],p=ii.util.sizeFromShape(d),v=ii.util.makeZerosTypedArray(p,"int32"),m=ii.util.sizeFromShape(h),g=n.data.get(s.dataId).values,y=0;y<v.length;++y){for(var b=y*m,x=g[b],w=0,k=0;k<m;++k){var _=g[b+k];_>x&&(x=_,w=k)}v[y]=w}return c.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),n.makeTensorInfo(d,"int32",v)}};var vy={kernelName:ii.ArgMin,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.axis;hg(a,"argMin");var o=ii.util.parseAxisParam(i,a.shape),u=ii.backend_util.getAxesPermutation(o,a.shape.length),s=a,c=[];null!=u&&(s=ly({inputs:{x:a},backend:n,attrs:{perm:u}}),c.push(s),o=ii.backend_util.getInnerMostAxes(o.length,s.shape.length)),o=[o[0]],ii.backend_util.assertAxesAreInnerMostDims("argMin",o,s.shape.length);for(var l=ii.backend_util.computeOutAndReduceShapes(s.shape,o),f=(0,C.Z)(l,2),d=f[0],h=f[1],p=ii.util.sizeFromShape(d),v=ii.util.makeZerosTypedArray(p,"int32"),m=ii.util.sizeFromShape(h),g=n.data.get(s.dataId).values,y=0;y<v.length;++y){for(var b=y*m,x=g[b],w=0,k=0;k<m;++k){var _=g[b+k];_<x&&(x=_,w=k)}v[y]=w}return c.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),n.makeTensorInfo(d,"int32",v)}},my=gg(ii.Asin,(function(e){return Math.asin(e)})),gy={kernelName:ii.Asin,backendName:"cpu",kernelFunc:my},yy=gg(ii.Asinh,(function(e){return Math.asinh(e)})),by={kernelName:ii.Asinh,backendName:"cpu",kernelFunc:yy},xy=gg(ii.Atan,(function(e){return Math.atan(e)})),wy={kernelName:ii.Atan,backendName:"cpu",kernelFunc:xy},ky=Cg((function(e,t){return Math.atan2(e,t)})),_y=qg(ii.Atan2,ky),Sy={kernelName:ii.Atan2,backendName:"cpu",kernelFunc:_y},Cy=gg(ii.Atanh,(function(e){return Math.atanh(e)})),Ay={kernelName:ii.Atanh,backendName:"cpu",kernelFunc:Cy};function Ey(e,t,n,r,a,i){for(var o=a.strideHeight,u=a.strideWidth,s=a.dilationHeight,c=a.dilationWidth,l=a.effectiveFilterHeight,f=a.effectiveFilterWidth,d=a.padInfo.top,h=a.padInfo.left,p="max"===i?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,v=(0,ii.buffer)(a.outShape,n),m=v.values,g=a.outShape[1]*a.outShape[2]*a.outShape[3],y=a.outShape[2]*a.outShape[3],b=a.outShape[3],x=0;x<a.batchSize;++x)for(var w=x*g,k=x*r[0],_=0;_<a.inChannels;++_)for(var S=0;S<a.outHeight;++S)for(var C=S*o-d,A=Math.max(0,C),E=Math.min(a.inHeight,l+C),N=w+S*y,T=0;T<a.outWidth;++T){for(var I=T*u-h,D=Math.max(0,I),F=Math.min(a.inWidth,f+I),M=p,O=0,R=0,j=A;j<E;j+=s){for(var B=k+j*r[1],z=D;z<F;z+=c){var Z=e[B+z*r[2]+_];"max"===i&&Z>M?M=Z:"avg"===i&&(O+=Z,R++)}if(isNaN(M))break}m[N+T*b+_]="avg"===i?O/R:M}return v}function Ny(e,t,n,r){for(var a=arguments.length>4&&void 0!==arguments[4]&&arguments[4],i=arguments.length>5&&void 0!==arguments[5]&&arguments[5],o=(0,ii.buffer)(r.outShape,"int32"),u=r.strideHeight,s=r.strideWidth,c=r.dilationHeight,l=r.dilationWidth,f=r.effectiveFilterHeight,d=r.effectiveFilterWidth,h=r.padInfo.top,p=r.padInfo.left,v=(0,ii.buffer)(t,n,e),m=0;m<r.batchSize;++m)for(var g=0;g<r.inChannels;++g)for(var y=0;y<r.outHeight;++y){for(var b=y*u-h,x=b;x<0;)x+=c;for(var w=Math.min(r.inHeight,f+b),k=0;k<r.outWidth;++k){for(var _=k*s-p,S=_;S<0;)S+=l;for(var C=Math.min(r.inWidth,d+_),A=Number.NEGATIVE_INFINITY,E=-1,N=x;N<w;N+=c)for(var T=N-b,I=S;I<C;I+=l){var D=I-_,F=v.get(m,N,I,g);F>A&&(A=F,E=a?i?((m*r.inHeight+N)*r.inWidth+I)*r.inChannels+g:(N*r.inWidth+I)*r.inChannels+g:T*d+D)}o.set(E,m,y,k,g)}}return o}function Ty(e,t,n,r,a,i){for(var o=a.strideDepth,u=a.strideHeight,s=a.strideWidth,c=a.dilationDepth,l=a.dilationHeight,f=a.dilationWidth,d=a.effectiveFilterDepth,h=a.effectiveFilterHeight,p=a.effectiveFilterWidth,v=a.padInfo.front,m=a.padInfo.top,g=a.padInfo.left,y="max"===i?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,b=(0,ii.buffer)(a.outShape,n),x=b.values,w=a.outShape[1]*a.outShape[2]*a.outShape[3]*a.outShape[4],k=a.outShape[2]*a.outShape[3]*a.outShape[4],_=a.outShape[3]*a.outShape[4],S=a.outShape[4],C=0;C<a.batchSize;++C)for(var A=C*w,E=C*r[0],N=0;N<a.inChannels;++N)for(var T=0;T<a.outDepth;++T){for(var I=T*o-v,D=I;D<0;)D+=c;for(var F=Math.min(a.inDepth,d+I),M=A+T*k,O=0;O<a.outHeight;++O){for(var R=O*u-m,j=R;j<0;)j+=l;for(var B=Math.min(a.inHeight,h+R),z=M+O*_,Z=0;Z<a.outWidth;++Z){for(var L=Z*s-g,P=L;P<0;)P+=f;for(var U=Math.min(a.inWidth,p+L),W=z+Z*S,V=y,q=0,G=0,H=D;H<F;H+=c){for(var X=E+H*r[1],K=j;K<B;K+=l){for(var Y=X+K*r[2],$=P;$<U;$+=f){var Q=e[Y+$*r[3]+N];if("max"===i&&Q>V?V=Q:"avg"===i&&(q+=Q,G++),isNaN(V))break}if(isNaN(V))break}if(isNaN(V))break}x[W+N]="avg"===i?q/Math.max(G,1):V}}}return b}var Iy={kernelName:ii.AvgPool,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x;hg(a,"avgPool");var i=r.filterSize,o=r.strides,u=r.pad,s=r.dimRoundingMode;ii.util.assert(ii.backend_util.eitherStridesOrDilationsAreOne(o,1),(function(){return"Error in avgPool: Either strides or dilations must be 1. "+"Got strides ".concat(o," and dilations '").concat(1,"'")}));var c,l=ii.backend_util.computePool2DInfo(a.shape,i,o,1,u,s);if(1===l.filterWidth&&1===l.filterHeight&&ii.util.arraysEqual(l.inShape,l.outShape))c=wg({inputs:{x:a},backend:n});else{var f=n.data.get(a.dataId).values,d=ii.util.computeStrides(a.shape),h=Ey(f,a.shape,a.dtype,d,l,"avg");c=n.makeTensorInfo(l.outShape,a.dtype,h.values)}return c}};var Dy={kernelName:ii.AvgPool3D,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.filterSize,o=r.strides,u=r.pad,s=r.dimRoundingMode,c=r.dataFormat;hg(a,"avgPool3d");var l=ii.backend_util.computePool3DInfo(a.shape,i,o,1,u,s,c),f=Ty(n.data.get(a.dataId).values,a.shape,a.dtype,ii.util.computeStrides(a.shape),l,"avg");return n.makeTensorInfo(f.shape,"float32",f.values)}};var Fy={kernelName:ii.AvgPool3DGrad,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.dy,i=t.input,o=r.filterSize,u=r.strides,s=r.pad,c=r.dimRoundingMode;hg([a,i],"avgPool3DGrad");for(var l=ii.backend_util.computePool3DInfo(i.shape,o,u,1,s,c),f=l.strideDepth,d=l.strideHeight,h=l.strideWidth,p=l.filterDepth,v=l.filterHeight,m=l.filterWidth,g=l.dilationDepth,y=l.dilationHeight,b=l.dilationWidth,x=l.effectiveFilterDepth,w=l.effectiveFilterHeight,k=l.effectiveFilterWidth,_=x-1-l.padInfo.front,S=k-1-l.padInfo.left,C=w-1-l.padInfo.top,A=(0,ii.buffer)(i.shape,"float32"),E=1/(p*v*m),N=n.bufferSync(a),T=0;T<l.batchSize;++T)for(var I=0;I<l.inChannels;++I)for(var D=0;D<l.inDepth;++D)for(var F=0;F<l.inHeight;++F)for(var M=0;M<l.inWidth;++M){for(var O=D-_,R=F-C,j=M-S,B=0,z=0;z<x;z+=g){var Z=(O+z)/f;if(!(Z<0||Z>=l.outDepth||Math.floor(Z)!==Z))for(var L=0;L<w;L+=y){var P=(R+L)/d;if(!(P<0||P>=l.outHeight||Math.floor(P)!==P))for(var U=0;U<k;U+=b){var W=(j+U)/h;if(!(W<0||W>=l.outWidth||Math.floor(W)!==W))B+=N.get(T,Z,P,W,I)}}}A.set(B*E,T,D,F,M,I)}return n.makeTensorInfo(A.shape,A.dtype,A.values)}};var My={kernelName:ii.AvgPoolGrad,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.dy,i=t.input,o=i;hg([a,i],"avgPoolGrad");for(var u=r.filterSize,s=r.strides,c=r.pad,l=ii.backend_util.computePool2DInfo(o.shape,u,s,1,c),f=l.strideHeight,d=l.strideWidth,h=l.filterHeight,p=l.filterWidth,v=l.dilationHeight,m=l.dilationWidth,g=l.effectiveFilterHeight,y=l.effectiveFilterWidth,b=y-1-l.padInfo.left,x=g-1-l.padInfo.top,w=(0,ii.buffer)(o.shape,"float32"),k=1/(h*p),_=n.data.get(a.dataId).values,S=(0,ii.buffer)(a.shape,"float32",_),C=0;C<l.batchSize;++C)for(var A=0;A<l.inChannels;++A)for(var E=0;E<l.inHeight;++E)for(var N=0;N<l.inWidth;++N){for(var T=E-x,I=N-b,D=0,F=0;F<g;F+=v){var M=(T+F)/f;if(!(M<0||M>=l.outHeight||Math.floor(M)!==M))for(var O=0;O<y;O+=m){var R=(I+O)/d;if(!(R<0||R>=l.outWidth||Math.floor(R)!==R))D+=S.get(C,M,R,A)}}w.set(D*k,C,E,N,A)}return n.makeTensorInfo(w.shape,w.dtype,w.values)}};var Oy={kernelName:ii.FusedBatchNorm,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.scale,o=t.offset,u=t.mean,s=t.variance;ii.util.assert(u.shape.length===s.shape.length,(function(){return"Batch normalization gradient requires mean and variance to have equal ranks."})),ii.util.assert(null==o||u.shape.length===o.shape.length,(function(){return"Batch normalization gradient requires mean and offset to have equal ranks."})),ii.util.assert(null==i||u.shape.length===i.shape.length,(function(){return"Batch normalization gradient requires mean and scale to have equal ranks."})),hg([a,u,s,i,o],"batchNorm");var c=r.varianceEpsilon;null==c&&(c=.001);for(var l=n.data.get(a.dataId).values,f=n.data.get(u.dataId).values,d=n.data.get(s.dataId).values,h=i?n.data.get(i.dataId).values:new Float32Array([1]),p=o?n.data.get(o.dataId).values:new Float32Array([0]),v=new Float32Array(l.length),m=p.length,g=h.length,y=d.length,b=f.length,x=0,w=0,k=0,_=0,S=0;S<l.length;++S)v[S]=p[x++]+(l[S]-f[w++])*h[k++]/Math.sqrt(d[_++]+c),x>=m&&(x=0),w>=b&&(w=0),k>=g&&(k=0),_>=y&&(_=0);return n.makeTensorInfo(a.shape,a.dtype,v)}};function Ry(e,t,n,r,a){var i=ii.slice_util.isSliceContinous(r,t,n),o=ii.util.sizeFromShape(n),u=ii.util.computeStrides(r);if(i){var s=ii.slice_util.computeFlatOffset(t,u);return"string"===a?e.slice(s,s+o):e.subarray(s,s+o)}for(var c="string"===a?ii.backend_util.fromUint8ToStringArray(e):e,l=(0,ii.buffer)(r,a,c),f=(0,ii.buffer)(n,a),d=0;d<f.size;++d){var h=f.indexToLoc(d),p=h.map((function(e,n){return e+t[n]}));f.set.apply(f,[l.get.apply(l,(0,I.Z)(p))].concat((0,I.Z)(h)))}return"string"===a?ii.backend_util.fromStringArrayToUint8(f.values):f.values}function jy(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.begin,o=r.size;hg(a,"slice");var u=ii.slice_util.parseSliceParams(a,i,o),s=(0,C.Z)(u,2),c=s[0],l=s[1];ii.slice_util.assertParamsValid(a,c,l);var f=Ry(n.data.get(a.dataId).values,c,l,a.shape,a.dtype);return n.makeTensorInfo(l,a.dtype,f)}var By={kernelName:ii.Slice,backendName:"cpu",kernelFunc:jy};var zy={kernelName:ii.BatchToSpaceND,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.blockShape,o=r.crops;hg([a],"batchToSpaceND");var u=i.reduce((function(e,t){return e*t})),s=ii.backend_util.getReshaped(a.shape,i,u),c=ii.backend_util.getPermuted(s.length,i.length),l=ii.backend_util.getReshapedPermuted(a.shape,i,u),f=ii.backend_util.getSliceBeginCoords(o,i.length),d=ii.backend_util.getSliceSize(l,o,i.length),h=$g({inputs:{x:a},backend:n,attrs:{shape:s}}),p=ly({inputs:{x:h},backend:n,attrs:{perm:c}}),v=$g({inputs:{x:p},backend:n,attrs:{shape:l}}),m=jy({inputs:{x:v},backend:n,attrs:{begin:f,size:d}});return n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(v),m}};function Zy(e,t,n,r,a){for(var i=ii.util.sizeFromShape(r),o=ii.util.makeZerosTypedArray(a,n),u=0;u<e.length;u++){var s=e[u];if(s<0)throw new Error("Input x must be non-negative!");s>=a||(o[s]+=i>0?t[u]:1)}return o}function Ly(e,t,n){for(var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=e.shape[0],i=e.shape[1],o=(0,ii.buffer)([a,n],t.dtype),u=0;u<a;u++)for(var s=0;s<i;s++){var c=e.get(u,s);if(c<0)throw new Error("Input x must be non-negative!");c>=n||(r?o.set(1,u,c):t.size>0?o.set(o.get(u,c)+t.get(u,s),u,c):o.set(o.get(u,c)+1,u,c))}return o}var Py={kernelName:ii.Bincount,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.weights,o=r.size,u=Zy(n.data.get(a.dataId).values,n.data.get(i.dataId).values,i.dtype,i.shape,o);return n.makeTensorInfo([o],i.dtype,u)}},Uy=Cg((function(e,t){return e&t})),Wy=qg(ii.BitwiseAnd,Uy),Vy={kernelName:ii.BitwiseAnd,backendName:"cpu",kernelFunc:Wy};var qy={kernelName:ii.BroadcastArgs,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.s0,a=t.s1,i=n.data.get(r.dataId).values,o=n.data.get(a.dataId).values,u=ii.backend_util.assertAndGetBroadcastShape(Array.from(i),Array.from(o));return n.makeTensorInfo([u.length],"int32",Int32Array.from(u))}},Gy=mg((function(e){return Math.ceil(e)})),Hy=yg(ii.Ceil,Gy),Xy={kernelName:ii.Ceil,backendName:"cpu",kernelFunc:Hy},Ky=gg(ii.ClipByValue,(function(e,t){var n=t;return e>n.clipValueMax?n.clipValueMax:e<n.clipValueMin?n.clipValueMin:e})),Yy={kernelName:ii.ClipByValue,backendName:"cpu",kernelFunc:Ky},$y={kernelName:ii.ComplexAbs,backendName:"cpu",kernelFunc:function(e){for(var t=e.inputs.x,n=e.backend,r=new Float32Array(ii.util.sizeFromShape(t.shape)),a=n.data.get(t.dataId),i=a.complexTensorInfos.real,o=a.complexTensorInfos.imag,u=n.data.get(i.dataId).values,s=n.data.get(o.dataId).values,c=0;c<u.length;c++){var l=u[c],f=s[c];r[c]=Math.hypot(l,f)}return n.makeOutput(r,t.shape,"float32")}};function Qy(e,t,n,r){var a=ii.util.getArrayFromDType(n,ii.util.sizeFromShape(t));if(r&&"string"!==n){var i=0;e.forEach((function(e){var t=ii.util.sizeFromShape(e.shape);a.set(e.vals,i),i+=t}))}else{var o=0;e.forEach((function(e){for(var r="string"===n?ii.backend_util.fromUint8ToStringArray(e.vals):e.vals,i=0,u=0;u<e.shape[0];++u)for(var s=u*t[1]+o,c=0;c<e.shape[1];++c)a[s+c]=r[i++];o+=e.shape[1]}))}return a}function Jy(e){var t=e.inputs,n=e.backend,r=t.input,a=n.data.get(r.dataId).complexTensorInfos.imag,i=n.data.get(a.dataId).values;return n.makeTensorInfo(a.shape,a.dtype,i)}var eb={kernelName:ii.Imag,backendName:"cpu",kernelFunc:Jy};function tb(e){var t=e.inputs,n=e.backend,r=e.attrs.axis,a=ii.util.parseAxisParam(r,t[0].shape)[0],i=t.map((function(e){return e.shape}));ii.backend_util.assertParamsConsistent(i,a);var o=ii.backend_util.computeOutShape(t.map((function(e){return e.shape})),a);if(0===ii.util.sizeFromShape(o))return n.makeTensorInfo(o,t[0].dtype,[]);var u=t.filter((function(e){return ii.util.sizeFromShape(e.shape)>0}));if(1===u.length)return wg({inputs:{x:u[0]},backend:n});if("complex64"===u[0].dtype){var s=u.map((function(e){return Lg({inputs:{input:e},backend:n})})),c=u.map((function(e){return Jy({inputs:{input:e},backend:n})})),l=tb({inputs:s,backend:n,attrs:{axis:a}}),f=tb({inputs:c,backend:n,attrs:{axis:a}}),d=Bg({inputs:{real:l,imag:f},backend:n});return s.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),c.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),n.disposeIntermediateTensorInfo(l),n.disposeIntermediateTensorInfo(f),d}var h=u.map((function(e){var t=ii.util.sizeFromShape(e.shape.slice(a));return $g({inputs:{x:e},backend:n,attrs:{shape:[-1,t]}})})),p=h.map((function(e){return{vals:n.data.get(e.dataId).values,shape:e.shape}}));o=ii.backend_util.computeOutShape(h.map((function(e){return e.shape})),1);var v=1===h[0].shape[0],m=Qy(p,o,t[0].dtype,v),g=ii.backend_util.computeOutShape(u.map((function(e){return e.shape})),a),y=n.makeTensorInfo(g,t[0].dtype,m);return h.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),y}var nb={kernelName:ii.Concat,backendName:"cpu",kernelFunc:tb};function rb(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.filter,o=r.strides,u=r.pad,s=r.dataFormat,c=r.dilations,l=r.dimRoundingMode;hg([a,i],"conv2d");for(var f=ii.backend_util.convertConv2DDataFormat(s),d=ii.backend_util.computeConv2DInfo(a.shape,i.shape,o,c,u,l,!1,f),h=d.filterHeight,p=d.filterWidth,v=d.dilationHeight,m=d.dilationWidth,g=d.padInfo.left,y=d.padInfo.top,b="channelsLast"===d.dataFormat,x=new ii.TensorBuffer(d.outShape,a.dtype),w=ii.util.computeStrides(a.shape),k=ii.util.computeStrides(i.shape),_=w[0],S=b?w[1]:w[2],C=b?w[2]:1,A=b?1:w[1],E=x.strides[0],N=b?x.strides[1]:x.strides[2],T=b?x.strides[2]:1,I=b?1:x.strides[1],D=n.data.get(a.dataId).values,F=n.data.get(i.dataId).values,M=x.values,O=0;O<d.batchSize;++O)for(var R=O*_,j=O*E,B=0;B<d.outHeight;++B)for(var z=j+B*N,Z=B*d.strideHeight-y,L=0;L<h;++L){var P=Z+L*v;if(!(P<0||P>=d.inHeight))for(var U=L*k[0],W=R+P*S,V=0;V<d.outWidth;++V)for(var q=z+V*T,G=V*d.strideWidth-g,H=0;H<p;++H){var X=G+H*m;if(!(X<0||X>=d.inWidth))for(var K=W+X*C,Y=U+H*k[1],$=0;$<d.inChannels;++$){for(var Q=D[K+$*A],J=0;J<d.outChannels;++J)M[q+J*I]+=Q*F[Y+J];Y+=d.outChannels}}}return n.makeTensorInfo(x.shape,x.dtype,M)}var ab={kernelName:ii.Conv2D,backendName:"cpu",kernelFunc:rb};var ib={kernelName:ii.Conv2DBackpropFilter,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.dy,o=r.strides,u=r.pad,s=r.dataFormat,c=r.dimRoundingMode,l=r.filterShape;hg([a,i],"conv2dBackpropFilter");for(var f=ii.backend_util.convertConv2DDataFormat(s),d=ii.backend_util.computeConv2DInfo(a.shape,l,o,1,u,c,!1,f),h=d.strideHeight,p=d.strideWidth,v=d.filterHeight,m=d.filterWidth,g="channelsLast"===d.dataFormat,y=new ii.TensorBuffer(d.filterShape,"float32"),b=d.padInfo.left,x=d.padInfo.top,w=n.data.get(a.dataId).values,k=n.data.get(i.dataId).values,_=new ii.TensorBuffer(a.shape,a.dtype,w),S=new ii.TensorBuffer(i.shape,i.dtype,k),C=0;C<v;++C)for(var A=Math.max(0,Math.ceil((x-C)/h)),E=Math.min(d.outHeight,(d.inHeight+x-C)/h),N=0;N<m;++N)for(var T=Math.max(0,Math.ceil((b-N)/p)),I=Math.min(d.outWidth,(d.inWidth+b-N)/p),D=0;D<d.inChannels;++D)for(var F=0;F<d.outChannels;++F){for(var M=0,O=0;O<d.batchSize;++O)for(var R=A;R<E;++R)for(var j=C+R*h-x,B=T;B<I;++B){var z=N+B*p-b;M+=g?_.get(O,j,z,D)*S.get(O,R,B,F):_.get(O,D,j,z)*S.get(O,F,R,B)}y.set(M,C,N,D,F)}return n.makeTensorInfo(y.shape,y.dtype,y.values)}};var ob={kernelName:ii.Conv2DBackpropInput,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.dy,i=t.filter,o=r.inputShape,u=r.strides,s=r.pad,c=r.dataFormat,l=r.dimRoundingMode;hg([a,i],"conv2dBackpropInput");var f=ii.util.computeStrides(i.shape),d=ii.util.computeStrides(a.shape),h=ii.backend_util.convertConv2DDataFormat(c),p=ii.backend_util.computeConv2DInfo(o,i.shape,u,1,s,l,!1,h),v=new ii.TensorBuffer(p.inShape,"float32"),m=v.values,g=n.data.get(a.dataId).values,y=n.data.get(i.dataId).values,b=(0,C.Z)(f,3),x=b[0],w=b[1],k=b[2],_=p.batchSize,S=p.filterHeight,A=p.filterWidth,E=p.inChannels,N=p.inHeight,T=p.inWidth,I=p.outChannels,D=p.outHeight,F=p.outWidth,M=p.strideHeight,O=p.strideWidth;h=p.dataFormat;for(var R=S-1-p.padInfo.top,j=A-1-p.padInfo.left,B="channelsLast"===h,z=v.strides[0],Z=B?v.strides[1]:v.strides[2],L=B?v.strides[2]:1,P=B?1:v.strides[1],U=d[0],W=B?d[1]:d[2],V=B?d[2]:1,q=B?1:d[1],G=0;G<_;++G)for(var H=0;H<E;++H)for(var X=0;X<N;++X)for(var K=X-R,Y=Math.max(0,Math.ceil(K/M)),$=Math.min(D,(S+K)/M),Q=0;Q<T;++Q){for(var J=Q-j,ee=Math.max(0,Math.ceil(J/O)),te=Math.min(F,(A+J)/O),ne=0,re=Y;re<$;++re)for(var ae=re*M-K,ie=ee;ie<te;++ie)for(var oe=U*G+W*re+V*ie,ue=x*(S-1-ae)+w*(A-1-(ie*O-J))+k*H,se=0;se<I;++se){ne+=g[oe+q*se]*y[ue+se]}m[z*G+Z*X+L*Q+P*H]=ne}return n.makeTensorInfo(v.shape,v.dtype,v.values)}};var ub={kernelName:ii.Conv3D,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.filter,o=r.strides,u=r.pad,s=r.dilations;hg([a,i],"conv3d");for(var c=ii.backend_util.computeConv3DInfo(a.shape,i.shape,o,s,u),l=c.filterDepth,f=c.filterHeight,d=c.filterWidth,h=c.dilationDepth,p=c.dilationHeight,v=c.dilationWidth,m=c.padInfo,g=m.front,y=m.left,b=m.top,x=new ii.TensorBuffer(c.outShape,a.dtype),w=n.data.get(a.dataId).values,k=n.data.get(i.dataId).values,_=x.values,S=ii.util.computeStrides(a.shape),C=ii.util.computeStrides(i.shape),A=0;A<c.batchSize;++A)for(var E=A*S[0],N=A*x.strides[0],T=0;T<c.outDepth;++T)for(var I=N+T*x.strides[1],D=T*c.strideDepth-g,F=0;F<l;++F){var M=D+F*h;if(!(M<0||M>=c.inDepth))for(var O=F*C[0],R=E+M*S[1],j=0;j<c.outHeight;++j)for(var B=I+j*x.strides[2],z=j*c.strideHeight-b,Z=0;Z<f;++Z){var L=z+Z*p;if(!(L<0||L>=c.inHeight))for(var P=O+Z*C[1],U=R+L*S[2],W=0;W<c.outWidth;++W)for(var V=B+W*c.outChannels,q=W*c.strideWidth-y,G=0;G<d;++G){var H=q+G*v;if(!(H<0||H>=c.inWidth))for(var X=P+G*C[2],K=U+H*c.inChannels,Y=X,$=0;$<c.inChannels;++$){for(var Q=w[K+$],J=0;J<c.outChannels;++J)_[V+J]+=Q*k[Y+J];Y+=c.outChannels}}}}return n.makeTensorInfo(x.shape,x.dtype,x.values)}};var sb={kernelName:ii.Conv3DBackpropFilterV2,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.dy,o=r.strides,u=r.pad,s=r.filterShape;hg([a,i],"conv3dBackpropFilterV2");for(var c=ii.util.computeStrides(a.shape),l=ii.util.computeStrides(i.shape),f=ii.backend_util.computeConv3DInfo(a.shape,s,o,1,u),d=f.strideDepth,h=f.strideHeight,p=f.strideWidth,v=f.filterDepth,m=f.filterHeight,g=f.filterWidth,y=new ii.TensorBuffer(f.filterShape,"float32"),b=y.values,x=(0,C.Z)(y.strides,4),w=x[0],k=x[1],_=x[2],S=x[3],A=n.data.get(i.dataId).values,E=(0,C.Z)(l,4),N=E[0],T=E[1],I=E[2],D=E[3],F=n.data.get(a.dataId).values,M=(0,C.Z)(c,4),O=M[0],R=M[1],j=M[2],B=M[3],z=f.padInfo.front,Z=f.padInfo.left,L=f.padInfo.top,P=0;P<v;++P)for(var U=Math.max(0,Math.ceil((z-P)/d)),W=Math.min(f.outDepth,(f.inDepth+z-P)/d),V=P*w,q=0;q<m;++q)for(var G=Math.max(0,Math.ceil((L-q)/h)),H=Math.min(f.outHeight,(f.inHeight+L-q)/h),X=q*k+V,K=0;K<g;++K)for(var Y=Math.max(0,Math.ceil((Z-K)/p)),$=Math.min(f.outWidth,(f.inWidth+Z-K)/p),Q=K*_+X,J=0;J<f.inChannels;++J)for(var ee=J*S+Q,te=0;te<f.outChannels;++te){for(var ne=0,re=0;re<f.batchSize;++re)for(var ae=re*O,ie=re*N,oe=U;oe<W;++oe)for(var ue=(P+oe*d-z)*R+ae,se=oe*T+ie,ce=G;ce<H;++ce)for(var le=(q+ce*h-L)*j+ue,fe=ce*I+se,de=Y;de<$;++de){var he=de*D+fe;ne+=F[(K+de*p-Z)*B+le+J]*A[he+te]}b[ee+te]=ne}return n.makeTensorInfo(y.shape,y.dtype,y.values)}};var cb={kernelName:ii.Conv3DBackpropInputV2,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.dy,i=t.filter,o=r.pad,u=r.strides,s=r.inputShape;hg([a],"conv3dBackpropInputV2");for(var c=ii.util.computeStrides(a.shape),l=ii.util.computeStrides(i.shape),f=ii.backend_util.computeConv3DInfo(s,i.shape,u,1,o),d=new ii.TensorBuffer(f.inShape,"float32"),h=d.values,p=(0,C.Z)(d.strides,4),v=p[0],m=p[1],g=p[2],y=p[3],b=n.data.get(a.dataId).values,x=(0,C.Z)(c,4),w=x[0],k=x[1],_=x[2],S=x[3],A=n.data.get(i.dataId).values,E=(0,C.Z)(l,4),N=E[0],T=E[1],I=E[2],D=E[3],F=f.batchSize,M=f.filterDepth,O=f.filterHeight,R=f.filterWidth,j=f.inChannels,B=f.inDepth,z=f.inHeight,Z=f.inWidth,L=f.outChannels,P=f.outDepth,U=f.outHeight,W=f.outWidth,V=f.strideDepth,q=f.strideHeight,G=f.strideWidth,H=M-1-f.padInfo.front,X=O-1-f.padInfo.top,K=R-1-f.padInfo.left,Y=0;Y<F;++Y)for(var $=0;$<j;++$)for(var Q=0;Q<B;++Q)for(var J=Q-H,ee=Math.max(0,Math.ceil(J/V)),te=Math.min(P,(M+J)/V),ne=0;ne<z;++ne)for(var re=ne-X,ae=Math.max(0,Math.ceil(re/q)),ie=Math.min(U,(O+re)/q),oe=0;oe<Z;++oe){for(var ue=oe-K,se=Math.max(0,Math.ceil(ue/G)),ce=Math.min(W,(R+ue)/G),le=0,fe=ee;fe<te;++fe)for(var de=fe*V-J,he=ae;he<ie;++he)for(var pe=he*q-re,ve=se;ve<ce;++ve)for(var me=w*Y+k*fe+_*he+S*ve,ge=N*(M-1-de)+T*(O-1-pe)+I*(R-1-(ve*G-ue))+D*$,ye=0;ye<L;++ye){le+=b[me+ye]*A[ge+ye]}h[v*Y+m*Q+g*ne+y*oe+$]=le}return n.makeTensorInfo(d.shape,d.dtype,d.values)}},lb=gg(ii.Cos,(function(e){return Math.cos(e)})),fb={kernelName:ii.Cos,backendName:"cpu",kernelFunc:lb},db=gg(ii.Cosh,(function(e){return Math.cosh(e)})),hb={kernelName:ii.Cosh,backendName:"cpu",kernelFunc:db};var pb={kernelName:ii.CropAndResize,backendName:"cpu",kernelFunc:function(e){for(var t=e.inputs,n=e.backend,r=e.attrs,a=t.image,i=t.boxes,o=t.boxInd,u=r.cropSize,s=r.method,c=r.extrapolationValue,l=(0,C.Z)(a.shape,4),f=l[0],d=l[1],h=l[2],p=l[3],v=i.shape[0],m=(0,C.Z)(u,2),g=m[0],y=m[1],b=(0,ii.buffer)([v,g,y,p],"float32"),x=n.data.get(i.dataId).values,w=n.data.get(o.dataId).values,k=n.data.get(a.dataId).values,_=ii.util.computeStrides(a.shape),S=ii.util.computeStrides(b.shape),A=0;A<v;A++){var E=4*A,N=x[E],T=x[E+1],I=x[E+2],D=x[E+3],F=w[A];if(!(F>=f))for(var M=g>1?(I-N)*(d-1)/(g-1):0,O=y>1?(D-T)*(h-1)/(y-1):0,R=0;R<g;R++){var j=g>1?N*(d-1)+R*M:.5*(N+I)*(d-1);if(j<0||j>d-1)for(var B=0;B<y;B++)for(var z=0;z<p;z++){var Z=z+B*S[2]+R*S[1]+A*S[0];b.values[Z]=c}else if("bilinear"===s)for(var L=Math.floor(j),P=Math.ceil(j),U=j-L,W=0;W<y;W++){var V=y>1?T*(h-1)+W*O:.5*(T+D)*(h-1);if(V<0||V>h-1)for(var q=0;q<p;q++){var G=q+W*S[2]+R*S[1]+A*S[0];b.values[G]=c}else for(var H=Math.floor(V),X=Math.ceil(V),K=V-H,Y=0;Y<p;Y++){var $=Y+H*_[2]+L*_[1]+F*_[0],Q=k[$],J=k[$=Y+X*_[2]+L*_[1]+F*_[0]],ee=k[$=Y+H*_[2]+P*_[1]+F*_[0]],te=Q+(J-Q)*K,ne=ee+(k[$=Y+X*_[2]+P*_[1]+F*_[0]]-ee)*K;$=Y+W*S[2]+R*S[1]+A*S[0],b.values[$]=te+(ne-te)*U}}else for(var re=0;re<y;++re){var ae=y>1?T*(h-1)+re*O:.5*(T+D)*(h-1);if(ae<0||ae>h-1)for(var ie=0;ie<p;ie++){var oe=ie+re*S[2]+R*S[1]+A*S[0];b.values[oe]=c}else for(var ue=Math.round(ae),se=Math.round(j),ce=0;ce<p;ce++){var le=ce+ue*_[2]+se*_[1]+F*_[0],fe=ce+re*S[2]+R*S[1]+A*S[0];b.values[fe]=k[le]}}}}return n.makeTensorInfo(b.shape,b.dtype,b.values)}};var vb={kernelName:ii.Cumprod,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.axis,o=r.exclusive,u=r.reverse;hg(a,"cumprod");var s=ii.backend_util.getAxesPermutation([i],a.shape.length),c=a;null!=s&&(c=ly({inputs:{x:a},backend:n,attrs:{perm:s}}));var l=ii.backend_util.getInnerMostAxes(1,a.shape.length)[0];if(l!==c.shape.length-1)throw new Error("backend.cumprod in CPU expects an inner-most "+"axis=".concat(c.shape.length-1," but got axis=").concat(l));for(var f=(0,ii.upcastType)(c.dtype,"int32"),d=ii.util.makeOnesTypedArray(ii.util.sizeFromShape(c.shape),f),h=n.data.get(c.dataId).values,p=c.shape[c.shape.length-1],v=u?function(e,t){return e+p-t-1}:function(e,t){return e+t},m=0;m<h.length;m+=p)for(var g=0;g<p;g++){var y=v(m,g);if(0===g)d[y]=o?1:h[y];else{var b=v(m,g-1);d[y]=o?h[b]*d[b]:h[y]*d[b]}}var x=n.makeTensorInfo(c.shape,f,d);if(null!=s){var w=ly({inputs:{x:x},backend:n,attrs:{perm:ii.backend_util.getUndoAxesPermutation(s)}});return n.disposeIntermediateTensorInfo(x),n.disposeIntermediateTensorInfo(c),w}return x}};var mb={kernelName:ii.Cumsum,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.axis,o=r.exclusive,u=r.reverse;hg(a,"cumsum");var s=ii.backend_util.getAxesPermutation([i],a.shape.length),c=a;null!=s&&(c=ly({inputs:{x:a},backend:n,attrs:{perm:s}}));var l=ii.backend_util.getInnerMostAxes(1,a.shape.length)[0];if(l!==c.shape.length-1)throw new Error("backend.cumsum in CPU expects an inner-most "+"axis=".concat(c.shape.length-1," but got axis=").concat(l));for(var f=(0,ii.upcastType)(c.dtype,"int32"),d=ii.util.makeZerosTypedArray(ii.util.sizeFromShape(c.shape),f),h=n.data.get(c.dataId).values,p=c.shape[c.shape.length-1],v=u?function(e,t){return e+p-t-1}:function(e,t){return e+t},m=0;m<h.length;m+=p)for(var g=0;g<p;g++){var y=v(m,g);if(0===g)d[y]=o?0:h[y];else{var b=v(m,g-1);d[y]=o?h[b]+d[b]:h[y]+d[b]}}var x=n.makeTensorInfo(c.shape,f,d);if(null!=s){var w=ly({inputs:{x:x},backend:n,attrs:{perm:ii.backend_util.getUndoAxesPermutation(s)}});return n.disposeIntermediateTensorInfo(x),n.disposeIntermediateTensorInfo(c),w}return x}};var gb={kernelName:ii.DenseBincount,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.weights,o=r.size,u=r.binaryOutput;if(1===a.shape.length){var s=Zy(n.data.get(a.dataId).values,n.data.get(i.dataId).values,i.dtype,i.shape,o);return n.makeTensorInfo([o],i.dtype,s)}if(2===a.shape.length){var c=Ly(n.bufferSync(a),n.bufferSync(i),o,u);return n.makeTensorInfo(c.shape,i.dtype,c.values)}throw new Error("Error in denseBincount: input must be at most rank 2, but got rank"+"".concat(a.shape.length,"."))}};var yb={kernelName:ii.DepthToSpace,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.blockSize,o=r.dataFormat;ii.util.assert("NHWC"===o,(function(){return"Only NHWC dataFormat supported on CPU for depthToSpace. Got ".concat(o)}));for(var u=a.shape[0],s=a.shape[1],c=a.shape[2],l=a.shape[3],f=s*i,d=c*i,h=l/(i*i),p=n.data.get(a.dataId).values,v=new Float32Array(u*f*d*h),m=0,g=0;g<u;++g)for(var y=0;y<f;++y)for(var b=Math.floor(y/i),x=y%i,w=0;w<d;++w)for(var k=Math.floor(w/i),_=(x*i+w%i)*h,S=0;S<h;++S){var C=S+_+l*(k+c*(b+s*g));v[m++]=p[C]}return n.makeTensorInfo([u,f,d,h],a.dtype,v)}};function bb(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.filter,o=r.strides,u=r.pad,s=r.dilations,c=r.dimRoundingMode;hg([a,i],"depthwiseConv2DNative");var l=ii.util.computeStrides(a.shape),f=ii.util.computeStrides(i.shape),d=s;null==d&&(d=[1,1]),ii.util.assert(ii.backend_util.eitherStridesOrDilationsAreOne(o,d),(function(){return"Error in depthwiseConv2d: Either strides or dilations must be "+"1. Got strides ".concat(o," and dilations '").concat(d,"'")}));for(var h=ii.backend_util.computeConv2DInfo(a.shape,i.shape,o,d,u,c,!0),p=h.filterHeight,v=h.filterWidth,m=h.dilationHeight,g=h.dilationWidth,y=h.padInfo,b=y.left,x=y.top,w=h.outChannels/h.inChannels,k=new ii.TensorBuffer(h.outShape,a.dtype),_=n.data.get(a.dataId).values,S=n.data.get(i.dataId).values,C=k.values,A=0;A<h.batchSize;++A)for(var E=A*l[0],N=A*k.strides[0],T=0;T<h.outHeight;++T)for(var I=N+T*k.strides[1],D=T*h.strideHeight-x,F=0;F<p;++F){var M=D+F*m;if(!(M<0||M>=h.inHeight))for(var O=F*f[0],R=E+M*l[1],j=0;j<h.outWidth;++j)for(var B=I+j*k.strides[2],z=j*h.strideWidth-b,Z=0;Z<v;++Z){var L=z+Z*g;if(!(L<0||L>=h.inWidth))for(var P=O+Z*f[1],U=R+L*h.inChannels,W=B,V=P,q=0;q<h.inChannels;++q){for(var G=_[U+q],H=0;H<w;++H)C[W+H]+=G*S[V+H];W+=w,V+=w}}}return n.makeTensorInfo(k.shape,k.dtype,k.values)}var xb={kernelName:ii.DepthwiseConv2dNative,backendName:"cpu",kernelFunc:bb};var wb={kernelName:ii.DepthwiseConv2dNativeBackpropFilter,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.dy,o=r.strides,u=r.dilations,s=r.pad,c=r.dimRoundingMode,l=r.filterShape;hg([a,i],"depthwiseConv2dNativeBackpropFilter");for(var f=ii.backend_util.computeConv2DInfo(a.shape,l,o,u,s,c,!0),d=f.strideHeight,h=f.strideWidth,p=f.filterHeight,v=f.filterWidth,m=new ii.TensorBuffer(f.filterShape,"float32"),g=f.padInfo.left,y=f.padInfo.top,b=f.outChannels/f.inChannels,x=n.data.get(a.dataId).values,w=new ii.TensorBuffer(a.shape,a.dtype,x),k=n.data.get(i.dataId).values,_=new ii.TensorBuffer(i.shape,i.dtype,k),S=0;S<p;++S)for(var C=Math.max(0,Math.ceil((y-S)/d)),A=Math.min(f.outHeight,(f.inHeight+y-S)/d),E=0;E<v;++E)for(var N=Math.max(0,Math.ceil((g-E)/h)),T=Math.min(f.outWidth,(f.inWidth+g-E)/h),I=0;I<f.outChannels;++I){for(var D=Math.trunc(I/b),F=I%b,M=0,O=0;O<f.batchSize;++O)for(var R=C;R<A;++R)for(var j=S+R*d-y,B=N;B<T;++B){var z=E+B*h-g;M+=w.get(O,j,z,D)*_.get(O,R,B,I)}m.set(M,S,E,D,F)}return n.makeTensorInfo(m.shape,m.dtype,m.values)}};var kb={kernelName:ii.DepthwiseConv2dNativeBackpropInput,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.dy,i=t.filter,o=r.strides,u=r.dilations,s=r.pad,c=r.dimRoundingMode,l=r.inputShape;hg([a,i],"depthwiseConv2DNativeBackpropInput");for(var f=ii.util.computeStrides(a.shape),d=ii.util.computeStrides(i.shape),h=ii.backend_util.computeConv2DInfo(l,i.shape,o,u,s,c,!0),p=new ii.TensorBuffer(h.inShape,"float32"),v=p.values,m=(0,C.Z)(p.strides,3),g=m[0],y=m[1],b=m[2],x=n.data.get(a.dataId).values,w=(0,C.Z)(f,3),k=w[0],_=w[1],S=w[2],A=n.data.get(i.dataId).values,E=(0,C.Z)(d,3),N=E[0],T=E[1],I=E[2],D=h.batchSize,F=h.filterHeight,M=h.filterWidth,O=h.inChannels,R=h.inHeight,j=h.inWidth,B=h.outChannels,z=h.outHeight,Z=h.outWidth,L=h.strideHeight,P=h.strideWidth,U=F-1-h.padInfo.top,W=M-1-h.padInfo.left,V=B/O,q=0;q<D;++q)for(var G=0;G<O;++G)for(var H=0;H<R;++H)for(var X=H-U,K=Math.max(0,Math.ceil(X/L)),Y=Math.min(z,(F+X)/L),$=0;$<j;++$){for(var Q=$-W,J=Math.max(0,Math.ceil(Q/P)),ee=Math.min(Z,(M+Q)/P),te=0,ne=K;ne<Y;++ne)for(var re=ne*L-X,ae=J;ae<ee;++ae)for(var ie=k*q+_*ne+S*ae,oe=N*(F-1-re)+T*(M-1-(ae*P-Q))+I*G,ue=0;ue<V;++ue){te+=x[ie+(G*V+ue)]*A[oe+ue]}v[g*q+y*H+b*$+G]=te}return n.makeTensorInfo(p.shape,p.dtype,p.values)}};var _b={kernelName:ii.Diag,backendName:"cpu",kernelFunc:function(e){for(var t=e.inputs,n=e.backend,r=t.x,a=ii.util.sizeFromShape(r.shape),i=n.data.get(r.dataId).values,o=(0,ii.buffer)([a,a],r.dtype),u=o.values,s=0;s<i.length;s++)u[s*a+s]=i[s];var c=[].concat((0,I.Z)(r.shape),(0,I.Z)(r.shape));return n.makeTensorInfo(c,o.dtype,o.values)}},Sb={kernelName:ii.Dilation2D,backendName:"cpu",kernelFunc:function(e){for(var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.filter,o=r.strides,u=r.pad,s=r.dilations,c=n,l=c.data.get(a.dataId).values,f=a.shape.length,d=c.data.get(i.dataId).values,h=i.shape.length,p=ii.backend_util.computeDilation2DInfo(a.shape,i.shape,o,u,"NHWC",s),v=p.batchSize,m=p.inHeight,g=p.inWidth,y=p.inChannels,b=p.outHeight,x=p.outWidth,w=p.padInfo,k=p.strideHeight,_=p.strideWidth,S=p.filterHeight,C=p.filterWidth,A=p.dilationHeight,E=p.dilationWidth,N=p.outShape,T=ii.util.sizeFromShape(N),I=N.length,D=ii.util.getArrayFromDType(a.dtype,T),F=0;F<v;++F)for(var M=0;M<b;++M)for(var O=M*k-w.top,R=0;R<x;++R)for(var j=R*_-w.left,B=0;B<y;++B){for(var z=Number.MIN_SAFE_INTEGER,Z=0;Z<S;++Z){var L=O+Z*A;if(L>=0&&L<m)for(var P=0;P<C;++P){var U=j+P*E;if(U>=0&&U<g){var W=ii.util.locToIndex([F,L,U,B],f,ii.util.computeStrides(a.shape)),V=ii.util.locToIndex([Z,P,B],h,ii.util.computeStrides(i.shape)),q=l[W]+d[V];q>z&&(z=q)}}}D[ii.util.locToIndex([F,M,R,B],I,ii.util.computeStrides(N))]=z}return{dataId:c.write(ii.util.toTypedArray(D,a.dtype),N,a.dtype),shape:N,dtype:a.dtype}}},Cb={kernelName:ii.Dilation2DBackpropFilter,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.filter,o=t.dy,u=r.strides,s=r.pad,c=r.dilations,l=n,f=ii.util.toNestedArray(a.shape,l.data.get(a.dataId).values),d=ii.util.toNestedArray(i.shape,l.data.get(i.dataId).values),h=ii.backend_util.computeDilation2DInfo(a.shape,i.shape,u,s,"NHWC",c),p=h.batchSize,v=h.inHeight,m=h.inWidth,g=h.inChannels,y=h.outHeight,b=h.outWidth,x=h.padInfo,w=h.strideHeight,k=h.strideWidth,_=h.filterHeight,S=h.filterWidth,C=h.dilationHeight,A=h.dilationWidth,E=h.outShape;ii.util.assert(o.rank===E.length,(function(){return"Error in ".concat(ii.Dilation2DBackpropFilter,", dy ")+"must have the same rank as output ".concat(E.length,", but got ")+"".concat(o.rank)}));for(var N=ii.util.toNestedArray(E,l.data.get(o.dataId).values),T=ii.util.makeZerosNestedTypedArray(i.shape,i.dtype),I=0;I<p;++I)for(var D=0;D<y;++D)for(var F=D*w-x.top,M=0;M<b;++M)for(var O=M*k-x.left,R=0;R<g;++R){for(var j=Number.MIN_SAFE_INTEGER,B=0,z=0,Z=0;Z<_;++Z){var L=F+Z*C;if(L>=0&&L<v)for(var P=0;P<S;++P){var U=O+P*A;if(U>=0&&U<m){var W=f[I][L][U][R]+d[Z][P][R];W>j&&(j=W,B=Z,z=P)}}}T[B][z][R]+=N[I][D][M][R]}return{dataId:l.write(ii.util.toTypedArray(T,a.dtype),i.shape,i.dtype),shape:i.shape,dtype:i.dtype}}},Ab={kernelName:ii.Dilation2DBackpropInput,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.filter,o=t.dy,u=r.strides,s=r.pad,c=r.dilations,l=n,f=ii.util.toNestedArray(a.shape,l.data.get(a.dataId).values),d=ii.util.toNestedArray(i.shape,l.data.get(i.dataId).values),h=ii.backend_util.computeDilation2DInfo(a.shape,i.shape,u,s,"NHWC",c),p=h.batchSize,v=h.inHeight,m=h.inWidth,g=h.inChannels,y=h.outHeight,b=h.outWidth,x=h.padInfo,w=h.strideHeight,k=h.strideWidth,_=h.filterHeight,S=h.filterWidth,C=h.dilationHeight,A=h.dilationWidth,E=h.outShape;ii.util.assert(o.rank===E.length,(function(){return"Error in ".concat(ii.Dilation2DBackpropInput,", dy ")+"must have the same rank as output ".concat(E.length,", but got ")+"".concat(o.rank)}));for(var N=ii.util.toNestedArray(E,l.data.get(o.dataId).values),T=ii.util.makeZerosNestedTypedArray(a.shape,a.dtype),I=0;I<p;++I)for(var D=0;D<y;++D)for(var F=D*w-x.top,M=0;M<b;++M)for(var O=M*k-x.left,R=0;R<g;++R){for(var j=Number.MIN_SAFE_INTEGER,B=F<0?0:F,z=O<0?0:O,Z=0;Z<_;++Z){var L=F+Z*C;if(L>=0&&L<v)for(var P=0;P<S;++P){var U=O+P*A;if(U>=0&&U<m){var W=f[I][L][U][R]+d[Z][P][R];W>j&&(j=W,B=L,z=U)}}}T[I][B][z][R]+=N[I][D][M][R]}return{dataId:l.write(ii.util.toTypedArray(T,a.dtype),a.shape,a.dtype),shape:a.shape,dtype:a.dtype}}};var Eb={kernelName:ii.Draw,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.image,i=r.canvas,o=r.options||{},u=o.contextOptions,s=o.imageOptions,c=(null===s||void 0===s?void 0:s.alpha)||1,l=(null===u||void 0===u?void 0:u.contextType)||"2d";if("2d"!==l)throw new Error("Context type ".concat(u.contextType," is not supported by the CPU backend."));var f=i.getContext(l,(null===u||void 0===u?void 0:u.contextAttributes)||{});if(null==f)throw new Error("Could not get the context with ".concat(l," type."));for(var d=a.shape.slice(0,2),h=(0,C.Z)(d,2),p=h[0],v=h[1],m=2===a.shape.length?1:a.shape[2],g=n.data.get(a.dataId).values,y="float32"===a.dtype?255:1,b=new Uint8ClampedArray(v*p*4),x=0;x<p*v;++x){for(var w=[0,0,0,255*c],k=0;k<m;k++){var _=g[x*m+k];if("float32"===a.dtype){if(_<0||_>1)throw new Error("Tensor values for a float32 Tensor must be in the "+"range [0 - 1] but encountered ".concat(_,"."))}else if("int32"===a.dtype&&(_<0||_>255))throw new Error("Tensor values for a int32 Tensor must be in the "+"range [0 - 255] but encountered ".concat(_,"."));1===m?(w[0]=_*y,w[1]=_*y,w[2]=_*y):w[k]=_*y}var S=4*x;b[S+0]=Math.round(w[0]),b[S+1]=Math.round(w[1]),b[S+2]=Math.round(w[2]),b[S+3]=Math.round(w[3])}i.width=v,i.height=p;var A=new ImageData(b,v,p);return f.putImageData(A,0,0),a}},Nb=Cg((function(e,t){return e*t})),Tb=Gg((function(e,t,n,r){return{real:e*n-t*r,imag:e*r+t*n}})),Ib=qg(ii.Multiply,Nb,Tb),Db={kernelName:ii.Multiply,backendName:"cpu",kernelFunc:Ib};function Fb(e){var t,n=e.inputs,r=e.backend,a=e.attrs,i=n.x,o=a.axis,u=a.keepDims;hg(i,"sum");var s=(t="bool"===i.dtype?Wg({inputs:{x:i},backend:r,attrs:{dtype:"int32"}}):wg({inputs:{x:i},backend:r})).shape.length,c=ii.util.parseAxisParam(o,t.shape),l=ii.backend_util.getAxesPermutation(c,s),f=c,d=t;null!=l&&(d=ly({inputs:{x:t},backend:r,attrs:{perm:l}}),f=ii.backend_util.getInnerMostAxes(f.length,s)),ii.backend_util.assertAxesAreInnerMostDims("sum",f,d.shape.length);for(var h=ii.backend_util.computeOutAndReduceShapes(d.shape,f),p=(0,C.Z)(h,2),v=p[0],m=p[1],g=Zg(r,v,ii.backend_util.upcastType(d.dtype,"int32")),y=ii.util.sizeFromShape(m),b=r.data.get(g.dataId).values,x=r.data.get(d.dataId).values,w=0;w<b.length;++w){for(var k=w*y,_=0,S=0;S<y;++S)_+=x[k+S];b[w]=_}if(u){var A=g;g=$g({inputs:{x:g},backend:r,attrs:{shape:ii.backend_util.expandShapeToKeepDim(g.shape,c)}}),r.disposeIntermediateTensorInfo(A)}return r.disposeIntermediateTensorInfo(t),null!=l&&r.disposeIntermediateTensorInfo(d),g}var Mb={kernelName:ii.Sum,backendName:"cpu",kernelFunc:Fb};var Ob={kernelName:ii.Einsum,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs.equation,a=t,i=ii.backend_util.decodeEinsumEquation(r,a.length),o=i.allDims,u=i.summedDims,s=i.idDims;ii.backend_util.checkEinsumDimSizes(o.length,s,a);for(var c=ii.backend_util.getEinsumComputePath(u,s),l=c.path,f=c.steps,d=f.length,h=null,p=o.length,v=[],m=0;m<d;++m){var g,y=(0,B.Z)(f[m]);try{for(y.s();!(g=y.n()).done;){var b=g.value,x=ii.backend_util.getEinsumPermutation(p,s[b]),w=x.permutationIndices,k=x.expandDims,_=void 0;ii.backend_util.isIdentityPermutation(w)?_=a[b]:(_=ly({inputs:{x:a[b]},backend:n,attrs:{perm:w}}),v.push(_));for(var S=_.shape.slice(),C=0;C<k.length;++C)S.splice(k[C],0,1);ii.util.arraysEqual(_.shape,S)||(_=$g({inputs:{x:_},backend:n,attrs:{shape:S}}),v.push(_)),null===h?h=_:(h=Ib({inputs:{a:_,b:h},backend:n}),v.push(h))}}catch(T){y.e(T)}finally{y.f()}m<d-1&&(l[m]>=0&&(h=Fb({inputs:{x:h},backend:n,attrs:{axis:l[m]-(o.length-p),keepDims:!1}}),v.push(h)),p--)}for(var A=0,E=v;A<E.length;A++){var N=E[A];N!==h&&n.disposeIntermediateTensorInfo(N)}return h}};var Rb={kernelName:ii.EluGrad,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.dy,a=t.y;hg([r,a],"eluGrad");for(var i=new Float32Array(ii.util.sizeFromShape(a.shape)),o=n.data.get(a.dataId).values,u=n.data.get(r.dataId).values,s=0;s<o.length;++s){var c=o[s];i[s]=c>=0?u[s]:u[s]*(c+1)}return n.makeTensorInfo(a.shape,"float32",i)}},jb=Cg((function(e,t){return e===t?1:0})),Bb=qg(ii.Equal,jb,null,"bool"),zb={kernelName:ii.Equal,backendName:"cpu",kernelFunc:Bb},Zb=ii.backend_util.ERF_P,Lb=ii.backend_util.ERF_A1,Pb=ii.backend_util.ERF_A2,Ub=ii.backend_util.ERF_A3,Wb=ii.backend_util.ERF_A4,Vb=ii.backend_util.ERF_A5,qb=gg(ii.Erf,(function(e){var t=Math.sign(e),n=Math.abs(e),r=1/(1+Zb*n);return t*(1-((((Vb*r+Wb)*r+Ub)*r+Pb)*r+Lb)*r*Math.exp(-n*n))})),Gb={kernelName:ii.Erf,backendName:"cpu",kernelFunc:qb},Hb=mg((function(e){return Math.exp(e)})),Xb=yg(ii.Exp,Hb,"float32"),Kb={kernelName:ii.Exp,backendName:"cpu",kernelFunc:Xb};function Yb(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.input,i=r.dim,o=a.shape.length,u=a.shape.slice(),s=i;return i<0&&(ii.util.assert(-(o+1)<=i,(function(){return"Axis must be in the interval [".concat(-(o+1),", ").concat(o,"]")})),s=o+i+1),u.splice(s,0,1),$g({inputs:{x:a},backend:n,attrs:{shape:u}})}var $b={kernelName:ii.ExpandDims,backendName:"cpu",kernelFunc:Yb},Qb=mg((function(e){return Math.expm1(e)})),Jb=yg(ii.Expm1,Qb),ex={kernelName:ii.Expm1,backendName:"cpu",kernelFunc:Jb},tx=Cg((function(e,t){return e/t})),nx=qg(ii.RealDiv,tx),rx={kernelName:ii.RealDiv,backendName:"cpu",kernelFunc:nx},ax=Cg((function(e,t){return e-t})),ix=Gg((function(e,t,n,r){return{real:e-n,imag:t-r}})),ox=qg(ii.Sub,ax,ix),ux={kernelName:ii.Sub,backendName:"cpu",kernelFunc:ox};function sx(e,t,n){for(var r=e.shape,a=r[0],i=r[1],o=n.data.get(e.dataId),u=o.complexTensorInfos.real,s=o.complexTensorInfos.imag,c=[a,i],l=ii.util.sizeFromShape(c),f=ii.util.getTypedArrayFromDType("float32",l),d=ii.util.getTypedArrayFromDType("float32",l),h=0;h<a;h++){for(var p=jy({inputs:{x:u},backend:n,attrs:{begin:[h,0],size:[1,i]}}),v=jy({inputs:{x:s},backend:n,attrs:{begin:[h,0],size:[1,i]}}),m=Bg({inputs:{real:p,imag:v},backend:n}),g=cx(m,t,n),y=g.real,b=g.imag,x=ii.backend_util.mergeRealAndImagArrays(y,b),w=0;w<i;w++){var k=ii.backend_util.getComplexWithIndex(x,w);f[h*i+w]=k.real,d[h*i+w]=k.imag}n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(v),n.disposeIntermediateTensorInfo(m)}var _=n.makeTensorInfo(c,"float32",f),S=n.makeTensorInfo(c,"float32",d),C=Bg({inputs:{real:_,imag:S},backend:n});return n.disposeIntermediateTensorInfo(_),n.disposeIntermediateTensorInfo(S),C}function cx(e,t,n){var r=ii.util.sizeFromShape(e.shape),a=n.data.get(e.dataId),i=n.data.get(a.complexTensorInfos.real.dataId).values,o=n.data.get(a.complexTensorInfos.imag.dataId).values;if(function(e){return 0===(e&e-1)}(r)){var u=lx(i,o,r,t,n),s=[e.shape[0],e.shape[1]];if(t){var c=n.makeTensorInfo(s,"float32",u.real),l=n.makeTensorInfo(s,"float32",u.imag),f=n.makeTensorInfo([],"float32",ii.util.createScalarValue(r,"float32")),d=wg({inputs:{x:f},backend:n}),h=rx.kernelFunc({inputs:{a:c,b:f},backend:n}),p=rx.kernelFunc({inputs:{a:l,b:d},backend:n}),v=n.data.get(h.dataId).values,m=n.data.get(p.dataId).values;return n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(l),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(p),{real:v,imag:m}}return u}var g=function(e,t,n){for(var r=new Float32Array(2*t),a=0;a<t;a++){for(var i=0,o=0,u=0;u<t;u++){var s=ii.backend_util.exponent(a*u,t,n),c=ii.backend_util.getComplexWithIndex(e,u);i+=c.real*s.real-c.imag*s.imag,o+=c.real*s.imag+c.imag*s.real}n&&(i/=t,o/=t),ii.backend_util.assignToTypedArray(r,i,o,a)}return r}(ii.backend_util.mergeRealAndImagArrays(i,o),r,t);return ii.backend_util.splitRealAndImagArrays(g)}function lx(e,t,n,r,a){if(1===n)return{real:e,imag:t};var i=ii.backend_util.mergeRealAndImagArrays(e,t),o=n/2,u=ii.backend_util.complexWithEvenIndex(i),s=u.real,c=u.imag,l=[s.length],f=a.makeTensorInfo(l,"float32",s),d=a.makeTensorInfo(l,"float32",c),h=Bg({inputs:{real:f,imag:d},backend:a}),p=ii.backend_util.complexWithOddIndex(i),v=p.real,m=p.imag,g=[v.length],y=a.makeTensorInfo(g,"float32",v),b=a.makeTensorInfo(g,"float32",m),x=Bg({inputs:{real:y,imag:b},backend:a}),w=lx(s,c,o,r,a),k=w.real,_=w.imag,S=[k.length],C=a.makeTensorInfo(S,"float32",k),A=a.makeTensorInfo(S,"float32",_),E=Bg({inputs:{real:C,imag:A},backend:a}),N=lx(v,m,o,r,a),T=N.real,I=N.imag,D=[T.length],F=a.makeTensorInfo(D,"float32",T),M=a.makeTensorInfo(D,"float32",I),O=Bg({inputs:{real:F,imag:M},backend:a}),R=ii.backend_util.exponents(n,r),j=[R.real.length],B=a.makeTensorInfo(j,"float32",R.real),z=a.makeTensorInfo(j,"float32",R.imag),Z=Bg({inputs:{real:B,imag:z},backend:a}),L=Ib({inputs:{a:Z,b:O},backend:a}),P=Kg({inputs:{a:E,b:L},backend:a}),U=ox({inputs:{a:E,b:L},backend:a}),W=Lg({inputs:{input:P},backend:a}),V=Lg({inputs:{input:U},backend:a}),q=Jy({inputs:{input:P},backend:a}),G=Jy({inputs:{input:U},backend:a}),H=tb({inputs:[W,V],backend:a,attrs:{axis:0}}),X=tb({inputs:[q,G],backend:a,attrs:{axis:0}}),K=a.data.get(H.dataId).values,Y=a.data.get(X.dataId).values;return a.disposeIntermediateTensorInfo(f),a.disposeIntermediateTensorInfo(d),a.disposeIntermediateTensorInfo(h),a.disposeIntermediateTensorInfo(y),a.disposeIntermediateTensorInfo(b),a.disposeIntermediateTensorInfo(x),a.disposeIntermediateTensorInfo(C),a.disposeIntermediateTensorInfo(A),a.disposeIntermediateTensorInfo(E),a.disposeIntermediateTensorInfo(F),a.disposeIntermediateTensorInfo(M),a.disposeIntermediateTensorInfo(O),a.disposeIntermediateTensorInfo(B),a.disposeIntermediateTensorInfo(z),a.disposeIntermediateTensorInfo(Z),a.disposeIntermediateTensorInfo(L),a.disposeIntermediateTensorInfo(P),a.disposeIntermediateTensorInfo(U),a.disposeIntermediateTensorInfo(W),a.disposeIntermediateTensorInfo(q),a.disposeIntermediateTensorInfo(V),a.disposeIntermediateTensorInfo(G),a.disposeIntermediateTensorInfo(H),a.disposeIntermediateTensorInfo(X),{real:K,imag:Y}}var fx={kernelName:ii.FFT,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.input,a=ii.util.sizeFromShape(r.shape),i=r.shape[r.shape.length-1],o=$g({inputs:{x:r},backend:n,attrs:{shape:[a/i,i]}}),u=sx(o,!1,n),s=$g({inputs:{x:u},backend:n,attrs:{shape:r.shape}});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(u),s}};function dx(e){var t=e.backend,n=e.attrs,r=n.shape,a=n.value,i=n.dtype||ii.util.inferDtype(a),o=ii.util.getArrayFromDType(i,ii.util.sizeFromShape(r));return function(e,t,n){e.fill(t)}(o,a),t.makeTensorInfo(r,i,o)}var hx={kernelName:ii.Fill,backendName:"cpu",kernelFunc:dx};var px={kernelName:ii.FlipLeftRight,backendName:"cpu",kernelFunc:function(e){for(var t=e.inputs,n=(e.attrs,e.backend),r=t.image,a=n,i=ii.util.getTypedArrayFromDType(r.dtype,ii.util.sizeFromShape(r.shape)),o=(0,C.Z)(r.shape,4),u=o[0],s=o[1],c=o[2],l=o[3],f=a.data.get(r.dataId).values,d=0;d<u;d++)for(var h=d*c*s*l,p=0;p<s;p++)for(var v=p*(c*l),m=0;m<c;m++)for(var g=m*l,y=0;y<l;y++){var b=Math.round(c-m-1),x=h+v+g+y,w=f[x];if(b>=0&&b<c)w=f[h+v+b*l+y];i[x]=w}return{dataId:a.write(i,r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}},vx=mg((function(e){return Math.floor(e)})),mx=yg(ii.Floor,vx),gx={kernelName:ii.Floor,backendName:"cpu",kernelFunc:mx},yx=Cg((function(e,t){return Math.floor(e/t)})),bx=qg(ii.FloorDiv,yx,null,"int32"),xx={kernelName:ii.FloorDiv,backendName:"cpu",kernelFunc:bx};var wx={kernelName:ii.FusedConv2D,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.filter,o=t.bias,u=t.preluActivationWeights,s=r.strides,c=r.pad,l=r.dataFormat,f=r.dilations,d=r.dimRoundingMode,h=r.activation,p=r.leakyreluAlpha,v=rb({inputs:{x:a,filter:i},backend:n,attrs:{strides:s,pad:c,dataFormat:l,dilations:f,dimRoundingMode:d}});if(o){var m=v;if("NCHW"===l&&1===o.shape.length&&1!==o.shape[0]){var g=$g({inputs:{x:o},backend:n,attrs:{shape:[o.shape[0],1,1]}});v=Kg({inputs:{a:v,b:g},backend:n}),n.disposeIntermediateTensorInfo(g)}else v=Kg({inputs:{a:v,b:o},backend:n});n.disposeIntermediateTensorInfo(m)}if(h){var y=v;if("NCHW"===l&&"prelu"===h&&1===u.shape.length&&1!==u.shape[0]){var b=$g({inputs:{x:u},backend:n,attrs:{shape:[u.shape[0],1,1]}});v=jg(n,v,h,b,p),n.disposeIntermediateTensorInfo(b)}else v=jg(n,v,h,u,p);n.disposeIntermediateTensorInfo(y)}return v}};var kx={kernelName:ii.FusedDepthwiseConv2D,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.filter,o=t.bias,u=t.preluActivationWeights,s=r.strides,c=r.pad,l=r.dataFormat,f=r.dilations,d=r.dimRoundingMode,h=r.activation,p=r.leakyreluAlpha,v=bb({inputs:{x:a,filter:i},backend:n,attrs:{strides:s,pad:c,dataFormat:l,dilations:f,dimRoundingMode:d}});if(o){var m=v;v=Kg({inputs:{a:v,b:o},backend:n}),n.disposeIntermediateTensorInfo(m)}if(h){var g=v;v=jg(n,v,h,u,p),n.disposeIntermediateTensorInfo(g)}return v}};function _x(e,t,n,r,a,i,o,u,s){for(var c=(0,ii.buffer)([r,i],n),l=0;l<r;l++){for(var f=[],d=0,h=0;h<a;h++){var p=e[l*a+h];d+=p*o[h],f.push(p)}if(d<0||d>=s/i)throw new Error("Invalid indices: ".concat(f," does not index into ").concat(u));for(var v=0;v<i;v++)c.values[l*i+v]=t.get.apply(t,(0,I.Z)(t.indexToLoc(d*i+v)))}return c}var Sx={kernelName:ii.GatherNd,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.params,a=t.indices,i=ii.util.sizeFromShape(r.shape),o=a.shape,u=o[o.length-1],s=ii.backend_util.prepareAndValidate(r,a),c=(0,C.Z)(s,4),l=c[0],f=c[1],d=c[2],h=c[3];if(0===f)return n.makeTensorInfo(l,r.dtype,[]);var p=_x(n.data.get(a.dataId).values,n.bufferSync(r),r.dtype,f,u,d,h,r.shape,i);return n.makeTensorInfo(l,r.dtype,p.values)}};function Cx(e,t,n){for(var r=(0,ii.buffer)(n,e.dtype),a=0;a<r.size;++a){var i=r.indexToLoc(a).slice(),o=i[0],u=i[2],s=t.locToIndex([o,u]);i[2]=t.values[s];var c=e.locToIndex(i);0<=c&&c<e.values.length&&(r.values[a]=e.values[c])}return r}var Ax={kernelName:ii.GatherV2,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.indices,o=r.axis,u=r.batchDims;hg([a,i],"gatherV2");for(var s=ii.util.parseAxisParam(o,a.shape)[0],c=n.data.get(i.dataId).values,l=a.shape[s],f=function(e){var t=c[e];ii.util.assert(t<=l-1&&t>=0,(function(){return"GatherV2: the index value ".concat(t," is not in [0, ").concat(l-1,"]")}))},d=0;d<c.length;++d)f(d);var h=u;null==u&&(h=0);var p=ii.util.sizeFromShape(i.shape),v=ii.backend_util.segment_util.collectGatherOpShapeInfo(a,i,s,h),m=$g({inputs:{x:a},backend:n,attrs:{shape:[v.batchSize,v.outerSize,v.dimSize,v.sliceSize]}}),g=$g({inputs:{x:i},backend:n,attrs:{shape:[v.batchSize,p/v.batchSize]}}),y=[v.batchSize,v.outerSize,p/v.batchSize,v.sliceSize],b=n.bufferSync(g),x=Cx(n.bufferSync(m),b,y);return n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(g),n.makeTensorInfo(v.outputShape,x.dtype,x.values)}},Ex=Cg((function(e,t){return e>t?1:0})),Nx=qg(ii.Greater,Ex,null,"bool"),Tx={kernelName:ii.Greater,backendName:"cpu",kernelFunc:Nx},Ix=Cg((function(e,t){return e>=t?1:0})),Dx=qg(ii.GreaterEqual,Ix,null,"bool"),Fx={kernelName:ii.GreaterEqual,backendName:"cpu",kernelFunc:Dx};var Mx={kernelName:ii.IFFT,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.input,a=ii.util.sizeFromShape(r.shape),i=r.shape[r.shape.length-1],o=$g({inputs:{x:r},backend:n,attrs:{shape:[a/i,i]}}),u=sx(o,!0,n),s=$g({inputs:{x:u},backend:n,attrs:{shape:r.shape}});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(u),s}},Ox=gg(ii.IsFinite,(function(e){return Number.isFinite(e)?1:0}),"bool"),Rx={kernelName:ii.IsFinite,backendName:"cpu",kernelFunc:Ox},jx=gg(ii.IsInf,(function(e){return Math.abs(e)===1/0?1:0}),"bool"),Bx={kernelName:ii.IsInf,backendName:"cpu",kernelFunc:jx},zx=gg(ii.IsNan,(function(e){return Number.isNaN(e)?1:0}),"bool"),Zx={kernelName:ii.IsNan,backendName:"cpu",kernelFunc:zx},Lx=Cg((function(e,t){return e<t?1:0})),Px=qg(ii.Less,Lx,null,"bool"),Ux={kernelName:ii.Less,backendName:"cpu",kernelFunc:Px},Wx=Cg((function(e,t){return e<=t?1:0})),Vx=qg(ii.LessEqual,Wx,null,"bool"),qx={kernelName:ii.LessEqual,backendName:"cpu",kernelFunc:Vx};function Gx(e,t,n){var r=(t-e)/(n-1),a=ii.util.makeZerosTypedArray(n,"float32");a[0]=e;for(var i=1;i<a.length;i++)a[i]=a[i-1]+r;return a}var Hx={kernelName:ii.LinSpace,backendName:"cpu",kernelFunc:function(e){var t=e.backend,n=e.attrs,r=Gx(n.start,n.stop,n.num);return t.makeTensorInfo([r.length],"float32",r)}},Xx=mg((function(e){return Math.log(e)})),Kx=yg(ii.Log,Xx),Yx={kernelName:ii.Log,backendName:"cpu",kernelFunc:Kx},$x=gg(ii.Log1p,(function(e){return Math.log1p(e)})),Qx={kernelName:ii.Log1p,backendName:"cpu",kernelFunc:$x},Jx=Cg((function(e,t){return e&&t})),ew=qg(ii.LogicalAnd,Jx,null,"bool"),tw={kernelName:ii.LogicalAnd,backendName:"cpu",kernelFunc:ew},nw=gg(ii.LogicalNot,(function(e){return e?0:1}),"bool"),rw={kernelName:ii.LogicalNot,backendName:"cpu",kernelFunc:nw},aw=Cg((function(e,t){return e||t})),iw=qg(ii.LogicalOr,aw,null,"bool"),ow={kernelName:ii.LogicalOr,backendName:"cpu",kernelFunc:iw};var uw={kernelName:ii.LRN,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.depthRadius,o=r.bias,u=r.alpha,s=r.beta;hg(a,"LRN");var c=a.shape[3],l=c-1,f=n.data.get(a.dataId).values,d=ii.util.sizeFromShape(a.shape),h=new Float32Array(d);function p(e){for(var t=e%c,n=e-t+Math.max(0,t-i),r=e-t+Math.min(t+i,l),a=0;n<=r;n++){var o=f[n];a+=o*o}return a}for(var v=0;v<d;v++){var m=p(v),g=f[v]*Math.pow(o+u*m,-s);h[v]=g}return n.makeTensorInfo(a.shape,a.dtype,h)}};var sw={kernelName:ii.LRNGrad,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.y,o=t.dy,u=r.depthRadius,s=r.bias,c=r.alpha,l=r.beta;hg(o,"LRNGrad");for(var f=ii.util.sizeFromShape(o.shape),d=o.shape[3],h=n.data.get(o.dataId).values,p=n.data.get(a.dataId).values,v=n.data.get(i.dataId).values,m=new Float32Array(f),g=f,y=0;y<g;y++){for(var b=y%d,x=y-b+Math.max(0,b-u),w=y-b+Math.min(d,b+u+1),k=0,_=x;_<w;_++)k+=Math.pow(p[_],2);k=c*k+s;for(var S=x;S<w;S++){var C=-2*c*l*p[S]*v[y]/k;y===S&&(C+=Math.pow(k,-l)),C*=h[y],m[S]+=C}}return n.makeTensorInfo(o.shape,a.dtype,m)}};function cw(e,t,n,r){for(var a=ii.util.getTypedArrayFromDType(r,ii.util.sizeFromShape(n)),i=0;i<a.length;++i){for(var o=i*t,u=e[o],s=0;s<t;++s){var c=e[o+s];(Number.isNaN(c)||c>u)&&(u=c)}a[i]=u}return a}function lw(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.reductionIndices,o=r.keepDims,u=n,s=a.shape,c=s.length,l=ii.util.parseAxisParam(i,s),f=l,d=ii.backend_util.getAxesPermutation(f,c),h=u.data.get(a.dataId).values;if(null!=d){for(var p=new Array(c),v=0;v<p.length;v++)p[v]=s[d[v]];h=cy(h,s,a.dtype,d,p),f=ii.backend_util.getInnerMostAxes(f.length,c),s=p}hg(a,"max"),ii.backend_util.assertAxesAreInnerMostDims("max",f,c);var m=ii.backend_util.computeOutAndReduceShapes(s,f),g=(0,C.Z)(m,2),y=g[0],b=g[1],x=cw(h,ii.util.sizeFromShape(b),y,a.dtype),w=u.write(x,y,a.dtype),k=y;o&&(k=p=ii.backend_util.expandShapeToKeepDim(y,l));return{dataId:w,shape:k,dtype:a.dtype}}var fw={kernelName:ii.Max,backendName:"cpu",kernelFunc:lw},dw=Cg((function(e,t){return Math.max(e,t)})),hw=qg(ii.Maximum,dw),pw={kernelName:ii.Maximum,backendName:"cpu",kernelFunc:hw};var vw={kernelName:ii.MaxPool,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x;hg(a,"maxPool");var i=r.filterSize,o=r.strides,u=r.pad,s=r.dimRoundingMode;ii.util.assert(ii.backend_util.eitherStridesOrDilationsAreOne(o,1),(function(){return"Error in maxPool: Either strides or dilations must be 1. "+"Got strides ".concat(o," and dilations '").concat(1,"'")}));var c,l=ii.backend_util.computePool2DInfo(a.shape,i,o,1,u,s);if(1===l.filterWidth&&1===l.filterHeight&&ii.util.arraysEqual(l.inShape,l.outShape))c=wg({inputs:{x:a},backend:n});else{var f=n.data.get(a.dataId).values,d=ii.util.computeStrides(a.shape),h=Ey(f,a.shape,a.dtype,d,l,"max");c=n.makeTensorInfo(l.outShape,a.dtype,h.values)}return c}};var mw={kernelName:ii.MaxPool3D,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.filterSize,o=r.strides,u=r.pad,s=r.dimRoundingMode,c=r.dataFormat;hg(a,"maxPool3d");var l=ii.backend_util.computePool3DInfo(a.shape,i,o,1,u,s,c),f=Ty(n.data.get(a.dataId).values,a.shape,a.dtype,ii.util.computeStrides(a.shape),l,"max");return n.makeTensorInfo(f.shape,"float32",f.values)}};var gw={kernelName:ii.MaxPool3DGrad,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.dy,i=t.input,o=r.filterSize,u=r.strides,s=r.pad,c=r.dimRoundingMode;hg([a,i],"maxPool3DGrad");for(var l=ii.backend_util.computePool3DInfo(i.shape,o,u,1,s,c),f=function(e,t){for(var n=(0,ii.buffer)(t.outShape,"int32"),r=t.strideDepth,a=t.strideHeight,i=t.strideWidth,o=t.dilationDepth,u=t.dilationHeight,s=t.dilationWidth,c=t.effectiveFilterDepth,l=t.effectiveFilterHeight,f=t.effectiveFilterWidth,d=t.padInfo.front,h=t.padInfo.top,p=t.padInfo.left,v=0;v<t.batchSize;++v)for(var m=0;m<t.inChannels;++m)for(var g=0;g<t.outDepth;++g){for(var y=g*r-d,b=y;b<0;)b+=o;for(var x=Math.min(t.inDepth,c+y),w=0;w<t.outHeight;++w){for(var k=w*a-h,_=k;_<0;)_+=u;for(var S=Math.min(t.inHeight,l+k),C=0;C<t.outWidth;++C){for(var A=C*i-p,E=A;E<0;)E+=s;for(var N=Math.min(t.inWidth,f+A),T=Number.NEGATIVE_INFINITY,I=-1,D=b;D<x;D+=o)for(var F=D-y,M=_;M<S;M+=u)for(var O=M-k,R=E;R<N;R+=s){var j=R-A,B=e.get(v,D,M,R,m);B>=T&&(T=B,I=F*l*f+O*l+j)}n.set(I,v,g,w,C,m)}}}return n}(n.bufferSync(i),l),d=l.strideDepth,h=l.strideHeight,p=l.strideWidth,v=l.dilationDepth,m=l.dilationHeight,g=l.dilationWidth,y=l.effectiveFilterDepth,b=l.effectiveFilterHeight,x=l.effectiveFilterWidth,w=y-1-l.padInfo.front,k=x-1-l.padInfo.left,_=b-1-l.padInfo.top,S=(0,ii.buffer)(i.shape,"float32"),C=n.bufferSync(a),A=0;A<l.batchSize;++A)for(var E=0;E<l.inChannels;++E)for(var N=0;N<l.inDepth;++N)for(var T=0;T<l.inHeight;++T)for(var I=0;I<l.inWidth;++I){for(var D=N-w,F=T-_,M=I-k,O=0,R=0;R<y;R+=v){var j=(D+R)/d;if(!(j<0||j>=l.outDepth||Math.floor(j)!==j))for(var B=0;B<b;B+=m){var z=(F+B)/h;if(!(z<0||z>=l.outHeight||Math.floor(z)!==z))for(var Z=0;Z<x;Z+=g){var L=(M+Z)/p;if(!(L<0||L>=l.outWidth||Math.floor(L)!==L)){var P=y*b*x-1-f.get(A,j,z,L,E)===R*b*x+B*x+Z?1:0;if(0!==P)O+=C.get(A,j,z,L,E)*P}}}}S.set(O,A,N,T,I,E)}return n.makeTensorInfo(S.shape,S.dtype,S.values)}};var yw={kernelName:ii.MaxPoolGrad,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.dy,i=t.input,o=i;hg([i,t.output],"maxPoolGrad");for(var u=r.filterSize,s=r.strides,c=r.pad,l=r.dimRoundingMode,f=ii.backend_util.computePool2DInfo(o.shape,u,s,1,c,l),d=n.data.get(o.dataId).values,h=(0,ii.buffer)(f.outShape,o.dtype,Ny(d,o.shape,o.dtype,f).values),p=f.strideHeight,v=f.strideWidth,m=f.dilationHeight,g=f.dilationWidth,y=f.effectiveFilterHeight,b=f.effectiveFilterWidth,x=b-1-f.padInfo.left,w=y-1-f.padInfo.top,k=(0,ii.buffer)(o.shape,"float32"),_=n.data.get(a.dataId).values,S=(0,ii.buffer)(a.shape,"float32",_),C=0;C<f.batchSize;++C)for(var A=0;A<f.inChannels;++A)for(var E=0;E<f.inHeight;++E)for(var N=0;N<f.inWidth;++N){for(var T=E-w,I=N-x,D=0,F=0;F<y;F+=m){var M=(T+F)/p;if(!(M<0||M>=f.outHeight||Math.floor(M)!==M))for(var O=0;O<b;O+=g){var R=(I+O)/v;if(!(R<0||R>=f.outWidth||Math.floor(R)!==R)){var j=y*b-1-h.get(C,M,R,A)===F*b+O?1:0;if(0!==j)D+=S.get(C,M,R,A)*j}}}k.set(D,C,E,N,A)}return n.makeTensorInfo(k.shape,k.dtype,k.values)}};var bw={kernelName:ii.MaxPoolWithArgmax,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.attrs,r=e.backend,a=t.x,i=n.filterSize,o=n.strides,u=n.pad,s=n.includeBatchInIndex,c=r;hg(a,"MaxPoolWithArgmax");var l=c.data.get(a.dataId).values,f=ii.backend_util.computePool2DInfo(a.shape,i,o,[1,1],u),d=function(e,t,n,r,a){var i=Ey(e,0,n,ii.util.computeStrides(t),a,"max"),o=Ny(e,t,n,a,!0,r);return[i.values,o.values]}(l,a.shape,a.dtype,s,f),h=(0,C.Z)(d,2),p=h[0],v=h[1],m=c.write(p,f.outShape,a.dtype),g=c.write(v,f.outShape,a.dtype);return[{dataId:m,shape:f.outShape,dtype:a.dtype},{dataId:g,shape:f.outShape,dtype:"int32"}]}};var xw={kernelName:ii.Mean,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.axis,o=r.keepDims,u=ii.util.parseAxisParam(i,a.shape),s=ii.backend_util.computeOutAndReduceShapes(a.shape,u)[1],c=ii.util.sizeFromShape(s),l=[],f=n.makeTensorInfo([],"float32",new Float32Array([c]));l.push(f);var d=Wg({inputs:{x:a},backend:n,attrs:{dtype:"float32"}});l.push(d);var h=nx({inputs:{a:d,b:f},backend:n});l.push(h);var p=Fb({inputs:{x:h},backend:n,attrs:{axis:i,keepDims:o}});return l.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),p}};var ww={kernelName:ii.Min,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.axis,o=r.keepDims;hg(a,"min");var u=ii.util.parseAxisParam(i,a.shape),s=u,c=ii.backend_util.getAxesPermutation(s,a.shape.length),l=a;null!=c&&(l=ly({inputs:{x:a},backend:n,attrs:{perm:c}}),s=ii.backend_util.getInnerMostAxes(s.length,a.shape.length)),ii.backend_util.assertAxesAreInnerMostDims("min",s,l.shape.length);for(var f=ii.backend_util.computeOutAndReduceShapes(l.shape,s),d=(0,C.Z)(f,2),h=d[0],p=d[1],v=ii.util.sizeFromShape(p),m=ii.util.makeZerosTypedArray(ii.util.sizeFromShape(h),l.dtype),g=n.data.get(l.dataId).values,y=0;y<m.length;++y){for(var b=y*v,x=g[b],w=0;w<v;++w){var k=g[b+w];(Number.isNaN(k)||k<x)&&(x=k)}m[y]=x}null!=c&&n.disposeIntermediateTensorInfo(l);var _=n.makeTensorInfo(h,l.dtype,m);if(o){var S=$g({inputs:{x:_},backend:n,attrs:{shape:ii.backend_util.expandShapeToKeepDim(h,u)}});return n.disposeIntermediateTensorInfo(_),S}return _}},kw=Cg((function(e,t){return Math.min(e,t)})),_w=qg(ii.Minimum,kw),Sw={kernelName:ii.Minimum,backendName:"cpu",kernelFunc:_w};var Cw={kernelName:ii.MirrorPad,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.paddings,o=r.mode;hg(a,"mirrorPad");for(var u=i.map((function(e,t){return e[0]+a.shape[t]+e[1]})),s=i.map((function(e){return e[0]})),c=i.map((function(e,t){return e[0]+a.shape[t]})),l="reflect"===o?0:1,f=n.data.get(a.dataId).values,d=a.shape.length,h=ii.util.computeStrides(a.shape),p=ii.util.sizeFromShape(u),v=u.length,m=ii.util.computeStrides(u),g=ii.util.getTypedArrayFromDType(a.dtype,p),y=0;y<p;y++){for(var b=ii.util.indexToLoc(y,v,m),x=0;x<v;x++)b[x]<s[x]?b[x]=2*s[x]-b[x]-l:b[x]>=c[x]&&(b[x]=2*(c[x]-1)-b[x]+l);b=b.map((function(e,t){return e-s[t]}));var w=ii.util.locToIndex(b,d,h);g[y]=f[w]}return{dataId:n.write(g,u,a.dtype),shape:u,dtype:a.dtype}}},Aw=Cg((function(e,t){var n=e%t;return e<0&&t<0||e>=0&&t>=0?n:(n+t)%t})),Ew=qg(ii.Mod,Aw),Nw={kernelName:ii.Mod,backendName:"cpu",kernelFunc:Ew};function Tw(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.logits,i=r.dim,o=a.shape.length,u=i;if(-1===u&&(u=o-1),u!==o-1)throw Error("Softmax along a non-last dimension is not yet supported. "+"Logits was rank ".concat(o," and dim was ").concat(u));var s=ii.util.parseAxisParam([u],a.shape),c=lw({inputs:{x:a},backend:n,attrs:{reductionIndices:s,keepDims:!1}}),l=ii.backend_util.expandShapeToKeepDim(c.shape,s),f=$g({inputs:{x:c},backend:n,attrs:{shape:l}}),d=ox({inputs:{a:a,b:f},backend:n}),h=Xb({inputs:{x:d},backend:n}),p=Fb({inputs:{x:h},backend:n,attrs:{axis:s,keepDims:!1}}),v=$g({inputs:{x:p},backend:n,attrs:{shape:l}}),m=nx({inputs:{a:h,b:v},backend:n});return n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(v),m}var Iw={kernelName:ii.Softmax,backendName:"cpu",kernelFunc:Tw};var Dw={kernelName:ii.Multinomial,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.logits,i=r.numSamples,o=r.seed,u=r.normalized;hg(a,"multinomial");for(var s=u?a:Tw({inputs:{logits:a},backend:n,attrs:{dim:-1}}),c=s.shape[0],l=s.shape[1],f=n.data.get(s.dataId).values,d=[c,i],h=ii.util.makeZerosTypedArray(ii.util.sizeFromShape(d),"int32"),p=0;p<c;++p){var v=p*l,m=new Float32Array(l-1);m[0]=f[v];for(var g=1;g<m.length;++g)m[g]=m[g-1]+f[v+g];for(var y=Rm.alea(o.toString()),b=p*i,x=0;x<i;++x){var w=y();h[b+x]=m.length;for(var k=0;k<m.length;k++)if(w<m[k]){h[b+x]=k;break}}}return u||n.disposeIntermediateTensorInfo(s),n.makeTensorInfo(d,"int32",h)}};function Fw(e,t,n){var r=ii.util.createScalarValue(-1,n);return Nb([],t,r,e,n)}var Mw={kernelName:ii.Neg,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.x;hg(r,"neg");var a=Fw(n.data.get(r.dataId).values,r.shape,r.dtype),i=(0,C.Z)(a,2),o=i[0],u=i[1];return n.makeTensorInfo(u,r.dtype,o)}},Ow=ii.kernel_impls.nonMaxSuppressionV3Impl;var Rw={kernelName:ii.NonMaxSuppressionV3,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.boxes,i=t.scores,o=r.maxOutputSize,u=r.iouThreshold,s=r.scoreThreshold;hg(a,"NonMaxSuppression");var c=n.data.get(a.dataId).values,l=n.data.get(i.dataId).values,f=Ow(c,l,o,u,s).selectedIndices;return n.makeTensorInfo([f.length],"int32",new Int32Array(f))}},jw=ii.kernel_impls.nonMaxSuppressionV4Impl;var Bw={kernelName:ii.NonMaxSuppressionV4,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.boxes,i=t.scores,o=r.maxOutputSize,u=r.iouThreshold,s=r.scoreThreshold,c=r.padToMaxOutputSize;hg(a,"NonMaxSuppressionPadded");var l=n.data.get(a.dataId).values,f=n.data.get(i.dataId).values,d=jw(l,f,o,u,s,c),h=d.selectedIndices,p=d.validOutputs;return[n.makeTensorInfo([h.length],"int32",new Int32Array(h)),n.makeTensorInfo([],"int32",new Int32Array([p]))]}},zw=ii.kernel_impls.nonMaxSuppressionV5Impl;var Zw={kernelName:ii.NonMaxSuppressionV5,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.boxes,i=t.scores,o=r.maxOutputSize,u=r.iouThreshold,s=r.scoreThreshold,c=r.softNmsSigma;hg(a,"NonMaxSuppressionWithScore");var l=n.data.get(a.dataId).values,f=n.data.get(i.dataId).values,d=zw(l,f,o,u,s,c),h=d.selectedIndices,p=d.selectedScores;return[n.makeTensorInfo([h.length],"int32",new Int32Array(h)),n.makeTensorInfo([p.length],"float32",new Float32Array(p))]}},Lw=Cg((function(e,t){return e!==t?1:0})),Pw=qg(ii.NotEqual,Lw,null,"bool"),Uw={kernelName:ii.NotEqual,backendName:"cpu",kernelFunc:Pw};var Ww={kernelName:ii.OneHot,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.indices,i=r.dtype,o=r.depth,u=r.onValue,s=r.offValue;hg(a,"oneHot");var c=ii.util.sizeFromShape(a.shape),l=new Float32Array(c*o);l.fill(s);for(var f=n.data.get(a.dataId).values,d=0;d<c;++d)f[d]>=0&&f[d]<o&&(l[d*o+f[d]]=u);return n.makeTensorInfo([].concat((0,I.Z)(a.shape),[o]),i,l)}};function Vw(e){var t=e.inputs,n=e.backend,r=t.x;if("string"===r.dtype)throw new Error("zerosLike is not supported for string tensors");if("complex64"===r.dtype){var a=Lg({inputs:{input:r},backend:n}),i=Vw({inputs:{x:a},backend:n}),o=Jy({inputs:{input:r},backend:n}),u=Vw({inputs:{x:o},backend:n}),s=Bg({inputs:{real:i,imag:u},backend:n});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(u),s}return dx({backend:n,attrs:{shape:r.shape,value:0,dtype:r.dtype}})}var qw={kernelName:ii.ZerosLike,backendName:"cpu",kernelFunc:Vw};var Gw={kernelName:ii.OnesLike,backendName:"cpu",kernelFunc:function e(t){var n=t.inputs,r=t.backend,a=n.x;if("string"===a.dtype)throw new Error("onesLike is not supported for string tensors");if("complex64"===a.dtype){var i=Lg({inputs:{input:a},backend:r}),o=e({inputs:{x:i},backend:r}),u=Jy({inputs:{input:a},backend:r}),s=Vw({inputs:{x:u},backend:r}),c=Bg({inputs:{real:o,imag:s},backend:r});return r.disposeIntermediateTensorInfo(i),r.disposeIntermediateTensorInfo(o),r.disposeIntermediateTensorInfo(u),r.disposeIntermediateTensorInfo(s),c}return dx({backend:r,attrs:{shape:a.shape,value:1,dtype:a.dtype}})}};function Hw(e){var t=e.inputs,n=e.backend,r=e.attrs.axis;if(1===t.length)return Yb({inputs:{input:t[0]},backend:n,attrs:{dim:r}});var a=t[0].shape,i=t[0].dtype;t.forEach((function(e){ii.util.assertShapesMatch(a,e.shape,"All tensors passed to stack must have matching shapes"),ii.util.assert(i===e.dtype,(function(){return"All tensors passed to stack must have matching dtypes"}))}));var o=[],u=tb({inputs:t.map((function(e){var t=Yb({inputs:{input:e},backend:n,attrs:{dim:r}});return o.push(t),t})),backend:n,attrs:{axis:r}});return o.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),u}var Xw={kernelName:ii.Pack,backendName:"cpu",kernelFunc:Hw};var Kw={kernelName:ii.PadV2,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.paddings,o=r.constantValue;hg(a,"pad");var u=i.map((function(e,t){return e[0]+a.shape[t]+e[1]})),s=i.map((function(e){return e[0]})),c=n.data.get(a.dataId).values,l=ii.util.sizeFromShape(a.shape),f=a.shape.length,d=ii.util.computeStrides(a.shape),h=ii.util.sizeFromShape(u),p=u.length,v=ii.util.computeStrides(u),m=ii.util.getTypedArrayFromDType(a.dtype,h);0!==o&&m.fill(o);for(var g=0;g<l;g++){var y=ii.util.indexToLoc(g,f,d).map((function(e,t){return e+s[t]}));m[ii.util.locToIndex(y,p,v)]=c[g]}return{dataId:n.write(m,u,a.dtype),shape:u,dtype:a.dtype}}},Yw=Cg((function(e,t){return Math.pow(e,t)})),$w=qg(ii.Pow,Yw),Qw={kernelName:ii.Pow,backendName:"cpu",kernelFunc:$w};function Jw(e,t,n,r){for(var a=ii.backend_util.computeOutAndReduceShapes(e,r),i=(0,C.Z)(a,2),o=i[0],u=i[1],s=(0,ii.upcastType)(t,"int32"),c=ii.util.makeZerosTypedArray(ii.util.sizeFromShape(o),s),l=ii.util.sizeFromShape(u),f=0;f<c.length;++f){for(var d=f*l,h=1,p=0;p<l;++p)h*=n[d+p];c[f]=h}return{outVals:c,outShape:o,outDtype:s}}var ek={kernelName:ii.Prod,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.axis,o=r.keepDims;hg(a,"prod");var u=a.shape.length,s=ii.util.parseAxisParam(i,a.shape),c=ii.backend_util.getAxesPermutation(s,u),l=s,f=a,d=[];null!=c&&(f=ly({inputs:{x:a},backend:n,attrs:{perm:c}}),d.push(f),l=ii.backend_util.getInnerMostAxes(l.length,u));var h=n.data.get(f.dataId).values,p=Jw(f.shape,f.dtype,h,l),v=p.outVals,m=p.outShape,g=p.outDtype,y=m;return o&&(y=ii.backend_util.expandShapeToKeepDim(m,s)),d.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),n.makeTensorInfo(y,g,v)}};function tk(e,t,n,r){var a=[],i=0,o=t.length-1+n.length,u=new Array(o).fill(null).map((function(){return[0]}));!function(e,t){for(var n=0;n<e.length;++n){var r=e[n],a=n===e.length-1?t:e[n+1].length;if(0===r.length)throw new Error("Ragged splits may not be empty");if(r[0]<0)throw new Error("Ragged splits must be non-negative");if(r[r.length-1]>a)throw new Error("Ragged splits must not point past values");for(var i=1;i<r.length;++i)if(r[i-1]>r[i])throw new Error("Ragged splits must be sorted in ascending order")}}(n,r);for(var s=1,c=0;c<t.length-1;++c){s*=t[c];for(var l=t[c+1],f=1;f<s+1;++f)u[c].push(f*l)}for(var d=0;d<e.length;++d){for(var h=e[d],p=e[d]+1,v=0;v<n.length;++v){var m=n[v],g=v+t.length-1;if(g>=0)for(var y=u[g],b=y[y.length-1]-m[h],x=h;x<p;++x)u[g].push(m[x+1]+b);h=m[h],p=m[p]}p!==h&&(a.push([h,p]),i+=p-h)}return{outSplits:u,valueSlices:a,numValues:i}}function nk(e,t){for(var n=e.slice(0,t);n.length<t;)n.push(1);for(var r=t;r<e.length;r++)n[t-1]*=e[r];return n}function rk(e,t,n,r,a){var i=t.slice();i[0]=a;var o=ii.util.getArrayFromDType(n,ii.util.sizeFromShape(i)),u=e.length;return function(e,t,n,r,a,i){var o,u=nk(t,2)[1],s=nk(i,2)[1],c=0,l=(0,B.Z)(n);try{for(l.s();!(o=l.n()).done;)for(var f=o.value,d=f[0];d<f[1];++d){for(var h=0;h<r;++h)a[c*s+h]=e[d*u+h];++c}}catch(p){l.e(p)}finally{l.f()}}(e,t,r,0===u?0:u/t[0],o,i),[o,i]}function ak(e,t,n,r,a,i,o,u){if(0===e.length)throw new Error("paramsNestedSplits must be non empty");if(0===t[0].length)throw new Error("Split tensors must not be scalars");if(function(e,t,n){e.forEach((function(e,r){if(e<0||e>=n){var a=ii.util.indexToLoc(r,t.length,ii.util.computeStrides(t)).join(",");throw new Error("indices[".concat(a,"] = ").concat(e," is not in [0, ").concat(n,")"))}}))}(i,o,t[0][0]-1),0===r.length)throw new Error("params.rank must be nonzero");var s=tk(i,o,e,r[0]),c=s.outSplits,l=s.valueSlices,f=s.numValues,d=function(e){for(var t=[],n=function(n){var r=e[n].length,a=ii.util.getArrayFromDType("int32",r);t.push(a),e[n].forEach((function(e,t){return a[t]=e}))},r=0;r<e.length;++r)n(r);return t}(c),h=rk(n,r,a,l,f);return[d,h[0],h[1]]}var ik={kernelName:ii.RaggedGather,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.paramsNestedSplits,i=t.paramsDenseValues,o=t.indices,u=(r.outputRaggedRank,a.map((function(e){return n.data.get(e.dataId).values}))),s=a.map((function(e){return e.shape})),c=n.data.get(i.dataId).values,l=n.data.get(o.dataId).values,f=ak(u,s,c,i.shape,i.dtype,l,o.shape),d=(0,C.Z)(f,3),h=d[0],p=d[1],v=d[2],m=h.map((function(e){return n.makeTensorInfo([e.length],"int32",e)})),g=n.makeTensorInfo(v,i.dtype,p);return m.concat([g])}},ok=2147483647;function uk(e,t,n,r,a,i,o){if(t.length>1)throw new Error("starts must be a scalar or vector");if(a.length>1)throw new Error("limits must be a scalar or vector");if(o.length>1)throw new Error("deltas must be a scalar or vector");var u=0===t.length,s=0===a.length,c=0===o.length,l=[];u||l.push(t[0]),s||l.push(a[0]),c||l.push(o[0]);for(var f=1;f<l.length;++f)if(l[f]!==l[f-1])throw new Error("starts, limits, and deltas must have the same shape");var d=0===l.length?1:l[0],h=ii.util.getArrayFromDType("int32",d+1);h[0]=0;for(var p=0;p<d;++p){var v=u?e[0]:e[p],m=s?r[0]:r[p],g=c?i[0]:i[p];if(0===g)throw new Error("Requires delta != 0");var y=void 0;if(g>0&&m<v||g<0&&m>v)y=0;else if((y=Math.ceil(Math.abs((m-v)/g)))>ok)throw new Error("Requires ((limit - start) / delta) <= ".concat(ok));h[p+1]=h[p]+y}for(var b=h[d],x=ii.util.getArrayFromDType(n,b),w=0,k=0;k<d;++k)for(var _=h[k+1]-h[k],S=u?e[0]:e[k],C=c?i[0]:i[k],A=0;A<_;++A)x[w++]=S,S+=C;return[h,x]}var sk={kernelName:ii.RaggedRange,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.starts,a=t.limits,i=t.deltas,o=n.data.get(r.dataId).values,u=n.data.get(a.dataId).values,s=n.data.get(i.dataId).values,c=uk(o,r.shape,r.dtype,u,a.shape,s,i.shape),l=(0,C.Z)(c,2),f=l[0],d=l[1];return[n.makeTensorInfo([f.length],"int32",f),n.makeTensorInfo([d.length],r.dtype,d)]}},ck=ii.backend_util.RowPartitionType,lk=function(){function e(t,n,r,a,i,o,u,s,c,l){(0,D.Z)(this,e),this.shape=t,this.shapeShape=n,this.values=r,this.valuesShape=a,this.valuesDType=i,this.defaultValue=o,this.defaultValueShape=u,this.rowPartitionValues=s,this.rowPartitionValuesShapes=c,this.rowPartitionTypes=ii.backend_util.getRowPartitionTypesHelper(l),this.raggedRank=ii.backend_util.getRaggedRank(this.rowPartitionTypes)}return(0,F.Z)(e,[{key:"getRowPartitionTypeByDimension",value:function(e){return this.rowPartitionTypes[0]===ck.FIRST_DIM_SIZE?this.rowPartitionTypes[e+1]:this.rowPartitionTypes[e]}},{key:"getRowPartitionTensor",value:function(e){return this.rowPartitionTypes[0]===ck.FIRST_DIM_SIZE?this.rowPartitionValues[e+1]:this.rowPartitionValues[e]}},{key:"getMaxWidth",value:function(t){var n=this.getRowPartitionTensor(t-1);switch(this.getRowPartitionTypeByDimension(t-1)){case ck.VALUE_ROWIDS:return e.getMaxWidthValueRowID(n);case ck.ROW_SPLITS:return e.getMaxWidthRowSplit(n);default:throw new Error("Cannot handle partition type ".concat(ck[this.getRowPartitionTypeByDimension(t-1)]))}}},{key:"tensorShapeFromTensor",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(0===t.length){if(-1===e[0])return[];throw new Error("The only valid scalar shape tensor is the fully unknown shape specified as -1.")}return dk(e,n)}},{key:"calculateOutputSize",value:function(e){var t=this.valuesShape,n=this.defaultValueShape;ii.backend_util.validateDefaultValueShape(n,t);var r=this.tensorShapeFromTensor(this.shape,this.shapeShape),a=ii.backend_util.combineRaggedTensorToTensorShapes(this.raggedRank,r,t);a[0]<0&&(a[0]=e);for(var i=1;i<=this.raggedRank;++i)a[i]<0&&(a[i]=this.getMaxWidth(i));return a}},{key:"calculateFirstParentOutputIndex",value:function(e,t,n){for(var r=Math.min(e,n),a=[],i=0,o=0;o<r;++o,i+=t)a.push(i);for(var u=r;u<e;++u)a.push(-1);return ii.util.assert(a.length===e,(function(){return"Final length of result must be equal to firstDimension."})),a}},{key:"calculateOutputIndexRowSplit",value:function(e,t,n,r){for(var a=e.length,i=[],o=0;o<a-1;++o){var u=e[o+1]-e[o],s=Math.min(r,u),c=t[o];-1===c&&(s=0);for(var l=0;l<s;++l)i.push(c),c+=n;for(var f=0;f<u-s;++f)i.push(-1)}if(a>0&&i.length!==e[a-1])throw new Error("Invalid row split size.");return i}},{key:"calculateOutputIndexValueRowID",value:function(e,t,n,r){var a=e.length,i=[];if(0===a)return[];var o=0,u=e[0];if(u>=t.length)throw new Error("Got currentValueRowId=".concat(u,", which is not less than ").concat(t.length));var s=t[u];i.push(s);for(var c=1;c<a;++c){var l=e[c];if(l===u)s>=0&&(++o<r?s+=n:s=-1);else{if(o=0,u=l,l>=t.length)throw new Error("Got nextValueRowId=".concat(l," which is not less than ").concat(t.length));s=t[l]}i.push(s)}if(i.length!==e.length)throw new Error("Invalid row ids.");return i}},{key:"calculateOutputIndex",value:function(e,t,n,r){var a=this.getRowPartitionTensor(e),i=this.getRowPartitionTypeByDimension(e);switch(i){case ck.VALUE_ROWIDS:return this.calculateOutputIndexValueRowID(a,t,n,r);case ck.ROW_SPLITS:if(a.length-1>t.length)throw new Error("Row partition size is greater than output size: ".concat(a.length-1," > ").concat(t.length));return this.calculateOutputIndexRowSplit(a,t,n,r);default:throw new Error("Unsupported partition type: ".concat(ck[i]))}}},{key:"getFirstDimensionSize",value:function(){var e=this.rowPartitionValues[0];if(0===this.rowPartitionTypes.length)throw new Error("No row_partition_types given.");var t=this.rowPartitionTypes[0];switch(t){case ck.FIRST_DIM_SIZE:return e[0];case ck.VALUE_ROWIDS:throw new Error("Cannot handle VALUE_ROWIDS in first dimension.");case ck.ROW_SPLITS:return this.rowPartitionValuesShapes[0][0]-1;default:throw new Error("Cannot handle type ".concat(ck[t]))}}},{key:"compute",value:function(){if(this.rowPartitionValues[0].length<=0)throw new Error("Invalid first partition input. Tensor requires at least one element.");var e=this.getFirstDimensionSize(),t=this.calculateOutputSize(e),n=new Array(this.raggedRank+1);n[n.length-1]=1;for(var r=n.length-2;r>=0;--r)n[r]=n[r+1]*t[r+1];var a=dk(t,!1),i=ii.util.getArrayFromDType(this.valuesDType,ii.util.sizeFromShape(a));if(n[0]*t[0]>0){for(var o=this.calculateFirstParentOutputIndex(e,n[0],t[0]),u=1;u<=this.raggedRank;++u){o=this.calculateOutputIndex(u-1,o,n[u],t[u])}this.setOutput(this.raggedRank,o,i,a)}return[a,i]}},{key:"setOutput",value:function(e,t,n,r){if(0!==n.length){var a=this.values,i=n,o=r.slice();o=o.slice(e+1);var u=ii.util.sizeFromShape(o),s=t.length,c=this.defaultValue;if(c.length!==u&&1!==c.length){var l=this.defaultValueShape;(0,ii.tidy)((function(){var e=(0,ii.reshape)(c,l),t=(0,ii.broadcastTo)(e,o);c=t.dataSync()}))}for(var f=0,d=0,h=0,p=0;p<=s;++p){var v=p<s?t[p]:-1;if(v!==h){if(d<h){var m=a.subarray(f*u);fk(i.subarray(d*u),m,(h-d)*u)}if(p>=s){var g=n.length;v=Math.floor(g/u)}if(v>h)if(1===this.defaultValue.length)i.subarray(h*u,v*u).fill(this.defaultValue[0]),h=v;else for(;v>h;){fk(i.slice(h*u),c,u),++h}v<0?(f=p+1,d=h):(f=p,h=(d=h)+1)}else++h}}}}],[{key:"getMaxWidthRowSplit",value:function(e){var t=e.length;if(0===t||1===t)return 0;for(var n=0,r=0;r<t-1;++r){var a=e[r+1]-e[r];a>n&&(n=a)}return n}},{key:"getMaxWidthValueRowID",value:function(e){var t=e.length;if(0===t)return 0;for(var n=0,r=e[0],a=0,i=1;i<t;++i){var o=e[i];o!==r&&(r=o,a=Math.max(i-n,a),n=i)}return Math.max(t-n,a)}}]),e}();function fk(e,t,n){for(var r=0;r<n;r++)e[r]=t[r]}function dk(e,t){var n,r=[],a=(0,B.Z)(e);try{for(a.s();!(n=a.n()).done;){var i=n.value;if(i<0){if(!t)throw new Error("Dimension ".concat(i," must be >= 0"));if(i<-1)throw new Error("Dimension ".concat(i," must be >= -1"));i=-1}r.push(i)}}catch(o){a.e(o)}finally{a.f()}return r}function hk(e,t,n,r,a,i,o,u,s,c){return new lk(e,t,n,r,a,i,o,u,s,c).compute()}var pk={kernelName:ii.RaggedTensorToTensor,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.shape,i=t.values,o=t.defaultValue,u=t.rowPartitionTensors,s=r.rowPartitionTypes,c=n.data.get(a.dataId).values,l=n.data.get(i.dataId).values,f=n.data.get(o.dataId).values,d=u.map((function(e){return n.data.get(e.dataId).values})),h=u.map((function(e){return e.shape})),p=hk(c,a.shape,l,i.shape,i.dtype,f,o.shape,d,h,s),v=(0,C.Z)(p,2),m=v[0],g=v[1];return n.makeTensorInfo(m,i.dtype,g)}};function vk(e,t,n,r){if(e===t||e<t&&n<0||t<e&&n>1)return ii.util.makeZerosTypedArray(0,r);var a=Math.abs(Math.ceil((t-e)/n)),i=ii.util.makeZerosTypedArray(a,r);t<e&&1===n&&(n=-1),i[0]=e;for(var o=1;o<i.length;o++)i[o]=i[o-1]+n;return i}var mk={kernelName:ii.Range,backendName:"cpu",kernelFunc:function(e){var t=e.backend,n=e.attrs,r=n.start,a=n.stop,i=n.dtype,o=vk(r,a,n.step,i);return t.makeTensorInfo([o.length],i,o)}},gk=gg(ii.Reciprocal,(function(e){return 1/e})),yk={kernelName:ii.Reciprocal,backendName:"cpu",kernelFunc:gk};var bk={kernelName:ii.ResizeBilinear,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.images,i=r.alignCorners,o=r.halfPixelCenters,u=r.size;hg(a,"resizeBilinear");for(var s=ii.util.computeStrides(a.shape),c=(0,C.Z)(u,2),l=c[0],f=c[1],d=(0,C.Z)(a.shape,4),h=d[0],p=d[1],v=d[2],m=d[3],g=n.data.get(a.dataId).values,y=new Float32Array(ii.util.sizeFromShape([h,l,f,m])),b=[i&&l>1?p-1:p,i&&f>1?v-1:v],x=[i&&l>1?l-1:l,i&&f>1?f-1:f],w=0,k=b[0]/x[0],_=b[1]/x[1],S=0;S<h;S++)for(var A=0;A<l;A++){var E=void 0;E=o?k*(A+.5)-.5:k*A;for(var N=Math.max(0,Math.floor(E)),T=E-N,I=Math.min(p-1,Math.ceil(E)),D=S*s[0]+N*s[1],F=S*s[0]+I*s[1],M=0;M<f;M++){var O=void 0;O=o?_*(M+.5)-.5:_*M;for(var R=Math.max(0,Math.floor(O)),j=O-R,B=Math.min(v-1,Math.ceil(O)),z=D+R*s[2],Z=F+R*s[2],L=D+B*s[2],P=F+B*s[2],U=0;U<m;U++){var W=g[z+U],V=g[Z+U],q=W+(g[L+U]-W)*j,G=q+(V+(g[P+U]-V)*j-q)*T;y[w++]=G}}}return n.makeTensorInfo([h,l,f,m],"float32",y)}};var xk={kernelName:ii.ResizeBilinearGrad,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.images,i=t.dy,o=r.alignCorners;hg([i,a],"resizeBilinearGrad");for(var u=ii.util.computeStrides(a.shape),s=(0,C.Z)(a.shape,4),c=s[0],l=s[1],f=s[2],d=s[3],h=(0,C.Z)(i.shape,3),p=h[1],v=h[2],m=new Float32Array(c*l*f*d),g=[o&&p>1?l-1:l,o&&v>1?f-1:f],y=[o&&p>1?p-1:p,o&&v>1?v-1:v],b=g[0]/y[0],x=g[1]/y[1],w=n.data.get(i.dataId).values,k=0,_=0;_<c;_++)for(var S=_*u[0],A=0;A<p;A++)for(var E=A*b,N=Math.floor(E),T=Math.min(Math.ceil(E),l-1),I=S+N*u[1],D=S+T*u[1],F=E-N,M=1-F,O=0;O<v;O++)for(var R=O*x,j=Math.floor(R),B=Math.min(Math.ceil(R),f-1),z=R-j,Z=1-z,L=I+j*u[2],P=I+B*u[2],U=D+j*u[2],W=D+B*u[2],V=M*Z,q=M*z,G=F*Z,H=F*z,X=0;X<d;X++){var K=w[k++];m[L+X]+=K*V,m[P+X]+=K*q,m[U+X]+=K*G,m[W+X]+=K*H}return n.makeTensorInfo([c,f,l,d],"float32",m)}};var wk={kernelName:ii.ResizeNearestNeighbor,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.images,i=r.alignCorners,o=r.halfPixelCenters,u=r.size;hg(a,"resizeNearestNeighbor");for(var s=ii.util.computeStrides(a.shape),c=(0,C.Z)(u,2),l=c[0],f=c[1],d=(0,C.Z)(a.shape,4),h=d[0],p=d[1],v=d[2],m=d[3],g=n.data.get(a.dataId).values,y=new Float32Array(h*l*f*m),b=[i&&l>1?p-1:p,i&&f>1?v-1:v],x=[i&&l>1?l-1:l,i&&f>1?f-1:f],w=b[0]/x[0],k=b[1]/x[1],_=0,S=0;S<h;S++)for(var A=S*s[0],E=0;E<l;E++){var N=o?w*(E+.5):w*E,T=Math.min(p-1,i?Math.round(N):Math.floor(N));o&&(T=Math.max(0,T));for(var I=A+T*s[1],D=0;D<f;D++){var F=o?k*(D+.5):k*D,M=Math.min(v-1,i?Math.round(F):Math.floor(F));o&&(M=Math.max(0,M));for(var O=I+M*s[2],R=0;R<m;R++){var j=g[O+R];y[_++]=j}}}return n.makeTensorInfo([h,l,f,m],a.dtype,y)}};var kk={kernelName:ii.ResizeNearestNeighborGrad,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.images,i=t.dy,o=r.alignCorners;hg([i,a],"resizeNearestNeighborGrad");for(var u=ii.util.computeStrides(a.shape),s=ii.util.computeStrides(i.shape),c=(0,C.Z)(a.shape,4),l=c[0],f=c[1],d=c[2],h=c[3],p=(0,C.Z)(i.shape,3),v=p[1],m=p[2],g=new Float32Array(l*f*d*h),y=n.data.get(i.dataId).values,b=[o&&v>1?f-1:f,o&&m>1?d-1:d],x=[o&&v>1?v-1:v,o&&m>1?m-1:m],w=b[0]/x[0],k=b[1]/x[1],_=1/w,S=1/k,A=2*Math.ceil(_)+2,E=2*Math.ceil(S)+2,N=0;N<l;N++)for(var T=N*u[0],I=0;I<f;I++)for(var D=T+I*u[1],F=Math.floor(I*_),M=Math.floor(F-A/2),O=0;O<d;O++)for(var R=D+O*u[2],j=Math.floor(O*S),B=Math.floor(j-E/2),z=0;z<h;z++){for(var Z=0,L=0;L<A;L++){var P=L+M;if(!(P<0||P>=v)){var U=T+P*s[1],W=P*w;if(I===Math.min(f-1,o?Math.round(W):Math.floor(W)))for(var V=0;V<E;V++){var q=V+B;if(!(q<0||q>=m)){var G=U+q*s[2],H=q*k;O===Math.min(d-1,o?Math.round(H):Math.floor(H))&&(Z+=y[G+z])}}}}g[R+z]=Z}return n.makeTensorInfo(a.shape,a.dtype,g)}};var _k={kernelName:ii.Reverse,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.dims;hg(a,"reverse");var o=a.shape.length,u=ii.util.parseAxisParam(i,a.shape);if(0===o)return wg({inputs:{x:a},backend:n});for(var s=new ii.TensorBuffer(a.shape,a.dtype),c=n.bufferSync(a),l=function(e){var t=s.indexToLoc(e),n=t.slice();u.forEach((function(e){return n[e]=a.shape[e]-1-n[e]})),s.set.apply(s,[c.get.apply(c,(0,I.Z)(n))].concat((0,I.Z)(t)))},f=0;f<s.size;f++)l(f);return n.makeTensorInfo(s.shape,s.dtype,s.values)}},Sk={kernelName:ii.RotateWithOffset,backendName:"cpu",kernelFunc:function(e){for(var t=e.inputs,n=e.attrs,r=e.backend,a=t.image,i=n.radians,o=n.fillValue,u=n.center,s=r,c=ii.util.getTypedArrayFromDType(a.dtype,ii.util.sizeFromShape(a.shape)),l=(0,C.Z)(a.shape,4),f=l[0],d=l[1],h=l[2],p=l[3],v=ii.backend_util.getImageCenter(u,d,h),m=(0,C.Z)(v,2),g=m[0],y=m[1],b=Math.sin(i),x=Math.cos(i),w=s.data.get(a.dataId).values,k=0;k<f;k++)for(var _=k*h*d*p,S=0;S<d;S++)for(var A=S*(h*p),E=0;E<h;E++)for(var N=E*p,T=0;T<p;T++){var I=[f,S,E,T],D=I[2],F=I[1],M=(D-g)*x-(F-y)*b,O=(D-g)*b+(F-y)*x;M=Math.round(M+g),O=Math.round(O+y);var R=o;if("number"!==typeof o&&(R=3===T?255:o[T]),M>=0&&M<h&&O>=0&&O<d)R=w[_+O*(h*p)+M*p+T];c[_+A+N+T]=R}return{dataId:s.write(c,a.shape,a.dtype),shape:a.shape,dtype:a.dtype}}},Ck=gg(ii.Round,(function(e){var t=Math.floor(e);return e-t<.5?Math.floor(e):e-t>.5?Math.ceil(e):t%2===0?t:t+1})),Ak={kernelName:ii.Round,backendName:"cpu",kernelFunc:Ck},Ek=mg((function(e){return 1/Math.sqrt(e)})),Nk=yg(ii.Rsqrt,Ek),Tk={kernelName:ii.Rsqrt,backendName:"cpu",kernelFunc:Nk};function Ik(e,t,n,r,a,i,o,u,s,c){var l=[r/a,a],f=e.values,d=t.values;if(0===r)return(0,ii.buffer)(n,t.dtype);var h=s instanceof ii.TensorBuffer?s:(0,ii.buffer)(l,t.dtype);"string"===typeof s||"number"===typeof s?h.values.fill(s):"boolean"===typeof s&&h.values.fill(+s);for(var p=0;p<i;p++){for(var v=[],m=0,g=0;g<o;g++){var y=f[p*o+g];v.push(y),m+=y*u[g]}if(m<0||m>=r/a)throw new Error("Invalid indices: ".concat(v," does not index into ").concat(n));for(var b=0;b<a;b++)c?h.values[m*a+b]+=d[p*a+b]:h.values[m*a+b]=0===t.rank?d[0]:d[p*a+b]}return h}var Dk={kernelName:ii.ScatterNd,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.indices,i=t.updates,o=r.shape,u=ii.backend_util.calculateShapes(i,a,o),s=u.sliceRank,c=u.numUpdates,l=u.sliceSize,f=u.strides,d=u.outputSize,h=Ik(n.bufferSync(a),n.bufferSync(i),o,d,l,c,s,f,0,!0);return n.makeTensorInfo(o,h.dtype,h.values)}};function Fk(e,t){for(var n=0,r=e.length,a=0;n<r;)e[a=Math.floor((n+r)/2)]<t?n=a+1:r=a;return r}function Mk(e,t){for(var n=0,r=e.length,a=0;n<r;)e[a=Math.floor((n+r)/2)]<=t?n=a+1:r=a;return r}var Ok={kernelName:ii.SearchSorted,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.sortedSequence,i=t.values,o=r.side,u=function(e,t,n,r,a,i){for(var o=ii.util.getArrayFromDType("int32",n*a),u=0;u<n;++u)for(var s=e.slice(u*r,(u+1)*r),c=u*a,l=0;l<a;++l)o[c+l]="left"===i?Fk(s,t[l+c]):Mk(s,t[l+c]);return o}(n.data.get(a.dataId).values,n.data.get(i.dataId).values,a.shape[0],a.shape[1],i.shape[1],o);return n.makeTensorInfo(i.shape,"int32",u)}};var Rk={kernelName:ii.Select,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.condition,a=t.t,i=t.e;hg([r,a,i],"select");for(var o=r.shape.length,u=n.data.get(r.dataId).values,s=n.data.get(a.dataId).values,c=n.data.get(i.dataId).values,l=(0,ii.upcastType)(a.dtype,i.dtype),f=ii.util.makeZerosTypedArray(ii.util.sizeFromShape(a.shape),l),d=0,h=0===o||o>1||1===a.shape.length?1:ii.util.sizeFromShape(a.shape.slice(1)),p=0;p<u.length;p++)for(var v=0;v<h;v++)1===u[p]?f[d++]=s[p]:f[d++]=c[p];return n.makeTensorInfo(a.shape,l,f)}},jk=ii.backend_util.SELU_SCALEALPHA,Bk=ii.backend_util.SELU_SCALE,zk=gg(ii.Selu,(function(e){return e>=0?Bk*e:jk*(Math.exp(e)-1)})),Zk={kernelName:ii.Selu,backendName:"cpu",kernelFunc:zk},Lk=gg(ii.Sign,(function(e){return e<0?-1:e>0?1:0})),Pk={kernelName:ii.Sign,backendName:"cpu",kernelFunc:Lk},Uk=gg(ii.Sin,(function(e){return Math.sin(e)})),Wk={kernelName:ii.Sin,backendName:"cpu",kernelFunc:Uk},Vk=gg(ii.Sinh,(function(e){return Math.sinh(e)})),qk={kernelName:ii.Sinh,backendName:"cpu",kernelFunc:Vk},Gk=Math.log(1.1920928955078125e-7)+2,Hk=gg(ii.Softplus,(function(e){var t=e>-Gk,n=e<Gk,r=Math.exp(e);return n?r:t?e:Math.log(1+r)})),Xk={kernelName:ii.Softplus,backendName:"cpu",kernelFunc:Hk};var Kk={kernelName:ii.SpaceToBatchND,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.blockShape,o=r.paddings;hg([a],"spaceToBatchND");var u=ii.util.sizeFromShape(i),s=[[0,0]];s.push.apply(s,(0,I.Z)(o));for(var c=1+i.length;c<a.shape.length;++c)s.push([0,0]);var l=Kw.kernelFunc({inputs:{x:a},backend:n,attrs:{paddings:s,constantValue:0}}),f=ii.backend_util.getReshaped(l.shape,i,u,!1),d=ii.backend_util.getPermuted(f.length,i.length,!1),h=ii.backend_util.getReshapedPermuted(l.shape,i,u,!1),p=$g({inputs:{x:l},backend:n,attrs:{shape:f}}),v=ly({inputs:{x:p},backend:n,attrs:{perm:d}}),m=$g({inputs:{x:v},backend:n,attrs:{shape:h}});return n.disposeIntermediateTensorInfo(l),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(v),m}};function Yk(e,t,n,r,a,i,o){var u=t[0],s=i[0],c=new Array(s),l=new Array(u),f=t[1];if(0===s){if(0!==u)throw new Error(ii.backend_util.getSparseFillEmptyRowsIndicesDenseShapeMismatch(u));return[ii.util.getArrayFromDType(n,0),[0,f],ii.util.getArrayFromDType(a,0),c,l]}for(var d=!0,h=0,p=new Array(s).fill(0),v=0;v<u;++v){var m=e[v*f];if(m<0)throw new Error(ii.backend_util.getSparseFillEmptyRowsNegativeIndexErrorMessage(v,m));if(m>=s)throw new Error(ii.backend_util.getSparseFillEmptyRowsOutOfRangeIndexErrorMessage(v,m,s));++p[m],d=d&&m>=h,h=m}for(var g=!0,y=0;y<s;++y){var b=0===p[y];c[y]=b,g=g&&!b,p[y]=Math.max(p[y],1),y>0&&(p[y]+=p[y-1])}if(g&&d){for(var x=e,w=r,k=0;k<u;++k)l[k]=k;return[x,[u,f],w,c,l]}for(var _=p[s-1],S=ii.util.getArrayFromDType(n,_*f),C=ii.util.getArrayFromDType(a,_),A=new Array(s).fill(0),E=0;E<u;++E){var N=e[E*f],T=A[N],I=(0===N?0:p[N-1])+T;A[N]++;for(var D=0;D<f;++D)S[I*f+D]=e[E*f+D];C[I]=r[E],l[E]=I}for(var F=0;F<s;++F){if(0===A[F]){var M=0===F?0:p[F-1];S[M*f+0]=F;for(var O=1;O<f;++O)S[M*f+O]=0;C[M]=o}}return[S,[_,f],C,c,l]}var $k={kernelName:ii.SparseFillEmptyRows,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.indices,a=t.values,i=t.denseShape,o=t.defaultValue;if(1!==i.shape.length)throw new Error("Dense shape must be a vector, saw:\n        ".concat(i.shape));if(2!==r.shape.length)throw new Error("Indices must be a matrix, saw:\n        ".concat(r.shape));if(1!==a.shape.length)throw new Error("Values must be a vector, saw:\n        ".concat(a.shape));if(0!==o.shape.length)throw new Error("Default value must be a scalar, saw:\n        ".concat(o.shape));var u=n.data.get(r.dataId).values,s=n.data.get(a.dataId).values,c=n.data.get(i.dataId).values,l=n.data.get(o.dataId).values[0],f=Yk(u,r.shape,r.dtype,s,a.dtype,c,l),d=(0,C.Z)(f,5),h=d[0],p=d[1],v=d[2],m=d[3],g=d[4];return[n.makeTensorInfo(p,r.dtype,h),n.makeTensorInfo([p[0]],a.dtype,v),n.makeTensorInfo([m.length],"bool",new Uint8Array(m.map((function(e){return Number(e)})))),n.makeTensorInfo([g.length],r.dtype,new Int32Array(g))]}};function Qk(e,t,n,r,a){for(var i=ii.util.sizeFromShape(r),o=t[0],u=a.length,s=[],c=1,l=-1,f=0;f<u;++f){var d=a[f];if(-1===d){if(-1!==l)throw new Error(ii.backend_util.getSparseReshapeMultipleNegativeOneOutputDimErrorMessage(l,f));l=f,s.push(1)}else{if(d<0)throw new Error(ii.backend_util.getSparseReshapeNegativeOutputDimErrorMessage(f,d));c*=d,s.push(d)}}if(-1!==l){if(c<=0)throw new Error(ii.backend_util.getSparseReshapeEmptyTensorZeroOutputDimErrorMessage());var h=Math.trunc(i/c);if(c*h!==i)throw new Error(ii.backend_util.getSparseReshapeInputOutputMultipleErrorMessage(r,s));s[l]=h}if(ii.util.sizeFromShape(s)!==i)throw new Error(ii.backend_util.getSparseReshapeInputOutputMismatchErrorMessage(r,s));var p=r.length,v=[];if(p>0){v[p-1]=1;for(var m=p-2;m>=0;--m)v[m]=v[m+1]*r[m+1]}var g=[];if(u>0){g[u-1]=1;for(var y=u-2;y>=0;--y)g[y]=g[y+1]*s[y+1]}for(var b=ii.util.getArrayFromDType(n,o*u),x=0;x<o;++x){for(var w=0,k=0;k<p;++k)w+=e[x*p+k]*v[k];for(var _=0;_<u;++_)b[x*u+_]=Math.trunc(w/g[_]),w%=g[_]}return[b,[o,u],s]}var Jk={kernelName:ii.SparseReshape,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.inputIndices,a=t.inputShape,i=t.newShape;if(2!==r.shape.length)throw new Error("Input indices should be a matrix but received shape\n        ".concat(r.shape));if(1!==a.shape.length)throw new Error("Input shape should be a vector but received shape\n        ".concat(a.shape));if(1!==i.shape.length)throw new Error("Target shape should be a vector but received shape ".concat(i.shape));var o=Array.from(n.data.get(a.dataId).values),u=n.data.get(r.dataId).values,s=Array.from(n.data.get(i.dataId).values),c=Qk(u,r.shape,r.dtype,o,s),l=(0,C.Z)(c,3),f=l[0],d=l[1],h=l[2];return[n.makeTensorInfo(d,r.dtype,f),n.makeTensorInfo([h.length],i.dtype,new Int32Array(h))]}};function e_(e,t,n,r,a){var i=arguments.length>5&&void 0!==arguments[5]&&arguments[5],o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,u=r.length,s=[t[0],e.length/t[0]],c=s[1],l=u>0?a[u-1]+1:0,f=l;if(f<0)throw new Error(ii.backend_util.getSparseSegmentReductionNegativeSegmentIdsErrorMessage());var d=t.slice();d[0]=f;var h=d.reduce((function(e,t){return e*t}),1),p=ii.util.getArrayFromDType(n,h);if(0===u)return f>0&&p.fill(o),[p,d];if(f<=0)throw new Error(ii.backend_util.getSparseSegmentReductionNegativeSegmentIdsErrorMessage());for(var v=0,m=1,g=0,y=a[v];;){var b=0;if(m<u){if(y===(b=a[m])){++m;continue}if(y>=b)throw new Error(ii.backend_util.getSparseSegmentReductionNonIncreasingSegmentIdsErrorMessage())}if(y<0||y>=f)throw new Error(ii.backend_util.getSparseSegmentReductionSegmentIdOutOfRangeErrorMessage(y,f));y>g&&p.fill(o,g*c,y*c);for(var x=v;x<m;++x){var w=r[x];if(w<0||w>=s[0])throw new Error(ii.backend_util.getSparseSegmentReductionIndicesOutOfRangeErrorMessage(x,r[x],s[0]));for(var k=0;k<c;k++)p[y*c+k]+=e[w*c+k]}if(i)for(var _=0;_<c;_++)p[y*c+_]/=m-v;if(v=m,g=y+1,y=b,++m>u)break}return g<f&&p.fill(o,g*c,f*c),[p,d]}var t_={kernelName:ii.SparseSegmentMean,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.data,a=t.indices,i=t.segmentIds;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==a.shape.length)throw new Error("Indices should be a vector but received shape\n          ".concat(a.shape));if(1!==i.shape.length)throw new Error("Segment ids should be a vector but received shape\n          ".concat(i.shape));if(a.shape[0]!==i.shape[0])throw new Error("segmentIds and indices should have same size.");var o=n.data.get(r.dataId).values,u=n.data.get(a.dataId).values,s=n.data.get(i.dataId).values,c=e_(o,r.shape,r.dtype,u,s,!0),l=(0,C.Z)(c,2),f=l[0],d=l[1];return n.makeTensorInfo(d,r.dtype,f)}};var n_={kernelName:ii.SparseSegmentSum,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.data,a=t.indices,i=t.segmentIds;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==a.shape.length)throw new Error("Indices should be a vector but received shape\n         ".concat(a.shape));if(1!==i.shape.length)throw new Error("Segment ids should be a vector but received shape\n         ".concat(i.shape));if(a.shape[0]!==i.shape[0])throw new Error("segmentIds and indices should have same size.");var o=n.data.get(r.dataId).values,u=n.data.get(a.dataId).values,s=n.data.get(i.dataId).values,c=e_(o,r.shape,r.dtype,u,s),l=(0,C.Z)(c,2),f=l[0],d=l[1];return n.makeTensorInfo(d,r.dtype,f)}};var r_={kernelName:ii.SparseToDense,backendName:"cpu",kernelFunc:function(e){var t,n=e.inputs,r=e.backend,a=e.attrs,i=n.sparseIndices,o=n.sparseValues,u=n.defaultValue,s=a.outputShape,c=ii.backend_util.calculateShapes(o,i,s),l=c.sliceRank,f=c.numUpdates,d=c.sliceSize,h=c.strides,p=c.outputSize,v=!1,m=r.bufferSync(i);switch(o.dtype){case"bool":t=Ik(m,r.bufferSync(o),s,p,d,f,l,h,Boolean(r.data.get(u.dataId).values[0]),v);break;case"float32":t=Ik(m,r.bufferSync(o),s,p,d,f,l,h,r.data.get(u.dataId).values[0],v);break;case"int32":t=Ik(m,r.bufferSync(o),s,p,d,f,l,h,r.data.get(u.dataId).values[0],v);break;case"string":t=Ik(m,r.bufferSync(o),s,p,d,f,l,h,ii.util.decodeString(r.data.get(u.dataId).values[0]),v);break;default:throw new Error("Unsupported type ".concat(o.dtype))}return r.makeTensorInfo(s,t.dtype,t.values)}};var a_={kernelName:ii.SplitV,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.numOrSizeSplits,o=r.axis,u=ii.util.parseAxisParam(o,a.shape)[0],s=ii.backend_util.prepareSplitSize(a,i,u),c=new Array(a.shape.length).fill(0),l=a.shape.slice();return s.map((function(e){var t=(0,I.Z)(l);t[u]=e;var r=jy({inputs:{x:a},backend:n,attrs:{begin:c,size:t}});return c[u]+=e,r}))}},i_=mg((function(e){return Math.sqrt(e)})),o_=gg(ii.Sqrt,(function(e){return Math.sqrt(e)})),u_={kernelName:ii.Sqrt,backendName:"cpu",kernelFunc:o_},s_={kernelName:ii.Square,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.x,a=n;hg(r,"square");for(var i=a.data.get(r.dataId).values,o=new Float32Array(i.length),u=0;u<i.length;++u){var s=i[u];o[u]=s*s}return{dataId:a.write(o,r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}},c_=Cg((function(e,t){var n=e-t;return n*n})),l_=qg(ii.SquaredDifference,c_),f_={kernelName:ii.SquaredDifference,backendName:"cpu",kernelFunc:l_},d_=mg((function(e,t){var n=t.pattern,r=t.replaceGlobal,a=t.rewrite;return e.replace(new RegExp(n,r?"g":""),a)})),h_=yg(ii.StaticRegexReplace,d_),p_={kernelName:ii.StaticRegexReplace,backendName:"cpu",kernelFunc:h_},v_=gg(ii.Step,(function(e,t){var n=t;return isNaN(e)?NaN:e>0?1:n.alpha})),m_={kernelName:ii.Step,backendName:"cpu",kernelFunc:v_};function g_(e,t,n,r){for(var a=(0,ii.buffer)(e,t.dtype),i=0;i<a.size;i++){for(var o=a.indexToLoc(i),u=new Array(o.length),s=0;s<u.length;s++)u[s]=o[s]*n[s]+r[s];a.set.apply(a,[t.get.apply(t,u)].concat((0,I.Z)(o)))}return a}var y_={kernelName:ii.StridedSlice,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.begin,o=r.end,u=r.strides,s=r.beginMask,c=r.endMask,l=r.ellipsisMask,f=r.newAxisMask,d=r.shrinkAxisMask;hg(a,"stridedSlice");var h,p=ii.slice_util.sliceInfo(a.shape,i,o,u,s,c,l,f,d),v=p.finalShapeSparse,m=p.finalShape,g=p.isIdentity,y=p.sliceDim0,b=p.isSimpleSlice,x=p.begin,w=p.end,k=p.strides;if(g)h=$g({inputs:{x:a},backend:n,attrs:{shape:m}});else if(y||b){ii.util.assert(a.shape.length>=1,(function(){return"Input must have rank at least 1, got: ".concat(a.shape.length)}));var _=ii.slice_util.computeOutShape(x,w,k),S=jy({inputs:{x:a},backend:n,attrs:{begin:x,size:_}});h=$g({inputs:{x:S},backend:n,attrs:{shape:m}}),n.disposeIntermediateTensorInfo(S)}else{var C=g_(v,n.bufferSync(a),k,x);h=n.makeTensorInfo(m,C.dtype,C.values)}return h}},b_=function(){function e(t,n,r,a,i,o){(0,D.Z)(this,e),this.separator=ii.util.encodeString(t),this.nGramWidths=n,this.leftPad=ii.util.encodeString(r),this.rightPad=ii.util.encodeString(a),this.padWidth=i,this.preserveShort=o}return(0,F.Z)(e,[{key:"getPadWidth",value:function(e){return Math.min(this.padWidth<0?e-1:this.padWidth,e-1)}},{key:"getNumNGrams",value:function(e,t){var n=this.getPadWidth(t);return Math.max(0,e+2*n-t+1)}},{key:"createNGrams",value:function(e,t,n,r,a,i){for(var o=this,u=function(u){var s=o.getPadWidth(i),c=Math.max(0,s-u),l=Math.max(0,s-(a-(u+1))),f=i-(c+l),d=t+(c>0?0:u-s),h=0;h+=c*o.leftPad.length;for(var p=0;p<f;++p)h+=e[d+p].length;h+=l*o.rightPad.length,h+=(c+l+f-1)*o.separator.length,n[r+u]=new Uint8Array(h);for(var v=n[r+u],m=0,g=function(e){return e.forEach((function(e){return v[m++]=e}))},y=0;y<c;++y)g(o.leftPad),g(o.separator);for(var b=0;b<f-1;++b)g(e[d+b]),g(o.separator);if(f>0){g(e[d+f-1]);for(var x=0;x<l;++x)g(o.separator),g(o.rightPad)}else{for(var w=0;w<l-1;++w)g(o.rightPad),g(o.separator);g(o.rightPad)}},s=0;s<a;++s)u(s)}},{key:"compute",value:function(e,t){var n=this,r=e.length,a=t.length;if(a>0){var i=t[0];if(0!==i)throw new Error("First split value must be 0, got ".concat(i));for(var o=1;o<a;++o){var u=t[o]>=i;if(!(u=u&&t[o]<=r))throw new Error("Invalid split value ".concat(t[o],", must be in [").concat(i,", ").concat(r,"]"));i=t[o]}if(i!==r)throw new Error("Last split value must be data size. Expected ".concat(r,", got ").concat(i))}var s=a-1,c=ii.util.getArrayFromDType("int32",a);if(0===r||0===a){for(var l=new Array(r),f=0;f<=s;++f)c[f]=0;return[l,c]}c[0]=0;for(var d=function(e){var r=t[e]-t[e-1],a=0;n.nGramWidths.forEach((function(e){a+=n.getNumNGrams(r,e)})),n.preserveShort&&r>0&&0===a&&(a=1),c[e]=c[e-1]+a},h=1;h<=s;++h)d(h);for(var p=new Array(c[s]),v=function(r){var a=t[r],i=c[r];if(n.nGramWidths.forEach((function(o){var u=t[r+1]-t[r],s=n.getNumNGrams(u,o);n.createNGrams(e,a,p,i,s,o),i+=s})),n.preserveShort&&i===c[r]){var o=t[r+1]-t[r];if(0===o)return"continue";var u=o+2*n.padWidth;n.createNGrams(e,a,p,i,1,u)}},m=0;m<s;++m)v(m);return[p,c]}}]),e}();function x_(e,t,n,r,a,i,o,u){return new b_(n,r,a,i,o,u).compute(e,t)}var w_={kernelName:ii.StringNGrams,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=r.separator,i=r.nGramWidths,o=r.leftPad,u=r.rightPad,s=r.padWidth,c=r.preserveShortSequences,l=t.data,f=t.dataSplits,d=x_(n.data.get(l.dataId).values,n.data.get(f.dataId).values,a,i,o,u,s,c),h=(0,C.Z)(d,2),p=h[0],v=h[1];return[n.makeTensorInfo([p.length],"string",p),n.makeTensorInfo(f.shape,"int32",v)]}};function k_(e,t,n,r){if(e.length)if(0!==t.length)if(1!==t.length){for(var a=0,i=0;i<e.length+1;i++)if(i===e.length||-1!==t.indexOf(e[i])){var o=e.subarray(a,i);n&&0===o.length||r.push(o),a=i+1}}else{for(var u=t[0],s=e.indexOf(u);-1!==s;){var c=e.subarray(0,s);n&&0===c.length||r.push(c),s=(e=e.subarray(s+1)).indexOf(u)}n&&0===e.length||r.push(e)}else for(var l=0;l<e.length;++l)r.push(e.subarray(l,l+1))}function __(e,t,n){for(var r=e.length,a=[],i=0,o=0,u=new Array(r),s=0;s<r;++s){var c=a.length;k_(e[s],t,n,a);var l=a.length-c;u[s]=l,i+=l,o=Math.max(o,l)}for(var f=ii.util.getArrayFromDType("int32",2*i),d=new Array(i),h=[r,o],p=0,v=0;v<r;++v)for(var m=0;m<u[v];++m)f[2*p]=v,f[2*p+1]=m,d[p]=a[p],++p;return[f,d,h]}var S_={kernelName:ii.StringSplit,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs.skipEmpty,a=t.input,i=t.delimiter;if("string"!==a.dtype)throw new Error("Input must be of datatype string");if(1!==a.shape.length)throw new Error("Input must be a vector, got shape: ".concat(a.shape));if(0!==i.shape.length)throw new Error("Delimiter must be a scalar, got shape: ".concat(i.shape));var o=__(n.data.get(a.dataId).values,n.data.get(i.dataId).values[0],r),u=(0,C.Z)(o,3),s=u[0],c=u[1],l=u[2],f=c.length;return[n.makeTensorInfo([f,2],"int32",s),n.makeTensorInfo([f],"string",c),n.makeTensorInfo([2],"int32",new Int32Array(l))]}};function C_(e,t){for(var n=ii.util.getArrayFromDType("int32",e.length),r=0;r<e.length;++r)n[r]=ii.util.fingerPrint64(e[r]).modulo(t).getLowBitsUnsigned();return n}var A_={kernelName:ii.StringToHashBucketFast,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs.numBuckets,a=t.input;if("string"!==a.dtype)throw new Error("Input must be of datatype string");if(r<=0)throw new Error("Number of buckets must be at least 1");var i=C_(n.data.get(a.dataId).values,r);return n.makeTensorInfo(a.shape,"int32",i)}},E_=gg(ii.Tan,(function(e){return Math.tan(e)})),N_={kernelName:ii.Tan,backendName:"cpu",kernelFunc:E_},T_=gg(ii.Tanh,(function(e){return Math.tanh(e)})),I_={kernelName:ii.Tanh,backendName:"cpu",kernelFunc:T_};var D_={kernelName:ii.TensorScatterUpdate,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.tensor,a=t.indices,i=t.updates,o=ii.backend_util.calculateShapes(i,a,r.shape),u=o.sliceRank,s=o.numUpdates,c=o.sliceSize,l=o.strides,f=o.outputSize,d=n.bufferSync(a),h=n.bufferSync(i),p=n.bufferSync(r),v=Ik(d,h,r.shape,f,c,s,u,l,p,!1);return n.makeTensorInfo(r.shape,v.dtype,v.values)}};function F_(e,t){for(var n=new Array(e.rank),r=0;r<n.length;r++)n[r]=e.shape[r]*t[r];for(var a=(0,ii.buffer)(n,e.dtype),i=0;i<a.values.length;++i){for(var o=a.indexToLoc(i),u=new Array(e.rank),s=0;s<u.length;s++)u[s]=o[s]%e.shape[s];var c=e.locToIndex(u);a.values[i]=e.values[c]}return a}var M_={kernelName:ii.Tile,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.reps;hg(a,"tile");var o=F_(n.bufferSync(a),i);return n.makeTensorInfo(o.shape,o.dtype,o.values)}},O_=function(e,t){var n=t.value-e.value;return 0===n?e.index-t.index:n};function R_(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.length-1;r>n;){if(r-n>600){var a=r-n+1,i=t-n+1,o=Math.log(a),u=.5*Math.exp(2*o/3),s=.5*Math.sqrt(o*u*(a-u)/a)*Math.sign(i-a/2),c=Math.max(n,Math.floor(t-i*u/a+s)),l=Math.min(r,Math.floor(t+(a-i)*u/a+s));R_(e,t,c,l)}var f=e[t],d=n,h=r;for(ii.util.swap(e,n,t),O_(e[r],f)>0&&ii.util.swap(e,n,r);d<h;){for(ii.util.swap(e,d,h),d++,h--;O_(e[d],f)<0;)d+=1;for(;O_(e[h],f)>0;)h-=1}0===O_(e[n],f)?ii.util.swap(e,n,h):(h+=1,ii.util.swap(e,h,r)),h<=t&&(n=h+1),t<=h&&(r=h-1)}}function j_(e,t,n,r,a){for(var i=t[t.length-1],o=e.length/i,u=i,s=ii.util.getTypedArrayFromDType(n,o*r),c=ii.util.getTypedArrayFromDType("int32",o*r),l=function(t){var n=t*u,i=e.subarray(n,n+u),o=new Array(i.length);i.forEach((function(e,t){return o[t]={value:e,index:t}})),r<o.length&&(R_(o,r),o=o.slice(0,r)),a&&o.sort(O_);for(var l=t*r,f=s.subarray(l,l+r),d=c.subarray(l,l+r),h=0;h<r;h++)f[h]=o[h].value,d[h]=o[h].index},f=0;f<o;f++)l(f);var d=t.slice();return d[d.length-1]=r,[(0,ii.buffer)(d,n,s),(0,ii.buffer)(d,"int32",c)]}var B_={kernelName:ii.TopK,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.k,o=r.sorted;hg(a,"topk");var u=j_(n.data.get(a.dataId).values,a.shape,a.dtype,i,o),s=(0,C.Z)(u,2),c=s[0],l=s[1];return[n.makeTensorInfo(c.shape,c.dtype,c.values),n.makeTensorInfo(l.shape,l.dtype,l.values)]}};var z_={kernelName:ii.Transform,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.attrs,r=e.backend,a=t.image,i=t.transforms,o=n.interpolation,u=n.fillMode,s=n.fillValue,c=n.outputShape,l=(0,C.Z)(a.shape,4),f=l[0],d=l[1],h=l[2],p=l[3],v=null!=c?c:[d,h],m=(0,C.Z)(v,2),g=m[0],y=m[1],b=[f,g,y,p],x=ii.util.computeStrides(a.shape),w=x[0],k=x[1],_=x[2],S=ii.util.computeStrides(b),A=S[0],E=S[1],N=S[2],T=ii.util.getTypedArrayFromDType(a.dtype,ii.util.sizeFromShape(b));T.fill(s);for(var I=r.data.get(a.dataId).values,D=r.data.get(i.dataId).values,F=0;F<f;++F){for(var M=1===i.shape[0]?D:D.subarray(8*F,8*F+8),O=0;O<g;++O)for(var R=0;R<y;++R)for(var j=0;j<p;++j){var B=void 0,z=M[6]*R+M[7]*O+1;if(0!==z){var Z=(M[0]*R+M[1]*O+M[2])/z,L=(M[3]*R+M[4]*O+M[5])/z,P=Z_(Z,h,u),U=Z_(L,d,u);switch(o){case"nearest":B=P_(I,d,h,w,k,_,F,U,P,j,s);break;case"bilinear":B=U_(I,d,h,w,k,_,F,U,P,j,s);break;default:throw new Error("Error in Transform: Expect 'nearest' or "+"'bilinear', but got ".concat(o))}T[F*A+O*E+R*N+j]=B}}return r.makeTensorInfo(b,a.dtype,T)}return{dataId:r.write(T,b,a.dtype),shape:a.shape,dtype:a.dtype}}};function Z_(e,t,n){switch(n){case"reflect":return function(e,t){var n=e;if(n<0)if(t<=1)n=0;else{var r=2*t;n<r&&(n=r*Math.trunc(-n/r)+n),n=n<-t?n+r:-n-1}else if(n>t-1)if(t<=1)n=0;else{var a=2*t;(n-=a*Math.trunc(n/a))>=t&&(n=a-n-1)}return ii.util.clamp(0,n,t-1)}(e,t);case"wrap":return function(e,t){var n=e;if(n<0)if(t<=1)n=0;else{var r=t-1;n+=t*(Math.trunc(-n/r)+1)}else if(n>t-1)if(t<=1)n=0;else{var a=t-1;n-=t*Math.trunc(n/a)}return ii.util.clamp(0,n,t-1)}(e,t);case"nearest":return function(e,t){return ii.util.clamp(0,e,t-1)}(e,t);default:return function(e,t){return e}(e)}}function L_(e,t,n,r,a,i,o,u,s,c,l){return 0<=u&&u<t&&0<=s&&s<n?e[o*r+u*a+s*i+c]:l}function P_(e,t,n,r,a,i,o,u,s,c,l){return L_(e,t,n,r,a,i,o,Math.round(u),Math.round(s),c,l)}function U_(e,t,n,r,a,i,o,u,s,c,l){var f=Math.floor(u),d=Math.floor(s),h=f+1,p=d+1;return(h-u)*((p-s)*L_(e,t,n,r,a,i,o,f,d,c,l)+(s-d)*L_(e,t,n,r,a,i,o,f,p,c,l))+(u-f)*((p-s)*L_(e,t,n,r,a,i,o,h,d,c,l)+(s-d)*L_(e,t,n,r,a,i,o,h,p,c,l))}function W_(e,t,n,r){for(var a=ii.util.parseAxisParam(t,n)[0],i=[1,n[0],1],o=0;o<a;o++)i[0]*=n[o];i[1]=n[a];for(var u=a+1;u<n.length;u++)i[2]*=n[u];for(var s=new Map,c=new Int32Array(n[a]),l=new ii.TensorBuffer(i,r,e),f=[],d=1===i[0]&&1===i[2],h=0;h<n[a];h++){var p=void 0;if(d)p=e[h].toString();else{for(var v=[],m=0;m<i[0];m++)for(var g=0;g<i[2];g++)v.push(l.get(m,h,g));p=v.join(",")}var y=s.get(p);if(null!=y)c[h]=y;else{var b=s.size;s.set(p,b),c[h]=b,f.push(h)}}var x=i.slice();x[1]=s.size;var w=new ii.TensorBuffer(x,r);f.forEach((function(e,t){for(var n=0;n<i[0];n++)for(var r=0;r<i[2];r++)w.set(l.get(n,e,r),n,t,r)}));var k=n.slice();return k[a]=x[1],{outputValues:w.values,outputShape:k,indices:c}}var V_={kernelName:ii.Unique,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.attrs,r=e.backend,a=n.axis,i=t.x;hg(i,"unique");var o=W_(r.data.get(i.dataId).values,a,i.shape,i.dtype),u=o.outputValues,s=o.outputShape,c=o.indices;return[r.makeTensorInfo(s,i.dtype,u),r.makeTensorInfo([c.length],"int32",c)]}};var q_={kernelName:ii.Unpack,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.value,i=r.axis;i<0&&(i+=a.shape.length);for(var o=a.shape.length,u=a.shape[i],s=new Array(o-1),c=0,l=0;l<o;l++)l!==i&&(s[c++]=a.shape[l]);var f=new Array(o).fill(0),d=a.shape.slice();d[i]=1;for(var h=new Array(u),p=0;p<h.length;p++){f[i]=p;var v=jy({inputs:{x:a},backend:n,attrs:{begin:f,size:d}});h[p]=$g({inputs:{x:v},backend:n,attrs:{shape:s}}),n.disposeIntermediateTensorInfo(v)}return h}};for(var G_={kernelName:ii.UnsortedSegmentSum,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.segmentIds,o=r.numSegments;hg(a,"unsortedSegmentSum");for(var u=[],s=[],c=a.shape.length-i.shape.length,l=i,f=0;f<c;++f){var d=Yb({inputs:{input:l},backend:n,attrs:{dim:f+1}});l=d,s.push(d)}for(var h=0;h<o;++h){var p=ii.util.createScalarValue(h,"int32"),v=n.makeTensorInfo([],"int32",p),m=Bb({inputs:{a:v,b:l},backend:n}),g=Wg({inputs:{x:m},backend:n,attrs:{dtype:"float32"}}),y=Ib({inputs:{a:g,b:a},backend:n}),b=Fb({inputs:{x:y},backend:n,attrs:{axis:0,keepDims:!1}});u.push(b),s.push(v),s.push(m),s.push(g),s.push(y),s.push(b)}var x=Hw({inputs:u,backend:n,attrs:{axis:0}});return s.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),x}},H_=0,X_=[ty,ry,iy,uy,Yg,sy,dy,hy,py,vy,gy,by,wy,Sy,Ay,Iy,Dy,Fy,My,ey,Oy,zy,Py,Vy,qy,Vg,Xy,Yy,zg,$y,nb,ab,ib,ob,ub,sb,cb,fb,hb,pb,vb,mb,gb,yb,xb,wb,kb,_b,Sb,Cb,Ab,Eb,Ob,xg,Rb,zb,Gb,Kb,$b,ex,fx,hx,px,gx,xx,wx,kx,Sx,Ax,Tx,Fx,kg,Mx,eb,Rx,Bx,Zx,Sg,Ux,qx,Hx,Yx,Qx,tw,rw,ow,uw,sw,fw,pw,vw,mw,gw,yw,bw,xw,ww,Sw,Cw,Nw,Dw,Db,Mw,Rw,Bw,Zw,Uw,Ww,Gw,Xw,Kw,Qw,Ng,ek,ik,sk,pk,mk,Pg,rx,yk,Ig,Fg,Qg,bk,xk,wk,kk,_k,Sk,Ak,Tk,Dk,Ok,Rk,Zk,Rg,Pk,Wk,qk,By,Iw,Xk,Kk,$k,Jk,t_,n_,r_,a_,u_,s_,f_,p_,m_,y_,w_,S_,A_,ux,Mb,N_,I_,D_,M_,B_,z_,fy,V_,q_,G_,qw];H_<X_.length;H_++){var K_=X_[H_];(0,ii.registerKernel)(K_)}var Y_,$_,Q_,J_={},eS={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function tS(e,t){if(!(e in J_)||null!=t){var n=function(e,t){if(1!==e&&2!==e)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");var n=null==t?function(e){if((0,ii.env)().getBool("IS_SAFARI")||"undefined"===typeof OffscreenCanvas||2!==e){if("undefined"!==typeof document)return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}return new OffscreenCanvas(300,150)}(e):t;n.addEventListener("webglcontextlost",(function(t){t.preventDefault(),delete J_[e]}),!1),(0,ii.env)().getBool("SOFTWARE_WEBGL_ENABLED")&&(eS.failIfMajorPerformanceCaveat=!1);if(1===e)return n.getContext("webgl",eS)||n.getContext("experimental-webgl",eS);return n.getContext("webgl2",eS)}(e,t);if(null===n)return console.log("Could not get context for WebGL version",e),null;J_[e]=n}var r=J_[e];return null==r||r.isContextLost()?(delete J_[e],tS(e)):(r.disable(r.DEPTH_TEST),r.disable(r.STENCIL_TEST),r.disable(r.BLEND),r.disable(r.DITHER),r.disable(r.POLYGON_OFFSET_FILL),r.disable(r.SAMPLE_COVERAGE),r.enable(r.SCISSOR_TEST),r.enable(r.CULL_FACE),r.cullFace(r.BACK),J_[e])}function nS(e,t){return[t,e]}function rS(e){var t=ii.util.sizeFromShape(e),n=Math.ceil(t/4);return ii.util.sizeToSquarishShape(n)}function aS(e,t){return[Math.max(1,Math.ceil(t/2)),Math.max(1,Math.ceil(e/2))]}function iS(e,t){var n,r,a,i,o,u,s,c,l,f,d=e;return 2===(0,ii.env)().getNumber("WEBGL_VERSION")?(n=d.R32F,r=d.R16F,a=d.RGBA16F,i=d.RGBA32F,o=d.RED,s=4,c=1,l=d.HALF_FLOAT,f=d.FLOAT,u=d.RGBA8):(n=e.RGBA,r=e.RGBA,a=e.RGBA,i=d.RGBA,o=e.RGBA,s=4,c=4,l=null!=t?t.HALF_FLOAT_OES:null,f=e.FLOAT,u=e.RGBA),{internalFormatFloat:n,internalFormatHalfFloat:r,internalFormatPackedHalfFloat:a,internalFormatPackedFloat:i,textureFormatFloat:o,downloadTextureFormat:u,downloadUnpackNumChannels:s,defaultNumChannels:c,textureTypeHalfFloat:l,textureTypeFloat:f}}function oS(e,t){var n=t();return(0,ii.env)().getBool("DEBUG")&&function(e){var t=e.getError();if(t!==e.NO_ERROR)throw new Error("WebGL Error: "+function(e,t){switch(t){case e.NO_ERROR:return"NO_ERROR";case e.INVALID_ENUM:return"INVALID_ENUM";case e.INVALID_VALUE:return"INVALID_VALUE";case e.INVALID_OPERATION:return"INVALID_OPERATION";case e.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case e.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case e.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return"Unknown error code ".concat(t)}}(e,t))}(e),n}!function(e){e[e.DENSE=0]="DENSE",e[e.SHARED_BATCH=1]="SHARED_BATCH"}(Y_||(Y_={})),function(e){e[e.RENDER=0]="RENDER",e[e.UPLOAD=1]="UPLOAD",e[e.PIXELS=2]="PIXELS",e[e.DOWNLOAD=3]="DOWNLOAD"}($_||($_={})),function(e){e[e.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",e[e.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",e[e.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",e[e.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",e[e.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"}(Q_||(Q_={}));function uS(e){return!!((0,ii.env)().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||0===e||5.96e-8<Math.abs(e)&&Math.abs(e)<65504)}function sS(e,t){return wS(e,(function(){return e.getExtension(t)}),'Extension "'+t+'" not supported on this browser.')}var cS,lS,fS=/ERROR: [0-9]+:([0-9]+):/g;function dS(e,t){var n=fS.exec(t);if(null==n)return console.log("Couldn't parse line number in error: ".concat(t)),void console.log(e);for(var r=+n[1],a=e.split("\n"),i=a.length.toString().length+2,o=a.map((function(e,t){return ii.util.rightPad((t+1).toString(),i)+e})),u=0,s=0;s<o.length;s++)u=Math.max(o[s].length,u);var c=o.slice(0,r-1),l=o.slice(r-1,r),f=o.slice(r);console.log(c.join("\n")),console.log(t.split("\n")[0]),console.log("%c ".concat(ii.util.rightPad(l[0],u)),"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(f.join("\n"))}function hS(e,t){if(oS(e,(function(){return e.validateProgram(t)})),!1===e.getProgramParameter(t,e.VALIDATE_STATUS))throw console.log(e.getProgramInfoLog(t)),new Error("Shader program validation failed.")}function pS(e,t,n,r,a,i,o){var u=e.getAttribLocation(t,n);return-1!==u&&(oS(e,(function(){return e.bindBuffer(e.ARRAY_BUFFER,r)})),oS(e,(function(){return e.vertexAttribPointer(u,a,e.FLOAT,!1,i,o)})),oS(e,(function(){return e.enableVertexAttribArray(u)})),!0)}function vS(e,t,n){return wS(e,(function(){return e.getUniformLocation(t,n)}),'uniform "'+n+'" not present in program.')}function mS(e,t,n){return e.getUniformLocation(t,n)}function gS(e,t,n,r){oS(e,(function(){return function(e,t,n){kS(e,n),oS(e,(function(){return e.activeTexture(e.TEXTURE0+n)})),oS(e,(function(){return e.bindTexture(e.TEXTURE_2D,t)}))}(e,t,r)})),oS(e,(function(){return e.uniform1i(n,r)}))}function yS(e,t,n){oS(e,(function(){return e.bindFramebuffer(e.FRAMEBUFFER,n)})),oS(e,(function(){return e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t,0)}))}function bS(e,t){oS(e,(function(){return e.bindFramebuffer(e.FRAMEBUFFER,t)})),oS(e,(function(){return e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,null,0)}))}function xS(e){var t=e.checkFramebufferStatus(e.FRAMEBUFFER);if(t!==e.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+function(e,t){switch(t){case e.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case e.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case e.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case e.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return"unknown error ".concat(t)}}(e,t))}function wS(e,t,n){var r=oS(e,(function(){return t()}));if(null==r)throw new Error(n);return r}function kS(e,t){var n=e.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,r=t+e.TEXTURE0;if(r<e.TEXTURE0||r>n){var a="[gl.TEXTURE0, gl.TEXTURE".concat(n,"]");throw new Error("textureUnit must be in ".concat(a,"."))}}function _S(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return ii.util.sizeFromShape(e.slice(0,e.length-t))}function SS(e){if(0===e.length)throw Error("Cannot get rows and columns of an empty shape array.");return[e.length>1?e[e.length-2]:1,e[e.length-1]]}function CS(e){var t=[1,1,1];return 0===e.length||1===e.length&&1===e[0]||(t=[_S(e)].concat((0,I.Z)(SS(e)))),t}function AS(e){return e%2===0}function ES(e,t){if(e=e.slice(-2),t=t.slice(-2),ii.util.arraysEqual(e,t))return!0;if(!e.length||!t.length)return!0;if(0===e[0]||0===e[1]||0===t[0]||0===t[1])return!0;if(e.length!==t.length){var n=e[e.length-1],r=t[t.length-1];if(n===r)return!0;if(AS(n)&&AS(r)&&(1===e[0]||1===t[0]))return!0}return e[1]===t[1]&&AS(e[0])&&AS(t[0])}function NS(e,t){return null!=e.getExtension(t)}function TS(e){try{if(null!=tS(e))return!0}catch(Xz){return console.log("Error when getting WebGL context: ",Xz),!1}return!1}function IS(e){if(0===e)return!1;var t=tS(e);if(1!==e){if(NS(t,"EXT_color_buffer_float"))return DS(t);var n="EXT_color_buffer_half_float";if(NS(t,n)){var r=t.getExtension(n);return function(e,t){var n=iS(e,t),r=e.createTexture();e.bindTexture(e.TEXTURE_2D,r);var a=1,i=1;e.texImage2D(e.TEXTURE_2D,0,n.internalFormatHalfFloat,a,i,0,n.textureFormatFloat,n.textureTypeHalfFloat,null);var o=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,o),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,r,0);var u=e.checkFramebufferStatus(e.FRAMEBUFFER)===e.FRAMEBUFFER_COMPLETE;return e.bindTexture(e.TEXTURE_2D,null),e.bindFramebuffer(e.FRAMEBUFFER,null),e.deleteTexture(r),e.deleteFramebuffer(o),u}(t,r)}return!1}return!!NS(t,"OES_texture_float")&&(!!NS(t,"WEBGL_color_buffer_float")&&DS(t))}function DS(e){var t=iS(e),n=e.createTexture();e.bindTexture(e.TEXTURE_2D,n);e.texImage2D(e.TEXTURE_2D,0,t.internalFormatFloat,1,1,0,t.textureFormatFloat,t.textureTypeFloat,null);var r=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,r),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,n,0);var a=e.checkFramebufferStatus(e.FRAMEBUFFER)===e.FRAMEBUFFER_COMPLETE;return e.bindTexture(e.TEXTURE_2D,null),e.bindFramebuffer(e.FRAMEBUFFER,null),e.deleteTexture(n),e.deleteFramebuffer(r),a}function FS(e,t){Array.isArray(e)||(e=[e]),e.forEach((function(e){null!=e&&ii.util.assert("complex64"!==e.dtype,(function(){return"".concat(t," does not support complex64 tensors ")+"in the WebGL backend."}))}))}var MS=(0,ii.env)();function OS(){var e,t,n,r,a,i,o,u,s,c;return 2===(0,ii.env)().getNumber("WEBGL_VERSION")?(e="#version 300 es",t="in",n="out",r="in",a="texture",i="outputColor",o="out vec4 outputColor;",u=(0,ii.env)().getBool("WEBGL2_ISNAN_CUSTOM")?"\n      bool isnan_custom(float val) {\n        uint floatToUint = floatBitsToUint(val);\n        return (floatToUint & 0x7fffffffu) > 0x7f800000u;\n      }\n\n      bvec4 isnan_custom(vec4 val) {\n        return bvec4(isnan_custom(val.x),\n          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));\n      }\n\n      #define isnan(value) isnan_custom(value)\n    ":"",s="",c="\n      #define round(value) newRound(value)\n      int newRound(float value) {\n        return int(floor(value + 0.5));\n      }\n\n      ivec4 newRound(vec4 value) {\n        return ivec4(floor(value + vec4(0.5)));\n      }\n    "):(e="",t="attribute",n="varying",r="varying",a="texture2D",i="gl_FragColor",o="",u="\n      #define isnan(value) isnan_custom(value)\n      bool isnan_custom(float val) {\n        return (val > 0. || val < 1. || val == 0.) ? false : true;\n      }\n      bvec4 isnan_custom(vec4 val) {\n        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));\n      }\n    ",s="\n      uniform float INFINITY;\n\n      bool isinf(float val) {\n        return abs(val) == INFINITY;\n      }\n      bvec4 isinf(vec4 val) {\n        return equal(abs(val), vec4(INFINITY));\n      }\n    ",c="\n      int round(float value) {\n        return int(floor(value + 0.5));\n      }\n\n      ivec4 round(vec4 value) {\n        return ivec4(floor(value + vec4(0.5)));\n      }\n    "),{version:e,attribute:t,varyingVs:n,varyingFs:r,texture2D:a,output:i,defineOutput:o,defineSpecialNaN:u,defineSpecialInf:s,defineRound:c}}function RS(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"index",r=ii.util.computeStrides(t);return r.map((function(t,a){var i="int ".concat(e[a]," = ").concat(n," / ").concat(t),o=a===r.length-1?"int ".concat(e[a+1]," = ").concat(n," - ").concat(e[a]," * ").concat(t):"index -= ".concat(e[a]," * ").concat(t);return"".concat(i,"; ").concat(o,";")})).join("")}function jS(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"index",r=ii.util.computeStrides(t);return r.map((function(t,a){var i="int ".concat(e[a]," = ").concat(n," / outShapeStrides[").concat(a,"]"),o=a===r.length-1?"int ".concat(e[a+1]," = ").concat(n," - ").concat(e[a]," * outShapeStrides[").concat(a,"]"):"index -= ".concat(e[a]," * outShapeStrides[").concat(a,"]");return"".concat(i,"; ").concat(o,";")})).join("")}function BS(e,t){var n=e.length,r=e.map((function(e){return"".concat(t,"[").concat(e,"]")})),a=new Array(n-1);a[n-2]=r[n-1];for(var i=n-3;i>=0;--i)a[i]="(".concat(a[i+1]," * ").concat(r[i+1],")");return a}function zS(e){var t=ii.util.computeStrides(e).map((function(e){return e.toString()}));return"\n  int getFlatIndex(ivec3 coords) {\n    return coords.x * ".concat(t[0]," + coords.y * ").concat(t[1]," + coords.z;\n  }\n")}MS.registerFlag("HAS_WEBGL",(function(){return MS.getNumber("WEBGL_VERSION")>0})),MS.registerFlag("WEBGL_VERSION",(function(){return TS(2)?2:TS(1)?1:0})),MS.registerFlag("WEBGL_CHECK_NUMERICAL_PROBLEMS",(function(){return!1})),MS.registerFlag("WEBGL_BUFFER_SUPPORTED",(function(){return 2===MS.get("WEBGL_VERSION")})),MS.registerFlag("WEBGL_CPU_FORWARD",(function(){return!0})),MS.registerFlag("WEBGL_FORCE_F16_TEXTURES",(function(){return!1})),MS.registerFlag("WEBGL_PACK",(function(){return MS.getBool("HAS_WEBGL")})),MS.registerFlag("WEBGL_PACK_NORMALIZATION",(function(){return MS.getBool("WEBGL_PACK")})),MS.registerFlag("WEBGL_PACK_CLIP",(function(){return MS.getBool("WEBGL_PACK")})),MS.registerFlag("WEBGL_PACK_DEPTHWISECONV",(function(){return MS.getBool("WEBGL_PACK")})),MS.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",(function(){return MS.getBool("WEBGL_PACK")})),MS.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",(function(){return MS.getBool("WEBGL_PACK")})),MS.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",(function(){return MS.getBool("WEBGL_PACK")})),MS.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",(function(){return MS.getBool("WEBGL_PACK")})),MS.registerFlag("WEBGL_PACK_REDUCE",(function(){return MS.getBool("WEBGL_PACK")})),MS.registerFlag("WEBGL_LAZILY_UNPACK",(function(){return MS.getBool("WEBGL_PACK")})),MS.registerFlag("WEBGL_CONV_IM2COL",(function(){return MS.getBool("WEBGL_PACK")})),MS.registerFlag("WEBGL_PACK_CONV2DTRANSPOSE",(function(){return MS.getBool("WEBGL_PACK")})),MS.registerFlag("WEBGL_MAX_TEXTURE_SIZE",(function(){return function(e){if(null==cS){var t=tS(e);cS=t.getParameter(t.MAX_TEXTURE_SIZE)}return cS}(MS.getNumber("WEBGL_VERSION"))})),MS.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",(function(){return function(e){if(null==lS){var t=tS(e);lS=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,lS)}(MS.getNumber("WEBGL_VERSION"))})),MS.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",(function(){var e=MS.getNumber("WEBGL_VERSION");return 0===e?0:function(e){if(0===e)return 0;var t=tS(e);return NS(t,"EXT_disjoint_timer_query_webgl2")&&2===e?2:NS(t,"EXT_disjoint_timer_query")?1:0}(e)})),MS.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",(function(){return MS.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&!ii.device_util.isMobile()})),MS.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",(function(){return function(e){if(0===e)return!1;var t=tS(e);if(1===e){if(!NS(t,"OES_texture_float"))return!1}else if(!NS(t,"EXT_color_buffer_float"))return!1;return DS(t)}(MS.getNumber("WEBGL_VERSION"))})),MS.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",(function(){return!MS.getBool("WEBGL_FORCE_F16_TEXTURES")&&MS.getBool("WEBGL_RENDER_FLOAT32_CAPABLE")})),MS.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",(function(){return IS(MS.getNumber("WEBGL_VERSION"))})),MS.registerFlag("WEBGL_FENCE_API_ENABLED",(function(){return 2===(e=MS.getNumber("WEBGL_VERSION"))&&null!=tS(e).fenceSync;var e})),MS.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",(function(){return MS.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0})),MS.registerFlag("WEBGL_DELETE_TEXTURE_THRESHOLD",(function(){return-1}),(function(e){if("number"!==typeof e)throw new Error("WEBGL_DELETE_TEXTURE_THRESHOLD must be a number but "+"got ".concat(e,"."));if(e<0&&-1!==e)throw new Error("WEBGL_DELETE_TEXTURE_THRESHOLD must be -1 (indicating never "+"delete) or at least 0, but got ".concat(e,"."))})),MS.registerFlag("WEBGL_FLUSH_THRESHOLD",(function(){return ii.device_util.isMobile()?1:-1}),(function(e){if("number"!==typeof e)throw new Error("WEBGL_FLUSH_THRESHOLD must be a number but got "+"".concat(e,"."));if(e<0&&-1!==e)throw new Error("WEBGL_FLUSH_THRESHOLD must be -1 (indicating never "+"manual flush) or at least 0, but got ".concat(e,"."))})),MS.registerFlag("CPU_HANDOFF_SIZE_THRESHOLD",(function(){return 128})),MS.registerFlag("WEBGL_USE_SHAPES_UNIFORMS",(function(){return!1})),MS.registerFlag("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD",(function(){return 1e5})),MS.registerFlag("TOPK_K_CPU_HANDOFF_THRESHOLD",(function(){return 128})),MS.registerFlag("WEBGL_EXP_CONV",(function(){return!1})),MS.registerFlag("SOFTWARE_WEBGL_ENABLED",(function(){return MS.getBool("IS_TEST")})),MS.registerFlag("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE",(function(){return 1/0})),MS.registerFlag("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE",(function(){return!1})),MS.registerFlag("WEBGL2_ISNAN_CUSTOM",(function(){return!1})),MS.registerFlag("ENGINE_COMPILE_ONLY",(function(){return!1}));var ZS="\n  const float FLOAT_MAX = 1.70141184e38;\n  const float FLOAT_MIN = 1.17549435e-38;\n\n  lowp vec4 encode_float(highp float v) {\n    if (isnan(v)) {\n      return vec4(255, 255, 255, 255);\n    }\n\n    highp float av = abs(v);\n\n    if(av < FLOAT_MIN) {\n      return vec4(0.0, 0.0, 0.0, 0.0);\n    } else if(v > FLOAT_MAX) {\n      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;\n    } else if(v < -FLOAT_MAX) {\n      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;\n    }\n\n    highp vec4 c = vec4(0,0,0,0);\n\n    highp float e = floor(log2(av));\n    highp float m = exp2(fract(log2(av))) - 1.0;\n\n    c[2] = floor(128.0 * m);\n    m -= c[2] / 128.0;\n    c[1] = floor(32768.0 * m);\n    m -= c[1] / 32768.0;\n    c[0] = floor(8388608.0 * m);\n\n    highp float ebias = e + 127.0;\n    c[3] = floor(ebias / 2.0);\n    ebias -= c[3] * 2.0;\n    c[2] += floor(ebias) * 128.0;\n\n    c[3] += 128.0 * step(0.0, -v);\n\n    return c / 255.0;\n  }\n",LS=ii.backend_util.getBroadcastDims;function PS(e,t,n){var r=[];if(e.forEach((function(e){var t=ii.util.sizeFromShape(e.shapeInfo.logicalShape);if(e.shapeInfo.isUniform?r.push("uniform float ".concat(e.name).concat(t>1?"[".concat(t,"]"):"",";")):(r.push("uniform sampler2D ".concat(e.name,";")),r.push("uniform int offset".concat(e.name,";"))),n.enableShapeUniforms){switch(oC(n.packedInputs,e.shapeInfo.logicalShape,e.shapeInfo.texShape).uniformShape.length){case 1:r.push("uniform int ".concat(e.name,"Shape;"));break;case 2:r.push("uniform ivec2 ".concat(e.name,"Shape;"));break;case 3:r.push("uniform ivec3 ".concat(e.name,"Shape;"));break;case 4:r.push("uniform ivec4 ".concat(e.name,"Shape;"))}r.push("uniform ivec2 ".concat(e.name,"TexShape;"))}})),n.enableShapeUniforms){switch(t.logicalShape.length){case 1:r.push("uniform int outShape;");break;case 2:r.push("uniform ivec2 outShape;"),r.push("uniform int outShapeStrides;");break;case 3:r.push("uniform ivec3 outShape;"),r.push("uniform ivec2 outShapeStrides;");break;case 4:r.push("uniform ivec4 outShape;"),r.push("uniform ivec3 outShapeStrides;")}r.push("uniform ivec2 outTexShape;")}n.customUniforms&&n.customUniforms.forEach((function(e){r.push("uniform ".concat(e.type," ").concat(e.name).concat(e.arrayIndex?"[".concat(e.arrayIndex,"]"):"",";"))}));var a,i,o=r.join("\n"),u=e.map((function(e){return function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3?arguments[3]:void 0,a="";a+=n?WS(e,r):US(e,r);var i=e.shapeInfo.logicalShape,o=t.logicalShape;i.length<=o.length&&(a+=n?rC(e,t):aC(e,t));return a}(e,t,n.packedInputs,n.enableShapeUniforms)})).join("\n"),s=t.texShape,c=OS(),l=function(e){return"\n    float sampleTexture(sampler2D textureSampler, vec2 uv) {\n      return ".concat(e.texture2D,"(textureSampler, uv).r;\n    }\n  ")}(c),f=function(e){return"".concat(e.version,"\n    precision highp float;\n    precision highp int;\n    precision highp sampler2D;\n    ").concat(e.varyingFs," vec2 resultUV;\n    ").concat(e.defineOutput,"\n    const vec2 halfCR = vec2(0.5, 0.5);\n\n    struct ivec5\n    {\n      int x;\n      int y;\n      int z;\n      int w;\n      int u;\n    };\n\n    struct ivec6\n    {\n      int x;\n      int y;\n      int z;\n      int w;\n      int u;\n      int v;\n    };\n\n    uniform float NAN;\n    ").concat(e.defineSpecialNaN,"\n    ").concat(e.defineSpecialInf,"\n    ").concat(e.defineRound,"\n\n    int imod(int x, int y) {\n      return x - y * (x / y);\n    }\n\n    int idiv(int a, int b, float sign) {\n      int res = a / b;\n      int mod = imod(a, b);\n      if (sign < 0. && mod != 0) {\n        res -= 1;\n      }\n      return res;\n    }\n\n    //Based on the work of Dave Hoskins\n    //https://www.shadertoy.com/view/4djSRW\n    #define HASHSCALE1 443.8975\n    float random(float seed){\n      vec2 p = resultUV * seed;\n      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);\n      p3 += dot(p3, p3.yzx + 19.19);\n      return fract((p3.x + p3.y) * p3.z);\n    }\n\n    ").concat(VS,"\n    ").concat(qS,"\n    ").concat(GS,"\n  ")}(c);return t.isPacked?(a=function(e,t,n){switch(e.length){case 0:return"\n    int getOutputCoords() {\n      return 0;\n    }\n  ";case 1:return function(e,t,n){var r=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)];if(1===r[0])return n?"\n      int getOutputCoords() {\n        return 2 * int(resultUV.x * ceil(float(outTexShape[1]) / 2.0));\n      }\n    ":"\n      int getOutputCoords() {\n        return 2 * int(resultUV.x * ".concat(r[1],".0);\n      }\n    ");if(1===r[1])return n?"\n      int getOutputCoords() {\n        return 2 * int(resultUV.y * ceil(float(outTexShape[0]) / 2.0));\n      }\n    ":"\n      int getOutputCoords() {\n        return 2 * int(resultUV.y * ".concat(r[0],".0);\n      }\n    ");if(n)return"\n    int getOutputCoords() {\n      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(packedTexShape[0], packedTexShape[1]));\n      return 2 * (resTexRC.x * packedTexShape[1] + resTexRC.y);\n    }\n  ";return"\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(r[0],", ").concat(r[1],"));\n      return 2 * (resTexRC.x * ").concat(r[1]," + resTexRC.y);\n    }\n  ")}(0,t,n);case 2:return function(e,t,n){var r=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)];if(ii.util.arraysEqual(e,t))return n?"\n      ivec2 getOutputCoords() {\n        ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n        return 2 * ivec2(resultUV.yx * vec2(packedTexShape[0], packedTexShape[1]));\n      }\n    ":"\n      ivec2 getOutputCoords() {\n        return 2 * ivec2(resultUV.yx * vec2(".concat(r[0],", ").concat(r[1],"));\n      }\n    ");var a=Math.ceil(e[1]/2);if(n)return"\n    ivec2 getOutputCoords() {\n      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n      int texelsInLogicalRow = int(ceil(float(outShape[1]) / 2.0));\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(packedTexShape[0], packedTexShape[1]));\n\n      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;\n      int r = 2 * (index / texelsInLogicalRow);\n      int c = imod(index, texelsInLogicalRow) * 2;\n\n      return ivec2(r, c);\n    }\n  ";return"\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(r[0],", ").concat(r[1],"));\n\n      int index = resTexRC.x * ").concat(r[1]," + resTexRC.y;\n      int r = 2 * (index / ").concat(a,");\n      int c = imod(index, ").concat(a,") * 2;\n\n      return ivec2(r, c);\n    }\n  ")}(e,t,n);case 3:return function(e,t,n){if(n)return"\n    ivec3 getOutputCoords() {\n      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n      int texelsInLogicalRow = int(ceil(float(outShape[2]) / 2.0));\n      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[1]) / 2.0));\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(packedTexShape[0], packedTexShape[1]));\n      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;\n\n      int b = index / texelsInBatch;\n      index -= b * texelsInBatch;\n\n      int r = 2 * (index / texelsInLogicalRow);\n      int c = imod(index, texelsInLogicalRow) * 2;\n\n      return ivec3(b, r, c);\n    }\n  ";var r=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)],a=Math.ceil(e[2]/2),i=a*Math.ceil(e[1]/2);return"\n    ivec3 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(r[0],", ").concat(r[1],"));\n      int index = resTexRC.x * ").concat(r[1]," + resTexRC.y;\n\n      int b = index / ").concat(i,";\n      index -= b * ").concat(i,";\n\n      int r = 2 * (index / ").concat(a,");\n      int c = imod(index, ").concat(a,") * 2;\n\n      return ivec3(b, r, c);\n    }\n  ")}(e,t,n);default:return function(e,t,n){if(n)return"\n    ivec4 getOutputCoords() {\n      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(packedTexShape[0], packedTexShape[1]));\n      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;\n\n      int texelsInLogicalRow = int(ceil(float(outShape[3]) / 2.0));\n      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[2]) / 2.0));\n      int texelsInBatchN = texelsInBatch * outShape[1];\n\n      int b2 = index / texelsInBatchN;\n      index -= b2 * texelsInBatchN;\n\n      int b = index / texelsInBatch;\n      index -= b * texelsInBatch;\n\n      int r = 2 * (index / texelsInLogicalRow);\n      int c = imod(index, texelsInLogicalRow) * 2;\n\n      return ivec4(b2, b, r, c);\n    }\n  ";for(var r=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)],a=Math.ceil(e[e.length-1]/2),i=a*Math.ceil(e[e.length-2]/2),o=i,u="",s="b, r, c",c=2;c<e.length-1;c++)o*=e[e.length-c-1],u="\n      int b".concat(c," = index / ").concat(o,";\n      index -= b").concat(c," * ").concat(o,";\n    ")+u,s="b".concat(c,", ")+s;return"\n    ivec".concat(e.length," getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(").concat(r[0],", ").concat(r[1],"));\n      int index = resTexRC.x * ").concat(r[1]," + resTexRC.y;\n\n      ").concat(u,"\n\n      int b = index / ").concat(i,";\n      index -= b * ").concat(i,";\n\n      int r = 2 * (index / ").concat(a,");\n      int c = imod(index, ").concat(a,") * 2;\n\n      return ivec").concat(e.length,"(").concat(s,");\n    }\n  ")}(e,t,n)}}(t.logicalShape,s,n.enableShapeUniforms),i=function(e){return"\n    void setOutput(vec4 val) {\n      ".concat(e.output," = val;\n    }\n  ")}(c)):(a=function(e,t,n){switch(e.length){case 0:return"\n    int getOutputCoords() {\n      return 0;\n    }\n  ";case 1:return function(e,t,n){if(1===t[0])return n?"\n      int getOutputCoords() {\n        return int(resultUV.x * float(outTexShape[1]));\n      }\n    ":"\n      int getOutputCoords() {\n        return int(resultUV.x * ".concat(t[1],".0);\n      }\n    ");if(1===t[1])return n?"\n      int getOutputCoords() {\n        return int(resultUV.y * float(outTexShape[0]));\n      }\n    ":"\n      int getOutputCoords() {\n        return int(resultUV.y * ".concat(t[0],".0);\n      }\n    ");if(n)return"\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(outTexShape[0], outTexShape[1]));\n      return resTexRC.x * outTexShape[1] + resTexRC.y;\n    }\n  ";return"\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(t[0],", ").concat(t[1],"));\n      return resTexRC.x * ").concat(t[1]," + resTexRC.y;\n    }\n  ")}(0,t,n);case 2:return function(e,t,n){if(ii.util.arraysEqual(e,t))return n?"\n      ivec2 getOutputCoords() {\n        return ivec2(resultUV.yx * vec2(outTexShape[0], outTexShape[1]));\n      }\n    ":"\n      ivec2 getOutputCoords() {\n        return ivec2(resultUV.yx * vec2(".concat(t[0],", ").concat(t[1],"));\n      }\n    ");if(1===e[1])return n?"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(outTexShape[0], outTexShape[1]));\n        int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n        return ivec2(index, 0);\n      }\n    ":"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(".concat(t[0],", ").concat(t[1],"));\n        int index = resTexRC.x * ").concat(t[1]," + resTexRC.y;\n        return ivec2(index, 0);\n      }\n    ");if(1===e[0])return n?"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(outTexShape[0], outTexShape[1]));\n        int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n        return ivec2(0, index);\n      }\n    ":"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(".concat(t[0],", ").concat(t[1],"));\n        int index = resTexRC.x * ").concat(t[1]," + resTexRC.y;\n        return ivec2(0, index);\n      }\n    ");if(n)return"\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(outTexShape[0], outTexShape[1]));\n      int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n      int r = index / outShape[1];\n      int c = index - r * outShape[1];\n      return ivec2(r, c);\n    }\n  ";return"\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(t[0],", ").concat(t[1],"));\n      int index = resTexRC.x * ").concat(t[1]," + resTexRC.y;\n      int r = index / ").concat(e[1],";\n      int c = index - r * ").concat(e[1],";\n      return ivec2(r, c);\n    }\n  ")}(e,t,n);case 3:return function(e,t,n){if(n){var r=jS(["r","c","d"],e);return"\n  ivec3 getOutputCoords() {\n    ivec2 resTexRC = ivec2(resultUV.yx *\n                           vec2(outTexShape[0], outTexShape[1]));\n    int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n    ".concat(r,"\n    return ivec3(r, c, d);\n  }\n")}var a=RS(["r","c","d"],e);return"\n    ivec3 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(t[0],", ").concat(t[1],"));\n      int index = resTexRC.x * ").concat(t[1]," + resTexRC.y;\n      ").concat(a,"\n      return ivec3(r, c, d);\n    }\n  ")}(e,t,n);case 4:return function(e,t,n){if(n){var r=jS(["r","c","d","d2"],e);return"\n    ivec4 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2(outTexShape[0], outTexShape[1]));\n      int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n      ".concat(r,"\n      return ivec4(r, c, d, d2);\n    }\n  ")}var a=RS(["r","c","d","d2"],e);return"\n    ivec4 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2(".concat(t[0],", ").concat(t[1],"));\n      int index = resTexRC.x * ").concat(t[1]," + resTexRC.y;\n      ").concat(a,"\n      return ivec4(r, c, d, d2);\n    }\n  ")}(e,t,n);case 5:return function(e,t){var n=RS(["r","c","d","d2","d3"],e);return"\n    ivec5 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx * vec2(".concat(t[0],",\n                             ").concat(t[1],"));\n\n      int index = resTexRC.x * ").concat(t[1]," + resTexRC.y;\n\n      ").concat(n,"\n\n      ivec5 outShape = ivec5(r, c, d, d2, d3);\n      return outShape;\n    }\n  ")}(e,t);case 6:return function(e,t){var n=RS(["r","c","d","d2","d3","d4"],e);return"\n    ivec6 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2(".concat(t[0],", ").concat(t[1],"));\n      int index = resTexRC.x * ").concat(t[1]," + resTexRC.y;\n\n      ").concat(n,"\n\n      ivec6 result = ivec6(r, c, d, d2, d3, d4);\n      return result;\n    }\n  ")}(e,t);default:throw new Error("".concat(e.length,"-D output sampling is not yet supported"))}}(t.logicalShape,s,n.enableShapeUniforms),i=function(e){return"\n    void setOutput(float val) {\n      ".concat(e.output," = vec4(val, 0, 0, 0);\n    }\n  ")}(c)),n.packedInputs&&(f+=HS),[f,l,i,o,a,u,n.userCode].join("\n")}function US(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=e.shapeInfo.logicalShape;switch(n.length){case 0:return KS(e,t);case 1:return YS(e,t);case 2:return $S(e,t);case 3:return QS(e,t);case 4:return JS(e,t);case 5:return eC(e);case 6:return tC(e);default:throw new Error("".concat(n.length,"-D input sampling")+" is not yet supported")}}function WS(e,t){switch(e.shapeInfo.logicalShape.length){case 0:return function(e){var t=e.name,n="get"+t.charAt(0).toUpperCase()+t.slice(1),r=OS();return"\n    vec4 ".concat(n,"() {\n      return ").concat(r.texture2D,"(").concat(t,", halfCR);\n    }\n  ")}(e);case 1:return function(e,t){var n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),a=e.shapeInfo.texShape,i=OS();if(t)return"\n    vec4 ".concat(r,"(int index) {\n      ivec2 packedTexShape = ivec2(ceil(float(").concat(n,"TexShape[0]) / 2.0), ceil(float(").concat(n,"TexShape[1]) / 2.0));\n      vec2 uv = packedUVfrom1D(\n        packedTexShape[0], packedTexShape[1], index);\n      return ").concat(i.texture2D,"(").concat(n,", uv);\n    }\n  ");var o=[Math.ceil(a[0]/2),Math.ceil(a[1]/2)];return"\n    vec4 ".concat(r,"(int index) {\n      vec2 uv = packedUVfrom1D(\n        ").concat(o[0],", ").concat(o[1],", index);\n      return ").concat(i.texture2D,"(").concat(n,", uv);\n    }\n  ")}(e,t);case 2:return function(e,t){var n=e.shapeInfo.logicalShape,r=e.name,a="get"+r.charAt(0).toUpperCase()+r.slice(1),i=e.shapeInfo.texShape,o=i[0],u=i[1],s=OS();if(null!=i&&ii.util.arraysEqual(n,i))return t?"\n      vec4 ".concat(a,"(int row, int col) {\n        vec2 uv = (vec2(col, row) + halfCR) / vec2(").concat(r,"TexShape[1], ").concat(r,"TexShape[0]);\n\n        return ").concat(s.texture2D,"(").concat(r,", uv);\n      }\n    "):"\n      vec4 ".concat(a,"(int row, int col) {\n        vec2 uv = (vec2(col, row) + halfCR) / vec2(").concat(u,".0, ").concat(o,".0);\n\n        return ").concat(s.texture2D,"(").concat(r,", uv);\n      }\n    ");if(t)return"\n    vec4 ".concat(a,"(int row, int col) {\n      ivec2 packedTexShape = ivec2(ceil(float(").concat(r,"TexShape[0]) / 2.0), ceil(float(").concat(r,"TexShape[1]) / 2.0));\n      int valuesPerRow = int(ceil(float(").concat(r,"Shape[1]) / 2.0));\n      vec2 uv = packedUVfrom2D(valuesPerRow, packedTexShape[0], packedTexShape[1], row, col);\n      return ").concat(s.texture2D,"(").concat(r,", uv);\n    }\n  ");var c=[Math.ceil(i[0]/2),Math.ceil(i[1]/2)],l=Math.ceil(n[1]/2);return"\n    vec4 ".concat(a,"(int row, int col) {\n      vec2 uv = packedUVfrom2D(").concat(l,", ").concat(c[0],", ").concat(c[1],", row, col);\n      return ").concat(s.texture2D,"(").concat(r,", uv);\n    }\n  ")}(e,t);case 3:return function(e,t){var n=e.shapeInfo.logicalShape,r=e.name,a="get"+r.charAt(0).toUpperCase()+r.slice(1),i=e.shapeInfo.texShape,o=[Math.ceil(i[0]/2),Math.ceil(i[1]/2)];if(1===n[0]){var u=[1,2],s=uC(e,n.slice(1)),c=["b","row","col"];return"\n        ".concat(WS(s,t),"\n        vec4 ").concat(a,"(int b, int row, int col) {\n          return ").concat(a,"(").concat(sC(c,u),");\n        }\n      ")}var l=OS();if(t)return"\n    vec4 ".concat(a,"(int b, int row, int col) {\n      ivec2 packedTexShape = ivec2(ceil(float(").concat(r,"TexShape[0]) / 2.0), ceil(float(").concat(r,"TexShape[1]) / 2.0));\n      int valuesPerRow = int(ceil(float(").concat(r,"Shape[2]) / 2.0));\n      int texelsInBatch = valuesPerRow * int(ceil(float(").concat(r,"Shape[1]) / 2.0));\n      vec2 uv = packedUVfrom3D(\n        packedTexShape[0], packedTexShape[1], texelsInBatch, valuesPerRow, b, row, col);\n      return ").concat(l.texture2D,"(").concat(r,", uv);\n    }\n  ");var f=o[0],d=o[1],h=Math.ceil(n[2]/2),p=h*Math.ceil(n[1]/2);return"\n    vec4 ".concat(a,"(int b, int row, int col) {\n      vec2 uv = packedUVfrom3D(\n        ").concat(f,", ").concat(d,", ").concat(p,", ").concat(h,", b, row, col);\n      return ").concat(l.texture2D,"(").concat(r,", uv);\n    }\n  ")}(e,t);default:return function(e,t){var n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),a=OS();if(t)return"\n    vec4 ".concat(r,"(int b2, int b, int row, int col) {\n      int valuesPerRow = int(ceil(float(").concat(n,"Shape[3]) / 2.0));\n      int texelsInBatch = valuesPerRow * int(ceil(float(").concat(n,"Shape[2]) / 2.0));\n      int index = b * texelsInBatch + (row / 2) * valuesPerRow + (col / 2);\n      texelsInBatch *= ").concat(n,"Shape[1];\n      index = b2 * texelsInBatch + index;\n      ivec2 packedTexShape = ivec2(ceil(float(").concat(n,"TexShape[0]) / 2.0), ceil(float(").concat(n,"TexShape[1]) / 2.0));\n      int texR = index / packedTexShape[1];\n      int texC = index - texR * packedTexShape[1];\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(packedTexShape[1], packedTexShape[0]); return ").concat(a.texture2D,"(").concat(n,", uv);\n    }\n  ");for(var i=e.shapeInfo.logicalShape,o=i.length,u=e.shapeInfo.texShape,s=[Math.ceil(u[0]/2),Math.ceil(u[1]/2)],c=s[0],l=s[1],f=Math.ceil(i[o-1]/2),d=f*Math.ceil(i[o-2]/2),h="int b, int row, int col",p="b * ".concat(d," + (row / 2) * ").concat(f," + (col / 2)"),v=2;v<o-1;v++)h="int b".concat(v,", ")+h,d*=i[o-v-1],p="b".concat(v," * ").concat(d," + ")+p;return"\n    vec4 ".concat(r,"(").concat(h,") {\n      int index = ").concat(p,";\n      int texR = index / ").concat(l,";\n      int texC = index - texR * ").concat(l,";\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(").concat(l,", ").concat(c,");\n      return ").concat(a.texture2D,"(").concat(n,", uv);\n    }\n  ")}(e,t)}}var VS="\nvec2 uvFromFlat(int texNumR, int texNumC, int index) {\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\nvec2 packedUVfrom1D(int texNumR, int texNumC, int index) {\n  int texelIndex = index / 2;\n  int texR = texelIndex / texNumC;\n  int texC = texelIndex - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",qS="\nvec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,\n  int texNumC, int row, int col) {\n  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);\n  int texR = texelIndex / texNumC;\n  int texC = texelIndex - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",GS="\nvec2 packedUVfrom3D(int texNumR, int texNumC,\n    int texelsInBatch, int texelsInLogicalRow, int b,\n    int row, int col) {\n  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",HS="\n  float getChannel(vec4 frag, vec2 innerDims) {\n    vec2 modCoord = mod(innerDims, 2.);\n    return modCoord.x == 0. ?\n      (modCoord.y == 0. ? frag.r : frag.g) :\n      (modCoord.y == 0. ? frag.b : frag.a);\n  }\n  float getChannel(vec4 frag, int dim) {\n    float modCoord = mod(float(dim), 2.);\n    return modCoord == 0. ? frag.r : frag.g;\n  }\n";function XS(e){return"offset".concat(e)}function KS(e,t){var n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1);if(e.shapeInfo.isUniform)return"float ".concat(r,"() {return ").concat(n,";}");var a=(0,C.Z)(e.shapeInfo.texShape,2),i=a[0],o=a[1];if(1===i&&1===o)return"\n      float ".concat(r,"() {\n        return sampleTexture(").concat(n,", halfCR);\n      }\n    ");var u=XS(n);if(t)return"\n    float ".concat(r,"() {\n      vec2 uv = uvFromFlat(").concat(n,"TexShape[0], ").concat(n,"TexShape[1], ").concat(u,");\n      return sampleTexture(").concat(n,", uv);\n    }\n  ");var s=(0,C.Z)(e.shapeInfo.texShape,2),c=s[0],l=s[1];return"\n    float ".concat(r,"() {\n      vec2 uv = uvFromFlat(").concat(c,", ").concat(l,", ").concat(u,");\n      return sampleTexture(").concat(n,", uv);\n    }\n  ")}function YS(e,t){var n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1);if(e.shapeInfo.isUniform)return"\n      float ".concat(r,"(int index) {\n        ").concat(nC(e),"\n      }\n    ");var a=e.shapeInfo.texShape,i=a[0],o=a[1];if(1===o&&1===i)return"\n      float ".concat(r,"(int index) {\n        return sampleTexture(").concat(n,", halfCR);\n      }\n    ");var u=XS(n);return 1===o?t?"\n      float ".concat(r,"(int index) {\n        vec2 uv = vec2(0.5, (float(index + ").concat(u,") + 0.5) / float(").concat(n,"TexShape[0]));\n        return sampleTexture(").concat(n,", uv);\n      }\n    "):"\n      float ".concat(r,"(int index) {\n        vec2 uv = vec2(0.5, (float(index + ").concat(u,") + 0.5) / ").concat(i,".0);\n        return sampleTexture(").concat(n,", uv);\n      }\n    "):1===i?t?"\n      float ".concat(r,"(int index) {\n        vec2 uv = vec2((float(index + ").concat(u,") + 0.5) / float(").concat(n,"TexShape[1]), 0.5);\n        return sampleTexture(").concat(n,", uv);\n      }\n    "):"\n      float ".concat(r,"(int index) {\n        vec2 uv = vec2((float(index + ").concat(u,") + 0.5) / ").concat(o,".0, 0.5);\n        return sampleTexture(").concat(n,", uv);\n      }\n    "):t?"\n    float ".concat(r,"(int index) {\n      vec2 uv = uvFromFlat(").concat(n,"TexShape[0], ").concat(n,"TexShape[1], index + ").concat(u,");\n      return sampleTexture(").concat(n,", uv);\n    }\n  "):"\n    float ".concat(r,"(int index) {\n      vec2 uv = uvFromFlat(").concat(i,", ").concat(o,", index + ").concat(u,");\n      return sampleTexture(").concat(n,", uv);\n    }\n  ")}function $S(e,t){var n=e.shapeInfo.logicalShape,r=e.name,a="get"+r.charAt(0).toUpperCase()+r.slice(1),i=e.shapeInfo.texShape;if(null!=i&&ii.util.arraysEqual(n,i)){if(t)return"\n      float ".concat(a,"(int row, int col) {\n        vec2 uv = (vec2(col, row) + halfCR) / vec2(").concat(r,"TexShape[1], ").concat(r,"TexShape[0]);\n        return sampleTexture(").concat(r,", uv);\n      }\n    ");var o=i[0],u=i[1];return"\n    float ".concat(a,"(int row, int col) {\n      vec2 uv = (vec2(col, row) + halfCR) / vec2(").concat(u,".0, ").concat(o,".0);\n      return sampleTexture(").concat(r,", uv);\n    }\n  ")}var s=ii.util.squeezeShape(n),c=s.newShape,l=s.keptDims,f=c;if(f.length<n.length){var d=uC(e,f);return"\n      ".concat(US(d,t),"\n      float ").concat(a,"(int row, int col) {\n        return ").concat(a,"(").concat(sC(["row","col"],l),");\n      }\n    ")}if(e.shapeInfo.isUniform)return"\n      float ".concat(a,"(int row, int col) {\n        int index = round(dot(vec2(row, col), vec2(").concat(n[1],", 1)));\n        ").concat(nC(e),"\n      }\n    ");var h=i[0],p=i[1],v=XS(r);return 1===p?t?"\n      float ".concat(a,"(int row, int col) {\n        float index = dot(vec3(row, col, ").concat(v,"), vec3(").concat(r,"Shape[1], 1, 1));\n        vec2 uv = vec2(0.5, (index + 0.5) / float(").concat(r,"TexShape[0]));\n        return sampleTexture(").concat(r,", uv);\n      }\n    "):"\n    float ".concat(a,"(int row, int col) {\n      float index = dot(vec3(row, col, ").concat(v,"), vec3(").concat(n[1],", 1, 1));\n      vec2 uv = vec2(0.5, (index + 0.5) / ").concat(h,".0);\n      return sampleTexture(").concat(r,", uv);\n    }\n  "):1===h?t?"\n      float ".concat(a,"(int row, int col) {\n        float index = dot(vec3(row, col, ").concat(v,"), vec3(").concat(r,"Shape[1], 1, 1));\n        vec2 uv = vec2((index + 0.5) / float(").concat(r,"TexShape[1]), 0.5);\n        return sampleTexture(").concat(r,", uv);\n      }\n    "):"\n    float ".concat(a,"(int row, int col) {\n      float index = dot(vec3(row, col, ").concat(v,"), vec3(").concat(n[1],", 1, 1));\n      vec2 uv = vec2((index + 0.5) / ").concat(p,".0, 0.5);\n      return sampleTexture(").concat(r,", uv);\n    }\n  "):t?"\n      float ".concat(a,"(int row, int col) {\n        // Explicitly use integer operations as dot() only works on floats.\n        int index = row * ").concat(r,"Shape[1] + col + ").concat(v,";\n        vec2 uv = uvFromFlat(").concat(r,"TexShape[0], ").concat(r,"TexShape[1], index);\n        return sampleTexture(").concat(r,", uv);\n      }\n    "):"\n  float ".concat(a,"(int row, int col) {\n    // Explicitly use integer operations as dot() only works on floats.\n    int index = row * ").concat(n[1]," + col + ").concat(v,";\n    vec2 uv = uvFromFlat(").concat(h,", ").concat(p,", index);\n    return sampleTexture(").concat(r,", uv);\n  }\n")}function QS(e,t){var n=e.shapeInfo.logicalShape,r=e.name,a="get"+r.charAt(0).toUpperCase()+r.slice(1),i=n[1]*n[2],o=n[2],u=ii.util.squeezeShape(n),s=u.newShape,c=u.keptDims,l=s;if(l.length<n.length){var f=uC(e,l);return"\n        ".concat(US(f,t),"\n        float ").concat(a,"(int row, int col, int depth) {\n          return ").concat(a,"(").concat(sC(["row","col","depth"],c),");\n        }\n      ")}if(e.shapeInfo.isUniform)return"\n      float ".concat(a,"(int row, int col, int depth) {\n        int index = round(dot(vec3(row, col, depth),\n                          vec3(").concat(i,", ").concat(o,", 1)));\n        ").concat(nC(e),"\n      }\n    ");var d=e.shapeInfo.texShape,h=d[0],p=d[1],v=e.shapeInfo.flatOffset;if(p===i&&null==v)return t?"\n      float ".concat(a,"(int row, int col, int depth) {\n        int stride1 = ").concat(r,"Shape[2];\n        float texR = float(row);\n        float texC = dot(vec2(col, depth), vec2(stride1, 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(").concat(r,"TexShape[1], ").concat(r,"TexShape[0]);\n        return sampleTexture(").concat(r,", uv);\n      }\n    "):"\n        float ".concat(a,"(int row, int col, int depth) {\n          float texR = float(row);\n          float texC = dot(vec2(col, depth), vec2(").concat(o,", 1));\n          vec2 uv = (vec2(texC, texR) + halfCR) /\n                     vec2(").concat(p,".0, ").concat(h,".0);\n          return sampleTexture(").concat(r,", uv);\n        }\n      ");if(p===o&&null==v)return t?"\n      float ".concat(a,"(int row, int col, int depth) {\n        float texR = dot(vec2(row, col), vec2(").concat(r,"Shape[1], 1));\n        float texC = float(depth);\n        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(").concat(r,"TexShape[1], ").concat(r,"TexShape[0]);\n        return sampleTexture(").concat(r,", uv);\n      }\n    "):"\n    float ".concat(a,"(int row, int col, int depth) {\n      float texR = dot(vec2(row, col), vec2(").concat(n[1],", 1));\n      float texC = float(depth);\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(").concat(p,".0, ").concat(h,".0);\n      return sampleTexture(").concat(r,", uv);\n    }\n  ");var m=XS(r);return t?"\n    float ".concat(a,"(int row, int col, int depth) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int stride0 = ").concat(r,"Shape[1] * ").concat(r,"Shape[2];\n      int stride1 = ").concat(r,"Shape[2];\n      int index = row * stride0 + col * stride1 + depth + ").concat(m,";\n      vec2 uv = uvFromFlat(").concat(r,"TexShape[0], ").concat(r,"TexShape[1], index);\n      return sampleTexture(").concat(r,", uv);\n    }\n    "):"\n      float ".concat(a,"(int row, int col, int depth) {\n        // Explicitly use integer operations as dot() only works on floats.\n        int index = row * ").concat(i," + col * ").concat(o," + depth + ").concat(m,";\n        vec2 uv = uvFromFlat(").concat(h,", ").concat(p,", index);\n        return sampleTexture(").concat(r,", uv);\n      }\n  ")}function JS(e,t){var n=e.shapeInfo.logicalShape,r=e.name,a="get"+r.charAt(0).toUpperCase()+r.slice(1),i=n[3],o=n[2]*i,u=n[1]*o,s=ii.util.squeezeShape(n),c=s.newShape,l=s.keptDims;if(c.length<n.length){var f=uC(e,c);return"\n      ".concat(US(f,t),"\n      float ").concat(a,"(int row, int col, int depth, int depth2) {\n        return ").concat(a,"(").concat(sC(["row","col","depth","depth2"],l),");\n      }\n    ")}if(e.shapeInfo.isUniform)return"\n      float ".concat(a,"(int row, int col, int depth, int depth2) {\n        int index = round(dot(vec4(row, col, depth, depth2),\n                          vec4(").concat(u,", ").concat(o,", ").concat(i,", 1)));\n        ").concat(nC(e),"\n      }\n    ");var d=e.shapeInfo.flatOffset,h=e.shapeInfo.texShape,p=h[0],v=h[1],m="int stride2 = ".concat(r,"Shape[3];"),g="int stride1 = ".concat(r,"Shape[2] * stride2;"),y="int stride0 = ".concat(r,"Shape[1] * stride1;");if(v===u&&null==d)return t?"\n      float ".concat(a,"(int row, int col, int depth, int depth2) {\n        ").concat(m,"\n        ").concat(g,"\n        float texR = float(row);\n        float texC =\n            dot(vec3(col, depth, depth2),\n                vec3(stride1, stride2, 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(").concat(r,"TexShape[1], ").concat(r,"TexShape[0]);\n        return sampleTexture(").concat(r,", uv);\n      }\n    "):"\n      float ".concat(a,"(int row, int col, int depth, int depth2) {\n        float texR = float(row);\n        float texC =\n            dot(vec3(col, depth, depth2),\n                vec3(").concat(o,", ").concat(i,", 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(").concat(v,".0, ").concat(p,".0);\n        return sampleTexture(").concat(r,", uv);\n      }\n    ");if(v===i&&null==d)return t?"\n      float ".concat(a,"(int row, int col, int depth, int depth2) {\n        float texR = dot(vec3(row, col, depth),\n                         vec3(").concat(r,"Shape[1] * ").concat(r,"Shape[2], ").concat(r,"Shape[2], 1));\n        float texC = float(depth2);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(").concat(r,"TexShape[1], ").concat(r,"TexShape[0]);\n        return sampleTexture(").concat(r,", uv);\n      }\n    "):"\n      float ".concat(a,"(int row, int col, int depth, int depth2) {\n        float texR = dot(vec3(row, col, depth),\n                         vec3(").concat(n[1]*n[2],", ").concat(n[2],", 1));\n        float texC = float(depth2);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(").concat(v,".0, ").concat(p,".0);\n        return sampleTexture(").concat(r,", uv);\n      }\n    ");var b=XS(r);return t?"\n    float ".concat(a,"(int row, int col, int depth, int depth2) {\n      // Explicitly use integer operations as dot() only works on floats.\n      ").concat(m,"\n      ").concat(g,"\n      ").concat(y,"\n      int index = row * stride0 + col * stride1 +\n          depth * stride2 + depth2;\n      vec2 uv = uvFromFlat(").concat(r,"TexShape[0], ").concat(r,"TexShape[1], index + ").concat(b,");\n      return sampleTexture(").concat(r,", uv);\n    }\n  "):"\n    float ".concat(a,"(int row, int col, int depth, int depth2) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * ").concat(u," + col * ").concat(o," +\n          depth * ").concat(i," + depth2;\n      vec2 uv = uvFromFlat(").concat(p,", ").concat(v,", index + ").concat(b,");\n      return sampleTexture(").concat(r,", uv);\n    }\n  ")}function eC(e){var t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),a=t[4],i=t[3]*a,o=t[2]*i,u=t[1]*o,s=ii.util.squeezeShape(t),c=s.newShape,l=s.keptDims;if(c.length<t.length){var f=uC(e,c);return"\n      ".concat(US(f),"\n      float ").concat(r,"(int row, int col, int depth, int depth2, int depth3) {\n        return ").concat(r,"(").concat(sC(["row","col","depth","depth2","depth3"],l),");\n      }\n    ")}if(e.shapeInfo.isUniform)return"\n      float ".concat(r,"(int row, int col, int depth, int depth2, int depth3) {\n        float index = dot(\n          vec4(row, col, depth, depth2),\n          vec4(").concat(u,", ").concat(o,", ").concat(i,", ").concat(a,")) +\n          depth3;\n        ").concat(nC(e),"\n      }\n    ");var d=e.shapeInfo.flatOffset,h=e.shapeInfo.texShape,p=h[0],v=h[1];if(v===u&&null==d)return"\n      float ".concat(r,"(int row, int col, int depth, int depth2, int depth3) {\n        int texR = row;\n        float texC = dot(vec4(col, depth, depth2, depth3),\n                         vec4(").concat(o,", ").concat(i,", ").concat(a,", 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(").concat(v,".0, ").concat(p,".0);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");if(v===a&&null==d)return"\n      float ".concat(r,"(int row, int col, int depth, int depth2, int depth3) {\n        float texR = dot(\n          vec4(row, col, depth, depth2),\n          vec4(").concat(t[1]*t[2]*t[3],",\n               ").concat(t[2]*t[3],", ").concat(t[3],", 1));\n        int texC = depth3;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(").concat(v,".0, ").concat(p,".0);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");var m=XS(n);return"\n    float ".concat(r,"(int row, int col, int depth, int depth2, int depth3) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * ").concat(u," + col * ").concat(o," + depth * ").concat(i," +\n          depth2 * ").concat(a," + depth3 + ").concat(m,";\n      vec2 uv = uvFromFlat(").concat(p,", ").concat(v,", index);\n      return sampleTexture(").concat(n,", uv);\n    }\n  ")}function tC(e){var t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),a=ii.util.squeezeShape(t),i=a.newShape,o=a.keptDims;if(i.length<t.length){var u=uC(e,i);return"\n      ".concat(US(u),"\n      float ").concat(r,"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        return ").concat(r,"(").concat(sC(["row","col","depth","depth2","depth3","depth4"],o),");\n      }\n    ")}var s=t[5],c=t[4]*s,l=t[3]*c,f=t[2]*l,d=t[1]*f;if(e.shapeInfo.isUniform)return"\n      float ".concat(r,"(int row, int col, int depth,\n                  int depth2, int depth3, int depth4) {\n        int index = round(dot(\n          vec4(row, col, depth, depth2),\n          vec4(").concat(d,", ").concat(f,", ").concat(l,", ").concat(c,")) +\n          dot(\n            vec2(depth3, depth4),\n            vec2(").concat(s,", 1)));\n        ").concat(nC(e),"\n      }\n    ");var h=e.shapeInfo.flatOffset,p=e.shapeInfo.texShape,v=p[0],m=p[1];if(m===d&&null==h)return"\n      float ".concat(r,"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        int texR = row;\n        float texC = dot(vec4(col, depth, depth2, depth3),\n          vec4(").concat(f,", ").concat(l,", ").concat(c,", ").concat(s,")) +\n               float(depth4);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(").concat(m,".0, ").concat(v,".0);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");if(m===s&&null==h)return"\n      float ".concat(r,"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        float texR = dot(vec4(row, col, depth, depth2),\n          vec4(").concat(t[1]*t[2]*t[3]*t[4],",\n               ").concat(t[2]*t[3]*t[4],",\n               ").concat(t[3]*t[4],",\n               ").concat(t[4],")) + float(depth3);\n        int texC = depth4;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(").concat(m,".0, ").concat(v,".0);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");var g=XS(n);return"\n    float ".concat(r,"(int row, int col, int depth,\n                  int depth2, int depth3, int depth4) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * ").concat(d," + col * ").concat(f," + depth * ").concat(l," +\n          depth2 * ").concat(c," + depth3 * ").concat(s," + depth4 + ").concat(g,";\n      vec2 uv = uvFromFlat(").concat(v,", ").concat(m,", index);\n      return sampleTexture(").concat(n,", uv);\n    }\n  ")}function nC(e){var t=e.name,n=ii.util.sizeFromShape(e.shapeInfo.logicalShape);return n<2?"return ".concat(t,";"):"\n    for (int i = 0; i < ".concat(n,"; i++) {\n      if (i == index) {\n        return ").concat(t,"[i];\n      }\n    }\n  ")}function rC(e,t){var n,r=e.name,a=r.charAt(0).toUpperCase()+r.slice(1),i="get"+a+"AtOutCoords",o=e.shapeInfo.logicalShape.length,u=t.logicalShape.length,s=LS(e.shapeInfo.logicalShape,t.logicalShape),c=iC(u),l=u-o,f=["x","y","z","w","u","v"];n=0===o?"":u<2&&s.length>=1?"coords = 0;":s.map((function(e){return"coords.".concat(f[e+l]," = 0;")})).join("\n");var d="";d=u<2&&o>0?"coords":e.shapeInfo.logicalShape.map((function(e,t){return"coords.".concat(f[t+l])})).join(", ");var h="return outputValue;",p=1===ii.util.sizeFromShape(e.shapeInfo.logicalShape),v=1===ii.util.sizeFromShape(t.logicalShape);if(1!==o||p||v){if(p&&!v)h=1===u?"\n        return vec4(outputValue.x, outputValue.x, 0., 0.);\n      ":"\n        return vec4(outputValue.x);\n      ";else if(s.length){var m=o-2,g=o-1;s.indexOf(m)>-1&&s.indexOf(g)>-1?h="return vec4(outputValue.x);":s.indexOf(m)>-1?h="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":s.indexOf(g)>-1&&(h="return vec4(outputValue.xx, outputValue.zz);")}}else h="\n      return vec4(outputValue.xy, outputValue.xy);\n    ";return"\n    vec4 ".concat(i,"() {\n      ").concat(c," coords = getOutputCoords();\n      ").concat(n,"\n      vec4 outputValue = get").concat(a,"(").concat(d,");\n      ").concat(h,"\n    }\n  ")}function aC(e,t){var n=e.name,r=n.charAt(0).toUpperCase()+n.slice(1),a="get"+r+"AtOutCoords",i=t.texShape,o=e.shapeInfo.texShape,u=e.shapeInfo.logicalShape.length,s=t.logicalShape.length;if(!e.shapeInfo.isUniform&&u===s&&null==e.shapeInfo.flatOffset&&ii.util.arraysEqual(o,i))return"\n      float ".concat(a,"() {\n        return sampleTexture(").concat(n,", resultUV);\n      }\n    ");var c,l=iC(s),f=LS(e.shapeInfo.logicalShape,t.logicalShape),d=s-u,h=["x","y","z","w","u","v"];c=0===u?"":s<2&&f.length>=1?"coords = 0;":f.map((function(e){return"coords.".concat(h[e+d]," = 0;")})).join("\n");var p="";return p=s<2&&u>0?"coords":e.shapeInfo.logicalShape.map((function(e,t){return"coords.".concat(h[t+d])})).join(", "),"\n    float ".concat(a,"() {\n      ").concat(l," coords = getOutputCoords();\n      ").concat(c,"\n      return get").concat(r,"(").concat(p,");\n    }\n  ")}function iC(e){if(e<=1)return"int";if(2===e)return"ivec2";if(3===e)return"ivec3";if(4===e)return"ivec4";if(5===e)return"ivec5";if(6===e)return"ivec6";throw Error("GPU for rank ".concat(e," is not yet supported"))}function oC(e,t,n){var r=ii.util.squeezeShape(t),a=r.newShape,i=r.keptDims,o=t.length,u=e&&3===o&&1===t[0],s=u?t.slice(1):a,c=!e&&o>1&&!ii.util.arraysEqual(t,n)&&a.length<o||u;return{useSqueezeShape:c,uniformShape:c?s:t,keptDims:i}}function uC(e,t){var n=JSON.parse(JSON.stringify(e));return n.shapeInfo.logicalShape=t,n}function sC(e,t){return t.map((function(t){return e[t]})).join(", ")}function cC(e,t,n,r){var a=n.map((function(e,n){var r={logicalShape:e.shape,texShape:e.isUniform?null:e.texData.texShape,isUniform:e.isUniform,isPacked:!e.isUniform&&e.texData.isPacked,flatOffset:null};return null!=e.texData&&null!=e.texData.slice&&e.texData.slice.flatOffset>0&&(r.flatOffset=e.texData.slice.flatOffset),{name:t.variableNames[n],shapeInfo:r}})),i=a.map((function(e){return e.shapeInfo})),o={logicalShape:r.shape,texShape:r.texData.texShape,isUniform:!1,isPacked:r.texData.isPacked,flatOffset:null},u=PS(a,o,t),s=function(e,t){var n=wS(e,(function(){return e.createShader(e.FRAGMENT_SHADER)}),"Unable to create fragment WebGLShader.");if(oS(e,(function(){return e.shaderSource(n,t)})),oS(e,(function(){return e.compileShader(n)})),(0,ii.env)().get("ENGINE_COMPILE_ONLY"))return n;if(!1===e.getShaderParameter(n,e.COMPILE_STATUS))throw dS(t,e.getShaderInfoLog(n)),new Error("Failed to compile fragment shader.");return n}(e.gl,u),c=e.createProgram(s);return(0,ii.env)().get("ENGINE_COMPILE_ONLY")?{program:t,fragmentShader:s,source:u,webGLProgram:c,inShapeInfos:i,outShapeInfo:o,variablesLocations:null,customUniformLocations:null,infLoc:null,nanLoc:null,outShapeLocation:null,outShapeStridesLocation:null,outTexShapeLocation:null}:(e.buildVao(c),Object.assign({program:t,fragmentShader:s,source:u,webGLProgram:c,inShapeInfos:i,outShapeInfo:o},lC(e,t,c)))}function lC(e,t,n){var r,a,i,o,u=[],s=[],c=null;o=e.getUniformLocation(n,"NAN",!1),1===(0,ii.env)().getNumber("WEBGL_VERSION")&&(c=e.getUniformLocation(n,"INFINITY",!1));var l,f=!1,d=(0,B.Z)(t.variableNames);try{for(d.s();!(l=d.n()).done;){var h=l.value,p={name:h,uniform:e.getUniformLocation(n,h,f),offset:e.getUniformLocation(n,"offset".concat(h),f)};t.enableShapeUniforms&&(p.shape=e.getUniformLocation(n,"".concat(h,"Shape"),f),p.texShape=e.getUniformLocation(n,"".concat(h,"TexShape"),f)),u.push(p)}}catch(y){d.e(y)}finally{d.f()}if(t.enableShapeUniforms&&(r=e.getUniformLocation(n,"outShape",f),i=e.getUniformLocation(n,"outShapeStrides",f),a=e.getUniformLocation(n,"outTexShape",f)),t.customUniforms){var v,m=(0,B.Z)(t.customUniforms);try{for(m.s();!(v=m.n()).done;){var g=v.value;s.push(e.getUniformLocation(n,g.name,f))}}catch(y){m.e(y)}finally{m.f()}}return{variablesLocations:u,customUniformLocations:s,infLoc:c,nanLoc:o,outShapeLocation:r,outShapeStridesLocation:i,outTexShapeLocation:a}}function fC(e,t){if(e.length!==t.length)throw Error("Binary was compiled with ".concat(e.length," inputs, but ")+"was executed with ".concat(t.length," inputs"));e.forEach((function(e,n){var r=e.logicalShape,a=t[n],i=a.shape;if(!ii.util.arraysEqual(r,i))throw Error("Binary was compiled with different shapes than "+"the current args. Shapes ".concat(r," and ").concat(i," must match"));if(!e.isUniform||!a.isUniform){var o=e.texShape,u=a.isUniform?null:a.texData.texShape;if(!ii.util.arraysEqual(o,u))throw Error("Binary was compiled with different texture shapes than the"+" current args. Shape ".concat(o," and ").concat(u," must match"))}}))}function dC(e,t,n,r,a){t.program.enableShapeUniforms||(fC(t.inShapeInfos,n),fC([t.outShapeInfo],[r]));var i=r.texData.texture,o=r.texData.texShape;r.texData.isPacked?e.setOutputPackedMatrixTexture(i.texture,o[0],o[1]):e.setOutputMatrixTexture(i.texture,o[0],o[1]),e.setProgram(t.webGLProgram),e.bindVertexArray(t.webGLProgram.vao),1===(0,ii.env)().getNumber("WEBGL_VERSION")&&null!==t.infLoc&&e.gl.uniform1f(t.infLoc,1/0),null!==t.nanLoc&&e.gl.uniform1f(t.nanLoc,NaN);for(var u=0;u<n.length;++u){var s=n[u],c=t.variablesLocations[u],l=c.uniform,f=c.offset,d=c.shape,h=c.texShape;if(d){var p=oC(t.program.packedInputs,s.shape,s.texData.texShape).uniformShape;switch(p.length){case 1:e.gl.uniform1iv(d,new Int32Array(p));break;case 2:e.gl.uniform2iv(d,new Int32Array(p));break;case 3:e.gl.uniform3iv(d,new Int32Array(p));break;case 4:e.gl.uniform4iv(d,new Int32Array(p))}}if(h&&e.gl.uniform2i(h,s.texData.texShape[0],s.texData.texShape[1]),null!=l)if(s.isUniform)if(ii.util.sizeFromShape(s.shape)<2)e.gl.uniform1f(l,s.uniformValues[0]);else{var v=s.uniformValues;v instanceof Float32Array||(v=new Float32Array(v)),e.gl.uniform1fv(l,v)}else null!=s.texData.slice&&null!=f&&e.gl.uniform1i(f,s.texData.slice.flatOffset),e.setInputMatrixTexture(s.texData.texture.texture,l,u)}var m=t.outShapeLocation;if(m)switch(r.shape.length){case 1:e.gl.uniform1iv(m,new Int32Array(r.shape));break;case 2:e.gl.uniform2iv(m,new Int32Array(r.shape));break;case 3:e.gl.uniform3iv(m,new Int32Array(r.shape));break;case 4:e.gl.uniform4iv(m,new Int32Array(r.shape))}if(t.outShapeStridesLocation){var g=ii.util.computeStrides(r.shape);switch(r.shape.length){case 2:e.gl.uniform1iv(t.outShapeStridesLocation,new Int32Array(g));break;case 3:e.gl.uniform2iv(t.outShapeStridesLocation,new Int32Array(g));break;case 4:e.gl.uniform3iv(t.outShapeStridesLocation,new Int32Array(g))}}if(t.outTexShapeLocation&&e.gl.uniform2i(t.outTexShapeLocation,r.texData.texShape[0],r.texData.texShape[1]),t.program.customUniforms&&a)for(var y=0;y<t.program.customUniforms.length;++y){var b=t.program.customUniforms[y],x=t.customUniformLocations[y],w=a[y];if("float"===b.type)e.gl.uniform1fv(x,w);else if("vec2"===b.type)e.gl.uniform2fv(x,w);else if("vec3"===b.type)e.gl.uniform3fv(x,w);else if("vec4"===b.type)e.gl.uniform4fv(x,w);else if("int"===b.type)e.gl.uniform1iv(x,w);else if("ivec2"===b.type)e.gl.uniform2iv(x,w);else if("ivec3"===b.type)e.gl.uniform3iv(x,w);else{if("ivec4"!==b.type)throw Error("uniform type ".concat(b.type," is not supported yet."));e.gl.uniform4iv(x,w)}}e.executeProgram()}function hC(e,t,n){var r="";t.concat(n).forEach((function(t){var a=null!=t.texData&&null!=t.texData.slice&&t.texData.slice.flatOffset>0;if(e.enableShapeUniforms&&!t.isUniform){var i=t.texData.texShape,o=oC(e.packedInputs,t.shape,i),u=o.useSqueezeShape,s=o.uniformShape,c=o.keptDims,l="",f="",d="";if(1===s.length&&e.packedInputs){var h=[Math.ceil(i[0]/2),Math.ceil(i[1]/2)];l="".concat(h[0]>1,"_").concat(h[1]>1)}else if(2!==s.length||e.packedInputs){if(s.length>2&&!e.packedInputs){var p=ii.util.computeStrides(s);d="".concat(p[0]===i[1],"_").concat(p[p.length-1]===i[1])}}else f="".concat(s[0]>1,"_").concat(s[1]>1);var v=t.shape.length,m=2===s.length&&ii.util.arraysEqual(t.shape,i),g=1===ii.util.sizeFromShape(t.shape),y=ii.backend_util.getBroadcastDims(t.shape,n.shape),b=!e.packedInputs&&v===n.shape.length&&ii.util.arraysEqual(i,n.texData.texShape),x=e.packedInputs||s.length>2?"":"".concat(i[0]>1,"_").concat(i[1]>1);r+="".concat(v,"_").concat(b,"_").concat(u?c:"","_").concat(s.length,"_").concat(g,"_").concat(y,"_").concat(m,"_").concat(l,"_").concat(f,"_").concat(d,"_").concat(x,"_").concat(a)}else{var w=t.isUniform?"uniform":t.texData.texShape;r+="".concat(t.shape,"_").concat(w,"_").concat(a)}}));var a=e.userCode,i=e.constructor.name;return i+="_"+r+"_"+a+"".concat((0,ii.env)().getNumber("WEBGL_VERSION"))}function pC(e){return(0,ii.env)().getBool("WEBGL_USE_SHAPES_UNIFORMS")&&e<=4}var vC=(0,F.Z)((function e(t){(0,D.Z)(this,e),this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=Y_.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];var n=OS();this.outputShape=t,this.enableShapeUniforms=pC(this.outputShape.length),this.userCode="\n      ivec3 outCoordsFromFlatIndex(int index) {\n        ".concat(this.enableShapeUniforms?jS(["r","c","d"],t):RS(["r","c","d"],t),"\n        return ivec3(r, c, d);\n      }\n\n      void main() {\n        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));\n        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);\n\n        vec4 result = vec4(0.);\n\n        for (int i=0; i<4; i++) {\n          int flatIndex = index + i;\n          ivec3 rc = outCoordsFromFlatIndex(flatIndex);\n          result[i] = getA(rc.x, rc.y, rc.z);\n        }\n\n        ").concat(n.output," = result;\n      }\n    ")})),mC=(0,F.Z)((function e(t){(0,D.Z)(this,e),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=Y_.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];var n=OS();this.outputShape=t,this.enableShapeUniforms=pC(this.outputShape.length),this.userCode="\n      ivec3 outCoordsFromFlatIndex(int index) {\n        ".concat(this.enableShapeUniforms?jS(["r","c","d"],t):RS(["r","c","d"],t),"\n        return ivec3(r, c, d);\n      }\n\n      void main() {\n        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));\n        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);\n\n        vec4 result = vec4(0.);\n\n        for (int i=0; i<4; i++) {\n          int flatIndex = index + i;\n          ivec3 rc = outCoordsFromFlatIndex(flatIndex);\n          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));\n        }\n\n        ").concat(n.output," = result;\n      }\n    ")})),gC=(0,F.Z)((function e(t){(0,D.Z)(this,e),this.variableNames=["A"],this.outTexUsage=$_.DOWNLOAD;var n=OS();this.outputShape=t,this.userCode="\n      ".concat(ZS,"\n\n      void main() {\n        float x = getAAtOutCoords();\n        ").concat(n.output," = encode_float(x);\n      }\n    ")})),yC=(0,F.Z)((function e(t){(0,D.Z)(this,e),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=$_.DOWNLOAD;var n=OS();this.outputShape=t,this.userCode="\n      ".concat(ZS,"\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));\n        ").concat(n.output," = encode_float(x);\n      }\n    ")})),bC={R:0,G:1,B:2,A:3},xC=(0,F.Z)((function e(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"RGBA";(0,D.Z)(this,e),this.variableNames=["A"],this.customUniforms=[{name:"texShape",type:"ivec2"}];var a=OS();this.outputShape=t,this.enableShapeUniforms=pC(this.outputShape.length);var i="result";n&&(i="floor(result * 255. + 0.5)");for(var o="",u=0;u<r.length;u++){var s=r[u];o+="\n          if(offset == ".concat(u,") {\n            result = values[").concat(bC[s],"];\n          }")}this.userCode="\n      ".concat(this.enableShapeUniforms?"\n  int getFlatIndex(ivec3 coords) {\n    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;\n  }\n":zS(t),"\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int flatIndex = getFlatIndex(coords);\n        float result = 0.;\n        int offset = imod(flatIndex, ").concat(r.length,");\n\n        flatIndex = idiv(flatIndex, ").concat(r.length,", 1.);\n\n        int r = flatIndex / texShape[1];\n        if (r < texShape[0]) {\n          int c = imod(flatIndex, texShape[1]);\n          vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);\n          vec4 values = ").concat(a.texture2D,"(A, uv);\n          ").concat(o,"\n        }\n        ").concat(a.output," = vec4(").concat(i,", 0., 0., 0.);\n      }\n    ")})),wC=(0,F.Z)((function e(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];(0,D.Z)(this,e),this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.customUniforms=[{name:"texShape",type:"ivec2"}];var r=OS();this.outputShape=t,this.enableShapeUniforms=pC(this.outputShape.length);var a="",i="result";n&&(i="floor(result * 255. + 0.5)");for(var o=0;o<=1;o++)for(var u=0;u<=1;u++){var s=2*o+u;a+="\n          localCoords = coords;\n          if(localCoords[2] + ".concat(u," < ").concat(this.enableShapeUniforms?"outShape[2]":"".concat(t[2]),") {\n          localCoords[2] += ").concat(u,";\n          if (localCoords[1] + ").concat(o," < ").concat(this.enableShapeUniforms?"outShape[1]":"".concat(t[1]),") {\n            localCoords[1] += ").concat(o,";\n\n            flatIndex = getFlatIndex(localCoords);\n            offset = imod(flatIndex, 4);\n\n            flatIndex = idiv(flatIndex, 4, 1.);\n\n            int r = flatIndex / texShape[1];\n            int c = imod(flatIndex, texShape[1]);\n            vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);\n            values = ").concat(r.texture2D,"(A, uv);\n\n            if (offset == 0) {\n              result[").concat(s,"] = values[0];\n            } else if (offset == 1) {\n              result[").concat(s,"] = values[1];\n            } else if (offset == 2) {\n              result[").concat(s,"] = values[2];\n            } else {\n              result[").concat(s,"] = values[3];\n            }\n          }\n        }\n        ")}this.userCode="\n        ".concat(this.enableShapeUniforms?"\n  int getFlatIndex(ivec3 coords) {\n    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;\n  }\n":zS(t),"\n\n        void main() {\n          ivec3 coords = getOutputCoords();\n\n          vec4 result = vec4(0.);\n          int flatIndex, r, c, offset;\n          ivec3 localCoords;\n          vec2 uv;\n          vec4 values;\n\n          ").concat(a,"\n\n          ").concat(r.output," = ").concat(i,";\n        }\n    ")}));function kC(e){var t=OS();return function(e,t){var n=wS(e,(function(){return e.createShader(e.VERTEX_SHADER)}),"Unable to create vertex WebGLShader.");if(oS(e,(function(){return e.shaderSource(n,t)})),oS(e,(function(){return e.compileShader(n)})),!1===e.getShaderParameter(n,e.COMPILE_STATUS))throw console.log(e.getShaderInfoLog(n)),new Error("Failed to compile vertex shader.");return n}(e,"".concat(t.version,"\n    precision highp float;\n    ").concat(t.attribute," vec3 clipSpacePos;\n    ").concat(t.attribute," vec2 uv;\n    ").concat(t.varyingVs," vec2 resultUV;\n\n    void main() {\n      gl_Position = vec4(clipSpacePos, 1);\n      resultUV = uv;\n    }"))}function _C(e){return function(e,t){var n=wS(e,(function(){return e.createBuffer()}),"Unable to create WebGLBuffer");return oS(e,(function(){return e.bindBuffer(e.ARRAY_BUFFER,n)})),oS(e,(function(){return e.bufferData(e.ARRAY_BUFFER,t,e.STATIC_DRAW)})),n}(e,new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]))}function SC(e){return function(e,t){var n=wS(e,(function(){return e.createBuffer()}),"Unable to create WebGLBuffer");return oS(e,(function(){return e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,n)})),oS(e,(function(){return e.bufferData(e.ELEMENT_ARRAY_BUFFER,t,e.STATIC_DRAW)})),n}(e,new Uint16Array([0,1,2,2,1,3]))}function CC(e,t,n,r,a,i){!function(e,t){var n=(0,ii.env)().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(e<=0||t<=0){var r="[".concat(e,"x").concat(t,"]");throw new Error("Requested texture size "+r+" is invalid.")}if(e>n||t>n){var a="[".concat(e,"x").concat(t,"]"),i="[".concat(n,"x").concat(n,"]");throw new Error("Requested texture size "+a+" greater than WebGL maximum on this browser / GPU "+i+".")}}(t,n);var o=function(e){return wS(e,(function(){return e.createTexture()}),"Unable to create WebGLTexture.")}(e),u=e.TEXTURE_2D;return oS(e,(function(){return e.bindTexture(u,o)})),oS(e,(function(){return e.texParameteri(u,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE)})),oS(e,(function(){return e.texParameteri(u,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE)})),oS(e,(function(){return e.texParameteri(u,e.TEXTURE_MIN_FILTER,e.NEAREST)})),oS(e,(function(){return e.texParameteri(u,e.TEXTURE_MAG_FILTER,e.NEAREST)})),1===(0,ii.env)().getNumber("WEBGL_VERSION")?oS(e,(function(){return e.texImage2D(u,0,r,t,n,0,a,i,null)})):oS(e,(function(){return e.texStorage2D(u,1,r,t,n)})),oS(e,(function(){return e.bindTexture(e.TEXTURE_2D,null)})),{texture:o,texShape:[n,t]}}function AC(e){return e.internalFormatFloat}function EC(e){return e.internalFormatHalfFloat}function NC(e){return e.downloadTextureFormat}function TC(e){return e.internalFormatPackedFloat}function IC(e){return e.internalFormatPackedHalfFloat}function DC(e,t,n,r,a,i,o,u){var s=e,c=new Float32Array(function(e,t){var n=aS(e,t),r=(0,C.Z)(n,2);return r[0]*r[1]*4}(i,o));return s.bindBuffer(s.PIXEL_PACK_BUFFER,t),s.getBufferSubData(s.PIXEL_PACK_BUFFER,0,c),s.bindBuffer(s.PIXEL_PACK_BUFFER,null),c}var FC=function(){function e(t){(0,D.Z)(this,e),this.outputTexture=null,this.program=null,this.disposed=!1,this.itemsToPoll=[];var n=(0,ii.env)().getNumber("WEBGL_VERSION");if(null!=t?(this.gl=t,function(e,t){J_[e]=t}(n,t)):this.gl=tS(n),t=this.gl,2===(0,ii.env)().getNumber("WEBGL_VERSION")){var r=t;this.createVertexArray=function(){return oS(r,(function(){return r.createVertexArray()}))},this.bindVertexArray=function(e){return oS(r,(function(){return r.bindVertexArray(e)}))},this.deleteVertexArray=function(e){return oS(r,(function(){return r.deleteVertexArray(e)}))},this.getVertexArray=function(){return oS(r,(function(){return r.getParameter(r.VERTEX_ARRAY_BINDING)}))}}else if(null!=t){var a=t.getExtension("OES_vertex_array_object");if(null==a)throw new Error("All WebGL1 implementations are expected to offer OES_vertex_array_object.");this.createVertexArray=function(){return oS(t,(function(){return a.createVertexArrayOES()}))},this.bindVertexArray=function(e){return oS(t,(function(){return a.bindVertexArrayOES(e)}))},this.deleteVertexArray=function(e){return oS(t,(function(){return a.deleteVertexArrayOES(e)}))},this.getVertexArray=function(){return oS(t,(function(){return t.getParameter(a.VERTEX_ARRAY_BINDING_OES)}))}}var i="WEBGL_color_buffer_float",o="EXT_color_buffer_half_float";if(this.parallelCompilationExtension=this.gl.getExtension("KHR_parallel_shader_compile"),1===(0,ii.env)().getNumber("WEBGL_VERSION")){var u="OES_texture_half_float";if(this.textureFloatExtension=sS(this.gl,"OES_texture_float"),NS(this.gl,u))this.textureHalfFloatExtension=sS(this.gl,u);else if((0,ii.env)().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(i),NS(this.gl,o))this.colorBufferHalfFloatExtension=sS(this.gl,o);else if((0,ii.env)().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(i="EXT_color_buffer_float",NS(this.gl,i))this.colorBufferFloatExtension=this.gl.getExtension(i);else{if(!NS(this.gl,o))throw new Error("GL context does not support color renderable floats");this.colorBufferHalfFloatExtension=this.gl.getExtension(o)}this.vertexBuffer=_C(this.gl),this.indexBuffer=SC(this.gl),this.framebuffer=function(e){return wS(e,(function(){return e.createFramebuffer()}),"Unable to create WebGLFramebuffer.")}(this.gl),this.textureConfig=iS(this.gl,this.textureHalfFloatExtension)}return(0,F.Z)(e,[{key:"debug",get:function(){return(0,ii.env)().getBool("DEBUG")}},{key:"dispose",value:function(){var e=this;if(!this.disposed){null!=this.program&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),null!=this.outputTexture&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");var t=this.gl;oS(t,(function(){return t.finish()})),oS(t,(function(){return t.bindFramebuffer(t.FRAMEBUFFER,null)})),oS(t,(function(){return t.deleteFramebuffer(e.framebuffer)})),oS(t,(function(){return t.bindBuffer(t.ARRAY_BUFFER,null)})),oS(t,(function(){return t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,null)})),oS(t,(function(){return t.deleteBuffer(e.indexBuffer)})),this.disposed=!0}}},{key:"createFloat32MatrixTexture",value:function(e,t){return this.throwIfDisposed(),function(e,t,n,r){var a=nS(t,n),i=(0,C.Z)(a,2);return CC(e,i[0],i[1],AC(r),r.textureFormatFloat,e.FLOAT)}(this.gl,e,t,this.textureConfig)}},{key:"createFloat16MatrixTexture",value:function(e,t){return this.throwIfDisposed(),function(e,t,n,r){var a=nS(t,n),i=(0,C.Z)(a,2);return CC(e,i[0],i[1],EC(r),r.textureFormatFloat,r.textureTypeHalfFloat)}(this.gl,e,t,this.textureConfig)}},{key:"createUnsignedBytesMatrixTexture",value:function(e,t){return this.throwIfDisposed(),function(e,t,n,r){var a=nS(t,n),i=(0,C.Z)(a,2);return CC(e,i[0],i[1],NC(r),e.RGBA,e.UNSIGNED_BYTE)}(this.gl,e,t,this.textureConfig)}},{key:"uploadPixelDataToTexture",value:function(e,t){this.throwIfDisposed(),function(e,t,n){oS(e,(function(){return e.bindTexture(e.TEXTURE_2D,t)})),n.data instanceof Uint8Array?2===(0,ii.env)().getNumber("WEBGL_VERSION")?oS(e,(function(){return e.texSubImage2D(e.TEXTURE_2D,0,0,0,n.width,n.height,e.RGBA,e.UNSIGNED_BYTE,n.data)})):oS(e,(function(){return e.texImage2D(e.TEXTURE_2D,0,e.RGBA,n.width,n.height,0,e.RGBA,e.UNSIGNED_BYTE,n.data)})):2===(0,ii.env)().getNumber("WEBGL_VERSION")?oS(e,(function(){return e.texSubImage2D(e.TEXTURE_2D,0,0,0,e.RGBA,e.UNSIGNED_BYTE,n)})):oS(e,(function(){return e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,n)})),oS(e,(function(){return e.bindTexture(e.TEXTURE_2D,null)}))}(this.gl,e,t)}},{key:"uploadDenseMatrixToTexture",value:function(e,t,n,r){this.throwIfDisposed(),function(e,t,n,r,a,i){var o,u,s;oS(e,(function(){return e.bindTexture(e.TEXTURE_2D,t)})),a instanceof Uint8Array?(o=new Uint8Array(n*r*4),u=e.UNSIGNED_BYTE,s=e.RGBA):(o=new Float32Array(n*r*4),u=e.FLOAT,s=i.internalFormatPackedFloat),o.set(a),2===(0,ii.env)().getNumber("WEBGL_VERSION")?oS(e,(function(){return e.texSubImage2D(e.TEXTURE_2D,0,0,0,n,r,e.RGBA,u,o)})):oS(e,(function(){return e.texImage2D(e.TEXTURE_2D,0,s,n,r,0,e.RGBA,u,o)})),oS(e,(function(){return e.bindTexture(e.TEXTURE_2D,null)}))}(this.gl,e,t,n,r,this.textureConfig)}},{key:"createFloat16PackedMatrixTexture",value:function(e,t){return this.throwIfDisposed(),function(e,t,n,r){var a=aS(t,n),i=(0,C.Z)(a,2);return CC(e,i[0],i[1],IC(r),e.RGBA,r.textureTypeHalfFloat)}(this.gl,e,t,this.textureConfig)}},{key:"createPackedMatrixTexture",value:function(e,t){return this.throwIfDisposed(),function(e,t,n,r){var a=aS(t,n),i=(0,C.Z)(a,2);return CC(e,i[0],i[1],TC(r),e.RGBA,e.FLOAT)}(this.gl,e,t,this.textureConfig)}},{key:"deleteMatrixTexture",value:function(e){var t=this;this.throwIfDisposed(),this.outputTexture===e&&(bS(this.gl,this.framebuffer),this.outputTexture=null),oS(this.gl,(function(){return t.gl.deleteTexture(e)}))}},{key:"downloadByteEncodedFloatMatrixFromOutputTexture",value:function(e,t,n){var r=this;return this.downloadMatrixDriver(e,(function(){return function(e,t,n,r){var a=nS(t,n),i=(0,C.Z)(a,2),o=i[0],u=i[1],s=new Uint8Array(t*n*4);return oS(e,(function(){return e.readPixels(0,0,o,u,r.downloadTextureFormat,e.UNSIGNED_BYTE,s)})),new Float32Array(s.buffer)}(r.gl,t,n,r.textureConfig)}))}},{key:"downloadPackedMatrixFromBuffer",value:function(e,t,n,r,a,i){return DC(this.gl,e,0,0,0,a,i,this.textureConfig)}},{key:"downloadFloat32MatrixFromBuffer",value:function(e,t){return function(e,t,n){var r=e,a=new Float32Array(n);return r.bindBuffer(r.PIXEL_PACK_BUFFER,t),r.getBufferSubData(r.PIXEL_PACK_BUFFER,0,a),r.bindBuffer(r.PIXEL_PACK_BUFFER,null),a}(this.gl,e,t)}},{key:"createBufferFromTexture",value:function(e,t,n){this.bindTextureToFrameBuffer(e);var r=function(e,t,n,r){var a=e.createBuffer();oS(e,(function(){return e.bindBuffer(e.PIXEL_PACK_BUFFER,a)}));var i=16*t*n;return oS(e,(function(){return e.bufferData(e.PIXEL_PACK_BUFFER,i,e.STREAM_READ)})),oS(e,(function(){return e.readPixels(0,0,n,t,e.RGBA,e.FLOAT,0)})),oS(e,(function(){return e.bindBuffer(e.PIXEL_PACK_BUFFER,null)})),a}(this.gl,t,n,this.textureConfig);return this.unbindTextureToFrameBuffer(),r}},{key:"createAndWaitForFence",value:function(){var e=this.createFence(this.gl);return this.pollFence(e)}},{key:"createFence",value:function(e){var t,n,r=this;if((0,ii.env)().getBool("WEBGL_FENCE_API_ENABLED")){var a=e,i=a.fenceSync(a.SYNC_GPU_COMMANDS_COMPLETE,0);e.flush(),n=function(){var e=a.clientWaitSync(i,0,0);return e===a.ALREADY_SIGNALED||e===a.CONDITION_SATISFIED},t=i}else(0,ii.env)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(t=this.beginQuery(),this.endQuery(),n=function(){return r.isQueryAvailable(t,(0,ii.env)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}):n=function(){return!0};return{query:t,isFencePassed:n}}},{key:"downloadMatrixFromPackedTexture",value:function(e,t,n){var r=this;return this.downloadMatrixDriver(e,(function(){return function(e,t,n){var r=new Float32Array(t*n*4);return oS(e,(function(){return e.readPixels(0,0,n,t,e.RGBA,e.FLOAT,r)})),r}(r.gl,t,n)}))}},{key:"createProgram",value:function(e){var t=this;this.throwIfDisposed();var n=this.gl;null==this.vertexShader&&(this.vertexShader=kC(n));var r=function(e){return wS(e,(function(){return e.createProgram()}),"Unable to create WebGLProgram.")}(n);oS(n,(function(){return n.attachShader(r,t.vertexShader)})),oS(n,(function(){return n.attachShader(r,e)})),function(e,t){if(oS(e,(function(){return e.linkProgram(t)})),!(0,ii.env)().get("ENGINE_COMPILE_ONLY")&&!1===e.getProgramParameter(t,e.LINK_STATUS))throw console.log(e.getProgramInfoLog(t)),new Error("Failed to link vertex and fragment shaders.")}(n,r);var a=Object.assign(r,{vao:this.createVertexArray()});return this.debug&&hS(n,a),a}},{key:"buildVao",value:function(e){var t=this;this.setProgram(e),this.bindVertexArray(e.vao);var n=this.gl;oS(n,(function(){return n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,t.indexBuffer)})),function(e,t,n){oS(e,(function(){return e.bindBuffer(e.ARRAY_BUFFER,n)})),pS(e,t,"clipSpacePos",n,3,20,0)&&pS(e,t,"uv",n,2,20,12)}(n,e,this.vertexBuffer)}},{key:"deleteProgram",value:function(e){var t=this;this.throwIfDisposed(),e===this.program&&(this.program=null),null!=e&&(oS(this.gl,(function(){return t.gl.deleteProgram(e)})),this.deleteVertexArray(e.vao))}},{key:"setProgram",value:function(e){var t=this;this.throwIfDisposed(),this.program=e,null!=this.program&&this.debug&&hS(this.gl,this.program),oS(this.gl,(function(){return t.gl.useProgram(e)}))}},{key:"getUniformLocation",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return this.throwIfDisposed(),n?vS(this.gl,e,t):mS(this.gl,e,t)}},{key:"getAttributeLocation",value:function(e,t){var n=this;return this.throwIfDisposed(),oS(this.gl,(function(){return n.gl.getAttribLocation(e,t)}))}},{key:"getUniformLocationNoThrow",value:function(e,t){return this.throwIfDisposed(),this.gl.getUniformLocation(e,t)}},{key:"setInputMatrixTexture",value:function(e,t,n){this.throwIfDisposed(),this.throwIfNoProgram(),gS(this.gl,e,t,n)}},{key:"setOutputMatrixTexture",value:function(e,t,n){this.setOutputMatrixTextureDriver(e,n,t)}},{key:"setOutputPackedMatrixTexture",value:function(e,t,n){this.throwIfDisposed();var r=aS(t,n),a=(0,C.Z)(r,2),i=a[0],o=a[1];this.setOutputMatrixTextureDriver(e,i,o)}},{key:"setOutputMatrixWriteRegion",value:function(e,t,n,r){this.setOutputMatrixWriteRegionDriver(n,e,r,t)}},{key:"setOutputPackedMatrixWriteRegion",value:function(e,t,n,r){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")}},{key:"debugValidate",value:function(){null!=this.program&&hS(this.gl,this.program),xS(this.gl)}},{key:"executeProgram",value:function(){this.throwIfDisposed(),this.throwIfNoProgram();var e=this.gl;if(this.debug){var t=this.getVertexArray();console.assert(t===this.program.vao,"VAO changed between setProgram and executeProgram!"),this.debugValidate()}oS(e,(function(){return e.drawElements(e.TRIANGLES,6,e.UNSIGNED_SHORT,0)}))}},{key:"blockUntilAllProgramsCompleted",value:function(){var e=this;this.throwIfDisposed(),oS(this.gl,(function(){return e.gl.finish()}))}},{key:"getQueryTimerExtension",value:function(){return null==this.disjointQueryTimerExtension&&(this.disjointQueryTimerExtension=sS(this.gl,2===(0,ii.env)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension}},{key:"getQueryTimerExtensionWebGL2",value:function(){return this.getQueryTimerExtension()}},{key:"getQueryTimerExtensionWebGL1",value:function(){return this.getQueryTimerExtension()}},{key:"beginQuery",value:function(){if(2===(0,ii.env)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")){var e=this.gl,t=this.getQueryTimerExtensionWebGL2(),n=e.createQuery();return e.beginQuery(t.TIME_ELAPSED_EXT,n),n}var r=this.getQueryTimerExtensionWebGL1(),a=r.createQueryEXT();return r.beginQueryEXT(r.TIME_ELAPSED_EXT,a),a}},{key:"endQuery",value:function(){if(2!==(0,ii.env)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")){var e=this.getQueryTimerExtensionWebGL1();e.endQueryEXT(e.TIME_ELAPSED_EXT)}else{var t=this.gl,n=this.getQueryTimerExtensionWebGL2();t.endQuery(n.TIME_ELAPSED_EXT)}}},{key:"waitForQueryAndGetTime",value:function(){var e=(0,Da.Z)(E().mark((function e(t){var n=this;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ii.util.repeatedTry((function(){return n.disposed||n.isQueryAvailable(t,(0,ii.env)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}));case 2:return e.abrupt("return",this.getQueryTime(t,(0,ii.env)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getQueryTime",value:function(e,t){if(0===t)return null;if(2===t){var n=this.gl;return n.getQueryParameter(e,n.QUERY_RESULT)/1e6}var r=this.getQueryTimerExtensionWebGL1();return r.getQueryObjectEXT(e,r.QUERY_RESULT_EXT)/1e6}},{key:"isQueryAvailable",value:function(e,t){if(0===t)return!0;if(2===t){var n=this.gl,r=this.getQueryTimerExtensionWebGL2(),a=n.getQueryParameter(e,n.QUERY_RESULT_AVAILABLE);return null==this.disjoint&&(this.disjoint=this.gl.getParameter(r.GPU_DISJOINT_EXT)),a&&!this.disjoint}var i=this.getQueryTimerExtensionWebGL1(),o=i.getQueryObjectEXT(e,i.QUERY_RESULT_AVAILABLE_EXT);return null==this.disjoint&&(this.disjoint=this.gl.getParameter(i.GPU_DISJOINT_EXT)),o&&!this.disjoint}},{key:"pollFence",value:function(e){var t=this;return new Promise((function(n){t.addItemToPoll((function(){return e.isFencePassed()}),(function(){return n()}))}))}},{key:"pollItems",value:function(){for(var e=function(e){for(var t=0;t<e.length;++t){if(!e[t]())break}return t-1}(this.itemsToPoll.map((function(e){return e.isDoneFn}))),t=0;t<=e;++t){(0,this.itemsToPoll[t].resolveFn)()}this.itemsToPoll=this.itemsToPoll.slice(e+1)}},{key:"addItemToPoll",value:function(e,t){var n=this;if(this.itemsToPoll.push({isDoneFn:e,resolveFn:t}),!(this.itemsToPoll.length>1)){var r=void 0;"setTimeoutCustom"in(0,ii.env)().platform&&(r=(0,ii.env)().platform.setTimeoutCustom.bind((0,ii.env)().platform)),ii.util.repeatedTry((function(){return n.pollItems(),0===n.itemsToPoll.length}),(function(){return 0}),null,r)}}},{key:"bindTextureToFrameBuffer",value:function(e){this.throwIfDisposed(),yS(this.gl,e,this.framebuffer),this.debug&&xS(this.gl)}},{key:"unbindTextureToFrameBuffer",value:function(){null!=this.outputTexture?(yS(this.gl,this.outputTexture,this.framebuffer),this.debug&&xS(this.gl)):bS(this.gl,this.framebuffer)}},{key:"downloadMatrixDriver",value:function(e,t){this.bindTextureToFrameBuffer(e);var n=t();return this.unbindTextureToFrameBuffer(),n}},{key:"setOutputMatrixTextureDriver",value:function(e,t,n){this.throwIfDisposed();var r=this.gl;yS(r,e,this.framebuffer),this.debug&&xS(r),this.outputTexture=e,oS(r,(function(){return r.viewport(0,0,t,n)})),oS(r,(function(){return r.scissor(0,0,t,n)}))}},{key:"setOutputMatrixWriteRegionDriver",value:function(e,t,n,r){var a=this;this.throwIfDisposed(),oS(this.gl,(function(){return a.gl.scissor(e,t,n,r)}))}},{key:"throwIfDisposed",value:function(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")}},{key:"throwIfNoProgram",value:function(){if(null==this.program)throw new Error("No GPU program is currently set.")}}]),e}();var MC=Hg,OC=Zy,RC=Ly,jC=Uy,BC=Ug,zC=Gy,ZC=Qy,LC=jb,PC=Hb,UC=Qb,WC=vx,VC=_x,qC=Cx,GC=Ex,HC=Ix,XC=Lx,KC=Wx,YC=Gx,$C=Xx,QC=cw,JC=dw,eA=kw,tA=Nb,nA=Fw,rA=Lw,aA=Jw,iA=ak,oA=uk,uA=hk,sA=vk,cA=Ek,lA=Ik,fA=Mg,dA=ny,hA=Ry,pA=Yk,vA=Qk,mA=e_,gA=i_,yA=d_,bA=g_,xA=x_,wA=__,kA=C_,_A=ax,SA=F_,CA=j_,AA=cy,EA=W_;function NA(e,t){return["x","y","z","w","u","v"].slice(0,t).map((function(t){return"".concat(e,".").concat(t)}))}function TA(e,t){return 1===t?[e]:NA(e,t)}var IA=function(){function e(t){if((0,D.Z)(this,e),this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=t,this.rank=t.length,this.enableShapeUniforms=pC(this.outputShape.length),0===this.rank)this.userCode="\n        void main() {\n          setOutput(vec4(getA(), 0., 0., 0.));\n        }\n      ";else{var n=TA("rc",this.rank),r=iC(this.rank),a=this.getOutOfBoundsCondition(n),i=this.getSetup(n),o=this.getOutput(n);this.userCode="\n        void main() {\n          ".concat(r," rc = getOutputCoords();\n\n          if(").concat(a,") {\n            setOutput(vec4(0));\n          } else {\n            ").concat(i,"\n\n            setOutput(vec4(").concat(o,"));\n          }\n        }\n      ")}}return(0,F.Z)(e,[{key:"getSourceCoordsArr",value:function(e){for(var t=[],n=0;n<=1;n++)for(var r=0;r<=1;r++){for(var a="".concat(0===n?"r":"rp1",", ").concat(0===r?"c":"cp1"),i=2;i<this.rank;i++)a="".concat(e[e.length-1-i],",")+a;t.push(a)}return t}},{key:"getOutOfBoundsCondition",value:function(e){if(1===this.rank)return"rc > ".concat(this.enableShapeUniforms?"outShape":this.outputShape[0]);for(var t="",n=this.rank-2;n<this.rank;n++)t+="".concat(e[n]," >= ").concat(this.enableShapeUniforms?"outShape[".concat(n,"]"):this.outputShape[n]),n<this.rank-1&&(t+="||");return t}},{key:"getSetup",value:function(e){if(1===this.rank)return"";var t=e.slice(-2),n=this.enableShapeUniforms?"outShape[".concat(this.rank," - 1]"):this.outputShape[this.rank-1],r=this.enableShapeUniforms?"outShape[".concat(this.rank," - 2]"):this.outputShape[this.rank-2];return"\n      int r = ".concat(t[0],";\n      int c = ").concat(t[1],";\n      int rp1 = r + 1;\n      int cp1 = c + 1;\n\n      bool cEdge = cp1 >= ").concat(n,";\n      bool rEdge = rp1 >= ").concat(r,";\n    ")}},{key:"getOutput",value:function(e){var t=this.getSourceCoordsArr(e);if(1===this.rank){var n=this.enableShapeUniforms?"outShape":this.outputShape[0];return"getA(rc), (rc + 1 >= ".concat(n," ? 0. : getA(rc + 1)), 0, 0")}return"getA(".concat(t[0],"),\n            cEdge ? 0. : getA(").concat(t[1],"),\n            rEdge ? 0. : getA(").concat(t[2],"),\n            rEdge || cEdge ? 0. : getA(").concat(t[3],")")}}]),e}(),DA=(0,F.Z)((function e(t,n){(0,D.Z)(this,e),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec3"}],this.outputShape=t,this.enableShapeUniforms=pC(this.outputShape.length);for(var r="",a=0;a<4;a++){var i="thisRC = rc;";a%2===1&&(i+="thisRC.z += 1;"),a>1&&(i+="thisRC.y += 1;"),r+="\n        ".concat(i,"\n        ").concat(a>0?"if(thisRC.y < rows && thisRC.z < cols){":"","\n          int flatIndex = getFlatIndex(thisRC);\n\n          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);\n          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));\n\n          result[").concat(a,"] =\n            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);\n        ").concat(a>0?"}":"","\n      ")}this.userCode="\n      ".concat(function(e,t){var n=t?function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"index",r=e.map((function(e,t){return t})),a=BS(r,t);return a.map((function(t,r){var i="int ".concat(e[r]," = ").concat(n," / ").concat(a[r]),o=r===a.length-1?"int ".concat(e[r+1]," = ").concat(n," - ").concat(e[r]," * ").concat(a[r]):"index -= ".concat(e[r]," * ").concat(a[r]);return"".concat(i,"; ").concat(o,";")})).join("")}(["r","c","d"],"inputShape"):RS(["r","c","d"],e);return"\n    ivec3 inputCoordsFromReshapedOutCoords(int index) {\n      ".concat(n,"\n      return ivec3(r, c, d);\n    }\n  ")}(n,this.enableShapeUniforms),"\n      ").concat(this.enableShapeUniforms?"\n  int getFlatIndex(ivec3 coords) {\n    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;\n  }\n":zS(t),"\n\n      void main() {\n        ivec3 rc = getOutputCoords();\n\n        vec4 result = vec4(0.);\n\n        ivec3 thisRC;\n        int rows = ").concat(this.enableShapeUniforms?"outShape[1]":t[1],";\n        int cols = ").concat(this.enableShapeUniforms?"outShape[2]":t[2],";\n\n        ").concat(r,"\n\n        setOutput(result);\n      }\n    ")}));var FA=function(){function e(t){(0,D.Z)(this,e),this.gpgpu=t,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0,this.freeTextures={},this.usedTextures={},this.logEnabled=!1}return(0,F.Z)(e,[{key:"acquireTexture",value:function(e,t,n){var r=OA(t,n),a=RA(e,r,n);a in this.freeTextures||(this.freeTextures[a]=[]),a in this.usedTextures||(this.usedTextures[a]=[]);var i,o=MA(e,r,this.gpgpu.gl,this.gpgpu.textureConfig,n);if(this.freeTextures[a].length>0){this.numFreeTextures--,this.numUsedTextures++,this._numBytesFree-=o,this.log();var u=this.freeTextures[a].pop();return this.usedTextures[a].push(u),u}return r===Q_.PACKED_2X2_FLOAT32?i=this.gpgpu.createPackedMatrixTexture(e[0],e[1]):r===Q_.PACKED_2X2_FLOAT16?i=this.gpgpu.createFloat16PackedMatrixTexture(e[0],e[1]):r===Q_.UNPACKED_FLOAT32?i=this.gpgpu.createFloat32MatrixTexture(e[0],e[1]):r===Q_.UNPACKED_FLOAT16?i=this.gpgpu.createFloat16MatrixTexture(e[0],e[1]):r===Q_.PACKED_4X1_UNSIGNED_BYTE&&(i=this.gpgpu.createUnsignedBytesMatrixTexture(e[0],e[1])),this.usedTextures[a].push(i),this.numUsedTextures++,this._numBytesAllocated+=o,this.log(),i}},{key:"releaseTexture",value:function(e,t,n,r){if(null!=this.freeTextures){var a=OA(n,r),i=RA(t,a,r);i in this.freeTextures||(this.freeTextures[i]=[]);var o=MA(t,a,this.gpgpu.gl,this.gpgpu.textureConfig,r),u=(0,ii.env)().getNumber("WEBGL_DELETE_TEXTURE_THRESHOLD");-1!==u&&this._numBytesAllocated>u?(this.gpgpu.deleteMatrixTexture(e.texture),this._numBytesAllocated-=o):(this.freeTextures[i].push(e),this.numFreeTextures++,this._numBytesFree+=o),this.numUsedTextures--;var s=this.usedTextures[i],c=s&&s.indexOf(e);if(null==c||c<0)throw new Error("Cannot release a texture that was never provided by this texture manager");s[c]=s[s.length-1],s.pop(),this.log()}}},{key:"log",value:function(){if(this.logEnabled){var e=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used","".concat(this.numFreeTextures," / ").concat(this.numUsedTextures),"(".concat(e,")"));var t=this._numBytesFree/this._numBytesAllocated;console.log("Bytes allocated: ".concat(this._numBytesAllocated)),console.log("Bytes unused: ".concat(this._numBytesFree," (").concat(Math.round(100*t),"%)"))}}},{key:"numBytesAllocated",get:function(){return this._numBytesAllocated}},{key:"numBytesFree",get:function(){return this._numBytesFree}},{key:"getNumUsedTextures",value:function(){return this.numUsedTextures}},{key:"getNumFreeTextures",value:function(){return this.numFreeTextures}},{key:"dispose",value:function(){var e=this;if(null!=this.freeTextures){for(var t in this.freeTextures)this.freeTextures[t].forEach((function(t){e.gpgpu.deleteMatrixTexture(t.texture)}));for(var n in this.usedTextures)this.usedTextures[n].forEach((function(t){e.gpgpu.deleteMatrixTexture(t.texture)}));this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0}}}]),e}();function MA(e,t,n,r,a){var i,o=function(e,t){switch(e){case Q_.PACKED_2X2_FLOAT32:return TC(t);case Q_.PACKED_2X2_FLOAT16:return IC(t);case Q_.UNPACKED_FLOAT32:return AC(t);case Q_.UNPACKED_FLOAT16:return EC(t);case Q_.PACKED_4X1_UNSIGNED_BYTE:return NC(t);default:throw new Error("Unknown physical texture type ".concat(e))}}(t,r);if(a){var u=aS(e[0],e[1]),s=(0,C.Z)(u,2);i=s[0]*s[1]}else{var c=nS(e[0],e[1]),l=(0,C.Z)(c,2);i=l[0]*l[1]}var f=function(e,t){var n=e;if(t===n.R32F)return 4;if(t===n.R16F)return 2;if(t===n.RGBA32F)return 16;if(t===e.RGBA)return 16;if(t===n.RGBA16F)return 8;if(t===n.RGBA8)return 4;throw new Error("Unknown internal format ".concat(t))}(n,o);return i*f}function OA(e,t){if(e===$_.UPLOAD)return Q_.PACKED_2X2_FLOAT32;if(e===$_.RENDER||null==e)return function(e){return(0,ii.env)().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?e?Q_.PACKED_2X2_FLOAT32:Q_.UNPACKED_FLOAT32:e?Q_.PACKED_2X2_FLOAT16:Q_.UNPACKED_FLOAT16}(t);if(e===$_.DOWNLOAD||e===$_.PIXELS)return Q_.PACKED_4X1_UNSIGNED_BYTE;throw new Error("Unknown logical texture type ".concat(e))}function RA(e,t,n){return"".concat(e[0],"_").concat(e[1],"_").concat(t,"_").concat(n)}var jA=(0,F.Z)((function e(t,n){(0,D.Z)(this,e),this.variableNames=["A"],this.outputShape=t,this.enableShapeUniforms=pC(this.outputShape.length),this.userCode="\n      float unaryOperation(float x) {\n        ".concat(n,"\n      }\n\n      void main() {\n        float x = getAAtOutCoords();\n        float y = unaryOperation(x);\n\n        setOutput(y);\n      }\n    ")})),BA="if (isnan(x)) return x;",zA="return x;",ZA="return abs(x);";var LA="return (x >= 0.0) ? x : (exp(x) - 1.0);",PA=BA+"\n  return (x < 0.0) ? 0.0 : x;\n",UA=BA+"\n  return (x < 0.0) ? 0.0 : min(6.0, x);\n",WA="return x;",VA="return 1.0 / (1.0 + exp(-1.0 * x));",qA="return x;",GA="\n  vec4 result;\n\n  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);\n  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);\n  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);\n  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);\n\n  return result;\n",HA="\n  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",XA="\n  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",KA="return 1.0 / (1.0 + exp(-1.0 * x));",YA=(0,F.Z)((function e(t,n){(0,D.Z)(this,e),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.enableShapeUniforms=pC(this.outputShape.length),this.userCode="\n      vec4 unaryOperation(vec4 x) {\n        ".concat(n,"\n      }\n\n      void main() {\n        vec4 x = getAAtOutCoords();\n        vec4 y = unaryOperation(x);\n\n        setOutput(y);\n      }\n    ")})),$A=(0,F.Z)((function e(t){(0,D.Z)(this,e),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=t,this.enableShapeUniforms=pC(this.outputShape.length);var n=t.length,r=TA("rc",n),a=iC(n),i=function(e,t){if(1===e)return"rc";for(var n="",r=0;r<e;r++)n+=t[r],r<e-1&&(n+=",");return n}(n,r),o=r.slice(-2),u=n<=1?"rc":"vec2(".concat(o.join(","),")");this.userCode="\n      void main() {\n        ".concat(a," rc = getOutputCoords();\n        vec4 packedInput = getA(").concat(i,");\n\n        setOutput(getChannel(packedInput, ").concat(u,"));\n      }\n    ")})),QA=ii.kernel_impls.whereImpl,JA={};var eE=(0,ii.env)().getNumber("CPU_HANDOFF_SIZE_THRESHOLD");var tE=function(e){(0,M.Z)(n,e);var t=(0,O.Z)(n);function n(e){var r,a,i;if((0,D.Z)(this,n),(r=t.call(this)).pendingRead=new WeakMap,r.pendingDisposal=new WeakSet,r.dataRefCount=new WeakMap,r.numBytesInGPU=0,r.uploadWaitMs=0,r.downloadWaitMs=0,r.lastGlFlushTime=0,r.warnedAboutMemory=!1,r.pendingDeletes=0,r.disposed=!1,!(0,ii.env)().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");if(null!=e){if(e instanceof FC)a=e;else{var o=tS((0,ii.env)().getNumber("WEBGL_VERSION"),e);a=new FC(o)}r.binaryCache={},r.gpgpuCreatedLocally=!1}else{var u=tS((0,ii.env)().getNumber("WEBGL_VERSION"));a=new FC(u),r.binaryCache=((i=(0,ii.env)().getNumber("WEBGL_VERSION"))in JA||(JA[i]={}),JA[i]),r.gpgpuCreatedLocally=!0}return r.gpgpu=a,r.canvas=r.gpgpu.gl.canvas,r.textureManager=new FA(r.gpgpu),r.numMBBeforeWarning=null==(0,ii.env)().global.screen?1024:(0,ii.env)().global.screen.height*(0,ii.env)().global.screen.width*window.devicePixelRatio*600/1024/1024,r.texData=new ii.DataStorage((0,Es.Z)(r),(0,ii.engine)()),r}return(0,F.Z)(n,[{key:"nextDataId",value:function(){return n.nextDataId++}},{key:"numDataIds",value:function(){return this.texData.numDataIds()-this.pendingDeletes}},{key:"writeTexture",value:function(e,t,n,r,a,i){var o=this.makeTensorInfo(t,n),u=this.texData.get(o.dataId);u.isPacked=!1,u.texture={texture:e,texShape:[r,a]},u.texShape=[r,a];var s=CS(t),c=new xC(s,!1,i),l=this.runWebGLProgram(c,[o],n,[[r,a]]);return l.shape=t,u.texture=null,this.disposeIntermediateTensorInfo(o),l.dataId}},{key:"write",value:function(e,t,n){if(((0,ii.env)().getBool("WEBGL_CHECK_NUMERICAL_PROBLEMS")||(0,ii.env)().getBool("DEBUG"))&&this.checkNumericalProblems(e),"complex64"===n&&null!=e)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");var r={id:this.nextDataId()};return this.texData.set(r,{shape:t,dtype:n,values:e,usage:$_.UPLOAD,refCount:1}),r}},{key:"refCount",value:function(e){return this.texData.has(e)?this.texData.get(e).refCount:0}},{key:"incRef",value:function(e){this.texData.get(e).refCount++}},{key:"decRef",value:function(e){this.texData.has(e)&&this.texData.get(e).refCount--}},{key:"move",value:function(e,t,n,r,a){if((0,ii.env)().getBool("DEBUG")&&this.checkNumericalProblems(t),"complex64"===r)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(e,{shape:n,dtype:r,values:t,usage:$_.UPLOAD,refCount:a})}},{key:"disposeIntermediateTensorInfo",value:function(e){this.disposeData(e.dataId)}},{key:"readSync",value:function(e){var t=this.texData.get(e),n=t.values,r=t.dtype,a=t.complexTensorInfos,i=t.slice,o=t.shape,u=t.isPacked;if(null!=i){var s;s=u?new YA(o,WA):new jA(o,WA);var c=this.runWebGLProgram(s,[{dataId:e,shape:o,dtype:r}],r),l=this.readSync(c.dataId);return this.disposeIntermediateTensorInfo(c),l}if(null!=n)return this.convertAndCacheOnCPU(e);if("string"===r)return n;var f,d,h=null!=this.activeTimers;if(h&&(f=ii.util.now()),"complex64"===r){var p=this.readSync(a.real.dataId),v=this.readSync(a.imag.dataId);d=ii.backend_util.mergeRealAndImagArrays(p,v)}else d=this.getValuesFromTexture(e);return h&&(this.downloadWaitMs+=ii.util.now()-f),this.convertAndCacheOnCPU(e,d)}},{key:"read",value:function(){var e=(0,Da.Z)(E().mark((function e(t){var n,r,a,i,o,u,s,c,l,f,d,h,p,v,m,g,y,b,x,w,k,_,S;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.pendingRead.has(t)){e.next=3;break}return n=this.pendingRead.get(t),e.abrupt("return",new Promise((function(e){return n.push(e)})));case 3:if(r=this.texData.get(t),a=r.values,i=r.shape,o=r.slice,u=r.dtype,s=r.complexTensorInfos,c=r.isPacked,null==o){e.next=11;break}return l=c?new YA(i,WA):new jA(i,WA),f=this.runWebGLProgram(l,[{dataId:t,shape:i,dtype:u}],u),d=this.read(f.dataId),this.disposeIntermediateTensorInfo(f),e.abrupt("return",d);case 11:if(null==a){e.next=13;break}return e.abrupt("return",this.convertAndCacheOnCPU(t));case 13:if(!(0,ii.env)().getBool("DEBUG")){e.next=16;break}if((0,ii.env)().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")||2!==(0,ii.env)().getNumber("WEBGL_VERSION")){e.next=16;break}throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");case 16:if(h=null,"complex64"!==u&&(0,ii.env)().get("WEBGL_BUFFER_SUPPORTED")&&(p=this.decode(t),m=this.texData.get(p.dataId),h=(v=this.gpgpu).createBufferFromTexture.apply(v,[m.texture.texture].concat((0,I.Z)(rS(i))))),this.pendingRead.set(t,[]),"complex64"===u){e.next=22;break}return e.next=22,this.gpgpu.createAndWaitForFence();case 22:if("complex64"!==u){e.next=31;break}return e.next=25,Promise.all([this.read(s.real.dataId),this.read(s.imag.dataId)]);case 25:y=e.sent,b=y[0],x=y[1],g=ii.backend_util.mergeRealAndImagArrays(b,x),e.next=32;break;case 31:null==h?g=this.getValuesFromTexture(t):(w=ii.util.sizeFromShape(i),g=this.gpgpu.downloadFloat32MatrixFromBuffer(h,w));case 32:return null!=p&&this.disposeIntermediateTensorInfo(p),null!=h&&oS(k=this.gpgpu.gl,(function(){return k.deleteBuffer(h)})),_=this.convertAndCacheOnCPU(t,g),S=this.pendingRead.get(t),this.pendingRead.delete(t),S.forEach((function(e){return e(_)})),this.pendingDisposal.has(t)&&(this.pendingDisposal.delete(t),this.disposeData(t)&&(0,ii.engine)().removeDataId(t,this),this.pendingDeletes--),e.abrupt("return",_);case 40:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"readToGPU",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.texData.get(e),r=n.values,a=n.shape,i=n.slice,o=n.dtype,u=n.isPacked,s=n.texture;if("complex64"===o)throw new Error("Does not support reading texture for complex64 dtype.");if(null!=i){var c;c=u?new YA(a,WA):new jA(a,WA);var l=this.runWebGLProgram(c,[{dataId:e,shape:a,dtype:o}],o),f=this.readToGPU(l,t);return this.disposeIntermediateTensorInfo(l),f}if(null==s)throw null!=r?new Error("Data is not on GPU but on CPU."):new Error("There is no data on GPU or CPU.");var d=this.decode(e,t.customTexShape),h=(0,ii.engine)().makeTensorFromTensorInfo(d),p=this.texData.get(d.dataId);return Object.assign({tensorRef:h},p.texture)}},{key:"bufferSync",value:function(e){var t=this.readSync(e.dataId);if("string"===e.dtype)try{var n=t.map((function(e){return ii.util.decodeString(e)}));return(0,ii.buffer)(e.shape,e.dtype,n)}catch(r){throw new Error("Failed to decode encoded string bytes into utf-8")}return(0,ii.buffer)(e.shape,e.dtype,t)}},{key:"checkNumericalProblems",value:function(e){if(null!=e)for(var t=0;t<e.length;t++){var n=e[t];if(!uS(n)){if((0,ii.env)().getBool("WEBGL_RENDER_FLOAT32_CAPABLE"))throw Error("The value ".concat(n," cannot be represented with your ")+"current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'");throw Error("The value ".concat(n," cannot be represented on this device."))}}}},{key:"getValuesFromTexture",value:function(e){var t=this.texData.get(e),n=t.shape,r=t.dtype,a=t.isPacked,i=ii.util.sizeFromShape(n);if((0,ii.env)().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){var o,u=this.decode(e),s=this.texData.get(u.dataId),c=(o=this.gpgpu).downloadMatrixFromPackedTexture.apply(o,[s.texture.texture].concat((0,I.Z)(rS(n)))).subarray(0,i);return this.disposeIntermediateTensorInfo(u),c}var l=(0,ii.env)().getBool("WEBGL_PACK")&&!0===a,f=l?CS(n):n,d=l?new yC(f):new gC(f),h=this.runWebGLProgram(d,[{shape:f,dtype:r,dataId:e}],"float32"),p=this.texData.get(h.dataId),v=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(p.texture.texture,p.texShape[0],p.texShape[1]).subarray(0,i);return this.disposeIntermediateTensorInfo(h),v}},{key:"timerAvailable",value:function(){return(0,ii.env)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0}},{key:"time",value:function(e){var t=this,n=this.activeTimers,r=[],a=!1;null==this.programTimersStack?(this.programTimersStack=r,a=!0):this.activeTimers.push(r),this.activeTimers=r,e();var i=ii.util.flatten(this.activeTimers.map((function(e){return e.query}))).filter((function(e){return null!=e})),o=ii.util.flatten(this.activeTimers.map((function(e){return e.name}))).filter((function(e){return null!=e}));this.activeTimers=n,a&&(this.programTimersStack=null);var u={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null};return(0,Da.Z)(E().mark((function e(){var n;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!((0,ii.env)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0)){e.next=8;break}return e.next=3,Promise.all(i);case 3:n=e.sent,u.kernelMs=ii.util.sum(n),u.getExtraProfileInfo=function(){return n.map((function(e,t){return{name:o[t],ms:e}})).map((function(e){return"".concat(e.name,": ").concat(e.ms)})).join(", ")},e.next=9;break;case 8:u.kernelMs={error:"WebGL query timers are not supported in this environment."};case 9:return t.uploadWaitMs=0,t.downloadWaitMs=0,e.abrupt("return",u);case 12:case"end":return e.stop()}}),e)})))()}},{key:"memory",value:function(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU,numBytesInGPUAllocated:this.textureManager.numBytesAllocated,numBytesInGPUFree:this.textureManager.numBytesFree}}},{key:"startTimer",value:function(){return(0,ii.env)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:ii.util.now(),endMs:null}}},{key:"endTimer",value:function(e){return(0,ii.env)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),e):(e.endMs=ii.util.now(),e)}},{key:"getQueryTime",value:function(){var e=(0,Da.Z)(E().mark((function e(t){var n;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!((0,ii.env)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0)){e.next=2;break}return e.abrupt("return",this.gpgpu.waitForQueryAndGetTime(t));case 2:return n=t,e.abrupt("return",n.endMs-n.startMs);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"disposeData",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this.pendingDisposal.has(e))return!1;if(!this.texData.has(e))return!0;if(t?this.texData.get(e).refCount=0:this.texData.get(e).refCount--,!t&&this.texData.get(e).refCount>0)return!1;if(this.pendingRead.has(e))return this.pendingDisposal.add(e),this.pendingDeletes++,!1;this.releaseGPUData(e);var n=this.texData.get(e),r=n.complexTensorInfos;return null!=r&&(this.disposeData(r.real.dataId,t),this.disposeData(r.imag.dataId,t)),this.texData.delete(e),!0}},{key:"releaseGPUData",value:function(e){var t=this.texData.get(e),n=t.texture,r=t.dtype,a=t.texShape,i=t.usage,o=t.isPacked,u=t.slice,s=u&&u.origDataId||e,c=this.dataRefCount.get(s);c>1?this.dataRefCount.set(s,c-1):(this.dataRefCount.delete(s),null!=n&&(this.numBytesInGPU-=this.computeBytes(a,r),this.textureManager.releaseTexture(n,a,i,o)));var l=this.texData.get(e);l.texture=null,l.texShape=null,l.isPacked=!1,l.slice=null}},{key:"getTexture",value:function(e){return this.uploadToGPU(e),this.texData.get(e).texture.texture}},{key:"getDataInfo",value:function(e){return this.texData.get(e)}},{key:"shouldExecuteOnCPU",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:eE;return(0,ii.env)().getBool("WEBGL_CPU_FORWARD")&&e.every((function(e){return null==t.texData.get(e.dataId).texture&&ii.util.sizeFromShape(e.shape)<n}))}},{key:"getGPGPUContext",value:function(){return this.gpgpu}},{key:"where",value:function(e){ii.backend_util.warn("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");var t=e.dataSync();return QA(e.shape,t)}},{key:"packedUnaryOp",value:function(e,t,n){var r=new YA(e.shape,t),a=this.compileAndRun(r,[e],n);return(0,ii.engine)().makeTensorFromTensorInfo(a)}},{key:"abs",value:function(e){if(this.shouldExecuteOnCPU([e])&&"complex64"!==e.dtype){var t=dA(this.texData.get(e.dataId).values);return this.makeOutput(e.shape,e.dtype,t)}if((0,ii.env)().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,ZA,e.dtype);var n=new jA(e.shape,ZA),r=this.compileAndRun(n,[e]);return(0,ii.engine)().makeTensorFromTensorInfo(r)}},{key:"makeTensorInfo",value:function(e,t,n){var r;if("string"===t&&null!=n&&n.length>0&&ii.util.isString(n[0])){var a=n.map((function(e){return ii.util.encodeString(e)}));r=this.write(a,e,t)}else r=this.write(n,e,t);return this.texData.get(r).usage=null,{dataId:r,shape:e,dtype:t}}},{key:"makeOutput",value:function(e,t,n){return(0,ii.engine)().makeTensorFromTensorInfo(this.makeTensorInfo(e,t,n),this)}},{key:"unpackTensor",value:function(e){var t=new $A(e.shape);return this.runWebGLProgram(t,[e],e.dtype)}},{key:"packTensor",value:function(e){var t=new IA(e.shape);return this.runWebGLProgram(t,[e],e.dtype,null,!0)}},{key:"packedReshape",value:function(e,t){var n=[_S(e.shape)].concat((0,I.Z)(SS(e.shape))),r={dtype:e.dtype,shape:n,dataId:e.dataId},a=[_S(t)].concat((0,I.Z)(SS(t))),i=new DA(a,n),o=[n],u=this.runWebGLProgram(i,[r],e.dtype,o,!0);return{dataId:u.dataId,shape:t,dtype:u.dtype}}},{key:"decode",value:function(e,t){var n=this.texData.get(e),r=n.isPacked,a=n.shape,i=n.dtype;if(null!=t){var o=ii.util.sizeFromShape(a),u=t[0]*t[1]*4;ii.util.assert(o<=u,(function(){return"customTexShape is too small. Row * Column * 4 should be equal or larger than the size of the tensor data."}))}var s,c=CS(a);s=r?new mC(c):new vC(c);var l=[null!=t?t:rS(c)];return{dtype:i,shape:a,dataId:this.runWebGLProgram(s,[{shape:c,dtype:i,dataId:e}],i,l,!0,t).dataId}}},{key:"runWebGLProgram",value:function(e,t,n,r){var a=this,i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=arguments.length>5?arguments[5]:void 0,u=this.makeTensorInfo(e.outputShape,n),s=this.texData.get(u.dataId);if(e.packedOutput&&(s.isPacked=!0),e.outPackingScheme===Y_.DENSE){var c=null!=o?o:rS(e.outputShape);s.texShape=c.map((function(e){return 2*e}))}if(null!=e.outTexUsage&&(s.usage=e.outTexUsage),0===ii.util.sizeFromShape(u.shape))return s.values=ii.util.getTypedArrayFromDType(u.dtype,0),u;var l=[],f=t.map((function(t){if("complex64"===t.dtype)throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");var n=a.texData.get(t.dataId);if(null==n.texture){if(!e.packedInputs&&ii.util.sizeFromShape(t.shape)<=(0,ii.env)().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:t.shape,texData:null,isUniform:!0,uniformValues:n.values};e.packedInputs&&(n.isPacked=!0,n.shape=t.shape)}if(a.uploadToGPU(t.dataId),!!n.isPacked!==!!e.packedInputs)t=n.isPacked?a.unpackTensor(t):a.packTensor(t),l.push(t),n=a.texData.get(t.dataId);else if(n.isPacked&&!ES(n.shape,t.shape)){var r=t,i=t.shape;t.shape=n.shape,t=a.packedReshape(t,i),l.push(t),n=a.texData.get(t.dataId),r.shape=i}return{shape:t.shape,texData:n,isUniform:!1}}));this.uploadToGPU(u.dataId);var d,h={shape:u.shape,texData:s,isUniform:!1},p=hC(e,f,h),v=this.getAndSaveBinary(p,(function(){return cC(a.gpgpu,e,f,h)})),m=null!=this.activeTimers;m&&(d=this.startTimer()),(0,ii.env)().get("ENGINE_COMPILE_ONLY")||dC(this.gpgpu,v,f,h,r),l.forEach((function(e){return a.disposeIntermediateTensorInfo(e)})),m&&(d=this.endTimer(d),this.activeTimers.push({name:e.constructor.name,query:this.getQueryTime(d)}));var g=(0,ii.env)().getNumber("WEBGL_FLUSH_THRESHOLD");if(g>0){var y=ii.util.now();y-this.lastGlFlushTime>g&&(this.gpgpu.gl.flush(),this.lastGlFlushTime=y)}if(!(0,ii.env)().getBool("WEBGL_LAZILY_UNPACK")&&s.isPacked&&!1===i){var b=this.unpackTensor(u);return this.disposeIntermediateTensorInfo(u),b}return u}},{key:"compileAndRun",value:function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];n=n||t[0].dtype;var i=this.runWebGLProgram(e,t,n,r,a);return i}},{key:"getAndSaveBinary",value:function(e,t){return e in this.binaryCache||(this.binaryCache[e]=t()),this.binaryCache[e]}},{key:"getTextureManager",value:function(){return this.textureManager}},{key:"dispose",value:function(){var e=this;if(!this.disposed){if(!(0,ii.env)().getBool("IS_TEST"))Object.keys(this.binaryCache).forEach((function(t){e.gpgpu.deleteProgram(e.binaryCache[t].webGLProgram),delete e.binaryCache[t]}));this.textureManager.dispose(),null!=this.canvas&&"undefined"!==typeof HTMLCanvasElement&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0}}},{key:"floatPrecision",value:function(){var e=this;return null==this.floatPrecisionValue&&(this.floatPrecisionValue=(0,ii.tidy)((function(){if(!(0,ii.env)().get("WEBGL_RENDER_FLOAT32_ENABLED")){var t=(0,ii.env)().getBool("DEBUG");(0,ii.env)().set("DEBUG",!1);var n=e.abs((0,ii.scalar)(1e-8)).dataSync()[0];if((0,ii.env)().set("DEBUG",t),n>0)return 32}return 16}))),this.floatPrecisionValue}},{key:"epsilon",value:function(){return 32===this.floatPrecision()?1e-7:1e-4}},{key:"uploadToGPU",value:function(e){var t=this.texData.get(e),n=t.shape,r=t.dtype,a=t.values,i=t.texture,o=t.usage,u=t.isPacked;if(null==i){var s,c=null!=this.activeTimers;c&&(s=ii.util.now());var l=t.texShape;if(null==l&&(l=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=(0,ii.env)().getNumber("WEBGL_MAX_TEXTURE_SIZE"),r=(0,ii.env)().getNumber("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE");if(r===1/0&&(0,ii.env)().getBool("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE")&&(r=n/2),t&&(n*=2,r*=2,1===(e=e.map((function(t,n){return n>=e.length-2?ii.util.nearestLargerEven(e[n]):e[n]}))).length&&(e=[2,e[0]])),2!==e.length){var a=ii.util.squeezeShape(e);e=a.newShape}var i=ii.util.sizeFromShape(e),o=null;e.length<=1&&i<=n?o=[1,i]:2===e.length&&e[0]<=n&&e[1]<=n?o=e:3===e.length&&e[0]*e[1]<=n&&e[2]<=n?o=[e[0]*e[1],e[2]]:3===e.length&&e[0]<=n&&e[1]*e[2]<=n?o=[e[0],e[1]*e[2]]:4===e.length&&e[0]*e[1]*e[2]<=n&&e[3]<=n?o=[e[0]*e[1]*e[2],e[3]]:4===e.length&&e[0]<=n&&e[1]*e[2]*e[3]<=n&&(o=[e[0],e[1]*e[2]*e[3]]);var u=null!=o&&Math.max.apply(Math,(0,I.Z)(o))>r&&Math.min.apply(Math,(0,I.Z)(o))<=(t?2:1)&&Math.min.apply(Math,(0,I.Z)(o))>0;if(null==o||u)if(t){var s=_S(e),c=2,l=2;if(e.length){var f=SS(e),d=(0,C.Z)(f,2);c=d[0],l=d[1]}i=s*(c/2)*(l/2),o=ii.util.sizeToSquarishShape(i).map((function(e){return 2*e}))}else o=ii.util.sizeToSquarishShape(i);return o}(n,u),t.texShape=l),null!=a){var f,d=CS(n),h=l[1],p=l[0],v=a instanceof Uint8Array||a instanceof Uint8ClampedArray;if(u||!v){var m=aS(l[0],l[1]),g=(0,C.Z)(m,2);h=g[0],p=g[1]}f=u?new wC(d,v):new xC(d,v);var y=v?[p,h]:l,b=this.makeTensorInfo(y,r),x=this.texData.get(b.dataId);x.usage=v?$_.PIXELS:$_.UPLOAD,x.texShape=y,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(b.dataId),h,p,a);var w=[[p,h]],k=this.runWebGLProgram(f,[b],r,w,!0),_=this.texData.get(k.dataId);t.texShape=_.texShape,t.isPacked=_.isPacked,t.usage=_.usage,(0,ii.env)().get("ENGINE_COMPILE_ONLY")?this.disposeData(k.dataId):(t.texture=_.texture,t.values=null,this.texData.delete(k.dataId)),this.disposeIntermediateTensorInfo(b),c&&(this.uploadWaitMs+=ii.util.now()-s)}else{var S=this.acquireTexture(l,o,r,u);t.texture=S}}}},{key:"convertAndCacheOnCPU",value:function(e,t){var n=this.texData.get(e),r=n.dtype;return null!=t&&(n.values=function(e,t){if("float32"===t||"complex64"===t)return e;if("int32"===t||"bool"===t){for(var n="int32"===t?new Int32Array(e.length):new Uint8Array(e.length),r=0;r<n.length;++r)n[r]=Math.round(e[r]);return n}throw new Error("Unknown dtype ".concat(t))}(t,r)),n.values}},{key:"acquireTexture",value:function(e,t,n,r){if(this.numBytesInGPU+=this.computeBytes(e,n),!this.warnedAboutMemory&&this.numBytesInGPU>1024*this.numMBBeforeWarning*1024){var a=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn("High memory usage in GPU: ".concat(a," MB, ")+"most likely due to a memory leak")}return this.textureManager.acquireTexture(e,t,r)}},{key:"computeBytes",value:function(e,t){return e[0]*e[1]*ii.util.bytesPerElement(t)}},{key:"checkCompileCompletion",value:function(){for(var e=0,t=Object.entries(this.binaryCache);e<t.length;e++){var n=(0,C.Z)(t[e],2)[1];this.checkCompletion_(n)}}},{key:"checkCompileCompletionAsync",value:function(){var e=(0,Da.Z)(E().mark((function e(){var t,n,r,a,i,o,u,s,c=this;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=[],!this.gpgpu.parallelCompilationExtension){e.next=6;break}for(n=0,r=Object.entries(this.binaryCache);n<r.length;n++)a=(0,C.Z)(r[n],2),i=a[1],t.push(this.checkCompletionAsync_(i));return e.abrupt("return",Promise.all(t));case 6:for(o=function(){var e=(0,C.Z)(s[u],2)[1],n=new Promise((function(t){try{c.checkCompletion_(e),t(!0)}catch(n){throw n}}));t.push(n)},u=0,s=Object.entries(this.binaryCache);u<s.length;u++)o();return e.abrupt("return",Promise.all(t));case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"checkCompletionAsync_",value:function(){var e=(0,Da.Z)(E().mark((function e(t){return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.gpgpu.gl.getProgramParameter(t.webGLProgram,this.gpgpu.parallelCompilationExtension.COMPLETION_STATUS_KHR)){e.next=4;break}return e.abrupt("return",this.checkCompletion_(t));case 4:return e.next=6,(0,ii.nextFrame)();case 6:return e.abrupt("return",this.checkCompletionAsync_(t));case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"checkCompletion_",value:function(e){if(!1===this.gpgpu.gl.getProgramParameter(e.webGLProgram,this.gpgpu.gl.LINK_STATUS)){if(console.log(this.gpgpu.gl.getProgramInfoLog(e.webGLProgram)),!1===this.gpgpu.gl.getShaderParameter(e.fragmentShader,this.gpgpu.gl.COMPILE_STATUS))throw dS(e.source,this.gpgpu.gl.getShaderInfoLog(e.fragmentShader)),new Error("Failed to compile fragment shader.");throw new Error("Failed to link vertex and fragment shaders.")}return!0}},{key:"getUniformLocations",value:function(){for(var e=0,t=Object.values(this.binaryCache);e<t.length;e++){var n=t[e];this.gpgpu.buildVao(n.webGLProgram);var r=lC(this.gpgpu,n.program,n.webGLProgram),a=r.variablesLocations,i=r.customUniformLocations,o=r.infLoc,u=r.nanLoc,s=r.outShapeLocation,c=r.outShapeStridesLocation,l=r.outTexShapeLocation;n.variablesLocations=a,n.customUniformLocations=i,n.infLoc=o,n.nanLoc=u,n.outShapeLocation=s,n.outShapeStridesLocation=c,n.outTexShapeLocation=l}}},{key:"createTensorFromGPUData",value:function(e,t,n){e.channels=e.channels||"RGBA";var r=e.texture,a=e.height,i=e.width,o=e.channels,u=(0,ii.engine)().backend;if(!u.gpgpu.gl.isTexture(r))throw new Error("The texture is invalid. Also, please make sure the texture and the TFJS WebGL backend are using the same canvas. If you want to use your own custom canvas, you have to create and use the custom TFJS WebGL backend created from the canvas through 'new tf.MathBackendWebGL(customCanvas)'.");var s=u.writeTexture(r,t,n,a,i,o);return(0,ii.engine)().makeTensorFromDataId(s,t,n,u)}}]),n}(ii.KernelBackend);tE.nextDataId=0;ii.device_util.isBrowser()&&(0,ii.registerBackend)("webgl",(function(){return new tE}),2);var nE=(0,F.Z)((function e(t,n,r){(0,D.Z)(this,e),this.variableNames=["A","B"],this.outputShape=ii.backend_util.assertAndGetBroadcastShape(n,r),this.enableShapeUniforms=pC(this.outputShape.length),this.userCode="\n      float binaryOperation(float a, float b) {\n        ".concat(t,"\n      }\n\n      void main() {\n        float a = getAAtOutCoords();\n        float b = getBAtOutCoords();\n        setOutput(binaryOperation(a, b));\n      }\n    ")})),rE="\n  result.r = isNaN.r ? NAN : result.r;\n  result.g = isNaN.g ? NAN : result.g;\n  result.b = isNaN.b ? NAN : result.b;\n  result.a = isNaN.a ? NAN : result.a;\n",aE=(0,F.Z)((function e(t,n,r){var a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];(0,D.Z)(this,e),this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=ii.backend_util.assertAndGetBroadcastShape(n,r);var i=this.outputShape.length;this.enableShapeUniforms=pC(i);var o="";if(a)if(0===i||1===ii.util.sizeFromShape(this.outputShape))o="\n          result.y = 0.;\n          result.z = 0.;\n          result.w = 0.;\n        ";else{var u=iC(i);if(o="\n          ".concat(u," coords = getOutputCoords();\n        "),1===i)this.enableShapeUniforms?o+="\n            result.y = (coords + 1) >= outShape ? 0. : result.y;\n            result.z = 0.;\n            result.w = 0.;\n          ":o+="\n            result.y = (coords + 1) >= ".concat(this.outputShape[0]," ? 0. : result.y;\n            result.z = 0.;\n            result.w = 0.;\n          ");else{var s=TA("coords",i);this.enableShapeUniforms?o+="\n            bool nextRowOutOfBounds =\n              (".concat(s[i-2]," + 1) >= outShape[").concat(i," - 2];\n            bool nextColOutOfBounds =\n              (").concat(s[i-1]," + 1) >= outShape[").concat(i," - 1];\n            result.y = nextColOutOfBounds ? 0. : result.y;\n            result.z = nextRowOutOfBounds ? 0. : result.z;\n            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;\n          "):o+="\n            bool nextRowOutOfBounds =\n              (".concat(s[i-2]," + 1) >= ").concat(this.outputShape[i-2],";\n            bool nextColOutOfBounds =\n              (").concat(s[i-1]," + 1) >= ").concat(this.outputShape[i-1],";\n            result.y = nextColOutOfBounds ? 0. : result.y;\n            result.z = nextRowOutOfBounds ? 0. : result.z;\n            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;\n          ")}}this.userCode="\n      vec4 binaryOperation(vec4 a, vec4 b) {\n        ".concat(t,"\n      }\n\n      void main() {\n        vec4 a = getAAtOutCoords();\n        vec4 b = getBAtOutCoords();\n\n        vec4 result = binaryOperation(a, b);\n        ").concat(o,"\n\n        setOutput(result);\n      }\n    ")}));function iE(e){var t=e.inputs,n=e.backend,r=t.x;return n.incRef(r.dataId),{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}var oE={kernelName:ii.Identity,backendName:"webgl",kernelFunc:iE};function uE(e){var t=e.inputs,n=e.backend,r=t.real,a=t.imag,i=n.makeTensorInfo(r.shape,"complex64"),o=n.texData.get(i.dataId),u=iE({inputs:{x:r},backend:n}),s=iE({inputs:{x:a},backend:n});return o.complexTensorInfos={real:u,imag:s},i}var sE={kernelName:ii.Complex,backendName:"webgl",kernelFunc:uE},cE="return (a < 0.) ? b * a : a;",lE="\n  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));\n  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);\n";var fE={kernelName:ii.LeakyRelu,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.alpha,o=n.makeTensorInfo([],"float32",ii.util.createScalarValue(i,"float32")),u=(0,ii.env)().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new aE(lE,a.shape,o.shape):new nE(cE,a.shape,o.shape),s=n.runWebGLProgram(u,[a,o],"float32");return n.disposeIntermediateTensorInfo(o),s}},dE="return (a < 0.) ? b * a : a;",hE="\n  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));\n  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);\n";var pE={kernelName:ii.Prelu,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.x,a=t.alpha,i=(0,ii.env)().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new aE(hE,r.shape,a.shape):new nE(dE,r.shape,a.shape);return n.runWebGLProgram(i,[r,a],"float32")}};function vE(e){var t=e.opSnippet,n=e.packedOpSnippet,r=e.cpuKernelImpl,a=e.dtype;return function(e){var i,o=e.inputs,u=e.backend,s=o.x,c=u,l=a||s.dtype;if(c.shouldExecuteOnCPU([s])&&null!=r){var f=c.texData.get(s.dataId),d=r(f.values,l);return c.makeTensorInfo(s.shape,l,d)}return i=(0,ii.env)().getBool("WEBGL_PACK_UNARY_OPERATIONS")&&null!=n?new YA(s.shape,n):new jA(s.shape,t),c.runWebGLProgram(i,[s],l)}}function mE(e){var t=e.opSnippet,n=e.packedOpSnippet,r=e.checkOutOfBounds,a=void 0!==r&&r,i=e.supportsComplex,o=void 0!==i&&i,u=e.cpuKernelImpl,s=e.dtype;return function(e){var r=e.inputs,i=e.backend,c=r.a,l=r.b,f=i;if(o&&"complex64"===c.dtype){var d=f.texData.get(c.dataId),h=f.texData.get(l.dataId),p=[[d.complexTensorInfos.real,h.complexTensorInfos.real],[d.complexTensorInfos.imag,h.complexTensorInfos.imag]].map((function(e){var n=(0,C.Z)(e,2),r=n[0],a=n[1],i={dataId:r.dataId,dtype:r.dtype,shape:c.shape},o={dataId:a.dataId,dtype:a.dtype,shape:l.shape},u=new nE(t,c.shape,l.shape);return f.runWebGLProgram(u,[i,o],(0,ii.upcastType)(r.dtype,a.dtype))})),v=(0,C.Z)(p,2),m=v[0],g=v[1],y=uE({inputs:{real:m,imag:g},backend:f});return f.disposeIntermediateTensorInfo(m),f.disposeIntermediateTensorInfo(g),y}var b,x=s||(0,ii.upcastType)(c.dtype,l.dtype);if(("string"===c.dtype||"string"===l.dtype||f.shouldExecuteOnCPU([c,l]))&&null!=u){var w=f.texData.get(c.dataId).values,k=f.texData.get(l.dataId).values,_="string"===c.dtype?ii.backend_util.fromUint8ToStringArray(w):w,S="string"===c.dtype?ii.backend_util.fromUint8ToStringArray(k):k,A=u(c.shape,l.shape,_,S,x),E=(0,C.Z)(A,2),N=E[0],T=E[1],I=f.makeTensorInfo(T,x);return f.texData.get(I.dataId).values=N,I}return b=(0,ii.env)().getBool("WEBGL_PACK_BINARY_OPERATIONS")&&null!=n?new aE(n,c.shape,l.shape,a):new nE(t,c.shape,l.shape),f.runWebGLProgram(b,[c,l],x)}}function gE(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if("linear"===e)return t?qA:zA;if("relu"===e)return t?HA:PA;if("elu"===e)return t?GA:LA;if("relu6"===e)return t?XA:UA;if("prelu"===e)return t?hE:dE;if("leakyrelu"===e)return t?lE:cE;if("sigmoid"===e)return t?KA:VA;throw new Error("Activation ".concat(e," has not been implemented for the WebGL backend."))}var yE=(0,F.Z)((function e(t,n,r){var a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=arguments.length>5&&void 0!==arguments[5]&&arguments[5],u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,s=arguments.length>7&&void 0!==arguments[7]&&arguments[7],c=arguments.length>8&&void 0!==arguments[8]&&arguments[8];(0,D.Z)(this,e),this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=r,this.enableShapeUniforms=pC(this.outputShape.length);var l=a?t[1]:t[2],f=Math.ceil(l/2),d=a?"i * 2, rc.y":"rc.y, i * 2",h=i?"rc.z, i * 2":"i * 2, rc.z",p=a?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],v=i?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"],m="",g="";u&&(m=s?"vec4 activation(vec4 a) {\n          vec4 b = getPreluActivationWeightsAtOutCoords();\n          ".concat(u,"\n        }"):c?"vec4 activation(vec4 a) {\n          vec4 b = getLeakyreluAlphaAtOutCoords();\n          ".concat(u,"\n        }"):"vec4 activation(vec4 x) {\n          ".concat(u,"\n        }"),g="result = activation(result);");var y=o?"result += getBiasAtOutCoords();":"";o&&this.variableNames.push("bias"),s&&this.variableNames.push("preluActivationWeights"),c&&this.variableNames.push("leakyreluAlpha");var b="rc.x",x="rc.x";t[0]<n[0]?b="imod(rc.x, ".concat(t[0],")"):n[0]<t[0]&&(x="imod(rc.x, ".concat(n[0],")")),this.userCode="\n      ".concat(m,"\n      // Don't use uniform for sharedDimensionPacked for performance.\n      const float sharedDimension = ").concat(f,".0;\n\n      vec4 dot2x2ARowBCol(ivec3 rc) {\n        vec4 result = vec4(0);\n        int batchA = ").concat(b,";\n        int batchB = ").concat(x,";\n        for (int i = 0; i < ").concat(f,"; i++) {\n          vec4 a = getMatrixA(batchA, ").concat(d,");\n          vec4 b = getMatrixB(batchB, ").concat(h,");\n\n          // These swizzled products need to be separately added.\n          // See: https://github.com/tensorflow/tfjs/issues/1735\n          result += (").concat(p[0]," * ").concat(v[0],");\n          result += (").concat(p[1]," * ").concat(v[1],");\n        }\n        return result;\n      }\n\n      void main() {\n        ivec3 rc = getOutputCoords();\n        vec4 result = dot2x2ARowBCol(rc);\n\n        ").concat(y,"\n\n        ").concat(g,"\n\n        setOutput(result);\n      }\n    ")})),bE="return areal * breal - aimag * bimag;",xE="return areal * bimag + aimag * breal;",wE=(0,F.Z)((function e(t,n,r){(0,D.Z)(this,e),this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=ii.backend_util.assertAndGetBroadcastShape(n,r),this.userCode="\n      float binaryOpComplex(\n          float areal, float aimag, float breal, float bimag) {\n        ".concat(t,"\n      }\n\n      void main() {\n        float areal = getARealAtOutCoords();\n        float aimag = getAImagAtOutCoords();\n        float breal = getBRealAtOutCoords();\n        float bimag = getBImagAtOutCoords();\n        setOutput(binaryOpComplex(areal, aimag, breal, bimag));\n      }\n    ")})),kE="return a * b;";function _E(e){var t,n=e.inputs,r=e.backend,a=n.a,i=n.b,o=ii.backend_util.upcastType(a.dtype,i.dtype);if("complex64"===a.dtype){var u=r.texData.get(a.dataId),s=r.texData.get(i.dataId),c=new wE(bE,a.shape,i.shape),l=new wE(xE,a.shape,i.shape),f=[{dataId:u.complexTensorInfos.real.dataId,dtype:u.complexTensorInfos.real.dtype,shape:a.shape},{dataId:u.complexTensorInfos.imag.dataId,dtype:u.complexTensorInfos.imag.dtype,shape:a.shape},{dataId:s.complexTensorInfos.real.dataId,dtype:s.complexTensorInfos.real.dtype,shape:i.shape},{dataId:s.complexTensorInfos.imag.dataId,dtype:s.complexTensorInfos.imag.dtype,shape:i.shape}],d=r.runWebGLProgram(c,f,"float32"),h=r.runWebGLProgram(l,f,"float32"),p=uE({inputs:{real:d,imag:h},backend:r});return r.disposeIntermediateTensorInfo(d),r.disposeIntermediateTensorInfo(h),p}if(r.shouldExecuteOnCPU([a,i])){var v=r.texData.get(a.dataId),m=r.texData.get(i.dataId),g=tA(a.shape,i.shape,v.values,m.values,o),y=(0,C.Z)(g,2),b=y[0],x=y[1],w=r.makeTensorInfo(x,o);return r.texData.get(w.dataId).values=b,w}return t=(0,ii.env)().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new aE(kE,a.shape,i.shape):new nE(kE,a.shape,i.shape),r.runWebGLProgram(t,[a,i],o)}var SE={kernelName:ii.Multiply,backendName:"webgl",kernelFunc:_E};function CE(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.shape,o=n,u=ii.util.sizeFromShape(a.shape),s=ii.util.inferFromImplicitShape(i,u),c=ii.util.sizeFromShape(s);ii.util.assert(u===c,(function(){return"The new shape (".concat(s,") has ").concat(c," elements and the old ")+"shape (".concat(a.shape,") has ").concat(u," elements. The new shape and old ")+"shape must have the same number of elements."}));var l=o.texData.get(a.dataId);return!l.isPacked||ES(a.shape,s)||null!==l.texture&&ES(l.shape,s)?(o.incRef(a.dataId),{dataId:a.dataId,shape:s,dtype:a.dtype}):function(e,t,n){var r=[_S(e.shape)].concat((0,I.Z)(SS(e.shape))),a={dtype:e.dtype,shape:r,dataId:e.dataId},i=[_S(t)].concat((0,I.Z)(SS(t))),o=new DA(i,r),u=[r],s=n.runWebGLProgram(o,[a],e.dtype,u,!0);return{dataId:s.dataId,shape:t,dtype:s.dtype}}(a,s,o)}var AE={kernelName:ii.Reshape,backendName:"webgl",kernelFunc:CE},EE=(0,F.Z)((function e(t,n){(0,D.Z)(this,e),this.variableNames=["x"];var r=t.windowSize,a=t.batchSize,i=t.inSize,o=t.outSize;this.outputShape=[a,o];var u=4*Math.floor(r/4),s=r%4,c="sumValue += dot(values, ones);";if(null!=n){var l=1/n;c="sumValue += dot(values * ".concat(ii.util.isInt(l)?l.toPrecision(2):l,", ones);")}var f="";i%r>0&&(f="\n        if (inIdx < 0 || inIdx >= ".concat(i,") {\n          return 0.0;\n        }\n      ")),this.userCode="\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float getValue(int batch, int inIdx) {\n        ".concat(f,"\n        return getX(batch, inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * ").concat(r,";\n\n        float sumValue = 0.0;\n\n        for (int i = 0; i < ").concat(u,"; i += 4) {\n          int inIdx = inOffset + i;\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          ").concat(c,"\n        }\n\n        int inIdx = inOffset + ").concat(u,";\n        if (").concat(1===s,") {\n          vec4 values = vec4(getValue(batch, inIdx), 0.0, 0.0, 0.0);\n\n          ").concat(c,"\n        } else if (").concat(2===s,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1), 0.0, 0.0);\n\n          ").concat(c,"\n        } else if (").concat(3===s,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2), 0.0);\n\n          ").concat(c,"\n        }\n        setOutput(sumValue);\n      }\n    ")})),NE=(0,F.Z)((function e(t,n){(0,D.Z)(this,e),this.variableNames=["x"];var r=t.windowSize,a=t.batchSize,i=t.inSize,o=t.outSize;this.outputShape=[a,o];var u="0.0",s="";"prod"===n?u="1.0":"min"===n?(u="1.0 / 1e-20",s="min"):"max"===n&&(u="-1.0 / 1e-20",s="max");var c="".concat(n,"(").concat(n,"(").concat(n,"(")+"minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"sum"===n?c="sumValue":"prod"===n?c="prodValue":"all"===n?c="allValue":"any"===n&&(c="anyValue");var l=4*Math.floor(r/4),f=r%4,d="\n      if (".concat("sum"===n,") {\n        sumValue += dot(values, ones);\n      } else if (").concat("prod"===n,") {\n        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);\n        prodValue *= tmp[0] * tmp[1];\n      } else {\n        minMaxValue = ").concat(s,"(values, minMaxValue);\n        if (").concat("min"===n," || ").concat("max"===n,") {\n          minMaxValue = ").concat(s,"(values, minMaxValue);\n          bvec4 isNaN = isnan(values);\n          if (isNaN.r || isNaN.g || isNaN.b || isNaN.a) {\n            minMaxValue = vec4(NAN);\n          }\n        }\n      }\n    "),h="vec4";"all"===n?(u="1.0",d="\n        bool reducedAllValue = all(values);\n        float floatedReducedAllValue = float(reducedAllValue);\n        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);\n      ",h="bvec4"):"any"===n&&(u="0.0",d="\n        bool reducedAnyValue = any(values);\n        float floatedReducedAnyValue = float(reducedAnyValue);\n        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);\n      ",h="bvec4");var p="";i%r>0&&(p="\n        if (inIdx < 0 || inIdx >= ".concat(i,") {\n          return initializationValue;\n        }\n      ")),this.userCode="\n      const float initializationValue = ".concat(u,";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float getValue(int batch, int inIdx) {\n        ").concat(p,"\n        return getX(batch, inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * ").concat(r,";\n\n        vec4 minMaxValue = vec4(").concat(u,");\n        float prodValue = 1.0;\n        float sumValue = 0.0;\n        float allValue = 1.0;\n        float anyValue = 0.0;\n\n        for (int i = 0; i < ").concat(l,"; i += 4) {\n          int inIdx = inOffset + i;\n          ").concat(h," values = ").concat(h,"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          ").concat(d,"\n        }\n\n        int inIdx = inOffset + ").concat(l,";\n        if (").concat(1===f,") {\n          ").concat(h," values = ").concat(h,"(\n            getValue(batch, inIdx),\n            initializationValue,\n            initializationValue,\n            initializationValue\n          );\n\n          ").concat(d,"\n        } else if (").concat(2===f,") {\n          ").concat(h," values = ").concat(h,"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            initializationValue,\n            initializationValue\n          );\n\n          ").concat(d,"\n        } else if (").concat(3===f,") {\n          ").concat(h," values = ").concat(h,"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            initializationValue\n          );\n\n          ").concat(d,"\n        }\n        setOutput(").concat(c,");\n      }\n    ")}));function TE(e,t,n,r){for(var a=function(e){for(var t=[];0===t.length||1!==t[t.length-1].outSize;){var n=t.length?t[t.length-1].outSize:e[1],r=ii.backend_util.computeOptimalWindowSize(n);t.push({inSize:n,windowSize:r,outSize:Math.ceil(n/r)})}return t}(e.shape),i=e,o=0;o<a.length;o++){var u,s=a[o],c=s.inSize,l=s.windowSize,f=s.outSize,d=void 0;d="mean"===n?0===o?new EE({windowSize:l,inSize:c,batchSize:e.shape[0],outSize:f},c):new EE({windowSize:l,inSize:c,batchSize:e.shape[0],outSize:f}):new NE({windowSize:l,inSize:c,batchSize:e.shape[0],outSize:f},n),u=i,i=r.runWebGLProgram(d,[i],t),u.dataId!==e.dataId&&r.disposeIntermediateTensorInfo(u)}return i}var IE=(0,F.Z)((function e(t,n){(0,D.Z)(this,e),this.variableNames=["A"];for(var r=new Array(t.length),a=0;a<r.length;a++)r[a]=t[n[a]];this.outputShape=r,this.rank=r.length;var i=iC(this.rank),o=function(e){var t=e.length;if(t>6)throw Error("Transpose for rank ".concat(t," is not yet supported"));for(var n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],r=new Array(t),a=0;a<e.length;a++)r[e[a]]=n[a];return r.join()}(n);this.userCode="\n    void main() {\n      ".concat(i," resRC = getOutputCoords();\n      setOutput(getA(").concat(o,"));\n    }\n    ")}));var DE=(0,F.Z)((function e(t,n){(0,D.Z)(this,e),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;for(var r=new Array(t.length),a=0;a<r.length;a++)r[a]=t[n[a]];if(this.outputShape=r,this.rank=r.length,this.rank>6)throw Error("Packed transpose for rank ".concat(this.rank," is not yet supported."));for(var i=iC(this.rank),o=NA("rc",this.rank),u=new Array(this.rank),s=0;s<n.length;s++)u[n[s]]=o[s];var c="vec2(".concat(u.slice(-2).join(),")"),l="++".concat(o[this.rank-1]," < ").concat(r[this.rank-1]),f="getChannel(getA(".concat(u.join(),"), ").concat(c,")");this.userCode="\n    void main() {\n      ".concat(i," rc = getOutputCoords();\n      vec4 result = vec4(0.);\n      result[0] = ").concat(f,";\n      if(").concat(l,") {\n        result[1] = ").concat(f,";\n      }\n      --").concat(o[this.rank-1],";\n      if(++").concat(o[this.rank-2]," < ").concat(r[this.rank-2],") {\n        result[2] = ").concat(f,";\n        if(").concat(l,") {\n          result[3] = ").concat(f,";\n        }\n      }\n      setOutput(result);\n    }\n    ")}));function FE(e,t,n){var r=(0,ii.env)().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new DE(e.shape,t):new IE(e.shape,t);return n.runWebGLProgram(r,[e],e.dtype)}function ME(e){var t=e.inputs,n=e.backend,r=e.attrs;return function(e,t,n,r){var a=t,i=e.shape.length,o=ii.util.parseAxisParam(a,e.shape),u=o,s=ii.backend_util.getAxesPermutation(u,i),c=null!=s,l=e;c&&(l=FE(e,s,r),u=ii.backend_util.getInnerMostAxes(u.length,i)),ii.backend_util.assertAxesAreInnerMostDims("sum",u,i);var f=ii.backend_util.computeOutAndReduceShapes(l.shape,u),d=(0,C.Z)(f,2),h=d[0],p=d[1],v=h;n&&(v=ii.backend_util.expandShapeToKeepDim(h,o));var m=ii.util.sizeFromShape(p),g=CE({inputs:{x:l},attrs:{shape:[ii.util.sizeFromShape(e.shape)/m,m]},backend:r}),y=TE(g,(0,ii.sumOutType)(e.dtype),"sum",r),b=CE({inputs:{x:y},attrs:{shape:v},backend:r});return r.disposeIntermediateTensorInfo(g),r.disposeIntermediateTensorInfo(y),c&&r.disposeIntermediateTensorInfo(l),b}(t.x,r.axis,r.keepDims,n)}var OE={kernelName:ii.Sum,backendName:"webgl",kernelFunc:ME};function RE(e){for(var t,n=e.inputs,r=e.backend,a=e.attrs,i=n.x,o=a.perm,u=r,s=i.shape.length,c=new Array(s),l=0;l<c.length;l++)c[l]=i.shape[o[l]];if(u.shouldExecuteOnCPU([i])){var f=u.texData.get(i.dataId).values,d=AA(f,i.shape,i.dtype,o,c);t=u.makeTensorInfo(c,i.dtype),u.texData.get(t.dataId).values=d}else t=FE(i,o,u);return t}var jE={kernelName:ii.Transpose,backendName:"webgl",kernelFunc:RE};function BE(e){var t=e.a,n=e.b,r=e.transposeA,a=e.transposeB,i=e.backend,o=e.bias,u=void 0===o?null:o,s=e.preluActivationWeights,c=void 0===s?null:s,l=e.leakyreluAlpha,f=void 0===l?0:l,d=e.activation,h=void 0===d?null:d,p=t.shape.length,v=n.shape.length,m=r?t.shape[p-2]:t.shape[p-1],g=a?n.shape[v-1]:n.shape[v-2],y=r?t.shape[p-1]:t.shape[p-2],b=a?n.shape[v-2]:n.shape[v-1],x=t.shape.slice(0,-2),w=n.shape.slice(0,-2),k=ii.util.sizeFromShape(x),_=ii.util.sizeFromShape(w),S=ii.broadcast_util.assertAndGetBroadcastShape(t.shape.slice(0,-2),n.shape.slice(0,-2)).concat([y,b]);ii.util.assert(m===g,(function(){return"Error in matMul: inner shapes (".concat(m,") and (")+"".concat(g,") of Tensors with shapes ").concat(t.shape," and ")+"".concat(n.shape," and transposeA=").concat(r)+" and transposeB=".concat(a," must match.")}));var C,A=r?[k,m,y]:[k,y,m],E=a?[_,b,g]:[_,g,b],N=CE({inputs:{x:t},backend:i,attrs:{shape:A}}),T=CE({inputs:{x:n},backend:i,attrs:{shape:E}}),I=[N,T],D=Math.max(k,_),F=r?N.shape[1]:N.shape[2],M=null!=u,O=null!=c,R="leakyrelu"===h,j=null!=h?gE(h,!0):null;if((1===y||1===b)&&F>1e3&&!1===(M||O||R||null!=j)){var B=N,z=T;r&&(B=RE({inputs:{x:N},backend:i,attrs:{perm:[0,2,1]}}),I.push(B)),a&&(z=RE({inputs:{x:T},backend:i,attrs:{perm:[0,2,1]}}),I.push(z));var Z=1===b,L=B;1!==b&&(L=CE({inputs:{x:B},backend:i,attrs:{shape:[D,F,1]}}),I.push(L));var P=1===b?2:1,U=z;Z&&(U=CE({inputs:{x:z},backend:i,attrs:{shape:[D,1,F]}}),I.push(U));var W=_E({inputs:{a:L,b:U},backend:i});C=ME({inputs:{x:W},backend:i,attrs:{axis:P,keepDims:!0}}),I.push(W)}else{var V=(0,ii.upcastType)(t.dtype,n.dtype),q=new yE(A,E,[D,y,b],r,a,M,j,O,R),G=[N,T];if(null!=u&&G.push(u),O&&G.push(c),R){var H=i.makeTensorInfo([],"float32",ii.util.createScalarValue(f,"float32"));G.push(H),I.push(H)}C=i.runWebGLProgram(q,G,V)}var X=CE({inputs:{x:C},backend:i,attrs:{shape:S}});I.push(C);for(var K=0,Y=I;K<Y.length;K++){var $=Y[K];i.disposeIntermediateTensorInfo($)}return X}var zE={kernelName:ii._FusedMatMul,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.a,i=t.b,o=t.bias,u=t.preluActivationWeights,s=r.transposeA,c=r.transposeB,l=r.activation;return BE({a:a,b:i,transposeA:s,transposeB:c,backend:n,bias:o,preluActivationWeights:u,leakyreluAlpha:r.leakyreluAlpha,activation:l})}},ZE="return abs(x);";var LE={kernelName:ii.Abs,backendName:"webgl",kernelFunc:function(e){var t,n=e.inputs,r=e.backend,a=n.x;if(r.shouldExecuteOnCPU([a])&&"complex64"!==a.dtype){var i=r.texData.get(a.dataId),o=dA(i.values);return r.makeTensorInfo(a.shape,a.dtype,o)}return t=(0,ii.env)().getBool("WEBGL_PACK_UNARY_OPERATIONS")?new YA(a.shape,ZE):new jA(a.shape,ZE),r.runWebGLProgram(t,[a],a.dtype)}},PE=vE({opSnippet:"if (isnan(x)) return x;\n  if (abs(x) > 1.) {\n    return NAN;\n  }\n  return acos(x);\n"}),UE={kernelName:ii.Acos,backendName:"webgl",kernelFunc:PE},WE=vE({opSnippet:"if (isnan(x)) return x;\n  if (x < 1.0) return NAN;\nreturn log(x + sqrt(x * x - 1.0));"}),VE={kernelName:ii.Acosh,backendName:"webgl",kernelFunc:WE},qE="return a + b;",GE=mE({opSnippet:qE,packedOpSnippet:qE,supportsComplex:!0,cpuKernelImpl:MC}),HE={kernelName:ii.Add,backendName:"webgl",kernelFunc:GE},XE=(0,F.Z)((function e(t,n){(0,D.Z)(this,e),this.outputShape=[],this.outputShape=t,this.variableNames=n.map((function(e,t){return"T".concat(t)}));var r=[];this.variableNames.forEach((function(e){r.push("float v".concat(e," = get").concat(e,"AtOutCoords();"))}));var a=this.variableNames.map((function(e){return"v".concat(e)})).join(" + ");this.userCode="\n      void main() {\n        ".concat(r.join("\n        "),"\n\n        float result = ").concat(a,";\n        setOutput(result);\n      }\n    ")})),KE=(0,F.Z)((function e(t,n){(0,D.Z)(this,e),this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.variableNames=n.map((function(e,t){return"T".concat(t)}));var r=[];this.variableNames.forEach((function(e){r.push("vec4 v".concat(e," = get").concat(e,"AtOutCoords();"))}));var a=this.variableNames.map((function(e){return"v".concat(e)})).join(" + ");this.userCode="\n      void main() {\n        ".concat(r.join("\n        "),"\n\n        vec4 result = ").concat(a,";\n        setOutput(result);\n      }\n    ")}));var YE={kernelName:ii.AddN,backendName:"webgl",kernelFunc:function e(t){var n=t.inputs,r=t.backend,a=n;if(1===a.length)return iE({inputs:{x:a[0]},backend:r});if(a.length>(0,ii.env)().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){var i=Math.floor(a.length/2),o=e({inputs:a.slice(0,i),backend:r}),u=e({inputs:a.slice(i),backend:r});return e({inputs:[o,u],backend:r})}var s=a.map((function(e){return e.dtype})).reduce((function(e,t){return(0,ii.upcastType)(e,t)})),c=a.map((function(e){return e.shape})),l=(0,ii.env)().getBool("WEBGL_PACK")?new KE(a[0].shape,c):new XE(a[0].shape,c);return r.runWebGLProgram(l,a,s)}};var $E={kernelName:ii.All,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.axis,o=r.keepDims,u=a.shape.length,s=ii.util.parseAxisParam(i,a.shape),c=s,l=ii.backend_util.getAxesPermutation(c,u),f=a;null!=l&&(f=RE({inputs:{x:a},backend:n,attrs:{perm:l}}),c=ii.backend_util.getInnerMostAxes(c.length,u)),ii.backend_util.assertAxesAreInnerMostDims("all",c,u);var d,h=ii.backend_util.computeOutAndReduceShapes(f.shape,c),p=(0,C.Z)(h,2),v=p[0],m=p[1],g=CE({inputs:{x:f},backend:n,attrs:{shape:[-1,ii.util.sizeFromShape(m)]}}),y=TE(g,g.dtype,"all",n);return d=CE(o?{inputs:{x:y},backend:n,attrs:{shape:ii.backend_util.expandShapeToKeepDim(v,s)}}:{inputs:{x:y},backend:n,attrs:{shape:v}}),n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(y),null!=l&&n.disposeIntermediateTensorInfo(f),d}};var QE={kernelName:ii.Any,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.axis,o=r.keepDims,u=a.shape.length,s=ii.util.parseAxisParam(i,a.shape),c=s,l=ii.backend_util.getAxesPermutation(c,u),f=a;null!=l&&(f=RE({inputs:{x:a},backend:n,attrs:{perm:l}}),c=ii.backend_util.getInnerMostAxes(c.length,u)),ii.backend_util.assertAxesAreInnerMostDims("any",c,u);var d,h=ii.backend_util.computeOutAndReduceShapes(f.shape,c),p=(0,C.Z)(h,2),v=p[0],m=p[1],g=CE({inputs:{x:f},backend:n,attrs:{shape:[-1,ii.util.sizeFromShape(m)]}}),y=TE(g,g.dtype,"any",n);return d=CE(o?{inputs:{x:y},backend:n,attrs:{shape:ii.backend_util.expandShapeToKeepDim(v,s)}}:{inputs:{x:y},backend:n,attrs:{shape:v}}),n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(y),null!=l&&n.disposeIntermediateTensorInfo(f),d}},JE=(0,F.Z)((function e(t,n,r){(0,D.Z)(this,e),this.variableNames=["A"];var a=t.windowSize,i=t.batchSize,o=t.outSize;r||this.variableNames.push("bestIndicesA"),this.outputShape=[i,o];var u="max"===n?">":"<",s=r?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * ".concat(a,";\n\n        int bestIndex = inOffset;\n        float bestValue = getA(batch, bestIndex);\n\n        for (int i = 0; i < ").concat(a,"; i++) {\n          int inIdx = ").concat(s,";\n          float candidate = getA(batch, inIdx);\n          if (candidate ").concat(u," bestValue) {\n            bestValue = candidate;\n            bestIndex = inIdx;\n          }\n        }\n        setOutput(float(bestIndex));\n      }\n    ")})),eN=(0,F.Z)((function e(t,n,r,a){(0,D.Z)(this,e),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,ii.util.assert(t.length>2,(function(){return"Packed arg".concat(r.charAt(0).toUpperCase()+r.slice(1)," supports only inputs with rank above 2.")}));var i=t[t.length-1],o=Math.ceil(i/n);this.outputShape=t.slice(0,-1),o>1&&this.outputShape.push(o),a||this.variableNames.push("bestIndicesA");var u,s,c=this.outputShape,l=c.length,f=iC(l),d=TA("coords",l);if(1===o){var h=iC(s=l+1);u="\n        ".concat(h," sourceLocR = ").concat(h,"(").concat(d.join(),", 0);\n        ++").concat(d[l-1],";\n        ").concat(h," sourceLocG = ").concat(h,"(").concat(d.join(),", 0);\n        ++").concat(d[l-2],";\n        ").concat(h," sourceLocA = ").concat(h,"(").concat(d.join(),", 0);\n        --").concat(d[l-1],";\n        ").concat(h," sourceLocB = ").concat(h,"(").concat(d.join(),", 0);\n        --").concat(d[l-2],";")}else s=l,u="\n        ".concat(f," sourceLocR = coords;\n        ++").concat(d[l-1],";\n        ").concat(f," sourceLocG = coords;\n        ++").concat(d[l-2],";\n        ").concat(f," sourceLocA = coords;\n        --").concat(d[l-1],";\n        ").concat(f," sourceLocB = coords;\n        --").concat(d[l-2],";");var p=["x","y","z","w","u","v"].slice(0,s),v="."+p[s-1],m=p.map((function(e){return"int "+e})),g=TA("sourceLocR",s-1).concat("inIdx.r"),y=TA("sourceLocG",s-1).concat("inIdx.g"),b=TA("sourceLocB",s-1).concat("inIdx.b"),x=TA("sourceLocA",s-1).concat("inIdx.a"),w="max"===r?"greaterThan":"lessThan",k=a?"":"\n          inIdx = round(vec4(getBestIndicesAChannel(".concat(g.join(),"),\n                             getBestIndicesAChannel(").concat(y.join(),"),\n                             getBestIndicesAChannel(").concat(b.join(),"),\n                             getBestIndicesAChannel(").concat(x.join(),")));"),_="vec4(\n            getAChannel(".concat(g.join(),"),\n            hasNextCol ? getAChannel(").concat(y.join(),") : 0.,\n            hasNextRow ? getAChannel(").concat(b.join(),") : 0.,\n            hasNextRow && hasNextCol ? getAChannel(").concat(x.join(),") : 0.)"),S=a?"":"\n      float getBestIndicesAChannel(".concat(m.join(),") {\n        return getChannel(getBestIndicesA(").concat(p.join(),"),\n                                          vec2(").concat(p.slice(-2).join(),"));\n      }");this.userCode="\n      float getAChannel(".concat(m.join(),") {\n        return getChannel(getA(").concat(p.join(),"),\n                               vec2(").concat(p.slice(-2).join(),"));\n      }\n      ").concat(S,"\n      void main() {\n        ").concat(f," coords = getOutputCoords();\n        bool hasNextCol = ").concat(d[l-1]," < ").concat(c[l-1]-1,";\n        bool hasNextRow = ").concat(d[l-2]," < ").concat(c[l-2]-1,";\n        ").concat(u,"\n        ivec4 srcIdx = ivec4(sourceLocR").concat(v,", sourceLocG").concat(v,",\n          sourceLocB").concat(v,", sourceLocA").concat(v,") * ").concat(n,";\n        ivec4 inIdx = srcIdx;\n        vec4 bestIndex = vec4(inIdx);\n        vec4 bestValue = ").concat(_,";\n\n        for (int i = 0; i < ").concat(n,"; i++) {\n          inIdx = srcIdx;\n          ").concat(k,"\n          vec4 candidate = ").concat(_,";\n          bvec4 nan = isnan(candidate);\n          bvec4 replace = bvec4(\n            vec4(").concat(w,"(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));\n\n          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,\n                           replace.y  ? candidate.y : bestValue.y,\n                           replace.z  ? candidate.z : bestValue.z,\n                           replace.w  ? candidate.w : bestValue.w);\n          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));\n          srcIdx++;\n        }\n        setOutput(bestIndex);\n      }\n    ")}));function tN(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=t.shape[0],i=t.shape[1];null!=r&&(a=r.shape[0],i=r.shape[1]);var o=ii.backend_util.computeOptimalWindowSize(i),u={windowSize:o,inSize:i,batchSize:a,outSize:Math.ceil(i/o)},s=new JE(u,n,null==r),c=[t];null!=r&&c.push(r);var l=e.runWebGLProgram(s,c,"int32");if(1===l.shape[1])return l;var f=tN(e,t,n,l);return e.disposeIntermediateTensorInfo(l),f}function nN(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=null!=r?r.shape:t.shape,i=a[a.length-1],o=ii.backend_util.computeOptimalWindowSize(i),u=new eN(a,o,n,null==r),s=null==r?[t]:[t,r],c=e.runWebGLProgram(u,s,"int32");if(c.shape.length===t.shape.length){var l=nN(e,t,n,c);return e.disposeIntermediateTensorInfo(c),l}return c}function rN(e,t,n,r){var a=[n];if(ii.backend_util.assertAxesAreInnerMostDims("arg"+r.charAt(0).toUpperCase()+r.slice(1),a,t.shape.length),!(0,ii.env)().getBool("WEBGL_PACK_REDUCE")||t.shape.length<=2){var i=[],o=e.texData.get(t.dataId),u=t;null!==o&&o.isPacked&&(u=e.unpackTensor(t),i.push(u));var s=ii.backend_util.computeOutAndReduceShapes(u.shape,a),c=(0,C.Z)(s,2),l=c[0],f=c[1],d=ii.util.sizeFromShape(f),h=CE({inputs:{x:u},backend:e,attrs:{shape:[-1,d]}});i.push(h);var p=tN(e,h,r);i.push(p);var v=CE({inputs:{x:p},backend:e,attrs:{shape:l}});return i.forEach((function(t){return e.disposeIntermediateTensorInfo(t)})),v}return nN(e,t,r)}var aN={kernelName:ii.ArgMax,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.axis,o=ii.util.parseAxisParam(i,a.shape),u=ii.backend_util.getAxesPermutation(o,a.shape.length),s=a,c=[];null!=u&&(s=RE({inputs:{x:a},backend:n,attrs:{perm:u}}),c.push(s),o=ii.backend_util.getInnerMostAxes(o.length,s.shape.length)),ii.backend_util.assertAxesAreInnerMostDims("argMax",[o[0]],s.shape.length);var l=rN(n,s,o[0],"max");return c.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),l}};var iN={kernelName:ii.ArgMin,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.axis,o=ii.util.parseAxisParam(i,a.shape),u=ii.backend_util.getAxesPermutation(o,a.shape.length),s=a,c=[];null!=u&&(s=RE({inputs:{x:a},backend:n,attrs:{perm:u}}),c.push(s),o=ii.backend_util.getInnerMostAxes(o.length,s.shape.length)),ii.backend_util.assertAxesAreInnerMostDims("argMin",[o[0]],s.shape.length);var l=rN(n,s,o[0],"min");return c.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),l}},oN=vE({opSnippet:"if (isnan(x)) return x;\n  if (abs(x) > 1.) {\n    return NAN;\n  }\n  return asin(x);\n"}),uN={kernelName:ii.Asin,backendName:"webgl",kernelFunc:oN},sN=vE({opSnippet:"if (isnan(x)) return x;return log(x + sqrt(x * x + 1.0));"}),cN={kernelName:ii.Asinh,backendName:"webgl",kernelFunc:sN},lN=vE({opSnippet:"if (isnan(x)) return x;\n  return atan(x);\n"}),fN={kernelName:ii.Atan,backendName:"webgl",kernelFunc:lN},dN=mE({opSnippet:"\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n\n  return atan(a, b);\n",packedOpSnippet:"\n  vec4 result = atan(a, b);\n  bvec4 isNaNA = isnan(a);\n  bvec4 isNaNB = isnan(b);\n  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);\n  \n  result.r = isNaN.r ? NAN : result.r;\n  result.g = isNaN.g ? NAN : result.g;\n  result.b = isNaN.b ? NAN : result.b;\n  result.a = isNaN.a ? NAN : result.a;\n\n  return result;\n"}),hN={kernelName:ii.Atan2,backendName:"webgl",kernelFunc:dN},pN=vE({opSnippet:"if (isnan(x)) return x;\n  if ((x < -1.0) || (x > 1.0)) return NAN;\nreturn (log(1.0 + x) - log(1.0 - x)) / 2.0;"}),vN={kernelName:ii.Atanh,backendName:"webgl",kernelFunc:pN},mN=(0,F.Z)((function e(t,n,r){var a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if((0,D.Z)(this,e),this.variableNames=["x"],"avg"===n&&r)throw new Error("Cannot compute positions for average pool.");var o=t.filterWidth,u=t.strideHeight,s=t.strideWidth,c=t.dilationHeight,l=t.dilationWidth,f=t.effectiveFilterHeight,d=t.effectiveFilterWidth,h=t.padInfo.top,p=t.padInfo.left;this.outputShape=t.outShape;var v="avg"===n,m="((batch  * ".concat(t.inHeight," + xR) * ").concat(t.inWidth," + xC) * ").concat(t.inChannels," + d"),g="(xR * ".concat(t.inWidth," + xC) * ").concat(t.inChannels," + d"),y="0.0";if(v||(y="-1.0 / 1e-20"),r){var b=">=";this.userCode="\n        const ivec2 strides = ivec2(".concat(u,", ").concat(s,");\n        const ivec2 pads = ivec2(").concat(h,", ").concat(p,");\n\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int batch = coords[0];\n          int d = coords[3];\n\n          ivec2 xRCCorner = coords.yz * strides - pads;\n          int xRCorner = xRCCorner.x;\n          int xCCorner = xRCCorner.y;\n\n          // max/min x(?, ?, d) to get y(yR, yC, d).\n          // ? = to be determined\n          float minMaxValue = 0.0;\n          float minMaxValueFound = 0.0;\n          int minMaxPosition = 0;\n          float avgValue = 0.0;\n\n          for (int wR = 0; wR < ").concat(f,";\n              wR += ").concat(c,") {\n            int xR = xRCorner + wR;\n\n            if (xR < 0 || xR >= ").concat(t.inHeight,") {\n              continue;\n            }\n\n            for (int wC = 0; wC < ").concat(d,";\n                wC += ").concat(l,") {\n              int xC = xCCorner + wC;\n\n              if (xC < 0 || xC >= ").concat(t.inWidth,") {\n                continue;\n              }\n\n              float value = getX(batch, xR, xC, d);\n\n              // If a min / max value has already been found, use it. If not,\n              // use the current value.\n              float currMinMaxValue = mix(\n                  value, minMaxValue, minMaxValueFound);\n              if (value ").concat(b," currMinMaxValue) {\n                minMaxValue = value;\n                minMaxValueFound = 1.0;\n                minMaxPosition = ").concat(a?i?m:g:"wR * ".concat(d," + wC"),";\n              }\n            }\n          }\n          setOutput(float(minMaxPosition));\n        }\n      ")}else{var x="max",w="".concat(n,"(").concat(n,"(").concat(n,"(")+"minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"avg"===n&&(w="avgValue / max(count, 1.0)");var k=4*Math.floor(o/4),_=o%4,S="\n      if (".concat(v,") {\n        avgValue += dot(values, ones);\n      } else {\n        minMaxValue = ").concat(x,"(values, minMaxValue);\n      }\n    ");this.userCode="\n      const ivec2 strides = ivec2(".concat(u,", ").concat(s,");\n      const ivec2 pads = ivec2(").concat(h,", ").concat(p,");\n      const float initializationValue = ").concat(y,";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float count = 0.0;\n\n      float getValue(int batch, int xR, int xC, int d) {\n        if (xC < 0 || xC >= ").concat(t.inWidth,") {\n          return initializationValue;\n        }\n        count += 1.0;\n        return getX(batch, xR, xC, d);\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d = coords[3];\n\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // max/min x(?, ?, d) to get y(yR, yC, d).\n        // ? = to be determined\n        vec4 minMaxValue = vec4(").concat(y,");\n        float avgValue = 0.0;\n        count = 0.0;\n\n        for (int wR = 0; wR < ").concat(f,";\n            wR += ").concat(c,") {\n          int xR = xRCorner + wR;\n\n          if (xR < 0 || xR >= ").concat(t.inHeight,") {\n            continue;\n          }\n\n          for (int wC = 0; wC < ").concat(k,"; wC += 4) {\n            int xC = xCCorner + wC * ").concat(l,";\n\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + ").concat(l,", d),\n              getValue(batch, xR, xC + 2 * ").concat(l,", d),\n              getValue(batch, xR, xC + 3 * ").concat(l,", d)\n            );\n\n            ").concat(S,"\n          }\n\n          int xC = xCCorner + ").concat(k,";\n          if (").concat(1===_,") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              initializationValue,\n              initializationValue,\n              initializationValue\n            );\n\n            ").concat(S,"\n          } else if (").concat(2===_,") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + ").concat(l,", d),\n              initializationValue,\n              initializationValue\n            );\n\n            ").concat(S,"\n          } else if (").concat(3===_,") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + ").concat(l,", d),\n              getValue(batch, xR, xC + 2 * ").concat(l,", d),\n              initializationValue\n            );\n\n            ").concat(S,"\n          }\n        }\n        setOutput(").concat(w,");\n      }\n    ")}})),gN=(0,F.Z)((function e(t,n,r){var a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if((0,D.Z)(this,e),this.variableNames=["x"],"avg"===n&&r)throw new Error("Cannot compute positions for average pool.");var o=t.filterWidth,u=t.strideDepth,s=t.strideHeight,c=t.strideWidth,l=t.dilationDepth,f=t.dilationHeight,d=t.dilationWidth,h=t.effectiveFilterDepth,p=t.effectiveFilterHeight,v=t.effectiveFilterWidth,m=t.padInfo.front,g=t.padInfo.top,y=t.padInfo.left;this.outputShape=t.outShape;var b="avg"===n,x="0.0";if(b||(x="-1.0 / 1e-20"),r){var w=">=";this.userCode="\n        const ivec3 strides =\n            ivec3(".concat(u,", ").concat(s,", ").concat(c,");\n        const ivec3 pads = ivec3(").concat(m,", ").concat(g,", ").concat(y,");\n\n        void main() {\n          ivec5 coords = getOutputCoords();\n          int batch = coords.x;\n          int ch = coords.u;\n\n          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n          int xDCorner = xCorner.x;\n          int xRCorner = xCorner.y;\n          int xCCorner = xCorner.z;\n\n          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).\n          // ? = to be determined\n          float minMaxValue = 0.0;\n          float minMaxValueFound = 0.0;\n          int minMaxPosition = 0;\n\n          for (int wD = 0; wD < ").concat(h,";\n              wD += ").concat(l,") {\n            int xD = xDCorner + wD;\n\n            if (xD < 0 || xD >= ").concat(t.inDepth,") {\n              continue;\n            }\n\n            for (int wR = 0; wR < ").concat(p,";\n                wR += ").concat(f,") {\n              int xR = xRCorner + wR;\n\n              if (xR < 0 || xR >= ").concat(t.inHeight,") {\n                continue;\n              }\n\n              for (int wC = 0; wC < ").concat(v,";\n                  wC += ").concat(d,") {\n                int xC = xCCorner + wC;\n\n                if (xC < 0 || xC >= ").concat(t.inWidth,") {\n                  continue;\n                }\n\n                float value = getX(batch, xD, xR, xC, ch);\n\n                // If a min / max value has already been found, use it. If not,\n                // use the current value.\n                float currMinMaxValue = mix(\n                    value, minMaxValue, minMaxValueFound);\n                if (value ").concat(w," currMinMaxValue) {\n                  minMaxValue = value;\n                  minMaxValueFound = 1.0;\n                  minMaxPosition = ").concat(a?i?"(((batch * ".concat(t.inDepth," + xD) * ").concat(t.inHeight," + xR) * ").concat(t.inWidth," + xC) * ").concat(t.inChannels," + ch"):"((xD * ".concat(t.inHeight," + xR) * ").concat(t.inWidth," + xC) * ").concat(t.inChannels," + ch"):"wD * ".concat(p," * ").concat(v," +\n                      wR * ").concat(v," + wC"),";\n                }\n              }\n            }\n          }\n          setOutput(float(minMaxPosition));\n        }\n      ")}else{var k="max",_="".concat(n,"(").concat(n,"(").concat(n,"(")+"minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"avg"===n&&(_="avgValue / max(count, 1.0)");var S=4*Math.floor(o/4),C=o%4,A="\n      if (".concat(b,") {\n        avgValue += dot(values, ones);\n      } else {\n        minMaxValue = ").concat(k,"(values, minMaxValue);\n      }\n    ");this.userCode="\n      const ivec3 strides =\n        ivec3(".concat(u,", ").concat(s,", ").concat(c,");\n      const ivec3 pads = ivec3(").concat(m,", ").concat(g,", ").concat(y,");\n      const float initializationValue = ").concat(x,";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float count = 0.0;\n\n      float getValue(int batch, int xD, int xR, int xC, int ch) {\n        if (xC < 0 || xC >= ").concat(t.inWidth,") {\n          return initializationValue;\n        }\n        count += 1.0;\n        return getX(batch, xD, xR, xC, ch);\n      }\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n        int xDCorner = xCorner.x;\n        int xRCorner = xCorner.y;\n        int xCCorner = xCorner.z;\n\n        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).\n        // ? = to be determined\n        vec4 minMaxValue = vec4(").concat(x,");\n        float avgValue = 0.0;\n        count = 0.0;\n\n        for (int wD = 0; wD < ").concat(h,";\n            wD += ").concat(l,") {\n          int xD = xDCorner + wD;\n\n          if (xD < 0 || xD >= ").concat(t.inDepth,") {\n            continue;\n          }\n\n          for (int wR = 0; wR < ").concat(p,";\n            wR += ").concat(f,") {\n            int xR = xRCorner + wR;\n\n            if (xR < 0 || xR >= ").concat(t.inHeight,") {\n              continue;\n            }\n\n            for (int wC = 0; wC < ").concat(S,"; wC += 4) {\n              int xC = xCCorner + wC * ").concat(d,";\n\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + ").concat(d,", ch),\n                getValue(batch, xD, xR, xC + 2 * ").concat(d,", ch),\n                getValue(batch, xD, xR, xC + 3 * ").concat(d,", ch)\n              );\n\n              ").concat(A,"\n            }\n\n            int xC = xCCorner + ").concat(S,";\n            if (").concat(1===C,") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                initializationValue,\n                initializationValue,\n                initializationValue\n              );\n\n              ").concat(A,"\n            } else if (").concat(2===C,") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + ").concat(d,", ch),\n                initializationValue,\n                initializationValue\n              );\n\n              ").concat(A,"\n            } else if (").concat(3===C,") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + ").concat(d,", ch),\n                getValue(batch, xD, xR, xC + 2 * ").concat(d,", ch),\n                initializationValue\n              );\n\n              ").concat(A,"\n            }\n          }\n        }\n        setOutput(").concat(_,");\n      }\n    ")}}));var yN={kernelName:ii.AvgPool,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x;FS(a,"avgPool");var i=r.filterSize,o=r.strides,u=r.pad,s=r.dimRoundingMode;ii.util.assert(ii.backend_util.eitherStridesOrDilationsAreOne(o,1),(function(){return"Error in avgPool: Either strides or dilations must be 1. "+"Got strides ".concat(o," and dilations '").concat(1,"'")}));var c=ii.backend_util.computePool2DInfo(a.shape,i,o,1,u,s);if(1===c.filterWidth&&1===c.filterHeight&&ii.util.arraysEqual(c.inShape,c.outShape))return iE({inputs:{x:a},backend:n});var l=new mN(c,"avg",!1);return n.runWebGLProgram(l,[a],"float32")}};var bN={kernelName:ii.AvgPool3D,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.filterSize,o=r.strides,u=r.pad,s=r.dimRoundingMode,c=r.dataFormat,l=ii.backend_util.computePool3DInfo(a.shape,i,o,[1,1,1],u,s,c),f=new gN(l,"avg",!1);return n.runWebGLProgram(f,[a],"float32")}},xN=(0,F.Z)((function e(t){(0,D.Z)(this,e),this.variableNames=["dy"],this.outputShape=t.inShape;var n=t.filterHeight,r=t.filterWidth,a=t.strideHeight,i=t.strideWidth,o=t.dilationHeight,u=t.dilationWidth,s=t.effectiveFilterHeight,c=t.effectiveFilterWidth,l=s-1-t.padInfo.top,f=c-1-t.padInfo.left,d=1/(n*r);this.userCode="\n      const ivec2 pads = ivec2(".concat(l,", ").concat(f,");\n      const float avgMultiplier = float(").concat(d,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n\n        ivec2 dyRCCorner = coords.yz - pads;\n        int dyRCorner = dyRCCorner.x;\n        int dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ").concat(s,";\n            wR += ").concat(o,") {\n          float dyR = float(dyRCorner + wR) / ").concat(a,".0;\n\n          if (dyR < 0.0 || dyR >= ").concat(t.outHeight,".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          for (int wC = 0; wC < ").concat(c,";\n            wC+= ").concat(u,") {\n            float dyC = float(dyCCorner + wC) / ").concat(i,".0;\n\n            if (dyC < 0.0 || dyC >= ").concat(t.outWidth,".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            float dyValue = getDy(b, idyR, idyC, d);\n\n            dotProd += dyValue * avgMultiplier;\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")})),wN=(0,F.Z)((function e(t){(0,D.Z)(this,e),this.variableNames=["dy"],this.outputShape=t.inShape;var n=t.filterDepth,r=t.filterHeight,a=t.filterWidth,i=t.strideDepth,o=t.strideHeight,u=t.strideWidth,s=t.dilationDepth,c=t.dilationHeight,l=t.dilationWidth,f=t.effectiveFilterDepth,d=t.effectiveFilterHeight,h=t.effectiveFilterWidth,p=f-1-t.padInfo.front,v=d-1-t.padInfo.top,m=h-1-t.padInfo.left,g=1/(n*r*a);this.userCode="\n      const ivec3 pads = ivec3(".concat(p,", ").concat(v,", ").concat(m,");\n      const float avgMultiplier = float(").concat(g,");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyDCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get\n        // dx(xD, xR, xC, ch).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int wD = 0; wD < ").concat(f,";\n            wD += ").concat(s,") {\n          float dyD = float(dyDCorner + wD) / ").concat(i,".0;\n\n          if (dyD < 0.0 || dyD >= ").concat(t.outDepth,".0 || fract(dyD) > 0.0) {\n            continue;\n          }\n          int idyD = int(dyD);\n\n          for (int wR = 0; wR < ").concat(d,";\n              wR += ").concat(c,") {\n            float dyR = float(dyRCorner + wR) / ").concat(o,".0;\n\n            if (dyR < 0.0 || dyR >= ").concat(t.outHeight,".0 ||\n                fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            for (int wC = 0; wC < ").concat(h,";\n                wC += ").concat(l,") {\n              float dyC = float(dyCCorner + wC) / ").concat(u,".0;\n\n              if (dyC < 0.0 || dyC >= ").concat(t.outWidth,".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              float dyValue = getDy(batch, idyD, idyR, idyC, ch);\n\n              dotProd += dyValue * avgMultiplier;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}));var kN={kernelName:ii.AvgPool3DGrad,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.dy,i=t.input,o=r.filterSize,u=r.strides,s=r.pad,c=r.dimRoundingMode,l=ii.backend_util.computePool3DInfo(i.shape,o,u,[1,1,1],s,c),f=new wN(l);return n.runWebGLProgram(f,[a],i.dtype)}};var _N={kernelName:ii.AvgPoolGrad,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.dy,i=t.input,o=i;FS([a,i],"avgPoolGrad");var u=r.filterSize,s=r.strides,c=r.pad,l=ii.backend_util.computePool2DInfo(o.shape,u,s,1,c),f=new xN(l);return n.runWebGLProgram(f,[a],o.dtype)}};var SN={kernelName:ii.BatchMatMul,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs;return BE({a:t.a,b:t.b,transposeA:r.transposeA,transposeB:r.transposeB,backend:n})}},CN=(0,F.Z)((function e(t,n,r,a,i,o){(0,D.Z)(this,e),this.outputShape=[],this.variableNames=["x","mean","variance"],ii.backend_util.assertAndGetBroadcastShape(t,n),ii.backend_util.assertAndGetBroadcastShape(t,r);var u="0.0";null!=a&&(ii.backend_util.assertAndGetBroadcastShape(t,a),this.variableNames.push("offset"),u="getOffsetAtOutCoords()");var s="1.0";null!=i&&(ii.backend_util.assertAndGetBroadcastShape(t,i),this.variableNames.push("scale"),s="getScaleAtOutCoords()"),this.outputShape=t,this.userCode="\n      void main() {\n        float x = getXAtOutCoords();\n        float mean = getMeanAtOutCoords();\n        float variance = getVarianceAtOutCoords();\n        float offset = ".concat(u,";\n        float scale = ").concat(s,";\n        float inv = scale * inversesqrt(variance + float(").concat(o,"));\n        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));\n      }\n    ")})),AN=(0,F.Z)((function e(t,n,r,a,i,o){(0,D.Z)(this,e),this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],ii.backend_util.assertAndGetBroadcastShape(t,n),ii.backend_util.assertAndGetBroadcastShape(t,r);var u="vec4(0.0)";null!=a&&(ii.backend_util.assertAndGetBroadcastShape(t,a),this.variableNames.push("offset"),u="getOffsetAtOutCoords()");var s="vec4(1.0)";null!=i&&(ii.backend_util.assertAndGetBroadcastShape(t,i),this.variableNames.push("scale"),s="getScaleAtOutCoords()"),this.outputShape=t,this.userCode="\n      void main() {\n        vec4 offset = ".concat(u,";\n        vec4 scale = ").concat(s,";\n\n        vec4 x = getXAtOutCoords();\n        vec4 mean = getMeanAtOutCoords();\n        vec4 variance = getVarianceAtOutCoords();\n\n        vec4 inv = scale * inversesqrt(variance + vec4(").concat(o,"));\n\n        setOutput((x - mean) * inv + offset);\n      }\n    ")})),EN={kernelName:ii.FusedBatchNorm,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.mean,o=t.variance,u=t.offset,s=t.scale;ii.util.assert(i.shape.length===o.shape.length,(function(){return"Batch normalization gradient requires mean and variance to have equal ranks."})),ii.util.assert(null==u||i.shape.length===u.shape.length,(function(){return"Batch normalization gradient requires mean and offset to have equal ranks."})),ii.util.assert(null==s||i.shape.length===s.shape.length,(function(){return"Batch normalization gradient requires mean and scale to have equal ranks."}));var c=r.varianceEpsilon;null==c&&(c=.001);var l=[a,i,o],f=null;null!=u&&(f=u.shape,l.push(u));var d=null;null!=s&&(d=s.shape,l.push(s));var h=(0,ii.env)().getBool("WEBGL_PACK_NORMALIZATION")?new AN(a.shape,i.shape,o.shape,f,d,c):new CN(a.shape,i.shape,o.shape,f,d,c);return n.runWebGLProgram(h,l,l[0].dtype)}},NN=(0,F.Z)((function e(t){(0,D.Z)(this,e),this.variableNames=["source"],this.outputShape=t,this.rank=t.length;var n=iC(this.rank);this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];var r,a=function(e){if(1===e)return"sourceLoc";if(e<=6)return TN.slice(0,e).map((function(e){return"sourceLoc."+e})).join(",");throw Error("Slicing for rank ".concat(e," is not yet supported"))}(this.rank),i=t.map((function(e,t){return"sourceLoc.".concat(TN[t]," = start[").concat(t,"] + coords.").concat(TN[t],";")}));r="\n        ".concat(n," sourceLoc;\n        ").concat(n," coords = getOutputCoords();\n        ").concat(i.join("\n"),"\n      "),this.userCode="\n      void main() {\n        ".concat(r,"\n        setOutput(getSource(").concat(a,"));\n      }\n    ")})),TN=["x","y","z","w","u","v"];var IN=(0,F.Z)((function e(t){(0,D.Z)(this,e),this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.rank=t.length,this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];var n=iC(this.rank),r=TA("coords",this.rank),a=TA("sourceLoc",this.rank),i=1===this.rank?"sourceLoc":"vec2(".concat(a.slice(-2).join(),")"),o="getChannel(getSource(".concat(a.join(),"), ").concat(i,")"),u="\n      result.x = ".concat(o,";\n      if (++").concat(r[this.rank-1]," < ").concat(t[this.rank-1],") {\n        ++").concat(a[this.rank-1],";\n        result.y = ").concat(o,";\n        --").concat(a[this.rank-1],";\n      }\n    "),s=1===this.rank?"":"\n      --".concat(r[this.rank-1],";\n      if (++").concat(r[this.rank-2]," < ").concat(t[this.rank-2],") {\n        ++").concat(a[this.rank-2],";\n        result.z = ").concat(o,";\n        if (++").concat(r[this.rank-1]," < ").concat(t[this.rank-1],") {\n          ++").concat(a[this.rank-1],";\n          result.w = ").concat(o,";\n        }\n      }\n    "),c=this.rank<=4?"sourceLoc = coords +\n            ".concat(n,"(").concat(t.map((function(e,t){return"start[".concat(t,"]")})).join(),");"):t.map((function(e,t){return"".concat(a[t]," = ").concat(r[t]," + start[").concat(t,"];")})).join("\n");this.userCode="\n      void main() {\n        ".concat(n," coords = getOutputCoords();\n        ").concat(n," sourceLoc;\n        ").concat(c,"\n        vec4 result = vec4(0.);\n        ").concat(u,"\n        ").concat(s,"\n        setOutput(result);\n      }\n    ")}));function DN(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.begin,o=r.size,u=ii.slice_util.parseSliceParams(a,i,o),s=(0,C.Z)(u,2),c=s[0],l=s[1];if(ii.slice_util.assertParamsValid(a,c,l),0===ii.util.sizeFromShape(l))return n.makeTensorInfo(l,a.dtype,[]);if(n.shouldExecuteOnCPU([a])||"string"===a.dtype){var f=n.texData.get(a.dataId),d=hA(f.values,c,l,a.shape,a.dtype);return n.makeTensorInfo(l,a.dtype,d)}var h=n.texData.get(a.dataId).isPacked,p=ii.slice_util.isSliceContinous(a.shape,c,l);if(h||!p){var v=(0,ii.env)().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new IN(l):new NN(l),m=[c];return n.runWebGLProgram(v,[a],a.dtype,m)}return n.uploadToGPU(a.dataId),function(e,t,n,r){var a=r.texData.get(e.dataId),i=r.makeTensorInfo(n,e.dtype),o=r.texData.get(i.dataId);Object.assign(o,a),o.refCount=1,o.shape=n,o.dtype=e.dtype;var u=ii.slice_util.computeFlatOffset(t,ii.util.computeStrides(e.shape));a.slice&&(u+=a.slice.flatOffset),o.slice={flatOffset:u,origDataId:a.slice&&a.slice.origDataId||e.dataId};var s=r.dataRefCount.get(o.slice.origDataId)||1;return r.dataRefCount.set(o.slice.origDataId,s+1),i}(a,c,l,n)}var FN={kernelName:ii.Slice,backendName:"webgl",kernelFunc:DN},MN={kernelName:ii.BatchToSpaceND,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.blockShape,o=r.crops;ii.util.assert(a.shape.length<=4,(function(){return"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet"}));var u=i.reduce((function(e,t){return e*t})),s=ii.backend_util.getReshaped(a.shape,i,u),c=ii.backend_util.getPermuted(s.length,i.length),l=ii.backend_util.getReshapedPermuted(a.shape,i,u),f=ii.backend_util.getSliceBeginCoords(o,i.length),d=ii.backend_util.getSliceSize(l,o,i.length),h=[],p=CE({inputs:{x:a},backend:n,attrs:{shape:s}}),v=RE({inputs:{x:p},backend:n,attrs:{perm:c}}),m=CE({inputs:{x:v},backend:n,attrs:{shape:l}}),g=DN({inputs:{x:m},backend:n,attrs:{begin:f,size:d}});return h.push(p),h.push(v),h.push(m),h.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),g}};var ON={kernelName:ii.Bincount,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.weights,o=r.size,u=n.readSync(a.dataId),s=n.readSync(i.dataId),c=OC(u,s,i.dtype,i.shape,o);return n.makeTensorInfo([o],i.dtype,c)}};var RN={kernelName:ii.BitwiseAnd,backendName:"webgl",kernelFunc:function(e){var t,n=e.inputs,r=e.backend,a=n.a,i=n.b,o=(0,ii.env)().getBool("WEBGL_PACK_BINARY_OPERATIONS"),u=(0,ii.env)().getNumber("WEBGL_VERSION");if(r.shouldExecuteOnCPU([a,i])||1===u){var s=r.texData.get(a.dataId).values,c=r.texData.get(i.dataId).values,l=jC(a.shape,i.shape,s,c,a.dtype),f=(0,C.Z)(l,2),d=f[0],h=f[1],p=r.makeTensorInfo(h,a.dtype);return r.texData.get(p.dataId).values=d,p}return t=o?new aE("\n  int r = int(a.r) & int(b.r);\n  int g = int(a.g) & int(b.g);\n  int rb = int(a.b) & int(b.b);\n  int ra = int(a.a) & int(b.a);\n  return vec4(r, g, rb, ra);\n",a.shape,i.shape,!1):new nE("\n  return float(int(a.r) & int(b.r));\n",a.shape,i.shape),r.runWebGLProgram(t,[a,i],a.dtype)}};var jN={kernelName:ii.BroadcastArgs,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.s0,a=t.s1,i=n.readSync(r.dataId),o=n.readSync(a.dataId),u=ii.backend_util.assertAndGetBroadcastShape(Array.from(i),Array.from(o));return n.makeTensorInfo([u.length],"int32",Int32Array.from(u))}},BN=mE({opSnippet:"return float(a != b);",cpuKernelImpl:rA,dtype:"bool"}),zN={kernelName:ii.NotEqual,backendName:"webgl",kernelFunc:BN};function ZN(e){var t=e.inputs,n=e.backend,r=t.input;return iE({inputs:{x:n.texData.get(r.dataId).complexTensorInfos.real},backend:n})}var LN={kernelName:ii.Real,backendName:"webgl",kernelFunc:ZN};var PN={kernelName:ii.Cast,backendName:"webgl",kernelFunc:function e(t){var n=t.inputs,r=t.backend,a=t.attrs,i=n.x,o=a.dtype;if("complex64"===o){if("complex64"===i.dtype)return iE({inputs:{x:i},backend:r});var u=ii.zeros(i.shape),s=e({inputs:{x:i},backend:r,attrs:{dtype:"float32"}}),c=uE({inputs:{real:s,imag:u},backend:r});return u.dispose(),r.disposeIntermediateTensorInfo(s),c}if("complex64"===i.dtype){var l=ZN({inputs:{input:i},backend:r}),f=e({inputs:{x:l},backend:r,attrs:{dtype:o}});return r.disposeIntermediateTensorInfo(l),f}if(!ii.util.hasEncodingLoss(i.dtype,o)){var d=iE({inputs:{x:i},backend:r});return{dataId:d.dataId,shape:d.shape,dtype:o}}if(r.shouldExecuteOnCPU([i])){var h=r.texData.get(i.dataId).values,p=BC(h,i.shape,i.dtype,o),v=(0,C.Z)(p,3),m=v[0],g=v[1],y=v[2];return r.makeTensorInfo(m,g,y)}if("int32"===o)return function(e,t){var n=new jA(e.shape,"return float(int(x));"),r=t.runWebGLProgram(n,[e],"int32");return{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}(i,r);if("bool"===o){var b=r.makeTensorInfo([],"bool",ii.util.getTypedArrayFromDType("bool",1)),x=BN({inputs:{a:i,b:b},backend:r});return r.disposeIntermediateTensorInfo(b),x}throw new Error("Error in Cast: failed to cast ".concat(i.dtype," to ").concat(o))}},UN="return ceil(x);",WN=vE({opSnippet:UN,packedOpSnippet:UN,cpuKernelImpl:zC}),VN={kernelName:ii.Ceil,backendName:"webgl",kernelFunc:WN},qN=(0,F.Z)((function e(t){(0,D.Z)(this,e),this.variableNames=["A"],this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=t,this.userCode="\n\n      void main() {\n        float value = getAAtOutCoords();\n        if (isnan(value)) {\n          setOutput(value);\n          return;\n        }\n\n        setOutput(clamp(value, minVal, maxVal));\n      }\n    "})),GN=(0,F.Z)((function e(t){(0,D.Z)(this,e),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=t,this.userCode="\n      void main() {\n        vec4 value = getAAtOutCoords();\n\n        if (any(isnan(value))) {\n          setOutput(value);\n          return;\n        }\n\n        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));\n      }\n    "}));var HN={kernelName:ii.ClipByValue,backendName:"webgl",kernelFunc:function(e){var t,n=e.inputs,r=e.backend,a=e.attrs,i=n.x,o=a.clipValueMin,u=a.clipValueMax;t=(0,ii.env)().getBool("WEBGL_PACK_CLIP")?new GN(i.shape):new qN(i.shape);var s=[[o],[u]];return r.runWebGLProgram(t,[i],i.dtype,s)}},XN=(0,F.Z)((function e(t){(0,D.Z)(this,e),this.variableNames=["real","imag"],this.outputShape=t,this.userCode="\n      void main() {\n        float re = abs(getRealAtOutCoords());\n        float im = abs(getImagAtOutCoords());\n        float mx = max(re, im);\n\n        // sadly the length function in glsl is not underflow-safe\n        // (at least not on Intel GPUs). So the safe solution is\n        // to ensure underflow-safety in all cases.\n        setOutput(\n          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))\n        );\n      }\n    "}));function KN(e,t){return{dataId:t.dataId,dtype:t.dtype,shape:e.shape}}var YN={kernelName:ii.ComplexAbs,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.x,a=n.texData.get(r.dataId),i=new XN(r.shape),o=[KN(r,a.complexTensorInfos.real),KN(r,a.complexTensorInfos.imag)];return n.runWebGLProgram(i,o,o[0].dtype)}},$N=(0,F.Z)((function e(t){(0,D.Z)(this,e),this.outputShape=[],this.outputShape=ii.backend_util.computeOutShape(t,1),this.variableNames=t.map((function(e,t){return"T".concat(t)}));var n=new Array(t.length-1);n[0]=t[0][1];for(var r=1;r<n.length;r++)n[r]=n[r-1]+t[r][1];for(var a=["if (yC < ".concat(n[0],") setOutput(getT0(yR, yC));")],i=1;i<n.length;i++){var o=n[i-1];a.push("else if (yC < ".concat(n[i],") ")+"setOutput(getT".concat(i,"(yR, yC-").concat(o,"));"))}var u=n.length,s=n[n.length-1];a.push("else setOutput(getT".concat(u,"(yR, yC-").concat(s,"));")),this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int yR = coords.x;\n        int yC = coords.y;\n\n        ".concat(a.join("\n        "),"\n      }\n    ")})),QN=(0,F.Z)((function e(t,n){(0,D.Z)(this,e),this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=ii.backend_util.computeOutShape(t,n);var r=this.outputShape,a=r.length,i=iC(a),o=TA("coords",a),u=["x","y","z","w","u","v"].slice(0,a);this.variableNames=t.map((function(e,t){return"T".concat(t)}));var s=new Array(t.length-1);s[0]=t[0][n];for(var c=1;c<s.length;c++)s[c]=s[c-1]+t[c][n];for(var l=u[n],f=u.slice(-2),d=u.join(),h="if (".concat(l," < ").concat(s[0],") {\n        return getChannel(\n            getT0(").concat(d,"), vec2(").concat(f.join(),"));\n        }"),p=1;p<s.length;p++){var v=s[p-1];h+="\n        if (".concat(l," < ").concat(s[p],"  && ").concat(l," >= ").concat(s[p-1],") {\n          return getChannel(\n            getT").concat(p,"(").concat(JN(u,l,v),"),\n            vec2(").concat(JN(f,l,v),"));\n        }")}var m=s.length,g=s[s.length-1];h+="\n        return getChannel(\n          getT".concat(m,"(").concat(JN(u,l,g),"),\n          vec2(").concat(JN(f,l,g),"));"),this.userCode="\n      float getValue(".concat(u.map((function(e){return"int "+e})),") {\n        ").concat(h,"\n      }\n\n      void main() {\n        ").concat(i," coords = getOutputCoords();\n        vec4 result = vec4(getValue(").concat(o,"), 0., 0., 0.);\n\n        ").concat(o[a-1]," = ").concat(o[a-1]," + 1;\n        if (").concat(o[a-1]," < ").concat(r[a-1],") {\n          result.g = getValue(").concat(o,");\n        }\n\n        ").concat(o[a-2]," = ").concat(o[a-2]," + 1;\n        if (").concat(o[a-2]," < ").concat(r[a-2],") {\n          result.a = getValue(").concat(o,");\n        }\n\n        ").concat(o[a-1]," = ").concat(o[a-1]," - 1;\n        if (").concat(o[a-2]," < ").concat(r[a-2]," &&\n            ").concat(o[a-1]," < ").concat(r[a-1],") {\n          result.b = getValue(").concat(o,");\n        }\n        setOutput(result);\n      }\n    ")}));function JN(e,t,n){var r=e.indexOf(t);return e.map((function(e,t){return t===r?"".concat(e," - ").concat(n):e})).join()}function eT(e){var t=e.inputs,n=e.backend,r=t.input;return iE({inputs:{x:n.texData.get(r.dataId).complexTensorInfos.imag},backend:n})}var tT={kernelName:ii.Imag,backendName:"webgl",kernelFunc:eT};function nT(e,t,n){var r=e[0].dtype;if("complex64"===r){var a=e.map((function(e){return ZN({inputs:{input:e},backend:n})})),i=e.map((function(e){return eT({inputs:{input:e},backend:n})})),o=nT(a,t,n),u=nT(i,t,n),s=uE({inputs:{real:o,imag:u},backend:n});return a.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),i.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(u),s}var c=n.shouldExecuteOnCPU(e);if("string"===r&&(c=!0),c){var l=e.map((function(e){var r=ii.util.sizeFromShape(e.shape.slice(t));return CE({inputs:{x:e},backend:n,attrs:{shape:[-1,r]}})})),f=l.map((function(e){return{vals:n.readSync(e.dataId),shape:e.shape}})),d=ii.backend_util.computeOutShape(l.map((function(e){return e.shape})),1),h=1===l[0].shape[0],p=ZC(f,d,r,h),v=ii.backend_util.computeOutShape(e.map((function(e){return e.shape})),t),m=n.makeTensorInfo(v,r,p);return l.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),m}var g=e.filter((function(e){return ii.util.sizeFromShape(e.shape)>0})),y=(0,ii.env)().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&g[0].shape.length>1;if(1===g.length){var b=y?new jA(e[0].shape,WA):new YA(e[0].shape,WA);return n.runWebGLProgram(b,e,r)}var x=(0,ii.env)().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER");if(g.length>x){for(var w=[],k=0;k<g.length;k+=x){var _=g.slice(k,k+x);w.push(nT(_,t,n))}for(var S=nT(w,t,n),C=0,A=w;C<A.length;C++){var E=A[C];n.disposeIntermediateTensorInfo(E)}return S}if(y){var N=new QN(g.map((function(e){return e.shape})),t);return n.runWebGLProgram(N,g,r)}var T=function(e,t,n){var r=ii.backend_util.computeOutShape(e.map((function(e){return e.shape})),t);return{tensors2D:e.map((function(e){return CE({inputs:{x:e},attrs:{shape:[-1,ii.util.sizeFromShape(e.shape.slice(t))]},backend:n})})),outShape:r}}(g,t,n),I=T.tensors2D,D=T.outShape,F=new $N(I.map((function(e){return e.shape}))),M=n.runWebGLProgram(F,I,r);I.forEach((function(e){return n.disposeIntermediateTensorInfo(e)}));var O=CE({inputs:{x:M},attrs:{shape:D},backend:n});return n.disposeIntermediateTensorInfo(M),O}function rT(e){var t=e.inputs,n=e.backend,r=e.attrs.axis,a=ii.util.parseAxisParam(r,t[0].shape)[0],i=t.map((function(e){return e.shape}));ii.backend_util.assertParamsConsistent(i,a);var o=ii.backend_util.computeOutShape(t.map((function(e){return e.shape})),a);if(0===ii.util.sizeFromShape(o))return n.makeTensorInfo(o,t[0].dtype,[]);var u=t.filter((function(e){return ii.util.sizeFromShape(e.shape)>0}));return 1===u.length?iE({inputs:{x:u[0]},backend:n}):nT(u,a,n)}var aT={kernelName:ii.Concat,backendName:"webgl",kernelFunc:rT},iT=(0,F.Z)((function e(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];(0,D.Z)(this,e),this.variableNames=["x","W"],this.outputShape=t.outShape;var o=t.padInfo.top,u=t.padInfo.left,s=t.strideHeight,c=t.strideWidth,l=t.dilationHeight,f=t.dilationWidth,d=t.filterHeight,h=t.filterWidth,p=4*Math.floor(t.inChannels/4),v=t.inChannels%4,m="channelsLast"===t.dataFormat,g=m?1:2,y=m?2:3,b=m?3:1,x="",w="";r&&(x=a?"float activation(float a) {\n          float b = getPreluActivationWeightsAtOutCoords();\n          ".concat(r,"\n        }"):i?"float activation(float a) {\n          float b = getLeakyreluAlphaAtOutCoords();\n          ".concat(r,"\n        }"):"\n          float activation(float x) {\n            ".concat(r,"\n          }\n        "),w="result = activation(result);");var k=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),a&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode="\n      ".concat(x,"\n\n      const ivec2 strides = ivec2(").concat(s,", ").concat(c,");\n      const ivec2 pads = ivec2(").concat(o,", ").concat(u,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d2 = coords[").concat(b,"];\n\n        ivec2 xRCCorner =\n            ivec2(coords[").concat(g,"], coords[").concat(y,"]) * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ").concat(d,"; wR++) {\n          int xR = xRCorner + wR * ").concat(l,";\n\n          if (xR < 0 || xR >= ").concat(t.inHeight,") {\n            continue;\n          }\n\n          for (int wC = 0; wC < ").concat(h,"; wC++) {\n            int xC = xCCorner + wC * ").concat(f,";\n\n            if (xC < 0 || xC >= ").concat(t.inWidth,") {\n              continue;\n            }\n\n            for (int d1 = 0; d1 < ").concat(p,"; d1 += 4) {\n              vec4 wValues = vec4(\n                getW(wR, wC, d1, d2),\n                getW(wR, wC, d1 + 1, d2),\n                getW(wR, wC, d1 + 2, d2),\n                getW(wR, wC, d1 + 3, d2)\n              );\n\n              if (").concat(m,") {\n                vec4 xValues = vec4(\n                  getX(batch, xR, xC, d1),\n                  getX(batch, xR, xC, d1 + 1),\n                  getX(batch, xR, xC, d1 + 2),\n                  getX(batch, xR, xC, d1 + 3)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec4 xValues = vec4(\n                  getX(batch, d1, xR, xC),\n                  getX(batch, d1 + 1, xR, xC),\n                  getX(batch, d1 + 2, xR, xC),\n                  getX(batch, d1 + 3, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n            }\n\n            if (").concat(1===v,") {\n\n              if (").concat(m,") {\n                dotProd +=\n                    getX(batch, xR, xC, ").concat(p,") *\n                    getW(wR, wC, ").concat(p,", d2);\n              } else {\n                dotProd +=\n                    getX(batch, ").concat(p,", xR, xC) *\n                    getW(wR, wC, ").concat(p,", d2);\n              }\n\n            } else if (").concat(2===v,") {\n              vec2 wValues = vec2(\n                getW(wR, wC, ").concat(p,", d2),\n                getW(wR, wC, ").concat(p," + 1, d2)\n              );\n\n              if (").concat(m,") {\n                vec2 xValues = vec2(\n                  getX(batch, xR, xC, ").concat(p,"),\n                  getX(batch, xR, xC, ").concat(p," + 1)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec2 xValues = vec2(\n                  getX(batch, ").concat(p,", xR, xC),\n                  getX(batch, ").concat(p," + 1, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n\n            } else if (").concat(3===v,") {\n              vec3 wValues = vec3(\n                getW(wR, wC, ").concat(p,", d2),\n                getW(wR, wC, ").concat(p," + 1, d2),\n                getW(wR, wC, ").concat(p," + 2, d2)\n              );\n\n              if (").concat(m,") {\n                vec3 xValues = vec3(\n                  getX(batch, xR, xC, ").concat(p,"),\n                  getX(batch, xR, xC, ").concat(p," + 1),\n                  getX(batch, xR, xC, ").concat(p," + 2)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec3 xValues = vec3(\n                  getX(batch, ").concat(p,", xR, xC),\n                  getX(batch, ").concat(p," + 1, xR, xC),\n                  getX(batch, ").concat(p," + 2, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n\n            }\n          }\n        }\n\n        float result = dotProd;\n        ").concat(k,"\n        ").concat(w,"\n        setOutput(result);\n      }\n    ")})),oT=(0,F.Z)((function e(t){(0,D.Z)(this,e),this.variableNames=["x","W"],this.outputShape=t.outShape;var n=t.padInfo.front,r=t.padInfo.top,a=t.padInfo.left,i=t.strideDepth,o=t.strideHeight,u=t.strideWidth,s=t.dilationDepth,c=t.dilationHeight,l=t.dilationWidth,f=t.filterDepth,d=t.filterHeight,h=t.filterWidth,p=4*Math.floor(t.inChannels/4),v=t.inChannels%4;this.userCode="\n      const ivec3 strides = ivec3(".concat(i,", ").concat(o,", ").concat(u,");\n      const ivec3 pads = ivec3(").concat(n,", ").concat(r,", ").concat(a,");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int d2 = coords.u;\n\n        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n        int xFCorner = xFRCCorner.x;\n        int xRCorner = xFRCCorner.y;\n        int xCCorner = xFRCCorner.z;\n\n        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get\n        // y(yF, yR, yC, d2). ? = to be determined. : = across all\n        // values in that axis.\n        float dotProd = 0.0;\n        for (int wF = 0; wF < ").concat(f,"; wF++) {\n          int xF = xFCorner + wF * ").concat(s,";\n\n          if (xF < 0 || xF >= ").concat(t.inDepth,") {\n            continue;\n          }\n\n          for (int wR = 0; wR < ").concat(d,"; wR++) {\n            int xR = xRCorner + wR * ").concat(c,";\n\n            if (xR < 0 || xR >= ").concat(t.inHeight,") {\n              continue;\n            }\n\n            for (int wC = 0; wC < ").concat(h,"; wC++) {\n              int xC = xCCorner + wC * ").concat(l,";\n\n              if (xC < 0 || xC >= ").concat(t.inWidth,") {\n                continue;\n              }\n\n              for (int d1 = 0; d1 < ").concat(p,"; d1 += 4) {\n                vec4 xValues = vec4(\n                  getX(batch, xF, xR, xC, d1),\n                  getX(batch, xF, xR, xC, d1 + 1),\n                  getX(batch, xF, xR, xC, d1 + 2),\n                  getX(batch, xF, xR, xC, d1 + 3)\n                );\n                vec4 wValues = vec4(\n                  getW(wF, wR, wC, d1, d2),\n                  getW(wF, wR, wC, d1 + 1, d2),\n                  getW(wF, wR, wC, d1 + 2, d2),\n                  getW(wF, wR, wC, d1 + 3, d2)\n                );\n\n                dotProd += dot(xValues, wValues);\n              }\n\n              if (").concat(1===v,") {\n                dotProd +=\n                  getX(batch, xF, xR, xC, ").concat(p,") *\n                  getW(wF, wR, wC, ").concat(p,", d2);\n              } else if (").concat(2===v,") {\n                vec2 xValues = vec2(\n                  getX(batch, xF, xR, xC, ").concat(p,"),\n                  getX(batch, xF, xR, xC, ").concat(p," + 1)\n                );\n                vec2 wValues = vec2(\n                  getW(wF, wR, wC, ").concat(p,", d2),\n                  getW(wF, wR, wC, ").concat(p," + 1, d2)\n                );\n                dotProd += dot(xValues, wValues);\n              } else if (").concat(3===v,") {\n                vec3 xValues = vec3(\n                  getX(batch, xF, xR, xC, ").concat(p,"),\n                  getX(batch, xF, xR, xC, ").concat(p," + 1),\n                  getX(batch, xF, xR, xC, ").concat(p," + 2)\n                );\n                vec3 wValues = vec3(\n                  getW(wF, wR, wC, ").concat(p,", d2),\n                  getW(wF, wR, wC, ").concat(p," + 1, d2),\n                  getW(wF, wR, wC, ").concat(p," + 2, d2)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")})),uT=(0,F.Z)((function e(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];(0,D.Z)(this,e),this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=t.outShape,this.enableShapeUniforms=pC(this.outputShape.length);for(var o=t.padInfo.left,u=t.strideWidth,s=t.dilationWidth,c=t.filterHeight,l=t.filterWidth,f=l,d="\n       int xR; int xC; int xCOffset;\n       vec4 wTexel; vec4 previous; vec4 final;",h=0;h<l;h++)d+="\n           vec4 xTexelC".concat(2*h,";\n           int xTexelC").concat(2*h,"Ready;\n           vec4 xTexelC").concat(2*h+1,";\n           int xTexelC").concat(2*h+1,"Ready;\n           vec4 xC").concat(h,";");d+="\n     for (int r = 0; r < ".concat(c,"; r++) {\n      for (int d1 = 0; d1 < ").concat(t.inChannels,"; d1 += 2) {\n       ");for(var p=0;p<l;p++)d+="\n           xTexelC".concat(2*p," = vec4(0.0);\n           xTexelC").concat(2*p,"Ready = 0;\n           xTexelC").concat(2*p+1," = vec4(0.0);\n           xTexelC").concat(2*p+1,"Ready = 0;\n           xC").concat(p," = vec4(0.0);");d+="\n         xR = xRCorner + r * dilations[0];\n         if (xR >=0 && xR < inDims[0]) {\n       ";for(var v=0;v<(f+1)/2;v++){var m=2*v;if(d+="\n           xC = xCCorner + ".concat(m*s,";\n           "),1===u){if(m<l&&(o%2===1?(d+="\n                 xCOffset = xC + 1;\n                 if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC".concat(m,"Ready == 0) {\n                   xTexelC").concat(m," = getX(batch, xR, xCOffset, d1);\n\n                   // Need to manually clear unused channels in case\n                   // we're reading from recycled texture.\n                   if (xCOffset + 1 >= inDims[1]) {\n                     xTexelC").concat(m,".zw = vec2(0.0);\n                   }\n                   xTexelC").concat(m,"Ready = 1;\n                 }\n               "),d+=1===s&&m>0?"\n                 xC".concat(m," = vec4(xTexelC").concat(m-2,".zw, xTexelC").concat(m,".xy);\n                 "):"\n                   xCOffset = xC + 1 - 2;\n\n                   if (xCOffset >= 0 && xCOffset < inDims[1]) {\n                     previous = getX(batch, xR, xCOffset, d1);\n\n                     // Need to manually clear unused channels in case\n                     // we're reading from recycled texture.\n                     if (xCOffset + 1 >= inDims[1]) {\n                       previous.zw = vec2(0.0);\n                     }\n\n                     xC".concat(m," = vec4(previous.zw, xTexelC").concat(m,".xy);\n                   } else {\n                     xC").concat(m," = vec4(0.0, 0.0, xTexelC").concat(m,".xy);\n                   }\n                   ")):d+="\n                 if (xC >= 0 && xC < inDims[1] && xTexelC".concat(m,"Ready == 0) {\n                   xTexelC").concat(m," = getX(batch, xR, xC, d1);\n                   if (xC + 1 >= inDims[1]) {\n                     xTexelC").concat(m,".zw = vec2(0.0);\n                   }\n                   xTexelC").concat(m,"Ready = 1;\n                 }\n\n                 xC").concat(m," = xTexelC").concat(m,";\n                 "),m+1<l)){var g=o%2===0?ii.util.nearestLargerEven(s):s;s%2===0&&o%2===1||s%2!==0&&o%2!==1?(d+="\n                   xCOffset = xC + imod(pads[1], 2) + ".concat(g,";\n\n                   if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC").concat(m+1,"Ready == 0) {\n                     xTexelC").concat(m+1," = getX(batch, xR, xCOffset, d1);\n\n                     // Need to manually clear unused channels in case\n                     // we're reading from recycled texture.\n                     if (xCOffset + 1 >= inDims[1]) {\n                       xTexelC").concat(m+1,".zw = vec2(0.0);\n                     }\n                     xTexelC").concat(m+1,"Ready = 1;\n                   }\n                   "),d+=s>1?"\n                     xCOffset -= 2;\n                     if (xCOffset >= 0 && xCOffset < inDims[1]) {\n                      previous = getX(batch, xR, xCOffset, d1);\n                      xC".concat(m+1," = vec4(previous.zw, xTexelC").concat(m+1,".xy);\n                     } else {\n                      xC").concat(m+1," = vec4(0.0, 0.0, xTexelC").concat(m+1,".xy);\n                     }\n                     "):"\n                     xC".concat(m+1," = vec4(xTexelC").concat(m,".zw, xTexelC").concat(m+1,".xy);\n                     ")):d+=1===g?"\n                     xC".concat(m+1," = xTexelC").concat(m,";\n                     "):"\n                     xCOffset = xC + ".concat(g,";\n\n                     if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC").concat(m+1,"Ready == 0) {\n                       xTexelC").concat(m+1," = getX(batch, xR, xCOffset, d1);\n                       if (xCOffset + 1 >= inDims[1]) {\n                         xTexelC").concat(m+1,".zw = vec2(0.0);\n                       }\n                       xTexelC").concat(m+1,"Ready = 1;\n                     }\n\n                     xC").concat(m+1," = xTexelC").concat(m+1,";\n                     ")}}else m<l&&(o%2===1?(d+="\n                 xCOffset = xC + 1 - strides[1];\n                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC".concat(m,"Ready == 0) {\n                   xTexelC").concat(m," = getX(batch, xR, xCOffset, d1);\n                   // Need to manually clear unused channels in case\n                   // we're reading from recycled texture.\n                   if (xCOffset + 1 >= inDims[1]) {\n                     xTexelC").concat(m,".zw = vec2(0.0);\n                   }\n                   xTexelC").concat(m,"Ready = 1;\n                 }\n\n                 if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC").concat(m+1,"Ready == 0) {\n                   xTexelC").concat(m+1," = getX(batch, xR, xC + 1, d1);\n                   // Need to manually clear unused channels in case\n                   // we're reading from recycled texture.\n                   if (xC + 2 >= inDims[1]) {\n                     xTexelC").concat(m+1,".zw = vec2(0.0);\n                   }\n                   xTexelC").concat(m+1,"Ready = 1;\n                 }\n\n                 xC").concat(m," = vec4(xTexelC").concat(m,".zw, xTexelC").concat(m+1,".zw);\n               "),m+1<l&&(d+="\n                   final = vec4(0.0);\n                   xCOffset = xC + 1 + strides[1];\n                   if(xCOffset >= 0 && xCOffset < inDims[1]) {\n                     final = getX(batch, xR, xCOffset, d1);\n                   }\n                   xC".concat(m+1," = vec4(xTexelC").concat(m+1,".xy, final.xy);\n                 "))):(d+="\n                 if(xC >= 0 && xC < inDims[1] && xTexelC".concat(m,"Ready == 0) {\n                   xTexelC").concat(m," = getX(batch, xR, xC, d1);\n                   if (xC + 1 >= inDims[1]) {\n                     xTexelC").concat(m,".zw = vec2(0.0);\n                   }\n                   xTexelC").concat(m,"Ready = 1;\n                 }\n\n                 xCOffset = xC + strides[1];\n                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC").concat(m+1,"Ready == 0) {\n                   xTexelC").concat(m+1," = getX(batch, xR, xCOffset, d1);\n                   if (xCOffset + 1 >= inDims[1]) {\n                     xTexelC").concat(m+1,".zw = vec2(0.);\n                   }\n                   xTexelC").concat(m+1,"Ready = 1;\n                 }\n\n                 xC").concat(m," = vec4(\n                   xTexelC").concat(m,".xy, xTexelC").concat(m+1,".xy);\n               "),m+1<l&&(d+="\n                   xC".concat(m+1," = vec4(xTexelC").concat(m,".zw, xTexelC").concat(m+1,".zw);\n                 "))));m<l&&(d+="\n             wTexel = getW(r, ".concat(m,", d1, d2);\n             dotProd += xC").concat(m,".xxzz * vec4(wTexel.xy, wTexel.xy);\n             if(d1 + 1 < ").concat(t.inChannels,") {\n               dotProd += xC").concat(m,".yyww * vec4(wTexel.zw, wTexel.zw);\n             }\n           "),m+1<l&&(d+="\n               wTexel = getW(r, ".concat(m+1,", d1, d2);\n               dotProd += xC").concat(m+1,".xxzz * vec4(wTexel.xy, wTexel.xy);\n               if(d1 + 1 < ").concat(t.inChannels,") {\n                 dotProd += xC").concat(m+1,".yyww * vec4(wTexel.zw, wTexel.zw);\n               }\n             ")))}d+="\n     }\n   ",d+="\n     }\n   ",d+="\n     }\n   ";var y="",b="";r&&(y=a?"vec4 activation(vec4 a) {\n           vec4 b = getPreluActivationWeightsAtOutCoords();\n           ".concat(r,"\n         }"):i?"vec4 activation(vec4 a) {\n           vec4 b = getLeakyreluAlphaAtOutCoords();\n           ".concat(r,"\n         }"):"vec4 activation(vec4 x) {\n           ".concat(r,"\n         }"),b="result = activation(result);");var x=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),a&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode="\n       ".concat(y,"\n\n       void main() {\n         ivec4 coords = getOutputCoords();\n         int batch = coords.x;\n         ivec2 xRCCorner = coords.yz * strides - pads;\n         int d2 = coords.w;\n         int xRCorner = xRCCorner.x;\n         int xCCorner = xRCCorner.y;\n\n         //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.\n         vec4 dotProd = vec4(0.000000000000001);\n\n         ").concat(d,"\n\n         vec4 result = dotProd - vec4(0.000000000000001);\n         ").concat(x,"\n         ").concat(b,"\n         setOutput(result);\n       }\n     ")})),sT=(0,F.Z)((function e(t,n){(0,D.Z)(this,e),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec4"},{name:"pad",type:"ivec2"},{name:"stride",type:"ivec2"},{name:"dilation",type:"ivec2"},{name:"inChannels",type:"int"},{name:"itemsPerBlockRow",type:"int"},{name:"outWidth",type:"int"}],this.outputShape=t,this.enableShapeUniforms=pC(this.outputShape.length);for(var r=n.dataFormat,a=OS(),i="channelsLast"===r,o=i?1:2,u=i?2:3,s=this.enableShapeUniforms?"if(blockIndex < outShape[2] && pos < outShape[1]) {":"if(blockIndex < ".concat(t[2]," && pos < ").concat(t[1],") {"),c="",l=0;l<=1;l++)for(var f=0;f<=1;f++)c+="\n          blockIndex = rc.z + ".concat(f,";\n          pos = rc.y + ").concat(l,";\n\n          ").concat(s,"\n            offsetY = int(blockIndex / outWidth) * stride[0] - pad[0];\n            d0 = offsetY + dilation[0] * (pos / itemsPerBlockRow);\n\n            if(d0 < inputShape[").concat(o,"] && d0 >= 0) {\n              // Use custom imod instead mod. On Intel GPU, mod may generate\n              // unexpected value.\n              // https://github.com/tensorflow/tfjs/issues/5447\n              offsetX = imod(blockIndex, outWidth) * stride[1] - pad[1];\n              d1 = offsetX + dilation[1] * (imod(pos, itemsPerBlockRow) /\n                  inChannels);\n\n              if(d1 < inputShape[").concat(u,"] && d1 >= 0) {\n\n                ch = imod(pos, inChannels);\n\n                if (").concat(i,") {\n                  innerDims = vec2(d1, ch);\n                  result[").concat(2*l+f,"] = getChannel(\n                    getA(rc.x, d0, int(innerDims.x),\n                    int(innerDims.y)), innerDims);\n                } else {\n                  innerDims = vec2(d0, d1);\n                  result[").concat(2*l+f,"] = getChannel(\n                    getA(rc.x, ch, int(innerDims.x),\n                    int(innerDims.y)), innerDims);\n                }\n              }\n            }\n          }\n        ");this.userCode="\n      void main() {\n        ivec3 rc = getOutputCoords();\n\n        vec4 result = vec4(0);\n\n        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;\n        vec2 innerDims;\n\n        ".concat(c,"\n\n        ").concat(a.output," = result;\n      }\n    ")}));function cT(e,t){var n=e.length;return n>=3?[].concat((0,I.Z)(e.slice(0,-3)),t?[e[n-3]*e[n-2],e[n-1]]:[e[n-3],e[n-2]*e[n-1]]):!t&&1===n&&e[0]>1?[e[0],1]:null}function lT(e){var t,n=e.x,r=e.filter,a=e.convInfo,i=e.backend,o=e.bias,u=void 0===o?null:o,s=e.preluActivationWeights,c=void 0===s?null:s,l=e.leakyreluAlpha,f=void 0===l?0:l,d=e.activation,h=void 0===d?null:d,p=n.shape,v=i.texData.get(n.dataId),m=a.inChannels,g=p[0]*p[1]*p[2],y=a.outChannels,b="channelsLast"===a.dataFormat,x=[];if(null!=c){var w=cT(c.shape,b);null!=w&&(c=CE({inputs:{x:c},backend:i,attrs:{shape:w}}),x.push(c))}if(null!=u){var k=cT(u.shape,b);null!=k&&(u=CE({inputs:{x:u},backend:i,attrs:{shape:k}}),x.push(u))}if(!((1===g||1===y)&&m>1e3)&&v.isPacked&&b&&null!=v.texture&&p[2]%2!==0&&ii.util.arraysEqual(v.shape.slice(-3),p.slice(-3))){var _=p[0]*p[1]*(p[2]+1),S={dataId:n.dataId,shape:[1,_,a.inChannels],dtype:n.dtype},C=v.shape;v.shape=v.shape.slice(),v.shape[v.shape.length-2]++,ii.util.assert(ES(v.shape,S.shape),(function(){return"packed reshape ".concat(v.shape," to ").concat(S.shape," isn't free")}));var A=CE({inputs:{x:r},backend:i,attrs:{shape:[1,a.inChannels,a.outChannels]}});x.push(A);var E=BE({a:S,b:A,backend:i,transposeA:!1,transposeB:false,bias:u,activation:h,preluActivationWeights:c,leakyreluAlpha:f}),N=i.texData.get(E.dataId);ii.util.assert(N.isPacked,(function(){return"batchMatMul result is expected to be packed"})),v.shape=C,N.shape=a.outShape,(t=iE({inputs:{x:E},backend:i})).shape=a.outShape,x.push(E)}else{var T=a.outHeight*a.outWidth,I=CE({inputs:{x:n},backend:i,attrs:{shape:b?[a.batchSize,T,a.inChannels]:[a.batchSize,a.inChannels,T]}}),D=CE({inputs:{x:r},backend:i,attrs:{shape:[1,a.inChannels,a.outChannels]}}),F=BE({a:b?I:D,b:b?D:I,transposeA:!b,transposeB:false,backend:i,bias:u,activation:h,preluActivationWeights:c,leakyreluAlpha:f});t=CE({inputs:{x:F},backend:i,attrs:{shape:a.outShape}}),x.push(I),x.push(D),x.push(F)}for(var M=0,O=x;M<O.length;M++){var R=O[M];i.disposeIntermediateTensorInfo(R)}return t}function fT(e){var t=e.x,n=e.filter,r=e.convInfo,a=e.backend,i=e.bias,o=void 0===i?null:i,u=e.preluActivationWeights,s=void 0===u?null:u,c=e.leakyreluAlpha,l=void 0===c?0:c,f=e.activation,d=void 0===f?null:f,h=r.filterWidth,p=r.filterHeight,v=r.inChannels,m=r.outWidth,g=r.outHeight,y="channelsLast"===r.dataFormat,b=h*p*v,x=g*m,w=[r.batchSize,b,x],k=[];if(null!=s){var _=cT(s.shape,y);null!=_&&(s=CE({inputs:{x:s},backend:a,attrs:{shape:_}}),k.push(s))}if(null!=o){var S=cT(o.shape,y);null!=S&&(o=CE({inputs:{x:o},backend:a,attrs:{shape:S}}),k.push(o))}var C=CE({inputs:{x:n},backend:a,attrs:{shape:[1,b,ii.util.sizeFromShape(n.shape)/b]}});k.push(C);var A=new sT(w,r),E=[t.shape,[r.padInfo.top,r.padInfo.left],[r.strideHeight,r.strideWidth],[r.dilationHeight,r.dilationWidth],[r.inChannels],[r.filterWidth*r.inChannels],[r.outWidth]],N=a.runWebGLProgram(A,[t],"float32",E),T=CE({inputs:{x:N},backend:a,attrs:{shape:w}});k.push(N),k.push(T);var I=null!=o,D=null!=s,F="leakyrelu"===d,M=d?gE(d,!0):null,O=new yE(y?T.shape:C.shape,y?C.shape:T.shape,y?[r.batchSize,x,r.outChannels]:[r.batchSize,r.outChannels,x],!0,!1,I,M,D,F),R=y?[T,C]:[C,T];if(o&&R.push(o),D&&R.push(s),F){var j=a.makeTensorInfo([],"float32",ii.util.createScalarValue(l,"float32"));R.push(j),k.push(j)}var B=a.runWebGLProgram(O,R,"float32"),z=CE({inputs:{x:B},backend:a,attrs:{shape:r.outShape}});k.push(B);for(var Z=0,L=k;Z<L.length;Z++){var P=L[Z];a.disposeIntermediateTensorInfo(P)}return z}var dT={kernelName:ii.Conv2D,backendName:"webgl",kernelFunc:function(e){var t,n=e.inputs,r=e.backend,a=e.attrs,i=n.x,o=n.filter,u=a.strides,s=a.pad,c=a.dataFormat,l=a.dilations,f=a.dimRoundingMode,d=ii.backend_util.convertConv2DDataFormat(c),h=ii.backend_util.computeConv2DInfo(i.shape,o.shape,u,l,s,f,!1,d);if(1!==h.filterHeight||1!==h.filterWidth||1!==h.dilationHeight||1!==h.dilationWidth||1!==h.strideHeight||1!==h.strideWidth||"SAME"!==h.padInfo.type&&"VALID"!==h.padInfo.type)if(h.strideWidth<=2&&"channelsLast"===d&&(0,ii.env)().getBool("WEBGL_EXP_CONV")){var p=new uT(h),v=[[h.padInfo.top,h.padInfo.left],[h.strideHeight,h.strideWidth],[h.dilationHeight,h.dilationWidth],[h.inHeight,h.inWidth]];t=r.runWebGLProgram(p,[i,o],"float32",v)}else if((0,ii.env)().getBool("WEBGL_CONV_IM2COL"))t=fT({x:i,filter:o,convInfo:h,backend:r});else{var m=new iT(h);t=r.runWebGLProgram(m,[i,o],"float32")}else t=lT({x:i,filter:o,convInfo:h,backend:r});var g=CE({inputs:{x:t},backend:r,attrs:{shape:h.outShape}});return r.disposeIntermediateTensorInfo(t),g}},hT=(0,F.Z)((function e(t){(0,D.Z)(this,e),this.variableNames=["x","dy"],this.outputShape=t.filterShape;var n=t.strideHeight,r=t.strideWidth,a=t.padInfo.top,i=t.padInfo.left,o="channelsLast"===t.dataFormat;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int wR = coords.x;\n        int wC = coords.y;\n        int d1 = coords.z;\n        int d2 = coords.w;\n\n        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int b = 0; b < ".concat(t.batchSize,"; b++) {\n          for (int yR = 0; yR < ").concat(t.outHeight,"; yR++) {\n            int xR = wR + yR * ").concat(n," - ").concat(a,";\n\n            if (xR < 0 || xR >= ").concat(t.inHeight,") {\n              continue;\n            }\n\n            for (int yC = 0; yC < ").concat(t.outWidth,"; yC++) {\n              int xC = wC + yC * ").concat(r," - ").concat(i,";\n\n              if (xC < 0 || xC >= ").concat(t.inWidth,") {\n                continue;\n              }\n\n              ").concat(o?"float dyValue = getDy(b, yR, yC, d2);\n              float xValue = getX(b, xR, xC, d1);\n              dotProd += (xValue * dyValue);":"float dyValue = getDy(b, d2, yR, yC);\n              float xValue = getX(b, d1, xR, xC);\n              dotProd += (xValue * dyValue);","\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")})),pT=(0,F.Z)((function e(t){(0,D.Z)(this,e),this.variableNames=["dy","W"],this.outputShape=t.inShape;var n=t.filterHeight,r=t.filterWidth,a=t.strideHeight,i=t.strideWidth,o="channelsLast"===t.dataFormat,u=n-1-t.padInfo.top,s=r-1-t.padInfo.left,c=o?1:2,l=o?2:3,f=o?3:1;this.userCode="\n      const ivec2 pads = ivec2(".concat(u,", ").concat(s,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[").concat(f,"];\n\n        ivec2 dyCorner = ivec2(coords[").concat(c,"], coords[").concat(l,"]) - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ").concat(n,"; wR++) {\n          float dyR = float(dyRCorner + wR) / ").concat(a,".0;\n\n          if (dyR < 0.0 || dyR >= ").concat(t.outHeight,".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          int wRPerm = ").concat(n," - 1 - wR;\n\n          for (int wC = 0; wC < ").concat(r,"; wC++) {\n            float dyC = float(dyCCorner + wC) / ").concat(i,".0;\n\n            if (dyC < 0.0 || dyC >= ").concat(t.outWidth,".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            int wCPerm = ").concat(r," - 1 - wC;\n\n            for (int d2 = 0; d2 < ").concat(t.outChannels,"; d2++) {\n\n              if (").concat(o,") {\n                float xValue = getDy(batch, idyR, idyC, d2);\n                float wValue = getW(wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              } else {\n                float xValue = getDy(batch, d2, idyR, idyC);\n                float wValue = getW(wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              }\n\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")})),vT=(0,F.Z)((function e(t){(0,D.Z)(this,e),this.variableNames=["x","dy"],this.outputShape=t.filterShape;var n=t.strideDepth,r=t.strideHeight,a=t.strideWidth,i=t.padInfo.front,o=t.padInfo.top,u=t.padInfo.left;this.userCode="\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int wF = coords.x;\n        int wR = coords.y;\n        int wC = coords.z;\n        int d1 = coords.w;\n        int d2 = coords.u;\n\n        float dotProd = 0.0;\n\n        for (int b = 0; b < ".concat(t.batchSize,"; b++) {\n          for (int yF = 0; yF < ").concat(t.outDepth,"; yF++) {\n            int xF = wF + yF * ").concat(n," - ").concat(i,";\n\n            if (xF < 0 || xF >= ").concat(t.inDepth,") {\n              continue;\n            }\n\n            for (int yR = 0; yR < ").concat(t.outHeight,"; yR++) {\n              int xR = wR + yR * ").concat(r," - ").concat(o,";\n\n              if (xR < 0 || xR >= ").concat(t.inHeight,") {\n                continue;\n              }\n\n              for (int yC = 0; yC < ").concat(t.outWidth,"; yC++) {\n                int xC = wC + yC * ").concat(a," - ").concat(u,";\n\n                if (xC < 0 || xC >= ").concat(t.inWidth,") {\n                  continue;\n                }\n\n                float dyValue = getDy(b, yF, yR, yC, d2);\n                float xValue = getX(b, xF, xR, xC, d1);\n                dotProd += (xValue * dyValue);\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")})),mT=(0,F.Z)((function e(t){(0,D.Z)(this,e),this.variableNames=["dy","W"],this.outputShape=t.inShape;var n=t.filterDepth,r=t.filterHeight,a=t.filterWidth,i=t.strideDepth,o=t.strideHeight,u=t.strideWidth,s=n-1-t.padInfo.front,c=r-1-t.padInfo.top,l=a-1-t.padInfo.left;this.userCode="\n      const ivec3 pads = ivec3(".concat(s,", ").concat(c,", ").concat(l,");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int d1 = coords.u;\n\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyFCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        float dotProd = 0.0;\n        for (int wF = 0; wF < ").concat(n,"; wF++) {\n          float dyF = float(dyFCorner + wF) / ").concat(i,".0;\n\n          if (dyF < 0.0 || dyF >= ").concat(t.outDepth,".0 || fract(dyF) > 0.0) {\n            continue;\n          }\n          int idyF = int(dyF);\n\n          int wFPerm = ").concat(n," - 1 - wF;\n\n          for (int wR = 0; wR < ").concat(r,"; wR++) {\n            float dyR = float(dyRCorner + wR) / ").concat(o,".0;\n\n            if (dyR < 0.0 || dyR >= ").concat(t.outHeight,".0 ||\n              fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            int wRPerm = ").concat(r," - 1 - wR;\n\n            for (int wC = 0; wC < ").concat(a,"; wC++) {\n              float dyC = float(dyCCorner + wC) / ").concat(u,".0;\n\n              if (dyC < 0.0 || dyC >= ").concat(t.outWidth,".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              int wCPerm = ").concat(a," - 1 - wC;\n\n              for (int d2 = 0; d2 < ").concat(t.outChannels,"; d2++) {\n                float xValue = getDy(batch, idyF, idyR, idyC, d2);\n                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}));var gT={kernelName:ii.Conv2DBackpropFilter,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.dy,o=r.strides,u=r.pad,s=r.dataFormat,c=r.dimRoundingMode,l=r.filterShape,f=ii.backend_util.convertConv2DDataFormat(s),d=ii.backend_util.computeConv2DInfo(a.shape,l,o,1,u,c,!1,f),h=new hT(d);return n.runWebGLProgram(h,[a,i],"float32")}},yT=(0,F.Z)((function e(t){(0,D.Z)(this,e),this.variableNames=["dy","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"strides",type:"vec2"}],this.outputShape=t.inShape,this.enableShapeUniforms=pC(this.outputShape.length);var n=t.filterHeight,r=t.filterWidth,a=n-1-t.padInfo.top,i=r-1-t.padInfo.left;this.userCode="\n      const ivec2 pads = ivec2(".concat(a,", ").concat(i,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[3];\n\n        ivec2 dyCorner = ivec2(coords[1], coords[2]) - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        vec4 result = vec4(0.);\n        for (int wR = 0; wR < ").concat(n,"; wR++) {\n          float dyR = float(dyRCorner + wR) / strides[0];\n          if (dyR < 0.0 || dyR >= ").concat(t.outHeight,".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n          int wRPerm = ").concat(n," - 1 - wR;\n\n          for (int wC = 0; wC < ").concat(r,"; wC++) {\n            int wCPerm = ").concat(r," - 1 - wC;\n\n            float dyC = float(dyCCorner + wC) / strides[1];\n            bool idyCVal = (dyC >= 0.0) && (dyC < ").concat(t.outWidth,".0)\n              && (fract(dyC) == 0.0);\n            int idyC = int(dyC);\n\n            float dyC2 = float(dyCCorner + wC + 1) / strides[1];\n            bool idyCVal2 = (dyC2 >= 0.0) && (dyC2 < ").concat(t.outWidth,".0)\n              && (fract(dyC2) == 0.0);\n            int idyC2 = int(dyC2);\n\n            if (idyCVal && idyCVal2) {\n              for (int d2 = 0; d2 < ").concat(t.outChannels,"; d2 += 2) {\n                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);\n                vec4 dySample = getDy(batch, idyR, idyC, d2);\n                vec4 dySample2 = (idyC / 2 == idyC2 / 2) ?\n                  dySample : getDy(batch, idyR, idyC2, d2);\n\n                vec2 dyValue = mod(float(idyC), 2.) == 0. ?\n                  dySample.xy : dySample.zw;\n                result.xy += vec2(dot(dyValue, wValue.xy),\n                  dot(dyValue, wValue.zw));\n\n                dyValue = mod(float(idyC2), 2.) == 0. ?\n                  dySample2.xy : dySample2.zw;\n                result.zw += vec2(dot(dyValue, wValue.xy),\n                  dot(dyValue, wValue.zw));\n              }\n            } else if (idyCVal) {\n              for (int d2 = 0; d2 < ").concat(t.outChannels,"; d2 += 2) {\n                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);\n                vec4 dySample = getDy(batch, idyR, idyC, d2);\n                vec2 dyValue = mod(float(idyC), 2.) == 0. ?\n                  dySample.xy : dySample.zw;\n                result.xy += vec2(dot(dyValue, wValue.xy),\n                  dot(dyValue, wValue.zw));\n              }\n            } else if (idyCVal2) {\n              for (int d2 = 0; d2 < ").concat(t.outChannels,"; d2 += 2) {\n                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);\n                vec4 dySample = getDy(batch, idyR, idyC2, d2);\n                vec2 dyValue = mod(float(idyC2), 2.) == 0. ?\n                  dySample.xy : dySample.zw;\n                result.zw += vec2(dot(dyValue, wValue.xy),\n                  dot(dyValue, wValue.zw));\n              }\n            }\n          }\n        }\n        setOutput(result);\n      }\n    ")}));var bT={kernelName:ii.Conv2DBackpropInput,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.dy,i=t.filter,o=r.inputShape,u=r.strides,s=r.pad,c=r.dataFormat,l=r.dimRoundingMode,f=ii.backend_util.convertConv2DDataFormat(c),d=ii.backend_util.computeConv2DInfo(o,i.shape,u,1,s,l,!1,f);if((0,ii.env)().getBool("WEBGL_PACK_CONV2DTRANSPOSE")&&"channelsLast"===f){var h=[[d.strideHeight,d.strideWidth]],p=new yT(d);return n.runWebGLProgram(p,[a,i],"float32",h)}var v=new pT(d);return n.runWebGLProgram(v,[a,i],"float32")}};var xT={kernelName:ii.Conv3D,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.filter,o=r.strides,u=r.pad,s=r.dilations,c=ii.backend_util.computeConv3DInfo(a.shape,i.shape,o,s,u),l=new oT(c);return n.runWebGLProgram(l,[a,i],"float32")}};var wT={kernelName:ii.Conv3DBackpropFilterV2,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.dy,o=r.strides,u=r.pad,s=r.filterShape,c=ii.backend_util.computeConv3DInfo(a.shape,s,o,1,u),l=new vT(c);return n.runWebGLProgram(l,[a,i],"float32")}};var kT,_T={kernelName:ii.Conv3DBackpropInputV2,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.dy,i=t.filter,o=r.pad,u=r.strides,s=r.inputShape,c=ii.backend_util.computeConv3DInfo(s,i.shape,u,1,o),l=new mT(c);return n.runWebGLProgram(l,[a,i],"float32")}},ST=vE({opSnippet:"if (isnan(x)) return x;\n  return cos(x);\n",packedOpSnippet:"\n  vec4 result = cos(x);\n  bvec4 isNaN = isnan(x);\n  ".concat(rE,"\n  return result;\n")}),CT={kernelName:ii.Cos,backendName:"webgl",kernelFunc:ST},AT=vE({opSnippet:"\n  float e2x = exp(-x);\n  return (e2x + 1.0 / e2x) / 2.0;\n"}),ET={kernelName:ii.Cosh,backendName:"webgl",kernelFunc:AT},NT=(0,F.Z)((function e(t,n,r,a,i){(0,D.Z)(this,e),this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];var o=(0,C.Z)(t,4),u=o[0],s=o[1],c=o[2],l=o[3],f=(0,C.Z)(n,1)[0],d=(0,C.Z)(r,2),h=d[0],p=d[1];this.outputShape=[f,h,p,l];var v="bilinear"===a?1:0,m="".concat(s-1,".0"),g="".concat(c-1,".0"),y=h>1?["".concat((s-1)/(h-1)),"(y2-y1) * height_ratio","y1*".concat(m," + float(y)*(height_scale)")]:["0.0","0.0","0.5 * (y1+y2) * ".concat(m)],b=(0,C.Z)(y,3),x=b[0],w=b[1],k=b[2],_=p>1?["".concat((c-1)/(p-1)),"(x2-x1) * width_ratio","x1*".concat(g," + float(x)*(width_scale)")]:["0.0","0.0","0.5 * (x1+x2) * ".concat(g)],S=(0,C.Z)(_,3),A=S[0],E=S[1],N=S[2];this.userCode="\n      const float height_ratio = float(".concat(x,");\n      const float width_ratio = float(").concat(A,");\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int y = coords[1];\n        int x = coords[2];\n        int d = coords[3];\n\n        // get box vals\n        float y1 = getBoxes(b,0);\n        float x1 = getBoxes(b,1);\n        float y2 = getBoxes(b,2);\n        float x2 = getBoxes(b,3);\n\n        // get image in batch index\n        int bInd = round(getBoxInd(b));\n        if(bInd < 0 || bInd >= ").concat(u,") {\n          return;\n        }\n\n        float height_scale = ").concat(w,";\n        float width_scale = ").concat(E,";\n\n        float in_y = ").concat(k,";\n        if( in_y < 0.0 || in_y > ").concat(m," ) {\n          setOutput(float(").concat(i,"));\n          return;\n        }\n        float in_x = ").concat(N,";\n        if( in_x < 0.0 || in_x > ").concat(g," ) {\n          setOutput(float(").concat(i,"));\n          return;\n        }\n\n        vec2 sourceFracIndexCR = vec2(in_x,in_y);\n        if(").concat(v," == 1) {\n          // Compute the four integer indices.\n          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);\n          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));\n\n          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);\n          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);\n          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);\n          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);\n\n          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);\n\n          float top = topLeft + (topRight - topLeft) * fracCR.x;\n          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;\n          float newValue = top + (bottom - top) * fracCR.y;\n          setOutput(newValue);\n        } else {\n          // Compute the coordinators of nearest neighbor point.\n          ivec2 sourceNearestCR = ivec2(floor(\n            sourceFracIndexCR + vec2(0.5,0.5)));\n          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);\n          setOutput(newValue);\n        }\n      }\n    ")})),TT={kernelName:ii.CropAndResize,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.image,i=t.boxes,o=t.boxInd,u=r.cropSize,s=r.method,c=r.extrapolationValue,l=new NT(a.shape,i.shape,u,s,c);return n.runWebGLProgram(l,[a,i,o],"float32")}};!function(e){e.Prod="*",e.Sum="+"}(kT||(kT={}));var IT=(0,F.Z)((function e(t,n,r,a){(0,D.Z)(this,e),this.op=t,this.outputShape=n,this.variableNames=["x"],this.customUniforms=[{name:"index",type:"float"}];var i=this.outputShape.length,o=this.op===kT.Prod?"1.0":"0.0",u=r?o:"getX(".concat(DT(i,"coords",this.op),")"),s=this.outputShape[this.outputShape.length-1],c="",l="";r?(c=a?"end != ".concat(s-1):"end != 0",l=a?"end + 1":"end - 1"):(c=a?"end + pow2 < ".concat(s):"end >= pow2",l=a?"end + pow2":"end - pow2"),this.userCode="\n      void main() {\n        ".concat(iC(i)," coords = getOutputCoords();\n        int end = ").concat(FT(i,"coords",this.op),";\n        float val = ").concat(u,";\n        int pow2 = int(pow(2.0, index));\n        if (").concat(c,") {\n          int idx = ").concat(l,";\n          ").concat(FT(i,"coords",this.op)," = idx;\n          val ").concat(this.op,"= getX(").concat(DT(i,"coords",this.op),");\n        }\n        setOutput(val);\n      }\n    ")}));function DT(e,t,n){if(1===e)return"".concat(t);if(2===e)return"".concat(t,".x, ").concat(t,".y");if(3===e)return"".concat(t,".x, ").concat(t,".y, ").concat(t,".z");if(4===e)return"".concat(t,".x, ").concat(t,".y, ").concat(t,".z, ").concat(t,".w");throw new Error("Cumulative ".concat(n," for rank ").concat(e," is not yet supported"))}function FT(e,t,n){if(1===e)return"".concat(t);if(2===e)return"".concat(t,".y");if(3===e)return"".concat(t,".z");if(4===e)return"".concat(t,".w");throw new Error("Cumulative ".concat(n," for rank ").concat(e," is not yet supported"))}function MT(e,t,n,r,a,i){var o=t.shape.length,u=ii.backend_util.getAxesPermutation([r],o),s=t;null!=u&&(s=RE({inputs:{x:t},backend:n,attrs:{perm:u}}));var c=ii.backend_util.getInnerMostAxes(1,o)[0];if(c!==o-1)throw new Error("WebGL cumprod shader expects an inner-most axis=".concat(t.shape.length-1," ")+"but got axis=".concat(r));for(var l=s.shape[c],f=iE({inputs:{x:s},backend:n}),d=0;d<=Math.ceil(Math.log2(l))-1;d++){var h=new IT(e,s.shape,!1,i),p=[[d]],v=f;f=n.runWebGLProgram(h,[f],f.dtype,p),n.disposeIntermediateTensorInfo(v)}if(a){var m=new IT(e,s.shape,a,i),g=f;f=n.runWebGLProgram(m,[f],f.dtype),n.disposeIntermediateTensorInfo(g)}if(null!=u){var y=RE({inputs:{x:f},backend:n,attrs:{perm:ii.backend_util.getUndoAxesPermutation(u)}});return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(s),y}return f}var OT={kernelName:ii.Cumprod,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.axis,o=r.exclusive,u=r.reverse;return MT(kT.Prod,a,n,i,o,u)}};var RT={kernelName:ii.Cumsum,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.axis,o=r.exclusive,u=r.reverse;return MT(kT.Sum,a,n,i,o,u)}};var jT={kernelName:ii.DenseBincount,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.weights,o=r.size,u=r.binaryOutput;if(1===a.shape.length){var s=n.readSync(a.dataId),c=n.readSync(i.dataId),l=OC(s,c,i.dtype,i.shape,o);return n.makeTensorInfo([o],i.dtype,l)}if(2===a.shape.length){var f=n.bufferSync(a),d=n.bufferSync(i),h=RC(f,d,o,u);return n.makeTensorInfo(h.shape,i.dtype,h.values)}throw new Error("Error in denseBincount: input must be at most rank 2, but got rank"+"".concat(a.shape.length,"."))}},BT=function(){function e(t,n,r){(0,D.Z)(this,e),this.variableNames=["x"],this.outputShape=[],this.outputShape=t,this.blockSize=n,this.dataFormat=r,this.userCode="\n    void main() {\n      ivec4 coords = getOutputCoords();\n      int b = coords[0];\n      int h = ".concat(this.getHeightCoordString(),";\n      int w = ").concat(this.getWidthCoordString(),";\n      int d = ").concat(this.getDepthCoordString(),";\n\n      int in_h = h / ").concat(n,";\n      int offset_h = imod(h, ").concat(n,");\n      int in_w = w / ").concat(n,";\n      int offset_w = imod(w, ").concat(n,");\n      int offset_d = (offset_h * ").concat(n," + offset_w) *\n        ").concat(this.getOutputDepthSize(),";\n      int in_d = d + offset_d;\n\n      float result = ").concat(this.getInputSamplingString(),";\n      setOutput(result);\n    }\n  ")}return(0,F.Z)(e,[{key:"getHeightCoordString",value:function(){return"NHWC"===this.dataFormat?"coords[1]":"coords[2]"}},{key:"getWidthCoordString",value:function(){return"NHWC"===this.dataFormat?"coords[2]":"coords[3]"}},{key:"getDepthCoordString",value:function(){return"NHWC"===this.dataFormat?"coords[3]":"coords[1]"}},{key:"getOutputDepthSize",value:function(){return"NHWC"===this.dataFormat?this.outputShape[3]:this.outputShape[1]}},{key:"getInputSamplingString",value:function(){return"NHWC"===this.dataFormat?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"}}]),e}();var zT={kernelName:ii.DepthToSpace,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.blockSize,o=r.dataFormat,u=a.shape[0],s=("NHWC"===o?a.shape[1]:a.shape[2])*i,c=("NHWC"===o?a.shape[2]:a.shape[3])*i,l=("NHWC"===o?a.shape[3]:a.shape[1])/(i*i),f=new BT("NHWC"===o?[u,s,c,l]:[u,l,s,c],i,o);return n.runWebGLProgram(f,[a],a.dtype)}},ZT=(0,F.Z)((function e(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];(0,D.Z)(this,e),this.variableNames=["x","W"],this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=t.outShape,this.enableShapeUniforms=pC(this.outputShape.length);var o=t.filterHeight,u=t.filterWidth,s=t.outChannels/t.inChannels,c="",l="";r&&(c=a?"float activation(float a) {\n          float b = getPreluActivationWeightsAtOutCoords();\n          ".concat(r,"\n        }"):i?"float activation(float a) {\n          float b = getLeakyreluAlphaAtOutCoords();\n          ".concat(r,"\n        }"):"\n          float activation(float x) {\n            ".concat(r,"\n          }\n        "),l="result = activation(result);");var f=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),a&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode="\n      ".concat(c,"\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int d2 = coords.w;\n        int d1 = d2 / ").concat(s,";\n        int q = d2 - d1 * ").concat(s,";\n\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.\n        for (int wR = 0; wR < ").concat(o,"; wR++) {\n          int xR = xRCorner + wR * dilations[0];\n\n          if (xR < 0 || xR >= inDims[0]) {\n            continue;\n          }\n\n          for (int wC = 0; wC < ").concat(u,"; wC++) {\n            int xC = xCCorner + wC * dilations[1];\n\n            if (xC < 0 || xC >= inDims[1]) {\n              continue;\n            }\n\n            float xVal = getX(batch, xR, xC, d1);\n            float wVal = getW(wR, wC, d1, q);\n            dotProd += xVal * wVal;\n          }\n        }\n\n        float result = dotProd;\n        ").concat(f,"\n        ").concat(l,"\n        setOutput(result);\n      }\n    ")})),LT=(0,F.Z)((function e(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];(0,D.Z)(this,e),this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=t.outShape,this.enableShapeUniforms=pC(this.outputShape.length);for(var o=t.outChannels/t.inChannels,u=t.padInfo.left,s=t.strideWidth,c=t.dilationWidth,l=t.filterHeight,f=t.filterWidth,d=f,h="\n      int xR; int xC; int xCOffset;\n      vec4 wTexel; vec4 previous; vec4 final;",p=0;p<f;p++)h+="\n          vec4 xTexelC".concat(2*p,";\n          int xTexelC").concat(2*p,"Ready;\n          vec4 xTexelC").concat(2*p+1,";\n          int xTexelC").concat(2*p+1,"Ready;\n          vec4 xC").concat(p,";");h+="\n    for (int r = 0; r < ".concat(l,"; r++) {\n      ");for(var v=0;v<f;v++)h+="\n          xTexelC".concat(2*v," = vec4(0.0);\n          xTexelC").concat(2*v,"Ready = 0;\n          xTexelC").concat(2*v+1," = vec4(0.0);\n          xTexelC").concat(2*v+1,"Ready = 0;\n          xC").concat(v," = vec4(0.0);");h+="\n        xR = xRCorner + r * dilations[0];\n        if (xR >=0 && xR < inDims[0]) {\n      ";for(var m=0;m<(d+1)/2;m++){var g=2*m;if(h+="\n          xC = xCCorner + ".concat(g*c,";\n          "),1===s){if(g<f&&(u%2===1?(h+="\n                xCOffset = xC + 1;\n                if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC".concat(g,"Ready == 0) {\n                  xTexelC").concat(g," = getX(batch, xR, xCOffset, d1);\n\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if (xCOffset + 1 >= inDims[1]) {\n                    xTexelC").concat(g,".zw = vec2(0.0);\n                  }\n                  xTexelC").concat(g,"Ready = 1;\n                }\n              "),h+=1===c&&g>0?"\n                xC".concat(g," = vec4(xTexelC").concat(g-2,".zw, xTexelC").concat(g,".xy);\n                "):"\n                  xCOffset = xC + 1 - 2;\n\n                  if (xCOffset >= 0 && xCOffset < inDims[1]) {\n                    previous = getX(batch, xR, xCOffset, d1);\n\n                    // Need to manually clear unused channels in case\n                    // we're reading from recycled texture.\n                    if (xCOffset + 1 >= inDims[1]) {\n                      previous.zw = vec2(0.0);\n                    }\n\n                    xC".concat(g," = vec4(previous.zw, xTexelC").concat(g,".xy);\n                  } else {\n                    xC").concat(g," = vec4(0.0, 0.0, xTexelC").concat(g,".xy);\n                  }\n                  ")):h+="\n                if (xC >= 0 && xC < inDims[1] && xTexelC".concat(g,"Ready == 0) {\n                  xTexelC").concat(g," = getX(batch, xR, xC, d1);\n                  if (xC + 1 >= inDims[1]) {\n                    xTexelC").concat(g,".zw = vec2(0.0);\n                  }\n                  xTexelC").concat(g,"Ready = 1;\n                }\n\n                xC").concat(g," = xTexelC").concat(g,";\n                "),g+1<f)){var y=u%2===0?ii.util.nearestLargerEven(c):c;c%2===0&&u%2===1||c%2!==0&&u%2!==1?(h+="\n                  xCOffset = xC + imod(pads[1], 2) + ".concat(y,";\n\n                  if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC").concat(g+1,"Ready == 0) {\n                    xTexelC").concat(g+1," = getX(batch, xR, xCOffset, d1);\n\n                    // Need to manually clear unused channels in case\n                    // we're reading from recycled texture.\n                    if (xCOffset + 1 >= inDims[1]) {\n                      xTexelC").concat(g+1,".zw = vec2(0.0);\n                    }\n                    xTexelC").concat(g+1,"Ready = 1;\n                  }\n                  "),h+=c>1?"\n                    xCOffset -= 2;\n                    if (xCOffset >= 0 && xCOffset < inDims[1]) {\n                     previous = getX(batch, xR, xCOffset, d1);\n                     xC".concat(g+1," = vec4(previous.zw, xTexelC").concat(g+1,".xy);\n                    } else {\n                     xC").concat(g+1," = vec4(0.0, 0.0, xTexelC").concat(g+1,".xy);\n                    }\n                    "):"\n                    xC".concat(g+1," = vec4(xTexelC").concat(g,".zw, xTexelC").concat(g+1,".xy);\n                    ")):h+=1===y?"\n                    xC".concat(g+1," = xTexelC").concat(g,";\n                    "):"\n                    xCOffset = xC + ".concat(y,";\n\n                    if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC").concat(g+1,"Ready == 0) {\n                      xTexelC").concat(g+1," = getX(batch, xR, xCOffset, d1);\n                      if (xCOffset + 1 >= inDims[1]) {\n                        xTexelC").concat(g+1,".zw = vec2(0.0);\n                      }\n                      xTexelC").concat(g+1,"Ready = 1;\n                    }\n\n                    xC").concat(g+1," = xTexelC").concat(g+1,";\n                    ")}}else g<f&&(u%2===1?(h+="\n                xCOffset = xC + 1 - strides[1];\n                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC".concat(g,"Ready == 0) {\n                  xTexelC").concat(g," = getX(batch, xR, xCOffset, d1);\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if (xCOffset + 1 >= inDims[1]) {\n                    xTexelC").concat(g,".zw = vec2(0.0);\n                  }\n                  xTexelC").concat(g,"Ready = 1;\n                }\n\n                if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC").concat(g+1,"Ready == 0) {\n                  xTexelC").concat(g+1," = getX(batch, xR, xC + 1, d1);\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if (xC + 2 >= inDims[1]) {\n                    xTexelC").concat(g+1,".zw = vec2(0.0);\n                  }\n                  xTexelC").concat(g+1,"Ready = 1;\n                }\n\n                xC").concat(g," = vec4(xTexelC").concat(g,".zw, xTexelC").concat(g+1,".zw);\n              "),g+1<f&&(h+="\n                  final = vec4(0.0);\n                  xCOffset = xC + 1 + strides[1];\n                  if(xCOffset >= 0 && xCOffset < inDims[1]) {\n                    final = getX(batch, xR, xCOffset, d1);\n                  }\n                  xC".concat(g+1," = vec4(xTexelC").concat(g+1,".xy, final.xy);\n                "))):(h+="\n                if(xC >= 0 && xC < inDims[1] && xTexelC".concat(g,"Ready == 0) {\n                  xTexelC").concat(g," = getX(batch, xR, xC, d1);\n                  if (xC + 1 >= inDims[1]) {\n                    xTexelC").concat(g,".zw = vec2(0.0);\n                  }\n                  xTexelC").concat(g,"Ready = 1;\n                }\n\n                xCOffset = xC + strides[1];\n                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC").concat(g+1,"Ready == 0) {\n                  xTexelC").concat(g+1," = getX(batch, xR, xCOffset, d1);\n                  if (xCOffset + 1 >= inDims[1]) {\n                    xTexelC").concat(g+1,".zw = vec2(0.);\n                  }\n                  xTexelC").concat(g+1,"Ready = 1;\n                }\n\n                xC").concat(g," = vec4(\n                  xTexelC").concat(g,".xy, xTexelC").concat(g+1,".xy);\n              "),g+1<f&&(h+="\n                  xC".concat(g+1," = vec4(xTexelC").concat(g,".zw, xTexelC").concat(g+1,".zw);\n                "))));g<f&&(h+="\n            wTexel = getW(r, ".concat(g,", d1, q);\n            dotProd += xC").concat(g," * vec4(wTexel.xz, wTexel.xz);\n          "),g+1<f&&(h+="\n              wTexel = getW(r, ".concat(g+1,", d1, q);\n              dotProd += xC").concat(g+1," * vec4(wTexel.xz, wTexel.xz);\n            ")))}h+="\n    }\n  ",h+="\n      }\n    ";var b="",x="";r&&(b=a?"vec4 activation(vec4 a) {\n          vec4 b = getPreluActivationWeightsAtOutCoords();\n          ".concat(r,"\n        }"):i?"vec4 activation(vec4 a) {\n          vec4 b = getLeakyreluAlphaAtOutCoords();\n          ".concat(r,"\n        }"):"vec4 activation(vec4 x) {\n          ".concat(r,"\n        }"),x="result = activation(result);");var w=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),a&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode="\n      ".concat(b,"\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int d2 = coords.w;\n        int d1 = d2 / ").concat(o,";\n        int q = d2 - d1 * ").concat(o,";\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.\n        vec4 dotProd = vec4(0.000000000000001);\n\n        ").concat(h,"\n\n        vec4 result = dotProd - vec4(0.000000000000001);\n        ").concat(w,"\n        ").concat(x,"\n        setOutput(result);\n      }\n    ")}));var PT={kernelName:ii.DepthwiseConv2dNative,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.filter,o=r.strides,u=r.pad,s=r.dilations,c=r.dimRoundingMode,l=s;null==l&&(l=[1,1]),ii.util.assert(ii.backend_util.eitherStridesOrDilationsAreOne(o,l),(function(){return"Error in depthwiseConv2d: Either strides or dilations must be "+"1. Got strides ".concat(o," and dilations '").concat(l,"'")}));var f,d=ii.backend_util.computeConv2DInfo(a.shape,i.shape,o,l,u,c,!0);f=(0,ii.env)().getBool("WEBGL_PACK_DEPTHWISECONV")&&d.strideWidth<=2&&d.outChannels/d.inChannels===1?new LT(d):new ZT(d);var h=[[d.padInfo.top,d.padInfo.left],[d.strideHeight,d.strideWidth],[d.dilationHeight,d.dilationWidth],[d.inHeight,d.inWidth]];return n.runWebGLProgram(f,[a,i],"float32",h)}},UT=(0,F.Z)((function e(t){(0,D.Z)(this,e),this.variableNames=["x","dy"],this.outputShape=t.filterShape;var n=t.strideHeight,r=t.strideWidth,a=t.padInfo.top,i=t.padInfo.left,o=t.outChannels/t.inChannels;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int wR = coords.x;\n        int wC = coords.y;\n        int d1 = coords.z;\n        int dm = coords.w;\n        int d2 = d1 * ".concat(o," + dm;\n\n        float dotProd = 0.0;\n\n        // TO DO: Vec4 over the batch size\n        for (int b = 0; b < ").concat(t.batchSize,"; b++) {\n          for (int yR = 0; yR < ").concat(t.outHeight,"; yR++) {\n            int xR = wR + yR * ").concat(n," - ").concat(a,";\n\n            if (xR < 0 || xR >= ").concat(t.inHeight,") {\n              continue;\n            }\n\n            for (int yC = 0; yC < ").concat(t.outWidth,"; yC++) {\n              int xC = wC + yC * ").concat(r," - ").concat(i,";\n\n              if (xC < 0 || xC >= ").concat(t.inWidth,") {\n                continue;\n              }\n\n              float dyValue = getDy(b, yR, yC, d2);\n              float xValue = getX(b, xR, xC, d1);\n              dotProd += (xValue * dyValue);\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")})),WT=(0,F.Z)((function e(t){(0,D.Z)(this,e),this.variableNames=["dy","W"],this.outputShape=t.inShape;var n=t.filterHeight,r=t.filterWidth,a=t.strideHeight,i=t.strideWidth,o=n-1-t.padInfo.top,u=r-1-t.padInfo.left,s=t.outChannels/t.inChannels;this.userCode="\n      const ivec2 pads = ivec2(".concat(o,", ").concat(u,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[3];\n        ivec2 dyCorner = coords.yz - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        float dotProd = 0.0;\n\n        for (int wR = 0; wR < ").concat(n,"; wR++) {\n          float dyR = float(dyRCorner + wR) / ").concat(a,".0;\n\n          if (dyR < 0.0 || dyR >= ").concat(t.outHeight,".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          int wRPerm = ").concat(n," - 1 - wR;\n\n          for (int wC = 0; wC < ").concat(r,"; wC++) {\n            float dyC = float(dyCCorner + wC) / ").concat(i,".0;\n\n            if (dyC < 0.0 || dyC >= ").concat(t.outWidth,".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            int wCPerm = ").concat(r," - 1 - wC;\n\n            // TO DO: Vec4 over the channelMul\n            for (int dm = 0; dm < ").concat(s,"; dm++) {\n              int d2 = d1 * ").concat(s," + dm;\n              float xValue = getDy(batch, idyR, idyC, d2);\n              float wValue = getW(wRPerm, wCPerm, d1, dm);\n              dotProd += xValue * wValue;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}));var VT={kernelName:ii.DepthwiseConv2dNativeBackpropFilter,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.dy,o=r.strides,u=r.dilations,s=r.pad,c=r.dimRoundingMode,l=r.filterShape,f=ii.backend_util.computeConv2DInfo(a.shape,l,o,u,s,c,!0),d=new UT(f);return n.runWebGLProgram(d,[a,i],"float32")}};var qT={kernelName:ii.DepthwiseConv2dNativeBackpropInput,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.dy,i=t.filter,o=r.strides,u=r.dilations,s=r.pad,c=r.dimRoundingMode,l=r.inputShape,f=ii.backend_util.computeConv2DInfo(l,i.shape,o,u,s,c,!0),d=new WT(f);return n.runWebGLProgram(d,[a,i],"float32")}},GT=(0,F.Z)((function e(t){(0,D.Z)(this,e),this.variableNames=["X"],this.outputShape=[t,t],this.userCode="\n      void main() {\n          ivec2 coords = getOutputCoords();\n          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;\n          setOutput(val);\n      }\n    "}));var HT={kernelName:ii.Diag,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.x,a=[].concat((0,I.Z)(r.shape),(0,I.Z)(r.shape)),i=ii.util.sizeFromShape(r.shape),o=CE({inputs:{x:r},backend:n,attrs:{shape:[i]}}),u=new GT(i),s=n.runWebGLProgram(u,[o],o.dtype),c=CE({inputs:{x:s},backend:n,attrs:{shape:a}});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(s),c}},XT=(0,F.Z)((function e(t){(0,D.Z)(this,e),this.variableNames=["x","W"],this.outputShape=t.outShape;var n=t.inHeight,r=t.inWidth,a=t.padInfo,i=t.strideHeight,o=t.strideWidth,u=t.filterHeight,s=t.filterWidth,c=t.dilationHeight,l=t.dilationWidth,f=a.top,d=a.left;this.userCode="\n      const ivec2 strides = ivec2(".concat(i,", ").concat(o,");\n      const ivec2 pads = ivec2(").concat(f,", ").concat(d,");\n      const float neg_infinity = -3.4e38;\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        int d1 = coords.w;\n        ivec2 outTopLeftCorner =\n            coords.yz * strides - pads;\n        int hBeg = outTopLeftCorner.x;\n        int wBeg = outTopLeftCorner.y;\n\n        float curVal = neg_infinity;\n        for (int h = 0; h < ").concat(u,"; h++) {\n          int hIn = hBeg + h * ").concat(c,";\n\n          if (hIn >= 0 && hIn < ").concat(n,") {\n            for (int w = 0; w < ").concat(s,"; w++) {\n              int wIn = wBeg + w * ").concat(l,";\n\n              if (wIn >= 0 && wIn < ").concat(r,") {\n                float xVal = getX(batch, hIn, wIn, d1);\n                float wVal = getW(h, w, d1);\n\n                float val = xVal + wVal;\n                if (val > curVal) {\n                  curVal = val;\n                }\n              }\n            }\n          }\n        }\n\n        float result = curVal;\n        setOutput(result);\n      }\n    ")}));var KT={kernelName:ii.Dilation2D,backendName:"webgl",kernelFunc:function(e){var t,n=e.inputs,r=e.backend,a=e.attrs,i=n.x,o=n.filter,u=a.strides,s=a.pad,c=a.dilations,l=ii.backend_util.computeDilation2DInfo(i.shape,o.shape,u,s,"NHWC",c),f=new XT(l),d=CE({inputs:{x:t=r.runWebGLProgram(f,[i,o],"float32")},backend:r,attrs:{shape:l.outShape}});return r.disposeIntermediateTensorInfo(t),d}};var YT={kernelName:ii.Einsum,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs.equation,a=t,i=ii.backend_util.decodeEinsumEquation(r,a.length),o=i.allDims,u=i.summedDims,s=i.idDims;ii.backend_util.checkEinsumDimSizes(o.length,s,a);for(var c=ii.backend_util.getEinsumComputePath(u,s),l=c.path,f=c.steps,d=f.length,h=null,p=o.length,v=[],m=0;m<d;++m){var g,y=(0,B.Z)(f[m]);try{for(y.s();!(g=y.n()).done;){var b=g.value,x=ii.backend_util.getEinsumPermutation(p,s[b]),w=x.permutationIndices,k=x.expandDims,_=void 0;ii.backend_util.isIdentityPermutation(w)?_=a[b]:(_=RE({inputs:{x:a[b]},backend:n,attrs:{perm:w}}),v.push(_));for(var S=_.shape.slice(),C=0;C<k.length;++C)S.splice(k[C],0,1);ii.util.arraysEqual(_.shape,S)||(_=CE({inputs:{x:_},backend:n,attrs:{shape:S}}),v.push(_)),null===h?h=_:(h=_E({inputs:{a:_,b:h},backend:n}),v.push(h))}}catch(T){y.e(T)}finally{y.f()}m<d-1&&(l[m]>=0&&(h=ME({inputs:{x:h},backend:n,attrs:{axis:l[m]-(o.length-p),keepDims:!1}}),v.push(h)),p--)}for(var A=0,E=v;A<E.length;A++){var N=E[A];N!==h&&n.disposeIntermediateTensorInfo(N)}return h}},$T=vE({opSnippet:"return (x >= 0.0) ? x : (exp(x) - 1.0);",packedOpSnippet:"\n  vec4 result;\n\n  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);\n  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);\n  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);\n  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);\n\n  return result;\n"}),QT={kernelName:ii.Elu,backendName:"webgl",kernelFunc:$T},JT={kernelName:ii.EluGrad,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.dy,a=t.y,i=(0,ii.env)().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new aE("\n  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));\n  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));\n",r.shape,a.shape):new nE("return (b >= 0.0) ? a : a * (b + 1.0);",r.shape,a.shape);return n.runWebGLProgram(i,[r,a],r.dtype)}},eI=mE({opSnippet:"return float(a == b);",packedOpSnippet:"\n  return vec4(equal(a, b));\n",dtype:"bool",cpuKernelImpl:LC}),tI={kernelName:ii.Equal,backendName:"webgl",kernelFunc:eI},nI=vE({opSnippet:'\n  // Error function is calculated approximately with elementary function.\n  // See "Handbook of Mathematical Functions with Formulas,\n  // Graphs, and Mathematical Tables", Abramowitz and Stegun.\n  float p = '.concat(ii.backend_util.ERF_P,";\n  float a1 = ").concat(ii.backend_util.ERF_A1,";\n  float a2 = ").concat(ii.backend_util.ERF_A2,";\n  float a3 = ").concat(ii.backend_util.ERF_A3,";\n  float a4 = ").concat(ii.backend_util.ERF_A4,";\n  float a5 = ").concat(ii.backend_util.ERF_A5,";\n\n  float sign = sign(x);\n  x = abs(x);\n  float t = 1.0 / (1.0 + p * x);\n  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));\n")}),rI={kernelName:ii.Erf,backendName:"webgl",kernelFunc:nI},aI=vE({opSnippet:"if (isnan(x)) return x;\n  return exp(x);\n",packedOpSnippet:"\n  vec4 result = exp(x);\n  bvec4 isNaN = isnan(x);\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",cpuKernelImpl:PC,dtype:"float32"}),iI={kernelName:ii.Exp,backendName:"webgl",kernelFunc:aI};function oI(e){var t=e.inputs,n=e.attrs,r=e.backend,a=n.dim,i=t.input,o=i.shape.length,u=i.shape.slice(),s=a;return a<0&&(ii.util.assert(-(o+1)<=a,(function(){return"Axis must be in the interval [".concat(-(o+1),", ").concat(o,"]")})),s=o+a+1),u.splice(s,0,1),CE({inputs:{x:i},backend:r,attrs:{shape:u}})}var uI={kernelName:ii.ExpandDims,backendName:"webgl",kernelFunc:oI},sI="return exp(x) - 1.0;",cI=vE({opSnippet:sI,packedOpSnippet:sI,cpuKernelImpl:UC}),lI={kernelName:ii.Expm1,backendName:"webgl",kernelFunc:cI},fI=(0,F.Z)((function e(t,n,r){(0,D.Z)(this,e),this.variableNames=["real","imag"];var a=n[1];this.outputShape=n;var i,o=r?"2.0 * ".concat(Math.PI):"-2.0 * ".concat(Math.PI),u=r?"".concat(a,".0"):"1.0";if("real"===t)i="return real * expR - imag * expI;";else{if("imag"!==t)throw new Error('FFT component must be either "real" or "imag", got '.concat(t,"."));i="return real * expI + imag * expR;"}this.userCode="\n      const float exponentMultiplier = ".concat(o,";\n\n      float unaryOpComplex(float real, float expR, float imag, float expI) {\n        ").concat(i,"\n      }\n\n      float mulMatDFT(int batch, int index) {\n        float indexRatio = float(index) / float(").concat(a,");\n        float exponentMultiplierTimesIndexRatio =\n            exponentMultiplier * indexRatio;\n\n        float result = 0.0;\n\n        for (int i = 0; i < ").concat(a,"; i++) {\n          // x = (-2|2 * PI / N) * index * i;\n          float x = exponentMultiplierTimesIndexRatio * float(i);\n          float expR = cos(x);\n          float expI = sin(x);\n          float real = getReal(batch, i);\n          float imag = getImag(batch, i);\n\n          result +=\n              unaryOpComplex(real, expR, imag, expI) / ").concat(u,";\n        }\n\n        return result;\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        setOutput(mulMatDFT(coords[0], coords[1]));\n      }\n    ")}));function dI(e,t,n){var r=n.texData.get(e.dataId),a=ii.util.sizeFromShape(e.shape),i=e.shape[e.shape.length-1],o=CE({inputs:{x:e},backend:n,attrs:{shape:[a/i,i]}}),u=o.shape,s=new fI("real",u,t),c=new fI("imag",u,t),l=[{dataId:r.complexTensorInfos.real.dataId,dtype:r.complexTensorInfos.real.dtype,shape:u},{dataId:r.complexTensorInfos.imag.dataId,dtype:r.complexTensorInfos.imag.dtype,shape:u}],f=n.runWebGLProgram(s,l,"float32"),d=n.runWebGLProgram(c,l,"float32"),h=uE({inputs:{real:f,imag:d},backend:n});n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(d);var p=CE({inputs:{x:h},backend:n,attrs:{shape:e.shape}});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(h),p}var hI={kernelName:ii.FFT,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend;return dI(t.input,!1,n)}},pI=(0,F.Z)((function e(t,n){(0,D.Z)(this,e),this.outputShape=[],this.customUniforms=[{name:"value",type:"float"}],this.variableNames=["x"],this.outputShape=t,this.userCode="\n      void main() {\n        // Input can be obtained from uniform value.\n        setOutput(value);\n      }\n    "}));function vI(e){var t=e.backend,n=e.attrs,r=n.shape,a=n.value,i=n.dtype;if("string"===(i=i||ii.util.inferDtype(a))){var o=ii.util.getArrayFromDType(i,ii.util.sizeFromShape(r));return o.fill(a),t.makeTensorInfo(r,i,o)}var u=new pI(r,a),s=[[a]];return t.runWebGLProgram(u,[],i,s)}var mI,gI={kernelName:ii.Fill,backendName:"webgl",kernelFunc:vI},yI=(0,F.Z)((function e(t){(0,D.Z)(this,e),this.variableNames=["Image"],this.outputShape=[];var n=t[2];this.outputShape=t,this.userCode="\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int x = coords[2];\n\n          int coordX = ".concat(n," - x - 1;\n          float outputValue;\n          if(coordX >= 0 && coordX < ").concat(n,") {\n            outputValue = getImage(coords[0], coords[1], coordX, coords[3]);\n          } else {\n            outputValue = getImage(coords[0], coords[1], coords[2], coords[3]);\n          }\n          setOutput(outputValue);\n        }\n    ")})),bI={kernelName:ii.FlipLeftRight,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.image,a=n,i=new yI(r.shape);return a.runWebGLProgram(i,[r],r.dtype)}},xI="return floor(x);",wI=vE({opSnippet:xI,packedOpSnippet:xI,cpuKernelImpl:WC}),kI={kernelName:ii.Floor,backendName:"webgl",kernelFunc:wI},_I=mE({opSnippet:"\n  float s = sign(a) * sign(b);\n  int ia = round(a);\n  int ib = round(b);\n  if (ib != 0) {\n    // Windows (D3D) wants guaranteed non-zero int division at compile-time.\n    return float(idiv(ia, ib, s));\n  } else {\n    return NAN;\n  }\n",packedOpSnippet:"\n  ivec4 ia = round(a);\n  ivec4 ib = round(b);\n  bvec4 cond = notEqual(ib, ivec4(0));\n  ivec4 result = ivec4(0);\n  vec4 s = sign(a) * sign(b);\n\n  // Windows (D3D) wants guaranteed non-zero int division at compile-time.\n  if (cond[0]) {\n    result[0] = idiv(ia[0], ib[0], s[0]);\n  }\n  if (cond[1]) {\n    result[1] = idiv(ia[1], ib[1], s[1]);\n  }\n  if (cond[2]) {\n    result[2] = idiv(ia[2], ib[2], s[2]);\n  }\n  if (cond[3]) {\n    result[3] = idiv(ia[3], ib[3], s[3]);\n  }\n  return vec4(result);\n",dtype:"int32"}),SI={kernelName:ii.FloorDiv,backendName:"webgl",kernelFunc:_I},CI=(0,F.Z)((function e(t){(0,D.Z)(this,e),this.variableNames=["A"];var n=OS(),r=(0,C.Z)(t,2),a=r[0],i=r[1];this.outputShape=t,this.userCode="\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int texR = coords[0];\n        int texC = coords[1];\n        int depth = coords[2];\n        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(".concat(i,".0, ").concat(a,".0);\n\n        vec4 values = ").concat(n.texture2D,"(A, uv);\n        float value;\n        if (depth == 0) {\n          value = values.r;\n        } else if (depth == 1) {\n          value = values.g;\n        } else if (depth == 2) {\n          value = values.b;\n        } else if (depth == 3) {\n          value = values.a;\n        }\n\n        setOutput(floor(value * 255.0 + 0.5));\n      }\n    ")})),AI=(0,F.Z)((function e(t){(0,D.Z)(this,e),this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;var n=OS(),r=(0,C.Z)(t,2),a=r[0],i=r[1];this.outputShape=t,this.userCode="\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int texR = coords[0];\n        int texC = coords[1];\n        int depth = coords[2];\n\n        vec4 result = vec4(0.);\n\n        for(int row=0; row<=1; row++) {\n          for(int col=0; col<=1; col++) {\n            texC = coords[1] + row;\n            depth = coords[2] + col;\n\n            vec2 uv = (vec2(texC, texR) + halfCR) /\n                       vec2(".concat(i,".0, ").concat(a,".0);\n            vec4 values = ").concat(n.texture2D,"(A, uv);\n            float value;\n            if (depth == 0) {\n              value = values.r;\n            } else if (depth == 1) {\n              value = values.g;\n            } else if (depth == 2) {\n              value = values.b;\n            } else if (depth == 3) {\n              value = values.a;\n            }\n\n            result[row * 2 + col] = floor(value * 255.0 + 0.5);\n          }\n        }\n\n        ").concat(n.output," = result;\n      }\n    ")})),EI={kernelName:ii.FromPixels,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.pixels,i=r.numChannels,o="undefined"!==typeof HTMLVideoElement&&a instanceof HTMLVideoElement,u="undefined"!==typeof HTMLImageElement&&a instanceof HTMLImageElement,s=o?[a.videoWidth,a.videoHeight]:[a.width,a.height],c=(0,C.Z)(s,2),l=c[0],f=c[1],d=[f,l],h=[f,l,i];if(u||o){var p=(0,ii.env)().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");null!=mI&&p===NI||(NI=p,mI=document.createElement("canvas").getContext("2d",{willReadFrequently:NI})),mI.canvas.width=l,mI.canvas.height=f,mI.drawImage(a,0,0,l,f),a=mI.canvas}var v=n.makeTensorInfo(d,"int32");n.texData.get(v.dataId).usage=$_.PIXELS,n.gpgpu.uploadPixelDataToTexture(n.getTexture(v.dataId),a);var m=(0,ii.env)().getBool("WEBGL_PACK")?new AI(h):new CI(h),g=n.runWebGLProgram(m,[v],"int32");return n.disposeData(v.dataId),g}},NI=(0,ii.env)().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");var TI={kernelName:ii.FusedConv2D,backendName:"webgl",kernelFunc:function(e){var t,n=e.inputs,r=e.backend,a=e.attrs,i=n.x,o=n.filter,u=n.bias,s=n.preluActivationWeights,c=a.strides,l=a.pad,f=a.dataFormat,d=a.dilations,h=a.dimRoundingMode,p=a.activation,v=a.leakyreluAlpha,m=ii.backend_util.convertConv2DDataFormat(f),g=ii.backend_util.computeConv2DInfo(i.shape,o.shape,c,d,l,h,!1,m),y=[],b=null!=u,x=null!=s,w="leakyrelu"===p,k=function(){var e=[i,o],t=function(e,t){if("NCHW"===t&&1===e.shape.length&&1!==e.shape[0]){var n=CE({inputs:{x:e},backend:r,attrs:{shape:[e.shape[0],1,1]}});return y.push(n),n}return e};if(b&&e.push(t(u,f)),x&&e.push(t(s,f)),w){var n=r.makeTensorInfo([],"float32",ii.util.createScalarValue(v,"float32"));e.push(n),y.push(n)}return e};if(1!==g.filterHeight||1!==g.filterWidth||1!==g.dilationHeight||1!==g.dilationWidth||1!==g.strideHeight||1!==g.strideWidth||"SAME"!==g.padInfo.type&&"VALID"!==g.padInfo.type)if(g.strideWidth<=2&&"channelsLast"===m&&(0,ii.env)().getBool("WEBGL_EXP_CONV")){var _=p?gE(p,!0):null,S=new uT(g,b,_,x,w),C=[[g.padInfo.top,g.padInfo.left],[g.strideHeight,g.strideWidth],[g.dilationHeight,g.dilationWidth],[g.inHeight,g.inWidth]],A=k();t=r.runWebGLProgram(S,A,"float32",C)}else if((0,ii.env)().getBool("WEBGL_CONV_IM2COL"))t=fT({x:i,filter:o,convInfo:g,backend:r,bias:u,activation:p,preluActivationWeights:s,leakyreluAlpha:v});else{var E=p?gE(p,!1):null,N=new iT(g,b,E,x,w),T=k();t=r.runWebGLProgram(N,T,"float32")}else t=lT({x:i,filter:o,convInfo:g,backend:r,bias:u,activation:p,preluActivationWeights:s,leakyreluAlpha:v});var I=CE({inputs:{x:t},backend:r,attrs:{shape:g.outShape}});return y.push(t),y.forEach((function(e){return r.disposeIntermediateTensorInfo(e)})),I}};var II={kernelName:ii.FusedDepthwiseConv2D,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.filter,o=t.bias,u=t.preluActivationWeights,s=r.strides,c=r.pad,l=r.dilations,f=r.dimRoundingMode,d=r.activation,h=r.leakyreluAlpha,p=[],v=l;null==v&&(v=[1,1]),ii.util.assert(ii.backend_util.eitherStridesOrDilationsAreOne(s,v),(function(){return"Error in depthwiseConv2d: Either strides or dilations must be "+"1. Got strides ".concat(s," and dilations '").concat(v,"'")}));var m,g=ii.backend_util.computeConv2DInfo(a.shape,i.shape,s,v,c,f,!0),y=(0,ii.env)().getBool("WEBGL_PACK_DEPTHWISECONV")&&g.strideWidth<=2&&g.outChannels/g.inChannels===1,b=d?gE(d,y):null,x=[a,i],w=null!=o,k=null!=u,_="leakyrelu"===d;if(w&&x.push(o),k&&x.push(u),_){var S=n.makeTensorInfo([],"float32",ii.util.createScalarValue(h,"float32"));x.push(S),p.push(S)}m=y?new LT(g,w,b,k,_):new ZT(g,w,b,k,_);var C=[[g.padInfo.top,g.padInfo.left],[g.strideHeight,g.strideWidth],[g.dilationHeight,g.dilationWidth],[g.inHeight,g.inWidth]],A=n.runWebGLProgram(m,x,"float32",C);return p.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),A}},DI=(0,F.Z)((function e(t,n,r,a){(0,D.Z)(this,e),this.sliceDim=t,this.strides=n,this.paramsShape=a,this.variableNames=["x","indices"],this.outputShape=r;for(var i=iC(r.length),o="\n    int index;",u=0;u<this.sliceDim;u++)o+="\n          index = round(getIndices(coords[0], ".concat(u,"));\n          out_of_bounds = out_of_bounds || index < 0;\n          out_of_bounds = out_of_bounds || index >= ").concat(this.paramsShape[u],";\n          flattenIndex += index * ").concat(this.strides[u],";");this.userCode="\n         void main() {\n          ".concat(i," coords = getOutputCoords();\n          int flattenIndex = 0;\n          bool out_of_bounds = false;\n\n          ").concat(o,"\n\n          setOutput(out_of_bounds ? 0.0 : getX(flattenIndex, coords[1]));\n        }\n      ")}));var FI={kernelName:ii.GatherNd,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.params,a=t.indices,i=a.shape,o=i[i.length-1],u=ii.util.sizeFromShape(r.shape),s=ii.backend_util.prepareAndValidate(r,a),c=(0,C.Z)(s,4),l=c[0],f=c[1],d=c[2],h=c[3],p=CE({inputs:{x:a},backend:n,attrs:{shape:[f,o]}}),v=CE({inputs:{x:r},backend:n,attrs:{shape:[ii.util.sizeFromShape(r.shape)/d,d]}});if(n.shouldExecuteOnCPU([r,a])||"string"===r.dtype){var m=n.readSync(a.dataId),g=n.bufferSync(r),y=VC(m,g,r.dtype,f,o,d,h,r.shape,u);return n.makeTensorInfo(l,r.dtype,y.values)}var b=new DI(o,h,[f,d],r.shape),x=n.runWebGLProgram(b,[v,p],v.dtype),w=CE({inputs:{x:x},backend:n,attrs:{shape:l}});return n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(v),n.disposeIntermediateTensorInfo(x),w}},MI=(0,F.Z)((function e(t,n){(0,D.Z)(this,e),this.variableNames=["A","indices"],this.outputShape=n,this.rank=n.length;var r=iC(this.rank),a=function(e,t){for(var n=["resRC.x","resRC.y","resRC.z","resRC.w"],r=[],a=0;a<e.length;a++)2===a?r.push("index"):r.push("".concat(n[a]));return r.join()}(t);this.userCode="\n      void main() {\n        ".concat(r," resRC = getOutputCoords();\n        int index = int(getIndices(resRC.x, resRC.z));\n        float inBounds = (index >= 0) && (index < ").concat(t[2],") ? 1.0 : 0.0;\n        setOutput(inBounds * getA(").concat(a,"));\n      }\n    ")}));function OI(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.indices,o=r.axis,u=r.batchDims,s=ii.util.parseAxisParam(o,a.shape)[0];(0,ii.env)().get("DEBUG")&&function(){for(var e=n.readSync(i.dataId),t=a.shape[s],r=function(n){var r=e[n];ii.util.assert(r<=t-1&&r>=0,(function(){return"GatherV2: the index value ".concat(r," is not in [0, ").concat(t-1,"]")}))},o=0;o<e.length;++o)r(o)}();var c=ii.backend_util.segment_util.collectGatherOpShapeInfo(a,i,s,u),l=ii.util.sizeFromShape(i.shape),f=[],d=CE({inputs:{x:a},backend:n,attrs:{shape:[c.batchSize,c.outerSize,c.dimSize,c.sliceSize]}}),h=CE({inputs:{x:i},backend:n,attrs:{shape:[c.batchSize,l/c.batchSize]}});f.push(d),f.push(h);var p=[c.batchSize,c.outerSize,l/c.batchSize,c.sliceSize];if(n.shouldExecuteOnCPU([a,i])||"string"===a.dtype){var v=n.bufferSync(h),m=n.bufferSync(d),g=qC(m,v,p);return f.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),n.makeTensorInfo(c.outputShape,g.dtype,g.values)}var y=new MI(d.shape,p),b=n.runWebGLProgram(y,[d,h],d.dtype);f.push(b);var x=CE({inputs:{x:b},backend:n,attrs:{shape:c.outputShape}});return f.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),x}var RI={kernelName:ii.GatherV2,backendName:"webgl",kernelFunc:OI},jI=mE({opSnippet:"return float(a > b);",packedOpSnippet:"\n  return vec4(greaterThan(a, b));\n",cpuKernelImpl:GC,dtype:"bool"}),BI={kernelName:ii.Greater,backendName:"webgl",kernelFunc:jI},zI=mE({opSnippet:"return float(a >= b);",packedOpSnippet:"\n  return vec4(greaterThanEqual(a, b));\n",dtype:"bool",cpuKernelImpl:HC}),ZI={kernelName:ii.GreaterEqual,backendName:"webgl",kernelFunc:zI};var LI={kernelName:ii.IFFT,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend;return dI(t.input,!0,n)}},PI=vE({opSnippet:"return float(!isnan(x) && !isinf(x));",dtype:"bool"}),UI={kernelName:ii.IsFinite,backendName:"webgl",kernelFunc:PI},WI=vE({opSnippet:"return float(isinf(x));",dtype:"bool"}),VI={kernelName:ii.IsInf,backendName:"webgl",kernelFunc:WI},qI=vE({opSnippet:"return float(isnan(x));",dtype:"bool"}),GI={kernelName:ii.IsNan,backendName:"webgl",kernelFunc:qI},HI=mE({opSnippet:"return float(a < b);",packedOpSnippet:"\n  return vec4(lessThan(a, b));\n",cpuKernelImpl:XC,dtype:"bool"}),XI={kernelName:ii.Less,backendName:"webgl",kernelFunc:HI},KI=mE({opSnippet:"return float(a <= b);",packedOpSnippet:"\n  return vec4(lessThanEqual(a, b));\n",cpuKernelImpl:KC,dtype:"bool"}),YI={kernelName:ii.LessEqual,backendName:"webgl",kernelFunc:KI};var $I={kernelName:ii.LinSpace,backendName:"webgl",kernelFunc:function(e){var t=e.backend,n=e.attrs,r=n.start,a=n.stop,i=n.num,o=YC(r,a,i);return t.makeTensorInfo([o.length],"float32",o)}},QI=vE({opSnippet:"if (isnan(x)) return x;\n  return x < 0.0 ? 0./0. : log(x);\n",packedOpSnippet:"\n  vec4 result = log(x);\n  bvec4 isNaN = isnan(x);\n  result.r = isNaN.r ? x.r : (x.r < 0.0 ? 0./0. : result.r);\n  result.g = isNaN.g ? x.g : (x.g < 0.0 ? 0./0. : result.g);\n  result.b = isNaN.b ? x.b : (x.b < 0.0 ? 0./0. : result.b);\n  result.a = isNaN.a ? x.a : (x.a < 0.0 ? 0./0. : result.a);\n  return result;\n",cpuKernelImpl:$C}),JI={kernelName:ii.Log,backendName:"webgl",kernelFunc:QI},eD=vE({opSnippet:"if (isnan(x)) return x;\n  return log(1.0 + x);\n"}),tD={kernelName:ii.Log1p,backendName:"webgl",kernelFunc:eD},nD=mE({opSnippet:"return float(a >= 1.0 && b >= 1.0);",packedOpSnippet:"\n  return vec4(\n    vec4(greaterThanEqual(a, vec4(1.0))) *\n    vec4(greaterThanEqual(b, vec4(1.0))));\n",dtype:"bool"}),rD={kernelName:ii.LogicalAnd,backendName:"webgl",kernelFunc:nD},aD=vE({opSnippet:"return float(!(x >= 1.0));"}),iD={kernelName:ii.LogicalNot,backendName:"webgl",kernelFunc:aD},oD=mE({opSnippet:"return float(a >= 1.0 || b >= 1.0);",packedOpSnippet:"\n  return min(\n    vec4(greaterThanEqual(a, vec4(1.0))) +\n    vec4(greaterThanEqual(b, vec4(1.0))),\n    vec4(1.0));\n",dtype:"bool"}),uD={kernelName:ii.LogicalOr,backendName:"webgl",kernelFunc:oD},sD=(0,F.Z)((function e(t,n,r,a,i){(0,D.Z)(this,e),this.variableNames=["x"],this.outputShape=[];var o,u=n,s=t[3]-1;this.outputShape=t;var c="float(".concat(r,") + float(").concat(a,") * sum");o=.5===i?"inversesqrt(".concat(c,")"):1===i?"1.0/(".concat(c,")"):"exp(log(".concat(c,") * float(-").concat(i,"));"),this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int r = coords[1];\n        int c = coords[2];\n        int d = coords[3];\n        float x = getX(b, r, c, d);\n        float sum = 0.0;\n        for (int j = -".concat(u,"; j <= ").concat(u,"; j++) {\n          int idx = d + j;\n          if (idx >= 0 && idx <=  ").concat(s,") {\n            float z = getX(b, r, c, idx);\n            sum += z * z;\n          }\n        }\n        float val = x * ").concat(o,";\n        setOutput(val);\n      }\n    ")})),cD=(0,F.Z)((function e(t,n,r,a,i){(0,D.Z)(this,e),this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;var o,u=n,s=t[3]-1;this.outputShape=t;var c="float(".concat(r,") + float(").concat(a,") * sum");o=.5===i?"inversesqrt(".concat(c,")"):1===i?"1.0/(".concat(c,")"):"exp(log(".concat(c,") * float(-").concat(i,"));"),this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords.x;\n        int r = coords.y;\n        int c = coords.z;\n        int d = coords.w;\n\n        bool hasNextCol = d < ".concat(this.outputShape[3],";\n        bool hasNextRow = c < ").concat(this.outputShape[2],";\n\n        vec4 sum = vec4(0.);\n        vec4 xFragAtOutputCoords = getX(b, r, c, d);\n\n        vec4 xAtOutputCoords = vec4(\n          getChannel(xFragAtOutputCoords, vec2(c, d)),\n          hasNextCol ?\n            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,\n          hasNextRow ?\n            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0\n        );\n\n        int firstChannel = d - ").concat(u,";\n        vec2 cache = vec2(0.);\n        if(firstChannel >= 0){\n          vec4 firstChannelFrag = getX(b, r, c, firstChannel);\n          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));\n            if(hasNextRow){\n              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));\n            }\n        }\n\n        ivec2 depth = ivec2(d, d + 1);\n        for (int j = - ").concat(u,"; j <= ").concat(u,"; j++) {\n          ivec2 idx = depth + j;\n          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));\n          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(").concat(s,"));\n\n          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;\n          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;\n\n          if(depthInRange || depthPlusOneInRange){\n            vec4 z = vec4(0.);\n            vec4 xFragAtCurrentDepth;\n            z.xz = cache.xy;\n            if(depthPlusOneInRange && hasNextCol){\n              xFragAtCurrentDepth = idx.y != d ?\n                getX(b, r, c, idx.y) : xFragAtOutputCoords;\n              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));\n              if(hasNextRow){\n                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));\n              }\n            }\n            cache.xy = z.yw;\n            sum += z * z;\n          }\n        }\n        vec4 result = xAtOutputCoords * ").concat(o,";\n        setOutput(result);\n      }\n    ")})),lD={kernelName:ii.LRN,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.depthRadius,o=r.bias,u=r.alpha,s=r.beta,c=(0,ii.env)().getBool("WEBGL_PACK_NORMALIZATION")?new cD(a.shape,i,o,u,s):new sD(a.shape,i,o,u,s);return n.runWebGLProgram(c,[a],a.dtype)}},fD=(0,F.Z)((function e(t,n,r,a,i){(0,D.Z)(this,e),this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=t,this.depth=t[3],this.depthRadius=n,this.bias=r,this.alpha=a,this.beta=i,this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int r = coords[1];\n        int c = coords[2];\n\n        float result = 0.0;\n        for (int d = 0; d < ".concat(this.depth,"; ++d) {\n          int depthBegin = int(max(0.0, float(d - ").concat(n,")));\n          int depthEnd = int(min(float(").concat(this.depth,"),\n              float(d + ").concat(n," + 1)));\n\n          const int MIN_DEPTH_BEGIN = 0;\n          const int MAX_DEPTH_END = ").concat(this.depth,";\n\n          float norm = 0.0;\n          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {\n            if (k < depthBegin){\n              continue;\n            }\n            else if (k >= depthBegin && k < depthEnd) {\n              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);\n            }\n            else {\n              break;\n            }\n          }\n\n          norm = float(").concat(a,") * norm + float(").concat(r,");\n\n          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){\n            if (k < depthBegin){\n              continue;\n            }\n            else if (k >= depthBegin && k < depthEnd){\n              float dyi = -2.0 * float(").concat(a,")\n                * float(").concat(i,")\n                * getInputImage(b, r, c, k) * getOutputImage(b, r, c, d)\n                / norm;\n              if (k == d) {\n                dyi += pow(norm, -1.0 * ").concat(i,");\n              }\n              if (k == coords[3]) {\n                dyi *= getDy(b, r, c, d);\n                result += dyi;\n              }\n            }\n            else {\n              break;\n            }\n          }\n      }\n      setOutput(result);\n      }\n    ")})),dD={kernelName:ii.LRNGrad,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.y,o=t.dy,u=r.depthRadius,s=r.bias,c=r.alpha,l=r.beta,f=new fD(a.shape,u,s,c,l);return n.runWebGLProgram(f,[a,i,o],a.dtype)}};function hD(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.reductionIndices,o=r.keepDims,u=a.shape.length,s=ii.util.parseAxisParam(i,a.shape),c=s,l=ii.backend_util.getAxesPermutation(c,u),f=null!=l,d=n.shouldExecuteOnCPU([a]),h=a;if(f){if(d){for(var p=n.texData.get(h.dataId).values,v=new Array(u),m=0;m<v.length;m++)v[m]=a.shape[l[m]];var g=AA(p,a.shape,a.dtype,l,v);h=n.makeTensorInfo(v,a.dtype),n.texData.get(h.dataId).values=g}else h=FE(a,l,n);c=ii.backend_util.getInnerMostAxes(c.length,u)}ii.backend_util.assertAxesAreInnerMostDims("max",c,u);var y,b=ii.backend_util.computeOutAndReduceShapes(h.shape,c),x=(0,C.Z)(b,2),w=x[0],k=x[1],_=w;if(o&&(_=ii.backend_util.expandShapeToKeepDim(w,s)),d){p=n.texData.get(h.dataId).values;var S=QC(p,ii.util.sizeFromShape(k),_,a.dtype);y=n.makeTensorInfo(_,a.dtype),n.texData.get(y.dataId).values=S}else y=function(e,t,n,r){var a=ii.util.sizeFromShape(t),i=CE({inputs:{x:e},attrs:{shape:[ii.util.sizeFromShape(e.shape)/a,a]},backend:r}),o=TE(i,e.dtype,"max",r),u=CE({inputs:{x:o},attrs:{shape:n},backend:r});return r.disposeIntermediateTensorInfo(i),r.disposeIntermediateTensorInfo(o),u}(h,k,_,n);return f&&n.disposeIntermediateTensorInfo(h),y}var pD={kernelName:ii.Max,backendName:"webgl",kernelFunc:hD},vD=mE({opSnippet:"\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n\n  return max(a, b);\n",packedOpSnippet:"\n  vec4 result = vec4(max(a, b));\n  bvec4 isNaNA = isnan(a);\n  bvec4 isNaNB = isnan(b);\n  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);\n  \n  result.r = isNaN.r ? NAN : result.r;\n  result.g = isNaN.g ? NAN : result.g;\n  result.b = isNaN.b ? NAN : result.b;\n  result.a = isNaN.a ? NAN : result.a;\n\n  return result;\n",cpuKernelImpl:JC}),mD={kernelName:ii.Maximum,backendName:"webgl",kernelFunc:vD};var gD={kernelName:ii.MaxPool,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x;FS(a,"maxPool");var i=r.filterSize,o=r.strides,u=r.pad,s=r.dimRoundingMode;ii.util.assert(ii.backend_util.eitherStridesOrDilationsAreOne(o,1),(function(){return"Error in maxPool: Either strides or dilations must be 1. "+"Got strides ".concat(o," and dilations '").concat(1,"'")}));var c=ii.backend_util.computePool2DInfo(a.shape,i,o,1,u,s);if(1===c.filterWidth&&1===c.filterHeight&&ii.util.arraysEqual(c.inShape,c.outShape))return iE({inputs:{x:a},backend:n});var l=new mN(c,"max",!1);return n.runWebGLProgram(l,[a],a.dtype)}};var yD={kernelName:ii.MaxPool3D,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.filterSize,o=r.strides,u=r.pad,s=r.dataFormat,c=r.dimRoundingMode,l=ii.backend_util.computePool3DInfo(a.shape,i,o,[1,1,1],u,c,s),f=new gN(l,"max",!1);return n.runWebGLProgram(f,[a],a.dtype)}},bD=(0,F.Z)((function e(t){(0,D.Z)(this,e),this.variableNames=["dy","maxPos"],this.outputShape=t.inShape;var n=t.strideHeight,r=t.strideWidth,a=t.dilationHeight,i=t.effectiveFilterHeight,o=t.effectiveFilterWidth,u=i-1-t.padInfo.top,s=o-1-t.padInfo.left,c=i*o-1;this.userCode="\n      const ivec2 pads = ivec2(".concat(u,", ").concat(s,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n\n        ivec2 dyRCCorner = coords.yz - pads;\n        int dyRCorner = dyRCCorner.x;\n        int dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ").concat(i,";\n          wR += ").concat(a,") {\n          float dyR = float(dyRCorner + wR) / ").concat(n,".0;\n\n          if (dyR < 0.0 || dyR >= ").concat(t.outHeight,".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          for (int wC = 0; wC < ").concat(o,"; wC++) {\n            float dyC = float(dyCCorner + wC) / ").concat(r,".0;\n\n            if (dyC < 0.0 || dyC >= ").concat(t.outWidth,".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            float dyValue = getDy(b, idyR, idyC, d);\n            int maxPosValue = ").concat(c," - int(getMaxPos(b, idyR, idyC, d));\n\n            // Get the current value, check it against the value from the\n            // position matrix.\n            int curPosValue = wR * ").concat(o," + wC;\n            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);\n\n            dotProd += dyValue * mask;\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")})),xD=(0,F.Z)((function e(t){(0,D.Z)(this,e),this.variableNames=["dy","maxPos"],this.outputShape=t.inShape;var n=t.strideDepth,r=t.strideHeight,a=t.strideWidth,i=t.dilationDepth,o=t.dilationHeight,u=t.dilationWidth,s=t.effectiveFilterDepth,c=t.effectiveFilterHeight,l=t.effectiveFilterWidth,f=s-1-t.padInfo.front,d=c-1-t.padInfo.top,h=l-1-t.padInfo.left,p=s*c*l-1;this.userCode="\n      const ivec3 pads = ivec3(".concat(f,", ").concat(d,", ").concat(h,");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyDCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get\n        // dx(xD, xR, xC, ch).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int wD = 0; wD < ").concat(s,";\n           wD += ").concat(i,") {\n          float dyD = float(dyDCorner + wD) / ").concat(n,".0;\n\n          if (dyD < 0.0 || dyD >= ").concat(t.outDepth,".0 || fract(dyD) > 0.0) {\n            continue;\n          }\n          int idyD = int(dyD);\n\n          for (int wR = 0; wR < ").concat(c,";\n              wR += ").concat(o,") {\n            float dyR = float(dyRCorner + wR) / ").concat(r,".0;\n\n            if (dyR < 0.0 || dyR >= ").concat(t.outHeight,".0 ||\n                fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            for (int wC = 0; wC < ").concat(l,";\n                wC += ").concat(u,") {\n              float dyC = float(dyCCorner + wC) / ").concat(a,".0;\n\n              if (dyC < 0.0 || dyC >= ").concat(t.outWidth,".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              float dyValue = getDy(batch, idyD, idyR, idyC, ch);\n              int maxPosValue = ").concat(p," -\n                  int(getMaxPos(batch, idyD, idyR, idyC, ch));\n\n              // Get the current value, check it against the value from the\n              // position matrix.\n              int curPosValue =\n                  wD * ").concat(c," * ").concat(l," +\n                  wR * ").concat(l," + wC;\n              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);\n\n              dotProd += dyValue * mask;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}));var wD={kernelName:ii.MaxPool3DGrad,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.dy,i=t.input,o=r.filterSize,u=r.strides,s=r.pad,c=r.dimRoundingMode,l=ii.backend_util.computePool3DInfo(i.shape,o,u,[1,1,1],s,c),f=new gN(l,"max",!0),d=n.runWebGLProgram(f,[i],i.dtype),h=new xD(l),p=n.runWebGLProgram(h,[a,d],i.dtype);return n.disposeIntermediateTensorInfo(d),p}};var kD={kernelName:ii.MaxPoolGrad,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.dy,i=t.input,o=i;FS([i,t.output],"maxPoolGrad");var u=r.filterSize,s=r.strides,c=r.pad,l=r.dimRoundingMode,f=ii.backend_util.computePool2DInfo(o.shape,u,s,1,c,l),d=new mN(f,"max",!0),h=n.runWebGLProgram(d,[o],o.dtype),p=new bD(f),v=n.runWebGLProgram(p,[a,h],o.dtype);return n.disposeIntermediateTensorInfo(h),v}};var _D={kernelName:ii.MaxPoolWithArgmax,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.attrs,r=e.backend,a=t.x,i=n.filterSize,o=n.strides,u=n.pad,s=n.includeBatchInIndex,c=r;ii.util.assert(4===a.shape.length,(function(){return"Error in maxPool: input must be rank 4 but got rank ".concat(a.shape.length,".")}));var l=[1,1];ii.util.assert(ii.backend_util.eitherStridesOrDilationsAreOne(o,l),(function(){return"Error in maxPool: Either strides or dilations must be 1. "+"Got strides ".concat(o," and dilations '").concat(l,"'")}));var f=ii.backend_util.computePool2DInfo(a.shape,i,o,l,u),d=function(e,t,n,r){var a=new mN(n,"max",!1),i=r.runWebGLProgram(a,[e],"float32");return a=new mN(n,"max",!0,!0,t),[i,r.runWebGLProgram(a,[e],"float32")]}(a,s,f,c),h=(0,C.Z)(d,2);return[h[0],h[1]]}};var SD={kernelName:ii.Mean,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.attrs,r=e.backend,a=t.x,i=n.keepDims,o=n.axis,u=r,s=a.shape.length,c=ii.util.parseAxisParam(o,a.shape),l=c,f=ii.backend_util.getAxesPermutation(l,s),d=null!=f,h=u.shouldExecuteOnCPU([a]),p=[],v=a;if(d){if(h){for(var m=u.texData.get(v.dataId).values,g=new Array(s),y=0;y<g.length;y++)g[y]=a.shape[f[y]];var b=AA(m,a.shape,a.dtype,f,g);v=u.makeTensorInfo(g,a.dtype),u.texData.get(v.dataId).values=b}else v=FE(a,f,u);p.push(v),l=ii.backend_util.getInnerMostAxes(l.length,s)}ii.backend_util.assertAxesAreInnerMostDims("sum",l,s);var x=ii.backend_util.computeOutAndReduceShapes(v.shape,l),w=(0,C.Z)(x,2),k=w[0],_=w[1],S=k;i&&(S=ii.backend_util.expandShapeToKeepDim(k,c));for(var A=function(e,t,n,r){var a=ii.util.sizeFromShape(t),i=CE({inputs:{x:e},attrs:{shape:[ii.util.sizeFromShape(e.shape)/a,a]},backend:r}),o=TE(i,"float32","mean",r),u=CE({inputs:{x:o},attrs:{shape:n},backend:r});return r.disposeIntermediateTensorInfo(i),r.disposeIntermediateTensorInfo(o),u}(v,_,S,u),E=0,N=p;E<N.length;E++){y=N[E];u.disposeIntermediateTensorInfo(y)}return A}};var CD={kernelName:ii.Min,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.axis,o=r.keepDims,u=a.shape.length,s=ii.util.parseAxisParam(i,a.shape),c=s,l=ii.backend_util.getAxesPermutation(c,u),f=a;null!=l&&(f=RE({inputs:{x:a},backend:n,attrs:{perm:l}}),c=ii.backend_util.getInnerMostAxes(c.length,a.shape.length)),ii.backend_util.assertAxesAreInnerMostDims("min",c,u);var d,h=ii.backend_util.computeOutAndReduceShapes(f.shape,c),p=(0,C.Z)(h,2),v=p[0],m=p[1],g=CE({inputs:{x:f},backend:n,attrs:{shape:[-1,ii.util.sizeFromShape(m)]}}),y=TE(g,g.dtype,"min",n);return d=CE(o?{inputs:{x:y},backend:n,attrs:{shape:ii.backend_util.expandShapeToKeepDim(v,s)}}:{inputs:{x:y},backend:n,attrs:{shape:v}}),n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(y),null!=l&&n.disposeIntermediateTensorInfo(f),d}},AD=mE({opSnippet:"\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n\n  return min(a, b);\n",packedOpSnippet:"\n  vec4 result = vec4(min(a, b));\n  bvec4 isNaNA = isnan(a);\n  bvec4 isNaNB = isnan(b);\n  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);\n  \n  result.r = isNaN.r ? NAN : result.r;\n  result.g = isNaN.g ? NAN : result.g;\n  result.b = isNaN.b ? NAN : result.b;\n  result.a = isNaN.a ? NAN : result.a;\n\n  return result;\n",cpuKernelImpl:eA}),ED={kernelName:ii.Minimum,backendName:"webgl",kernelFunc:AD},ND=(0,F.Z)((function e(t,n,r){(0,D.Z)(this,e),this.variableNames=["x"],this.outputShape=n.map((function(e,n){return e[0]+t[n]+e[1]}));var a=t.length,i=iC(a),o=n.map((function(e){return e[0]})).join(","),u=n.map((function(e,n){return e[0]+t[n]})).join(","),s=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,a),c="reflect"===r?0:1;this.userCode=1!==a?"\n      ".concat(i," start = ").concat(i,"(").concat(o,");\n      ").concat(i," end = ").concat(i,"(").concat(u,");\n\n      void main() {\n        ").concat(i," outC = getOutputCoords();\n        for (int i = 0; i < ").concat(a,"; i++) {\n          if (outC[i] < start[i]) {\n            outC[i] = start[i] * 2 - outC[i] - ").concat(c,";\n          } else if(outC[i] >= end[i]) {\n            outC[i] = (end[i] - 1) * 2 - outC[i] + ").concat(c,";\n          }\n        }\n        ").concat(i," coords = outC - start;\n        setOutput(getX(").concat(s,"));\n      }\n    "):"\n        int start = ".concat(o,";\n        int end = ").concat(u,";\n\n        void main() {\n          int outC = getOutputCoords();\n          if (outC < start) {\n            outC = start * 2 - outC - ").concat(c,";\n          } else if(outC >= end) {\n            outC = (end - 1) * 2 - outC + ").concat(c,";\n          }\n          setOutput(getX(outC - start));\n        }\n      ")})),TD=(0,F.Z)((function e(t,n,r){(0,D.Z)(this,e),this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n.map((function(e,n){return e[0]+t[n]+e[1]}));var a=t.length,i=iC(a),o=n.map((function(e){return e[0]})).join(","),u=n.map((function(e,n){return e[0]+t[n]})).join(","),s=TA("rc",a),c=TA("source",a),l="".concat(s[a-1]," < ").concat(this.outputShape[a-1]),f=1===a?"source":"vec2(".concat(c.slice(-2).join(),")"),d="reflect"===r?0:1,h="";if(1===a){var p="\n        ".concat(i," source = rc;\n        if (source < start) {\n          source = start * 2 - source - ").concat(d,";\n        } else if (source >= end) {\n          source = (end - 1) * 2 - source + ").concat(d,";\n        }\n        source -= start;\n      ");h="\n        ".concat(i," rc = outputLoc;\n        ").concat(p,"\n        result[0] = getChannel(getX(").concat(c.join(),"), ").concat(f,");\n        ").concat(s[a-1]," += 1;\n        if(").concat(l,") {\n          ").concat(p,"\n          result[1] = getChannel(getX(").concat(c.join(),"), ").concat(f,");\n        }\n      ")}else{var v="\n        ".concat(i," source = rc;\n        ").concat(i," lt = ").concat(i,"(lessThan(source, start));\n        ").concat(i," gte = ").concat(i,"(greaterThanEqual(source, end));\n        ").concat(i," orig = 1 - (lt + gte);\n        source = orig * source +\n                lt * (start * 2 - source - ").concat(d,") +\n                gte * ((end - 1) * 2 - source + ").concat(d,");\n        source -= start;\n      ");h="\n        ".concat(i," rc = outputLoc;\n        ").concat(v,"\n        result[0] = getChannel(getX(").concat(c.join(),"), ").concat(f,");\n        ").concat(s[a-1]," += 1;\n        if(").concat(l,") {\n          ").concat(v,"\n          result[1] = getChannel(getX(").concat(c.join(),"), ").concat(f,");\n        }\n        rc = outputLoc;\n        ").concat(s[a-2]," += 1;\n        if(").concat(s[a-2]," < ").concat(this.outputShape[a-2],") {\n          ").concat(v,"\n          result[2] = getChannel(getX(").concat(c.join(),"), ").concat(f,");\n          ").concat(s[a-1]," += 1;\n          if(").concat(l,") {\n            ").concat(v,"\n            result[3] = getChannel(getX(").concat(c.join(),"), ").concat(f,");\n          }\n        }\n      ")}this.userCode="\n      const ".concat(i," start = ").concat(i,"(").concat(o,");\n      const ").concat(i," end = ").concat(i,"(").concat(u,");\n\n      void main() {\n        ").concat(i," outputLoc = getOutputCoords();\n        vec4 result = vec4(0.);\n        ").concat(h,"\n        setOutput(result);\n      }\n    ")})),ID={kernelName:ii.MirrorPad,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.paddings,o=r.mode,u=(0,ii.env)().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new TD(a.shape,i,o):new ND(a.shape,i,o);return n.runWebGLProgram(u,[a],a.dtype)}},DD=mE({opSnippet:"if (b == 0.0) return NAN;\n  return mod(a, b);",packedOpSnippet:"\n  vec4 result = mod(a, b);\n  bvec4 isNaN = equal(b, vec4(0.0));\n  \n  result.r = isNaN.r ? NAN : result.r;\n  result.g = isNaN.g ? NAN : result.g;\n  result.b = isNaN.b ? NAN : result.b;\n  result.a = isNaN.a ? NAN : result.a;\n\n  return result;\n"}),FD={kernelName:ii.Mod,backendName:"webgl",kernelFunc:DD},MD=(0,F.Z)((function e(t,n,r){(0,D.Z)(this,e),this.variableNames=["probs"],this.customUniforms=[{name:"seed",type:"float"}],this.outputShape=[t,r],this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n\n        float r = random(seed);\n        float cdf = 0.0;\n\n        for (int i = 0; i < ".concat(n-1,"; i++) {\n          cdf += getProbs(batch, i);\n\n          if (r < cdf) {\n            setOutput(float(i));\n            return;\n          }\n        }\n\n        // If no other event happened, last event happened.\n        setOutput(float(").concat(n-1,"));\n      }\n    ")})),OD=mE({opSnippet:"\nif (a == b) {\n  return 1.0;\n};\nreturn a / b;",packedOpSnippet:"\n  // vec4 one = vec4(equal(a, b));\n  // return one + (vec4(1.0) - one) * a / b;\n  vec4 result = a / b;\n  if(a.x == b.x) {\n    result.x = 1.;\n  }\n  if(a.y == b.y) {\n    result.y = 1.;\n  }\n  if(a.z == b.z) {\n    result.z = 1.;\n  }\n  if(a.w == b.w) {\n    result.w = 1.;\n  }\n\n  return result;\n",checkOutOfBounds:!0}),RD={kernelName:ii.RealDiv,backendName:"webgl",kernelFunc:OD},jD="return a - b;",BD=mE({opSnippet:jD,packedOpSnippet:jD,supportsComplex:!0,cpuKernelImpl:_A}),zD={kernelName:ii.Sub,backendName:"webgl",kernelFunc:BD};function ZD(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.logits,i=r.dim,o=ii.util.parseAxisParam([i],a.shape),u=hD({inputs:{x:a},backend:n,attrs:{reductionIndices:o,keepDims:!1}}),s=ii.backend_util.expandShapeToKeepDim(u.shape,o),c=CE({inputs:{x:u},backend:n,attrs:{shape:s}}),l=BD({inputs:{a:a,b:c},backend:n}),f=aI({inputs:{x:l},backend:n}),d=ME({inputs:{x:f},backend:n,attrs:{axis:o,keepDims:!1}}),h=CE({inputs:{x:d},backend:n,attrs:{shape:s}}),p=OD({inputs:{a:f,b:h},backend:n});return n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(l),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(h),p}var LD={kernelName:ii.Softmax,backendName:"webgl",kernelFunc:ZD};var PD={kernelName:ii.Multinomial,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.logits,i=r.numSamples,o=r.seed,u=r.normalized,s=u?a:ZD({inputs:{logits:a},backend:n,attrs:{dim:a.shape.length-1}}),c=s.shape[0],l=s.shape[1],f=new MD(c,l,i),d=[[o]],h=n.runWebGLProgram(f,[s],"int32",d);return u||n.disposeIntermediateTensorInfo(s),h}};var UD={kernelName:ii.Neg,backendName:"webgl",kernelFunc:function(e){var t,n=e.inputs,r=e.backend,a=n.x;if(r.shouldExecuteOnCPU([a])){var i=r.texData.get(a.dataId),o=nA(i.values,a.shape,a.dtype),u=(0,C.Z)(o,2),s=u[0],c=u[1];return r.makeTensorInfo(c,a.dtype,s)}return t=(0,ii.env)().getBool("WEBGL_PACK_UNARY_OPERATIONS")?new YA(a.shape,"\n  vec4 result = -x;\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n"):new jA(a.shape,"if (isnan(x)) return x;\n  return -x;\n"),r.runWebGLProgram(t,[a],a.dtype)}},WD=ii.kernel_impls.nonMaxSuppressionV3Impl;var VD={kernelName:ii.NonMaxSuppressionV3,backendName:"webgl",kernelFunc:function(e){ii.backend_util.warn("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");var t=e.inputs,n=e.backend,r=e.attrs,a=t.boxes,i=t.scores,o=r.maxOutputSize,u=r.iouThreshold,s=r.scoreThreshold,c=n.readSync(a.dataId),l=n.readSync(i.dataId),f=WD(c,l,o,u,s).selectedIndices;return n.makeTensorInfo([f.length],"int32",new Int32Array(f))}},qD=ii.kernel_impls.nonMaxSuppressionV4Impl;var GD={kernelName:ii.NonMaxSuppressionV4,backendName:"webgl",kernelFunc:function(e){ii.backend_util.warn("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");var t=e.inputs,n=e.backend,r=e.attrs,a=t.boxes,i=t.scores,o=r.maxOutputSize,u=r.iouThreshold,s=r.scoreThreshold,c=r.padToMaxOutputSize,l=n.readSync(a.dataId),f=n.readSync(i.dataId),d=qD(l,f,o,u,s,c),h=d.selectedIndices,p=d.validOutputs;return[n.makeTensorInfo([h.length],"int32",new Int32Array(h)),n.makeTensorInfo([],"int32",new Int32Array([p]))]}},HD=ii.kernel_impls.nonMaxSuppressionV5Impl;var XD={kernelName:ii.NonMaxSuppressionV5,backendName:"webgl",kernelFunc:function(e){ii.backend_util.warn("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");var t=e.inputs,n=e.backend,r=e.attrs,a=t.boxes,i=t.scores,o=r.maxOutputSize,u=r.iouThreshold,s=r.scoreThreshold,c=r.softNmsSigma,l=n.readSync(a.dataId),f=n.readSync(i.dataId),d=HD(l,f,o,u,s,c),h=d.selectedIndices,p=d.selectedScores;return[n.makeTensorInfo([h.length],"int32",new Int32Array(h)),n.makeTensorInfo([p.length],"float32",new Float32Array(p))]}},KD=(0,F.Z)((function e(t,n,r,a){(0,D.Z)(this,e),this.variableNames=["indices"],this.outputShape=[t,n],this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int index = round(getIndices(coords.x));\n        setOutput(mix(float(".concat(a,"), float(").concat(r,"),\n                      float(index == coords.y)));\n      }\n    ")})),YD={kernelName:ii.OneHot,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.indices,i=r.dtype,o=r.depth,u=r.onValue,s=r.offValue,c=ii.util.sizeFromShape(a.shape),l=new KD(c,o,u,s),f=CE({inputs:{x:a},backend:n,attrs:{shape:[c]}}),d=n.runWebGLProgram(l,[f],i);n.disposeIntermediateTensorInfo(f);var h=CE({inputs:{x:d},backend:n,attrs:{shape:[].concat((0,I.Z)(a.shape),[o])}});return n.disposeIntermediateTensorInfo(d),h}};function $D(e){var t=e.inputs,n=e.backend,r=t.x;if("complex64"===r.dtype){var a=ZN({inputs:{input:r},backend:n}),i=$D({inputs:{x:a},backend:n}),o=eT({inputs:{input:r},backend:n}),u=$D({inputs:{x:o},backend:n}),s=uE({inputs:{real:i,imag:u},backend:n});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(u),s}return vI({attrs:{shape:r.shape,dtype:r.dtype,value:"string"===r.dtype?"":0},backend:n})}var QD={kernelName:ii.ZerosLike,backendName:"webgl",kernelFunc:$D};var JD={kernelName:ii.OnesLike,backendName:"webgl",kernelFunc:function e(t){var n=t.inputs,r=t.backend,a=n.x;if("string"===a.dtype)throw new Error("onesLike is not supported under string dtype");if("complex64"===a.dtype){var i=ZN({inputs:{input:a},backend:r}),o=e({inputs:{x:i},backend:r}),u=eT({inputs:{input:a},backend:r}),s=$D({inputs:{x:u},backend:r}),c=uE({inputs:{real:o,imag:s},backend:r});return r.disposeIntermediateTensorInfo(i),r.disposeIntermediateTensorInfo(o),r.disposeIntermediateTensorInfo(u),r.disposeIntermediateTensorInfo(s),c}return vI({attrs:{shape:a.shape,dtype:a.dtype,value:1},backend:r})}};var eF={kernelName:ii.Pack,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs.axis;if(1===t.length)return oI({inputs:{input:t[0]},backend:n,attrs:{dim:r}});var a=t[0].shape,i=t[0].dtype;t.forEach((function(e){ii.util.assertShapesMatch(a,e.shape,"All tensors passed to stack must have matching shapes"),ii.util.assert(i===e.dtype,(function(){return"All tensors passed to stack must have matching dtypes"}))}));var o=[],u=rT({inputs:t.map((function(e){var t=oI({inputs:{input:e},backend:n,attrs:{dim:r}});return o.push(t),t})),backend:n,attrs:{axis:r}});return o.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),u}},tF=(0,F.Z)((function e(t,n,r){(0,D.Z)(this,e),this.variableNames=["x"],this.customUniforms=[{name:"value",type:"float"}],this.outputShape=n.map((function(e,n){return e[0]+t[n]+e[1]}));var a=t.length,i=iC(a),o=n.map((function(e){return e[0]})).join(","),u=n.map((function(e,n){return e[0]+t[n]})).join(","),s=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,a);this.userCode=1!==a?"\n      ".concat(i," start = ").concat(i,"(").concat(o,");\n      ").concat(i," end = ").concat(i,"(").concat(u,");\n\n      void main() {\n        ").concat(i," outC = getOutputCoords();\n        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {\n          setOutput(value);\n        } else {\n          ").concat(i," coords = outC - start;\n          setOutput(getX(").concat(s,"));\n        }\n      }\n    "):"\n        int start = ".concat(o,";\n        int end = ").concat(u,";\n\n        void main() {\n          int outC = getOutputCoords();\n          if (outC < start || outC >= end) {\n            setOutput(value);\n          } else {\n            setOutput(getX(outC - start));\n          }\n        }\n      ")})),nF=(0,F.Z)((function e(t,n,r){(0,D.Z)(this,e),this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"value",type:"float"}],this.outputShape=n.map((function(e,n){return e[0]+t[n]+e[1]}));for(var a=t.length,i=iC(a),o=n.map((function(e){return e[0]})).join(","),u=n.map((function(e,n){return e[0]+t[n]})).join(","),s=TA("rc",a),c=TA("source",a),l="".concat(s[a-1]," < ").concat(this.outputShape[a-1]),f=1===a?"source":"vec2(".concat(c.slice(-2).join(),")"),d=["".concat(i," rc = outputLoc;"),"".concat(s[a-1]," += 1;\n       if(").concat(l,") {\n      "),1===a?"":"}\n       rc = outputLoc;\n       ".concat(s[a-2]," += 1;\n       if(").concat(s[a-2]," < ").concat(this.outputShape[a-2],") {"),1===a?"":"  ".concat(s[a-1]," += 1;\n         if(").concat(l,") {")],h=1===a?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))",p="",v=0,m=1===a?2:4;v<m;v++)p+="\n        ".concat(d[v],"\n        if (").concat(h,") {\n          result[").concat(v,"] = float(value);\n        } else {\n          ").concat(i," source = rc - start;\n          result[").concat(v,"] = getChannel(getX(").concat(c.join(),"), ").concat(f,");\n        }\n      ");p+=1===a?"} ":"}}",this.userCode="\n      const ".concat(i," start = ").concat(i,"(").concat(o,");\n      const ").concat(i," end = ").concat(i,"(").concat(u,");\n\n      void main() {\n        ").concat(i," outputLoc = getOutputCoords();\n        vec4 result = vec4(0.);\n        ").concat(p,"\n        setOutput(result);\n      }\n    ")})),rF=function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.paddings,o=r.constantValue;if(0===ii.util.sizeFromShape(a.shape)){var u=i.map((function(e,t){return e[0]+a.shape[t]+e[1]}));return vI({backend:n,attrs:{shape:u,value:o,dtype:a.dtype}})}var s=(0,ii.env)().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new nF(a.shape,i,o):new tF(a.shape,i,o),c=[[o]];return n.runWebGLProgram(s,[a],a.dtype,c)},aF={kernelName:ii.PadV2,backendName:"webgl",kernelFunc:rF},iF=mE({opSnippet:"\n  if(a < 0.0 && floor(b) < b){\n    return NAN;\n  }\n  if (b == 0.0) {\n    return 1.0;\n  }\n  return (round(mod(b, 2.0)) != 1) ?\n      pow(abs(a), b) : sign(a) * pow(abs(a), b);\n",packedOpSnippet:"\n  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.\n  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));\n  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);\n  vec4 result = multiplier * pow(abs(a), b);\n\n  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS\n  bvec4 isExpZero = equal(b, vec4(0.0));\n  result.r = isExpZero.r ? 1.0 : result.r;\n  result.g = isExpZero.g ? 1.0 : result.g;\n  result.b = isExpZero.b ? 1.0 : result.b;\n  result.a = isExpZero.a ? 1.0 : result.a;\n\n  bvec4 isNaN1 = lessThan(a, vec4(0.0));\n  bvec4 isNaN2 = lessThan(floor(b), b);\n  bvec4 isNaN = bvec4(isNaN1.x && isNaN2.x, isNaN1.y && isNaN2.y, isNaN1.z && isNaN2.z, isNaN1.w && isNaN2.w);\n  \n  result.r = isNaN.r ? NAN : result.r;\n  result.g = isNaN.g ? NAN : result.g;\n  result.b = isNaN.b ? NAN : result.b;\n  result.a = isNaN.a ? NAN : result.a;\n\n  return result;\n"}),oF={kernelName:ii.Pow,backendName:"webgl",kernelFunc:iF};var uF={kernelName:ii.Prod,backendName:"webgl",kernelFunc:function(e){var t,n=e.inputs,r=e.backend,a=e.attrs,i=n.x,o=a.axis,u=a.keepDims,s=i.shape.length,c=[],l=ii.util.parseAxisParam(o,i.shape),f=l,d=ii.backend_util.getAxesPermutation(f,s),h=i;if(null!=d&&(h=RE({inputs:{x:i},backend:r,attrs:{perm:d}}),f=ii.backend_util.getInnerMostAxes(f.length,s),c.push(h)),ii.backend_util.assertAxesAreInnerMostDims("prod",f,s),r.shouldExecuteOnCPU([h])){var p=r.texData.get(h.dataId).values,v=aA(h.shape,h.dtype,p,f),m=v.outVals,g=v.outShape,y=v.outDtype;t=r.makeTensorInfo(g,y,m)}else{var b=ii.backend_util.computeOutAndReduceShapes(h.shape,f),x=(0,C.Z)(b,2),w=x[0],k=x[1],_=ii.util.sizeFromShape(k),S=CE({inputs:{x:h},backend:r,attrs:{shape:[-1,_]}}),A=TE(S,(0,ii.sumOutType)(i.dtype),"prod",r);t=CE({inputs:{x:A},backend:r,attrs:{shape:w}}),c.push(S),c.push(A)}if(u){c.push(t);var E=ii.backend_util.expandShapeToKeepDim(t.shape,l);t=CE({inputs:{x:t},backend:r,attrs:{shape:E}})}return c.forEach((function(e){return r.disposeIntermediateTensorInfo(e)})),t}};var sF={kernelName:ii.RaggedGather,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.paramsNestedSplits,i=t.paramsDenseValues,o=t.indices,u=r.outputRaggedRank,s=a.map((function(e){return n.readSync(e.dataId)})),c=a.map((function(e){return e.shape})),l=n.readSync(i.dataId),f=n.readSync(o.dataId),d=iA(s,c,l,i.shape,i.dtype,f,o.shape,u),h=(0,C.Z)(d,3),p=h[0],v=h[1],m=h[2],g=p.map((function(e){return n.makeTensorInfo([e.length],"int32",e)})),y=n.makeTensorInfo(m,i.dtype,v);return g.concat([y])}};var cF={kernelName:ii.RaggedRange,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.starts,a=t.limits,i=t.deltas,o=n.readSync(r.dataId),u=n.readSync(a.dataId),s=n.readSync(i.dataId),c=oA(o,r.shape,r.dtype,u,a.shape,s,i.shape),l=(0,C.Z)(c,2),f=l[0],d=l[1];return[n.makeTensorInfo([f.length],"int32",f),n.makeTensorInfo([d.length],r.dtype,d)]}};var lF={kernelName:ii.RaggedTensorToTensor,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.shape,i=t.values,o=t.defaultValue,u=t.rowPartitionTensors,s=r.rowPartitionTypes,c=n.readSync(a.dataId),l=n.readSync(i.dataId),f=n.readSync(o.dataId),d=u.map((function(e){return n.readSync(e.dataId)})),h=u.map((function(e){return e.shape})),p=uA(c,a.shape,l,i.shape,i.dtype,f,o.shape,d,h,s),v=(0,C.Z)(p,2),m=v[0],g=v[1];return n.makeTensorInfo(m,i.dtype,g)}},fF=function(e){var t=e.backend,n=e.attrs,r=n.start,a=n.stop,i=n.step,o=n.dtype,u=sA(r,a,i,o);return t.makeTensorInfo([u.length],o,u)},dF={kernelName:ii.Range,backendName:"webgl",kernelFunc:fF},hF=vE({opSnippet:"return 1.0 / x;"}),pF={kernelName:ii.Reciprocal,backendName:"webgl",kernelFunc:hF},vF=vE({opSnippet:"if (isnan(x)) return x;\n  return (x < 0.0) ? 0.0 : x;\n",packedOpSnippet:"\n  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n"}),mF={kernelName:ii.Relu,backendName:"webgl",kernelFunc:vF},gF=vE({opSnippet:"if (isnan(x)) return x;\n  return (x < 0.0) ? 0.0 : min(6.0, x);\n",packedOpSnippet:"\n  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n"}),yF={kernelName:ii.Relu6,backendName:"webgl",kernelFunc:gF},bF=(0,F.Z)((function e(t,n,r,a,i){(0,D.Z)(this,e),this.variableNames=["A"],this.outputShape=[];var o=(0,C.Z)(t,4),u=o[0],s=o[1],c=o[2],l=o[3];this.outputShape=[u,n,r,l];var f,d=[a&&n>1?s-1:s,a&&r>1?c-1:c],h=[a&&n>1?n-1:n,a&&r>1?r-1:r];f=i?"(vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC - vec2(0.5)":"vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode="\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\n          ".concat(d[0]/h[0],",\n          ").concat(d[1]/h[1],");\n      const vec2 inputShapeRC = vec2(").concat(s,".0, ").concat(c,".0);\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        ivec2 yRC = coords.yz;\n\n        // Fractional source index.\n        vec2 sourceFracIndexRC = ").concat(f,";\n\n        // Compute the four integer indices.\n        ivec2 sourceFloorRC = ivec2(max(sourceFracIndexRC, vec2(0.0)));\n        ivec2 sourceCeilRC = ivec2(\n          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));\n\n        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);\n        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);\n        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);\n        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);\n\n        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);\n\n        float top = topLeft + (topRight - topLeft) * fracRC.y;\n        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;\n        float newValue = top + (bottom - top) * fracRC.x;\n\n        setOutput(newValue);\n      }\n    ")})),xF=(0,F.Z)((function e(t,n,r,a,i){(0,D.Z)(this,e),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];var o=(0,C.Z)(t,4),u=o[0],s=o[1],c=o[2],l=o[3];this.outputShape=[u,n,r,l];var f,d=[a&&n>1?s-1:s,a&&r>1?c-1:c],h=[a&&n>1?n-1:n,a&&r>1?r-1:r];f=i?"(vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC - vec3(0.5)":"vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode="\n      const vec3 effectiveInputOverOutputRatioRC = vec3(\n          ".concat(d[0]/h[0],",\n          ").concat(d[1]/h[1],",\n          ").concat(d[1]/h[1],");\n      const vec3 inputShapeRC = vec3(").concat(s,".0, ").concat(c,".0,\n                                     ").concat(c,".0);\n\n      float getAValue(int b, int r, int c, int d) {\n        return getChannel(getA(b, r, c, d), vec2(c, d));\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        // Calculate values for next column in yRC.z.\n        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);\n\n        // Fractional source index.\n        vec3 sourceFracIndexRC = ").concat(f,";\n\n        // Compute the four integer indices.\n        ivec3 sourceFloorRC = ivec3(max(sourceFracIndexRC, vec3(0.0)));\n        ivec3 sourceCeilRC = ivec3(\n          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));\n\n        // Should we calculate next column and row elements in 2x2 packed cell.\n        bool hasNextCol = d < ").concat(l-1,";\n        bool hasNextRow = coords.z < ").concat(r-1,";\n\n        // In parallel, construct four corners for all four components in\n        // packed 2x2 cell.\n        vec4 topLeft = vec4(\n          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),\n          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);\n\n        vec4 bottomLeft = vec4(\n          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),\n          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);\n\n        vec4 topRight = vec4(\n          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),\n          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);\n\n        vec4 bottomRight = vec4(\n          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),\n          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);\n\n        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);\n\n        vec4 top = mix(topLeft, topRight, fracRC.yyzz);\n        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);\n        vec4 newValue = mix(top, bottom, fracRC.x);\n\n        setOutput(newValue);\n      }\n    ")}));var wF={kernelName:ii.ResizeBilinear,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.images,i=r.alignCorners,o=r.halfPixelCenters,u=r.size,s=(0,C.Z)(u,2),c=s[0],l=s[1],f=(0,ii.env)().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new xF(a.shape,c,l,i,o):new bF(a.shape,c,l,i,o);return n.runWebGLProgram(f,[a],"float32")}},kF=(0,F.Z)((function e(t,n,r){(0,D.Z)(this,e),this.variableNames=["dy"],this.outputShape=[],this.outputShape=n;var a=(0,C.Z)(n,3),i=a[1],o=a[2],u=(0,C.Z)(t,3),s=u[1],c=u[2],l=[r&&s>1?i-1:i,r&&c>1?o-1:o],f=[r&&s>1?s-1:s,r&&c>1?c-1:c],d=l[0]/f[0],h=l[1]/f[1],p=1/d,v=1/h,m=2*Math.ceil(p)+2,g=2*Math.ceil(v)+2;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        int r = coords[1];\n        int c = coords[2];\n\n        float accumulator = 0.0;\n\n        const float heightScale = float(".concat(d,");\n        const float widthScale = float(").concat(h,");\n\n        const float invHeightScale = float(").concat(p,");\n        const float invWidthScale = float(").concat(v,");\n\n        const int winHeight = int(").concat(m,");\n        const int winWidth = int(").concat(g,");\n\n        // Compute bounds for where in dy we will look\n        float startRLerp = floor(float(r) * invHeightScale);\n        int startDyR = int(startRLerp - float(winHeight / 2));\n\n        float startCLerp = floor(float(c) * invWidthScale);\n        int startDyC = int(startCLerp - float(winWidth / 2));\n\n        // Loop over dy\n        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {\n          int dyR = dyROffset + startDyR;\n\n          // Guard against the window exceeding the bounds of dy\n          if (dyR < 0 || dyR >= ").concat(s,") {\n            continue;\n          }\n\n          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {\n            int dyC = dyCOffset + startDyC;\n\n            // Guard against the window exceeding the bounds of dy\n            if (dyC < 0 || dyC >= ").concat(c,") {\n              continue;\n            }\n\n            float dxR = float(dyR) * heightScale;\n            int topDxRIndex = int(floor(dxR));\n            int bottomDxRIndex = int(min(ceil(dxR), ").concat(i-1,".0));\n            float dxRLerp = dxR - float(topDxRIndex);\n            float inverseDxRLerp = 1.0 - dxRLerp;\n\n            float dxC = float(dyC) * widthScale;\n            int leftDxCIndex = int(floor(dxC));\n            int rightDxCIndex = int(min(ceil(dxC), ").concat(o-1,".0));\n            float dxCLerp = dxC - float(leftDxCIndex);\n            float inverseDxCLerp = 1.0 - dxCLerp;\n\n            if (r == topDxRIndex && c == leftDxCIndex) {\n              // topLeft\n              accumulator +=\n                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;\n            }\n\n            if (r == topDxRIndex && c == rightDxCIndex) {\n              // topRight\n              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;\n            }\n\n            if (r == bottomDxRIndex && c == leftDxCIndex) {\n              // bottomLeft\n              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;\n            }\n\n            if (r == bottomDxRIndex && c == rightDxCIndex) {\n              // bottomRight\n              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;\n            }\n          }\n        }\n        // End loop over dy\n\n        setOutput(accumulator);\n      }\n    ")}));var _F={kernelName:ii.ResizeBilinearGrad,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.images,i=t.dy,o=r.alignCorners,u=new kF(i.shape,a.shape,o);return n.runWebGLProgram(u,[i],i.dtype)}},SF=(0,F.Z)((function e(t,n,r,a,i){(0,D.Z)(this,e),this.variableNames=["A"],this.outputShape=[];var o=(0,C.Z)(t,4),u=o[0],s=o[1],c=o[2],l=o[3];this.outputShape=[u,n,r,l];var f,d=[a&&n>1?s-1:s,a&&r>1?c-1:c],h=[a&&n>1?n-1:n,a&&r>1?r-1:r],p=a?"0.5":"0.0";f=i?"max((vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC, vec2(0.0))":"vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode="\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\n          ".concat(d[0]/h[0],",\n          ").concat(d[1]/h[1],");\n      const vec2 inputShapeRC = vec2(").concat(s,".0, ").concat(c,".0);\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        ivec2 yRC = coords.yz;\n\n        // Fractional source index.\n        vec2 sourceFracIndexRC = ").concat(f,";\n\n        // Compute the coordinators of nearest neighbor point.\n        ivec2 sourceNearestRC = ivec2(\n          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ").concat(p,")));\n        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);\n\n        setOutput(newValue);\n      }\n    ")})),CF=(0,F.Z)((function e(t,n,r,a,i){(0,D.Z)(this,e),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];var o=(0,C.Z)(t,4),u=o[0],s=o[1],c=o[2],l=o[3];this.outputShape=[u,n,r,l];var f,d=[a&&n>1?s-1:s,a&&r>1?c-1:c],h=[a&&n>1?n-1:n,a&&r>1?r-1:r],p=a?"0.5":"0.0";f=i?"max((vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC, vec3(0.0))":"vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode="\n      const vec3 effectiveInputOverOutputRatioRC = vec3(\n          ".concat(d[0]/h[0],",\n          ").concat(d[1]/h[1],",\n          ").concat(d[1]/h[1],");\n      const vec3 inputShapeRC = vec3(").concat(s,".0, ").concat(c,".0,\n                                     ").concat(c,".0);\n\n      float getAValue(int b, int r, int c, int d) {\n        return getChannel(getA(b, r, c, d), vec2(c, d));\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        // Calculate values for next column in yRC.z.\n        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);\n\n        // Fractional source index.\n        vec3 sourceFracIndexRC = ").concat(f,";\n\n        // Compute the coordinators of nearest neighbor point.\n        ivec3 sourceNearestRC = ivec3(\n          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ").concat(p,")));\n\n        // Should we calculate next column and row elements in 2x2 packed cell.\n        bool hasNextCol = d < ").concat(l-1,";\n        bool hasNextRow = coords.z < ").concat(r-1,";\n\n        vec4 newValue = vec4(\n          getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d),\n          hasNextCol ? getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d + 1) : 0.0);\n\n        setOutput(newValue);\n      }\n    ")}));var AF={kernelName:ii.ResizeNearestNeighbor,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.images,i=r.alignCorners,o=r.halfPixelCenters,u=r.size,s=(0,C.Z)(u,2),c=s[0],l=s[1],f=(0,ii.env)().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new CF(a.shape,c,l,i,o):new SF(a.shape,c,l,i,o);return n.runWebGLProgram(f,[a],a.dtype)}},EF=(0,F.Z)((function e(t,n,r){(0,D.Z)(this,e),this.variableNames=["dy"],this.outputShape=[],this.outputShape=n;var a=(0,C.Z)(n,3),i=a[1],o=a[2],u=(0,C.Z)(t,3),s=u[1],c=u[2],l=[r&&s>1?i-1:i,r&&c>1?o-1:o],f=[r&&s>1?s-1:s,r&&c>1?c-1:c],d=l[0]/f[0],h=l[1]/f[1],p=1/d,v=1/h,m=2*Math.ceil(p)+2,g=2*Math.ceil(v)+2;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        int r = coords[1];\n        int c = coords[2];\n\n        float accumulator = 0.0;\n\n        const float heightScale = float(".concat(d,");\n        const float widthScale = float(").concat(h,");\n\n        const float invHeightScale = float(").concat(p,");\n        const float invWidthScale = float(").concat(v,");\n\n        const int winHeight = int(").concat(m,");\n        const int winWidth = int(").concat(g,");\n\n        // Compute bounds for where in dy we will look\n        float startRLerp = floor(float(r) * invHeightScale);\n        int startDyR = int(floor(startRLerp - float(winHeight / 2)));\n\n        float startCLerp = floor(float(c) * invWidthScale);\n        int startDyC = int(floor(startCLerp - float(winWidth / 2)));\n\n        // Loop over dy\n        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {\n          int dyR = dyROffset + startDyR;\n\n          // Guard against the window exceeding the bounds of dy\n          if (dyR < 0 || dyR >= ").concat(s,") {\n            continue;\n          }\n\n          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {\n            int dyC = dyCOffset + startDyC;\n\n            // Guard against the window exceeding the bounds of dy\n            if (dyC < 0 || dyC >= ").concat(c,") {\n              continue;\n            }\n\n            float sourceFracRow =\n              float(").concat(l[0],") *\n                (float(dyR) / float(").concat(f[0],"));\n\n            float sourceFracCol =\n                float(").concat(l[1],") *\n                  (float(dyC) / float(").concat(f[1],"));\n\n            int sourceNearestRow = int(min(\n                float(int(").concat(i,") - 1),\n                ").concat(r," ? float(round(sourceFracRow)) :\n                                  float(floor(sourceFracRow))));\n\n            int sourceNearestCol = int(min(\n                float(int(").concat(o,") - 1),\n                ").concat(r," ? float(round(sourceFracCol)) :\n                                  float(floor(sourceFracCol))));\n\n            if (r == sourceNearestRow && c == sourceNearestCol) {\n              accumulator += getDy(b, dyR, dyC, d);\n            }\n          }\n        }\n        // End loop over dy\n\n        setOutput(accumulator);\n      }\n    ")}));var NF={kernelName:ii.ResizeNearestNeighborGrad,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.images,i=t.dy,o=r.alignCorners,u=new EF(i.shape,a.shape,o);return n.runWebGLProgram(u,[i],i.dtype)}},TF=(0,F.Z)((function e(t,n){(0,D.Z)(this,e),this.variableNames=["x"];var r=t.length;if(r>4)throw new Error("WebGL backend: Reverse of rank-".concat(r," tensor is not yet supported"));if(this.outputShape=t,1!==r){var a=t.map((function(e,r){return function(e){return-1!==n.indexOf(e)&&1!==t[e]?"".concat(t[e]," - coords[").concat(e,"] - 1"):"coords[".concat(e,"]")}(r)})).join(","),i=iC(r);this.userCode="\n      void main() {\n        ".concat(i," coords = getOutputCoords();\n        setOutput(getX(").concat(a,"));\n      }\n    ")}else this.userCode="\n        void main() {\n          int coord = getOutputCoords();\n          setOutput(getX(".concat(t[0]," - coord - 1));\n        }\n      ")})),IF=(0,F.Z)((function e(t,n){(0,D.Z)(this,e),this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;var r=t.length;if(r>4)throw new Error("WebGL backend: Reverse of rank-".concat(r," tensor is not yet supported"));this.outputShape=t;var a=TA("rc",r),i="".concat(a[r-1]," + 1 < ").concat(this.outputShape[r-1]),o="".concat(a[r-2]," + 1 < ").concat(this.outputShape[r-2]),u=iC(r);function s(e){var r=t.map((function(r,a){return function(e,r){return-1!==n.indexOf(e)&&1!==t[e]?"".concat(t[e]," - ").concat(r[e]," - 1"):"".concat(r[e])}(a,e)})),a=r.join(","),i=r.slice(-2).join(",");return"getChannel(getX(".concat(a,"), vec2(").concat(i,"))")}this.userCode=1===r?"\n        void main(){\n          int rc = getOutputCoords();\n          vec4 result = vec4(0.);\n          result.r = getChannel(getX(".concat(t[0]," - rc - 1),\n            ").concat(t[0]," - rc - 1);\n          if(").concat(i,"){\n              result.g = getChannel(getX(").concat(t[0]," - (rc  + 1) - 1),\n                ").concat(t[0]," - (rc  + 1) - 1);\n          }\n          setOutput(result);\n        }\n      "):"\n        void main() {\n          ".concat(u," rc = getOutputCoords();\n          vec4 result = vec4(0.);\n          result.r = ").concat(function(e){return s(e)}(a.slice()),";\n          if(").concat(i,"){\n            result.g = ").concat(function(e){return e[r-1]="("+e[r-1]+" + 1)",s(e)}(a.slice()),";\n          }\n          if(").concat(o,") {\n            result.b = ").concat(function(e){return e[r-2]="("+e[r-2]+" + 1)",s(e)}(a.slice()),";\n            if(").concat(i,") {\n              result.a = ").concat(function(e){return e[r-1]="("+e[r-1]+" + 1)",e[r-2]="("+e[r-2]+" + 1)",s(e)}(a.slice()),";\n            }\n          }\n          setOutput(result);\n        }\n    ")}));var DF={kernelName:ii.Reverse,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.dims,o=a.shape.length,u=ii.util.parseAxisParam(i,a.shape);if(0===o)return iE({inputs:{x:a},backend:n});var s=(0,ii.env)().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new IF(a.shape,u):new TF(a.shape,u);return n.runWebGLProgram(s,[a],a.dtype)}},FF=(0,F.Z)((function e(t,n){(0,D.Z)(this,e),this.variableNames=["Image"],this.outputShape=[],this.customUniforms=[{name:"params",type:"vec4"}];var r=t[1],a=t[2];this.outputShape=t;var i="";i="number"===typeof n?"float outputValue = ".concat(n.toFixed(2),";"):"\n        vec3 fill = vec3(".concat(n.join(","),");\n        float outputValue = fill[coords[3]];"),this.userCode="\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int x = coords[2];\n          int y = coords[1];\n          float coordXFloat = (float(x) - params[0]) * params[3] -\n            (float(y) - params[1]) * params[2];\n          float coordYFloat = (float(x) - params[0]) * params[2] +\n            (float(y) - params[1]) * params[3];\n          int coordX = int(round(coordXFloat + params[0]));\n          int coordY = int(round(coordYFloat + params[1]));\n          ".concat(i,"\n          if(coordX >= 0 && coordX < ").concat(a," && coordY >= 0 && coordY < ").concat(r,") {\n            outputValue = getImage(coords[0], coordY, coordX, coords[3]);\n          }\n          setOutput(outputValue);\n        }\n    ")})),MF={kernelName:ii.RotateWithOffset,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.attrs,r=e.backend,a=t.image,i=n.radians,o=n.fillValue,u=n.center,s=r,c=new FF(a.shape,o),l=ii.backend_util.getImageCenter(u,a.shape[1],a.shape[2]),f=(0,C.Z)(l,2),d=[[f[0],f[1],Math.sin(i),Math.cos(i)]];return s.runWebGLProgram(c,[a],a.dtype,d)}},OF=vE({opSnippet:"\n  // OpenGL ES does not support round function.\n  // The algorithm is based on banker's rounding.\n  float base = floor(x);\n  if ((x - base) < 0.5) {\n    return floor(x);\n  } else if ((x - base) > 0.5) {\n    return ceil(x);\n  } else {\n    if (mod(base, 2.0) == 0.0) {\n      return base;\n    } else {\n      return base + 1.0;\n    }\n  }\n"}),RF={kernelName:ii.Round,backendName:"webgl",kernelFunc:OF},jF=vE({opSnippet:"return inversesqrt(x);",cpuKernelImpl:cA}),BF={kernelName:ii.Rsqrt,backendName:"webgl",kernelFunc:jF},zF=(0,F.Z)((function e(t,n,r,a,i,o){var u=arguments.length>7&&void 0!==arguments[7]&&arguments[7];(0,D.Z)(this,e),this.variableNames=["updates","indices","defaultValue"],this.outputShape=o;var s=iC(i.length),c=iC(o.length),l="";1===r?l="i":2===r&&(l="i, j");var f="getIndices(".concat(l,")"),d="";1===a?d="i":2===a&&(d="i, coords[1]");var h="getUpdates(".concat(d,")"),p="";u&&(p="coords[0], coords[1]");var v="getDefaultValue(".concat(p,")"),m=n>1?"strides[j]":"strides";this.userCode="\n        ".concat(s," strides = ").concat(s,"(").concat(i,");\n\n        void main() {\n          ").concat(c," coords = getOutputCoords();\n          float sum = 0.0;\n          bool found = false;\n          for (int i = 0; i < ").concat(t,"; i++) {\n            int flattenedIndex = 0;\n            for (int j = 0; j < ").concat(n,"; j++) {\n              int index = round(").concat(f,");\n              flattenedIndex += index * ").concat(m,";\n            }\n            if (flattenedIndex == coords[0]) {\n              sum += ").concat(h,";\n              found = true;\n            }\n          }\n          setOutput(mix(").concat(v,", sum, float(found)));\n        }\n      ")})),ZF=(0,F.Z)((function e(t,n,r,a,i,o){var u=arguments.length>7&&void 0!==arguments[7]&&arguments[7];(0,D.Z)(this,e),this.variableNames=["updates","indices","defaultValue"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=o;var s=iC(i.length),c=iC(o.length),l="";1===r?l="i":2===r&&(l="i, j");var f="getIndices(".concat(l,")"),d="";1===a?d="i":2===a&&(d="i, coords[1]");var h="getUpdates(".concat(d,")"),p="";u&&(p="coords[0], coords[1]");var v="getDefaultValue(".concat(p,")"),m=n>1?"strides[j]":"strides",g=n>1?"strides[j + 1]":"strides";this.userCode="\n        ".concat(s," strides = ").concat(s,"(").concat(i,");\n\n        void main() {\n          ").concat(c," coords = getOutputCoords();\n          vec4 sum = vec4(0.);\n          vec4 found = vec4(0.);\n          for (int i = 0; i < ").concat(t,"; i+=2) {\n            ivec2 flattenedIndex = ivec2(0);\n            for (int j = 0; j < ").concat(n,"; j+=2) {\n              ivec4 index = round(").concat(f,");\n              flattenedIndex += index.xz * ").concat(m,";\n              if (j + 1 < ").concat(n,") {\n                flattenedIndex += index.yw * ").concat(g,";\n              }\n            }\n            if (flattenedIndex[0] == coords[0] || flattenedIndex[1] == coords[0] ||\n                flattenedIndex[0] == coords[0] + 1 || flattenedIndex[1] == coords[0] + 1) {\n              vec4 updVals = ").concat(h,";\n              if (flattenedIndex[0] == coords[0]) {\n                sum.xy += updVals.xy;\n                found.xy = vec2(1.);\n              } else if (flattenedIndex[0] == coords[0] + 1) {\n                sum.zw += updVals.xy;\n                found.zw = vec2(1.);\n              }\n              if (flattenedIndex[1] == coords[0]) {\n                sum.xy += updVals.zw;\n                found.xy = vec2(1.);\n              } else if (flattenedIndex[1] == coords[0] + 1) {\n                sum.zw += updVals.zw;\n                found.zw = vec2(1.);\n              }\n            }\n          }\n          setOutput(mix(").concat(v,", sum, found));\n        }\n      ")}));var LF={kernelName:ii.ScatterNd,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.indices,i=t.updates,o=r.shape,u=ii.backend_util.calculateShapes(i,a,o),s=u.sliceRank,c=u.numUpdates,l=u.sliceSize,f=u.strides,d=u.outputSize,h=[d/l,l];if(0===d)return n.makeTensorInfo(o,a.dtype);var p,v=CE({inputs:{x:a},backend:n,attrs:{shape:[c,s]}}),m=CE({inputs:{x:i},backend:n,attrs:{shape:[c,l]}}),g=n.makeTensorInfo([],"float32",new Float32Array([0]));p=(0,ii.env)().getBool("WEBGL_PACK")?new ZF(c,s,v.shape.length,m.shape.length,f,h):new zF(c,s,v.shape.length,m.shape.length,f,h);var y=n.runWebGLProgram(p,[m,v,g],m.dtype),b=CE({inputs:{x:y},backend:n,attrs:{shape:o}});return n.disposeIntermediateTensorInfo(v),n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(y),n.disposeIntermediateTensorInfo(g),b}},PF=(0,F.Z)((function e(t,n,r,a){(0,D.Z)(this,e),this.variableNames=["sortedSequence","values"],this.customUniforms=[{name:"numInputs",type:"int"}],this.outputShape=[t,r];var i="for (int i = 0; i < ".concat(Math.ceil(Math.log2(n+1)),"; ++i) { if (left >= right) break;"),o=2===(0,ii.env)().getNumber("WEBGL_VERSION")?"while (left < right) {":i,u="left"===a?"<":"<=";this.userCode="\n       int findBound(int batch, float value) {\n         int left = 0;\n         int right = numInputs;\n         int mid;\n         ".concat(o,"\n           mid = (left + right) / 2;\n           if (getSortedSequence(batch, mid) ").concat(u," value) {\n             left = mid + 1;\n           } else {\n             right = mid;\n           }\n         }\n         return right;\n       }\n\n       void main() {\n         ivec2 coords = getOutputCoords();\n         int batch = coords[0];\n         int valueIndex = coords[1];\n\n         float value = getValues(batch, valueIndex);\n\n         setOutput(float(findBound(batch, value)));\n       }\n     ")}));var UF={kernelName:ii.SearchSorted,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.sortedSequence,i=t.values,o=r.side,u=new PF(a.shape[0],a.shape[1],i.shape[1],o),s=[[a.shape[1]]];return n.runWebGLProgram(u,[a,i],"int32",s)}},WF=(0,F.Z)((function e(t,n,r){var a,i;if((0,D.Z)(this,e),this.variableNames=["c","a","b"],this.outputShape=n,r>4)throw Error("Where for rank ".concat(r," is not yet supported"));if(1===r)i="resRC",a="resRC";else{for(var o=["resRC.x","resRC.y","resRC.z","resRC.w"],u=[],s=[],c=0;c<n.length;c++)s.push("".concat(o[c])),c<t&&u.push("".concat(o[c]));a=u.join(),i=s.join()}var l=iC(r);this.userCode="\n      void main() {\n        ".concat(l," resRC = getOutputCoords();\n        float cVal = getC(").concat(a,");\n        if (cVal >= 1.0) {\n          setOutput(getA(").concat(i,"));\n        } else {\n          setOutput(getB(").concat(i,"));\n        }\n      }\n    ")}));var VF={kernelName:ii.Select,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.condition,a=t.t,i=t.e,o=new WF(r.shape.length,a.shape,a.shape.length);return n.runWebGLProgram(o,[r,a,i],(0,ii.upcastType)(a.dtype,i.dtype))}},qF=vE({opSnippet:"\n  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.\n  // see: https://arxiv.org/abs/1706.02515\n  float scaleAlpha = ".concat(ii.backend_util.SELU_SCALEALPHA,";\n  float scale = ").concat(ii.backend_util.SELU_SCALE,";\n  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);\n")}),GF={kernelName:ii.Selu,backendName:"webgl",kernelFunc:qF},HF=vE({opSnippet:"if (isnan(x)) return x;\n  return 1.0 / (1.0 + exp(-1.0 * x));\n",packedOpSnippet:"\n  vec4 result = 1.0 / (1.0 + exp(-1.0 * x));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",cpuKernelImpl:fA}),XF={kernelName:ii.Sigmoid,backendName:"webgl",kernelFunc:HF},KF=vE({opSnippet:"\n  if (isnan(x)) { return 0.0; }\n  return sign(x);\n"}),YF={kernelName:ii.Sign,backendName:"webgl",kernelFunc:KF},$F=vE({opSnippet:"if (isnan(x)) return x;\n  return sin(x);\n",packedOpSnippet:"\n  vec4 result = sin(x);\n  bvec4 isNaN = isnan(x);\n  ".concat(rE,"\n  return result;\n")}),QF={kernelName:ii.Sin,backendName:"webgl",kernelFunc:$F},JF=vE({opSnippet:"\n  float e2x = exp(x);\n  return (e2x - 1.0 / e2x) / 2.0;\n"}),eM={kernelName:ii.Sinh,backendName:"webgl",kernelFunc:JF},tM=vE({opSnippet:"\n  float epsilon = 1.1920928955078125e-7;\n  float threshold = log(epsilon) + 2.0;\n\n  bool too_large = x > -threshold;\n  bool too_small = x < threshold;\n\n  float result;\n  float exp_x = exp(x);\n\n  if (too_large){\n    result = x;\n  }\n  else if (too_small){\n    result = exp_x;\n  }\n  else{\n    result = log(exp_x + 1.0);\n  }\n  return result;\n"}),nM={kernelName:ii.Softplus,backendName:"webgl",kernelFunc:tM},rM={kernelName:ii.SpaceToBatchND,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.blockShape,o=r.paddings;ii.util.assert(a.shape.length<=4,(function(){return"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet"}));var u=i.reduce((function(e,t){return e*t})),s=[[0,0]];s.push.apply(s,(0,I.Z)(o));for(var c=1+i.length;c<a.shape.length;++c)s.push([0,0]);var l=[],f=rF({inputs:{x:a},backend:n,attrs:{paddings:s,constantValue:0}}),d=ii.backend_util.getReshaped(f.shape,i,u,!1),h=ii.backend_util.getPermuted(d.length,i.length,!1),p=ii.backend_util.getReshapedPermuted(f.shape,i,u,!1),v=CE({inputs:{x:f},backend:n,attrs:{shape:d}}),m=RE({inputs:{x:v},backend:n,attrs:{perm:h}}),g=CE({inputs:{x:m},backend:n,attrs:{shape:p}});return l.push(f),l.push(v),l.push(m),l.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),g}};var aM={kernelName:ii.SparseFillEmptyRows,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.indices,a=t.values,i=t.denseShape,o=t.defaultValue;if(1!==i.shape.length)throw new Error("Dense shape must be a vector, saw:\n         ".concat(i.shape));if(2!==r.shape.length)throw new Error("Indices must be a matrix, saw:\n         ".concat(r.shape));if(1!==a.shape.length)throw new Error("Values must be a vector, saw:\n         ".concat(a.shape));if(0!==o.shape.length)throw new Error("Default value must be a scalar, saw:\n        ".concat(o.shape));var u=n.readSync(r.dataId),s=n.readSync(a.dataId),c=n.readSync(i.dataId),l=n.readSync(o.dataId)[0],f=pA(u,r.shape,r.dtype,s,a.dtype,c,l),d=(0,C.Z)(f,5),h=d[0],p=d[1],v=d[2],m=d[3],g=d[4];return[n.makeTensorInfo(p,r.dtype,h),n.makeTensorInfo([p[0]],a.dtype,v),n.makeTensorInfo([m.length],"bool",new Uint8Array(m.map((function(e){return Number(e)})))),n.makeTensorInfo([g.length],r.dtype,new Int32Array(g))]}};var iM={kernelName:ii.SparseReshape,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.inputIndices,a=t.inputShape,i=t.newShape;if(2!==r.shape.length)throw new Error("Input indices should be a matrix but received shape ".concat(r.shape));if(1!==a.shape.length)throw new Error("Input shape should be a vector but received shape ".concat(a.shape));if(1!==i.shape.length)throw new Error("Target shape should be a vector but received shape ".concat(i.shape));var o=Array.from(n.readSync(a.dataId)),u=n.readSync(r.dataId),s=Array.from(n.readSync(i.dataId)),c=vA(u,r.shape,r.dtype,o,s),l=(0,C.Z)(c,3),f=l[0],d=l[1],h=l[2];return[n.makeTensorInfo(d,r.dtype,f),n.makeTensorInfo([h.length],i.dtype,new Int32Array(h))]}};var oM={kernelName:ii.SparseSegmentMean,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.data,a=t.indices,i=t.segmentIds;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==a.shape.length)throw new Error("Indices should be a vector but received shape\n              ".concat(a.shape));if(1!==i.shape.length)throw new Error("Segment ids should be a vector but received shape\n              ".concat(i.shape));var o=n.readSync(r.dataId),u=n.readSync(a.dataId),s=n.readSync(i.dataId),c=mA(o,r.shape,r.dtype,u,s,!0),l=(0,C.Z)(c,2),f=l[0],d=l[1];return n.makeTensorInfo(d,r.dtype,f)}};var uM={kernelName:ii.SparseSegmentSum,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.data,a=t.indices,i=t.segmentIds;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==a.shape.length)throw new Error("Indices should be a vector but received shape\n             ".concat(a.shape));if(1!==i.shape.length)throw new Error("Segment ids should be a vector but received shape\n             ".concat(i.shape));var o=n.readSync(r.dataId),u=n.readSync(a.dataId),s=n.readSync(i.dataId),c=mA(o,r.shape,r.dtype,u,s),l=(0,C.Z)(c,2),f=l[0],d=l[1];return n.makeTensorInfo(d,r.dtype,f)}};var sM={kernelName:ii.SparseToDense,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.sparseIndices,i=t.sparseValues,o=t.defaultValue,u=r.outputShape,s=ii.backend_util.calculateShapes(i,a,u),c=s.sliceRank,l=s.numUpdates,f=s.sliceSize,d=s.strides,h=s.outputSize;if("string"===i.dtype){var p=n.bufferSync(a),v=n.bufferSync(i),m=ii.util.decodeString(n.readSync(o.dataId)[0]),g=lA(p,v,u,h,f,l,c,d,m,false);return n.makeTensorInfo(u,g.dtype,g.values)}var y=new zF(l,c,a.shape.length,i.shape.length,d,[h,1],false),b=n.runWebGLProgram(y,[i,a,o],i.dtype),x=CE({inputs:{x:b},backend:n,attrs:{shape:u}});return n.disposeIntermediateTensorInfo(b),x}};var cM={kernelName:ii.SplitV,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.numOrSizeSplits,o=r.axis,u=ii.util.parseAxisParam(o,a.shape)[0],s=ii.backend_util.prepareSplitSize(a,i,u),c=a.shape.length,l=new Array(c).fill(0),f=a.shape.slice();return s.map((function(e){var t=(0,I.Z)(f);t[u]=e;var r=DN({inputs:{x:a},backend:n,attrs:{begin:l,size:t}});return l[u]+=e,r}))}},lM="return sqrt(x);",fM=vE({opSnippet:lM,packedOpSnippet:lM,cpuKernelImpl:gA}),dM={kernelName:ii.Sqrt,backendName:"webgl",kernelFunc:fM},hM=vE({opSnippet:"return x * x;"}),pM={kernelName:ii.Square,backendName:"webgl",kernelFunc:hM},vM="return (a - b) * (a - b);",mM=mE({opSnippet:vM,packedOpSnippet:vM}),gM={kernelName:ii.SquaredDifference,backendName:"webgl",kernelFunc:mM};var yM={kernelName:ii.StaticRegexReplace,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x;if("string"!==a.dtype)throw new Error("Input must be of datatype string");var i=n.readSync(a.dataId),o=ii.backend_util.fromUint8ToStringArray(i),u=yA(o,"string",r);return n.makeTensorInfo(a.shape,"string",u)}};var bM={kernelName:ii.Step,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.attrs,r=e.backend,a=t.x,i=BA+"\n    return x > 0.0 ? 1.0 : float(".concat(n.alpha,");\n  "),o=new jA(a.shape,i);return r.runWebGLProgram(o,[a],a.dtype)}},xM=(0,F.Z)((function e(t,n,r){(0,D.Z)(this,e),this.variableNames=["x"],this.outputShape=r;var a=r.length,i=iC(r.length),o=iC(r.length),u="";if(1===a)u="coords * strides + begin";else{var s=0;u=r.map((function(e,t){return s++,1===r.length?"coords * strides[".concat(t,"] + begin[").concat(t,"]"):"coords[".concat(s-1,"] * strides[").concat(t,"] + begin[").concat(t,"]")})).join(",")}this.userCode="\n      ".concat(i," begin = ").concat(i,"(").concat(t,");\n      ").concat(i," strides = ").concat(i,"(").concat(n,");\n\n      void main() {\n        ").concat(o," coords = getOutputCoords();\n        setOutput(getX(").concat(u,"));\n      }\n    ")}));var wM={kernelName:ii.StridedSlice,backendName:"webgl",kernelFunc:function(e){var t,n=e.inputs,r=e.backend,a=e.attrs,i=n.x,o=a.begin,u=a.end,s=a.strides,c=a.beginMask,l=a.endMask,f=a.ellipsisMask,d=a.newAxisMask,h=a.shrinkAxisMask,p=ii.slice_util.sliceInfo(i.shape,o,u,s,c,l,f,d,h),v=p.finalShapeSparse,m=p.finalShape,g=p.isIdentity,y=p.sliceDim0,b=p.isSimpleSlice,x=p.begin,w=p.end,k=p.strides;if(g)t=CE({inputs:{x:i},backend:r,attrs:{shape:m}});else if(y||b){ii.util.assert(i.shape.length>=1,(function(){return"Input must have rank at least 1, got: ".concat(i.shape.length)}));var _=ii.slice_util.computeOutShape(x,w,k),S=DN({inputs:{x:i},backend:r,attrs:{begin:x,size:_}});t=CE({inputs:{x:S},backend:r,attrs:{shape:m}}),r.disposeIntermediateTensorInfo(S)}else{if(r.shouldExecuteOnCPU([i])){var C=r.readSync(i.dataId),A=(0,ii.buffer)(i.shape,i.dtype,C),E=bA(v,A,k,x);t=r.makeTensorInfo(m,i.dtype,E.values)}else{var N=new xM(x,k,v);t=r.runWebGLProgram(N,[i],i.dtype)}}var T=CE({inputs:{x:t},backend:r,attrs:{shape:m}});return r.disposeIntermediateTensorInfo(t),T}};var kM={kernelName:ii.StringNGrams,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=r.separator,i=r.nGramWidths,o=r.leftPad,u=r.rightPad,s=r.padWidth,c=r.preserveShortSequences,l=t.data,f=t.dataSplits,d=n.readSync(l.dataId),h=n.readSync(f.dataId),p=xA(d,h,a,i,o,u,s,c),v=(0,C.Z)(p,2),m=v[0],g=v[1];return[n.makeTensorInfo([m.length],"string",m),n.makeTensorInfo(f.shape,"int32",g)]}};var _M={kernelName:ii.StringSplit,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs.skipEmpty,a=t.input,i=t.delimiter;if("string"!==a.dtype)throw new Error("Input must be of datatype string");if(1!==a.shape.length)throw new Error("Input must be a vector, got shape: ".concat(a.shape));if(0!==i.shape.length)throw new Error("Delimiter must be a scalar, got shape: ".concat(i.shape));var o=n.readSync(a.dataId),u=n.readSync(i.dataId)[0],s=wA(o,u,r),c=(0,C.Z)(s,3),l=c[0],f=c[1],d=c[2],h=f.length;return[n.makeTensorInfo([h,2],"int32",l),n.makeTensorInfo([h],"string",f),n.makeTensorInfo([2],"int32",new Int32Array(d))]}};var SM={kernelName:ii.StringToHashBucketFast,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs.numBuckets,a=t.input;if("string"!==a.dtype)throw new Error("Input must be of datatype string");if(r<=0)throw new Error("Number of buckets must be at least 1");var i=n.readSync(a.dataId),o=kA(i,r);return n.makeTensorInfo(a.shape,"int32",o)}},CM=vE({opSnippet:"return tan(x);"}),AM={kernelName:ii.Tan,backendName:"webgl",kernelFunc:CM},EM=vE({opSnippet:"\n  float e2x = exp(-2.0 * abs(x));\n  return sign(x) * (1.0 - e2x) / (1.0 + e2x);\n"}),NM={kernelName:ii.Tanh,backendName:"webgl",kernelFunc:EM};var TM={kernelName:ii.TensorScatterUpdate,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.tensor,i=t.indices,o=t.updates;!function(e){if(null==e)throw new TypeError("Cannot destructure "+e)}(r);var u=ii.backend_util.calculateShapes(o,i,a.shape),s=u.sliceRank,c=u.numUpdates,l=u.sliceSize,f=u.strides,d=u.outputSize,h=[d/l,l];if(0===d)return n.makeTensorInfo(a.shape,i.dtype);var p=CE({inputs:{x:i},backend:n,attrs:{shape:[c,s]}}),v=CE({inputs:{x:o},backend:n,attrs:{shape:[c,l]}}),m=CE({inputs:{x:a},backend:n,attrs:{shape:h}}),g=new zF(c,s,p.shape.length,v.shape.length,f,h,!1,!0),y=n.runWebGLProgram(g,[v,p,m],m.dtype),b=CE({inputs:{x:y},backend:n,attrs:{shape:a.shape}});return n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(v),n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(y),b}},IM=(0,F.Z)((function e(t,n){(0,D.Z)(this,e),this.variableNames=["A"];for(var r=new Array(t.length),a=0;a<r.length;a++)r[a]=t[a]*n[a];this.outputShape=r,this.rank=r.length;var i=iC(this.rank),o=function(e){var t=e.length;if(t>5)throw Error("Tile for rank ".concat(t," is not yet supported"));if(1===t)return"imod(resRC, ".concat(e[0],")");for(var n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],r=[],a=0;a<e.length;a++)r.push("imod(".concat(n[a],", ").concat(e[a],")"));return r.join()}(t);this.userCode="\n      void main() {\n        ".concat(i," resRC = getOutputCoords();\n        setOutput(getA(").concat(o,"));\n      }\n    ")}));function DM(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.reps;if("string"===a.dtype||a.shape.length>5){var o=n.readSync(a.dataId),u="string"===a.dtype?o.map((function(e){return ii.util.decodeString(e)})):o,s=(0,ii.buffer)(a.shape,a.dtype,u),c=SA(s,i);return n.makeTensorInfo(c.shape,c.dtype,c.values)}var l=new IM(a.shape,i);return n.runWebGLProgram(l,[a],a.dtype)}var FM={kernelName:ii.Tile,backendName:"webgl",kernelFunc:DM},MM=(0,F.Z)((function e(t){(0,D.Z)(this,e),this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"negativeInf",type:"float"},{name:"dir",type:"int"},{name:"inc",type:"int"}],this.outputShape=t,this.userCode="\n       void main() {\n         ivec2 coords = getOutputCoords();\n         int batch = coords[0];\n         int elemIdx = coords[1];\n\n         // We compare elements pair-wise within a group of size 2 * inc.\n         // The comparing rule for each group alternates between ascending\n         // and descending. Within each group, we compare each pair at\n         // positions i and i+inc. To decide whether an element at position i\n         // is x0 or x1, we mod it by 2 * inc, if the result is smaller than\n         // inc, it is in the first half of the group, we denote it as x0,\n         // otherwise we denote it as x1.\n         // For example, as shown in the Bitonic top K paper referenced above,\n         // Figure5(a) shows that element[1] is in the\n         // second half of the group when group size is 2, but it is in the\n         // first half of the group when group size is 4.\n\n         bool isFirstInPair = imod(elemIdx, 2 * inc) < inc;\n         int i = isFirstInPair ? elemIdx : elemIdx - inc;\n\n         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));\n         int i1 = firstPass == 1 ? i + inc : int(getIndices(batch, i + inc));\n         float x0 = i0 < n ? getX(batch, i0) : negativeInf;\n         float x1 = i1 < n ? getX(batch, i1) : negativeInf;\n\n         // Denotes which direction indices are in (ascending or descending).\n         bool reverse = imod(elemIdx, 2 * dir) >= dir;\n         bool isGreater = x0 > x1 || (x0 == x1 && i1 > i0);\n         if (reverse == isGreater) { // Elements in opposite order of direction\n           int iTemp = i0;\n           i0 = i1;\n           i1 = iTemp;\n         }\n         if (isFirstInPair) {\n            setOutput(float(i0));\n         } else {\n            setOutput(float(i1));\n         }\n       }\n     "})),OM=(0,F.Z)((function e(t){(0,D.Z)(this,e),this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"k",type:"int"}],this.outputShape=t,this.userCode="\n    void main() {\n         // Takes max of indices (0, k), (1, k + 1), (2, k + 2) ...\n         ivec2 coords = getOutputCoords();\n         int batch = coords[0];\n         int elemIdx = coords[1];\n\n         // The output size is half of the previous size.\n         // If the previous sequence is | | | | _ _ _ _  | | | |  _ _ _ _ (k=4),\n         // we only need to output the indices at positions |, the indices at\n         // positions _ can be thrown away, see Figure5(b) After Phase 2\n         // (Merge phase) in the Bitonic Top K paper referenced above.\n         // For example, the paper shows we only need to output the orange bars.\n         // The output sequence should look like this | | | | | | | |.\n         // Because the sequence is halved, to map the output index back\n         // to the previous sequence to find the corresponding value,\n         // we need to double the index. When we double the index,\n         // we basically interpolate a position, so 2i looks like\n         // | _ | _ | _ | _ | _ | _ | _. We move the | to the first k position\n         // of each 2k positions by - elemIdx % k. E.g. for output at\n         // index 4,5,6,7, we want to get the corresponding element at\n         // original index 8,9,10,11, for output at index 8,9,10,11,\n         // we want to get the corresponding element at original index\n         // 16,17,18,19, so on and so forth.\n\n         int i = elemIdx < k ? elemIdx : (elemIdx * 2 - imod(elemIdx, k));\n         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));\n         int i1 = firstPass == 1 ? i + k : int(getIndices(batch, i + k));\n\n         float x0 = getX(batch, i0);\n         float x1 = i1 < n ? getX(batch, i1) : x0;\n\n         setOutput(x0 >= x1 ? float(i0) : float(i1));\n       }\n     "}));function RM(e,t){null!==t&&e.disposeIntermediateTensorInfo(t)}function jM(e){for(var t=1;t<e;)t*=2;return t}var BM={kernelName:ii.TopK,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.k,o=r.sorted,u=(0,ii.env)().getNumber("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD"),s=(0,ii.env)().getNumber("TOPK_K_CPU_HANDOFF_THRESHOLD"),c=a.shape,l=c[c.length-1];if(n.shouldExecuteOnCPU([a])||l<u||i>s){var f=n.readSync(a.dataId),d=CA(f,c,a.dtype,i,o),h=(0,C.Z)(d,2),p=h[0],v=h[1];return[n.makeTensorInfo(p.shape,p.dtype,p.values),n.makeTensorInfo(v.shape,v.dtype,v.values)]}if(0===i)return c[c.length-1]=0,[n.makeTensorInfo(c,a.dtype,[]),n.makeTensorInfo(c,"int32",[])];if(1===l)return[a,vI({attrs:{shape:c,dtype:"int32",value:0},backend:n})];var m=n.texData.get(a.dataId),g=null!==m&&m.isPacked,y=g?n.unpackTensor(a):a,b=ii.util.sizeFromShape(c)/l,x=CE({inputs:{x:y},attrs:{shape:[b,l]},backend:n});g&&RM(n,y);for(var w=jM(i),k=jM(l),_=null,S=function(){return null===_?[x,x]:[x,_]},A=function(e,t,r){var a=S(),i=new MM(r),o=[[l],[null===_?1:0],[Number.NEGATIVE_INFINITY],[e],[t]],u=_;_=n.runWebGLProgram(i,a,"int32",o),RM(n,u)},E=1;E<w;E*=2)for(var N=2*E,T=E;T>=1;T/=2)A(N,T,[b,k]);for(var I=k;I>w;I/=2){var D=S(),F=new OM([b,I/2]),M=[[l],[null===_?1:0],[w]],O=_;_=n.runWebGLProgram(F,D,"int32",M),RM(n,O);for(var R=w/2,j=2*R,B=R;B>=1;B/=2)A(j,B,_.shape)}var z=_;_=DN({inputs:{x:_},backend:n,attrs:{begin:0,size:[b,i]}}),RM(n,z);var Z=OI({inputs:{x:x,indices:_},backend:n,attrs:{axis:1,batchDims:1}});RM(n,x);var L=c.slice(0,-1);L.push(i),z=_,_=CE({inputs:{x:_},attrs:{shape:L},backend:n}),RM(n,z);var P=Z;return Z=CE({inputs:{x:Z},attrs:{shape:L},backend:n}),RM(n,P),[Z,_]}},zM=(0,F.Z)((function e(t,n,r,a,i,o){(0,D.Z)(this,e),this.variableNames=["Image","Transforms"],this.outputShape=o;var u,s="nearest"===r?1:2;switch(a){case"constant":default:u=1;break;case"reflect":u=2;break;case"wrap":u=3;break;case"nearest":u=4}this.userCode="\n            float mapCoord(float outCoord, float len) {\n              float inCoord = outCoord;\n              if(".concat(u," == 2) {\n                if (inCoord < 0.0) {\n                  if (len <= 1.0) {\n                    inCoord = 0.0;\n                  } else {\n                    float sz2 = 2.0 * len;\n                    if (inCoord < sz2) {\n                      inCoord = sz2 * float(int(float(-inCoord / sz2))) +\n                      inCoord;\n                    }\n                    inCoord = inCoord < -len ? inCoord + sz2 : -inCoord - 1.0;\n                  }\n                } else if (inCoord > len - 1.0) {\n                  if (len <= 1.0) {\n                    inCoord = 0.0;\n                  } else {\n                    float sz2 = 2.0 * len;\n                    inCoord -= sz2 * float(int(float(inCoord / sz2)));\n                    if (inCoord >= len) {\n                      inCoord = sz2 - inCoord - 1.0;\n                    }\n                  }\n                }\n                return clamp(inCoord, 0.0, len - 1.0);\n              } else if (").concat(u," == 3) {\n                if (inCoord < 0.0) {\n                  if (len <= 1.0) {\n                    inCoord = 0.0;\n                  } else {\n                    float sz = len - 1.0;\n                    inCoord += len * (float(int(float(-inCoord / sz))) + 1.0);\n                  }\n                } else if (inCoord > len - 1.0) {\n                  if (len <= 1.0) {\n                    inCoord = 0.0;\n                  } else {\n                    float sz = len - 1.0;\n                    inCoord -= len * float(int(float(inCoord / sz)));\n                  }\n                }\n                return clamp(inCoord, 0.0, len - 1.0);\n              } else if (").concat(u," == 4) {\n                return clamp(outCoord, 0.0, len - 1.0);\n              } else {\n                return outCoord;\n              }\n            }\n\n            float readWithFillValue(int batch, int coordY, int coordX,\n              int channel) {\n              float outputValue;\n              if (0 <= coordY && coordY < ").concat(t," && 0 <= coordX && coordX < ").concat(n,") {\n                  outputValue = getImage(batch, coordY, coordX, channel);\n              } else {\n                outputValue = float(").concat(i,");\n              }\n              return outputValue;\n            }\n\n            void main() {\n              ivec4 coords = getOutputCoords();\n              float outputValue;\n              int batch = coords[0];\n              int x = coords[2];\n              int y = coords[1];\n              int channel = coords[3];\n              float xf = float(x);\n              float yf = float(y);\n              float a1 = getTransforms(batch, 0);\n              float a2 = getTransforms(batch, 1);\n              float a3 = getTransforms(batch, 2);\n              float b1 = getTransforms(batch, 3);\n              float b2 = getTransforms(batch, 4);\n              float b3 = getTransforms(batch, 5);\n              float c1 = getTransforms(batch, 6);\n              float c2 = getTransforms(batch, 7);\n              float projection = c1 * xf + c2 * yf + 1.0;\n              if (projection == 0.0) {\n                outputValue = float(").concat(i,");\n              } else {\n                float inX = (a1 * xf + a2 * yf + a3) / projection;\n                float inY = (b1 * xf + b2 * yf + b3) / projection;\n                float mapX = mapCoord(inX, float(").concat(n,"));\n                float mapY = mapCoord(inY, float(").concat(t,"));\n\n                if (").concat(s," == 1) {\n                  int coordY = int(round(mapY));\n                  int coordX = int(round(mapX));\n                  outputValue = readWithFillValue(batch, coordY, coordX,\n                    channel);\n                } else {\n                  float yFloor = floor(mapY);\n                  float xFloor = floor(mapX);\n                  float yCeil = yFloor + 1.0;\n                  float xCeil = xFloor + 1.0;\n                  float valueYFloor = (xCeil - mapX) *\n                  readWithFillValue(batch, int(yFloor), int(xFloor), channel) +\n                  (mapX - xFloor) *\n                  readWithFillValue(batch, int(yFloor), int(xCeil), channel);\n                  float valueYCeil = (xCeil - mapX) *\n                  readWithFillValue(batch, int(yCeil), int(xFloor), channel) +\n                  (mapX - xFloor) *\n                  readWithFillValue(batch, int(yCeil), int(xCeil), channel);\n                  outputValue = (yCeil - mapY) * valueYFloor +\n                  (mapY - yFloor) * valueYCeil;\n                }\n              }\n              setOutput(outputValue);\n            }\n        ")}));var ZM={kernelName:ii.Transform,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.image,i=t.transforms,o=r.interpolation,u=r.fillMode,s=r.fillValue,c=r.outputShape,l=(0,C.Z)(a.shape,4),f=l[0],d=l[1],h=l[2],p=l[3],v=null!=c?c:[d,h],m=(0,C.Z)(v,2),g=m[0],y=m[1],b=new zM(d,h,o,u,s,[f,g,y,p]);return n.runWebGLProgram(b,[a,i],"float32")}};var LM={kernelName:ii.Unique,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.attrs,r=e.backend,a=n.axis,i=t.x;FS(i,"unique"),console.warn("WARNING: ","UI might be locked temporarily as data is being downloaded");var o=r.readSync(i.dataId),u=EA(o,a,i.shape,i.dtype),s=u.outputValues,c=u.outputShape,l=u.indices;return[r.makeTensorInfo(c,i.dtype,s),r.makeTensorInfo([l.length],"int32",l)]}};var PM={kernelName:ii.Unpack,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.value,i=r.axis;i<0&&(i+=a.shape.length);for(var o=a,u=o.shape.length,s=a.shape[i],c=new Array(u-1),l=0,f=0;f<u;f++)f!==i&&(c[l++]=o.shape[f]);var d=[],h=new Array(u).fill(0),p=o.shape.slice();p[i]=1;for(var v=new Array(s),m=0;m<v.length;m++){h[i]=m;var g=DN({inputs:{x:o},backend:n,attrs:{begin:h,size:p}}),y=CE({inputs:{x:g},backend:n,attrs:{shape:c}});v[m]=y,d.push(g)}return d.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),v}},UM=(0,F.Z)((function e(t,n){(0,D.Z)(this,e),this.variableNames=["x","segmentIds"];var r=t.windowSize,a=t.batchSize,i=t.inSize,o=t.numSegments,u=o*Math.ceil(i/r);this.outputShape=[a,u];var s=4*Math.floor(r/4),c=r%4,l="\n        sumValue += dot(values, segFilter);\n    ",f="";i%r>0&&(f="\n        if (inIdx < 0 || inIdx >= ".concat(i,") {\n          return initializationValue;\n        }\n      "));var d="";i%r>0&&(d="\n        if (inIdx < 0 || inIdx >= ".concat(i,") {\n          return -1.0;\n        }\n      ")),this.userCode="\n      const float initializationValue = ".concat("0.0",";\n\n      float getValue(int batch, int inIdx) {\n        ").concat(f,"\n        return getX(batch, inIdx);\n      }\n\n      float getSegmentIdAtIndex(int inIdx) {\n        ").concat(d,"\n        return getSegmentIds(inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = int(floor(float(outIdx) / float(\n          ").concat(o,")) * float(").concat(r,"));\n        int currentSeg = int(mod(float(outIdx), float(").concat(o,")));\n\n        float sumValue = 0.0;\n\n        for (int i = 0; i < ").concat(s,"; i += 4) {\n          int inIdx = inOffset + i;\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0\n          );\n\n          ").concat(l,"\n        }\n\n        int inIdx = inOffset + ").concat(s,";\n        if (").concat(1===c,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            initializationValue,\n            initializationValue,\n            initializationValue\n          );\n\n          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            0,\n            0,\n            0\n          );\n\n          ").concat(l,"\n        } else if (").concat(2===c,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            initializationValue,\n            initializationValue\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n              0,\n              0\n          );\n\n          ").concat(l,"\n        } else if (").concat(3===c,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            initializationValue\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,\n            0\n          );\n\n          ").concat(l,"\n        }\n        setOutput(").concat("sumValue",");\n      }\n    ")}));for(var WM={kernelName:ii.UnsortedSegmentSum,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.segmentIds,o=r.numSegments,u=a.shape.length,s=[],c=0,l=ii.backend_util.getAxesPermutation([c],u),f=a;null!=l&&(f=RE({inputs:{x:a},backend:n,attrs:{perm:l}}),s.push(f),c=ii.backend_util.getInnerMostAxes(1,u)[0]);var d=ii.backend_util.segment_util.computeOutShape(f.shape,c,o),h=ii.util.sizeFromShape([f.shape[c]]),p=CE({inputs:{x:f},backend:n,attrs:{shape:[-1,h]}});s.push(p);var v=function e(t,r,a,i,o){var u=t.shape[0],c=t.shape[1],l=ii.backend_util.segment_util.segOpComputeOptimalWindowSize(c,o),f=new UM({windowSize:l,inSize:c,batchSize:u,numSegments:o},r),d=n.compileAndRun(f,[t,a],i);if(s.push(d),d.shape[1]===o)return d;var h=fF({backend:n,attrs:{start:0,stop:o,step:1,dtype:"float32"}}),p=DM({inputs:{x:h},backend:n,attrs:{reps:[c/l]}});return s.push(h),s.push(p),e(d,r,p,i,o)}(p,"unsortedSegmentSum",i,(0,ii.sumOutType)(a.dtype),o),m=CE({inputs:{x:v},backend:n,attrs:{shape:d}}),g=m;if(null!=l){s.push(m);var y=ii.backend_util.getUndoAxesPermutation(l);g=RE({inputs:{x:g},backend:n,attrs:{perm:y}})}return s.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),g}},VM=0,qM=[zE,LE,UE,VE,HE,YE,$E,QE,aN,iN,uN,cN,fN,hN,vN,yN,bN,kN,_N,SN,EN,MN,ON,RN,jN,PN,VN,HN,sE,YN,aT,dT,gT,bT,xT,wT,_T,CT,ET,TT,OT,RT,jT,zT,PT,VT,qT,HT,KT,YT,QT,JT,tI,rI,iI,uI,lI,hI,gI,bI,kI,SI,EI,TI,II,FI,RI,BI,ZI,oE,LI,tT,UI,VI,GI,fE,XI,YI,$I,JI,tD,rD,iD,uD,lD,dD,pD,mD,gD,yD,wD,kD,_D,SD,CD,ED,ID,FD,PD,SE,UD,VD,GD,XD,zN,YD,JD,eF,aF,oF,pE,uF,sF,cF,lF,dF,LN,RD,pF,mF,yF,AE,wF,_F,AF,NF,DF,MF,RF,BF,LF,UF,VF,GF,XF,YF,QF,eM,FN,LD,nM,rM,aM,iM,oM,uM,sM,cM,dM,pM,gM,yM,bM,wM,kM,_M,SM,zD,OE,AM,NM,TM,FM,BM,ZM,jE,LM,PM,WM,QD];VM<qM.length;VM++){var GM=qM[VM];(0,ii.registerKernel)(GM)}ii.version_core;var HM=n(386),XM=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4],KM=12288,YM=500,$M=Math.floor(500),QM=YM-$M,JM=function(){function e(){(0,D.Z)(this,e),this.shuffledTrainIndex=0,this.shuffledTestIndex=0}return(0,F.Z)(e,[{key:"load",value:function(){var e=(0,Da.Z)(E().mark((function e(){var t,n,r,a,i=this;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=new Image,n=document.createElement("canvas"),r=n.getContext("2d",{willReadFrequently:!0}),a=new Promise((function(e,a){t.crossOrigin="",t.onload=function(){t.width=t.naturalWidth,t.height=t.naturalHeight;var a=new ArrayBuffer(24576e3);n.width=t.width,n.height=4;for(var o=0;o<125;o++){var u=new Float32Array(a,o*KM*4*4,49152);r.drawImage(t,0,4*o,t.width,4,0,0,t.width,4);for(var s=r.getImageData(0,0,n.width,n.height),c=0,l=0;l<s.data.length;l+=4)u[c]=s.data[l]/255,u[c+1]=s.data[l+1]/255,u[c+2]=s.data[l+2]/255,c+=3}i.datasetImages=new Float32Array(a),e()},t.src="data.png"})),a.then((function(){i.datasetLabels=new Uint8Array(XM),i.trainIndices=ii.util.createShuffledIndices($M),i.testIndices=ii.util.createShuffledIndices(QM),i.trainImages=i.datasetImages.slice(0,KM*$M),i.testImages=i.datasetImages.slice(KM*$M),i.trainLabels=i.datasetLabels.slice(0,$M),i.testLabels=i.datasetLabels.slice($M)}));case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"nextTrainBatch",value:function(e){var t=this;return this.nextBatch(e,[this.trainImages,this.trainLabels],(function(){return t.shuffledTrainIndex=(t.shuffledTrainIndex+1)%t.trainIndices.length,t.trainIndices[t.shuffledTrainIndex]}))}},{key:"nextTestBatch",value:function(e){var t=this;return this.nextBatch(e,[this.testImages,this.testLabels],(function(){return t.shuffledTestIndex=(t.shuffledTestIndex+1)%t.testIndices.length,t.testIndices[t.shuffledTestIndex]}))}},{key:"nextBatch",value:function(e,t,n){for(var r=new Float32Array(e*KM),a=new Uint8Array(e),i=0;i<e;i++){var o=n(),u=t[0].slice(o*KM,o*KM+KM);r.set(u,i*KM);var s=t[1].slice(o,o+1);a.set(s,i)}return{xs:ii.tensor2d(r,[e,KM]),labels:ii.tensor1d(a)}}}]),e}();function eO(){return tO.apply(this,arguments)}function tO(){return tO=(0,Da.Z)(E().mark((function e(){var t;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=new JM,e.next=3,t.load();case 3:return e.abrupt("return",t);case 4:case"end":return e.stop()}}),e)}))),tO.apply(this,arguments)}function nO(){return rO.apply(this,arguments)}function rO(){return(rO=(0,Da.Z)(E().mark((function e(){var t;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=xd(),64,64,3,t.add(Zp({inputShape:[64,64,3],kernelSize:5,filters:8,strides:1,activation:"relu",kernelInitializer:"varianceScaling"})),t.add(Wp({poolSize:[3,3],strides:[3,3]})),t.add(Zp({kernelSize:3,filters:16,strides:1,activation:"relu",kernelInitializer:"varianceScaling"})),t.add(Wp({poolSize:[3,3],strides:[3,3]})),t.add(Up()),t.add(Lp({units:5,kernelInitializer:"varianceScaling",activation:"softmax"})),e.abrupt("return",t);case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function aO(){return iO.apply(this,arguments)}function iO(){return(iO=(0,Da.Z)(E().mark((function e(){var t;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=xd(),64,64,3,t.add(Zp({inputShape:[64,64,3],kernelSize:5,filters:8,strides:1,activation:"relu",kernelInitializer:"varianceScaling"})),t.add(Wp({poolSize:[2,2],strides:[2,2]})),t.add(Zp({kernelSize:3,filters:16,strides:1,activation:"relu",kernelInitializer:"varianceScaling"})),t.add(Wp({poolSize:[2,2],strides:[2,2]})),t.add(Zp({kernelSize:3,filters:16,strides:1,activation:"relu",kernelInitializer:"varianceScaling"})),t.add(Wp({poolSize:[2,2],strides:[2,2]})),t.add(Up()),t.add(Lp({units:5,kernelInitializer:"varianceScaling",activation:"softmax"})),e.abrupt("return",t);case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function oO(){return uO.apply(this,arguments)}function uO(){return(uO=(0,Da.Z)(E().mark((function e(){var t;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=xd(),64,64,3,t.add(Zp({inputShape:[64,64,3],kernelSize:5,filters:6,strides:1,activation:"relu",kernelInitializer:"varianceScaling"})),t.add(Wp({poolSize:[2,2],strides:[2,2]})),t.add(Zp({kernelSize:5,filters:16,strides:1,activation:"relu",kernelInitializer:"varianceScaling"})),t.add(Wp({poolSize:[2,2],strides:[2,2]})),t.add(Up()),t.add(Lp({units:32,kernelInitializer:"varianceScaling",activation:"relu"})),t.add(Lp({units:8,kernelInitializer:"varianceScaling",activation:"relu"})),t.add(Lp({units:5,kernelInitializer:"varianceScaling",activation:"softmax"})),e.abrupt("return",t);case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function sO(){return cO.apply(this,arguments)}function cO(){return(cO=(0,Da.Z)(E().mark((function e(){var t;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=xd(),64,64,3,t.add(Zp({inputShape:[64,64,3],kernelSize:5,filters:6,strides:1,activation:"relu",kernelInitializer:"varianceScaling"})),t.add(Wp({poolSize:[2,2],strides:[2,2]})),t.add(Zp({kernelSize:3,filters:8,strides:1,activation:"relu",kernelInitializer:"varianceScaling"})),t.add(Wp({poolSize:[2,2],strides:[2,2]})),t.add(Zp({kernelSize:3,filters:12,strides:1,padding:"same",activation:"relu",kernelInitializer:"varianceScaling"})),t.add(Zp({kernelSize:3,filters:16,strides:1,padding:"same",activation:"relu",kernelInitializer:"varianceScaling"})),t.add(Zp({kernelSize:3,filters:20,strides:1,padding:"same",activation:"relu",kernelInitializer:"varianceScaling"})),t.add(Wp({poolSize:[2,2],strides:[2,2]})),t.add(Up()),t.add(Lp({units:32,kernelInitializer:"varianceScaling",activation:"relu"})),t.add(Pp({rate:.5})),t.add(Lp({units:5,kernelInitializer:"varianceScaling",activation:"softmax"})),e.abrupt("return",t);case 17:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function lO(e,t){return fO.apply(this,arguments)}function fO(){return fO=(0,Da.Z)(E().mark((function e(t,n){var r,a,i,o,u,s,c,l,f,d,h,p=arguments;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=p.length>2&&void 0!==p[2]?p[2]:32,a=p.length>3&&void 0!==p[3]?p[3]:15,i=p.length>4&&void 0!==p[4]?p[4]:.001,(o=document.getElementById("tfjs-visor-container"))&&o.remove(),u=ii.train.adam(i),n.compile({optimizer:u,loss:"categoricalCrossentropy",metrics:["accuracy"]}),s=500,c=ii.tidy((function(){var e=t.nextTrainBatch(s);return[e.xs.reshape([s,64,64,3]),e.labels]})),l=(0,C.Z)(c,2),f=l[0],d=l[1],h=ii.oneHot(d,5),HM.visor().isOpen()||HM.visor().open(),e.prev=11,e.next=14,n.fit(f,h,{shuffle:!0,batchSize:parseInt(r),epochs:parseInt(a),validationSplit:.2,callbacks:HM.show.fitCallbacks({name:"Loss and Accuracy Curves",tab:"Training"},["loss","acc","val_loss","val_acc"])});case 14:e.next=19;break;case 16:e.prev=16,e.t0=e.catch(11),console.log(e.t0);case 19:return HM.visor().setActiveTab("Training"),h.dispose(),e.abrupt("return",n);case 22:case"end":return e.stop()}}),e,null,[[11,16]])}))),fO.apply(this,arguments)}var dO=function(e){var t=e.setClassifier,n=e.setDataset,r=(0,k.useState)(void 0),a=(0,C.Z)(r,2),i=a[0],o=a[1],u=(0,k.useState)(32),s=(0,C.Z)(u,2),c=s[0],l=s[1],f=(0,k.useState)(10),d=(0,C.Z)(f,2),h=d[0],p=d[1],v=(0,k.useState)(.001),m=(0,C.Z)(v,2),g=m[0],y=m[1],b=(0,k.useState)("small"),x=(0,C.Z)(b,2),w=x[0],_=x[1];function S(){return S=(0,Da.Z)(E().mark((function e(){return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:eO().then((function(e){o(e),n(e),document.getElementById("train").disabled=!1,document.getElementById("select-model").disabled=!1,document.getElementById("select-lr").disabled=!1,document.getElementById("select-bz").disabled=!1,document.getElementById("select-epochs").disabled=!1,document.getElementById("loaddm").disabled=!0}));case 1:case"end":return e.stop()}}),e)}))),S.apply(this,arguments)}function A(){return(A=(0,Da.Z)(E().mark((function e(n){var r;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.preventDefault(),document.getElementById("train").disabled=!0,"small"!==w){e.next=8;break}return e.next=5,nO();case 5:r=e.sent,e.next=23;break;case 8:if("base"!==w){e.next=14;break}return e.next=11,aO();case 11:r=e.sent,e.next=23;break;case 14:if("lenet"!==w){e.next=20;break}return e.next=17,oO();case 17:r=e.sent,e.next=23;break;case 20:return e.next=22,sO();case 22:r=e.sent;case 23:return e.next=25,lO(i,r,c,h,g);case 25:r=e.sent,t(r),document.getElementById("train").disabled=!1;case 28:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return(0,k.useEffect)((function(){document.getElementById("train").disabled=!0,document.getElementById("select-model").disabled=!0,document.getElementById("select-lr").disabled=!0,document.getElementById("select-bz").disabled=!0,document.getElementById("select-epochs").disabled=!0}),[]),(0,rt.jsxs)("div",{style:{marginBottom:50},children:[(0,rt.jsx)("h2",{className:"display-6",children:"Training the Model"}),(0,rt.jsxs)("div",{className:"container-sm",style:{marginTop:50,maxWidth:800},children:[(0,rt.jsxs)("div",{style:{textAlign:"justify"},children:["Now that we have looked over the dataset and understood how different layers in the model work, let's finally train a classifier on it! We will be working with four different models: a 2 convolutional-layered network, a 3 convolutional-layered network, ",(0,rt.jsx)("a",{href:"http://vision.stanford.edu/cs598_spring07/papers/Lecun98.pdf",children:"LeNet"}),", and ",(0,rt.jsx)("a",{href:"https://proceedings.neurips.cc/paper_files/paper/2012/file/c399862d3b9d6b76c8436e924a68c45b-Paper.pdf",children:"AlexNet"}),"; and three ",(0,rt.jsx)("a",{href:"https://d2l.ai/chapter_hyperparameter-optimization/hyperopt-intro.html",children:"hyperparameters"}),", i.e., variables that we will try to find the best values for so that the classifier performs best on unseen images according to some metric: ",(0,rt.jsx)("span",{className:"emph",children:"learning rate"})," of the optimizer, ",(0,rt.jsx)("span",{className:"emph",children:"batch size"})," for inputs, and ",(0,rt.jsx)("span",{className:"emph",children:"number of epochs"})," (complete passes over the dataset while training). Since our dataset comprises of a total of 500 images, we will randomly choose 400 of them for training and the rest for validating classifier performance (which will be unseen during training and be an indicator of performance generalization).",(0,rt.jsx)("br",{}),(0,rt.jsx)("br",{})]}),(0,rt.jsx)("div",{children:(0,rt.jsxs)(pn,{style:{textAlign:"left"},children:[(0,rt.jsx)("button",{id:"loaddm",className:"random-img-gen",onClick:function(){return S.apply(this,arguments)},children:"Load Dataset"}),(0,rt.jsx)("br",{}),(0,rt.jsx)(ai,{src:w+".png",alt:"Model architecture",height:300}),(0,rt.jsx)("br",{}),(0,rt.jsx)("br",{}),(0,rt.jsx)("label",{style:{marginRight:15},children:"Model:"}),(0,rt.jsxs)("select",{id:"select-model","aria-label":"Model",value:w,onChange:function(e){return _(e.target.value)},children:[(0,rt.jsx)("option",{value:"small",children:"2 Convolutional Layered Model"}),(0,rt.jsx)("option",{value:"base",children:"3 Convolutional Layered Model"}),(0,rt.jsx)("option",{value:"lenet",children:"LeNet"}),(0,rt.jsx)("option",{value:"alexnet",children:"AlexNet"})]}),(0,rt.jsx)("br",{}),(0,rt.jsx)("label",{style:{marginRight:15,marginTop:5},children:"Learning Rate:"}),(0,rt.jsxs)("select",{id:"select-lr","aria-label":"Learning rate",value:g,onChange:function(e){return y(e.target.value)},children:[(0,rt.jsx)("option",{value:.01,children:"0.01"}),(0,rt.jsx)("option",{value:.001,children:"0.001"}),(0,rt.jsx)("option",{value:1e-4,children:"0.0001"}),(0,rt.jsx)("option",{value:1e-5,children:"0.00001"})]}),(0,rt.jsx)("br",{}),(0,rt.jsx)("label",{style:{marginRight:15,marginTop:5},children:"Batch Size:"}),(0,rt.jsxs)("select",{id:"select-bz","aria-label":"Batch Size",value:c,onChange:function(e){return l(e.target.value)},children:[(0,rt.jsx)("option",{value:32,children:"32"}),(0,rt.jsx)("option",{value:64,children:"64"}),(0,rt.jsx)("option",{value:128,children:"128"}),(0,rt.jsx)("option",{value:256,children:"256"})]}),(0,rt.jsx)("br",{}),(0,rt.jsx)("label",{style:{marginRight:15,marginTop:5},children:"Epochs:"}),(0,rt.jsxs)("select",{id:"select-epochs","aria-label":"Epochs",value:h,onChange:function(e){return p(e.target.value)},children:[(0,rt.jsx)("option",{value:3,children:"3"}),(0,rt.jsx)("option",{value:5,children:"5"}),(0,rt.jsx)("option",{value:10,children:"10"}),(0,rt.jsx)("option",{value:20,children:"20"}),(0,rt.jsx)("option",{value:30,children:"30"}),(0,rt.jsx)("option",{value:50,children:"50"})]}),(0,rt.jsx)("br",{})]})}),(0,rt.jsxs)("div",{style:{textAlign:"justify",marginTop:30},children:["Metrics that we will look at are:",(0,rt.jsxs)("div",{children:["[1] ",(0,rt.jsx)("span",{className:"emph",children:"Loss"}),': Measure of the "cost" associated with trying to bring classifier predictions closer to actual image labels. Loss values should go down while training!',(0,rt.jsx)("br",{}),"[2] ",(0,rt.jsx)("span",{className:"emph",children:"Accuracy"}),": Fraction of images the classifier gets correct. Accuracy should go up while training!",(0,rt.jsx)("br",{})]}),(0,rt.jsx)("br",{}),"When analyzing model performance, pay attention to how the validation set loss and accuracy curves behave. Do they behave similarly as the training set curves? Is there a prominent gap between the two? The closer the validation loss and accuracy curves are to their training set counterparts, the better the model performs\u2014it hasn't ",(0,rt.jsx)("a",{href:"https://docs.aws.amazon.com/machine-learning/latest/dg/model-fit-underfitting-vs-overfitting.html",children:"overfit"})," (started to memorize training data) or ",(0,rt.jsx)("a",{href:"https://docs.aws.amazon.com/machine-learning/latest/dg/model-fit-underfitting-vs-overfitting.html",children:"underfit"})," (too simple to learn training data features)!",(0,rt.jsx)("br",{}),(0,rt.jsx)("br",{}),(0,rt.jsxs)("span",{className:"emph",children:["To open or close the visualization pane, press ",(0,rt.jsx)("tt",{children:"~"})]}),'. It might take a moment before you see anything happen after clicking on the "Train" button.',(0,rt.jsx)("br",{}),(0,rt.jsx)(Oa,{id:"train",onClick:function(e){return A.apply(this,arguments)},style:{marginTop:20},children:"Train Classifier!"})]})]})]})},hO=n(4525),pO=function(){return pO=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},pO.apply(this,arguments)};function vO(e,t,n,r){return new(n||(n=Promise))((function(a,i){function o(e){try{s(r.next(e))}catch(e){i(e)}}function u(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,u)}s((r=r.apply(e,t||[])).next())}))}function mO(e,t){var n,r,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(a=2&i[0]?r.return:i[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,i[1])).done)return a;switch(r=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,r=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!((a=(a=o.trys).length>0&&a[a.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){o.label=i[1];break}if(6===i[0]&&o.label<a[1]){o.label=a[1],a=i;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(i);break}a[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],r=0}finally{n=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}}var gO=["rightEye","leftEye","noseTip","mouthCenter","rightEarTragion","leftEarTragion"],yO={modelType:"short",runtime:"mediapipe",maxFaces:1},bO=function(){function e(e){var t=this;this.width=0,this.height=0,this.selfieMode=!1,this.faceDetectorSolution=new hO.FaceDetection({locateFile:function(t,n){if(e.solutionPath){var r=e.solutionPath.replace(/\/+$/,"");return"".concat(r,"/").concat(t)}return"".concat(n,"/").concat(t)}}),this.faceDetectorSolution.setOptions({selfieMode:this.selfieMode,model:e.modelType}),this.faceDetectorSolution.onResults((function(e){if(t.height=e.image.height,t.width=e.image.width,t.faces=[],null!==e.detections)for(var n=0,r=e.detections;n<r.length;n++){var a=r[n];t.faces.push(t.normalizedToAbsolute(a.landmarks,(void 0,void 0,void 0,{xMin:o=(i=a.boundingBox).xCenter-i.width/2,xMax:o+i.width,yMin:u=i.yCenter-i.height/2,yMax:u+i.height,width:i.width,height:i.height})))}var i,o,u}))}return e.prototype.normalizedToAbsolute=function(e,t){var n=this;return{keypoints:e.map((function(e,t){return{x:e.x*n.width,y:e.y*n.height,name:gO[t]}})),box:{xMin:t.xMin*this.width,yMin:t.yMin*this.height,xMax:t.xMax*this.width,yMax:t.yMax*this.height,width:t.width*this.width,height:t.height*this.height}}},e.prototype.estimateFaces=function(e,t){return vO(this,void 0,void 0,(function(){var n,r;return mO(this,(function(a){switch(a.label){case 0:return t&&t.flipHorizontal&&t.flipHorizontal!==this.selfieMode&&(this.selfieMode=t.flipHorizontal,this.faceDetectorSolution.setOptions({selfieMode:this.selfieMode})),e instanceof ii.Tensor?(r=ImageData.bind,[4,ii.browser.toPixels(e)]):[3,2];case 1:return n=new(r.apply(ImageData,[void 0,a.sent(),e.shape[1],e.shape[0]])),[3,3];case 2:n=e,a.label=3;case 3:return e=n,[4,this.faceDetectorSolution.send({image:e})];case 4:return a.sent(),[2,this.faces]}}))}))},e.prototype.dispose=function(){this.faceDetectorSolution.close()},e.prototype.reset=function(){this.faceDetectorSolution.reset(),this.width=0,this.height=0,this.faces=null,this.selfieMode=!1},e.prototype.initialize=function(){return this.faceDetectorSolution.initialize()},e}();function xO(e){return vO(this,void 0,void 0,(function(){var t,n;return mO(this,(function(r){switch(r.label){case 0:return t=function(e){if(null==e)return pO({},yO);var t=pO({},e);return t.runtime="mediapipe",null==t.modelType&&(t.modelType=yO.modelType),null==t.maxFaces&&(t.maxFaces=yO.maxFaces),t}(e),[4,(n=new bO(t)).initialize()];case 1:return r.sent(),[2,n]}}))}))}function wO(e){return e instanceof ii.Tensor?{height:e.shape[0],width:e.shape[1]}:{height:e.height,width:e.width}}function kO(e){return e instanceof ii.Tensor?e:ii.browser.fromPixels(e)}function _O(e,t){ii.util.assert(0!==e.width,(function(){return"".concat(t," width cannot be 0.")})),ii.util.assert(0!==e.height,(function(){return"".concat(t," height cannot be 0.")}))}function SO(e,t,n){var r=t.outputTensorSize,a=t.keepAspectRatio,i=t.borderMode,o=t.outputTensorFloatRange,u=wO(e),s=function(e,t){return t?{xCenter:t.xCenter*e.width,yCenter:t.yCenter*e.height,width:t.width*e.width,height:t.height*e.height,rotation:t.rotation}:{xCenter:.5*e.width,yCenter:.5*e.height,width:e.width,height:e.height,rotation:0}}(u,n),c=function(e,t,n){if(void 0===n&&(n=!1),!n)return{top:0,left:0,right:0,bottom:0};var r=t.height,a=t.width;_O(t,"targetSize"),_O(e,"roi");var i,o,u=r/a,s=e.height/e.width,c=0,l=0;return u>s?(i=e.width,o=e.width*u,l=(1-s/u)/2):(i=e.height/u,o=e.height,c=(1-u/s)/2),e.width=i,e.height=o,{top:l,left:c,right:c,bottom:l}}(s,r,a),l=function(e,t,n,r){var a=e.width,i=e.height,o=r?-1:1,u=Math.cos(e.rotation),s=Math.sin(e.rotation),c=e.xCenter,l=e.yCenter,f=1/t,d=1/n,h=new Array(16);return h[0]=a*u*o*f,h[1]=-i*s*f,h[2]=0,h[3]=(-.5*a*u*o+.5*i*s+c)*f,h[4]=a*s*o*d,h[5]=i*u*d,h[6]=0,h[7]=(-.5*i*u-.5*a*s*o+l)*d,h[8]=0,h[9]=0,h[10]=a*f,h[11]=0,h[12]=0,h[13]=0,h[14]=0,h[15]=1,function(e){if(16!==e.length)throw new Error("Array length must be 16 but got ".concat(e.length));return[[e[0],e[1],e[2],e[3]],[e[4],e[5],e[6],e[7]],[e[8],e[9],e[10],e[11]],[e[12],e[13],e[14],e[15]]]}(h)}(s,u.width,u.height,!1),f=(0,ii.tidy)((function(){var t=kO(e),n=(0,ii.tensor2d)(function(e,t,n){return _O(n,"inputResolution"),[1/n.width*e[0][0]*t.width,1/n.height*e[0][1]*t.width,e[0][3]*t.width,1/n.width*e[1][0]*t.height,1/n.height*e[1][1]*t.height,e[1][3]*t.height,0,0]}(l,u,r),[1,8]),a="zero"===i?"constant":"nearest",s=ii.image.transform((0,ii.expandDims)((0,ii.cast)(t,"float32")),n,"bilinear",a,0,[r.height,r.width]);return null!=o?function(e,t){var n=function(e,t,n,r){var a=(r-n)/255;return{scale:a,offset:n-0*a}}(0,0,t[0],t[1]);return(0,ii.tidy)((function(){return(0,ii.add)((0,ii.mul)(e,n.scale),n.offset)}))}(s,o):s}));return{imageTensor:f,padding:c,transformationMatrix:l}}function CO(e){null==e.reduceBoxesInLowestLayer&&(e.reduceBoxesInLowestLayer=!1),null==e.interpolatedScaleAspectRatio&&(e.interpolatedScaleAspectRatio=1),null==e.fixedAnchorSize&&(e.fixedAnchorSize=!1);for(var t=[],n=0;n<e.numLayers;){for(var r=[],a=[],i=[],o=[],u=n;u<e.strides.length&&e.strides[u]===e.strides[n];){var s=AO(e.minScale,e.maxScale,u,e.strides.length);if(0===u&&e.reduceBoxesInLowestLayer)i.push(1),i.push(2),i.push(.5),o.push(.1),o.push(s),o.push(s);else{for(var c=0;c<e.aspectRatios.length;++c)i.push(e.aspectRatios[c]),o.push(s);if(e.interpolatedScaleAspectRatio>0){var l=u===e.strides.length-1?1:AO(e.minScale,e.maxScale,u+1,e.strides.length);o.push(Math.sqrt(s*l)),i.push(e.interpolatedScaleAspectRatio)}}u++}for(var f=0;f<i.length;++f){var d=Math.sqrt(i[f]);r.push(o[f]/d),a.push(o[f]*d)}var h=0,p=0;if(e.featureMapHeight.length>0)h=e.featureMapHeight[n],p=e.featureMapWidth[n];else{var v=e.strides[n];h=Math.ceil(e.inputSizeHeight/v),p=Math.ceil(e.inputSizeWidth/v)}for(var m=0;m<h;++m)for(var g=0;g<p;++g)for(var y=0;y<r.length;++y){var b={xCenter:(g+e.anchorOffsetX)/p,yCenter:(m+e.anchorOffsetY)/h,width:0,height:0};e.fixedAnchorSize?(b.width=1,b.height=1):(b.width=a[y],b.height=r[y]),t.push(b)}n=u}return t}function AO(e,t,n,r){return 1===r?.5*(e+t):e+(t-e)*n/(r-1)}function EO(e,t){var n=t[0],r=t[1];return[n*e[0]+r*e[1]+e[3],n*e[4]+r*e[5]+e[7]]}function NO(e,t,n,r){return vO(this,void 0,void 0,(function(){var r,a,i,o,u;return mO(this,(function(s){switch(s.label){case 0:return e.sort((function(e,t){return Math.max.apply(Math,t.score)-Math.max.apply(Math,e.score)})),r=(0,ii.tensor2d)(e.map((function(e){return[e.locationData.relativeBoundingBox.yMin,e.locationData.relativeBoundingBox.xMin,e.locationData.relativeBoundingBox.yMax,e.locationData.relativeBoundingBox.xMax]}))),a=(0,ii.tensor1d)(e.map((function(e){return e.score[0]}))),[4,ii.image.nonMaxSuppressionAsync(r,a,t,n)];case 1:return[4,(i=s.sent()).array()];case 2:return o=s.sent(),u=e.filter((function(e,t){return o.indexOf(t)>-1})),(0,ii.dispose)([r,a,i]),[2,u]}}))}))}function TO(e,t,n){return vO(this,void 0,void 0,(function(){var r,a,i,o,u;return mO(this,(function(s){switch(s.label){case 0:return r=e[0],a=e[1],i=function(e,t,n){return(0,ii.tidy)((function(){var r,a,i,o;n.reverseOutputOrder?(a=(0,ii.squeeze)((0,ii.slice)(e,[0,n.boxCoordOffset+0],[-1,1])),r=(0,ii.squeeze)((0,ii.slice)(e,[0,n.boxCoordOffset+1],[-1,1])),o=(0,ii.squeeze)((0,ii.slice)(e,[0,n.boxCoordOffset+2],[-1,1])),i=(0,ii.squeeze)((0,ii.slice)(e,[0,n.boxCoordOffset+3],[-1,1]))):(r=(0,ii.squeeze)((0,ii.slice)(e,[0,n.boxCoordOffset+0],[-1,1])),a=(0,ii.squeeze)((0,ii.slice)(e,[0,n.boxCoordOffset+1],[-1,1])),i=(0,ii.squeeze)((0,ii.slice)(e,[0,n.boxCoordOffset+2],[-1,1])),o=(0,ii.squeeze)((0,ii.slice)(e,[0,n.boxCoordOffset+3],[-1,1]))),a=(0,ii.add)((0,ii.mul)((0,ii.div)(a,n.xScale),t.w),t.x),r=(0,ii.add)((0,ii.mul)((0,ii.div)(r,n.yScale),t.h),t.y),n.applyExponentialOnBoxSize?(i=(0,ii.mul)((0,ii.exp)((0,ii.div)(i,n.hScale)),t.h),o=(0,ii.mul)((0,ii.exp)((0,ii.div)(o,n.wScale)),t.w)):(i=(0,ii.mul)((0,ii.div)(i,n.hScale),t.h),o=(0,ii.mul)((0,ii.div)(o,n.wScale),t.h));var u=(0,ii.sub)(r,(0,ii.div)(i,2)),s=(0,ii.sub)(a,(0,ii.div)(o,2)),c=(0,ii.add)(r,(0,ii.div)(i,2)),l=(0,ii.add)(a,(0,ii.div)(o,2)),f=(0,ii.concat)([(0,ii.reshape)(u,[n.numBoxes,1]),(0,ii.reshape)(s,[n.numBoxes,1]),(0,ii.reshape)(c,[n.numBoxes,1]),(0,ii.reshape)(l,[n.numBoxes,1])],1);if(n.numKeypoints)for(var d=0;d<n.numKeypoints;++d){var h=n.keypointCoordOffset+d*n.numValuesPerKeypoint,p=void 0,v=void 0;n.reverseOutputOrder?(p=(0,ii.squeeze)((0,ii.slice)(e,[0,h],[-1,1])),v=(0,ii.squeeze)((0,ii.slice)(e,[0,h+1],[-1,1]))):(v=(0,ii.squeeze)((0,ii.slice)(e,[0,h],[-1,1])),p=(0,ii.squeeze)((0,ii.slice)(e,[0,h+1],[-1,1])));var m=(0,ii.add)((0,ii.mul)((0,ii.div)(p,n.xScale),t.w),t.x),g=(0,ii.add)((0,ii.mul)((0,ii.div)(v,n.yScale),t.h),t.y);f=(0,ii.concat)([f,(0,ii.reshape)(m,[n.numBoxes,1]),(0,ii.reshape)(g,[n.numBoxes,1])],1)}return f}))}(a,t,n),o=(0,ii.tidy)((function(){var e=r;return n.sigmoidScore?(null!=n.scoreClippingThresh&&(e=(0,ii.clipByValue)(r,-n.scoreClippingThresh,n.scoreClippingThresh)),e=(0,ii.sigmoid)(e)):e})),[4,IO(i,o,n)];case 1:return u=s.sent(),(0,ii.dispose)([i,o]),[2,u]}}))}))}function IO(e,t,n){return vO(this,void 0,void 0,(function(){var r,a,i,o,u,s,c,l,f,d,h,p;return mO(this,(function(v){switch(v.label){case 0:return r=[],[4,e.data()];case 1:return a=v.sent(),[4,t.data()];case 2:for(i=v.sent(),o=0;o<n.numBoxes;++o)if(!(null!=n.minScoreThresh&&i[o]<n.minScoreThresh||(u=o*n.numCoords,s=DO(a[u+0],a[u+1],a[u+2],a[u+3],i[o],n.flipVertically,o),(c=s.locationData.relativeBoundingBox).width<0||c.height<0))){if(n.numKeypoints>0)for((l=s.locationData).relativeKeypoints=[],f=n.numKeypoints*n.numValuesPerKeypoint,d=0;d<f;d+=n.numValuesPerKeypoint)h=u+n.keypointCoordOffset+d,p={x:a[h+0],y:n.flipVertically?1-a[h+1]:a[h+1]},l.relativeKeypoints.push(p);r.push(s)}return[2,r]}}))}))}function DO(e,t,n,r,a,i,o){return{score:[a],ind:o,locationData:{relativeBoundingBox:{xMin:t,yMin:i?1-n:e,xMax:r,yMax:i?1-e:n,width:r-t,height:n-e}}}}var FO,MO={reduceBoxesInLowestLayer:!1,interpolatedScaleAspectRatio:1,featureMapHeight:[],featureMapWidth:[],numLayers:4,minScale:.1484375,maxScale:.75,inputSizeHeight:128,inputSizeWidth:128,anchorOffsetX:.5,anchorOffsetY:.5,strides:[8,16,16,16],aspectRatios:[1],fixedAnchorSize:!0},OO={reduceBoxesInLowestLayer:!1,interpolatedScaleAspectRatio:0,featureMapHeight:[],featureMapWidth:[],numLayers:1,minScale:.1484375,maxScale:.75,inputSizeHeight:192,inputSizeWidth:192,anchorOffsetX:.5,anchorOffsetY:.5,strides:[4],aspectRatios:[1],fixedAnchorSize:!0},RO={runtime:"tfjs",modelType:"short",maxFaces:1,detectorModelUrl:"https://tfhub.dev/mediapipe/tfjs-model/face_detection/short/1"},jO={applyExponentialOnBoxSize:!1,flipVertically:!1,ignoreClasses:[],numClasses:1,numBoxes:896,numCoords:16,boxCoordOffset:0,keypointCoordOffset:4,numKeypoints:6,numValuesPerKeypoint:2,sigmoidScore:!0,scoreClippingThresh:100,reverseOutputOrder:!0,xScale:128,yScale:128,hScale:128,wScale:128,minScoreThresh:.5},BO={applyExponentialOnBoxSize:!1,flipVertically:!1,ignoreClasses:[],numClasses:1,numBoxes:2304,numCoords:16,boxCoordOffset:0,keypointCoordOffset:4,numKeypoints:6,numValuesPerKeypoint:2,sigmoidScore:!0,scoreClippingThresh:100,reverseOutputOrder:!0,xScale:192,yScale:192,hScale:192,wScale:192,minScoreThresh:.6},zO={outputTensorSize:{width:128,height:128},keepAspectRatio:!0,outputTensorFloatRange:[-1,1],borderMode:"zero"},ZO={outputTensorSize:{width:192,height:192},keepAspectRatio:!0,outputTensorFloatRange:[-1,1],borderMode:"zero"},LO=function(){function e(e,t,n){this.detectorModel=t,this.maxFaces=n,"full"===e?(this.imageToTensorConfig=ZO,this.tensorsToDetectionConfig=BO,this.anchors=CO(OO)):(this.imageToTensorConfig=zO,this.tensorsToDetectionConfig=jO,this.anchors=CO(MO));var r=(0,ii.tensor1d)(this.anchors.map((function(e){return e.width}))),a=(0,ii.tensor1d)(this.anchors.map((function(e){return e.height}))),i=(0,ii.tensor1d)(this.anchors.map((function(e){return e.xCenter}))),o=(0,ii.tensor1d)(this.anchors.map((function(e){return e.yCenter})));this.anchorTensor={x:i,y:o,w:r,h:a}}return e.prototype.dispose=function(){this.detectorModel.dispose(),(0,ii.dispose)([this.anchorTensor.x,this.anchorTensor.y,this.anchorTensor.w,this.anchorTensor.h])},e.prototype.reset=function(){},e.prototype.detectFaces=function(e,t){return void 0===t&&(t=!1),vO(this,void 0,void 0,(function(){var n,r,a,i,o,u,s,c,l,f,d;return mO(this,(function(h){switch(h.label){case 0:return null==e?(this.reset(),[2,[]]):(n=(0,ii.tidy)((function(){var n=(0,ii.cast)(kO(e),"float32");return t&&(n=(0,ii.squeeze)(ii.image.flipLeftRight((0,ii.expandDims)(n,0)),[0])),n})),r=SO(n,this.imageToTensorConfig),a=r.imageTensor,i=r.transformationMatrix,o=this.detectorModel.execute(a,"Identity:0"),u=function(e){return(0,ii.tidy)((function(){var t=function(e){return(0,ii.tidy)((function(){return[(0,ii.slice)(e,[0,0,0],[1,-1,1]),(0,ii.slice)(e,[0,0,1],[1,-1,-1])]}))}(e),n=t[0],r=t[1];return{boxes:(0,ii.squeeze)(r),logits:(0,ii.squeeze)(n)}}))}(o),s=u.boxes,[4,TO([c=u.logits,s],this.anchorTensor,this.tensorsToDetectionConfig)]);case 1:return 0===(l=h.sent()).length?((0,ii.dispose)([n,a,o,c,s]),[2,l]):[4,NO(l,this.maxFaces,.3)];case 2:return f=h.sent(),d=function(e,t){void 0===e&&(e=[]);var n,r=(n=t,[].concat.apply([],n));return e.forEach((function(e){var t=e.locationData;t.relativeKeypoints.forEach((function(e){var t=EO(r,[e.x,e.y]),n=t[0],a=t[1];e.x=n,e.y=a}));var n=t.relativeBoundingBox,a=Number.MAX_VALUE,i=Number.MAX_VALUE,o=Number.MIN_VALUE,u=Number.MIN_VALUE;[[n.xMin,n.yMin],[n.xMin+n.width,n.yMin],[n.xMin+n.width,n.yMin+n.height],[n.xMin,n.yMin+n.height]].forEach((function(e){var t=EO(r,e),n=t[0],s=t[1];a=Math.min(a,n),o=Math.max(o,n),i=Math.min(i,s),u=Math.max(u,s)})),t.relativeBoundingBox={xMin:a,xMax:o,yMin:i,yMax:u,width:o-a,height:u-i}})),e}(f,i),(0,ii.dispose)([n,a,o,c,s]),[2,d]}}))}))},e.prototype.estimateFaces=function(e,t){return vO(this,void 0,void 0,(function(){var n,r;return mO(this,(function(a){return n=wO(e),r=!!t&&t.flipHorizontal,[2,this.detectFaces(e,r).then((function(e){return e.map((function(e){for(var t=e.locationData.relativeKeypoints.map((function(e,t){return pO(pO({},e),{x:e.x*n.width,y:e.y*n.height,name:gO[t]})})),r=e.locationData.relativeBoundingBox,a=0,i=["width","xMax","xMin"];a<i.length;a++)r[i[a]]*=n.width;for(var o=0,u=["height","yMax","yMin"];o<u.length;o++)r[u[o]]*=n.height;return{keypoints:t,box:r}}))}))]}))}))},e}();function PO(e){return vO(this,void 0,void 0,(function(){var t,n,r;return mO(this,(function(a){switch(a.label){case 0:return t=function(e){if(null==e)return pO({},RO);var t=pO({},e);return null==t.modelType&&(t.modelType=RO.modelType),null==t.maxFaces&&(t.maxFaces=RO.maxFaces),null==t.detectorModelUrl&&("full"===t.modelType?t.detectorModelUrl="https://tfhub.dev/mediapipe/tfjs-model/face_detection/full/1":t.detectorModelUrl="https://tfhub.dev/mediapipe/tfjs-model/face_detection/short/1"),t}(e),n="string"==typeof t.detectorModelUrl&&t.detectorModelUrl.indexOf("https://tfhub.dev")>-1,[4,Fm(t.detectorModelUrl,{fromTFHub:n})];case 1:return r=a.sent(),[2,new LO(t.modelType,r,t.maxFaces)]}}))}))}function UO(e,t){return vO(this,void 0,void 0,(function(){var n,r;return mO(this,(function(a){if(e===FO.MediaPipeFaceDetector){if(r=void 0,null!=(n=t)){if("tfjs"===n.runtime)return[2,PO(n)];if("mediapipe"===n.runtime)return[2,xO(n)];r=n.runtime}throw new Error("Expect modelConfig.runtime to be either 'tfjs' "+"or 'mediapipe', but got ".concat(r))}throw new Error("".concat(e," is not a supported model name."))}))}))}function WO(){return VO.apply(this,arguments)}function VO(){return VO=(0,Da.Z)(E().mark((function e(){var t,n;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=FO.MediaPipeFaceDetector,n={runtime:"tfjs"},e.next=4,UO(t,n);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)}))),VO.apply(this,arguments)}function qO(e,t){return GO.apply(this,arguments)}function GO(){return(GO=(0,Da.Z)(E().mark((function e(t,n){return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.estimateFaces(n);case 2:e.sent.length>0&&(document.getElementById("has-faces").style.display="block");case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function HO(e,t){return XO.apply(this,arguments)}function XO(){return XO=(0,Da.Z)(E().mark((function e(t,n){var r,a,i,o,u,s;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(r=["church","dog","face","fish","parachute"],a=0;a<5;a++)document.getElementById(r[a]).classList.remove("emph");for(i=ii.tidy((function(){var e=ii.browser.fromPixels(n).resizeBilinear([64,64]).toFloat().div(255);return t.predict(e.expandDims()).squeeze()})),o=i.arraySync(),u=i.argMax().arraySync(),s=0;s<5;s++)document.getElementById(r[s]).innerHTML=o[s].toFixed(3);document.getElementById(r[u]).classList.add("emph"),document.getElementById("output-spn").style.display="none",document.getElementById("pred").style.display="block",document.getElementById("ps").style.display="block";case 10:case"end":return e.stop()}}),e)}))),XO.apply(this,arguments)}(FO||(FO={})).MediaPipeFaceDetector="MediaPipeFaceDetector";var KO=function(e){var t=e.classifier,n=(0,k.useState)(void 0),r=(0,C.Z)(n,2),a=r[0],i=r[1];function o(e){document.getElementById("output-spn").style.display="none",document.getElementById("has-faces").style.display="none",document.getElementById("pred").style.display="none";var t=document.getElementById("source-img").getContext("2d",{willReadFrequently:!0}),n=new Image;document.getElementById("source-spn").style.display="inline-block",document.getElementById("source-img").style.display="none",n.src=e,n.onload=function(){t.drawImage(n,0,0,224,224)},document.getElementById("source-spn").style.display="none",document.getElementById("source-img").style.display="inline-block",document.getElementById("output-spn").style.display="inline-block",document.getElementById("has-faces").style.display="none",document.getElementById("pred").style.display="none",setTimeout((function(){return function(){return s.apply(this,arguments)}()}),1e3)}function u(){return u=(0,Da.Z)(E().mark((function e(){return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:document.getElementById("loadfdspn").style.display="block",document.getElementById("loadfd").disabled=!0,WO().then((function(e){i(e),document.getElementById("loadfdspn").style.display="none"}));case 3:case"end":return e.stop()}}),e)}))),u.apply(this,arguments)}function s(){return(s=(0,Da.Z)(E().mark((function e(){var n;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=document.getElementById("source-img").getContext("2d").getImageData(0,0,224,224),e.next=3,qO(a,n);case 3:return e.next=5,HO(t,n);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function c(){return c=(0,Da.Z)(E().mark((function e(t){return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),o("random/"+Math.floor(10*Math.random()).toString()+".jpeg");case 2:case"end":return e.stop()}}),e)}))),c.apply(this,arguments)}return(0,k.useEffect)((function(){a?(document.getElementById("random").disabled=!1,document.getElementById("user").disabled=!1):(document.getElementById("random").disabled=!0,document.getElementById("user").disabled=!0)}),[a]),(0,k.useEffect)((function(){document.getElementById("loadfd").disabled=!t}),[t]),(0,rt.jsxs)("div",{style:{marginBottom:50},children:[(0,rt.jsx)("h2",{className:"display-6",children:"How Does The Model Perform?"}),(0,rt.jsxs)("div",{className:"container-sm",style:{marginTop:50,maxWidth:800},children:[(0,rt.jsxs)("div",{style:{textAlign:"justify"},children:["Now that we've learned how the model works \"under-the-hood\" and what dataset it was trained on, let's see how it performs on unseen samples. Over-reliance on model predictions can do more harm than good, especially because these models are not always right! Sometimes, models can be extremely wrong with very high confidence. AI systems should keep humans in the loop, since humans are ultimately ",(0,rt.jsx)("a",{href:"https://www.unesco.org/en/artificial-intelligence",children:"responsible and accountable"})," for the tasks.",(0,rt.jsx)("br",{}),(0,rt.jsx)("br",{}),"How does the model do on an unseen image? The pipeline that we will be following is:",(0,rt.jsx)("br",{}),(0,rt.jsxs)("div",{className:"emph",children:["[1] Get an input image",(0,rt.jsx)("br",{}),"[2] Detect faces in the image using ",(0,rt.jsx)("a",{href:"https://arxiv.org/pdf/1907.05047.pdf",children:"BlazeFace"}),(0,rt.jsx)("br",{}),"[3] Pass image through the model to get predictions!"]}),(0,rt.jsx)("br",{})]}),(0,rt.jsxs)("div",{children:[(0,rt.jsx)("div",{style:{marginBottom:15,textAlign:"left"},children:(0,rt.jsxs)(La,{children:[(0,rt.jsx)(Gt,{xs:!0,lg:"3",children:(0,rt.jsx)(Oa,{id:"loadfd",onClick:function(){return u.apply(this,arguments)},children:"Load Face Detector"})}),(0,rt.jsx)(Gt,{xs:!0,lg:"2",style:{justifyContent:"left"},children:(0,rt.jsx)(Ba,{id:"loadfdspn",style:{display:"none"}})})]})}),(0,rt.jsx)("button",{id:"random",className:"random-img-gen",onClick:function(e){return c.apply(this,arguments)},children:"Use Random Image"}),(0,rt.jsx)("span",{style:{margin:"0 20px"},children:"OR"}),(0,rt.jsx)("input",{id:"user",type:"file",accept:"image/*",onChange:function(e){o(URL.createObjectURL(e.target.files[0]))},style:{marginBottom:20,justifyContent:"center",cursor:"pointer"}}),(0,rt.jsx)("br",{}),(0,rt.jsx)("canvas",{id:"source-img",width:224,height:224,style:{display:"none"}}),(0,rt.jsx)(Ba,{id:"source-spn",style:{display:"none"}})]}),(0,rt.jsxs)("div",{children:[(0,rt.jsx)(Ba,{id:"output-spn",style:{display:"none",marginTop:10}}),(0,rt.jsx)("div",{id:"has-faces",style:{display:"none",color:"red",marginTop:20,textAlign:"left"},children:"BlazeFace has detected presence of faces (sometimes even dog faces \ud83d\ude1e) in the provided image. As detailed above, always keep in mind concerns around privacy and data protection!"}),(0,rt.jsxs)("div",{id:"pred",style:{display:"none",marginTop:20},children:[(0,rt.jsx)("span",{style:{textDecoration:"underline"},children:"Prediction"}),(0,rt.jsx)("br",{}),"Church: ",(0,rt.jsx)("span",{id:"church"}),(0,rt.jsx)("br",{}),"Dog: ",(0,rt.jsx)("span",{id:"dog"}),(0,rt.jsx)("br",{}),"Face: ",(0,rt.jsx)("span",{id:"face"}),(0,rt.jsx)("br",{}),"Fish: ",(0,rt.jsx)("span",{id:"fish"}),(0,rt.jsx)("br",{}),"Parachute: ",(0,rt.jsx)("span",{id:"parachute"})]}),(0,rt.jsxs)("div",{id:"ps",style:{textAlign:"justify",marginTop:20,display:"none"},children:["Two of the many reasons why a model might incorrectly classify a test image, given that it performs decently well on the training and validation sets, are: (1) the image is ",(0,rt.jsx)("a",{href:"https://arxiv.org/pdf/2108.13624.pdf",children:"out-of-distribution"})," (image styles not present in the dataset; for example, a face at a different angle, a different dog breed, etc.), or (2) the image is ",(0,rt.jsx)("a",{href:"https://arxiv.org/pdf/2103.03097.pdf",children:"out-of-domain"})," (images from classes the model might not have seen during training). Always have humans in the loop!"]})]})]})]})},YO=n(6360),$O={value:function(){}};function QO(){for(var e,t=0,n=arguments.length,r={};t<n;++t){if(!(e=arguments[t]+"")||e in r||/[\s.]/.test(e))throw new Error("illegal type: "+e);r[e]=[]}return new JO(r)}function JO(e){this._=e}function eR(e,t){return e.trim().split(/^|\s+/).map((function(e){var n="",r=e.indexOf(".");if(r>=0&&(n=e.slice(r+1),e=e.slice(0,r)),e&&!t.hasOwnProperty(e))throw new Error("unknown type: "+e);return{type:e,name:n}}))}function tR(e,t){for(var n,r=0,a=e.length;r<a;++r)if((n=e[r]).name===t)return n.value}function nR(e,t,n){for(var r=0,a=e.length;r<a;++r)if(e[r].name===t){e[r]=$O,e=e.slice(0,r).concat(e.slice(r+1));break}return null!=n&&e.push({name:t,value:n}),e}JO.prototype=QO.prototype={constructor:JO,on:function(e,t){var n,r=this._,a=eR(e+"",r),i=-1,o=a.length;if(!(arguments.length<2)){if(null!=t&&"function"!==typeof t)throw new Error("invalid callback: "+t);for(;++i<o;)if(n=(e=a[i]).type)r[n]=nR(r[n],e.name,t);else if(null==t)for(n in r)r[n]=nR(r[n],e.name,null);return this}for(;++i<o;)if((n=(e=a[i]).type)&&(n=tR(r[n],e.name)))return n},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new JO(e)},call:function(e,t){if((n=arguments.length-2)>0)for(var n,r,a=new Array(n),i=0;i<n;++i)a[i]=arguments[i+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(i=0,n=(r=this._[e]).length;i<n;++i)r[i].value.apply(t,a)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var r=this._[e],a=0,i=r.length;a<i;++a)r[a].value.apply(t,n)}};var rR,aR,iR=QO,oR=0,uR=0,sR=0,cR=0,lR=0,fR=0,dR="object"===typeof performance&&performance.now?performance:Date,hR="object"===typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function pR(){return lR||(hR(vR),lR=dR.now()+fR)}function vR(){lR=0}function mR(){this._call=this._time=this._next=null}function gR(e,t,n){var r=new mR;return r.restart(e,t,n),r}function yR(){lR=(cR=dR.now())+fR,oR=uR=0;try{!function(){pR(),++oR;for(var e,t=rR;t;)(e=lR-t._time)>=0&&t._call.call(void 0,e),t=t._next;--oR}()}finally{oR=0,function(){var e,t,n=rR,r=1/0;for(;n;)n._call?(r>n._time&&(r=n._time),e=n,n=n._next):(t=n._next,n._next=null,n=e?e._next=t:rR=t);aR=e,xR(r)}(),lR=0}}function bR(){var e=dR.now(),t=e-cR;t>1e3&&(fR-=t,cR=e)}function xR(e){oR||(uR&&(uR=clearTimeout(uR)),e-lR>24?(e<1/0&&(uR=setTimeout(yR,e-dR.now()-fR)),sR&&(sR=clearInterval(sR))):(sR||(cR=dR.now(),sR=setInterval(bR,1e3)),oR=1,hR(yR)))}function wR(e,t,n){var r=new mR;return t=null==t?0:+t,r.restart((function(n){r.stop(),e(n+t)}),t,n),r}mR.prototype=gR.prototype={constructor:mR,restart:function(e,t,n){if("function"!==typeof e)throw new TypeError("callback is not a function");n=(null==n?pR():+n)+(null==t?0:+t),this._next||aR===this||(aR?aR._next=this:rR=this,aR=this),this._call=e,this._time=n,xR()},stop:function(){this._call&&(this._call=null,this._time=1/0,xR())}};var kR=iR("start","end","cancel","interrupt"),_R=[];function SR(e,t,n,r,a,i){var o=e.__transition;if(o){if(n in o)return}else e.__transition={};!function(e,t,n){var r,a=e.__transition;function i(e){n.state=1,n.timer.restart(o,n.delay,n.time),n.delay<=e&&o(e-n.delay)}function o(i){var c,l,f,d;if(1!==n.state)return s();for(c in a)if((d=a[c]).name===n.name){if(3===d.state)return wR(o);4===d.state?(d.state=6,d.timer.stop(),d.on.call("interrupt",e,e.__data__,d.index,d.group),delete a[c]):+c<t&&(d.state=6,d.timer.stop(),d.on.call("cancel",e,e.__data__,d.index,d.group),delete a[c])}if(wR((function(){3===n.state&&(n.state=4,n.timer.restart(u,n.delay,n.time),u(i))})),n.state=2,n.on.call("start",e,e.__data__,n.index,n.group),2===n.state){for(n.state=3,r=new Array(f=n.tween.length),c=0,l=-1;c<f;++c)(d=n.tween[c].value.call(e,e.__data__,n.index,n.group))&&(r[++l]=d);r.length=l+1}}function u(t){for(var a=t<n.duration?n.ease.call(null,t/n.duration):(n.timer.restart(s),n.state=5,1),i=-1,o=r.length;++i<o;)r[i].call(e,a);5===n.state&&(n.on.call("end",e,e.__data__,n.index,n.group),s())}function s(){for(var r in n.state=6,n.timer.stop(),delete a[t],a)return;delete e.__transition}a[t]=n,n.timer=gR(i,0,n.time)}(e,n,{name:t,index:r,group:a,on:kR,tween:_R,time:i.time,delay:i.delay,duration:i.duration,ease:i.ease,timer:null,state:0})}function CR(e,t){var n=ER(e,t);if(n.state>0)throw new Error("too late; already scheduled");return n}function AR(e,t){var n=ER(e,t);if(n.state>3)throw new Error("too late; already running");return n}function ER(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw new Error("transition not found");return n}var NR=n(3375);function TR(e,t){var n,r;return function(){var a=AR(this,e),i=a.tween;if(i!==n)for(var o=0,u=(r=n=i).length;o<u;++o)if(r[o].name===t){(r=r.slice()).splice(o,1);break}a.tween=r}}function IR(e,t,n){var r,a;if("function"!==typeof n)throw new Error;return function(){var i=AR(this,e),o=i.tween;if(o!==r){a=(r=o).slice();for(var u={name:t,value:n},s=0,c=a.length;s<c;++s)if(a[s].name===t){a[s]=u;break}s===c&&a.push(u)}i.tween=a}}function DR(e,t,n){var r=e._id;return e.each((function(){var e=AR(this,r);(e.value||(e.value={}))[t]=n.apply(this,arguments)})),function(e){return ER(e,r).value[t]}}var FR=n(5010),MR=n(4837),OR=n(5217),RR=n(327);function jR(e,t){var n;return("number"===typeof t?MR.Z:t instanceof FR.ZP?OR.ZP:(n=(0,FR.ZP)(t))?(t=n,OR.ZP):RR.Z)(e,t)}function BR(e){return function(){this.removeAttribute(e)}}function zR(e){return function(){this.removeAttributeNS(e.space,e.local)}}function ZR(e,t,n){var r,a,i=n+"";return function(){var o=this.getAttribute(e);return o===i?null:o===r?a:a=t(r=o,n)}}function LR(e,t,n){var r,a,i=n+"";return function(){var o=this.getAttributeNS(e.space,e.local);return o===i?null:o===r?a:a=t(r=o,n)}}function PR(e,t,n){var r,a,i;return function(){var o,u,s=n(this);if(null!=s)return(o=this.getAttribute(e))===(u=s+"")?null:o===r&&u===a?i:(a=u,i=t(r=o,s));this.removeAttribute(e)}}function UR(e,t,n){var r,a,i;return function(){var o,u,s=n(this);if(null!=s)return(o=this.getAttributeNS(e.space,e.local))===(u=s+"")?null:o===r&&u===a?i:(a=u,i=t(r=o,s));this.removeAttributeNS(e.space,e.local)}}function WR(e,t){return function(n){this.setAttribute(e,t.call(this,n))}}function VR(e,t){return function(n){this.setAttributeNS(e.space,e.local,t.call(this,n))}}function qR(e,t){var n,r;function a(){var a=t.apply(this,arguments);return a!==r&&(n=(r=a)&&VR(e,a)),n}return a._value=t,a}function GR(e,t){var n,r;function a(){var a=t.apply(this,arguments);return a!==r&&(n=(r=a)&&WR(e,a)),n}return a._value=t,a}function HR(e,t){return function(){CR(this,e).delay=+t.apply(this,arguments)}}function XR(e,t){return t=+t,function(){CR(this,e).delay=t}}function KR(e,t){return function(){AR(this,e).duration=+t.apply(this,arguments)}}function YR(e,t){return t=+t,function(){AR(this,e).duration=t}}function $R(e,t){if("function"!==typeof t)throw new Error;return function(){AR(this,e).ease=t}}function QR(e,t,n){var r,a,i=function(e){return(e+"").trim().split(/^|\s+/).every((function(e){var t=e.indexOf(".");return t>=0&&(e=e.slice(0,t)),!e||"start"===e}))}(t)?CR:AR;return function(){var o=i(this,e),u=o.on;u!==r&&(a=(r=u).copy()).on(t,n),o.on=a}}var JR=YO.selection.prototype.constructor;function ej(e){return function(){this.style.removeProperty(e)}}function tj(e,t,n){return function(r){this.style.setProperty(e,t.call(this,r),n)}}function nj(e,t,n){var r,a;function i(){var i=t.apply(this,arguments);return i!==a&&(r=(a=i)&&tj(e,i,n)),r}return i._value=t,i}function rj(e){return function(t){this.textContent=e.call(this,t)}}function aj(e){var t,n;function r(){var r=e.apply(this,arguments);return r!==n&&(t=(n=r)&&rj(r)),t}return r._value=e,r}var ij=0;function oj(e,t,n,r){this._groups=e,this._parents=t,this._name=n,this._id=r}function uj(){return++ij}var sj=YO.selection.prototype;oj.prototype=function(e){return(0,YO.selection)().transition(e)}.prototype=(0,it.Z)({constructor:oj,select:function(e){var t=this._name,n=this._id;"function"!==typeof e&&(e=(0,YO.selector)(e));for(var r=this._groups,a=r.length,i=new Array(a),o=0;o<a;++o)for(var u,s,c=r[o],l=c.length,f=i[o]=new Array(l),d=0;d<l;++d)(u=c[d])&&(s=e.call(u,u.__data__,d,c))&&("__data__"in u&&(s.__data__=u.__data__),f[d]=s,SR(f[d],t,n,d,f,ER(u,n)));return new oj(i,this._parents,t,n)},selectAll:function(e){var t=this._name,n=this._id;"function"!==typeof e&&(e=(0,YO.selectorAll)(e));for(var r=this._groups,a=r.length,i=[],o=[],u=0;u<a;++u)for(var s,c=r[u],l=c.length,f=0;f<l;++f)if(s=c[f]){for(var d,h=e.call(s,s.__data__,f,c),p=ER(s,n),v=0,m=h.length;v<m;++v)(d=h[v])&&SR(d,t,n,v,h,p);i.push(h),o.push(s)}return new oj(i,o,t,n)},selectChild:sj.selectChild,selectChildren:sj.selectChildren,filter:function(e){"function"!==typeof e&&(e=(0,YO.matcher)(e));for(var t=this._groups,n=t.length,r=new Array(n),a=0;a<n;++a)for(var i,o=t[a],u=o.length,s=r[a]=[],c=0;c<u;++c)(i=o[c])&&e.call(i,i.__data__,c,o)&&s.push(i);return new oj(r,this._parents,this._name,this._id)},merge:function(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,n=e._groups,r=t.length,a=n.length,i=Math.min(r,a),o=new Array(r),u=0;u<i;++u)for(var s,c=t[u],l=n[u],f=c.length,d=o[u]=new Array(f),h=0;h<f;++h)(s=c[h]||l[h])&&(d[h]=s);for(;u<r;++u)o[u]=t[u];return new oj(o,this._parents,this._name,this._id)},selection:function(){return new JR(this._groups,this._parents)},transition:function(){for(var e=this._name,t=this._id,n=uj(),r=this._groups,a=r.length,i=0;i<a;++i)for(var o,u=r[i],s=u.length,c=0;c<s;++c)if(o=u[c]){var l=ER(o,t);SR(o,e,n,c,u,{time:l.time+l.delay+l.duration,delay:0,duration:l.duration,ease:l.ease})}return new oj(r,this._parents,e,n)},call:sj.call,nodes:sj.nodes,node:sj.node,size:sj.size,empty:sj.empty,each:sj.each,on:function(e,t){var n=this._id;return arguments.length<2?ER(this.node(),n).on.on(e):this.each(QR(n,e,t))},attr:function(e,t){var n=(0,YO.namespace)(e),r="transform"===n?NR.w:jR;return this.attrTween(e,"function"===typeof t?(n.local?UR:PR)(n,r,DR(this,"attr."+e,t)):null==t?(n.local?zR:BR)(n):(n.local?LR:ZR)(n,r,t))},attrTween:function(e,t){var n="attr."+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(null==t)return this.tween(n,null);if("function"!==typeof t)throw new Error;var r=(0,YO.namespace)(e);return this.tween(n,(r.local?qR:GR)(r,t))},style:function(e,t,n){var r="transform"===(e+="")?NR.Y:jR;return null==t?this.styleTween(e,function(e,t){var n,r,a;return function(){var i=(0,YO.style)(this,e),o=(this.style.removeProperty(e),(0,YO.style)(this,e));return i===o?null:i===n&&o===r?a:a=t(n=i,r=o)}}(e,r)).on("end.style."+e,ej(e)):"function"===typeof t?this.styleTween(e,function(e,t,n){var r,a,i;return function(){var o=(0,YO.style)(this,e),u=n(this),s=u+"";return null==u&&(this.style.removeProperty(e),s=u=(0,YO.style)(this,e)),o===s?null:o===r&&s===a?i:(a=s,i=t(r=o,u))}}(e,r,DR(this,"style."+e,t))).each(function(e,t){var n,r,a,i,o="style."+t,u="end."+o;return function(){var s=AR(this,e),c=s.on,l=null==s.value[o]?i||(i=ej(t)):void 0;c===n&&a===l||(r=(n=c).copy()).on(u,a=l),s.on=r}}(this._id,e)):this.styleTween(e,function(e,t,n){var r,a,i=n+"";return function(){var o=(0,YO.style)(this,e);return o===i?null:o===r?a:a=t(r=o,n)}}(e,r,t),n).on("end.style."+e,null)},styleTween:function(e,t,n){var r="style."+(e+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(null==t)return this.tween(r,null);if("function"!==typeof t)throw new Error;return this.tween(r,nj(e,t,null==n?"":n))},text:function(e){return this.tween("text","function"===typeof e?function(e){return function(){var t=e(this);this.textContent=null==t?"":t}}(DR(this,"text",e)):function(e){return function(){this.textContent=e}}(null==e?"":e+""))},textTween:function(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(null==e)return this.tween(t,null);if("function"!==typeof e)throw new Error;return this.tween(t,aj(e))},remove:function(){return this.on("end.remove",function(e){return function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}}(this._id))},tween:function(e,t){var n=this._id;if(e+="",arguments.length<2){for(var r,a=ER(this.node(),n).tween,i=0,o=a.length;i<o;++i)if((r=a[i]).name===e)return r.value;return null}return this.each((null==t?TR:IR)(n,e,t))},delay:function(e){var t=this._id;return arguments.length?this.each(("function"===typeof e?HR:XR)(t,e)):ER(this.node(),t).delay},duration:function(e){var t=this._id;return arguments.length?this.each(("function"===typeof e?KR:YR)(t,e)):ER(this.node(),t).duration},ease:function(e){var t=this._id;return arguments.length?this.each($R(t,e)):ER(this.node(),t).ease},easeVarying:function(e){if("function"!==typeof e)throw new Error;return this.each(function(e,t){return function(){var n=t.apply(this,arguments);if("function"!==typeof n)throw new Error;AR(this,e).ease=n}}(this._id,e))},end:function(){var e,t,n=this,r=n._id,a=n.size();return new Promise((function(i,o){var u={value:o},s={value:function(){0===--a&&i()}};n.each((function(){var n=AR(this,r),a=n.on;a!==e&&((t=(e=a).copy())._.cancel.push(u),t._.interrupt.push(u),t._.end.push(s)),n.on=t})),0===a&&i()}))}},Symbol.iterator,sj[Symbol.iterator]);var cj={time:null,delay:0,duration:250,ease:function(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}};function lj(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))throw new Error("transition ".concat(t," not found"));return n}YO.selection.prototype.interrupt=function(e){return this.each((function(){!function(e,t){var n,r,a,i=e.__transition,o=!0;if(i){for(a in t=null==t?null:t+"",i)(n=i[a]).name===t?(r=n.state>2&&n.state<5,n.state=6,n.timer.stop(),n.on.call(r?"interrupt":"cancel",e,e.__data__,n.index,n.group),delete i[a]):o=!1;o&&delete e.__transition}}(this,e)}))},YO.selection.prototype.transition=function(e){var t,n;e instanceof oj?(t=e._id,e=e._name):(t=uj(),(n=cj).time=pR(),e=null==e?null:e+"");for(var r=this._groups,a=r.length,i=0;i<a;++i)for(var o,u=r[i],s=u.length,c=0;c<s;++c)(o=u[c])&&SR(o,e,t,c,u,n||lj(o,t));return new oj(r,this._parents,e,t)};Math.abs,Math.max,Math.min;function fj(e){return[+e[0],+e[1]]}function dj(e){return[fj(e[0]),fj(e[1])]}["w","e"].map(hj),["n","s"].map(hj),["n","w","e","s","nw","ne","sw","se"].map(hj);function hj(e){return{type:e}}var pj=n(2989);function vj(){}function mj(e){return null==e?vj:function(){return this.querySelector(e)}}function gj(e){return null==e?[]:Array.isArray(e)?e:Array.from(e)}function yj(){return[]}function bj(e){return function(t){return t.matches(e)}}var xj=Array.prototype.find;function wj(){return this.firstElementChild}var kj=Array.prototype.filter;function _j(){return Array.from(this.children)}function Sj(e){return new Array(e.length)}function Cj(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}function Aj(e){return function(){return e}}function Ej(e,t,n,r,a,i){for(var o,u=0,s=t.length,c=i.length;u<c;++u)(o=t[u])?(o.__data__=i[u],r[u]=o):n[u]=new Cj(e,i[u]);for(;u<s;++u)(o=t[u])&&(a[u]=o)}function Nj(e,t,n,r,a,i,o){var u,s,c,l=new Map,f=t.length,d=i.length,h=new Array(f);for(u=0;u<f;++u)(s=t[u])&&(h[u]=c=o.call(s,s.__data__,u,t)+"",l.has(c)?a[u]=s:l.set(c,s));for(u=0;u<d;++u)c=o.call(e,i[u],u,i)+"",(s=l.get(c))?(r[u]=s,s.__data__=i[u],l.delete(c)):n[u]=new Cj(e,i[u]);for(u=0;u<f;++u)(s=t[u])&&l.get(h[u])===s&&(a[u]=s)}function Tj(e){return e.__data__}function Ij(e){return"object"===typeof e&&"length"in e?e:Array.from(e)}function Dj(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}Cj.prototype={constructor:Cj,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};var Fj="http://www.w3.org/1999/xhtml",Mj={svg:"http://www.w3.org/2000/svg",xhtml:Fj,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function Oj(e){var t=e+="",n=t.indexOf(":");return n>=0&&"xmlns"!==(t=e.slice(0,n))&&(e=e.slice(n+1)),Mj.hasOwnProperty(t)?{space:Mj[t],local:e}:e}function Rj(e){return function(){this.removeAttribute(e)}}function jj(e){return function(){this.removeAttributeNS(e.space,e.local)}}function Bj(e,t){return function(){this.setAttribute(e,t)}}function zj(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function Zj(e,t){return function(){var n=t.apply(this,arguments);null==n?this.removeAttribute(e):this.setAttribute(e,n)}}function Lj(e,t){return function(){var n=t.apply(this,arguments);null==n?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function Pj(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function Uj(e){return function(){this.style.removeProperty(e)}}function Wj(e,t,n){return function(){this.style.setProperty(e,t,n)}}function Vj(e,t,n){return function(){var r=t.apply(this,arguments);null==r?this.style.removeProperty(e):this.style.setProperty(e,r,n)}}function qj(e,t){return e.style.getPropertyValue(t)||Pj(e).getComputedStyle(e,null).getPropertyValue(t)}function Gj(e){return function(){delete this[e]}}function Hj(e,t){return function(){this[e]=t}}function Xj(e,t){return function(){var n=t.apply(this,arguments);null==n?delete this[e]:this[e]=n}}function Kj(e){return e.trim().split(/^|\s+/)}function Yj(e){return e.classList||new $j(e)}function $j(e){this._node=e,this._names=Kj(e.getAttribute("class")||"")}function Qj(e,t){for(var n=Yj(e),r=-1,a=t.length;++r<a;)n.add(t[r])}function Jj(e,t){for(var n=Yj(e),r=-1,a=t.length;++r<a;)n.remove(t[r])}function eB(e){return function(){Qj(this,e)}}function tB(e){return function(){Jj(this,e)}}function nB(e,t){return function(){(t.apply(this,arguments)?Qj:Jj)(this,e)}}function rB(){this.textContent=""}function aB(e){return function(){this.textContent=e}}function iB(e){return function(){var t=e.apply(this,arguments);this.textContent=null==t?"":t}}function oB(){this.innerHTML=""}function uB(e){return function(){this.innerHTML=e}}function sB(e){return function(){var t=e.apply(this,arguments);this.innerHTML=null==t?"":t}}function cB(){this.nextSibling&&this.parentNode.appendChild(this)}function lB(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function fB(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===Fj&&t.documentElement.namespaceURI===Fj?t.createElement(e):t.createElementNS(n,e)}}function dB(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function hB(e){var t=Oj(e);return(t.local?dB:fB)(t)}function pB(){return null}function vB(){var e=this.parentNode;e&&e.removeChild(this)}function mB(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function gB(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function yB(e){return e.trim().split(/^|\s+/).map((function(e){var t="",n=e.indexOf(".");return n>=0&&(t=e.slice(n+1),e=e.slice(0,n)),{type:e,name:t}}))}function bB(e){return function(){var t=this.__on;if(t){for(var n,r=0,a=-1,i=t.length;r<i;++r)n=t[r],e.type&&n.type!==e.type||n.name!==e.name?t[++a]=n:this.removeEventListener(n.type,n.listener,n.options);++a?t.length=a:delete this.__on}}}function xB(e,t,n){return function(){var r,a=this.__on,i=function(e){return function(t){e.call(this,t,this.__data__)}}(t);if(a)for(var o=0,u=a.length;o<u;++o)if((r=a[o]).type===e.type&&r.name===e.name)return this.removeEventListener(r.type,r.listener,r.options),this.addEventListener(r.type,r.listener=i,r.options=n),void(r.value=t);this.addEventListener(e.type,i,n),r={type:e.type,name:e.name,value:t,listener:i,options:n},a?a.push(r):this.__on=[r]}}function wB(e,t,n){var r=Pj(e),a=r.CustomEvent;"function"===typeof a?a=new a(t,n):(a=r.document.createEvent("Event"),n?(a.initEvent(t,n.bubbles,n.cancelable),a.detail=n.detail):a.initEvent(t,!1,!1)),e.dispatchEvent(a)}function kB(e,t){return function(){return wB(this,e,t)}}function _B(e,t){return function(){return wB(this,e,t.apply(this,arguments))}}$j.prototype={add:function(e){this._names.indexOf(e)<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};var SB=A.mark(CB);function CB(){var e,t,n,r,a,i,o;return A.wrap((function(u){for(;;)switch(u.prev=u.next){case 0:e=this._groups,t=0,n=e.length;case 1:if(!(t<n)){u.next=13;break}r=e[t],a=0,i=r.length;case 3:if(!(a<i)){u.next=10;break}if(!(o=r[a])){u.next=7;break}return u.next=7,o;case 7:++a,u.next=3;break;case 10:++t,u.next=1;break;case 13:case"end":return u.stop()}}),SB,this)}var AB=[null];function EB(e,t){this._groups=e,this._parents=t}function NB(){return new EB([[document.documentElement]],AB)}EB.prototype=NB.prototype=(0,it.Z)({constructor:EB,select:function(e){"function"!==typeof e&&(e=mj(e));for(var t=this._groups,n=t.length,r=new Array(n),a=0;a<n;++a)for(var i,o,u=t[a],s=u.length,c=r[a]=new Array(s),l=0;l<s;++l)(i=u[l])&&(o=e.call(i,i.__data__,l,u))&&("__data__"in i&&(o.__data__=i.__data__),c[l]=o);return new EB(r,this._parents)},selectAll:function(e){e="function"===typeof e?function(e){return function(){return gj(e.apply(this,arguments))}}(e):function(e){return null==e?yj:function(){return this.querySelectorAll(e)}}(e);for(var t=this._groups,n=t.length,r=[],a=[],i=0;i<n;++i)for(var o,u=t[i],s=u.length,c=0;c<s;++c)(o=u[c])&&(r.push(e.call(o,o.__data__,c,u)),a.push(o));return new EB(r,a)},selectChild:function(e){return this.select(null==e?wj:function(e){return function(){return xj.call(this.children,e)}}("function"===typeof e?e:bj(e)))},selectChildren:function(e){return this.selectAll(null==e?_j:function(e){return function(){return kj.call(this.children,e)}}("function"===typeof e?e:bj(e)))},filter:function(e){"function"!==typeof e&&(e=function(e){return function(){return this.matches(e)}}(e));for(var t=this._groups,n=t.length,r=new Array(n),a=0;a<n;++a)for(var i,o=t[a],u=o.length,s=r[a]=[],c=0;c<u;++c)(i=o[c])&&e.call(i,i.__data__,c,o)&&s.push(i);return new EB(r,this._parents)},data:function(e,t){if(!arguments.length)return Array.from(this,Tj);var n=t?Nj:Ej,r=this._parents,a=this._groups;"function"!==typeof e&&(e=Aj(e));for(var i=a.length,o=new Array(i),u=new Array(i),s=new Array(i),c=0;c<i;++c){var l=r[c],f=a[c],d=f.length,h=Ij(e.call(l,l&&l.__data__,c,r)),p=h.length,v=u[c]=new Array(p),m=o[c]=new Array(p),g=s[c]=new Array(d);n(l,f,v,m,g,h,t);for(var y,b,x=0,w=0;x<p;++x)if(y=v[x]){for(x>=w&&(w=x+1);!(b=m[w])&&++w<p;);y._next=b||null}}return(o=new EB(o,r))._enter=u,o._exit=s,o},enter:function(){return new EB(this._enter||this._groups.map(Sj),this._parents)},exit:function(){return new EB(this._exit||this._groups.map(Sj),this._parents)},join:function(e,t,n){var r=this.enter(),a=this,i=this.exit();return"function"===typeof e?(r=e(r))&&(r=r.selection()):r=r.append(e+""),null!=t&&(a=t(a))&&(a=a.selection()),null==n?i.remove():n(i),r&&a?r.merge(a).order():a},merge:function(e){for(var t=e.selection?e.selection():e,n=this._groups,r=t._groups,a=n.length,i=r.length,o=Math.min(a,i),u=new Array(a),s=0;s<o;++s)for(var c,l=n[s],f=r[s],d=l.length,h=u[s]=new Array(d),p=0;p<d;++p)(c=l[p]||f[p])&&(h[p]=c);for(;s<a;++s)u[s]=n[s];return new EB(u,this._parents)},selection:function(){return this},order:function(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var r,a=e[t],i=a.length-1,o=a[i];--i>=0;)(r=a[i])&&(o&&4^r.compareDocumentPosition(o)&&o.parentNode.insertBefore(r,o),o=r);return this},sort:function(e){function t(t,n){return t&&n?e(t.__data__,n.__data__):!t-!n}e||(e=Dj);for(var n=this._groups,r=n.length,a=new Array(r),i=0;i<r;++i){for(var o,u=n[i],s=u.length,c=a[i]=new Array(s),l=0;l<s;++l)(o=u[l])&&(c[l]=o);c.sort(t)}return new EB(a,this._parents).order()},call:function(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this},nodes:function(){return Array.from(this)},node:function(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],a=0,i=r.length;a<i;++a){var o=r[a];if(o)return o}return null},size:function(){var e,t=0,n=(0,B.Z)(this);try{for(n.s();!(e=n.n()).done;){e.value;++t}}catch(r){n.e(r)}finally{n.f()}return t},empty:function(){return!this.node()},each:function(e){for(var t=this._groups,n=0,r=t.length;n<r;++n)for(var a,i=t[n],o=0,u=i.length;o<u;++o)(a=i[o])&&e.call(a,a.__data__,o,i);return this},attr:function(e,t){var n=Oj(e);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((null==t?n.local?jj:Rj:"function"===typeof t?n.local?Lj:Zj:n.local?zj:Bj)(n,t))},style:function(e,t,n){return arguments.length>1?this.each((null==t?Uj:"function"===typeof t?Vj:Wj)(e,t,null==n?"":n)):qj(this.node(),e)},property:function(e,t){return arguments.length>1?this.each((null==t?Gj:"function"===typeof t?Xj:Hj)(e,t)):this.node()[e]},classed:function(e,t){var n=Kj(e+"");if(arguments.length<2){for(var r=Yj(this.node()),a=-1,i=n.length;++a<i;)if(!r.contains(n[a]))return!1;return!0}return this.each(("function"===typeof t?nB:t?eB:tB)(n,t))},text:function(e){return arguments.length?this.each(null==e?rB:("function"===typeof e?iB:aB)(e)):this.node().textContent},html:function(e){return arguments.length?this.each(null==e?oB:("function"===typeof e?sB:uB)(e)):this.node().innerHTML},raise:function(){return this.each(cB)},lower:function(){return this.each(lB)},append:function(e){var t="function"===typeof e?e:hB(e);return this.select((function(){return this.appendChild(t.apply(this,arguments))}))},insert:function(e,t){var n="function"===typeof e?e:hB(e),r=null==t?pB:"function"===typeof t?t:mj(t);return this.select((function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)}))},remove:function(){return this.each(vB)},clone:function(e){return this.select(e?gB:mB)},datum:function(e){return arguments.length?this.property("__data__",e):this.node().__data__},on:function(e,t,n){var r,a,i=yB(e+""),o=i.length;if(!(arguments.length<2)){for(u=t?xB:bB,r=0;r<o;++r)this.each(u(i[r],t,n));return this}var u=this.node().__on;if(u)for(var s,c=0,l=u.length;c<l;++c)for(r=0,s=u[c];r<o;++r)if((a=i[r]).type===s.type&&a.name===s.name)return s.value},dispatch:function(e,t){return this.each(("function"===typeof t?_B:kB)(e,t))}},Symbol.iterator,CB);function TB(e){return"string"===typeof e?new EB([[document.querySelector(e)]],[document.documentElement]):new EB([[e]],AB)}function IB(e,t,n){this.k=e,this.x=t,this.y=n}IB.prototype={constructor:IB,scale:function(e){return 1===e?this:new IB(this.k*e,this.x,this.y)},translate:function(e,t){return 0===e&0===t?this:new IB(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};new IB(1,0,0);function DB(){return DB=(0,Da.Z)(E().mark((function e(t){var n,r,a,i,o,u,s,c;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(n=ii.tidy((function(){var e=t.nextTrainBatch(500);return[e.xs.reshape([500,64,64,3]),e.labels]})),r=(0,C.Z)(n,2),a=r[0],i=r[1],o=i.arraySync(),u=[],s=0;s<5;s++)u.push(o.indexOf(s));return c=ii.gather(a,u),e.abrupt("return",c);case 6:case"end":return e.stop()}}),e)}))),DB.apply(this,arguments)}function FB(){return FB=(0,Da.Z)(E().mark((function e(t,n){var r,a,i,o,u,s,c,l;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=ii.tidy((function(){var e=n.nextTrainBatch(500);return[e.xs.reshape([500,64,64,3]),e.labels]})),a=(0,C.Z)(r,2),i=a[0],o=a[1],u=t.predict(i).squeeze(),s=u.argMax(1),e.next=5,HM.metrics.confusionMatrix(o,s,5);case 5:c=e.sent,l={name:"Confusion Matrix",tab:"Confusion Matrix"},HM.render.confusionMatrix(l,{values:c,tickLabels:["church","face","fish","dog","parachute"]}),HM.visor().isOpen()||HM.visor().open(),HM.visor().setActiveTab("Confusion Matrix");case 10:case"end":return e.stop()}}),e)}))),FB.apply(this,arguments)}function MB(){return(MB=(0,Da.Z)(E().mark((function e(t){var n;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n={name:"Model Summary",tab:"Model Inspection"},HM.show.modelSummary(n,t),HM.visor().isOpen()||HM.visor().open(),HM.visor().setActiveTab("Model Inspection");case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function OB(e,t,n){var r;return(r={inputs:t.input,outputs:n.output},new gd(r)).predict(e)}function RB(e,t,n){return jB.apply(this,arguments)}function jB(){return(jB=(0,Da.Z)(E().mark((function e(t,n,r){var a,i;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=ii.tidy((function(){return ii.image.resizeNearestNeighbor(n,[r.height,r.width]).clipByValue(0,1)})),(i=t.querySelector("canvas")||document.createElement("canvas")).width=r.width,i.height=r.height,i.style="margin: 4px; width:".concat(r.width,"px; height:").concat(r.height,"px"),t.appendChild(i),e.next=8,ii.browser.toPixels(a,i);case 8:a.dispose();case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function BB(e,t,n){var r=TB(e).select("table");0===r.size()&&((r=TB(e).append("table")).append("thead").append("tr"),r.append("tbody"));var a=r.select("thead").select("tr").selectAll("th").data(t),i=a.enter().append("th");a.merge(i).each((function(e,t,n){var r=n[t];"string"==typeof e?r.innerHTML=e:RB(r,e,{width:25,height:25})}));var o=r.select("tbody").selectAll("tr").data(n),u=o.enter().append("tr"),s=o.merge(u).selectAll("td").data((function(e){return e})),c=s.enter().append("td");s.merge(c).each((function(e,t,n){RB(n[t],e,{width:40,height:40})})),s.exit().remove(),o.exit().remove()}function zB(e,t,n){var r=e.getLayer(n),a=ii.tidy((function(){return r.kernel.val.transpose([3,0,1,2]).unstack()}));a[0].shape[2]>3&&(a=a.map((function(e,t){return"Filter ".concat(t+1)}))),a.unshift("Input");var i=ii.tidy((function(){return OB(t,e,r).unstack()})),o=i[0].shape[0],u=i[0].shape[2],s=i.map((function(e,n){var r=Array(u).fill(0).map((function(t,n){return e.slice([0,0,n],[o,o,1])})),a=ii.tidy((function(){return t.slice([n],[1]).reshape([64,64,3])}));return r.unshift(a),r}));return{filters:a,filterActivations:s}}function ZB(e,t,n){return LB.apply(this,arguments)}function LB(){return(LB=(0,Da.Z)(E().mark((function e(t,n,r){var a,i,o,u,s;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=HM.visor().surface({name:r+" Activations",tab:"Activations"}),i=a.drawArea,o=zB(t,n,r),u=o.filters,s=o.filterActivations,BB(i,u,s),HM.visor().isOpen()||HM.visor().open(),HM.visor().setActiveTab("Activations");case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function PB(){return PB=(0,Da.Z)(E().mark((function e(t,n,r){var a,i,o,u;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(a=HM.visor().surface({name:r+" Activations",tab:"Activations"}),a.drawArea.innerHTML="",64,i=OB(n,t,t.getLayer(r)),o=function(e){var t=i.slice([e],[1]),r=n.slice([e],[1]).reshape([64,64,3]),o=document.createElement("div");o.innerHTML='<span class="image"></span><span class="chart"></span>',a.drawArea.appendChild(o);var u=o.querySelector(".image"),s=o.querySelector(".chart"),c=["church","dog","face","fish","parachute"],l=Array.from(t.dataSync()).map((function(e,t){return{index:c[t],value:e}}));RB(u,r,{width:50,height:50}),HM.render.barchart(s,l,{width:375,height:120})},u=0;u<5;u++)o(u);HM.visor().isOpen()||HM.visor().open(),HM.visor().setActiveTab("Activations");case 9:case"end":return e.stop()}}),e)}))),PB.apply(this,arguments)}IB.prototype;var UB,WB=function(e){var t=e.classifier,n=e.dataset,r=(0,k.useState)([]),a=(0,C.Z)(r,2),i=a[0],o=a[1],u=(0,k.useState)(void 0),s=(0,C.Z)(u,2),c=s[0],l=s[1];return(0,k.useEffect)((function(){if(t){for(var e=1;e<=5;e++)document.getElementById("conv"+e.toString()+"-act").style.display="none";document.getElementById("dense-act").style.display="none",function(e){return DB.apply(this,arguments)}(n).then((function(e){return l(e)}));for(var r=[],a=0;a<t.layers.length;a++){var i=t.layers[a].name;i.startsWith("conv")&&(r.push(i),document.getElementById("conv"+r.length.toString()+"-act").style.display="block")}r.push(t.layers[t.layers.length-1].name),o(r),document.getElementById("model-params").disabled=!1,document.getElementById("conf-matrix").disabled=!1,document.getElementById("dense-act").style.display="block"}else document.getElementById("model-params").disabled=!0,document.getElementById("conf-matrix").disabled=!0}),[t,n,i.length]),(0,rt.jsxs)("div",{style:{marginBottom:50},children:[(0,rt.jsx)("h2",{className:"display-6",children:"Model Explainability"}),(0,rt.jsxs)("div",{className:"container-sm",style:{marginTop:50,maxWidth:800},children:[(0,rt.jsxs)("div",{style:{textAlign:"justify"},children:["We've trained a model, and maybe it performs decently well. But what exactly has it learned? How \"good\" is it? Can we try to interpret the decisions/predictions that the model makes? We'll try to answer these in this section!",(0,rt.jsx)("br",{}),(0,rt.jsx)("br",{})]}),(0,rt.jsx)("h4",{className:"display-8",children:"Model Parameters"}),(0,rt.jsxs)("div",{style:{textAlign:"justify"},children:["Model size, especially ",(0,rt.jsx)("a",{href:"https://arxiv.org/pdf/1409.4842.pdf",children:"model depth"}),", has a huge impact on model performance. This is because more parameters are at the model's disposal for learning useful information from the dataset. However, training huge models with millions or billions of parameters requires access to a large number of GPUs and compute power, often accessible to large corporations only. ",(0,rt.jsx)("a",{href:"https://www.unesco.org/en/artificial-intelligence",children:"UNESCO"}),' stresses on assessing AI technologies "against their impacts on sustainability, understood as a set of constantly evolving goals including those set out in the UN\'s Sustainable Development Goals". Click on the button below to see the number of parameters in every layer of the model you trained above.',(0,rt.jsx)("br",{}),(0,rt.jsx)("br",{}),(0,rt.jsx)("button",{id:"model-params",className:"random-img-gen",onClick:function(){return function(e){return MB.apply(this,arguments)}(t)},children:"Model Summary"})]}),(0,rt.jsx)("h4",{className:"display-8",children:"Confusion Matrix"}),(0,rt.jsxs)("div",{style:{textAlign:"justify"},children:['A confusion matrix is a square matrix that quantifies how "confused" the model gets on various classes. Each row represents the number of images belonging to an actual category, whereas each column represents the number of images belonging to a category predicted by the model. For example, the "face" row and "dog" column denotes the number of images that belong to the "face" category but the model predicted as belonging to the "dog" category. Stop and think about why having large numbers along the main diagonal of the matrix makes sense! Is there a category the model gets most confused on? And why might that be now that you know the dataset it was trained on?',(0,rt.jsx)("br",{}),(0,rt.jsx)("br",{}),(0,rt.jsx)("button",{id:"conf-matrix",className:"random-img-gen",onClick:function(){return function(e,t){return FB.apply(this,arguments)}(t,n)},children:"Confusion Matrix"})]}),(0,rt.jsx)("h4",{className:"display-8",children:"Model Activations"}),(0,rt.jsxs)("div",{style:{textAlign:"justify"},children:['Similar to how neurons in the brain get excited/activated by certain stimuli, units in the convolutional layers of our model also get activated by different parts of an image, capturing various information from them. We can visualize the activations of the units in these different convolutional layers and try to make sense of what the model might be doing "behind-the-scene".',(0,rt.jsx)("br",{}),(0,rt.jsx)("br",{})," As a reference, below visualized are the filters and activations of the first convolutional layer of AlexNet that has been trained on the entire 1000 classes of ImageNet for hundreds of epochs. How do the filters and activations differ from the filters we saw when we learned about convolutions above?",(0,rt.jsx)("br",{}),(0,rt.jsx)("br",{}),(0,rt.jsx)(ai,{src:"activations.png",className:"img-fluid",alt:"activations and filters"}),(0,rt.jsx)("br",{}),(0,rt.jsx)("br",{}),(0,rt.jsx)("button",{id:"conv1-act",className:"random-img-gen",onClick:function(){return ZB(t,c,i[0])},style:{display:"none",marginBottom:5},children:"Convolutional Layer #1"}),(0,rt.jsx)("button",{id:"conv2-act",className:"random-img-gen",onClick:function(){return ZB(t,c,i[1])},style:{display:"none",marginBottom:5},children:"Convolutional Layer #2"}),(0,rt.jsx)("button",{id:"conv3-act",className:"random-img-gen",onClick:function(){return ZB(t,c,i[2])},style:{display:"none",marginBottom:5},children:"Convolutional Layer #3"}),(0,rt.jsx)("button",{id:"conv4-act",className:"random-img-gen",onClick:function(){return ZB(t,c,i[3])},style:{display:"none",marginBottom:5},children:"Convolutional Layer #4"}),(0,rt.jsx)("button",{id:"conv5-act",className:"random-img-gen",onClick:function(){return ZB(t,c,i[4])},style:{display:"none",marginBottom:5},children:"Convolutional Layer #5"}),(0,rt.jsx)("button",{id:"dense-act",className:"random-img-gen",onClick:function(){return function(e,t,n){return PB.apply(this,arguments)}(t,c,i[i.length-1])},style:{display:"none"},children:"Final Dense Layer"})]})]})]})},VB=function(){var e=(0,k.useState)(!1),t=(0,C.Z)(e,2),n=t[0],r=t[1],a=(0,k.useState)(void 0),i=(0,C.Z)(a,2),o=i[0],u=i[1];return(0,k.useEffect)((function(){window.scrollTo(0,0)}),[]),(0,rt.jsxs)("div",{className:"container-sm",style:{maxWidth:1e3},children:[(0,rt.jsxs)("div",{className:"frame",style:{backgroundColor:"#ffddc1",justifyContent:"center"},children:[(0,rt.jsxs)("h1",{className:"display-4",children:["Image Classification Using",(0,rt.jsx)("br",{}),"Convolutional Neural Networks"]}),(0,rt.jsxs)("div",{className:"container-sm",style:{marginTop:50,maxWidth:800,textAlign:"justify"},children:['The task of Image Classification is concerned with categorizing (labelling) images into different classes based on what those images depict. For example, an image of a cat would be classified as belonging to the "cat" class. Convolutional Neural Networks (CNNs) are a family of neural networks that leverage the powerful spatial structure present in images. This spatial structure can comprise of the ',(0,rt.jsx)("a",{href:"https://d2l.ai/chapter_convolutional-neural-networks/why-conv.html",children:"observations"})," that:",(0,rt.jsx)("div",{className:"container-sm",style:{justifyContent:"center",display:"flex"},children:(0,rt.jsxs)("ul",{children:[(0,rt.jsxs)("li",{children:[(0,rt.jsx)("span",{className:"emph",children:"Translational Invariance"}),": A cat at different locations in an image, like sleeping on the floor or jumping over a fence, are all images of cats."]}),(0,rt.jsxs)("li",{children:[(0,rt.jsx)("span",{className:"emph",children:"Locality"}),": A pixel representing the sky is likely to be surrounded by pixels that also represent the sky."]}),(0,rt.jsxs)("li",{children:[(0,rt.jsx)("span",{className:"emph",children:"Composition"}),": Objects in images are composed of parts, like a face is composed of eyes, a nose, lips, ears, etc."]})]})})]}),(0,rt.jsx)("hr",{style:{margin:"30px 20px"}}),(0,rt.jsx)(Ia,{}),(0,rt.jsx)("hr",{style:{margin:"30px 20px"}}),(0,rt.jsx)(ti,{}),(0,rt.jsx)("hr",{style:{margin:"30px 20px"}}),(0,rt.jsx)(dO,{setClassifier:u,setDataset:r}),(0,rt.jsx)("hr",{style:{margin:"30px 20px"}}),(0,rt.jsx)(WB,{classifier:o,dataset:n}),(0,rt.jsx)("hr",{style:{margin:"30px 20px"}}),(0,rt.jsx)(KO,{classifier:o}),(0,rt.jsx)("hr",{style:{margin:"30px 20px"}}),(0,rt.jsx)("div",{className:"container-sm",style:{maxWidth:750,textAlign:"justify"}})]}),(0,rt.jsx)("hr",{style:{margin:0},className:"border border-2 "})]})},qB=function(){return(0,rt.jsxs)("div",{style:{marginBottom:50},children:[(0,rt.jsx)("h2",{className:"display-6",children:"What Are Multimodal Models?"}),(0,rt.jsx)("div",{className:"container-sm",style:{marginTop:50,maxWidth:800},children:(0,rt.jsxs)("div",{style:{textAlign:"justify"},children:["Traditional machine learning models typically work with one type of data at a time. An image classifier processes only images, while a text classifier processes only text. But humans naturally integrate information from multiple sources - we see, hear, read, and touch simultaneously to understand the world around us.",(0,rt.jsx)("br",{}),(0,rt.jsx)("br",{}),(0,rt.jsx)("span",{className:"emph",children:"Multimodal models"})," aim to replicate this ability by learning from multiple types of data together. One of the most influential multimodal architectures is ",(0,rt.jsx)("a",{href:"https://arxiv.org/abs/2103.00020",children:"CLIP (Contrastive Language-Image Pre-training)"}),", developed by OpenAI in 2021. CLIP learns to understand images and text in a unified way by training on 400 million (image, text) pairs from the internet.",(0,rt.jsx)("br",{}),(0,rt.jsx)("br",{}),(0,rt.jsx)("h4",{className:"display-8",children:"How CLIP Works"}),"CLIP uses a clever training approach called ",(0,rt.jsx)("span",{className:"emph",children:"contrastive learning"}),":",(0,rt.jsx)("div",{className:"container-sm",style:{justifyContent:"center",display:"flex"},children:(0,rt.jsxs)("ul",{children:[(0,rt.jsx)("li",{children:'It takes a batch of image-text pairs (e.g., an image of a dog with the caption "a golden retriever playing in a park")'}),(0,rt.jsx)("li",{children:"It encodes the image through an image encoder (like a ResNet or Vision Transformer)"}),(0,rt.jsx)("li",{children:"It encodes the text through a text encoder (like a Transformer)"}),(0,rt.jsx)("li",{children:"It learns to make matching pairs have similar embeddings (close together in space)"}),(0,rt.jsx)("li",{children:"It learns to make non-matching pairs have different embeddings (far apart in space)"})]})}),(0,rt.jsx)("br",{}),(0,rt.jsx)("h4",{className:"display-8",children:"Why This Matters"}),"Once trained, CLIP can perform ",(0,rt.jsx)("span",{className:"emph",children:"zero-shot classification"}),' - it can recognize new categories it has never explicitly been trained on, just by comparing an image to text descriptions. For example, if you want to detect "unicorns" in images, you don\'t need to retrain the model with unicorn images. You simply provide the text "a unicorn" and CLIP can find images that match this description!',(0,rt.jsx)("br",{}),(0,rt.jsx)("br",{}),"This capability has profound implications for ",(0,rt.jsx)("a",{href:"https://www.unesco.org/en/artificial-intelligence",children:"accessibility"}),", enabling applications like:",(0,rt.jsxs)("ul",{children:[(0,rt.jsx)("li",{children:"Helping visually impaired users understand image content through text descriptions"}),(0,rt.jsx)("li",{children:"Searching large image databases using natural language queries"}),(0,rt.jsx)("li",{children:"Content moderation and safety systems that work across languages"}),(0,rt.jsx)("li",{children:"Educational tools that can explain visual concepts"})]}),(0,rt.jsx)("br",{}),(0,rt.jsx)("h4",{className:"display-8",children:"Ethical Considerations"}),"As with any AI system, multimodal models raise important ethical questions:",(0,rt.jsxs)("ul",{children:[(0,rt.jsxs)("li",{children:[(0,rt.jsx)("span",{className:"emph",children:"Bias"}),": Models trained on internet data can reflect societal biases present in captions and descriptions. For example, certain professions might be stereotypically associated with specific genders or ethnicities."]}),(0,rt.jsxs)("li",{children:[(0,rt.jsx)("span",{className:"emph",children:"Privacy"}),": Models that can search through images using text make it easier to find specific people or locations, raising surveillance concerns."]}),(0,rt.jsxs)("li",{children:[(0,rt.jsx)("span",{className:"emph",children:"Misinformation"}),": The ability to match images with text can be misused to spread false narratives or deepfakes."]}),(0,rt.jsxs)("li",{children:[(0,rt.jsx)("span",{className:"emph",children:"Environmental Impact"}),": Training large multimodal models requires significant computational resources and energy."]})]}),"Understanding how these models work is the first step toward using them responsibly and addressing these concerns."]})})]})},GB=function(){var e=(0,k.useRef)(),t=(0,k.useState)("separate"),n=(0,C.Z)(t,2),r=n[0],a=n[1];(0,k.useEffect)((function(){i(r)}),[r]);var i=function(t){TB(e.current).selectAll("*").remove();var n,r=400,a=TB(e.current).attr("width",700).attr("height",r);n="separate"===t?[].concat([{x:100,y:100,label:"\ud83d\udc15 Dog Image",type:"image",category:"dog"},{x:120,y:110,label:"\ud83d\udc15 Another Dog",type:"image",category:"dog"},{x:400,y:300,label:"\ud83d\udc31 Cat Image",type:"image",category:"cat"},{x:420,y:310,label:"\ud83d\udc31 Another Cat",type:"image",category:"cat"},{x:250,y:200,label:"\ud83d\ude97 Car Image",type:"image",category:"car"},{x:270,y:210,label:"\ud83d\ude97 Another Car",type:"image",category:"car"}],[{x:500,y:100,label:'"a dog"',type:"text",category:"dog"},{x:510,y:90,label:'"puppy"',type:"text",category:"dog"},{x:200,y:300,label:'"a cat"',type:"text",category:"cat"},{x:190,y:310,label:'"kitten"',type:"text",category:"cat"},{x:350,y:80,label:'"a car"',type:"text",category:"car"},{x:360,y:90,label:'"vehicle"',type:"text",category:"car"}]):[].concat([{x:140,y:145,label:"\ud83d\udc15 Dog Image",type:"image",category:"dog"},{x:165,y:165,label:"\ud83d\udc15 Another Dog",type:"image",category:"dog"},{x:440,y:245,label:"\ud83d\udc31 Cat Image",type:"image",category:"cat"},{x:465,y:270,label:"\ud83d\udc31 Another Cat",type:"image",category:"cat"},{x:285,y:95,label:"\ud83d\ude97 Car Image",type:"image",category:"car"},{x:310,y:120,label:"\ud83d\ude97 Another Car",type:"image",category:"car"}],[{x:185,y:100,label:'"a dog"',type:"text",category:"dog"},{x:200,y:170,label:'"puppy"',type:"text",category:"dog"},{x:485,y:205,label:'"a cat"',type:"text",category:"cat"},{x:495,y:280,label:'"kitten"',type:"text",category:"cat"},{x:335,y:55,label:'"a car"',type:"text",category:"car"},{x:345,y:125,label:'"vehicle"',type:"text",category:"car"}]),a.append("text").attr("x",350).attr("y",20).attr("text-anchor","middle").style("font-size","16px").style("font-weight","bold").text("separate"===t?"Before Training: Separate Spaces":"After Training: Shared Embedding Space");var i={dog:"#ff6b6b",cat:"#4ecdc4",car:"#45b7d1"};if("aligned"===t){a.selectAll(".cluster").data([{x:180,y:152,r:50,category:"dog"},{x:475,y:255,r:50,category:"cat"},{x:325,y:105,r:50,category:"car"}]).enter().append("circle").attr("cx",(function(e){return e.x})).attr("cy",(function(e){return e.y})).attr("r",(function(e){return e.r})).attr("fill",(function(e){return i[e.category]})).attr("opacity",.1).attr("stroke",(function(e){return i[e.category]})).attr("stroke-width",2).attr("stroke-dasharray","5,5")}var o=a.selectAll(".point").data(n).enter().append("g").attr("class","point").attr("transform",(function(e){var n="aligned"===t&&"text"===e.type?12:0;return"translate(".concat(e.x,", ").concat(e.y+n,")")}));o.append("circle").attr("r",8).attr("fill",(function(e){return"image"===e.type?"#6c5ce7":"#fd79a8"})).attr("stroke",(function(e){return i[e.category]})).attr("stroke-width",2).style("cursor","pointer"),o.append("text").attr("dx",(function(e){return"aligned"===t?14:12})).attr("dy",(function(e){return"aligned"===t?"image"===e.type?4:10:4})).text((function(e){return e.label})).style("font-size","12px").style("fill","#333");var u=a.append("g").attr("transform","translate(20, ".concat(340,")"));u.append("circle").attr("cx",0).attr("cy",0).attr("r",6).attr("fill","#6c5ce7"),u.append("text").attr("x",12).attr("y",4).text("Image Embedding").style("font-size","12px"),u.append("circle").attr("cx",0).attr("cy",20).attr("r",6).attr("fill","#fd79a8"),u.append("text").attr("x",12).attr("y",24).text("Text Embedding").style("font-size","12px"),a.append("text").attr("x",350).attr("y",395).attr("text-anchor","middle").style("font-size","12px").style("font-style","italic").text("Embedding Dimension 1"),a.append("text").attr("transform","rotate(-90)").attr("x",-200).attr("y",15).attr("text-anchor","middle").style("font-size","12px").style("font-style","italic").text("Embedding Dimension 2")};return(0,rt.jsxs)("div",{style:{marginBottom:50},children:[(0,rt.jsx)("h2",{className:"display-6",children:"Understanding Embeddings"}),(0,rt.jsxs)("div",{className:"container-sm",style:{marginTop:50,maxWidth:800},children:[(0,rt.jsxs)("div",{style:{textAlign:"justify"},children:[(0,rt.jsx)("h4",{className:"display-8",children:"What are Embeddings?"}),"An ",(0,rt.jsx)("span",{className:"emph",children:"embedding"})," is a way of representing data (like images or text) as points in a high-dimensional space. Think of it like plotting words or images on a graph where similar items are close together and different items are far apart. In practice, these embeddings typically have hundreds or thousands of dimensions, but we can visualize them in 2D or 3D for understanding.",(0,rt.jsx)("br",{}),(0,rt.jsx)("br",{}),(0,rt.jsx)("h4",{className:"display-8",children:"From Separate to Shared Spaces"}),"Before training, images and text exist in completely separate spaces - there's no way to compare them directly. Multimodal models learn to map both modalities into a ",(0,rt.jsx)("span",{className:"emph",children:"shared embedding space"})," where:",(0,rt.jsxs)("ul",{children:[(0,rt.jsx)("li",{children:'Images of dogs and the text "dog" end up close together'}),(0,rt.jsx)("li",{children:'Images of cats and the text "cat" cluster in their own region'}),(0,rt.jsx)("li",{children:"Similar concepts (whether expressed as images or text) are nearby"})]}),"This alignment is what enables the model to understand relationships between vision and language!",(0,rt.jsx)("br",{}),(0,rt.jsx)("br",{})]}),(0,rt.jsx)("div",{style:{display:"flex",justifyContent:"center",marginBottom:20},children:(0,rt.jsxs)(Qa,{children:[(0,rt.jsx)(Oa,{variant:"separate"===r?"primary":"secondary",onClick:function(){return a("separate")},children:"Before Training"}),(0,rt.jsx)(Oa,{variant:"aligned"===r?"primary":"secondary",onClick:function(){return a("aligned")},children:"After Training"})]})}),(0,rt.jsx)("div",{style:{display:"flex",justifyContent:"center",marginBottom:20},children:(0,rt.jsx)("svg",{ref:e})}),(0,rt.jsxs)("div",{style:{textAlign:"justify"},children:[(0,rt.jsx)("h4",{className:"display-8",children:"How Alignment Happens"}),"During training, the model learns through ",(0,rt.jsx)("span",{className:"emph",children:"contrastive loss"}),":",(0,rt.jsxs)("ul",{children:[(0,rt.jsxs)("li",{children:[(0,rt.jsx)("span",{className:"emph",children:"Positive pairs"})," (matching image-text pairs) are pulled closer together"]}),(0,rt.jsxs)("li",{children:[(0,rt.jsx)("span",{className:"emph",children:"Negative pairs"})," (non-matching pairs) are pushed further apart"]}),(0,rt.jsx)("li",{children:"Over millions of examples, the model learns a shared representation where semantically similar concepts cluster together regardless of modality"})]}),'This is why a trained multimodal model can match "a photo of a golden retriever" with an actual photo of a golden retriever - they\'ve learned to occupy nearby positions in the embedding space!']})]})]})},HB=["className","bsPrefix","as"],XB=(UB="h4",k.forwardRef((function(e,t){return(0,rt.jsx)("div",ut(ut({},e),{},{ref:t,className:ft()(e.className,UB)}))})));XB.displayName="DivStyledAsH4";var KB=k.forwardRef((function(e,t){var n=e.className,r=e.bsPrefix,a=e.as,i=void 0===a?XB:a,o=ct(e,HB);return r=wt(r,"alert-heading"),(0,rt.jsx)(i,ut({ref:t,className:ft()(n,r)},o))}));KB.displayName="AlertHeading";var YB=KB,$B=["className","bsPrefix","as"],QB=k.forwardRef((function(e,t){var n=e.className,r=e.bsPrefix,a=e.as,i=void 0===a?kr:a,o=ct(e,$B);return r=wt(r,"alert-link"),(0,rt.jsx)(i,ut({ref:t,className:ft()(n,r)},o))}));QB.displayName="AlertLink";var JB=QB,ez=["className","variant","aria-label"],tz={"aria-label":ht().string,onClick:ht().func,variant:ht().oneOf(["white"])},nz=k.forwardRef((function(e,t){var n=e.className,r=e.variant,a=e["aria-label"],i=void 0===a?"Close":a,o=ct(e,ez);return(0,rt.jsx)("button",ut({ref:t,type:"button",className:ft()("btn-close",r&&"btn-close-".concat(r),n),"aria-label":i},o))}));nz.displayName="CloseButton",nz.propTypes=tz;var rz=nz,az=["bsPrefix","show","closeLabel","closeVariant","className","children","variant","onClose","dismissible","transition"],iz=k.forwardRef((function(e,t){var n=yn(e,{show:"onClose"}),r=n.bsPrefix,a=n.show,i=void 0===a||a,o=n.closeLabel,u=void 0===o?"Close alert":o,s=n.closeVariant,c=n.className,l=n.children,f=n.variant,d=void 0===f?"primary":f,h=n.onClose,p=n.dismissible,v=n.transition,m=void 0===v?ha:v,g=ct(n,az),y=wt(r,"alert"),b=Bn((function(e){h&&h(!1,e)})),x=!0===m?ha:m,w=(0,rt.jsxs)("div",ut(ut({role:"alert"},x?void 0:g),{},{ref:t,className:ft()(c,y,d&&"".concat(y,"-").concat(d),p&&"".concat(y,"-dismissible")),children:[p&&(0,rt.jsx)(rz,{onClick:b,"aria-label":u,variant:s}),l]}));return x?(0,rt.jsx)(x,ut(ut({unmountOnExit:!0},g),{},{ref:void 0,in:i,children:w})):i?w:null}));iz.displayName="Alert";var oz=Object.assign(iz,{Link:JB,Heading:YB}),uz=function(){function e(){(0,D.Z)(this,e)}return(0,F.Z)(e,[{key:"classify",value:function(){var e=(0,Da.Z)(E().mark((function e(t){var n,r=arguments;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.length>1&&void 0!==r[1]?r[1]:5,e.abrupt("return",[{className:"dog",probability:.8},{className:"cat",probability:.6},{className:"car",probability:.4},{className:"bird",probability:.2},{className:"fish",probability:.1}].slice(0,n));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"infer",value:function(e,t){if(t){var n=Array.from({length:1e3},(function(e,t){return.05*(Math.sin(t)+1)}));return ii.tensor1d(n)}return ii.tensor2d([[.8,.6,.4,.2,.1]])}}]),e}();function sz(){return cz.apply(this,arguments)}function cz(){return(cz=(0,Da.Z)(E().mark((function e(){return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Promise((function(e){return setTimeout(e,300)}));case 2:return e.abrupt("return",new uz);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function lz(e){var t=e.toLowerCase().trim(),n={dog:[1,0,0,0,0],puppy:[.9,.1,0,0,0],cat:[0,1,0,0,0],kitten:[0,.9,.1,0,0],car:[0,0,1,0,0],vehicle:[0,0,.9,.1,0],automobile:[0,0,.8,.2,0],bird:[0,0,0,1,0],fish:[0,0,0,0,1],animal:[.3,.3,0,.2,.2]},r=[0,0,0,0,0],a=t.split(/\s+/),i=0;if(a.forEach((function(e){if(n[e]){i++;for(var t=0;t<5;t++)r[t]+=n[e][t]}})),i>0){var o=Math.sqrt(r.reduce((function(e,t){return e+t*t}),0));o>0&&(r=r.map((function(e){return e/o})))}else{r=Array(5).fill(0).map((function(){return.3*Math.random()}));var u=Math.sqrt(r.reduce((function(e,t){return e+t*t}),0));r=r.map((function(e){return e/u}))}return r}function fz(e,t){if(e.length!==t.length)throw new Error("Vectors must have same length");for(var n=0,r=0,a=0,i=0;i<e.length;i++)n+=e[i]*t[i],r+=e[i]*e[i],a+=t[i]*t[i];return r=Math.sqrt(r),a=Math.sqrt(a),0===r||0===a?0:n/(r*a)}function dz(e,t){return hz.apply(this,arguments)}function hz(){return(hz=(0,Da.Z)(E().mark((function e(t,n){return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",ii.tidy((function(){var e=ii.browser.fromPixels(n).toFloat().div(127.5).sub(1).expandDims(0);return t.infer(e,!0).squeeze().arraySync()})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function pz(e){var t=Array.from({length:59},(function(e,t){return t+7})),n=[0,0,0,0,0];[151,152,153,154,155,156,157,158,159,160].forEach((function(t){return n[0]+=e[t]})),[281,282,283,284,285].forEach((function(t){return n[1]+=e[t]})),[436,511,609,627,656,661,751,817].forEach((function(t){return n[2]+=e[t]})),t.forEach((function(t){return n[3]+=e[t]})),[0,1,389,390,391,392,393,394,395,396].forEach((function(t){return n[4]+=e[t]}));var r=Math.sqrt(n.reduce((function(e,t){return e+t*t}),0));return r>0?n.map((function(e){return e/r})):n}function vz(e,t,n){return mz.apply(this,arguments)}function mz(){return mz=(0,Da.Z)(E().mark((function e(t,n,r){var a,i,o,u,s,c;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,dz(t,n);case 2:return a=e.sent,i=pz(a),(o=r.map((function(e){var t=lz(e);return{text:e,score:fz(i,t)}}))).sort((function(e,t){return t.score-e.score})),u=Math.max.apply(Math,(0,I.Z)(o.map((function(e){return e.score})))),s=o.map((function(e){return Math.exp(5*(e.score-u))})),c=s.reduce((function(e,t){return e+t}),0),o.forEach((function(e,t){e.score=s[t]/c})),e.abrupt("return",o);case 11:case"end":return e.stop()}}),e)}))),mz.apply(this,arguments)}var gz=function(e){var t=e.setModel,n=(0,k.useState)(void 0),r=(0,C.Z)(n,2),a=r[0],i=r[1],o=(0,k.useState)(null),u=(0,C.Z)(o,2),s=u[0],c=u[1],l=(0,k.useState)(["a dog","a cat","a car"]),f=(0,C.Z)(l,2),d=f[0],h=f[1],p=(0,k.useState)(null),v=(0,C.Z)(p,2),m=v[0],g=v[1],y=(0,k.useState)(!1),b=(0,C.Z)(y,2),x=b[0],w=b[1];(0,k.useEffect)((function(){a&&t(a)}),[a,t]);var _=(0,k.useState)(!1),S=(0,C.Z)(_,2),A=S[0],N=S[1];function T(){return T=(0,Da.Z)(E().mark((function e(){var t;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return N(!0),e.prev=1,e.next=4,sz();case 4:t=e.sent,i(t),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(1),console.error("Error loading model:",e.t0),alert("Failed to load model. Please try again.");case 12:return e.prev=12,N(!1),e.finish(12);case 15:case"end":return e.stop()}}),e,null,[[1,8,12,15]])}))),T.apply(this,arguments)}function D(){return(D=(0,Da.Z)(E().mark((function e(){var t,n;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s&&a){e.next=3;break}return alert("Please load the model and upload an image first!"),e.abrupt("return");case 3:if(0!==(t=d.filter((function(e){return""!==e.trim()}))).length){e.next=7;break}return alert("Please enter at least one text description!"),e.abrupt("return");case 7:return w(!0),g(null),e.prev=9,e.next=12,vz(a,s,t);case 12:n=e.sent,g(n),e.next=20;break;case 16:e.prev=16,e.t0=e.catch(9),console.error("Error computing similarities:",e.t0),alert("Failed to compute similarities. Please try again.");case 20:w(!1);case 21:case"end":return e.stop()}}),e,null,[[9,16]])})))).apply(this,arguments)}return(0,rt.jsxs)("div",{style:{marginBottom:50},children:[(0,rt.jsx)("h2",{className:"display-6",children:"Interactive Image-Text Matching"}),(0,rt.jsxs)("div",{className:"container-sm",style:{marginTop:50,maxWidth:800},children:[(0,rt.jsxs)("div",{style:{textAlign:"justify"},children:["Now let's try it ourselves! In this simplified demo, we'll use a pre-trained image model to extract image features. While a full CLIP model would have separate encoders for both images and text trained together, this demo will help you understand the core concept of matching images with text descriptions.",(0,rt.jsx)("br",{}),(0,rt.jsx)("br",{}),(0,rt.jsxs)(oz,{variant:"info",children:[(0,rt.jsx)("strong",{children:"Note:"})," This is a simplified demonstration. A true multimodal model like CLIP would encode both images and text into the same embedding space. Here, we're using a pre-trained image classifier to demonstrate the concept of similarity matching between modalities."]})]}),(0,rt.jsxs)("div",{style:{marginTop:30},children:[(0,rt.jsx)("h4",{className:"display-8",children:"Step 1: Load the Model"}),(0,rt.jsx)(Oa,{id:"load-model-btn",onClick:function(){return T.apply(this,arguments)},style:{marginRight:10},disabled:A||!!a,children:"Load Image Model"}),A&&(0,rt.jsx)(Ba,{id:"load-spinner",animation:"border",size:"sm"})]}),(0,rt.jsxs)("div",{style:{marginTop:30},children:[(0,rt.jsx)("h4",{className:"display-8",children:"Step 2: Upload an Image"}),(0,rt.jsx)("input",{id:"upload-image-btn",type:"file",accept:"image/*",onChange:function(e){var t=e.target.files[0];if(t){var n=new FileReader;n.onload=function(e){var t=new Image;t.onload=function(){var e=document.getElementById("uploaded-canvas"),n=e.getContext("2d");e.width=224,e.height=224,n.drawImage(t,0,0,224,224),c(e),document.getElementById("uploaded-canvas").style.display="block"},t.src=e.target.result},n.readAsDataURL(t),g(null)}},disabled:!a,style:{marginBottom:20}}),(0,rt.jsx)("div",{style:{display:"flex",justifyContent:"center"},children:(0,rt.jsx)("canvas",{id:"uploaded-canvas",style:{display:"none",border:"2px solid #ddd",borderRadius:"8px"}})})]}),(0,rt.jsxs)("div",{style:{marginTop:30},children:[(0,rt.jsx)("h4",{className:"display-8",children:"Step 3: Enter Text Descriptions"}),(0,rt.jsx)("div",{style:{textAlign:"justify",marginBottom:15},children:"Enter different text descriptions that might match your image. The model will compute how well each description matches the image!"}),d.map((function(e,t){return(0,rt.jsxs)("div",{style:{display:"flex",marginBottom:10,alignItems:"center"},children:[(0,rt.jsx)(pn.Control,{type:"text",value:e,onChange:function(e){return function(e,t){var n=(0,I.Z)(d);n[e]=t,h(n)}(t,e.target.value)},placeholder:"Text description ".concat(t+1),style:{marginRight:10}}),d.length>2&&(0,rt.jsx)(Oa,{variant:"danger",size:"sm",onClick:function(){return function(e){if(d.length>2){var t=d.filter((function(t,n){return n!==e}));h(t)}}(t)},children:"Remove"})]},t)})),d.length<6&&(0,rt.jsx)(Oa,{variant:"secondary",size:"sm",onClick:function(){d.length<6&&h([].concat((0,I.Z)(d),[""]))},style:{marginTop:10},children:"Add Another Description"})]}),(0,rt.jsxs)("div",{style:{marginTop:30},children:[(0,rt.jsx)("h4",{className:"display-8",children:"Step 4: Compute Matches"}),(0,rt.jsx)(Oa,{id:"match-btn",variant:"primary",onClick:function(){return D.apply(this,arguments)},disabled:!a||!s||x,style:{marginRight:10},children:"Find Best Match!"}),x&&(0,rt.jsx)(Ba,{animation:"border",size:"sm"})]}),m&&(0,rt.jsxs)("div",{style:{marginTop:30},children:[(0,rt.jsx)("h4",{className:"display-8",children:"Results: Similarity Scores"}),(0,rt.jsx)("div",{style:{textAlign:"justify",marginBottom:15},children:"Higher scores indicate better matches between the image and text description. The scores are computed based on how similar the image features are to the concepts in the text."}),(0,rt.jsx)("div",{style:{backgroundColor:"#f8f9fa",padding:20,borderRadius:8},children:m.map((function(e,t){return(0,rt.jsxs)("div",{style:{marginBottom:15,padding:15,backgroundColor:0===t?"#d4edda":"white",borderRadius:5,border:0===t?"2px solid #28a745":"1px solid #dee2e6"},children:[(0,rt.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,rt.jsxs)("div",{children:[(0,rt.jsx)("strong",{children:e.text}),0===t&&(0,rt.jsx)("span",{style:{marginLeft:10,color:"#28a745"},children:"\u2713 Best Match!"})]}),(0,rt.jsxs)("div",{style:{fontSize:"18px",fontWeight:"bold",color:0===t?"#28a745":"#333"},children:[(100*e.score).toFixed(1),"%"]})]}),(0,rt.jsx)("div",{style:{marginTop:10},children:(0,rt.jsx)("div",{style:{width:"100%",height:"20px",backgroundColor:"#e9ecef",borderRadius:"10px",overflow:"hidden"},children:(0,rt.jsx)("div",{style:{width:"".concat(100*e.score,"%"),height:"100%",backgroundColor:0===t?"#28a745":"#007bff",transition:"width 0.5s ease"}})})})]},t)}))})]}),(0,rt.jsxs)("div",{style:{textAlign:"justify",marginTop:30},children:[(0,rt.jsx)("h4",{className:"display-8",children:"Try These Experiments:"}),(0,rt.jsxs)("ul",{children:[(0,rt.jsx)("li",{children:"Upload an image of a common object and try different ways of describing it"}),(0,rt.jsx)("li",{children:"Test with very different descriptions to see how the scores change"}),(0,rt.jsx)("li",{children:"Try abstract concepts vs. concrete descriptions"}),(0,rt.jsx)("li",{children:"See how specific vs. general descriptions affect the matching"})]})]})]})]})},yz=function(e){e.model;var t=(0,k.useState)("architecture"),n=(0,C.Z)(t,2),r=n[0],a=n[1];return(0,rt.jsxs)("div",{style:{marginBottom:50},children:[(0,rt.jsx)("h2",{className:"display-6",children:"Understanding Multimodal Architecture"}),(0,rt.jsxs)("div",{className:"container-sm",style:{marginTop:50,maxWidth:800},children:[(0,rt.jsxs)("div",{style:{textAlign:"justify"},children:["Let's dive deeper into how multimodal models are structured and what makes them work. Understanding these architectural choices helps us think critically about their capabilities and limitations.",(0,rt.jsx)("br",{}),(0,rt.jsx)("br",{})]}),(0,rt.jsxs)(_a,{activeKey:r,onSelect:function(e){return a(e)},className:"mb-3",style:{marginTop:30},children:[(0,rt.jsx)(Ta,{eventKey:"architecture",title:"Architecture",children:(0,rt.jsxs)("div",{style:{textAlign:"justify",marginTop:20},children:[(0,rt.jsx)("h4",{className:"display-8",children:"Dual Encoder Architecture"}),"CLIP and similar models use a ",(0,rt.jsx)("span",{className:"emph",children:"dual encoder architecture"}),":",(0,rt.jsx)("br",{}),(0,rt.jsx)("br",{}),(0,rt.jsxs)("div",{style:{backgroundColor:"#f8f9fa",padding:20,borderRadius:8,marginBottom:20},children:[(0,rt.jsx)("strong",{children:"Image Encoder:"}),(0,rt.jsxs)("ul",{children:[(0,rt.jsx)("li",{children:"Processes raw images (typically 224\xd7224 or larger)"}),(0,rt.jsx)("li",{children:"Can be a ResNet, Vision Transformer (ViT), or other CNN"}),(0,rt.jsx)("li",{children:"Outputs a fixed-size embedding vector (e.g., 512 dimensions)"}),(0,rt.jsx)("li",{children:"Learns visual features: edges, textures, shapes, objects"})]}),(0,rt.jsx)("strong",{children:"Text Encoder:"}),(0,rt.jsxs)("ul",{children:[(0,rt.jsx)("li",{children:"Processes text using tokenization (breaking text into pieces)"}),(0,rt.jsx)("li",{children:"Usually a Transformer model"}),(0,rt.jsx)("li",{children:"Outputs a fixed-size embedding vector (same dimensions as image encoder)"}),(0,rt.jsx)("li",{children:"Learns semantic meaning, context, and relationships between words"})]})]}),"The key innovation is that both encoders project their inputs into the ",(0,rt.jsx)("span",{className:"emph",children:"same embedding space"}),", making direct comparison possible.",(0,rt.jsx)("br",{}),(0,rt.jsx)("br",{}),(0,rt.jsx)("h4",{className:"display-8",children:"Training Process"}),(0,rt.jsxs)("div",{style:{backgroundColor:"#fff3cd",padding:20,borderRadius:8,marginBottom:20},children:[(0,rt.jsx)("strong",{children:"Contrastive Learning:"}),(0,rt.jsxs)("ol",{children:[(0,rt.jsx)("li",{children:"Take a batch of N (image, text) pairs from the dataset"}),(0,rt.jsx)("li",{children:"Encode all images and all texts"}),(0,rt.jsx)("li",{children:"Compute N \xd7 N similarity matrix (every image vs. every text)"}),(0,rt.jsx)("li",{children:"Maximize similarity for the N correct pairs (diagonal)"}),(0,rt.jsx)("li",{children:"Minimize similarity for the N\xb2 - N incorrect pairs"})]}),"This creates N positive examples and N\xb2 - N negative examples per batch!"]}),(0,rt.jsx)("h4",{className:"display-8",children:"Why This Works"}),"By training on millions of diverse (image, text) pairs from the internet:",(0,rt.jsxs)("ul",{children:[(0,rt.jsx)("li",{children:"The model learns visual concepts and their linguistic descriptions"}),(0,rt.jsx)("li",{children:"It discovers relationships between objects, actions, and attributes"}),(0,rt.jsx)("li",{children:"It builds robust representations that generalize to new examples"}),(0,rt.jsx)("li",{children:"It enables zero-shot transfer: recognizing new categories without retraining"})]})]})}),(0,rt.jsx)(Ta,{eventKey:"applications",title:"Applications",children:(0,rt.jsxs)("div",{style:{textAlign:"justify",marginTop:20},children:[(0,rt.jsx)("h4",{className:"display-8",children:"Real-World Applications"}),"Multimodal models have enabled numerous practical applications:",(0,rt.jsx)("br",{}),(0,rt.jsx)("br",{}),(0,rt.jsxs)("div",{style:{marginBottom:20},children:[(0,rt.jsx)("strong",{children:"1. Image Search & Retrieval"}),(0,rt.jsxs)("ul",{children:[(0,rt.jsx)("li",{children:"Search massive image databases using natural language"}),(0,rt.jsx)("li",{children:'Find specific photos in your library: "beach sunset 2022"'}),(0,rt.jsx)("li",{children:'E-commerce: "red leather jacket with zipper"'})]})]}),(0,rt.jsxs)("div",{style:{marginBottom:20},children:[(0,rt.jsx)("strong",{children:"2. Content Moderation"}),(0,rt.jsxs)("ul",{children:[(0,rt.jsx)("li",{children:"Detect inappropriate content across languages"}),(0,rt.jsx)("li",{children:"Find policy violations without language-specific training"}),(0,rt.jsx)("li",{children:"Flag misinformation or harmful imagery"})]})]}),(0,rt.jsxs)("div",{style:{marginBottom:20},children:[(0,rt.jsx)("strong",{children:"3. Accessibility"}),(0,rt.jsxs)("ul",{children:[(0,rt.jsx)("li",{children:"Describe images for visually impaired users"}),(0,rt.jsx)("li",{children:"Generate alt text automatically"}),(0,rt.jsx)("li",{children:"Answer questions about visual content"})]})]}),(0,rt.jsxs)("div",{style:{marginBottom:20},children:[(0,rt.jsx)("strong",{children:"4. Creative Tools"}),(0,rt.jsxs)("ul",{children:[(0,rt.jsx)("li",{children:"Text-to-image generation (DALL-E, Stable Diffusion)"}),(0,rt.jsx)("li",{children:"Image editing via text instructions"}),(0,rt.jsx)("li",{children:"Style transfer and manipulation"})]})]}),(0,rt.jsxs)("div",{style:{marginBottom:20},children:[(0,rt.jsx)("strong",{children:"5. Robotics & Autonomous Systems"}),(0,rt.jsxs)("ul",{children:[(0,rt.jsx)("li",{children:"Robots understanding natural language commands"}),(0,rt.jsx)("li",{children:"Visual navigation with linguistic goals"}),(0,rt.jsx)("li",{children:"Human-robot interaction"})]})]}),(0,rt.jsx)("h4",{className:"display-8",children:"Emerging Directions"}),(0,rt.jsxs)("ul",{children:[(0,rt.jsxs)("li",{children:[(0,rt.jsx)("strong",{children:"Video Understanding:"})," Extending to temporal sequences"]}),(0,rt.jsxs)("li",{children:[(0,rt.jsx)("strong",{children:"Audio-Visual Models:"})," Connecting sound with vision"]}),(0,rt.jsxs)("li",{children:[(0,rt.jsx)("strong",{children:"3D Understanding:"})," Spatial reasoning with language"]}),(0,rt.jsxs)("li",{children:[(0,rt.jsx)("strong",{children:"Multilingual Models:"})," Supporting hundreds of languages"]})]})]})}),(0,rt.jsx)(Ta,{eventKey:"limitations",title:"Limitations & Ethics",children:(0,rt.jsxs)("div",{style:{textAlign:"justify",marginTop:20},children:[(0,rt.jsx)("h4",{className:"display-8",children:"Technical Limitations"}),(0,rt.jsx)("div",{style:{backgroundColor:"#f8d7da",padding:20,borderRadius:8,marginBottom:20},children:(0,rt.jsxs)("ul",{children:[(0,rt.jsxs)("li",{children:[(0,rt.jsx)("strong",{children:"Compositionality:"}),' Struggles with complex scenes requiring spatial reasoning (e.g., "cat to the left of dog" vs. "dog to the left of cat")']}),(0,rt.jsxs)("li",{children:[(0,rt.jsx)("strong",{children:"Counting:"}),' Difficulty with precise quantities ("three apples" vs. "five apples")']}),(0,rt.jsxs)("li",{children:[(0,rt.jsx)("strong",{children:"Abstract Concepts:"})," Better at concrete objects than abstract ideas"]}),(0,rt.jsxs)("li",{children:[(0,rt.jsx)("strong",{children:"Fine-grained Distinctions:"})," May confuse similar categories without additional training"]}),(0,rt.jsxs)("li",{children:[(0,rt.jsx)("strong",{children:"Context Dependence:"})," Performance varies based on image quality, lighting, angles"]})]})}),(0,rt.jsx)("h4",{className:"display-8",children:"Ethical Concerns & Bias"}),(0,rt.jsxs)("div",{style:{backgroundColor:"#fff3cd",padding:20,borderRadius:8,marginBottom:20},children:[(0,rt.jsx)("strong",{children:"1. Training Data Bias"}),(0,rt.jsxs)("ul",{children:[(0,rt.jsx)("li",{children:"Models trained on internet data inherit societal biases"}),(0,rt.jsx)("li",{children:"Gender stereotypes (e.g., nurses as female, engineers as male)"}),(0,rt.jsx)("li",{children:"Cultural bias toward Western/English content"}),(0,rt.jsx)("li",{children:"Underrepresentation of certain demographics"})]}),(0,rt.jsx)("strong",{children:"2. Privacy & Surveillance"}),(0,rt.jsxs)("ul",{children:[(0,rt.jsx)("li",{children:"Powerful search capabilities enable mass surveillance"}),(0,rt.jsx)("li",{children:"Can identify individuals, locations, private information"}),(0,rt.jsx)("li",{children:"Raises questions about consent and data collection"}),(0,rt.jsxs)("li",{children:[(0,rt.jsx)("a",{href:"https://www.unesco.org/en/artificial-intelligence",children:"UNESCO"})," emphasizes right to privacy in AI systems"]})]}),(0,rt.jsx)("strong",{children:"3. Misinformation & Deepfakes"}),(0,rt.jsxs)("ul",{children:[(0,rt.jsx)("li",{children:"Can be used to match misleading text with images"}),(0,rt.jsx)("li",{children:"Enables sophisticated fake content generation"}),(0,rt.jsx)("li",{children:"Difficult to detect manipulated content"}),(0,rt.jsx)("li",{children:"Potential for electoral interference and propaganda"})]}),(0,rt.jsx)("strong",{children:"4. Environmental Impact"}),(0,rt.jsxs)("ul",{children:[(0,rt.jsx)("li",{children:"Training large models requires massive computational resources"}),(0,rt.jsx)("li",{children:"Significant carbon footprint and energy consumption"}),(0,rt.jsx)("li",{children:"Concentrates resources in wealthy organizations"}),(0,rt.jsx)("li",{children:"Questions of sustainability and accessibility"})]})]}),(0,rt.jsx)("h4",{className:"display-8",children:"Responsible Development"}),"To address these concerns, the AI community should:",(0,rt.jsxs)("ul",{children:[(0,rt.jsxs)("li",{children:[(0,rt.jsx)("strong",{children:"Dataset Transparency:"})," Document data sources, collection methods, and known biases"]}),(0,rt.jsxs)("li",{children:[(0,rt.jsx)("strong",{children:"Fairness Audits:"})," Test models across diverse demographics and scenarios"]}),(0,rt.jsxs)("li",{children:[(0,rt.jsx)("strong",{children:"Privacy Protections:"})," Implement safeguards against identifying individuals"]}),(0,rt.jsxs)("li",{children:[(0,rt.jsx)("strong",{children:"Access Controls:"})," Consider who can use powerful models and for what purposes"]}),(0,rt.jsxs)("li",{children:[(0,rt.jsx)("strong",{children:"Efficiency Research:"})," Develop smaller, more efficient models"]}),(0,rt.jsxs)("li",{children:[(0,rt.jsx)("strong",{children:"Human Oversight:"})," Keep humans in decision-making loops"]}),(0,rt.jsxs)("li",{children:[(0,rt.jsx)("strong",{children:"Education:"})," Help users understand capabilities and limitations"]})]}),(0,rt.jsxs)("div",{style:{backgroundColor:"#d1ecf1",padding:20,borderRadius:8,marginTop:20},children:[(0,rt.jsx)("strong",{children:"Remember:"})," Understanding how these models work empowers us to use them responsibly, identify their limitations, and advocate for ethical AI development. As users and developers, we have a responsibility to consider the broader societal impacts of these technologies."]})]})}),(0,rt.jsx)(Ta,{eventKey:"future",title:"Future Directions",children:(0,rt.jsxs)("div",{style:{textAlign:"justify",marginTop:20},children:[(0,rt.jsx)("h4",{className:"display-8",children:"The Evolution of Multimodal AI"}),(0,rt.jsxs)("div",{style:{marginBottom:20},children:[(0,rt.jsx)("strong",{children:"From Dual-Modal to Any-Modal"}),(0,rt.jsx)("p",{children:"Current research is moving beyond just image-text models:"}),(0,rt.jsxs)("ul",{children:[(0,rt.jsxs)("li",{children:[(0,rt.jsx)("strong",{children:"ImageBind (Meta):"})," Learns joint embeddings across 6+ modalities (images, text, audio, depth, thermal, IMU)"]}),(0,rt.jsxs)("li",{children:[(0,rt.jsx)("strong",{children:"Unified Models:"})," Single model handling any combination of inputs/outputs"]}),(0,rt.jsxs)("li",{children:[(0,rt.jsx)("strong",{children:"Cross-modal Generation:"})," Generate audio from images, images from audio, etc."]})]})]}),(0,rt.jsxs)("div",{style:{marginBottom:20},children:[(0,rt.jsx)("strong",{children:"Improved Reasoning"}),(0,rt.jsxs)("ul",{children:[(0,rt.jsx)("li",{children:"Better compositional understanding (spatial relationships, temporal sequences)"}),(0,rt.jsx)("li",{children:"Mathematical and logical reasoning over visual content"}),(0,rt.jsx)("li",{children:"Chain-of-thought reasoning for complex visual questions"}),(0,rt.jsx)("li",{children:"Integration with large language models for enhanced capabilities"})]})]}),(0,rt.jsxs)("div",{style:{marginBottom:20},children:[(0,rt.jsx)("strong",{children:"Efficiency & Accessibility"}),(0,rt.jsxs)("ul",{children:[(0,rt.jsxs)("li",{children:[(0,rt.jsx)("strong",{children:"Model Compression:"})," Smaller models that run on phones/edge devices"]}),(0,rt.jsxs)("li",{children:[(0,rt.jsx)("strong",{children:"Few-shot Learning:"})," Adapt to new tasks with minimal examples"]}),(0,rt.jsxs)("li",{children:[(0,rt.jsx)("strong",{children:"Open-source Models:"})," Democratizing access (OpenCLIP, LLaVA)"]}),(0,rt.jsxs)("li",{children:[(0,rt.jsx)("strong",{children:"Energy Efficiency:"})," Reducing computational and environmental costs"]})]})]}),(0,rt.jsxs)("div",{style:{marginBottom:20},children:[(0,rt.jsx)("strong",{children:"Embodied AI"}),(0,rt.jsxs)("ul",{children:[(0,rt.jsx)("li",{children:"Robots that understand both language commands and visual scenes"}),(0,rt.jsx)("li",{children:"Virtual assistants with true multimodal understanding"}),(0,rt.jsx)("li",{children:"AR/VR applications with natural language interaction"})]})]}),(0,rt.jsxs)("div",{style:{marginBottom:20},children:[(0,rt.jsx)("strong",{children:"Medical & Scientific Applications"}),(0,rt.jsxs)("ul",{children:[(0,rt.jsx)("li",{children:"Medical image analysis with clinical text integration"}),(0,rt.jsx)("li",{children:"Drug discovery combining molecular structures and literature"}),(0,rt.jsx)("li",{children:"Climate science analyzing satellite imagery with textual data"})]})]}),(0,rt.jsx)("h4",{className:"display-8",children:"Challenges Ahead"}),(0,rt.jsx)("div",{style:{backgroundColor:"#f8f9fa",padding:20,borderRadius:8},children:(0,rt.jsxs)("ul",{children:[(0,rt.jsxs)("li",{children:[(0,rt.jsx)("strong",{children:"Hallucination:"})," Models generating plausible but incorrect information"]}),(0,rt.jsxs)("li",{children:[(0,rt.jsx)("strong",{children:"Grounding:"})," Ensuring models truly understand rather than pattern-match"]}),(0,rt.jsxs)("li",{children:[(0,rt.jsx)("strong",{children:"Evaluation:"}),' How do we measure "understanding" across modalities?']}),(0,rt.jsxs)("li",{children:[(0,rt.jsx)("strong",{children:"Safety:"})," Preventing harmful outputs and misuse"]}),(0,rt.jsxs)("li",{children:[(0,rt.jsx)("strong",{children:"Alignment:"})," Ensuring models behave according to human values"]})]})}),(0,rt.jsxs)("div",{style:{backgroundColor:"#d4edda",padding:20,borderRadius:8,marginTop:20},children:[(0,rt.jsx)("strong",{children:"Your Role in AI's Future"}),(0,rt.jsx)("p",{children:"As you've learned about multimodal AI, consider:"}),(0,rt.jsxs)("ul",{children:[(0,rt.jsx)("li",{children:"How can these technologies be used to benefit society?"}),(0,rt.jsx)("li",{children:"What safeguards are needed to prevent harm?"}),(0,rt.jsx)("li",{children:"How can we ensure equitable access and representation?"}),(0,rt.jsx)("li",{children:"What questions should we be asking as these systems become more powerful?"})]}),(0,rt.jsx)("p",{children:"Your understanding and critical thinking about AI will help shape its responsible development and deployment!"})]})]})})]})]})]})},bz=function(){var e=(0,k.useState)(void 0),t=(0,C.Z)(e,2),n=t[0],r=t[1];return(0,k.useEffect)((function(){window.scrollTo(0,0)}),[]),(0,rt.jsxs)("div",{className:"container-sm",style:{maxWidth:1e3},children:[(0,rt.jsxs)("div",{className:"frame",style:{backgroundColor:"#e0f7fa",justifyContent:"center"},children:[(0,rt.jsxs)("h1",{className:"display-4",children:["Understanding Multimodal AI:",(0,rt.jsx)("br",{}),"Image-Text Matching"]}),(0,rt.jsxs)("div",{className:"container-sm",style:{marginTop:50,maxWidth:800,textAlign:"justify"},children:["Multimodal AI refers to systems that can understand and process multiple types of data simultaneously - such as images, text, audio, and video. Unlike traditional models that work with only one type of data, multimodal models can find connections and relationships across different modalities. For example, they can match images with text descriptions, answer questions about images, or generate captions for photos.",(0,rt.jsx)("div",{className:"container-sm",style:{justifyContent:"center",display:"flex"},children:(0,rt.jsxs)("ul",{children:[(0,rt.jsxs)("li",{children:[(0,rt.jsx)("span",{className:"emph",children:"Cross-Modal Understanding"}),': The model learns to connect concepts across different types of data, like linking the word "cat" with images of cats.']}),(0,rt.jsxs)("li",{children:[(0,rt.jsx)("span",{className:"emph",children:"Shared Representation Space"}),': Both images and text are transformed into a common "language" (embeddings) where similar concepts are close together.']}),(0,rt.jsxs)("li",{children:[(0,rt.jsx)("span",{className:"emph",children:"Zero-Shot Learning"}),": Once trained, these models can recognize new categories without additional training, just by using text descriptions."]})]})})]}),(0,rt.jsx)("hr",{style:{margin:"30px 20px"}}),(0,rt.jsx)(qB,{}),(0,rt.jsx)("hr",{style:{margin:"30px 20px"}}),(0,rt.jsx)(GB,{}),(0,rt.jsx)("hr",{style:{margin:"30px 20px"}}),(0,rt.jsx)(gz,{setModel:r}),(0,rt.jsx)("hr",{style:{margin:"30px 20px"}}),(0,rt.jsx)(yz,{model:n}),(0,rt.jsx)("hr",{style:{margin:"30px 20px"}})]}),(0,rt.jsx)("hr",{style:{margin:0},className:"border border-2 "})]})},xz=function(){return(0,rt.jsxs)("div",{style:{marginBottom:50},children:[(0,rt.jsx)("h2",{className:"display-6",children:"The Puzzle of Representational Convergence"}),(0,rt.jsx)("div",{className:"container-sm",style:{marginTop:50,maxWidth:800},children:(0,rt.jsxs)("div",{style:{textAlign:"justify"},children:[(0,rt.jsx)("h4",{className:"display-8",children:"A Surprising Discovery"}),"When researchers trained different multimodal models\u2014CLIP (OpenAI), ALIGN (Google), BLIP (Salesforce), and others\u2014they discovered something remarkable: ",(0,rt.jsx)("span",{className:"emph",children:"despite using different architectures, training on different datasets, and optimizing with different procedures, these models learned strikingly similar internal representations"}),".",(0,rt.jsx)("br",{}),(0,rt.jsx)("br",{}),'Images of dogs ended up in similar regions of embedding space. The text "a cat" pointed to similar locations. The relationships between concepts\u2014that "puppy" is close to "dog", that "vehicle" relates to "car"\u2014emerged consistently across models.',(0,rt.jsx)("br",{}),(0,rt.jsx)("br",{}),(0,rt.jsx)("h4",{className:"display-8",children:"Why Does This Matter?"}),"This convergence suggests something fundamental about how neural networks learn from visual-linguistic data:",(0,rt.jsx)("div",{style:{backgroundColor:"#e8f4f8",padding:20,borderRadius:8,marginTop:15,marginBottom:15},children:(0,rt.jsxs)("ul",{children:[(0,rt.jsxs)("li",{children:[(0,rt.jsx)("strong",{children:"Data Structure Hypothesis"}),": The representations reflect the inherent structure of the data itself, not arbitrary choices in model design"]}),(0,rt.jsxs)("li",{children:[(0,rt.jsx)("strong",{children:"Optimization Landscape"}),": Different optimization paths (SGD, Adam, etc.) lead to the same local minima in representation space"]}),(0,rt.jsxs)("li",{children:[(0,rt.jsx)("strong",{children:"Inductive Biases"}),": Despite architectural differences, common constraints (convolution, attention) guide learning toward similar solutions"]}),(0,rt.jsxs)("li",{children:[(0,rt.jsx)("strong",{children:"Task Demands"}),": The contrastive learning objective forces models to discover the same semantic structure"]})]})}),(0,rt.jsx)("h4",{className:"display-8",children:"Parallels with Neuroscience"}),"This phenomenon mirrors discoveries in neuroscience. Different biological brains\u2014whether across individuals or even across species\u2014develop similar representations for processing visual information:",(0,rt.jsxs)("ul",{children:[(0,rt.jsxs)("li",{children:[(0,rt.jsx)("strong",{children:"V1 Simple Cells"}),": Edge detectors emerge in primate visual cortex, remarkably similar to first-layer CNN filters"]}),(0,rt.jsxs)("li",{children:[(0,rt.jsx)("strong",{children:"Hierarchical Organization"}),": Both brains and CNNs process information hierarchically: edges \u2192 textures \u2192 parts \u2192 objects"]}),(0,rt.jsxs)("li",{children:[(0,rt.jsx)("strong",{children:"Invariances"}),": Both learn similar invariances (to position, rotation, scale)"]}),(0,rt.jsxs)("li",{children:[(0,rt.jsx)("strong",{children:"Semantic Organization"}),": Concept clustering in human semantic memory resembles embedding space organization"]})]}),(0,rt.jsxs)("div",{style:{backgroundColor:"#fff3cd",padding:20,borderRadius:8,marginTop:20},children:[(0,rt.jsx)("strong",{children:"The Central Question:"})," If different learning systems (biological brains, various neural architectures) converge on similar representations, what does this tell us about the fundamental nature of visual and linguistic understanding?"]}),(0,rt.jsx)("h4",{className:"display-8",children:"Practical Implications"}),"Understanding representational convergence has immediate practical benefits:",(0,rt.jsx)("br",{}),(0,rt.jsx)("br",{}),(0,rt.jsx)("strong",{children:"1. Model Stitching & Merging"}),(0,rt.jsxs)("ul",{children:[(0,rt.jsx)("li",{children:"If models learn similar representations, we can swap components between them"}),(0,rt.jsx)("li",{children:"Use CLIP's image encoder with ALIGN's text encoder"}),(0,rt.jsx)("li",{children:"Merge weights from multiple models to improve performance"})]}),(0,rt.jsx)("strong",{children:"2. Transfer Learning & Zero-Shot Generalization"}),(0,rt.jsxs)("ul",{children:[(0,rt.jsx)("li",{children:"Representations learned by one model transfer to others"}),(0,rt.jsx)("li",{children:"Fine-tune on one model's outputs, deploy on another"}),(0,rt.jsx)("li",{children:"Cross-model knowledge distillation"})]}),(0,rt.jsx)("strong",{children:"3. Model Efficiency"}),(0,rt.jsxs)("ul",{children:[(0,rt.jsx)("li",{children:"If convergence is guaranteed, focus on computational efficiency"}),(0,rt.jsx)("li",{children:"Smaller models can learn similar representations to larger ones"}),(0,rt.jsx)("li",{children:"Knowledge about universal features guides architecture design"})]}),(0,rt.jsx)("strong",{children:"4. Interpretability"}),(0,rt.jsxs)("ul",{children:[(0,rt.jsx)("li",{children:"Universal features are more likely to be meaningful"}),(0,rt.jsx)("li",{children:"Consistent representations across models build trust"}),(0,rt.jsx)("li",{children:"Easier to explain what models have learned"})]}),(0,rt.jsx)("h4",{className:"display-8",children:"Our Exploration"}),"In this module, we'll investigate:",(0,rt.jsxs)("ol",{children:[(0,rt.jsxs)("li",{children:[(0,rt.jsx)("strong",{children:"How"})," to measure similarity between representations from different models"]}),(0,rt.jsxs)("li",{children:[(0,rt.jsx)("strong",{children:"Why"})," convergence happens (theoretical perspectives)"]}),(0,rt.jsxs)("li",{children:[(0,rt.jsx)("strong",{children:"When"})," convergence occurs (and when it doesn't)"]}),(0,rt.jsxs)("li",{children:[(0,rt.jsx)("strong",{children:"What"})," practical applications benefit from this understanding"]})]}),"Through interactive visualizations and comparisons, you'll see firsthand how different architectures arrive at similar solutions to the multimodal learning problem."]})})]})},wz=["bsPrefix","className","striped","bordered","borderless","hover","size","variant","responsive"],kz=k.forwardRef((function(e,t){var n=e.bsPrefix,r=e.className,a=e.striped,i=e.bordered,o=e.borderless,u=e.hover,s=e.size,c=e.variant,l=e.responsive,f=ct(e,wz),d=wt(n,"table"),h=ft()(r,d,c&&"".concat(d,"-").concat(c),s&&"".concat(d,"-").concat(s),a&&"".concat(d,"-").concat("string"===typeof a?"striped-".concat(a):"striped"),i&&"".concat(d,"-bordered"),o&&"".concat(d,"-borderless"),u&&"".concat(d,"-hover")),p=(0,rt.jsx)("table",ut(ut({},f),{},{className:h,ref:t}));if(l){var v="".concat(d,"-responsive");return"string"===typeof l&&(v="".concat(v,"-").concat(l)),(0,rt.jsx)("div",{className:v,children:p})}return p})),_z=kz;function Sz(){return Cz.apply(this,arguments)}function Cz(){return Cz=(0,Da.Z)(E().mark((function e(){return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Promise((function(e){return setTimeout(e,500)}));case 2:return e.abrupt("return",{clip:{id:"clip"},align:{id:"align"},blip:{id:"blip"}});case 3:case"end":return e.stop()}}),e)}))),Cz.apply(this,arguments)}function Az(e,t,n){return Ez.apply(this,arguments)}function Ez(){return Ez=(0,Da.Z)(E().mark((function e(t,n,r){var a,i,o,u,s,c,l;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=Math.min(.95,.6+Nz(r)%35/100),i=Object.keys(t).map((function(e,t){return{model:e,score:Tz(a-.03*t+(Nz(e+r)%7-3)/100)}})).sort((function(e,t){return t.score-e.score})),o=Object.keys(t),u=o.map((function(e,t){return o.map((function(n,a){return t===a?1:Tz(.65+Nz(e+n+r)%20/100)}))})),s=u.flat().reduce((function(e,t){return e+t}),0)/(o.length*o.length),c=i.reduce((function(e,t){return e+t.score}),0)/i.length,l=i.reduce((function(e,t){return e+Math.pow(t.score-c,2)}),0)/i.length,e.abrupt("return",{matchScores:i,similarityMatrix:u,avgSimilarity:s,scoreVariance:l});case 8:case"end":return e.stop()}}),e)}))),Ez.apply(this,arguments)}function Nz(e){for(var t=0,n=0;n<e.length;n++)t=(t<<5)-t+e.charCodeAt(n),t|=0;return Math.abs(t)}function Tz(e){return Math.max(0,Math.min(1,e))}var Iz=function(e){var t=e.setModels,n=(0,k.useState)({}),r=(0,C.Z)(n,2),a=r[0],i=r[1],o=(0,k.useState)(!1),u=(0,C.Z)(o,2),s=u[0],c=u[1],l=(0,k.useState)(null),f=(0,C.Z)(l,2),d=f[0],h=f[1],p=(0,k.useState)("a dog"),v=(0,C.Z)(p,2),m=v[0],g=v[1],y=(0,k.useState)(null),b=(0,C.Z)(y,2),x=b[0],w=b[1];function _(){return _=(0,Da.Z)(E().mark((function e(){var t;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c(!0),e.prev=1,e.next=4,Sz();case 4:t=e.sent,i(t),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(1),console.error("Error loading models:",e.t0),alert("Failed to load models. Please try again.");case 12:c(!1);case 13:case"end":return e.stop()}}),e,null,[[1,8]])}))),_.apply(this,arguments)}function S(){return(S=(0,Da.Z)(E().mark((function e(){var t;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(d&&0!==Object.keys(a).length){e.next=3;break}return alert("Please load models and upload an image first!"),e.abrupt("return");case 3:if(m.trim()){e.next=6;break}return alert("Please enter a text description!"),e.abrupt("return");case 6:return c(!0),e.prev=7,e.next=10,Az(a,d,m);case 10:t=e.sent,w(t),e.next=18;break;case 14:e.prev=14,e.t0=e.catch(7),console.error("Error comparing embeddings:",e.t0),alert("Failed to compare embeddings. Please try again.");case 18:c(!1);case 19:case"end":return e.stop()}}),e,null,[[7,14]])})))).apply(this,arguments)}(0,k.useEffect)((function(){Object.keys(a).length>0&&t(a)}),[a,t]);var A={clip:{name:"CLIP",org:"OpenAI",architecture:"ResNet-50 / ViT",dataset:"400M image-text pairs",released:"2021"},align:{name:"ALIGN",org:"Google",architecture:"EfficientNet / BERT",dataset:"1.8B image-text pairs",released:"2021"},blip:{name:"BLIP",org:"Salesforce",architecture:"ViT / BERT",dataset:"129M images",released:"2022"}};return(0,rt.jsxs)("div",{style:{marginBottom:50},children:[(0,rt.jsx)("h2",{className:"display-6",children:"Cross-Model Representation Analysis"}),(0,rt.jsxs)("div",{className:"container-sm",style:{marginTop:50,maxWidth:800},children:[(0,rt.jsxs)("div",{style:{textAlign:"justify"},children:["Now let's conduct our own experiment: upload an image and text, then see how different models represent them. We'll compare the embeddings across models to quantify their similarity.",(0,rt.jsx)("br",{}),(0,rt.jsx)("br",{}),(0,rt.jsxs)(oz,{variant:"info",children:[(0,rt.jsx)("strong",{children:"What We're Testing:"})," Do different models produce similar embeddings for the same input? If convergence theory is correct, we should see high similarity across models even though they were trained independently."]})]}),(0,rt.jsxs)("div",{style:{marginTop:30},children:[(0,rt.jsx)("h4",{className:"display-8",children:"Step 1: Load Multiple Models"}),(0,rt.jsx)("p",{style:{textAlign:"justify"},children:"We'll load simulated versions of CLIP, ALIGN, and BLIP. In practice, these would be the actual pre-trained models with different architectures."}),(0,rt.jsx)(Oa,{onClick:function(){return _.apply(this,arguments)},disabled:s||Object.keys(a).length>0,style:{marginBottom:20},children:s?"Loading...":"Load All Models"}),Object.keys(a).length>0&&(0,rt.jsxs)("div",{style:{marginTop:20},children:[(0,rt.jsx)("strong",{children:"Loaded Models:"}),(0,rt.jsxs)(_z,{striped:!0,bordered:!0,hover:!0,size:"sm",style:{marginTop:10},children:[(0,rt.jsx)("thead",{children:(0,rt.jsxs)("tr",{children:[(0,rt.jsx)("th",{children:"Model"}),(0,rt.jsx)("th",{children:"Organization"}),(0,rt.jsx)("th",{children:"Architecture"}),(0,rt.jsx)("th",{children:"Dataset Size"})]})}),(0,rt.jsx)("tbody",{children:Object.keys(a).map((function(e){return(0,rt.jsxs)("tr",{children:[(0,rt.jsx)("td",{children:(0,rt.jsx)("strong",{children:A[e].name})}),(0,rt.jsx)("td",{children:A[e].org}),(0,rt.jsx)("td",{children:A[e].architecture}),(0,rt.jsx)("td",{children:A[e].dataset})]},e)}))})]})]})]}),(0,rt.jsxs)("div",{style:{marginTop:30},children:[(0,rt.jsx)("h4",{className:"display-8",children:"Step 2: Upload Test Image"}),(0,rt.jsx)("input",{type:"file",accept:"image/*",onChange:function(e){var t=e.target.files[0];if(t){var n=new FileReader;n.onload=function(e){var t=new Image;t.onload=function(){var e=document.getElementById("comparison-canvas"),n=e.getContext("2d");e.width=224,e.height=224,n.drawImage(t,0,0,224,224),h(e),document.getElementById("comparison-canvas").style.display="block"},t.src=e.target.result},n.readAsDataURL(t),w(null)}},disabled:0===Object.keys(a).length,style:{marginBottom:20}}),(0,rt.jsx)("div",{style:{display:"flex",justifyContent:"center"},children:(0,rt.jsx)("canvas",{id:"comparison-canvas",style:{display:"none",border:"2px solid #ddd",borderRadius:"8px"}})})]}),(0,rt.jsxs)("div",{style:{marginTop:30},children:[(0,rt.jsx)("h4",{className:"display-8",children:"Step 3: Enter Text Description"}),(0,rt.jsx)(pn.Control,{type:"text",value:m,onChange:function(e){return g(e.target.value)},placeholder:"Enter a description...",style:{marginBottom:20}})]}),(0,rt.jsxs)("div",{style:{marginTop:30},children:[(0,rt.jsx)("h4",{className:"display-8",children:"Step 4: Compare Representations"}),(0,rt.jsx)(Oa,{variant:"primary",onClick:function(){return S.apply(this,arguments)},disabled:!d||0===Object.keys(a).length||s,children:s?"Computing...":"Compare Across Models"})]}),x&&(0,rt.jsxs)("div",{style:{marginTop:40},children:[(0,rt.jsx)("h4",{className:"display-8",children:"Results: Cross-Model Similarity"}),(0,rt.jsxs)("div",{style:{backgroundColor:"#f8f9fa",padding:20,borderRadius:8,marginBottom:20},children:[(0,rt.jsx)("h5",{children:"Image-Text Matching Scores"}),(0,rt.jsx)("p",{style:{fontSize:"14px"},children:"How well does each model match this image with the text?"}),(0,rt.jsxs)(_z,{bordered:!0,style:{marginTop:15},children:[(0,rt.jsx)("thead",{children:(0,rt.jsxs)("tr",{children:[(0,rt.jsx)("th",{children:"Model"}),(0,rt.jsx)("th",{children:"Similarity Score"}),(0,rt.jsx)("th",{children:"Rank"})]})}),(0,rt.jsx)("tbody",{children:x.matchScores.map((function(e,t){return(0,rt.jsxs)("tr",{children:[(0,rt.jsx)("td",{children:(0,rt.jsx)("strong",{children:e.model.toUpperCase()})}),(0,rt.jsx)("td",{children:e.score.toFixed(4)}),(0,rt.jsxs)("td",{children:["#",t+1]})]},e.model)}))})]})]}),(0,rt.jsxs)("div",{style:{backgroundColor:"#e8f4f8",padding:20,borderRadius:8,marginBottom:20},children:[(0,rt.jsx)("h5",{children:"Representation Similarity Matrix"}),(0,rt.jsx)("p",{style:{fontSize:"14px"},children:"Pairwise similarity between model representations (CKA)"}),(0,rt.jsxs)(_z,{bordered:!0,style:{marginTop:15},children:[(0,rt.jsx)("thead",{children:(0,rt.jsxs)("tr",{children:[(0,rt.jsx)("th",{}),Object.keys(a).map((function(e){return(0,rt.jsx)("th",{children:e.toUpperCase()},e)}))]})}),(0,rt.jsx)("tbody",{children:Object.keys(a).map((function(e,t){return(0,rt.jsxs)("tr",{children:[(0,rt.jsx)("td",{children:(0,rt.jsx)("strong",{children:e.toUpperCase()})}),Object.keys(a).map((function(e,n){return(0,rt.jsx)("td",{style:{backgroundColor:x.similarityMatrix[t][n]>.8?"#d4edda":x.similarityMatrix[t][n]>.6?"#fff3cd":"#f8d7da",fontWeight:t===n?"bold":"normal"},children:x.similarityMatrix[t][n].toFixed(3)},e)}))]},e)}))})]}),(0,rt.jsxs)("div",{style:{fontSize:"12px",marginTop:10,color:"#666"},children:[(0,rt.jsx)("span",{style:{backgroundColor:"#d4edda",padding:"2px 8px",marginRight:10},children:"High (>0.8)"}),(0,rt.jsx)("span",{style:{backgroundColor:"#fff3cd",padding:"2px 8px",marginRight:10},children:"Medium (0.6-0.8)"}),(0,rt.jsx)("span",{style:{backgroundColor:"#f8d7da",padding:"2px 8px"},children:"Low (<0.6)"})]})]}),(0,rt.jsxs)("div",{style:{backgroundColor:"#d4edda",padding:20,borderRadius:8},children:[(0,rt.jsx)("h5",{children:"Key Findings"}),(0,rt.jsxs)("ul",{style:{marginBottom:0},children:[(0,rt.jsxs)("li",{children:[(0,rt.jsx)("strong",{children:"Average Cross-Model Similarity:"})," ",x.avgSimilarity.toFixed(3)]}),(0,rt.jsxs)("li",{children:[(0,rt.jsx)("strong",{children:"Interpretation:"})," ",x.avgSimilarity>.8?"Very high convergence! Different models have learned remarkably similar representations.":x.avgSimilarity>.6?"Moderate convergence. Models show significant representational alignment.":"Lower convergence. Models may have learned different features for this input."]}),(0,rt.jsxs)("li",{children:[(0,rt.jsx)("strong",{children:"Variance in Matching:"})," ",x.scoreVariance.toFixed(4),x.scoreVariance<.01?" (very consistent across models)":" (some variation across models)"]})]})]}),(0,rt.jsxs)("div",{style:{textAlign:"justify",marginTop:20},children:[(0,rt.jsx)("h5",{children:"What This Tells Us"}),(0,rt.jsx)("p",{children:"High similarity values (>0.7) in the matrix indicate that different models have learned similar geometric relationships in their embedding spaces. This suggests that the representational structure is driven more by the data and task than by specific architectural choices."}),(0,rt.jsx)("p",{children:'When all models produce similar matching scores for the image-text pair, it demonstrates that they\'ve converged on similar semantic understanding\u2014they all "recognize" the relationship between the image and text in comparable ways.'})]})]}),(0,rt.jsxs)("div",{style:{textAlign:"justify",marginTop:30},children:[(0,rt.jsx)("h4",{className:"display-8",children:"Experiment Ideas"}),(0,rt.jsxs)("ul",{children:[(0,rt.jsxs)("li",{children:[(0,rt.jsx)("strong",{children:"Edge Cases:"})," Try ambiguous images or abstract text. Do models still converge?"]}),(0,rt.jsxs)("li",{children:[(0,rt.jsx)("strong",{children:"Compositional Understanding:"}),' Test "cat on a mat" vs "mat under a cat"']}),(0,rt.jsxs)("li",{children:[(0,rt.jsx)("strong",{children:"Counting:"})," Upload images with multiple objects and describe counts"]}),(0,rt.jsxs)("li",{children:[(0,rt.jsx)("strong",{children:"Cultural Concepts:"})," Test with images/text from different cultures"]})]})]})]})]})},Dz=function(){var e=(0,k.useRef)(),t=(0,k.useState)(["clip","align"]),n=(0,C.Z)(t,2),r=n[0],a=n[1],i=(0,k.useState)("cka"),o=(0,C.Z)(i,2),u=o[0],s=o[1];(0,k.useEffect)((function(){l()}),[r,u]);var c=function(e){var t={dog:[.8,.1,.1],cat:[.1,.8,.1],car:[.1,.1,.8],puppy:[.75,.15,.1],kitten:[.15,.75,.1],vehicle:[.1,.15,.75]},n={clip:0,align:.05,blip:.08,flava:.06}[e]||0,r={};return Object.keys(t).forEach((function(e){r[e]=t[e].map((function(e){return e+(Math.random()-.5)*n}))})),r},l=function(){TB(e.current).selectAll("*").remove();var t=700,n=400,a=TB(e.current).attr("width",t).attr("height",n),i={clip:"#e74c3c",align:"#3498db",blip:"#2ecc71",flava:"#f39c12"},o={clip:"CLIP (OpenAI)",align:"ALIGN (Google)",blip:"BLIP (Salesforce)",flava:"FLAVA (Meta)"};a.append("text").attr("x",350).attr("y",25).attr("text-anchor","middle").style("font-size","16px").style("font-weight","bold").text("Embedding Space Comparison: "+r.map((function(e){return o[e]})).join(" vs "));var s=r.map((function(e){return{name:e,embeddings:c(e),color:i[e]}})),l=["dog","cat","car","puppy","kitten","vehicle"].map((function(e){var t=s.map((function(t){var n=t.embeddings[e];return{x:200*n[0]+100*n[1]+150,y:200*n[1]+100*n[2]+150,model:t.name,color:t.color,concept:e}}));return{concept:e,points:t}}));l.forEach((function(e){e.concept;var t=e.points;2===t.length&&a.append("line").attr("x1",t[0].x).attr("y1",t[0].y).attr("x2",t[1].x).attr("y2",t[1].y).attr("stroke","#ccc").attr("stroke-width",1).attr("stroke-dasharray","3,3")}));var d={dog:"#ff6b6b",puppy:"#ff6b6b",cat:"#4ecdc4",kitten:"#4ecdc4",car:"#45b7d1",vehicle:"#45b7d1"};l.forEach((function(e){var t=e.concept;e.points.forEach((function(e){a.append("circle").attr("cx",e.x).attr("cy",e.y).attr("r",8).attr("fill",e.color).attr("stroke",d[t]).attr("stroke-width",2).style("cursor","pointer").append("title").text("".concat(e.model,": ").concat(t))}))}));var h={dog:{x:320,y:100},cat:{x:150,y:280},car:{x:180,y:120},puppy:{x:350,y:140},kitten:{x:180,y:310},vehicle:{x:210,y:150}};Object.keys(h).forEach((function(e){a.append("text").attr("x",h[e].x).attr("y",h[e].y).text(e).style("font-size","11px").style("font-weight","bold").style("fill",d[e])}));var p=a.append("g").attr("transform","translate(".concat(560,", 60)"));if(r.forEach((function(e,t){p.append("circle").attr("cx",0).attr("cy",25*t).attr("r",6).attr("fill",i[e]),p.append("text").attr("x",12).attr("y",25*t+4).text(o[e]).style("font-size","12px")})),a.append("text").attr("x",350).attr("y",390).attr("text-anchor","middle").style("font-size","12px").style("font-style","italic").text("Embedding Dimension 1"),a.append("text").attr("transform","rotate(-90)").attr("x",-200).attr("y",15).attr("text-anchor","middle").style("font-size","12px").style("font-style","italic").text("Embedding Dimension 2"),2===r.length){var v=f(s[0].embeddings,s[1].embeddings,u);a.append("text").attr("x",350).attr("y",370).attr("text-anchor","middle").style("font-size","14px").style("font-weight","bold").style("fill",v>.8?"#27ae60":"#f39c12").text("".concat(u.toUpperCase()," Similarity: ").concat(v.toFixed(3)))}},f=function(e,t,n){var r=Object.keys(e),a=0;return r.forEach((function(n){var r=e[n],i=t[n],o=r.reduce((function(e,t,n){return e+t*i[n]}),0),u=Math.sqrt(r.reduce((function(e,t){return e+t*t}),0)),s=Math.sqrt(i.reduce((function(e,t){return e+t*t}),0));a+=o/(u*s)})),a/r.length};return(0,rt.jsxs)("div",{style:{marginBottom:50},children:[(0,rt.jsx)("h2",{className:"display-6",children:"Visualizing Representational Convergence"}),(0,rt.jsxs)("div",{className:"container-sm",style:{marginTop:50,maxWidth:800},children:[(0,rt.jsxs)("div",{style:{textAlign:"justify"},children:[(0,rt.jsx)("h4",{className:"display-8",children:"Measuring Similarity Across Models"}),"Below, we visualize how different multimodal models represent the same concepts in embedding space. Despite being trained independently with different architectures, notice how similar concepts cluster together in remarkably similar ways.",(0,rt.jsx)("br",{}),(0,rt.jsx)("br",{}),(0,rt.jsxs)("div",{style:{backgroundColor:"#e8f4f8",padding:15,borderRadius:8},children:[(0,rt.jsx)("strong",{children:"Key Observation:"})," The dashed lines connect the same concept as represented by different models. Shorter lines indicate higher representational similarity\u2014the models have learned similar embeddings for that concept."]})]}),(0,rt.jsxs)("div",{style:{marginTop:30,marginBottom:20},children:[(0,rt.jsx)("h4",{className:"display-8",children:"Select Models to Compare (1-4):"}),(0,rt.jsx)(Qa,{style:{marginRight:10,marginBottom:10},children:["clip","align","blip","flava"].map((function(e){return(0,rt.jsx)(Oa,{variant:r.includes(e)?"primary":"outline-secondary",onClick:function(){return function(e){r.includes(e)?r.length>1&&a(r.filter((function(t){return t!==e}))):r.length<4&&a([].concat((0,I.Z)(r),[e]))}(e)},children:e.toUpperCase()},e)}))})]}),(0,rt.jsxs)("div",{style:{marginBottom:20},children:[(0,rt.jsx)(pn.Label,{children:(0,rt.jsx)("strong",{children:"Similarity Metric:"})}),(0,rt.jsxs)(pn.Select,{value:u,onChange:function(e){return s(e.target.value)},style:{width:"200px"},children:[(0,rt.jsx)("option",{value:"cka",children:"CKA (Centered Kernel Alignment)"}),(0,rt.jsx)("option",{value:"rsa",children:"RSA (Representational Similarity Analysis)"}),(0,rt.jsx)("option",{value:"cosine",children:"Cosine Similarity"})]})]}),(0,rt.jsx)("div",{style:{display:"flex",justifyContent:"center",marginBottom:30},children:(0,rt.jsx)("svg",{ref:e})}),(0,rt.jsxs)("div",{style:{textAlign:"justify"},children:[(0,rt.jsx)("h4",{className:"display-8",children:"What Are We Measuring?"}),(0,rt.jsx)("strong",{children:"CKA (Centered Kernel Alignment)"}),(0,rt.jsxs)("ul",{children:[(0,rt.jsx)("li",{children:"Measures similarity of representation geometries"}),(0,rt.jsx)("li",{children:"Invariant to orthogonal transformations and isotropic scaling"}),(0,rt.jsx)("li",{children:"Values close to 1 indicate similar representational structure"})]}),(0,rt.jsx)("strong",{children:"RSA (Representational Similarity Analysis)"}),(0,rt.jsxs)("ul",{children:[(0,rt.jsx)("li",{children:"Compares pairwise distances between representations"}),(0,rt.jsx)("li",{children:"Originally from neuroscience (comparing brain activity patterns)"}),(0,rt.jsx)("li",{children:"Robust to individual neuron/unit differences"})]}),(0,rt.jsx)("strong",{children:"Cosine Similarity"}),(0,rt.jsxs)("ul",{children:[(0,rt.jsx)("li",{children:"Measures angle between embedding vectors"}),(0,rt.jsx)("li",{children:"Simple and interpretable"}),(0,rt.jsx)("li",{children:"Commonly used in embedding space analysis"})]}),(0,rt.jsxs)("div",{style:{backgroundColor:"#fff3cd",padding:20,borderRadius:8,marginTop:20},children:[(0,rt.jsx)("strong",{children:"Empirical Finding:"})," Across multiple studies, researchers have found that different multimodal models achieve CKA similarities of 0.7-0.9 in their learned representations, despite using different:",(0,rt.jsxs)("ul",{style:{marginBottom:0},children:[(0,rt.jsx)("li",{children:"Architectures (ResNet vs ViT for vision)"}),(0,rt.jsx)("li",{children:"Training datasets (400M vs 1.8B image-text pairs)"}),(0,rt.jsx)("li",{children:"Optimization procedures (different learning rates, batch sizes)"}),(0,rt.jsx)("li",{children:"Training compute (days vs weeks of GPU time)"})]})]})]})]})]})},Fz=function(e){e.models;var t=(0,k.useState)("stitching"),n=(0,C.Z)(t,2),r=n[0],a=n[1],i=(0,k.useState)(null),o=(0,C.Z)(i,2),u=o[0],s=o[1];return(0,rt.jsxs)("div",{style:{marginBottom:50},children:[(0,rt.jsx)("h2",{className:"display-6",children:"Practical Applications of Representational Convergence"}),(0,rt.jsxs)("div",{className:"container-sm",style:{marginTop:50,maxWidth:800},children:[(0,rt.jsxs)("div",{style:{textAlign:"justify"},children:["Understanding that different models learn similar representations opens up powerful practical applications. Let's explore how this insight enables new capabilities in model deployment, training, and development.",(0,rt.jsx)("br",{}),(0,rt.jsx)("br",{})]}),(0,rt.jsxs)(_a,{activeKey:r,onSelect:function(e){return a(e)},className:"mb-3",style:{marginTop:30},children:[(0,rt.jsx)(Ta,{eventKey:"stitching",title:"Model Stitching",children:(0,rt.jsxs)("div",{style:{textAlign:"justify",marginTop:20},children:[(0,rt.jsx)("h4",{className:"display-8",children:"What is Model Stitching?"}),(0,rt.jsxs)("p",{children:[(0,rt.jsx)("span",{className:"emph",children:"Model stitching"})," is the ability to swap components between different models because their intermediate representations are compatible. If CLIP and ALIGN learn similar image embeddings, we can use CLIP's image encoder with ALIGN's text encoder!"]}),(0,rt.jsxs)("div",{style:{backgroundColor:"#e8f4f8",padding:20,borderRadius:8,marginBottom:20},children:[(0,rt.jsx)("strong",{children:"How It Works:"}),(0,rt.jsxs)("ol",{style:{marginTop:10},children:[(0,rt.jsx)("li",{children:"Train models A and B independently on similar tasks"}),(0,rt.jsx)("li",{children:"Verify representational similarity (CKA > 0.7)"}),(0,rt.jsx)("li",{children:"Replace a component from A with the corresponding component from B"}),(0,rt.jsx)("li",{children:"Optionally fine-tune connection layers"}),(0,rt.jsx)("li",{children:"Deploy the hybrid model"})]})]}),(0,rt.jsx)("h4",{className:"display-8",children:"Why Stitch Models?"}),(0,rt.jsxs)("ul",{children:[(0,rt.jsxs)("li",{children:[(0,rt.jsx)("strong",{children:"Performance:"})," Combine strengths of different models (CLIP's vision + ALIGN's language)"]}),(0,rt.jsxs)("li",{children:[(0,rt.jsx)("strong",{children:"Efficiency:"})," Use smaller, faster components where possible"]}),(0,rt.jsxs)("li",{children:[(0,rt.jsx)("strong",{children:"Specialization:"})," Keep domain-specific encoder, swap general one"]}),(0,rt.jsxs)("li",{children:[(0,rt.jsx)("strong",{children:"Privacy:"})," Replace components trained on sensitive data"]})]}),(0,rt.jsx)("div",{style:{marginTop:20,marginBottom:20},children:(0,rt.jsx)(Oa,{variant:"primary",onClick:function(){s({sourceModel:"CLIP",targetModel:"ALIGN",component:"Image Encoder",accuracyBefore:.847,accuracyAfter:.831,message:"Successfully stitched! Only 1.6% performance drop."})},children:"Demonstrate Stitching"})}),u&&(0,rt.jsxs)(oz,{variant:"success",children:[(0,rt.jsx)(oz.Heading,{children:"Stitching Result"}),(0,rt.jsxs)("p",{children:[(0,rt.jsx)("strong",{children:"Source:"})," ",u.sourceModel," (",u.component,")",(0,rt.jsx)("br",{}),(0,rt.jsx)("strong",{children:"Target:"})," ",u.targetModel,(0,rt.jsx)("br",{}),(0,rt.jsx)("strong",{children:"Original Accuracy:"})," ",(100*u.accuracyBefore).toFixed(1),"%",(0,rt.jsx)("br",{}),(0,rt.jsx)("strong",{children:"Stitched Accuracy:"})," ",(100*u.accuracyAfter).toFixed(1),"%",(0,rt.jsx)("br",{}),(0,rt.jsx)("strong",{children:"Performance Drop:"})," ",(100*(u.accuracyBefore-u.accuracyAfter)).toFixed(1),"%"]}),(0,rt.jsx)("hr",{}),(0,rt.jsx)("p",{className:"mb-0",children:u.message})]}),(0,rt.jsx)("h4",{className:"display-8",children:"Real-World Example"}),(0,rt.jsxs)("div",{style:{backgroundColor:"#fff3cd",padding:20,borderRadius:8},children:[(0,rt.jsx)("strong",{children:"Scenario:"})," You have a CLIP model trained on general images and an industry-specific model trained on medical images. You want medical understanding with general language capabilities.",(0,rt.jsx)("br",{}),(0,rt.jsx)("br",{}),(0,rt.jsx)("strong",{children:"Solution:"})," Stitch the medical image encoder with CLIP's text encoder. Because they learned similar representational structures, they're compatible with minimal fine-tuning!"]})]})}),(0,rt.jsx)(Ta,{eventKey:"merging",title:"Model Merging",children:(0,rt.jsxs)("div",{style:{textAlign:"justify",marginTop:20},children:[(0,rt.jsx)("h4",{className:"display-8",children:"Weight Space Merging"}),(0,rt.jsxs)("p",{children:["If models converge to similar representations, their weights occupy similar regions of parameter space. We can ",(0,rt.jsx)("span",{className:"emph",children:"merge"})," them by averaging weights or using more sophisticated techniques."]}),(0,rt.jsxs)("div",{style:{backgroundColor:"#e8f4f8",padding:20,borderRadius:8,marginBottom:20},children:[(0,rt.jsx)("strong",{children:"Simple Average Merging:"}),(0,rt.jsx)("div",{style:{fontFamily:"monospace",marginTop:10},children:"\u03b8_merged = (\u03b8_model1 + \u03b8_model2) / 2"}),(0,rt.jsx)("p",{style:{marginTop:10,marginBottom:0},children:"Surprisingly effective when models are trained on similar data! Often achieves performance between or even better than individual models."})]}),(0,rt.jsx)("h4",{className:"display-8",children:"Advanced Merging Techniques"}),(0,rt.jsx)("strong",{children:"1. Task Arithmetic"}),(0,rt.jsxs)("ul",{children:[(0,rt.jsx)("li",{children:"Learn task-specific directions in weight space"}),(0,rt.jsx)("li",{children:"Add/subtract these directions to control capabilities"}),(0,rt.jsx)("li",{children:"Example: \u03b8_multilingual = \u03b8_base + (\u03b8_french - \u03b8_base) + (\u03b8_spanish - \u03b8_base)"})]}),(0,rt.jsx)("strong",{children:"2. SLERP (Spherical Linear Interpolation)"}),(0,rt.jsxs)("ul",{children:[(0,rt.jsx)("li",{children:"Interpolate along geodesics in weight space"}),(0,rt.jsx)("li",{children:"Preserves normalization and representational geometry"}),(0,rt.jsx)("li",{children:"Better than linear averaging for normalized embeddings"})]}),(0,rt.jsx)("strong",{children:"3. Fisher-Weighted Merging"}),(0,rt.jsxs)("ul",{children:[(0,rt.jsx)("li",{children:"Weight parameters by their importance (Fisher information)"}),(0,rt.jsx)("li",{children:"Preserve critical parameters, average less important ones"}),(0,rt.jsx)("li",{children:"Maintains performance better than simple averaging"})]}),(0,rt.jsxs)("div",{style:{backgroundColor:"#d4edda",padding:20,borderRadius:8,marginTop:20},children:[(0,rt.jsx)("strong",{children:"Why Merging Works:"})," Representational convergence means models have learned similar functions. In weight space, this translates to parameters occupying nearby regions. Averaging finds a point that approximates both functions, often with minimal performance loss."]}),(0,rt.jsx)("h4",{className:"display-8",children:"Applications"}),(0,rt.jsxs)("ul",{children:[(0,rt.jsxs)("li",{children:[(0,rt.jsx)("strong",{children:"Multi-Task Models:"})," Merge specialists into generalist"]}),(0,rt.jsxs)("li",{children:[(0,rt.jsx)("strong",{children:"Continual Learning:"})," Merge new knowledge without forgetting"]}),(0,rt.jsxs)("li",{children:[(0,rt.jsx)("strong",{children:"Ensemble Without Inference Cost:"})," Get ensemble benefits in single model"]}),(0,rt.jsxs)("li",{children:[(0,rt.jsx)("strong",{children:"Federated Learning:"})," Merge models trained on distributed data"]})]})]})}),(0,rt.jsx)(Ta,{eventKey:"transfer",title:"Transfer & Reuse",children:(0,rt.jsxs)("div",{style:{textAlign:"justify",marginTop:20},children:[(0,rt.jsx)("h4",{className:"display-8",children:"Zero-Shot Transfer Across Models"}),(0,rt.jsxs)("p",{children:["Representational convergence enables ",(0,rt.jsx)("span",{className:"emph",children:"cross-model transfer"}),": train a classifier on Model A's representations, deploy on Model B."]}),(0,rt.jsxs)("div",{style:{backgroundColor:"#e8f4f8",padding:20,borderRadius:8,marginBottom:20},children:[(0,rt.jsx)("strong",{children:"Example Workflow:"}),(0,rt.jsxs)("ol",{style:{marginTop:10},children:[(0,rt.jsx)("li",{children:"Extract embeddings from CLIP for your dataset"}),(0,rt.jsx)("li",{children:"Train a linear classifier on these embeddings"}),(0,rt.jsx)("li",{children:"Deploy using ALIGN embeddings (no retraining!)"}),(0,rt.jsx)("li",{children:"Performance degrades only ~5-10% despite different models"})]})]}),(0,rt.jsx)("h4",{className:"display-8",children:"Knowledge Distillation"}),(0,rt.jsx)("p",{children:"Use a large model's representations to train a smaller, faster model:"}),(0,rt.jsxs)("ul",{children:[(0,rt.jsxs)("li",{children:[(0,rt.jsx)("strong",{children:"Traditional Distillation:"})," Match output distributions"]}),(0,rt.jsxs)("li",{children:[(0,rt.jsx)("strong",{children:"Representation Distillation:"})," Match intermediate embeddings"]}),(0,rt.jsxs)("li",{children:[(0,rt.jsx)("strong",{children:"Cross-Model Distillation:"})," Distill from any model with similar representations"]})]}),(0,rt.jsxs)("div",{style:{backgroundColor:"#fff3cd",padding:20,borderRadius:8,marginBottom:20},children:[(0,rt.jsx)("strong",{children:"Key Insight:"})," Because large models converge on similar representations, distillation targets are interchangeable. Train once, distill from any teacher!"]}),(0,rt.jsx)("h4",{className:"display-8",children:"Representation Reuse"}),(0,rt.jsx)("strong",{children:"Scenario 1: New Modality"}),(0,rt.jsxs)("ul",{children:[(0,rt.jsx)("li",{children:"Have: Trained image-text model"}),(0,rt.jsx)("li",{children:"Want: Add audio modality"}),(0,rt.jsx)("li",{children:"Solution: Train audio encoder to match existing embedding space"}),(0,rt.jsx)("li",{children:"Benefit: Leverage existing text and image understanding"})]}),(0,rt.jsx)("strong",{children:"Scenario 2: Domain Adaptation"}),(0,rt.jsxs)("ul",{children:[(0,rt.jsx)("li",{children:"Have: Model trained on natural images"}),(0,rt.jsx)("li",{children:"Want: Work on medical images"}),(0,rt.jsx)("li",{children:"Solution: Fine-tune medical encoder to match general representation structure"}),(0,rt.jsx)("li",{children:"Benefit: Transfer semantic understanding to new domain"})]}),(0,rt.jsxs)("div",{style:{backgroundColor:"#d4edda",padding:20,borderRadius:8,marginTop:20},children:[(0,rt.jsx)("strong",{children:"Research Finding:"})," Models fine-tuned on different downstream tasks maintain high representational similarity (CKA \u2248 0.75-0.85) in early layers, enabling significant reuse of learned features."]})]})}),(0,rt.jsx)(Ta,{eventKey:"development",title:"Development Benefits",children:(0,rt.jsxs)("div",{style:{textAlign:"justify",marginTop:20},children:[(0,rt.jsx)("h4",{className:"display-8",children:"Faster Model Development"}),(0,rt.jsx)("p",{children:"Understanding representational convergence accelerates the development cycle:"}),(0,rt.jsxs)("div",{style:{backgroundColor:"#e8f4f8",padding:20,borderRadius:8,marginBottom:20},children:[(0,rt.jsx)("strong",{children:"1. Architecture Search"}),(0,rt.jsxs)("ul",{style:{marginTop:10},children:[(0,rt.jsx)("li",{children:"Focus on efficiency rather than representation quality"}),(0,rt.jsx)("li",{children:"If convergence is guaranteed, optimize for speed/size"}),(0,rt.jsx)("li",{children:"Use smaller proxy models during search"}),(0,rt.jsx)("li",{children:"Validate final architecture produces converged representations"})]}),(0,rt.jsx)("strong",{children:"2. Hyperparameter Tuning"}),(0,rt.jsxs)("ul",{children:[(0,rt.jsx)("li",{children:"Measure convergence to known good models as optimization target"}),(0,rt.jsx)("li",{children:"Early stopping when representational similarity plateaus"}),(0,rt.jsx)("li",{children:"Transfer hyperparameters across similar architectures"})]}),(0,rt.jsx)("strong",{children:"3. Training Validation"}),(0,rt.jsxs)("ul",{children:[(0,rt.jsx)("li",{children:"Check intermediate representations against reference models"}),(0,rt.jsx)("li",{children:"Detect training bugs when representations diverge unexpectedly"}),(0,rt.jsx)("li",{children:"Verify new technique doesn't break learned structure"})]})]}),(0,rt.jsx)("h4",{className:"display-8",children:"Debugging and Interpretability"}),(0,rt.jsxs)("ul",{children:[(0,rt.jsxs)("li",{children:[(0,rt.jsx)("strong",{children:"Universal Features:"})," Features consistent across models are more likely meaningful"]}),(0,rt.jsxs)("li",{children:[(0,rt.jsx)("strong",{children:"Anomaly Detection:"})," Representations that diverge indicate potential issues"]}),(0,rt.jsxs)("li",{children:[(0,rt.jsx)("strong",{children:"Probing:"})," Probe classifiers transfer across models with similar representations"]}),(0,rt.jsxs)("li",{children:[(0,rt.jsx)("strong",{children:"Explanation:"})," Can use explanations from one model to understand another"]})]}),(0,rt.jsx)("h4",{className:"display-8",children:"Efficient Experimentation"}),(0,rt.jsxs)("div",{style:{backgroundColor:"#fff3cd",padding:20,borderRadius:8,marginBottom:20},children:[(0,rt.jsx)("strong",{children:"Practical Workflow:"}),(0,rt.jsxs)("ol",{style:{marginTop:10,marginBottom:0},children:[(0,rt.jsx)("li",{children:"Experiment with small, fast model"}),(0,rt.jsx)("li",{children:"Verify it converges to similar representations as SOTA"}),(0,rt.jsx)("li",{children:"Only scale up if convergence is good"}),(0,rt.jsx)("li",{children:"Saves compute: train 10 small models vs 1 large model"})]})]}),(0,rt.jsx)("h4",{className:"display-8",children:"Quality Assurance"}),(0,rt.jsx)("p",{children:"Use representational similarity as a quality metric:"}),(0,rt.jsxs)("ul",{children:[(0,rt.jsxs)("li",{children:[(0,rt.jsx)("strong",{children:"Model Updates:"})," Ensure new version maintains representation quality"]}),(0,rt.jsxs)("li",{children:[(0,rt.jsx)("strong",{children:"Deployment:"})," Check production model matches research model"]}),(0,rt.jsxs)("li",{children:[(0,rt.jsx)("strong",{children:"Quantization:"})," Verify compressed model preserves representations"]}),(0,rt.jsxs)("li",{children:[(0,rt.jsx)("strong",{children:"Hardware Migration:"})," Confirm representations survive platform changes"]})]}),(0,rt.jsxs)("div",{style:{backgroundColor:"#d4edda",padding:20,borderRadius:8,marginTop:20},children:[(0,rt.jsx)("strong",{children:"Best Practice:"}),' Establish a "representation test suite"\u2014a set of reference embeddings from validated models. Check new models against this suite before deployment.']})]})}),(0,rt.jsx)(Ta,{eventKey:"future",title:"Future Directions",children:(0,rt.jsxs)("div",{style:{textAlign:"justify",marginTop:20},children:[(0,rt.jsx)("h4",{className:"display-8",children:"Emerging Research Directions"}),(0,rt.jsx)("strong",{children:"1. Universal Representation Spaces"}),(0,rt.jsxs)("div",{style:{backgroundColor:"#e8f4f8",padding:15,borderRadius:8,marginTop:10,marginBottom:20},children:[(0,rt.jsx)("p",{children:"Goal: Create a single, shared embedding space that all models can plug into."}),(0,rt.jsxs)("ul",{style:{marginBottom:0},children:[(0,rt.jsx)("li",{children:"Any model can encode to this space"}),(0,rt.jsx)("li",{children:"Any application can consume from this space"}),(0,rt.jsx)("li",{children:"Enables true modularity in AI systems"})]})]}),(0,rt.jsx)("strong",{children:"2. Compositional Model Building"}),(0,rt.jsxs)("div",{style:{backgroundColor:"#e8f4f8",padding:15,borderRadius:8,marginTop:10,marginBottom:20},children:[(0,rt.jsx)("p",{children:"Build complex models by composing simpler components:"}),(0,rt.jsxs)("ul",{style:{marginBottom:0},children:[(0,rt.jsx)("li",{children:"Library of verified, converged encoders"}),(0,rt.jsx)("li",{children:"Mix and match for specific applications"}),(0,rt.jsx)("li",{children:"Formal guarantees on composed model behavior"})]})]}),(0,rt.jsx)("strong",{children:"3. Automatic Architecture Discovery"}),(0,rt.jsxs)("ul",{children:[(0,rt.jsx)("li",{children:"Search for architectures that converge to target representations"}),(0,rt.jsx)("li",{children:"Use representation similarity as search objective"}),(0,rt.jsx)("li",{children:"Discover efficient architectures that match SOTA representations"})]}),(0,rt.jsx)("strong",{children:"4. Cross-Modal Universal Models"}),(0,rt.jsxs)("ul",{children:[(0,rt.jsx)("li",{children:"ImageBind: Single model for 6+ modalities"}),(0,rt.jsx)("li",{children:"Any-to-Any models: Input any modality, output any modality"}),(0,rt.jsx)("li",{children:"Leverages representational convergence across modalities"})]}),(0,rt.jsx)("h4",{className:"display-8",children:"Open Questions"}),(0,rt.jsx)("div",{style:{backgroundColor:"#fff3cd",padding:20,borderRadius:8,marginBottom:20},children:(0,rt.jsxs)("ul",{style:{marginBottom:0},children:[(0,rt.jsx)("li",{children:"What are the theoretical limits of representational convergence?"}),(0,rt.jsx)("li",{children:"Can we predict convergence without training to completion?"}),(0,rt.jsx)("li",{children:"How does model capacity affect convergence patterns?"}),(0,rt.jsx)("li",{children:"What features are truly universal vs. dataset-specific?"}),(0,rt.jsx)("li",{children:"Can we enforce convergence during training for better interoperability?"})]})}),(0,rt.jsx)("h4",{className:"display-8",children:"Industry Impact"}),(0,rt.jsx)("strong",{children:"Model Marketplaces"}),(0,rt.jsxs)("ul",{children:[(0,rt.jsx)("li",{children:"Standardized embedding spaces enable model interchangeability"}),(0,rt.jsx)("li",{children:"Compare models objectively via representation similarity"}),(0,rt.jsx)("li",{children:"Guarantee backward compatibility"})]}),(0,rt.jsx)("strong",{children:"Federated and Collaborative AI"}),(0,rt.jsxs)("ul",{children:[(0,rt.jsx)("li",{children:"Different organizations train models independently"}),(0,rt.jsx)("li",{children:"Merge or stitch for collective benefit"}),(0,rt.jsx)("li",{children:"Privacy-preserving through representation alignment"})]}),(0,rt.jsx)("strong",{children:"Efficient AI Development"}),(0,rt.jsxs)("ul",{children:[(0,rt.jsx)("li",{children:"Reduce redundant training: reuse converged representations"}),(0,rt.jsx)("li",{children:"Focus innovation on novel components"}),(0,rt.jsx)("li",{children:"Lower barriers to entry: start from validated representations"})]}),(0,rt.jsxs)("div",{style:{backgroundColor:"#d4edda",padding:20,borderRadius:8,marginTop:20},children:[(0,rt.jsx)("strong",{children:"The Vision:"})," A future where AI models are modular, interoperable, and composable\u2014much like software libraries today. Representational convergence is the foundation that makes this vision possible."]})]})})]}),(0,rt.jsxs)("div",{style:{textAlign:"justify",marginTop:30},children:[(0,rt.jsx)("h4",{className:"display-8",children:"Try It Yourself"}),(0,rt.jsx)("p",{children:"The cross-model comparison tool above demonstrates these principles. Upload different types of images and observe how models produce similar matching scores\u2014evidence of representational convergence in action!"})]})]})]})},Mz=function(){var e=(0,k.useState)("why"),t=(0,C.Z)(e,2),n=t[0],r=t[1];return(0,rt.jsxs)("div",{style:{marginBottom:50},children:[(0,rt.jsx)("h2",{className:"display-6",children:"Why Do Models Converge?"}),(0,rt.jsxs)("div",{className:"container-sm",style:{marginTop:50,maxWidth:800},children:[(0,rt.jsxs)("div",{style:{textAlign:"justify"},children:["The convergence of representations across different models is not accidental\u2014it emerges from fundamental principles of learning, optimization, and the structure of visual-linguistic data itself. Let's explore the theoretical perspectives that explain this phenomenon.",(0,rt.jsx)("br",{}),(0,rt.jsx)("br",{})]}),(0,rt.jsxs)(_a,{activeKey:n,onSelect:function(e){return r(e)},className:"mb-3",style:{marginTop:30},children:[(0,rt.jsx)(Ta,{eventKey:"why",title:"Why Convergence?",children:(0,rt.jsxs)("div",{style:{textAlign:"justify",marginTop:20},children:[(0,rt.jsx)("h4",{className:"display-8",children:"1. Data Manifold Hypothesis"}),(0,rt.jsxs)("div",{style:{backgroundColor:"#e8f4f8",padding:20,borderRadius:8,marginBottom:20},children:[(0,rt.jsx)("strong",{children:"Core Idea:"})," Natural images and language don't occupy all possible configurations\u2014they lie on a low-dimensional manifold within the high-dimensional input space.",(0,rt.jsx)("br",{}),(0,rt.jsx)("br",{}),(0,rt.jsx)("strong",{children:"Implication:"})," Any learning algorithm that successfully captures this manifold will discover similar structure, regardless of the path taken to get there.",(0,rt.jsxs)("ul",{style:{marginTop:10},children:[(0,rt.jsx)("li",{children:"Dogs appear in limited poses, lighting conditions, contexts"}),(0,rt.jsx)("li",{children:"Language describing dogs uses consistent vocabulary and grammar"}),(0,rt.jsx)("li",{children:"The co-occurrence statistics of (image, text) constrain learned representations"})]})]}),(0,rt.jsx)("h4",{className:"display-8",children:"2. Optimization Landscape"}),(0,rt.jsxs)("div",{style:{backgroundColor:"#fff3cd",padding:20,borderRadius:8,marginBottom:20},children:[(0,rt.jsx)("strong",{children:"Core Idea:"}),' The loss landscape for multimodal learning has relatively few "good" solutions. Different optimization trajectories converge to the same basin.',(0,rt.jsx)("br",{}),(0,rt.jsx)("br",{}),(0,rt.jsx)("strong",{children:"Key Observations:"}),(0,rt.jsxs)("ul",{style:{marginTop:10},children:[(0,rt.jsxs)("li",{children:[(0,rt.jsx)("strong",{children:"Mode Connectivity:"})," Different local minima are often connected by paths of similar loss"]}),(0,rt.jsxs)("li",{children:[(0,rt.jsx)("strong",{children:"Over-parameterization:"})," Modern models have many parameters, creating multiple equivalent solutions"]}),(0,rt.jsxs)("li",{children:[(0,rt.jsx)("strong",{children:"Implicit Regularization:"})," SGD naturally favors solutions with certain properties (e.g., flat minima)"]}),(0,rt.jsxs)("li",{children:[(0,rt.jsx)("strong",{children:"Loss Geometry:"})," Contrastive loss creates a geometry where similar concepts must be close"]})]})]}),(0,rt.jsx)("h4",{className:"display-8",children:"3. Inductive Biases"}),(0,rt.jsxs)("div",{style:{backgroundColor:"#f8d7da",padding:20,borderRadius:8,marginBottom:20},children:[(0,rt.jsx)("strong",{children:"Core Idea:"})," Despite architectural differences, common design principles guide all models toward similar solutions.",(0,rt.jsx)("br",{}),(0,rt.jsx)("br",{}),(0,rt.jsx)("strong",{children:"Shared Biases:"}),(0,rt.jsxs)("ul",{style:{marginTop:10},children:[(0,rt.jsxs)("li",{children:[(0,rt.jsx)("strong",{children:"Locality:"})," Convolutions and local attention bias toward spatial coherence"]}),(0,rt.jsxs)("li",{children:[(0,rt.jsx)("strong",{children:"Hierarchy:"})," Deep networks naturally learn hierarchical features"]}),(0,rt.jsxs)("li",{children:[(0,rt.jsx)("strong",{children:"Translation Invariance:"})," Architectural choices promote position-independent features"]}),(0,rt.jsxs)("li",{children:[(0,rt.jsx)("strong",{children:"Compositionality:"})," Attention mechanisms encourage compositional understanding"]})]})]}),(0,rt.jsx)("h4",{className:"display-8",children:"4. Information Bottleneck Theory"}),(0,rt.jsxs)("div",{style:{backgroundColor:"#d4edda",padding:20,borderRadius:8,marginBottom:20},children:[(0,rt.jsx)("strong",{children:"Core Idea:"})," Neural networks learn to compress inputs while retaining task-relevant information. The optimal compression is largely task-dependent, not architecture-dependent.",(0,rt.jsx)("br",{}),(0,rt.jsx)("br",{}),(0,rt.jsx)("strong",{children:"Formulation:"}),(0,rt.jsxs)("ul",{style:{marginTop:10},children:[(0,rt.jsx)("li",{children:"Maximize mutual information I(Z; Y) between representations Z and labels Y"}),(0,rt.jsx)("li",{children:"Minimize mutual information I(Z; X) between representations Z and inputs X"}),(0,rt.jsx)("li",{children:"This creates a minimal sufficient statistic\u2014the simplest representation that preserves task information"}),(0,rt.jsx)("li",{children:"Different architectures converge to similar sufficient statistics"})]})]}),(0,rt.jsx)("h4",{className:"display-8",children:"5. Task-Driven Convergence"}),(0,rt.jsx)("p",{children:"The contrastive learning objective itself strongly constrains learned representations:"}),(0,rt.jsxs)("ul",{children:[(0,rt.jsxs)("li",{children:[(0,rt.jsx)("strong",{children:"Alignment:"})," Matching pairs must be close \u2192 models learn similar concept groupings"]}),(0,rt.jsxs)("li",{children:[(0,rt.jsx)("strong",{children:"Uniformity:"})," Non-matching pairs pushed apart \u2192 models spread representations uniformly"]}),(0,rt.jsxs)("li",{children:[(0,rt.jsx)("strong",{children:"Semantic Structure:"})," Co-occurrence patterns in data enforce similar semantic relationships"]}),(0,rt.jsxs)("li",{children:[(0,rt.jsx)("strong",{children:"Zero-Shot Transfer:"})," The need to generalize encourages learning universal features"]})]})]})}),(0,rt.jsx)(Ta,{eventKey:"when",title:"When Does It Occur?",children:(0,rt.jsxs)("div",{style:{textAlign:"justify",marginTop:20},children:[(0,rt.jsx)("h4",{className:"display-8",children:"Conditions for Strong Convergence"}),(0,rt.jsxs)("div",{style:{backgroundColor:"#e8f4f8",padding:20,borderRadius:8,marginBottom:20},children:[(0,rt.jsx)("strong",{children:"\u2705 Convergence is High When:"}),(0,rt.jsxs)("ul",{style:{marginTop:10},children:[(0,rt.jsxs)("li",{children:[(0,rt.jsx)("strong",{children:"Similar Training Objectives:"})," All models use contrastive learning"]}),(0,rt.jsxs)("li",{children:[(0,rt.jsx)("strong",{children:"Sufficient Capacity:"})," Models have enough parameters to capture data structure"]}),(0,rt.jsxs)("li",{children:[(0,rt.jsx)("strong",{children:"Adequate Training:"})," Models trained to convergence (not underfitted)"]}),(0,rt.jsxs)("li",{children:[(0,rt.jsx)("strong",{children:"Overlapping Data Distributions:"})," Training sets sample from similar distributions"]}),(0,rt.jsxs)("li",{children:[(0,rt.jsx)("strong",{children:"Common Concepts:"})," Testing on concepts well-represented in all training sets"]}),(0,rt.jsxs)("li",{children:[(0,rt.jsx)("strong",{children:"Later Layers:"})," Higher layers show more convergence than early layers"]})]})]}),(0,rt.jsxs)("div",{style:{backgroundColor:"#fff3cd",padding:20,borderRadius:8,marginBottom:20},children:[(0,rt.jsx)("strong",{children:"\u26a0\ufe0f Convergence is Lower When:"}),(0,rt.jsxs)("ul",{style:{marginTop:10},children:[(0,rt.jsxs)("li",{children:[(0,rt.jsx)("strong",{children:"Different Objectives:"})," E.g., contrastive vs. generative vs. discriminative"]}),(0,rt.jsxs)("li",{children:[(0,rt.jsx)("strong",{children:"Limited Capacity:"})," Small models may not capture full data structure"]}),(0,rt.jsxs)("li",{children:[(0,rt.jsx)("strong",{children:"Under-training:"})," Models stopped before convergence"]}),(0,rt.jsxs)("li",{children:[(0,rt.jsx)("strong",{children:"Different Data Domains:"})," One trained on photos, another on drawings"]}),(0,rt.jsxs)("li",{children:[(0,rt.jsx)("strong",{children:"Rare Concepts:"})," Testing on categories not in training data"]}),(0,rt.jsxs)("li",{children:[(0,rt.jsx)("strong",{children:"Early Layers:"})," Low-level features more architecture-dependent"]})]})]}),(0,rt.jsx)("h4",{className:"display-8",children:"Empirical Findings from Research"}),(0,rt.jsxs)("ul",{children:[(0,rt.jsxs)("li",{children:[(0,rt.jsx)("strong",{children:"Layer-wise Analysis:"})," CKA similarity increases from ~0.4 in early layers to ~0.85 in final layers"]}),(0,rt.jsxs)("li",{children:[(0,rt.jsx)("strong",{children:"Dataset Size:"})," Convergence improves with larger, more diverse training sets"]}),(0,rt.jsxs)("li",{children:[(0,rt.jsx)("strong",{children:"Architecture Families:"})," Within family (all CNNs or all Transformers): CKA > 0.9; across families: CKA \u2248 0.7-0.8"]}),(0,rt.jsxs)("li",{children:[(0,rt.jsx)("strong",{children:"Fine-tuning:"})," Task-specific fine-tuning reduces convergence slightly but structure remains"]})]}),(0,rt.jsx)("h4",{className:"display-8",children:'The "Lottery Ticket" Perspective'}),(0,rt.jsx)("div",{style:{backgroundColor:"#f8d7da",padding:15,borderRadius:8,marginTop:15},children:(0,rt.jsx)("p",{children:'Some researchers propose that there are many equivalent "winning tickets" in the parameter space\u2014different initializations and training runs find different tickets, but they all implement similar functions. This explains why convergence isn\'t perfect (different tickets) but is very high (all winning tickets solve the same problem similarly).'})})]})}),(0,rt.jsx)(Ta,{eventKey:"neuro",title:"Neuroscience Parallels",children:(0,rt.jsxs)("div",{style:{textAlign:"justify",marginTop:20},children:[(0,rt.jsx)("h4",{className:"display-8",children:"Biological-Artificial Convergence"}),(0,rt.jsx)("p",{children:"The same principles that drive artificial neural networks to converge may explain why biological brains develop similar representations:"}),(0,rt.jsxs)("div",{style:{backgroundColor:"#e8f4f8",padding:20,borderRadius:8,marginBottom:20},children:[(0,rt.jsx)("strong",{children:"Visual System Hierarchies"}),(0,rt.jsxs)("ul",{style:{marginTop:10},children:[(0,rt.jsxs)("li",{children:[(0,rt.jsx)("strong",{children:"V1 (Primary Visual Cortex):"})," Edge detectors, orientation selectivity",(0,rt.jsx)("br",{}),"\u2192 ",(0,rt.jsx)("em",{children:"Similar to first CNN layer Gabor-like filters"})]}),(0,rt.jsxs)("li",{children:[(0,rt.jsx)("strong",{children:"V2/V4 (Intermediate Areas):"})," Texture, color, simple shapes",(0,rt.jsx)("br",{}),"\u2192 ",(0,rt.jsx)("em",{children:"Similar to mid-layer CNN features"})]}),(0,rt.jsxs)("li",{children:[(0,rt.jsx)("strong",{children:"IT (Inferotemporal Cortex):"})," Object-selective neurons",(0,rt.jsx)("br",{}),"\u2192 ",(0,rt.jsx)("em",{children:"Similar to high-layer CNN features"})]})]})]}),(0,rt.jsxs)("div",{style:{backgroundColor:"#fff3cd",padding:20,borderRadius:8,marginBottom:20},children:[(0,rt.jsx)("strong",{children:"Shared Constraints"}),(0,rt.jsx)("p",{children:"Both biological and artificial systems face similar constraints:"}),(0,rt.jsxs)("ul",{children:[(0,rt.jsxs)("li",{children:[(0,rt.jsx)("strong",{children:"Energy Efficiency:"})," Sparse coding reduces metabolic/computational cost"]}),(0,rt.jsxs)("li",{children:[(0,rt.jsx)("strong",{children:"Generalization:"})," Must handle novel stimuli with limited training"]}),(0,rt.jsxs)("li",{children:[(0,rt.jsx)("strong",{children:"Invariance:"})," Recognize objects despite transformations"]}),(0,rt.jsxs)("li",{children:[(0,rt.jsx)("strong",{children:"Speed:"})," Fast inference for survival/real-time applications"]}),(0,rt.jsxs)("li",{children:[(0,rt.jsx)("strong",{children:"Noise Robustness:"})," Function despite imperfect inputs"]})]})]}),(0,rt.jsx)("h4",{className:"display-8",children:"Evidence from Neuroscience Studies"}),(0,rt.jsxs)("ul",{children:[(0,rt.jsxs)("li",{children:[(0,rt.jsx)("strong",{children:"fMRI Studies:"})," Neural response patterns to images correlate with CNN activations (r \u2248 0.6-0.8)"]}),(0,rt.jsxs)("li",{children:[(0,rt.jsx)("strong",{children:"Representational Similarity:"})," Human IT cortex and CNN final layers show similar RSA patterns"]}),(0,rt.jsxs)("li",{children:[(0,rt.jsx)("strong",{children:"Developmental Convergence:"})," Infant visual systems and trained CNNs both progress from simple to complex features"]}),(0,rt.jsxs)("li",{children:[(0,rt.jsx)("strong",{children:"Cross-Species:"})," Macaque and human visual cortex show similar representational structure"]})]}),(0,rt.jsx)("h4",{className:"display-8",children:"Efficient Coding Hypothesis"}),(0,rt.jsxs)("div",{style:{backgroundColor:"#d4edda",padding:20,borderRadius:8,marginTop:15},children:[(0,rt.jsx)("strong",{children:"Barlow's Hypothesis (1961):"})," Sensory systems evolved to efficiently encode natural stimuli by removing statistical redundancy.",(0,rt.jsx)("br",{}),(0,rt.jsx)("br",{}),(0,rt.jsx)("strong",{children:"Modern Interpretation:"})," Both evolution and gradient descent discover similar efficient codes for the same statistical environment (natural images). This explains convergence across:",(0,rt.jsxs)("ul",{style:{marginTop:10,marginBottom:0},children:[(0,rt.jsx)("li",{children:"Different species (evolution found similar solutions)"}),(0,rt.jsx)("li",{children:"Different neural architectures (SGD found similar solutions)"}),(0,rt.jsx)("li",{children:"Biological and artificial systems (same optimization problem)"})]})]}),(0,rt.jsx)("h4",{className:"display-8",children:"Implications for AI"}),(0,rt.jsx)("p",{children:"Understanding why biological and artificial systems converge suggests:"}),(0,rt.jsxs)("ul",{children:[(0,rt.jsx)("li",{children:'There may be fundamental "canonical" representations for visual understanding'}),(0,rt.jsx)("li",{children:"Neuroscience can guide architecture design toward these canonical forms"}),(0,rt.jsx)("li",{children:"Artificial models may help us understand biological computation"}),(0,rt.jsx)("li",{children:"Universal learning principles transcend substrate (neurons vs. silicon)"})]})]})}),(0,rt.jsx)(Ta,{eventKey:"math",title:"Mathematical Framework",children:(0,rt.jsxs)("div",{style:{textAlign:"justify",marginTop:20},children:[(0,rt.jsx)("h4",{className:"display-8",children:"Formalizing Representational Similarity"}),(0,rt.jsxs)("div",{style:{backgroundColor:"#f8f9fa",padding:20,borderRadius:8,marginBottom:20},children:[(0,rt.jsx)("strong",{children:"Setup:"})," Consider two models f and g producing representations:",(0,rt.jsxs)("ul",{style:{marginTop:10},children:[(0,rt.jsx)("li",{children:"f: X \u2192 Z_f (model f's representation)"}),(0,rt.jsx)("li",{children:"g: X \u2192 Z_g (model g's representation)"}),(0,rt.jsx)("li",{children:"Where X is input space, Z_f and Z_g are embedding spaces"})]})]}),(0,rt.jsx)("h4",{className:"display-8",children:"Similarity Metrics"}),(0,rt.jsx)("strong",{children:"1. Centered Kernel Alignment (CKA)"}),(0,rt.jsxs)("div",{style:{fontFamily:"monospace",backgroundColor:"#e8f4f8",padding:15,borderRadius:8,margin:"10px 0 20px 0"},children:["CKA(Z_f, Z_g) = \u2551H\xb7Z_f\xb7Z_f^T\xb7H\u2551_F \xb7 \u2551H\xb7Z_g\xb7Z_g^T\xb7H\u2551_F / (\u2551H\xb7Z_f\xb7Z_f^T\xb7H\u2551_F \xb7 \u2551H\xb7Z_g\xb7Z_g^T\xb7H\u2551_F)",(0,rt.jsx)("br",{}),(0,rt.jsx)("br",{}),"where H is the centering matrix"]}),(0,rt.jsxs)("p",{children:[(0,rt.jsx)("strong",{children:"Properties:"})," Invariant to orthogonal transformations and isotropic scaling; ranges [0, 1]"]}),(0,rt.jsx)("strong",{children:"2. Representational Similarity Analysis (RSA)"}),(0,rt.jsxs)("div",{style:{fontFamily:"monospace",backgroundColor:"#e8f4f8",padding:15,borderRadius:8,margin:"10px 0 20px 0"},children:["RSA(f, g) = corr(RDM_f, RDM_g)",(0,rt.jsx)("br",{}),(0,rt.jsx)("br",{}),"where RDM is the representational dissimilarity matrix:",(0,rt.jsx)("br",{}),"RDM_f[i,j] = d(f(x_i), f(x_j))"]}),(0,rt.jsxs)("p",{children:[(0,rt.jsx)("strong",{children:"Properties:"})," Compares pairwise distance structure; robust to monotonic transformations"]}),(0,rt.jsx)("strong",{children:"3. Linear Predictability"}),(0,rt.jsxs)("div",{style:{fontFamily:"monospace",backgroundColor:"#e8f4f8",padding:15,borderRadius:8,margin:"10px 0 20px 0"},children:["LP(f\u2192g) = max_W \u2551W\xb7Z_f - Z_g\u2551\xb2",(0,rt.jsx)("br",{}),(0,rt.jsx)("br",{}),"Find best linear map from f's representations to g's"]}),(0,rt.jsxs)("p",{children:[(0,rt.jsx)("strong",{children:"Properties:"})," Measures if representations are linearly related; asymmetric"]}),(0,rt.jsx)("h4",{className:"display-8",children:"Convergence as Optimization"}),(0,rt.jsxs)("div",{style:{backgroundColor:"#fff3cd",padding:20,borderRadius:8,marginBottom:20},children:[(0,rt.jsx)("strong",{children:"Contrastive Learning Objective:"}),(0,rt.jsx)("div",{style:{fontFamily:"monospace",margin:"10px 0"},children:"L = -\u03a3 log(exp(sim(z_i, z_i^+)/\u03c4) / \u03a3_j exp(sim(z_i, z_j)/\u03c4))"}),"where z_i^+ is the matching pair and z_j are negative samples.",(0,rt.jsx)("br",{}),(0,rt.jsx)("br",{}),(0,rt.jsx)("strong",{children:"Key Insight:"})," This objective is (mostly) architecture-agnostic! Any model minimizing this loss must:",(0,rt.jsxs)("ul",{style:{marginTop:10,marginBottom:0},children:[(0,rt.jsx)("li",{children:"Place matching pairs close together"}),(0,rt.jsx)("li",{children:"Spread non-matching pairs uniformly"}),(0,rt.jsx)("li",{children:"Preserve semantic relationships from data"})]})]}),(0,rt.jsx)("h4",{className:"display-8",children:"Identifiability Theory"}),(0,rt.jsxs)("p",{children:["From a theoretical ML perspective, the question is: ",(0,rt.jsx)("em",{children:"Under what conditions is the learned representation uniquely determined?"})]}),(0,rt.jsxs)("ul",{children:[(0,rt.jsxs)("li",{children:[(0,rt.jsx)("strong",{children:"Identifiable:"})," If the data generating process uniquely determines the representation (up to simple transformations)"]}),(0,rt.jsxs)("li",{children:[(0,rt.jsx)("strong",{children:"Over-parametrized:"})," Modern models have many equivalent solutions, but functional form is often similar"]}),(0,rt.jsxs)("li",{children:[(0,rt.jsx)("strong",{children:"Symmetries:"})," Some variations (permutations, rotations) don't affect function"]})]}),(0,rt.jsxs)("div",{style:{backgroundColor:"#d4edda",padding:20,borderRadius:8,marginTop:20},children:[(0,rt.jsx)("strong",{children:"Theoretical Result:"})," Under mild assumptions about the data distribution and assuming convergence, contrastive learning provably recovers representations that are unique up to invertible transformations. This explains why different models converge\u2014they're all finding (essentially) the same solution!"]})]})})]})]})]})},Oz=function(){var e=(0,k.useState)({}),t=(0,C.Z)(e,2),n=t[0],r=t[1];return(0,k.useEffect)((function(){window.scrollTo(0,0)}),[]),(0,rt.jsxs)("div",{className:"container-sm",style:{maxWidth:1e3},children:[(0,rt.jsxs)("div",{className:"frame",style:{backgroundColor:"#f0f4ff",justifyContent:"center"},children:[(0,rt.jsx)("h1",{className:"display-4",children:"Universal Representations in Multimodal Learning"}),(0,rt.jsx)("h2",{className:"display-5",style:{color:"#646161",padding:"0 20px",marginTop:20},children:"Why Different Models Converge on Similar Image-Text Embeddings"}),(0,rt.jsxs)("div",{className:"container-sm",style:{marginTop:50,maxWidth:800,textAlign:"justify"},children:["A fascinating phenomenon emerges when training multimodal models: ",(0,rt.jsx)("span",{className:"emph",children:"despite differences in architecture, training procedures, and datasets, different models learn remarkably similar representations"}),". CLIP, ALIGN, BLIP, and other vision-language models all converge on similar ways of organizing visual and linguistic concepts in their embedding spaces.",(0,rt.jsx)("div",{className:"container-sm",style:{justifyContent:"center",display:"flex"},children:(0,rt.jsxs)("ul",{children:[(0,rt.jsxs)("li",{children:[(0,rt.jsx)("span",{className:"emph",children:"Representational Convergence"}),': Different models cluster "dog" images and text near each other in similar ways']}),(0,rt.jsxs)("li",{children:[(0,rt.jsx)("span",{className:"emph",children:"Emergent Structure"}),": The geometry of learned representations reflects the underlying structure of visual-linguistic data"]}),(0,rt.jsxs)("li",{children:[(0,rt.jsx)("span",{className:"emph",children:"Universal Features"}),": Certain features (edges, colors, semantic concepts) emerge consistently across architectures"]})]})})]}),(0,rt.jsx)("hr",{style:{margin:"30px 20px"}}),(0,rt.jsx)(xz,{}),(0,rt.jsx)("hr",{style:{margin:"30px 20px"}}),(0,rt.jsx)(Dz,{}),(0,rt.jsx)("hr",{style:{margin:"30px 20px"}}),(0,rt.jsx)(Iz,{setModels:r}),(0,rt.jsx)("hr",{style:{margin:"30px 20px"}}),(0,rt.jsx)(Mz,{}),(0,rt.jsx)("hr",{style:{margin:"30px 20px"}}),(0,rt.jsx)(Fz,{models:n}),(0,rt.jsx)("hr",{style:{margin:"30px 20px"}})]}),(0,rt.jsx)("hr",{style:{margin:0},className:"border border-2 "})]})},Rz=function(){var e=(0,k.useRef)(),t=(0,k.useState)(50),n=(0,C.Z)(t,2),r=n[0],a=n[1];(0,k.useEffect)((function(){o()}),[r]);var i=function(e){return e<=20?{level:"Completely Opaque",icon:"\ud83d\udd12",color:"#e74c3c",description:"These models are essentially black boxes. They can recognize patterns and make predictions, but provide no insight into how they reach their conclusions.",examples:["Deep Neural Networks","Ensemble Methods","Complex Architectures"],pros:["High accuracy","Handles complex data","State-of-the-art performance"],cons:["No interpretability","Cannot debug failures","Trust issues"]}:e<=40?{level:"Mostly Opaque",icon:"\ud83e\udde0",color:"#ff9800",description:"These models produce amazing results but their reasoning is largely opaque. While we can extract some insights, the full decision process remains mysterious.",examples:["Large Language Models","Deep CNNs","Complex Transformers"],pros:["High performance","Some interpretability tools","Impressive capabilities"],cons:["Limited transparency","Hard to debug","Black box reasoning"]}:e<=60?{level:"The Messy Middle",icon:"\ud83c\udfad",color:"#667eea",description:"Multimodal AI systems live here. We can visualize attention maps showing which image regions correspond to which words, but mysteries remain about how they learn abstract concepts.",examples:["Multimodal Transformers","Vision-Language Models","Cross-modal Attention"],pros:["Visual attention maps","Cross-modal insights","Powerful capabilities"],cons:["Partial understanding","Abstract concepts unclear","Complex interactions"]}:e<=80?{level:"Mostly Transparent",icon:"\ud83d\udd0d",color:"#66bb6a",description:"These models offer good interpretability with some complexity. While not every detail is visible, the main decision factors are clear and understandable.",examples:["Logistic Regression","Naive Bayes","Simple Neural Networks"],pros:["Good balance","Main factors visible","Reasonable complexity"],cons:["Some opacity","Limited to simpler patterns"]}:{level:"Fully Transparent",icon:"\ud83d\udd13",color:"#4caf50",description:"These models are completely interpretable. Every decision can be traced step-by-step, making them ideal for high-stakes applications where trust and accountability are crucial.",examples:["Decision Trees","Linear Regression","Rule-based Systems"],pros:["Complete transparency","Easy to debug","Regulatory compliance"],cons:["Limited complexity","May not capture complex patterns"]}},o=function(){TB(e.current).selectAll("*").remove();var t=TB(e.current).attr("width",800).attr("height",500),n=t.append("defs"),i=n.append("linearGradient").attr("id","spectrumGradient").attr("x1","0%").attr("x2","100%");i.append("stop").attr("offset","0%").attr("stop-color","#1a1a1a").attr("stop-opacity",1),i.append("stop").attr("offset","50%").attr("stop-color","#667eea").attr("stop-opacity",.8),i.append("stop").attr("offset","100%").attr("stop-color","#e3f2fd").attr("stop-opacity",1),t.append("rect").attr("x",50).attr("y",200).attr("width",700).attr("height",80).attr("fill","url(#spectrumGradient)").attr("rx",40).attr("opacity",.3);var o=n.append("filter").attr("id","glow");o.append("feGaussianBlur").attr("stdDeviation","4").attr("result","coloredBlur");var u=o.append("feMerge");u.append("feMergeNode").attr("in","coloredBlur"),u.append("feMergeNode").attr("in","SourceGraphic");[{name:"Deep CNN",pos:10,icon:"\ud83d\udd2e",color:"#e74c3c",desc:"Millions of params\ncompletely mysterious"},{name:"GPT-4",pos:25,icon:"\ud83e\udde0",color:"#ff9800",desc:"Amazing results\nopaque reasoning"},{name:"Multimodal AI\n(The Messy Middle)",pos:50,icon:"\ud83c\udfad",color:"#667eea",desc:"Can see attention\nbut mysteries remain",special:!0},{name:"Linear\nRegression",pos:80,icon:"\ud83d\udcca",color:"#66bb6a",desc:"Simple equations\neasy to interpret"},{name:"Decision\nTree",pos:90,icon:"\ud83c\udf33",color:"#4caf50",desc:"Crystal clear\nevery step visible"}].forEach((function(e){var n=50+e.pos/100*700,i=Math.abs(e.pos-r)<15,o=Math.abs(e.pos-r)<5,u=e.special?80:o?70:50,s=t.append("g").attr("class","model-group").style("cursor","pointer").on("click",(function(){return a(e.pos)}));(o&&s.append("circle").attr("cx",n).attr("cy",240).attr("r",u+15).attr("fill",e.color).attr("opacity",.3).attr("class","pulse-circle").style("animation","pulse 2s infinite"),s.append("circle").attr("cx",n).attr("cy",240).attr("r",u).attr("fill",e.color).attr("opacity",o?.9:i?.7:.5).attr("stroke",o?"#fff":e.color).attr("stroke-width",o?4:2).attr("filter",o?"url(#glow)":"none"),s.append("text").attr("x",n).attr("y",250).attr("text-anchor","middle").style("font-size",e.special?"40px":"30px").text(e.icon),e.name.split("\n").forEach((function(t,r){s.append("text").attr("x",n).attr("y",120+16*r).attr("text-anchor","middle").style("font-size",e.special?"14px":"12px").style("font-weight",e.special?"bold":"600").style("fill",e.special?"#667eea":"#333").text(t)})),o)&&e.desc.split("\n").forEach((function(e,t){s.append("text").attr("x",n).attr("y",340+14*t).attr("text-anchor","middle").style("font-size","11px").style("fill","#666").text(e)}))})),t.append("text").attr("x",50).attr("y",180).attr("text-anchor","middle").style("font-size","14px").style("font-weight","bold").style("fill","#e74c3c").text("\ud83d\udd12 Opaque"),t.append("text").attr("x",750).attr("y",180).attr("text-anchor","middle").style("font-size","14px").style("font-weight","bold").style("fill","#4caf50").text("\ud83d\udd13 Transparent");var s=50+r/100*700;t.append("line").attr("x1",s).attr("y1",195).attr("x2",s).attr("y2",285).attr("stroke","#fff").attr("stroke-width",4).attr("stroke-linecap","round").attr("filter","url(#glow)");for(var c=t.append("g").attr("transform","translate(300, 420)"),l=0;l<=10;l++){var f=l/10,d=l/10,h=void 0;if(d<=.5){var p=2*d;h=pj.interpolateRgb("#e74c3c","#ff9800")(p)}else{var v=2*(d-.5);h=pj.interpolateRgb("#ff9800","#4caf50")(v)}c.append("circle").attr("cx",20+18*l).attr("cy",30).attr("r",5).attr("fill",h).attr("opacity",r>=10*l?f:.1)}};return(0,rt.jsxs)("div",{className:"dimmer-container",children:[(0,rt.jsx)("div",{className:"dimmer-title",children:"The Explainability Spectrum"}),(0,rt.jsx)("div",{className:"dimmer-subtitle",children:"Like a dimmer switch, not an on/off button"}),(0,rt.jsx)("svg",{ref:e}),(0,rt.jsxs)("div",{className:"dimmer-slider-container",children:[(0,rt.jsxs)("div",{className:"dimmer-slider-label",children:[(0,rt.jsx)("span",{children:"\ud83d\udd12 Opaque"}),(0,rt.jsxs)("span",{children:["Current: ",r,"%"]}),(0,rt.jsx)("span",{children:"\ud83d\udd13 Transparent"})]}),(0,rt.jsx)("input",{type:"range",min:"0",max:"100",value:r,onChange:function(e){return a(parseInt(e.target.value))},className:"dimmer-slider"}),(0,rt.jsx)("div",{className:"dimmer-instruction",children:"\ud83d\udc46 Drag the slider or click on any model to explore the spectrum"})]}),(0,rt.jsxs)("div",{className:"dimmer-callout",children:[(0,rt.jsx)("div",{className:"dimmer-callout-icon",children:i(r).icon}),(0,rt.jsxs)("div",{className:"dimmer-callout-content",children:[(0,rt.jsx)("div",{className:"dimmer-callout-title",children:i(r).level}),(0,rt.jsx)("div",{className:"dimmer-callout-text",children:i(r).description})]})]}),(0,rt.jsx)("div",{className:"dimmer-examples",children:(0,rt.jsxs)("div",{className:"dimmer-example",style:{backgroundColor:i(r).color+"20",borderColor:i(r).color},children:[(0,rt.jsxs)("div",{className:"dimmer-example-title",children:[i(r).icon," ",i(r).level]}),(0,rt.jsxs)("div",{className:"dimmer-example-desc",children:[(0,rt.jsx)("strong",{children:"Examples:"})," ",i(r).examples.join(", ")]}),(0,rt.jsxs)("div",{className:"dimmer-example-desc",children:[(0,rt.jsx)("strong",{children:"Pros:"})," ",i(r).pros.join(", ")]}),(0,rt.jsxs)("div",{className:"dimmer-example-desc",children:[(0,rt.jsx)("strong",{children:"Cons:"})," ",i(r).cons.join(", ")]})]})})]})},jz=n.p+"static/media/interpretability_visual.17e0727f3b54b2bf905e.png",Bz=n.p+"static/media/spectrum.e8b9d2273585b2eeec19.png",zz=function(){var e=(0,k.useRef)();(0,k.useEffect)((function(){t()}),[]);var t=function(){TB(e.current).selectAll("*").remove();var t=TB(e.current).attr("width",700).attr("height",400);t.append("text").attr("x",350).attr("y",30).attr("text-anchor","middle").style("font-size","18px").style("font-weight","bold").text("Real Failure Case: COVID-Net");var n=t.append("g").attr("transform","translate(100, 80)");n.append("rect").attr("x",0).attr("y",0).attr("width",180).attr("height",220).attr("fill","#1a1a1a").attr("stroke","#666").attr("stroke-width",2),n.append("ellipse").attr("cx",60).attr("cy",110).attr("rx",35).attr("ry",50).attr("fill","#444").attr("opacity",.6),n.append("ellipse").attr("cx",120).attr("cy",110).attr("rx",35).attr("ry",50).attr("fill","#444").attr("opacity",.6),n.append("text").attr("x",5).attr("y",15).attr("fill","#0f0").style("font-size","8px").style("font-family","monospace").text("HOSPITAL_A_2020"),n.append("text").attr("x",5).attr("y",25).attr("fill","#0f0").style("font-size","8px").style("font-family","monospace").text("Model: XR-3000"),n.append("text").attr("x",90).attr("y",250).attr("text-anchor","middle").style("font-size","12px").style("font-weight","bold").text("Input X-Ray"),t.append("line").attr("x1",300).attr("y1",190).attr("x2",360).attr("y2",190).attr("stroke","#333").attr("stroke-width",2).attr("marker-end","url(#arrow)"),t.append("defs").append("marker").attr("id","arrow").attr("viewBox","0 0 10 10").attr("refX",5).attr("refY",5).attr("markerWidth",6).attr("markerHeight",6).attr("orient","auto").append("path").attr("d","M 0 0 L 10 5 L 0 10 z").attr("fill","#333");var r=t.append("g").attr("transform","translate(370, 140)");r.append("rect").attr("x",0).attr("y",0).attr("width",100).attr("height",100).attr("fill","#2c3e50").attr("stroke","#34495e").attr("stroke-width",2).attr("rx",5),r.append("text").attr("x",50).attr("y",50).attr("text-anchor","middle").style("font-size","14px").style("fill","#fff").style("font-weight","bold").text("Black Box"),r.append("text").attr("x",50).attr("y",68).attr("text-anchor","middle").style("font-size","12px").style("fill","#bdc3c7").text("COVID-Net"),t.append("line").attr("x1",480).attr("y1",190).attr("x2",540).attr("y2",190).attr("stroke","#333").attr("stroke-width",2).attr("marker-end","url(#arrow)");var a=t.append("g").attr("transform","translate(550, 150)");a.append("rect").attr("x",0).attr("y",0).attr("width",120).attr("height",80).attr("fill","#e74c3c").attr("stroke","#c0392b").attr("stroke-width",2).attr("rx",5),a.append("text").attr("x",60).attr("y",30).attr("text-anchor","middle").style("font-size","14px").style("fill","#fff").style("font-weight","bold").text("COVID-19"),a.append("text").attr("x",60).attr("y",50).attr("text-anchor","middle").style("font-size","16px").style("fill","#fff").style("font-weight","bold").text("98%"),a.append("text").attr("x",60).attr("y",65).attr("text-anchor","middle").style("font-size","10px").style("fill","#ecf0f1").text("confidence");var i=t.append("g").attr("transform","translate(50, 340)");i.append("rect").attr("x",0).attr("y",0).attr("width",600).attr("height",50).attr("fill","#fff3cd").attr("stroke","#ffc107").attr("stroke-width",2).attr("rx",5),i.append("text").attr("x",300).attr("y",18).attr("text-anchor","middle").style("font-size","12px").style("font-weight","bold").style("fill","#856404").text("\u26a0\ufe0f The Problem: Model learned to detect hospital-specific metadata,"),i.append("text").attr("x",300).attr("y",35).attr("text-anchor","middle").style("font-size","12px").style("font-weight","bold").style("fill","#856404").text("not actual disease in lungs! Nurses couldn't trust or debug it.")};return(0,rt.jsxs)("div",{style:{marginBottom:50},children:[(0,rt.jsx)("h2",{className:"display-6",children:"1. The Problem: Why We Need Explainability"}),(0,rt.jsxs)("div",{className:"container-sm",style:{marginTop:50,maxWidth:800},children:[(0,rt.jsx)("div",{style:{textAlign:"justify"},children:(0,rt.jsxs)("p",{children:['Picture a 2D space where the x-axis represents model complexity and the y-axis represents interpretability. Classical models like linear regression sit in the "simple but clear" corner. Modern transformers lurk in the "powerful but opaque" region. The sweet spot\u2014where we want multimodal AI to live\u2014is the upper right: both capable AND interpretable. That\'s our glass box. ',(0,rt.jsx)("br",{})," ",(0,rt.jsx)("br",{}),'The reality is that multimodal AI\u2014systems that juggle text, images, audio, and more\u2014lives somewhere in the messy middle. Take CLIP from OpenAI, which matches images with text descriptions. While we can visualize attention maps showing which image regions correspond to which words, we still don\'t fully understand how it learned abstract concepts like "artistic style" or "mood" without explicit training.']})}),(0,rt.jsx)("div",{style:{display:"flex",justifyContent:"center",marginTop:"40px",marginBottom:"40px",backgroundColor:"#f8f9fa",border:"2px dashed #dee2e6",borderRadius:"8px",padding:"40px",minHeight:"200px",alignItems:"center"},children:(0,rt.jsx)("div",{style:{textAlign:"center"},children:(0,rt.jsx)("img",{src:jz,alt:"Interpretability Visual",style:{maxWidth:"100%",height:"auto",borderRadius:"8px",boxShadow:"0 4px 20px rgba(0,0,0,0.1)",marginBottom:"20px"},onError:function(e){console.log("Image failed to load:",e.target.src)},onLoad:function(){console.log("Image loaded successfully!")}})})}),(0,rt.jsx)("p",{children:"Some architectures are built from the ground up to be interpretable. ALIGN from Google uses contrastive learning with explicit alignment scores\u2014you can actually see numerical values for how well image and text features match. Others need detective work after the fact, using techniques like Integrated Gradients (which traces the model's decision back through derivatives) or concept activation vectors that find directions in neural network space corresponding to human concepts."}),(0,rt.jsx)("div",{style:{display:"flex",justifyContent:"center",marginTop:20,marginBottom:20},children:(0,rt.jsx)("svg",{ref:e})}),(0,rt.jsxs)(oz,{variant:"danger",children:[(0,rt.jsx)(oz.Heading,{children:"The COVID-Net Case Study"}),(0,rt.jsx)("p",{children:"When Google's diabetic retinopathy AI was deployed in Thailand, it failed spectacularly\u2014not because it couldn't detect disease, but because its black-box nature meant nurses couldn't trust or debug its decisions when it conflicted with their expertise."}),(0,rt.jsx)("hr",{}),(0,rt.jsxs)("p",{className:"mb-0",children:[(0,rt.jsx)("strong",{children:"The EU's AI Act"})," now explicitly requires high-risk systems to be interpretable. Whether we like it or not, the black box era is ending."]})]}),(0,rt.jsxs)("div",{style:{textAlign:"justify",marginTop:30},children:[(0,rt.jsx)("h4",{className:"display-8",children:"The Challenge: Complexity vs. Interpretability"}),(0,rt.jsx)("p",{children:'Picture a 2D space where the x-axis represents model complexity and the y-axis represents interpretability. Classical models like linear regression sit in the "simple but clear" corner. Modern transformers lurk in the "powerful but opaque" region. The sweet spot\u2014where we want multimodal AI to live\u2014is the upper right: both capable AND interpretable.'})]}),(0,rt.jsxs)("div",{style:{textAlign:"justify",marginTop:20},children:[(0,rt.jsx)("h4",{className:"display-8",children:"Why This Matters"}),(0,rt.jsxs)("ul",{children:[(0,rt.jsxs)("li",{children:[(0,rt.jsx)("strong",{children:"Trust:"})," Users need to understand AI decisions to trust them, especially in high-stakes domains like healthcare"]}),(0,rt.jsxs)("li",{children:[(0,rt.jsx)("strong",{children:"Debugging:"})," When models fail, we need to understand why to fix them"]}),(0,rt.jsxs)("li",{children:[(0,rt.jsx)("strong",{children:"Fairness:"})," Explanations can reveal hidden biases and discrimination"]}),(0,rt.jsxs)("li",{children:[(0,rt.jsx)("strong",{children:"Regulation:"})," Laws increasingly require interpretable AI systems"]}),(0,rt.jsxs)("li",{children:[(0,rt.jsx)("strong",{children:"Scientific Understanding:"})," We learn about the world by understanding what models learn"]})]})]})]})]})},Zz=function(e){var t=e.selectedImage,n=e.setSelectedImage,r=e.selectedText,a=e.setSelectedText,i=(0,k.useRef)();(0,k.useEffect)((function(){o()}),[t,r]);var o=function(){TB(i.current).selectAll("*").remove();var e=TB(i.current).attr("width",750).attr("height",500);e.append("text").attr("x",375).attr("y",25).attr("text-anchor","middle").style("font-size","18px").style("font-weight","bold").text("Information Flow in Multimodal AI");var t=80,n=e.append("g").attr("transform","translate(80, ".concat(t,")"));n.append("rect").attr("width",80).attr("height",80).attr("fill","#e3f2fd").attr("stroke","#2196f3").attr("stroke-width",2).attr("rx",5),n.append("text").attr("x",40).attr("y",35).attr("text-anchor","middle").style("font-size","30px").text("\ud83d\uddbc\ufe0f"),n.append("text").attr("x",40).attr("y",60).attr("text-anchor","middle").style("font-size","11px").style("font-weight","bold").text("Image");var r=e.append("g").attr("transform","translate(80, ".concat(190,")"));r.append("rect").attr("width",80).attr("height",80).attr("fill","#f3e5f5").attr("stroke","#9c27b0").attr("stroke-width",2).attr("rx",5),r.append("text").attr("x",40).attr("y",35).attr("text-anchor","middle").style("font-size","30px").text("\ud83d\udcdd"),r.append("text").attr("x",40).attr("y",60).attr("text-anchor","middle").style("font-size","11px").style("font-weight","bold").text("Text"),e.append("text").attr("x",120).attr("y",60).attr("text-anchor","middle").style("font-size","12px").style("fill","#666").text("RAW DATA"),u(e,170,120,230,120),u(e,170,230,230,230);var a=e.append("g").attr("transform","translate(".concat(240,", ").concat(t,")"));a.append("rect").attr("width",100).attr("height",80).attr("fill","#2196f3").attr("opacity",.3).attr("stroke","#1976d2").attr("stroke-width",2).attr("rx",5),a.append("text").attr("x",50).attr("y",35).attr("text-anchor","middle").style("font-size","11px").style("font-weight","bold").text("Image"),a.append("text").attr("x",50).attr("y",50).attr("text-anchor","middle").style("font-size","11px").style("font-weight","bold").text("Encoder"),a.append("text").attr("x",50).attr("y",65).attr("text-anchor","middle").style("font-size","9px").style("fill","#666").text("(ResNet/ViT)"),a.append("text").attr("x",50).attr("y",-5).attr("text-anchor","middle").style("font-size","10px").style("fill","#ff6b6b").style("font-weight","bold").text("\u26a0\ufe0f Opaque");var o=e.append("g").attr("transform","translate(".concat(240,", ").concat(190,")"));o.append("rect").attr("width",100).attr("height",80).attr("fill","#9c27b0").attr("opacity",.3).attr("stroke","#7b1fa2").attr("stroke-width",2).attr("rx",5),o.append("text").attr("x",50).attr("y",35).attr("text-anchor","middle").style("font-size","11px").style("font-weight","bold").text("Text"),o.append("text").attr("x",50).attr("y",50).attr("text-anchor","middle").style("font-size","11px").style("font-weight","bold").text("Encoder"),o.append("text").attr("x",50).attr("y",65).attr("text-anchor","middle").style("font-size","9px").style("fill","#666").text("(BERT/GPT)"),o.append("text").attr("x",50).attr("y",-5).attr("text-anchor","middle").style("font-size","10px").style("fill","#ff6b6b").style("font-weight","bold").text("\u26a0\ufe0f Opaque"),u(e,350,120,410,120),u(e,350,230,410,230);var s=e.append("g").attr("transform","translate(".concat(420,", ").concat(t,")"));s.append("rect").attr("width",80).attr("height",80).attr("fill","#bbdefb").attr("stroke","#2196f3").attr("stroke-width",2).attr("rx",5);for(var c=0;c<5;c++)s.append("rect").attr("x",10+13*c).attr("y",25).attr("width",10).attr("height",30).attr("fill","#2196f3").attr("opacity",.3+.4*Math.random());s.append("text").attr("x",40).attr("y",72).attr("text-anchor","middle").style("font-size","10px").style("font-weight","bold").text("Embedding"),s.append("text").attr("x",40).attr("y",-5).attr("text-anchor","middle").style("font-size","10px").style("fill","#4caf50").style("font-weight","bold").text("\u2713 Inspectable");var l=e.append("g").attr("transform","translate(".concat(420,", ").concat(190,")"));l.append("rect").attr("width",80).attr("height",80).attr("fill","#e1bee7").attr("stroke","#9c27b0").attr("stroke-width",2).attr("rx",5);for(var f=0;f<5;f++)l.append("rect").attr("x",10+13*f).attr("y",25).attr("width",10).attr("height",30).attr("fill","#9c27b0").attr("opacity",.3+.4*Math.random());l.append("text").attr("x",40).attr("y",72).attr("text-anchor","middle").style("font-size","10px").style("font-weight","bold").text("Embedding"),l.append("text").attr("x",40).attr("y",-5).attr("text-anchor","middle").style("font-size","10px").style("fill","#4caf50").style("font-weight","bold").text("\u2713 Inspectable"),e.append("text").attr("x",460).attr("y",60).attr("text-anchor","middle").style("font-size","10px").style("fill","#666").text("BOTTLENECK"),u(e,510,120,555,160),u(e,510,230,555,200);var d=e.append("g").attr("transform","translate(560, 140)");d.append("rect").attr("width",120).attr("height",80).attr("fill","#fff9c4").attr("stroke","#fbc02d").attr("stroke-width",3).attr("rx",5),d.append("text").attr("x",60).attr("y",30).attr("text-anchor","middle").style("font-size","12px").style("font-weight","bold").text("Fusion Layer"),d.append("text").attr("x",60).attr("y",45).attr("text-anchor","middle").style("font-size","10px").text("Cross-Attention"),d.append("text").attr("x",60).attr("y",58).attr("text-anchor","middle").style("font-size","9px").style("fill","#666").text("(Multimodal"),d.append("text").attr("x",60).attr("y",69).attr("text-anchor","middle").style("font-size","9px").style("fill","#666").text("Reasoning)"),d.append("text").attr("x",60).attr("y",-10).attr("text-anchor","middle").style("font-size","20px").text("\u2b50"),d.append("text").attr("x",60).attr("y",95).attr("text-anchor","middle").style("font-size","11px").style("fill","#f57c00").style("font-weight","bold").text("GLASS BOX WINDOW"),u(e,690,180,690,240);var h=e.append("g").attr("transform","translate(640, 250)");h.append("rect").attr("width",100).attr("height",60).attr("fill","#c8e6c9").attr("stroke","#4caf50").attr("stroke-width",2).attr("rx",5),h.append("text").attr("x",50).attr("y",30).attr("text-anchor","middle").style("font-size","12px").style("font-weight","bold").text("Prediction"),h.append("text").attr("x",50).attr("y",48).attr("text-anchor","middle").style("font-size","10px").style("fill","#666").text("Match: 0.92");var p=e.append("g").attr("transform","translate(50, 350)");p.append("rect").attr("x",0).attr("y",0).attr("width",200).attr("height",60).attr("fill","#ffebee").attr("stroke","#ef5350").attr("stroke-width",2).attr("rx",5),p.append("text").attr("x",100).attr("y",20).attr("text-anchor","middle").style("font-size","11px").style("font-weight","bold").text("\u26a0\ufe0f Opaque Components"),p.append("text").attr("x",100).attr("y",35).attr("text-anchor","middle").style("font-size","9px").text("Complex transformations,"),p.append("text").attr("x",100).attr("y",48).attr("text-anchor","middle").style("font-size","9px").text("hard to interpret directly"),p.append("rect").attr("x",220).attr("y",0).attr("width",200).attr("height",60).attr("fill","#e8f5e9").attr("stroke","#4caf50").attr("stroke-width",2).attr("rx",5),p.append("text").attr("x",320).attr("y",20).attr("text-anchor","middle").style("font-size","11px").style("font-weight","bold").text("\u2713 Inspectable Points"),p.append("text").attr("x",320).attr("y",35).attr("text-anchor","middle").style("font-size","9px").text("Natural explanation points:"),p.append("text").attr("x",320).attr("y",48).attr("text-anchor","middle").style("font-size","9px").text("embeddings, attention weights"),p.append("rect").attr("x",440).attr("y",0).attr("width",200).attr("height",60).attr("fill","#fff9c4").attr("stroke","#fbc02d").attr("stroke-width",2).attr("rx",5),p.append("text").attr("x",540).attr("y",20).attr("text-anchor","middle").style("font-size","11px").style("font-weight","bold").text("\u2b50 Glass Box Window"),p.append("text").attr("x",540).attr("y",35).attr("text-anchor","middle").style("font-size","9px").text("Fusion shows HOW"),p.append("text").attr("x",540).attr("y",48).attr("text-anchor","middle").style("font-size","9px").text("modalities interact!")},u=function(e,t,n,r,a){e.append("line").attr("x1",t).attr("y1",n).attr("x2",r).attr("y2",a).attr("stroke","#666").attr("stroke-width",2).attr("marker-end","url(#arrowhead)"),e.select("#arrowhead").empty()&&e.append("defs").append("marker").attr("id","arrowhead").attr("viewBox","0 0 10 10").attr("refX",5).attr("refY",5).attr("markerWidth",6).attr("markerHeight",6).attr("orient","auto").append("path").attr("d","M 0 0 L 10 5 L 0 10 z").attr("fill","#666")};return(0,rt.jsxs)("div",{style:{marginBottom:50},children:[(0,rt.jsx)("h2",{className:"display-6",children:"2. How Information Flows Through the Model"}),(0,rt.jsxs)("div",{className:"container-sm",style:{marginTop:50,maxWidth:800},children:[(0,rt.jsxs)("div",{style:{textAlign:"justify"},children:[(0,rt.jsx)("p",{children:'Let\'s trace how data transforms from raw inputs to final predictions. Understanding this flow reveals where opacity creeps in and where we have natural "inspection points" for explanations.'}),(0,rt.jsx)("h4",{className:"display-8",children:"The Modular Approach"}),(0,rt.jsx)("p",{children:"One framework for interpretability is keeping things modular\u2014imagine Lego blocks where each piece handles one modality clearly before they connect. Salesforce's ALBEF model explicitly separates unimodal encoders from multimodal fusion, letting you probe each stage."})]}),(0,rt.jsxs)("div",{style:{marginTop:30,marginBottom:20},children:[(0,rt.jsx)(La,{children:(0,rt.jsx)(Gt,{children:(0,rt.jsx)(pn.Label,{children:(0,rt.jsx)("strong",{children:"Select Inputs to Trace:"})})})}),(0,rt.jsxs)(La,{children:[(0,rt.jsx)(Gt,{md:6,children:(0,rt.jsxs)(pn.Select,{value:t,onChange:function(e){return n(e.target.value)},style:{marginBottom:10},children:[(0,rt.jsx)("option",{value:"dog",children:"Dog Image"}),(0,rt.jsx)("option",{value:"cat",children:"Cat Image"}),(0,rt.jsx)("option",{value:"car",children:"Car Image"})]})}),(0,rt.jsx)(Gt,{md:6,children:(0,rt.jsx)(pn.Control,{type:"text",value:r,onChange:function(e){return a(e.target.value)},placeholder:"Enter text..."})})]})]}),(0,rt.jsx)("div",{style:{display:"flex",justifyContent:"center",marginBottom:30},children:(0,rt.jsx)("svg",{ref:i})}),(0,rt.jsxs)("div",{style:{textAlign:"justify"},children:[(0,rt.jsx)("h4",{className:"display-8",children:"Key Insights"}),(0,rt.jsxs)("ul",{children:[(0,rt.jsxs)("li",{children:[(0,rt.jsx)("strong",{children:"Encoders are Opaque:"}),' The transformation from raw data to embeddings involves millions of parameters. We can\'t easily trace exactly why a ResNet thinks a region contains "fur."']}),(0,rt.jsxs)("li",{children:[(0,rt.jsx)("strong",{children:"Embeddings are Inspectable:"})," Once we have vector representations, we can measure distances, project to 2D, and understand relationships between concepts."]}),(0,rt.jsxs)("li",{children:[(0,rt.jsx)("strong",{children:"Fusion is the Glass Box Window:"})," This is where the magic happens! Cross-attention weights explicitly show which image regions correspond to which text tokens. This is THE key insight point for multimodal explainability."]}),(0,rt.jsxs)("li",{children:[(0,rt.jsx)("strong",{children:"Information Bottlenecks:"})," By forcing information through narrow channels (embeddings), we create natural explanation points. The bottleneck principle says these compressed representations must contain all task-relevant information."]})]})]})]})]})},Lz=function(e){var t=e.selectedImage,n=e.selectedText,r=(0,k.useRef)(),a=(0,k.useState)(null),i=(0,C.Z)(a,2),o=i[0],u=i[1],s=(0,k.useState)(null),c=(0,C.Z)(s,2),l=c[0],f=c[1];(0,k.useEffect)((function(){d()}),[t,n,o,l]);var d=function(){TB(r.current).selectAll("*").remove();var e=TB(r.current).attr("width",750).attr("height",500);e.append("text").attr("x",375).attr("y",25).attr("text-anchor","middle").style("font-size","18px").style("font-weight","bold").text("3. Cross-Modal Attention: The Glass Box Window");var t=[{id:"head",x:50,y:80,width:60,height:50,label:"Head",color:"#ffcdd2"},{id:"body",x:50,y:135,width:60,height:70,label:"Body",color:"#f8bbd0"},{id:"legs",x:50,y:210,width:60,height:50,label:"Legs",color:"#e1bee7"},{id:"background",x:50,y:265,width:60,height:50,label:"Background",color:"#d1c4e9"}],a=n.split(" ").filter((function(e){return e.length>0})),i={};a.forEach((function(e,n){i[e]={},t.forEach((function(t,n){var r=.1+.2*Math.random();(e.toLowerCase().includes("golden")||e.toLowerCase().includes("dog"))&&("head"!==t.id&&"body"!==t.id||(r=.6+.3*Math.random())),e.toLowerCase().includes("retriever")&&"body"===t.id&&(r=.7+.2*Math.random()),i[e][t.id]=r}))}));var s=e.append("g");e.append("text").attr("x",80).attr("y",65).attr("text-anchor","middle").style("font-size","12px").style("font-weight","bold").text("Image Regions"),t.forEach((function(e){var t,n=l===e.id,r=o?(null===(t=i[o])||void 0===t?void 0:t[e.id])||.1:n?.9:.3;s.append("rect").attr("x",e.x).attr("y",e.y).attr("width",e.width).attr("height",e.height).attr("fill",e.color).attr("opacity",r).attr("stroke",n?"#000":"#666").attr("stroke-width",n?3:1).attr("rx",3).style("cursor","pointer").on("mouseenter",(function(){return f(e.id)})).on("mouseleave",(function(){return f(null)}));s.append("text").attr("x",e.x+e.width/2).attr("y",e.y+e.height/2+4).attr("text-anchor","middle").style("font-size","10px").style("font-weight","bold").style("pointer-events","none").text(e.label)}));var c=600;e.append("text").attr("x",c).attr("y",65).attr("text-anchor","middle").style("font-size","12px").style("font-weight","bold").text("Text Tokens"),a.forEach((function(t,n){var r=80+40*n,a=o===t,i=e.append("g");i.append("rect").attr("x",550).attr("y",r-15).attr("width",100).attr("height",30).attr("fill","#e3f2fd").attr("opacity",a||l?.9:.5).attr("stroke",a?"#000":"#2196f3").attr("stroke-width",a?3:2).attr("rx",5).style("cursor","pointer").on("mouseenter",(function(){return u(t)})).on("mouseleave",(function(){return u(null)})),i.append("text").attr("x",c).attr("y",r+4).attr("text-anchor","middle").style("font-size","12px").style("font-weight",a?"bold":"normal").style("pointer-events","none").text(t)}));var d=e.append("g");o?t.forEach((function(e){var t=i[o][e.id],n=80+40*a.indexOf(o);d.append("line").attr("x1",115).attr("y1",e.y+e.height/2).attr("x2",548).attr("y2",n).attr("stroke","#ff9800").attr("stroke-width",8*t).attr("opacity",.6).attr("stroke-linecap","round");var r=(e.y+e.height/2+n)/2;d.append("circle").attr("cx",331.5).attr("cy",r).attr("r",15).attr("fill","#fff").attr("stroke","#ff9800").attr("stroke-width",2),d.append("text").attr("x",331.5).attr("y",r+4).attr("text-anchor","middle").style("font-size","10px").style("font-weight","bold").text(t.toFixed(2))})):l?a.forEach((function(e,n){var r,a=(null===(r=i[e])||void 0===r?void 0:r[l])||0,o=80+40*n,u=t.find((function(e){return e.id===l}));d.append("line").attr("x1",115).attr("y1",u.y+u.height/2).attr("x2",548).attr("y2",o).attr("stroke","#4caf50").attr("stroke-width",8*a).attr("opacity",.6).attr("stroke-linecap","round")})):a.forEach((function(e,n){var r=80+40*n,a=0,o=null;t.forEach((function(t){var n=i[e][t.id];n>a&&(a=n,o=t)})),o&&d.append("line").attr("x1",115).attr("y1",o.y+o.height/2).attr("x2",548).attr("y2",r).attr("stroke","#9e9e9e").attr("stroke-width",6*a).attr("opacity",.3).attr("stroke-linecap","round")}));var h=420,p=e.append("g");if(p.append("rect").attr("x",150).attr("y",405).attr("width",450).attr("height",70).attr("fill","#fff9c4").attr("stroke","#fbc02d").attr("stroke-width",2).attr("rx",5),o){p.append("text").attr("x",375).attr("y",425).attr("text-anchor","middle").style("font-size","11px").style("font-weight","bold").text('Token "'.concat(o,'" attends to image regions:'));var v=20;t.forEach((function(e){var t=i[o][e.id];p.append("text").attr("x",375).attr("y",h+v).attr("text-anchor","middle").style("font-size","10px").text("".concat(e.label,": ").concat((100*t).toFixed(0),"%")),v+=12}))}else if(l){var m=t.find((function(e){return e.id===l}));p.append("text").attr("x",375).attr("y",425).attr("text-anchor","middle").style("font-size","11px").style("font-weight","bold").text('Image region "'.concat(m.label,'" receives attention from:'));var g=20;a.forEach((function(e){var t=i[e][l];p.append("text").attr("x",375).attr("y",h+g).attr("text-anchor","middle").style("font-size","10px").text('"'.concat(e,'": ').concat((100*t).toFixed(0),"%")),g+=12}))}else p.append("text").attr("x",375).attr("y",430).attr("text-anchor","middle").style("font-size","11px").style("font-weight","bold").text("\ud83d\udc46 Hover over text tokens or image regions"),p.append("text").attr("x",375).attr("y",445).attr("text-anchor","middle").style("font-size","10px").text("to see cross-modal attention weights!"),p.append("text").attr("x",375).attr("y",465).attr("text-anchor","middle").style("font-size","9px").style("fill","#666").text("Thick lines = high attention | Thin lines = low attention")};return(0,rt.jsxs)("div",{style:{marginBottom:50},children:[(0,rt.jsx)("h2",{className:"display-6",children:"3. Attention/Fusion: The Glass Box Window \u2b50"}),(0,rt.jsxs)("div",{className:"container-sm",style:{marginTop:50,maxWidth:800},children:[(0,rt.jsxs)("div",{style:{textAlign:"justify"},children:[(0,rt.jsxs)("p",{children:[(0,rt.jsx)("strong",{children:"This is THE key insight for multimodal explainability:"})," The fusion layer, where modalities interact through cross-attention, provides a natural window into the model's reasoning process."]}),(0,rt.jsx)("p",{children:'Cross-attention weights explicitly show which image regions correspond to which text tokens. When the model processes "golden retriever," we can see it attending to the dog\'s head and body regions. This is multimodal reasoning made visible!'})]}),(0,rt.jsx)("div",{style:{display:"flex",justifyContent:"center",marginTop:30,marginBottom:30},children:(0,rt.jsx)("svg",{ref:r})}),(0,rt.jsxs)("div",{style:{textAlign:"justify"},children:[(0,rt.jsx)("h4",{className:"display-8",children:"Why This Matters"}),(0,rt.jsxs)("div",{style:{backgroundColor:"#e8f4f8",padding:20,borderRadius:8,marginBottom:15},children:[(0,rt.jsx)("strong",{children:"The Power of Attention Visualization:"}),(0,rt.jsxs)("ul",{style:{marginBottom:0,marginTop:10},children:[(0,rt.jsxs)("li",{children:[(0,rt.jsx)("strong",{children:"Interpretable by Design:"})," Attention weights are probabilities\u2014easy to understand"]}),(0,rt.jsxs)("li",{children:[(0,rt.jsx)("strong",{children:"Multimodal Specific:"})," Shows how modalities interact, not just individual processing"]}),(0,rt.jsxs)("li",{children:[(0,rt.jsx)("strong",{children:"Debuggable:"})," Can identify when model attends to wrong regions (like the COVID-Net case)"]}),(0,rt.jsxs)("li",{children:[(0,rt.jsx)("strong",{children:"Trust Building:"}),' Users can verify model is "looking" at the right things']})]})]}),(0,rt.jsx)("h4",{className:"display-8",children:"Architectures That Expose Attention"}),(0,rt.jsxs)("ul",{children:[(0,rt.jsxs)("li",{children:[(0,rt.jsx)("strong",{children:"ALBEF (Salesforce):"})," Explicitly separates encoders from fusion with visible attention"]}),(0,rt.jsxs)("li",{children:[(0,rt.jsx)("strong",{children:"CLIP:"})," While simpler, can still visualize which patches matter via gradients"]}),(0,rt.jsxs)("li",{children:[(0,rt.jsx)("strong",{children:"Flamingo (DeepMind):"})," Gated cross-attention makes interactions inspectable"]}),(0,rt.jsxs)("li",{children:[(0,rt.jsx)("strong",{children:"BLIP:"})," Attention maps show fine-grained image-text alignment"]})]}),(0,rt.jsxs)("div",{style:{backgroundColor:"#fff3cd",padding:20,borderRadius:8,marginTop:20},children:[(0,rt.jsx)("strong",{children:"The Limitation:"})," While attention shows WHERE the model looks, it doesn't fully explain WHY. Attention is correlation, not necessarily causation. But it's still our best window into multimodal reasoning!"]})]})]})]})},Pz=function(e){var t=e.selectedImage,n=e.selectedText,r=(0,k.useRef)(),a=(0,k.useState)("attention"),i=(0,C.Z)(a,2),o=i[0];i[1];(0,k.useEffect)((function(){u()}),[o,t,n]);var u=function(){TB(r.current).selectAll("*").remove();var e=TB(r.current).attr("width",750).attr("height",450);e.append("text").attr("x",375).attr("y",25).attr("text-anchor","middle").style("font-size","18px").style("font-weight","bold").text("Explanation Method: ".concat(h(o)));var t=e.append("g").attr("transform","translate(50, 60)");t.append("rect").attr("width",200).attr("height",200).attr("fill","#f5f5f5").attr("stroke","#999").attr("stroke-width",2).attr("rx",5),t.append("text").attr("x",100).attr("y",95).attr("text-anchor","middle").style("font-size","40px").text("\ud83d\udc15"),t.append("text").attr("x",100).attr("y",130).attr("text-anchor","middle").style("font-size","12px").style("fill","#666").text("Input Image"),"attention"===o?s(t):"shap"===o?c(t):"gradcam"===o?l(t):"integrated"===o&&f(t),e.append("g").attr("transform","translate(50, 280)").append("text").attr("x",0).attr("y",0).style("font-size","14px").style("font-weight","bold").text('Text: "'.concat(n,'"'));var a=e.append("g").attr("transform","translate(".concat(300,", ").concat(60,")"));a.append("rect").attr("width",400).attr("height",340).attr("fill","#fff").attr("stroke","#ddd").attr("stroke-width",2).attr("rx",5);var i=p(o);a.append("text").attr("x",200).attr("y",25).attr("text-anchor","middle").style("font-size","14px").style("font-weight","bold").text(i.name),a.append("text").attr("x",15).attr("y",50).style("font-size","12px").style("font-weight","bold").text("What it shows:"),d(a,i.shows,15,65,370,12),a.append("text").attr("x",15).attr("y",130).style("font-size","12px").style("font-weight","bold").text("How it works:"),d(a,i.howItWorks,15,145,370,12),a.append("text").attr("x",15).attr("y",210).style("font-size","12px").style("font-weight","bold").style("fill","#4caf50").text("\u2713 Pros:"),d(a,i.pros,15,225,370,11),a.append("text").attr("x",15).attr("y",270).style("font-size","12px").style("font-weight","bold").style("fill","#f44336").text("\u2717 Cons:"),d(a,i.cons,15,285,370,11)},s=function(e){[{x:60,y:40,size:50,opacity:.8,label:"Head"},{x:80,y:100,size:60,opacity:.6,label:"Body"},{x:90,y:140,size:30,opacity:.3,label:"Legs"}].forEach((function(t){e.append("circle").attr("cx",t.x).attr("cy",t.y).attr("r",t.size).attr("fill","#ff9800").attr("opacity",.5*t.opacity),e.append("text").attr("x",t.x).attr("y",t.y+4).attr("text-anchor","middle").style("font-size","10px").style("font-weight","bold").style("fill","#fff").text((100*t.opacity).toFixed(0)+"%")}))},c=function(e){for(var t=0;t<8;t++)for(var n=0;n<8;n++){var r=Math.random(),a=r>.5?"#4caf50":"#f44336",i=2*Math.abs(r-.5);e.append("rect").attr("x",25*n).attr("y",25*t).attr("width",25).attr("height",25).attr("fill",a).attr("opacity",.6*i).attr("stroke","#fff").attr("stroke-width",1)}e.append("text").attr("x",5).attr("y",15).style("font-size","9px").style("fill","#4caf50").style("font-weight","bold").text("Green: Increases match"),e.append("text").attr("x",5).attr("y",27).style("font-size","9px").style("fill","#f44336").style("font-weight","bold").text("Red: Decreases match")},l=function(e){var t=e.append("defs");[{x:50,y:50,intensity:.9},{x:100,y:80,intensity:.7},{x:80,y:120,intensity:.5},{x:120,y:100,intensity:.4}].forEach((function(n,r){var a=t.append("radialGradient").attr("id","heatGrad".concat(r));a.append("stop").attr("offset","0%").attr("stop-color","#ff0000").attr("stop-opacity",n.intensity),a.append("stop").attr("offset","100%").attr("stop-color","#ff0000").attr("stop-opacity",0),e.append("circle").attr("cx",n.x).attr("cy",n.y).attr("r",40).attr("fill","url(#heatGrad".concat(r,")"))}))},f=function(e){["M 100 180 Q 80 140 60 80","M 100 180 Q 110 120 100 60","M 100 180 Q 130 140 140 80"].forEach((function(t,n){e.append("path").attr("d",t).attr("fill","none").attr("stroke","#2196f3").attr("stroke-width",3).attr("opacity",.7).attr("marker-end","url(#arrowBlue)")})),e.append("defs").append("marker").attr("id","arrowBlue").attr("viewBox","0 0 10 10").attr("refX",5).attr("refY",5).attr("markerWidth",6).attr("markerHeight",6).attr("orient","auto").append("path").attr("d","M 0 0 L 10 5 L 0 10 z").attr("fill","#2196f3"),e.append("text").attr("x",5).attr("y",15).style("font-size","9px").style("fill","#2196f3").style("font-weight","bold").text("Attribution paths")},d=function(e,t,n,r,a,i){var o=t.split(" "),u="",s=0;o.forEach((function(t){var o=u+t+" ";6*o.length>a&&""!==u?(e.append("text").attr("x",n).attr("y",r+s*i).style("font-size","11px").style("fill","#333").text(u),u=t+" ",s++):u=o})),e.append("text").attr("x",n).attr("y",r+s*i).style("font-size","11px").style("fill","#333").text(u)},h=function(e){return{attention:"Attention Maps",shap:"SHAP Values",gradcam:"Grad-CAM",integrated:"Integrated Gradients"}[e]},p=function(e){return{attention:{name:"Attention Maps",shows:"Which image regions the model attends to when processing specific text tokens. Brighter = higher attention.",howItWorks:"Extracts attention weights from the fusion layer. These are built into the model architecture and computed during forward pass.",pros:"Fast, interpretable, shows cross-modal interactions directly. No extra computation needed.",cons:"Only available in attention-based models. Shows correlation, not causation. May not reflect actual decision process."},shap:{name:"SHAP Values (Shapley Additive Explanations)",shows:"How much each image region contributes to the prediction. Green = positive contribution, Red = negative contribution.",howItWorks:"Uses game theory to fairly distribute credit among features. Computes contribution by testing all possible feature combinations.",pros:"Theoretically grounded (satisfies efficiency, symmetry). Works for any model. Shows actual feature importance.",cons:"Very slow (exponential in features). Can't show cross-modal interactions directly. High computational cost."},gradcam:{name:"Gradient-weighted Class Activation Mapping",shows:"Which image regions are most important for the prediction, based on gradients flowing back through the network.",howItWorks:"Backpropagates gradients from prediction to convolutional layers, then weights activation maps by these gradients.",pros:"Works with any CNN. Relatively fast. Highlights important regions without extra training.",cons:"Only for CNNs (not transformers). Noisy gradients. Doesn't explain multimodal fusion directly."},integrated:{name:"Integrated Gradients",shows:"Attribution paths showing how each pixel contributes to the prediction, integrated from a baseline to the actual input.",howItWorks:"Computes gradients along path from baseline (e.g., black image) to actual input. Integrates these gradients for final attribution.",pros:"Theoretically sound (satisfies axioms). Works for any differentiable model. Explains full path of influence.",cons:"Computationally expensive. Requires choosing baseline. Can be noisy. Doesn't show cross-modal reasoning."}}[e]};return(0,rt.jsxs)("div",{style:{marginBottom:50},children:[(0,rt.jsx)("h2",{className:"display-6",children:"4. Explanation Methods in Action"}),(0,rt.jsxs)("div",{className:"container-sm",style:{marginTop:50,maxWidth:800},children:[(0,rt.jsx)("div",{style:{textAlign:"justify"},children:(0,rt.jsx)("p",{children:"Different explanation methods can reveal different aspects of how a model works. Interestingly, they sometimes disagree! Understanding the strengths and limitations of each method is crucial for building trust in AI systems."})}),(0,rt.jsx)("div",{style:{display:"flex",justifyContent:"center",marginBottom:30},children:(0,rt.jsx)("svg",{ref:r})}),(0,rt.jsxs)(oz,{variant:"warning",children:[(0,rt.jsx)(oz.Heading,{children:"\u26a0\ufe0f When Methods Disagree"}),(0,rt.jsx)("p",{children:"Different explanation methods can highlight different regions for the same prediction. This isn't a bug\u2014it's because they measure different things:"}),(0,rt.jsxs)("ul",{style:{marginBottom:0},children:[(0,rt.jsxs)("li",{children:[(0,rt.jsx)("strong",{children:"Attention:"})," Where the model looks (correlation)"]}),(0,rt.jsxs)("li",{children:[(0,rt.jsx)("strong",{children:"SHAP:"})," What features matter most (contribution)"]}),(0,rt.jsxs)("li",{children:[(0,rt.jsx)("strong",{children:"Grad-CAM:"})," What changes prediction (sensitivity)"]}),(0,rt.jsxs)("li",{children:[(0,rt.jsx)("strong",{children:"Integrated Gradients:"})," Path of attribution (causal chain)"]})]})]}),(0,rt.jsxs)("div",{style:{textAlign:"justify",marginTop:20},children:[(0,rt.jsx)("h4",{className:"display-8",children:"Validation: How Do We Know Explanations Are True?"}),(0,rt.jsxs)("div",{style:{backgroundColor:"#e8f4f8",padding:20,borderRadius:8},children:[(0,rt.jsx)("strong",{children:"Key Metrics:"}),(0,rt.jsxs)("ul",{style:{marginBottom:0},children:[(0,rt.jsxs)("li",{children:[(0,rt.jsx)("strong",{children:"Faithfulness:"}),' Does removing "important" features actually change the output? (Test with perturbations)']}),(0,rt.jsxs)("li",{children:[(0,rt.jsx)("strong",{children:"Stability:"})," Do similar inputs produce similar explanations? (Measure with Lipschitz continuity)"]}),(0,rt.jsxs)("li",{children:[(0,rt.jsx)("strong",{children:"Completeness:"})," Do explanations capture all important factors? (Check sufficiency scores)"]})]})]}),(0,rt.jsx)("h4",{className:"display-8",style:{marginTop:20},children:"The Clever Hans Problem"}),(0,rt.jsxs)("p",{children:["Remember Clever Hans, the horse that could supposedly do arithmetic? Modern AI has its own Clever Hans moments. The COVID-Net X-ray system was found to identify COVID-19 partly by recognizing hospital-specific text fonts in image corners\u2014not lung pathology. ",(0,rt.jsx)("strong",{children:"Explanation methods revealed this flaw!"})]}),(0,rt.jsxs)("div",{style:{backgroundColor:"#d4edda",padding:20,borderRadius:8,marginTop:20},children:[(0,rt.jsx)("strong",{children:"Best Practice:"})," Use multiple explanation methods together. If they agree, you can be more confident. If they disagree, dig deeper\u2014something interesting is happening!"]}),(0,rt.jsx)("h4",{className:"display-8",style:{marginTop:30},children:"The Challenge: Complexity vs. Interpretability"}),(0,rt.jsx)("p",{children:'Picture a 2D space where the x-axis represents model complexity and the y-axis represents interpretability. Classical models like linear regression sit in the "simple but clear" corner. Modern transformers lurk in the "powerful but opaque" region. The sweet spot\u2014where we want multimodal AI to live\u2014is the upper right: both capable AND interpretable.'})]})]})]})},Uz=n.p+"static/media/attention.6ce07e75cf58095cd1ba.png",Wz=n.p+"static/media/bidirectional_crossmodal.f63ad02b610fc7788058.png",Vz=n.p+"static/media/encoder.4b53ebdeddf362e4647a.png",qz=n.p+"static/media/audio_encoder.5f434a6cc21203a6924a.png",Gz=function(){var e=(0,k.useState)("dog"),t=(0,C.Z)(e,2),n=t[0],r=t[1],a=(0,k.useState)("a golden retriever"),i=(0,C.Z)(a,2),o=i[0],u=i[1];return(0,k.useEffect)((function(){window.scrollTo(0,0)}),[]),(0,rt.jsxs)("div",{style:{maxWidth:"1200px",margin:"0 auto",padding:"60px 40px",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif',lineHeight:"1.6",color:"#2c3e50",backgroundColor:"#ffffff"},children:[(0,rt.jsxs)("header",{style:{textAlign:"center",marginBottom:"80px",borderBottom:"1px solid #e8e8e8",paddingBottom:"40px"},children:[(0,rt.jsx)("h1",{style:{fontSize:"48px",fontWeight:"300",color:"#1a1a1a",marginBottom:"20px",letterSpacing:"-0.02em",lineHeight:"1.2"},children:"Explainable Multimodal AI"}),(0,rt.jsx)("p",{style:{fontSize:"24px",color:"#666",fontWeight:"300",marginBottom:"30px",fontStyle:"italic"},children:"From Black Box to Glass Box"}),(0,rt.jsx)("div",{style:{width:"60px",height:"2px",backgroundColor:"#667eea",margin:"0 auto"}})]}),(0,rt.jsx)("img",{src:Bz,alt:"Interpretability Visual",style:{maxWidth:"100%",height:"auto",borderRadius:"8px",boxShadow:"0 4px 20px rgba(0,0,0,0.1)",marginBottom:"20px"},onError:function(e){console.log("Image failed to load:",e.target.src)},onLoad:function(){console.log("Image loaded successfully!")}}),(0,rt.jsxs)("article",{style:{maxWidth:"800px",margin:"0 auto"},children:[(0,rt.jsxs)("section",{style:{marginBottom:"60px"},children:[(0,rt.jsx)("h2",{style:{fontSize:"32px",fontWeight:"400",color:"#2c3e50",marginBottom:"30px",letterSpacing:"-0.01em"},children:"The Transparency Spectrum"}),(0,rt.jsx)("div",{style:{fontSize:"18px",lineHeight:"1.7",marginBottom:"40px",color:"#444"},children:(0,rt.jsx)("p",{style:{marginBottom:"24px"},children:"Think of AI explainability like a dimmer switch rather than an on/off button. At one end, you've got completely opaque systems\u2014those mysterious deep learning models that somehow recognize cats in videos but can't tell you why. At the other end, there are simple decision trees where every choice is crystal clear."})}),(0,rt.jsx)(Rz,{}),(0,rt.jsx)("div",{style:{fontSize:"18px",lineHeight:"1.7",marginTop:"40px",color:"#444"}})]}),(0,rt.jsx)("div",{style:{height:"1px",background:"linear-gradient(to right, transparent, #e8e8e8, transparent)",margin:"80px 0"}}),(0,rt.jsx)(zz,{}),(0,rt.jsx)("div",{style:{height:"1px",background:"linear-gradient(to right, transparent, #e8e8e8, transparent)",margin:"80px 0"}}),(0,rt.jsx)(Zz,{selectedImage:n,setSelectedImage:r,selectedText:o,setSelectedText:u}),(0,rt.jsx)("div",{style:{height:"1px",background:"linear-gradient(to right, transparent, #e8e8e8, transparent)",margin:"80px 0"}}),(0,rt.jsx)(Lz,{selectedImage:n,selectedText:o}),(0,rt.jsx)("div",{style:{height:"1px",background:"linear-gradient(to right, transparent, #e8e8e8, transparent)",margin:"80px 0"}}),(0,rt.jsx)(Pz,{selectedImage:n,selectedText:o}),(0,rt.jsx)("div",{style:{height:"1px",background:"linear-gradient(to right, transparent, #e8e8e8, transparent)",margin:"80px 0"}}),(0,rt.jsxs)("section",{style:{marginBottom:"80px"},children:[(0,rt.jsx)("h2",{style:{fontSize:"32px",fontWeight:"400",color:"#2c3e50",marginBottom:"30px",letterSpacing:"-0.01em"},children:"Future Directions"}),(0,rt.jsxs)("div",{style:{fontSize:"18px",lineHeight:"1.7",marginBottom:"40px",color:"#444"},children:[(0,rt.jsx)("p",{style:{marginBottom:"30px"},children:"The frontier of explainable multimodal AI is full of challenges and possibilities:"}),(0,rt.jsxs)("ul",{style:{listStyle:"none",padding:0,marginBottom:"40px"},children:[(0,rt.jsxs)("li",{style:{marginBottom:"20px",paddingLeft:"30px",position:"relative"},children:[(0,rt.jsx)("div",{style:{position:"absolute",left:"0",top:"0",width:"6px",height:"6px",backgroundColor:"#667eea",borderRadius:"50%",marginTop:"8px"}}),(0,rt.jsx)("strong",{style:{color:"#2c3e50"},children:"Emergent Capabilities:"})," We're seeing behaviors that even creators can't explain, requiring new mathematical frameworks"]}),(0,rt.jsxs)("li",{style:{marginBottom:"20px",paddingLeft:"30px",position:"relative"},children:[(0,rt.jsx)("div",{style:{position:"absolute",left:"0",top:"0",width:"6px",height:"6px",backgroundColor:"#667eea",borderRadius:"50%",marginTop:"8px"}}),(0,rt.jsx)("strong",{style:{color:"#2c3e50"},children:"Real-Time Systems:"})," Current explanation methods are too slow for deployment (10-100x overhead)"]}),(0,rt.jsxs)("li",{style:{marginBottom:"20px",paddingLeft:"30px",position:"relative"},children:[(0,rt.jsx)("div",{style:{position:"absolute",left:"0",top:"0",width:"6px",height:"6px",backgroundColor:"#667eea",borderRadius:"50%",marginTop:"8px"}}),(0,rt.jsx)("strong",{style:{color:"#2c3e50"},children:"Personalized Explanations:"})," Different stakeholders need different views\u2014doctors want anatomical details, patients want analogies"]}),(0,rt.jsxs)("li",{style:{marginBottom:"20px",paddingLeft:"30px",position:"relative"},children:[(0,rt.jsx)("div",{style:{position:"absolute",left:"0",top:"0",width:"6px",height:"6px",backgroundColor:"#667eea",borderRadius:"50%",marginTop:"8px"}}),(0,rt.jsx)("strong",{style:{color:"#2c3e50"},children:"Trust Calibration:"})," Finding the balance between transparency and overwhelming users with information"]})]})]}),(0,rt.jsx)("div",{style:{backgroundColor:"#f8f9fa",border:"1px solid #e8e8e8",borderRadius:"8px",padding:"30px",marginTop:"40px",borderLeft:"4px solid #667eea"},children:(0,rt.jsxs)("p",{style:{fontSize:"18px",lineHeight:"1.7",margin:0,color:"#2c3e50"},children:[(0,rt.jsx)("strong",{style:{color:"#667eea"},children:"Key Takeaway:"})," The black box era is ending. As AI systems become more powerful and deployed in high-stakes domains, interpretability isn't optional\u2014it's essential for trust, debugging, and regulatory compliance."]})})]}),(0,rt.jsxs)("section",{style:{marginBottom:"80px"},children:[(0,rt.jsx)("h2",{style:{fontSize:"32px",fontWeight:"400",color:"#2c3e50",marginBottom:"30px",letterSpacing:"-0.01em"},children:"Other Rough Draft Images"}),(0,rt.jsx)("img",{src:Uz,alt:"Interpretability Visual",style:{maxWidth:"100%",height:"auto",borderRadius:"8px",boxShadow:"0 4px 20px rgba(0,0,0,0.1)",marginBottom:"20px"},onError:function(e){console.log("Image failed to load:",e.target.src)},onLoad:function(){console.log("Image loaded successfully!")}}),(0,rt.jsx)("img",{src:Vz,alt:"Interpretability Visual",style:{maxWidth:"100%",height:"auto",borderRadius:"8px",boxShadow:"0 4px 20px rgba(0,0,0,0.1)",marginBottom:"20px"},onError:function(e){console.log("Image failed to load:",e.target.src)},onLoad:function(){console.log("Image loaded successfully!")}}),(0,rt.jsx)("img",{src:qz,alt:"Interpretability Visual",style:{maxWidth:"100%",height:"auto",borderRadius:"8px",boxShadow:"0 4px 20px rgba(0,0,0,0.1)",marginBottom:"20px"},onError:function(e){console.log("Image failed to load:",e.target.src)},onLoad:function(){console.log("Image loaded successfully!")}}),(0,rt.jsx)("img",{src:Wz,alt:"Interpretability Visual",style:{maxWidth:"100%",height:"auto",borderRadius:"8px",boxShadow:"0 4px 20px rgba(0,0,0,0.1)",marginBottom:"20px"},onError:function(e){console.log("Image failed to load:",e.target.src)},onLoad:function(){console.log("Image loaded successfully!")}})]})]})]})};var Hz=function(){return(0,rt.jsx)("div",{children:(0,rt.jsxs)(We,{children:[(0,rt.jsx)(Pe,{path:"/",element:(0,rt.jsx)(at,{})}),(0,rt.jsx)(Pe,{path:"/cnn",element:(0,rt.jsx)(VB,{})}),(0,rt.jsx)(Pe,{path:"/multimodal",element:(0,rt.jsx)(bz,{})}),(0,rt.jsx)(Pe,{path:"/unireps",element:(0,rt.jsx)(Oz,{})}),(0,rt.jsx)(Pe,{path:"/explainability",element:(0,rt.jsx)(Gz,{})}),"  "]})})};S.createRoot(document.getElementById("root")).render((0,rt.jsx)(k.StrictMode,{children:(0,rt.jsx)($e,{basename:"/blog",children:(0,rt.jsx)(Hz,{})})}))}()}();
//# sourceMappingURL=main.0dd92edc.js.map